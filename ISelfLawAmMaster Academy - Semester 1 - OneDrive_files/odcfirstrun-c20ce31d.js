define("odsp-next/bundles/odc/FirstRun",["require","exports","../../controls/premiumIntro/PremiumIntro","../../controls/firstRunExperience/FirstRunExperience","../../controls/featureCards/FeatureCards","../../controls/firstRunDialog/FirstRunDialog","../../controls/positioningPresetPlanCard/PositioningPresetPlanCard","../../controls/guidedTour/GuidedTour","../../controls/firstRunBanner/FirstRunBanner","../../controls/guidedTourShareLightBox/GuidedTourShareLightBox","../../providers/firstRunExperience/FirstRunExperienceProvider","../../providers/guidedTour/GuidedTourProvider","../../dataSources/firstRunExperience/odc/FirstRunExperienceDataSource","../../dataSources/guidedTour/odc/GuidedTourDataSource","../../dataSources/inAppMessaging/odc/InAppMessagingDataSource","../../models/inAppMessaging/MessagingType","../../models/inAppMessaging/MessagingTypeHelper","../../providers/inAppMessaging/InAppMessagingProvider"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})});
define("odsp-next/controls/premiumIntro/PremiumIntro",["require","exports","./PremiumIntroViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./PremiumIntro.html","./PremiumIntro.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-premium-intro",template:e("./PremiumIntro.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/premiumIntro/PremiumIntroViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../bindings/html/BindableHtmlBinding","../../bindings/focus/PreserveFocusBinding","../../bindings/focus/FocusTrapBinding","../../bindings/element/ElementBinding","../../utilities/accessibility/Accessibility","../overlays/Overlay","../positioningPresetPlanCard/PositioningPresetPlanCard","../../bindings/keyboard/KeyboardBinding","../../providers/premium/PremiumLightboxProvider","../securityMomentLightbox/SecurityMomentLightbox","../../utilities/features/Features","../../providers/featureCards/FeatureCardsProvider","../../providers/premium/PremiumStateProvider","../../providers/inAppMessaging/InAppMessagingProvider.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.overlayTagName=f.default.tagName;n.addBindingHandlers({element:u.default,bindableHtml:i.default,focusTrap:o.default,preserveFocus:s.default,keyboard:c.default});n.contentRoot=n.createObservable();var r=n.subscribe(n.contentRoot,function(e){a.focusFirstTabStop(e);r.dispose()});n.isPositioningVisible=n.createObservable(!1);n.isOverlayVisible=n.createObservable(!1);n._iamProviderPromise=n.resources.consumeAsync(g.resourceKey);n._iamProviderPromise.then(function(e){e.logLightboxPositioningAttributionEvent(t.upsellType)});n.resources.consume(h.resourceKey).getPremiumLightboxData(t.upsellType).then(function(e){if(!d.isFeatureEnabled(d.EnableSecurityMomentLightbox)||5!==t.upsellType&&6!==t.upsellType){n.isOverlayVisible(!0);n.positioningComponent={name:l.default.tagName,params:{pageData:e,onDismissPositioningClick:n.hide.bind(n)}};n.isPositioningVisible(!0)}else{n.isOverlayVisible(!0);var r=n.resources.consume(v.resourceKey);e.featureCards=r.getFeatureCardsForSecurityMomentLightbox();n.resources.consume(m.resourceKey).getPremiumState(!1).then(function(t){n.positioningComponent={name:p.default.tagName,params:{pageData:e,onDismissPositioningClick:n.hide.bind(n),hasPremium:3===t}};n.isPositioningVisible(!0)})}});return n}t.prototype.hide=function(){this.isPositioningVisible(!1);this.isOverlayVisible(!1)};return t}(r.default);t.default=y});
define("odsp-next/controls/securityMomentLightbox/SecurityMomentLightbox",["require","exports","./SecurityMomentLightboxViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SecurityMomentLightbox.html","./SecurityMomentLightbox.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-security-moment-lightbox",template:e("./SecurityMomentLightbox.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/securityMomentLightbox/SecurityMomentLightboxViewModel",["require","exports","tslib","../../resources/ControlResourceKeys","../../resources/ProviderResourceKeys","../../utilities/attribution/AttributionHelper","../featureCards/FeatureCards","@ms/odsp-shared/lib/base/ViewModel","../../providers/engagement/Engagement","../firstRunExperience/FirstRunExperience.resx","./SecurityMomentLightbox.resx","../../providers/inAppMessaging/InAppMessagingProvider.key"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.imageSource=window.require.toUrl("odsp-media/images/premium/security-lightbox-shield.svg");n.closeButtonAriaLabel=f.strings.closeButtonAriaLabel;n.showFeatureCardsLinkText=l.strings.lightboxShowFeatureCardsLink;n.pageData=t.pageData;n.hasPremium=t.hasPremium;var u=n.hasPremium;n.imageAltText=u?l.strings.lightboxPaidUserTitle:l.strings.lightboxFreeUserTitle;n.headerText=u?l.strings.lightboxPaidUserTitle:l.strings.lightboxFreeUserTitle;n.descriptionText=u?l.strings.lightboxPaidUserBody:l.strings.lightboxFreeUserBody;n.displayFeatureCards=n.createObservable(!1);n.featureCardsTagName=o.default.tagName;n._onDismissPositioningClick=t.onDismissPositioningClick;n._engagement=n.resources.consume(a.resourceKey);n._instrumentationProvider=n.resources.consume(i.instrumentation);n._attributionHelper=n.resources.consume(s.resourceKey);n._actionMap=n.resources.consume(r.actionMap);n.resources.consume(i.userInfo).setPositioningUserFactWithParams(!0);n.resources.consumeAsync(c.resourceKey).then(function(e){return e.markMessagesRead(u?152:151)});n._logEngagementEvent("Show");return n}t.prototype.onCloseButtonClick=function(){this._onDismissPositioningClick();this._logEngagementEvent("Close.Click")};t.prototype.showFeatureCards=function(){this.displayFeatureCards(!0);this._logFeatureCardEngagementEvent("SeeAllFeatures.Click")};t.prototype.purchasePlan=function(){var e=this._getUrlWithAttribution();new(this.managed(this._actionMap.NavigationAction))({url:e,target:"_blank"}).execute({});this._onDismissPositioningClick();this._attributionHelper.logAttributionViaAWA({uri:e});this._logEngagementEvent("GoPremium.Click")};t.prototype.closeFeatureCards=function(e,t){this._closeFeatureCards();this._logFeatureCardEngagementEvent("CloseCards.Click",e)};t.prototype.mainButtonClickFeatureCards=function(e,t){this._closeFeatureCards();this._logFeatureCardEngagementEvent("GotIt.Click",e)};t.prototype._closeFeatureCards=function(){this.displayFeatureCards(!1)};t.prototype._logFeatureCardEngagementEvent=function(e,t){this._engagement.logData({name:"SecurityMomentLightbox."+e,currentPage:this._instrumentationProvider.currentPageName(),extraData:{cardIndex:t,hasPremium:this.hasPremium}})};t.prototype._logEngagementEvent=function(e){this._engagement.logData({name:"SecurityMomentLightbox."+e,currentPage:this._instrumentationProvider.currentPageName(),extraData:{hasPremium:this.hasPremium}})};t.prototype._getUrlWithAttribution=function(){return this._attributionHelper.appendPurchaseAttribution({source:"Positioning-Security-ReturningUser",cta:"GoPremium",attributionEndpoint:"Web"},this.pageData.purchaseUrl)};return t}(u.default);t.default=h});
define("odsp-next/controls/securityMomentLightbox/SecurityMomentLightbox.html",[],function(){return'\x3c!--ko ifnot: displayFeatureCards()--\x3e<div class=od-SecurityMomentLightbox><div class=od-SecurityMomentLightbox-closeButtonContainer><button class=od-SecurityMomentLightbox-closeButton data-bind="click: onCloseButtonClick, attr: { \'aria-label\': closeButtonAriaLabel }"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button></div><img class=od-SecurityMomentLightbox-image data-bind="attr: { src: imageSource, alt: imageAltText }"><div class=od-SecurityMomentLightbox-textArea><h2 class=od-SecurityMomentLightbox-header data-bind="text: headerText"></h2><p class=od-SecurityMomentLightbox-description data-bind="text: descriptionText"></p><a href=javascript:; class=od-SecurityMomentLightbox-showFeatureCardsLink data-bind="click: showFeatureCards, text: showFeatureCardsLinkText"></a>\x3c!--ko ifnot: hasPremium--\x3e<p class=od-SecurityMomentLightbox-price data-bind="text: pageData.price"></p><button class="od-Button od-SecurityMomentLightbox-upgradeButton" data-bind="text: pageData.primaryButtonText, click: purchasePlan"></button>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--ko if: displayFeatureCards()--\x3e<div data-bind="component: { name: featureCardsTagName, params: { cards: pageData.featureCards, currentIndex: 0, close: $component.closeFeatureCards.bind($component), mainButtonClick: $component.mainButtonClickFeatureCards.bind($component) } }"></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/securityMomentLightbox/SecurityMomentLightbox.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-SecurityMomentLightbox{width:620px;box-shadow:0 0 16px 0 "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";margin:auto}@media (max-width:1023.99999px){.od-SecurityMomentLightbox{width:524px}}.od-SecurityMomentLightbox-image{background-color:#1A9BF5}.od-SecurityMomentLightbox-textArea{font-size:17px;font-weight:300;width:100%;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";min-height:130px;text-align:center;padding-bottom:20px}.od-SecurityMomentLightbox-header{font-size:28px;font-weight:100;font-weight:600;display:block;padding:16px 24px 15px 24px;line-height:32px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";margin:0}.od-SecurityMomentLightbox-description{font-size:14px;font-weight:400;display:block;line-height:20px;padding:0 36px 10px 36px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";margin:0}.od-SecurityMomentLightbox-closeButtonContainer{position:absolute;width:620px}html[dir=ltr] .od-SecurityMomentLightbox-closeButtonContainer{text-align:right}html[dir=rtl] .od-SecurityMomentLightbox-closeButtonContainer{text-align:left}@media (max-width:1023.99999px){.od-SecurityMomentLightbox-closeButtonContainer{width:524px}}.od-SecurityMomentLightbox-closeButton{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";cursor:pointer;font-size:16px;background:0 0;border:0;padding:15px 20px}.od-SecurityMomentLightbox-price{font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";padding-top:8px;padding-bottom:14px;margin:0 auto}.od-SecurityMomentLightbox-upgradeButton{background-color:#107C10;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border:1px solid #107C10;font-weight:600;height:40px}.od-SecurityMomentLightbox-upgradeButton:hover{background-color:#0b6a0b;border:1px solid #0b6a0b}.od-SecurityMomentLightbox-upgradeButton:focus{background-color:#0b6a0b;border:1px solid #004b1c}.od-SecurityMomentLightbox-showFeatureCardsLink{font-size:14px;font-weight:400}"}])});
define("odsp-next/controls/premiumIntro/PremiumIntro.html",[],function(){return'\x3c!--ko component: {\r\n name: overlayTagName,\r\n params: {\r\n animation: {},\r\n alignToParent: false\r\n }\r\n}--\x3e<div class=od-PremiumIntro-modal data-bind="visible: isOverlayVisible"><div class=ms-ModalOverlay></div>\x3c!--ko focusTrap: {}--\x3e<div class=od-PremiumIntro-main data-bind="preserveFocus: true, element: contentRoot">\x3c!--ko if: isPositioningVisible--\x3e\x3c!--ko component: positioningComponent--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/premiumIntro/PremiumIntro.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'.od-PremiumIntro-modal{display:block;font-size:0;text-align:center;background-color:transparent;position:absolute;height:100%;width:100%;top:0}@media (max-width:639.99999px){.od-PremiumIntro-modal{display:none}}[dir=ltr] .od-PremiumIntro-modal{left:0}[dir=rtl] .od-PremiumIntro-modal{right:0}.od-PremiumIntro-modal::before{vertical-align:middle;display:inline-block;content:"";height:100%;width:0}.od-PremiumIntro-modal .ms-ModalOverlay{background-color:rgba(51,51,51,.8);cursor:default;animation-name:ms-fadeIn;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-timing-function:cubic-bezier(.455,.03,.515,.955);animation-duration:1s}@media (prefers-reduced-motion:reduce){.od-PremiumIntro-modal .ms-ModalOverlay{animation:none}}.od-PremiumIntro-main{vertical-align:middle;display:inline-block;cursor:default;margin:auto;position:relative}.od-PremiumIntro-welcome{font-weight:100;opacity:1;color:'},{theme:"white",defaultValue:"#ffffff"},{rawString:";text-align:center;height:40px;font-size:32px;padding-bottom:15px}.od-PremiumIntro-page{position:relative;width:620px;box-shadow:0 0 16px 0 "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";margin:auto}@media (max-width:1023.99999px){.od-PremiumIntro-page{width:524px}}.od-PremiumIntro-closeButton{position:absolute;top:0;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";cursor:pointer;font-size:16px;background:0 0;border:0;padding:15px 20px}[dir=ltr] .od-PremiumIntro-closeButton{right:0}[dir=rtl] .od-PremiumIntro-closeButton{left:0}html[dir=ltr] .od-PremiumIntro-closeButton{text-align:right}html[dir=rtl] .od-PremiumIntro-closeButton{text-align:left}"}])});
define("odsp-next/controls/firstRunExperience/FirstRunExperience",["require","exports","../../bindings/component/ControlBinding","./FirstRunExperienceViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FirstRunExperience.html"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.registerComponent({tagName:"ms-first-run-page",template:e("./FirstRunExperience.html"),viewModel:r.default,synchronous:!0});t.resourceKey=n.createResolvedControlDefinitionResourceKey({name:e("module").id,template:e("./FirstRunExperience.html"),automationName:"ms-first-run-page",viewModelType:r.default});t.default=s});
define("odsp-next/controls/firstRunExperience/FirstRunExperienceViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../firstRunDialog/FirstRunDialog","../../providers/engagement/Engagement","../../controls/firstRunExperience/FirstRunExperience.resx","../../resources/ProviderResourceKeys","../../utilities/dragAndDropRobot/DragAndDropAnimationHelper","../../controls/firstRunExperience/FirstRunExperienceStatus.key","../../controls/firstRunExperience/FirstRunExperienceStatus"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c="FirstRunDialog",h="FirstRunLightBox",p=function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.dialogTagName=i.default.tagName;var a=n.firstRunExperienceProvider,f=void 0===a?r.resources.consume(u.firstRunExperience):a;r._provider=f;var l=r._engagement=r.resources.consume(s.resourceKey);r._provider.incrementViewCount();r.dialogParams={laterBtnText:r._provider.getLaterButtonText(),previousBtnText:o.strings.previousButtonText,nextBtnText:o.strings.nextButtonText,finishBtnText:o.strings.finishButtonText,getStartedText:o.strings.finishButtonTextFluent,skipButtonText:o.strings.skipButtonText,startButtonText:o.strings.startButtonText,closeBtnAriaLabel:o.strings.closeButtonAriaLabel,paginationAriaLabel:o.strings.pageNumberLabel,pages:r.createObservable(r._provider.getFirstRunPages()),onClose:r.onClose.bind(r),onFinish:r.onFinish.bind(r),onLater:r.onLater.bind(r),onNext:r.onNext.bind(r),onPrevious:r.onPrevious.bind(r),isReady:r._provider.isReady,positioningPageType:r.createPureComputed(function(){return r._provider.isReady()&&r._provider.getPositioningPageType()}),isStandardPositioningReady:r.createPureComputed(function(){return r._provider.isReady()&&r._provider.getIsStandardPositioningReady()})};l.logData({name:c+".Show"});r._currentPage=1;l.logData({name:h+".ShowPage",extraData:{page:r._currentPage}});r.async.setTimeout(function(){r._provider.timeoutGetUpgradeOptions()},1e3);return r}t.prototype.onClose=function(){var e=this._engagement;e.logData({name:c+".Close.Click",isIntentional:!0});e.logData({name:h+".Close.Click",isIntentional:!0,extraData:{page:this._currentPage}});this.close();this._provider.setFirstRunFlag(!0);this.resources.consume(a.resourceKey).isDialogClosed(!0)};t.prototype.onLater=function(){var e=this._engagement;e.logData({name:c+".Later.Click",isIntentional:!0});e.logData({name:h+".Later.Click",isIntentional:!0,extraData:{page:this._currentPage}});this.close();this._provider.getShouldDismissOnLater()&&this._provider.setFirstRunFlag(!0)};t.prototype.onFinish=function(){var e=this._engagement;e.logData({name:c+".Finish.Click",isIntentional:!0});e.logData({name:h+".Finish.Click",isIntentional:!0,extraData:{page:this._currentPage}});this.close();this._provider.setFirstRunFlag(!0)};t.prototype.onNext=function(){var e=this._engagement;e.logData({name:c+".Next.Click",isIntentional:!0});e.logData({name:h+".Next.Click",isIntentional:!0,extraData:{page:this._currentPage}});this._currentPage++;e.logData({name:h+".ShowPage",extraData:{page:this._currentPage}})};t.prototype.onPrevious=function(){var e=this._engagement;e.logData({name:c+".Previous.Click",isIntentional:!0});e.logData({name:h+".Previous.Click",isIntentional:!0,extraData:{page:this._currentPage}});this._currentPage--;e.logData({name:h+".ShowPage",extraData:{page:this._currentPage}})};t.prototype.close=function(){this.resources.consume(f.resourceKey)(l.FirstRunExperienceStatus.notVisible)};t.dependencies=n.__assign({},r.default.dependencies,{firstRunExperienceProvider:u.firstRunExperience});return t}(r.default);t.default=p});
define("odsp-next/controls/firstRunDialog/FirstRunDialog",["require","exports","./FirstRunDialogViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FirstRunDialog.html","./FirstRunDialog.css","../overlays/Overlay"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-first-run-dialog",template:e("./FirstRunDialog.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/firstRunDialog/FirstRunDialogViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../bindings/html/BindableHtmlBinding","../../bindings/focus/PreserveFocusBinding","../../bindings/focus/FocusTrapBinding","../../bindings/element/ElementBinding","../../bindings/keyboard/KeyboardBinding","../overlays/Overlay","../positioningPresetPlanCard/PositioningPresetPlanCard","../firstRunExperience/FirstRunExperience.resx","@ms/odsp-utilities/lib/string/StringHelper","../../bindings/interactionScope/InteractionScopeBinding","../../bindings/focus/RecoverFocusBinding","../../providers/premium/PremiumLightboxProvider","../../providers/inAppMessaging/InAppMessagingProvider.key","../../controls/fluentStyling/FluentStyling.key","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=function(e){n.__extends(t,e);function t(t){var n=e.call(this)||this;n.overlayTagName=f.default.tagName;n.addBindingHandlers({element:u.default,bindableHtml:i.default,preserveFocus:s.default,focusTrap:o.default,keyboard:a.default,interactionScope:p.default,recoverFocus:d.default});var r=n.observables;n.contentRoot=r.create();n.isOverlayVisible=r.create(!0);n.currentPageIndex=r.create(0);n.welcomeText=r.pureCompute(n._computeWelcomeText);n.pages=t.pages;n.isReady=t.isReady;n.laterBtnText=t.laterBtnText;n.previousBtnText=t.previousBtnText;n.nextBtnText=t.nextBtnText;n.finishBtnText=t.finishBtnText;n.getStartedText=t.getStartedText;n.skipButtonText=t.skipButtonText;n.startButtonText=t.startButtonText;n.closeBtnAriaLabel=t.closeBtnAriaLabel;n.paginationAriaLabel=t.paginationAriaLabel;n.indicatorIconsAriaLabel=r.pureCompute(n._computeIndicatorIconsAriaLabel);n.isActive=r.create(!0);n.currentPage=n.createPureComputed(function(){return n.isReady()&&n.pages()[n.currentPageIndex()]});n._isIAMDataSourceExposed=n.resources.isExposed(y.inAppMessaging);n._onClose=t.onClose;n._onLater=t.onLater;n._onFinish=t.onFinish;n._onNext=t.onNext;n._onPrevious=t.onPrevious;n._premiumLightboxProvider=n.resources.consume(v.resourceKey.optional);n._positioningPageType=t.positioningPageType;if(n._isIAMDataSourceExposed){n._iamProviderPromise=n.resources.consumeAsync(m.resourceKey);n._iamProviderPromise.then(function(e){e.logFREShownForValidation()})}n.isStandardPositioningReady=t.isStandardPositioningReady;n.isStandardPositioning=n.createPureComputed(function(){return n._computePositioningType(101)});n.isWelcomePositioning=n.createPureComputed(function(){return n._computePositioningType(2)});n.isPositioningVisible=n.createObservable(!1);n.displayPositioning=n.createObservable(n.isWelcomePositioning());n.createComputed(n._computePositioningComponent);n.isFirstCardInStandaloneTutorial=n.createPureComputed(function(){return 0===n.currentPageIndex()&&!n.isWelcomePositioning()});n.displayIndicatorIcons=n.createPureComputed(function(){return n.displayPositioning()?n.isWelcomePositioning():n.pages().length>1});n.numberIndicatorIcons=n.createPureComputed(n._computeNumberIndicatorIcons);n.currentIndicatorIndex=n.createObservable(0);n.isFluentEnabled=n.resources.consume(g.resourceKey);return n}t.prototype.onTutorialRightButtonClick=function(e){var t=this.currentPageIndex.peek()===this.pages.peek().length-1,n=this.displayPositioning.peek();this._navigateTutorial(!0,e,t,n,this._onFinish,this._onNext)};t.prototype.onTutorialLeftButtonClick=function(e){var t=0===this.currentIndicatorIndex.peek(),n=this.isWelcomePositioning.peek()&&1===this.currentIndicatorIndex.peek();this._navigateTutorial(!1,e,t,n,this._onLater,this._onPrevious)};t.prototype.onCloseBtnClick=function(){if(this.isStandardPositioning.peek()&&this.isStandardPositioningReady.peek())this.displayPositioning(!0);else{this._hide();this._onClose&&this._onClose()}};t.prototype.onIndicatorClick=function(e){var t=e;if(this.isWelcomePositioning.peek())if(0===e)this.displayPositioning(!0);else{t--;0===this.currentIndicatorIndex.peek()&&this.displayPositioning(!1)}this.currentPageIndex(t);this.currentIndicatorIndex(e)};t.prototype._navigateTutorial=function(e,t,n,r,i,s){var o=this.isStandardPositioning.peek()&&this.isStandardPositioningReady.peek();if(n)t&&(o?this.displayPositioning(!0):this._hideAndFireHelper(i));else{this._manageIndexes(e);r&&this.displayPositioning(!e);s&&s()}};t.prototype._hide=function(){this.isActive(!1);this.isOverlayVisible(!1)};t.prototype.dismissPositioningClick=function(){this.displayPositioning(!1);this._hide();this._onClose&&this._onClose()};t.prototype._hideAndFireHelper=function(e){this._hide();e&&e()};t.prototype._manageIndexes=function(e){if(e){this.displayPositioning.peek()||this.currentPageIndex(this.currentPageIndex.peek()+1);this.currentIndicatorIndex(this.currentIndicatorIndex.peek()+1)}else{this.isWelcomePositioning.peek()&&1===this.currentIndicatorIndex.peek()||this.currentPageIndex(this.currentPageIndex.peek()-1);this.currentIndicatorIndex(this.currentIndicatorIndex.peek()-1)}};t.prototype._computePositioningType=function(e){var t=this._positioningPageType;return this.isReady()&&t&&t()&&t()===e};t.prototype._computeNumberIndicatorIcons=function(){var e=this.pages.peek().length;return this.isWelcomePositioning()?1+e:e};t.prototype._computeWelcomeText=function(){return this.displayPositioning()?"":this.currentPage().welcomeText};t.prototype._computeIndicatorIconsAriaLabel=function(){var e=this.currentPageIndex()+1;return h.format(c.strings.indicatorIconsAriaLabel,e,this.pages.peek().length)};t.prototype._computePositioningComponent=function(){var e=this,t=this._positioningPageType.peek();this.displayPositioning()&&this.isReady()&&t&&this._premiumLightboxProvider.getPremiumLightboxData(t).then(function(n){e.positioningComponent={name:l.default.tagName,params:{pageData:n,onDismissPositioningClick:e.dismissPositioningClick.bind(e)}};e.isPositioningVisible(!0);e._isIAMDataSourceExposed&&e._iamProviderPromise&&e._iamProviderPromise.then(function(e){e.logLightboxPositioningAttributionEvent(t)})})};return t}(r.default);t.default=b});
define("odsp-next/controls/firstRunDialog/FirstRunDialog.html",[],function(){return'\x3c!--ko component: {\r\n name: overlayTagName,\r\n params: {\r\n animation: {},\r\n alignToParent: false\r\n }\r\n}--\x3e<div class=FirstRunDialog-modal data-bind="visible: isOverlayVisible"><div class=ms-ModalOverlay></div>\x3c!--ko if: isReady()--\x3e\x3c!--ko focusTrap: {}--\x3e<div class=FirstRunDialog-main tabindex=-1 role=alertdialog aria-labelledby=FirstRunDialog-welcome data-bind="preserveFocus: true, element: contentRoot, interactionScope: { isScope: true }, recoverFocus: { isEnabled: isActive }, keyboard: { mappings: { Esc: onCloseBtnClick }, allowButtonEvents: true }">\x3c!--ko if: displayPositioning() && isPositioningVisible()--\x3e\x3c!--ko component: positioningComponent--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot: displayPositioning()--\x3e\x3c!--ko ifnot: isFluentEnabled--\x3e<h1 id=FirstRunDialog-welcome class=FirstRunDialog-welcome data-bind="text: welcomeText"></h1>\x3c!--/ko--\x3e\x3c!--/ko--\x3e<div class=FirstRunDialog-page><div class=FirstRunDialog-tutorial data-bind="visible: !displayPositioning(), attr: { id: \'FirstRunDialog-tutorial--\' + currentPageIndex() }, css: { \'od-Carousel-page\': isFluentEnabled }"><div class=FirstRunDialog-closeBtnContainer><button class=FirstRunDialog-closeBtn data-bind="css: { \'FirstRunDialog-closeBtn--grey\': (currentPage().isCloseButtonGrey) }, click: onCloseBtnClick, attr: { \'aria-label\': closeBtnAriaLabel }"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button></div>\x3c!--ko if: isFluentEnabled--\x3e<h2 id=FirstRunDialog-descTitle class=FirstRunDialog-descTitle><span data-bind="bindableHtml: currentPage().title"></span>\x3c!--ko if: currentPage().iconClass && currentPage().iconAriaLabel--\x3e<i class="ms-fontColor-red FirstRunDialog-descTitle--heartIcon" data-bind="css: currentPage().iconClass, attr: { \'aria-label\': currentPage().iconAriaLabel }"></i>\x3c!--/ko--\x3e</h2>\x3c!--/ko--\x3e<div class=FirstRunDialog-animationArea data-bind="css: { \'FirstRunDialog-animationArea--imageWithPadding\': currentPage().isImagePadded }"><img data-bind="attr: { src: currentPage().imageUrl, alt: currentPage().imageAltText }"></div><div class=FirstRunDialog-desc role=region aria-live=polite>\x3c!--ko ifnot: isFluentEnabled--\x3e<h2 id=FirstRunDialog-descTitle class=FirstRunDialog-descTitle><span data-bind="bindableHtml: currentPage().title"></span>\x3c!--ko if: currentPage().iconClass && currentPage().iconAriaLabel--\x3e<i class="ms-fontColor-red FirstRunDialog-descTitle--heartIcon" data-bind="css: currentPage().iconClass, attr: { \'aria-label\': currentPage().iconAriaLabel }"></i>\x3c!--/ko--\x3e</h2>\x3c!--/ko--\x3e<p id=FirstRunDialog-descText class=FirstRunDialog-descText data-bind="bindableHtml: currentPage().textHtml"></p></div>\x3c!--ko if: displayIndicatorIcons() && isFluentEnabled--\x3e<div class=od-FeatureCards-paginationControls>\x3c!--ko if: currentPageIndex() === 0--\x3e<button class="od-FeatureCards-TextNavigation od-FeatureCards-paginationControls--leftButton" data-bind="click: onCloseBtnClick, attr: { \'aria-label\': closeBtnAriaLabel }"><span data-bind="text: skipButtonText"></span></button>\x3c!--/ko--\x3e\x3c!--ko if: currentPageIndex() !== 0--\x3e<button class=od-FeatureCards-NavigatePreviousButton data-bind="click: onTutorialLeftButtonClick.bind($data, true), attr: { \'aria-label\': previousBtnText }"><i class="ms-Icon ms-Icon--ChevronLeft" data-bind="icon: true"></i> <span data-bind="text: previousBtnText"></span></button>\x3c!--/ko--\x3e<div class=od-FeatureCards-paginationNumbers data-bind="visible: pages().length > 1"><span data-bind="text: (currentPageIndex()+ 1)"></span> of <span data-bind="text: pages().length"></span></div>\x3c!--ko if: currentPageIndex() === 0--\x3e<button class=od-FeatureCards-NavigateNextButton data-bind="click: onTutorialRightButtonClick.bind($data, true), attr: { \'aria-label\': nextBtnText }"><i class="ms-Icon ms-Icon--ChevronRight" data-bind="icon: true"></i> <span data-bind="text: startButtonText"></span></button>\x3c!--/ko--\x3e\x3c!--ko if: currentPageIndex() > 0 && (currentPageIndex() < pages().length - 1)--\x3e<button class=od-FeatureCards-NavigateNextButton data-bind="click: (currentPageIndex() < pages().length - 1) ? onTutorialRightButtonClick.bind($data, true) : undefined, attr: { \'aria-label\': nextBtnText }"><i class="ms-Icon ms-Icon--ChevronRight" data-bind="icon: true"></i> <span data-bind="text: nextBtnText"></span></button>\x3c!--/ko--\x3e\x3c!--ko if: currentPageIndex() === pages().length - 1--\x3e<button class="od-FeatureCards-TextNavigation od-FeatureCards-FinishedButton od-FeatureCards-paginationControls--rightButton" data-bind="click: onCloseBtnClick, attr: { \'aria-label\': closeBtnAriaLabel }"><span data-bind="text: finishBtnText"></span></button>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if: !isFluentEnabled--\x3e<div class=FirstRunDialog-buttons><button class=FirstRunDialog-prevBtn data-bind="click: onTutorialLeftButtonClick.bind($data, true), text: isFirstCardInStandaloneTutorial() ? laterBtnText : previousBtnText, css: { \'FirstRunDialog-lightBtn\': isFirstCardInStandaloneTutorial(), \'FirstRunDialog-withOptional\': (currentPage().showOptionalButton && pages().length > 1) }, attr: { \'aria-label\': previousBtnText }"></button> <button class=FirstRunDialog-nextBtn data-bind="click: onTutorialRightButtonClick.bind($data, true), visible: pages().length > 1, text: currentPageIndex() === (pages().length - 1) ? finishBtnText : nextBtnText, css: { \'FirstRunDialog-withOptional\': currentPage().showOptionalButton }, attr: { \'aria-label\': nextBtnText }"></button> <button class=FirstRunDialog-optionalBtn data-bind="click: currentPage().onOptional, text: currentPage().optionalButtonText, visible: currentPage().showOptionalButton, css: { \'FirstRunDialog-withOptional\': pages().length > 1, \'FirstRunDialog-optionalBtnGreen\': currentPage().isOptionalButtonGreen, \'FirstRunDialog-optionalBtnBlue\': currentPage().isOptionalButtonBlue }"></button></div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if: displayIndicatorIcons() && !isFluentEnabled--\x3e<div class=FirstRunDialog-pagination role=application tabindex=0 data-bind="visible: displayPositioning() ? isWelcomePositioning() : (pages().length > 1), keyboard: { mappings: { Right: onTutorialRightButtonClick.bind($data, false), Left: onTutorialLeftButtonClick.bind($data, false) }, allowButtonEvents: true }, attr: { \'aria-label\': indicatorIconsAriaLabel }">\x3c!--ko foreach: new Array(numberIndicatorIcons())--\x3e<button class=FirstRunDialog-page tabindex=-1 data-bind="css: { \'FirstRunDialog-curPage\': ($index() === $parent.currentIndicatorIndex()) }, attr: { id: \'FirstRunDialog-page--\' + $index(), \'aria-label\': $parent.paginationAriaLabel + \' \' + ($index() + 1) }, click: $parent.onIndicatorClick.bind($parent, $index())"></button>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/firstRunDialog/FirstRunDialog.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'.FirstRunDialog-modal{display:block;font-size:0;text-align:center;background-color:transparent;position:absolute;height:100%;width:100%;top:0}@media (max-width:639.99999px){.FirstRunDialog-modal{display:none}.isFluent .FirstRunDialog-modal{display:block}}[dir=ltr] .FirstRunDialog-modal{left:0}[dir=rtl] .FirstRunDialog-modal{right:0}.FirstRunDialog-modal::before{vertical-align:middle;display:inline-block;content:"";height:100%;width:0}.FirstRunDialog-modal>.ms-ModalOverlay{background-color:rgba(51,51,51,.8);cursor:default;animation-name:ms-fadeIn;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-timing-function:cubic-bezier(.455,.03,.515,.955);animation-duration:1.1s}@media (prefers-reduced-motion:reduce){.FirstRunDialog-modal>.ms-ModalOverlay{animation:none}}.FirstRunDialog-main{vertical-align:middle;display:inline-block;cursor:default;margin:auto;position:relative}.isFluent .FirstRunDialog-main{color:'},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.isFluent.sm .FirstRunDialog-main{height:100%}.isFluent.md .FirstRunDialog-main{height:100%}.FirstRunDialog-main:focus{outline:0}.FirstRunDialog-welcome{font-weight:100;opacity:1;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";text-align:center;height:40px;font-size:32px;padding-bottom:15px;margin:0}.isFluent .FirstRunDialog-welcome{font-weight:400}.FirstRunDialog-page{width:620px;box-shadow:0 0 16px 0 "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";margin:auto}.isFluent .FirstRunDialog-page{width:540px;border-radius:2px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.isFluent.xxxxlg .FirstRunDialog-page{width:840px}.isFluent.xxxlg .FirstRunDialog-page{width:644px}.isFluent.xxlg .FirstRunDialog-page{width:560px}.isFluent.sm .FirstRunDialog-page{width:448px}.isFluent.md .FirstRunDialog-page{width:448px}.isFluent.lg .FirstRunDialog-page{width:448px}.isFluent.xlg .FirstRunDialog-page{width:448px}.isFluent.sm .FirstRunDialog-page{width:100%;height:100%}.isFluent.md .FirstRunDialog-page{width:100%;height:100%}@media (max-width:1023.99999px){.FirstRunDialog-page{width:524px}}.FirstRunDialog-closeBtnContainer{position:absolute;width:620px}html[dir=ltr] .FirstRunDialog-closeBtnContainer{text-align:right}html[dir=rtl] .FirstRunDialog-closeBtnContainer{text-align:left}.isFluent .FirstRunDialog-closeBtnContainer{width:auto;top:16px}html[dir=ltr] .isFluent .FirstRunDialog-closeBtnContainer{right:16px}html[dir=rtl] .isFluent .FirstRunDialog-closeBtnContainer{left:16px}@media (max-width:1023.99999px){.FirstRunDialog-closeBtnContainer{width:524px}}.FirstRunDialog-closeBtn{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";cursor:pointer;font-size:16px;background:0 0;border:0;padding:15px 20px}.isFluent .FirstRunDialog-closeBtn{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";border-radius:2px;width:32px;height:32px;padding:0}.FirstRunDialog-closeBtn.FirstRunDialog-closeBtn--grey{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.FirstRunDialog-animationArea{top:0;width:100%;height:auto;background-color:#30C6CC}.FirstRunDialog-animationArea img{width:100%;height:100%}.isFluent .FirstRunDialog-animationArea img{border-radius:2px 2px 0 0}.FirstRunDialog-animationArea.FirstRunDialog-animationArea--imageWithPadding{box-sizing:border-box;padding:60px 55px 0;background-color:#6CAEDF}.FirstRunDialog-desc{font-size:17px;font-weight:300;width:100%;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";min-height:130px}html[dir=ltr] .FirstRunDialog-desc{text-align:left}html[dir=rtl] .FirstRunDialog-desc{text-align:right}.isFluent .FirstRunDialog-desc{min-height:1px}.isFluent.sm .FirstRunDialog-desc{-ms-flex:1 1 auto;flex:1 1 auto}.isFluent.md .FirstRunDialog-desc{-ms-flex:1 1 auto;flex:1 1 auto}.FirstRunDialog-descTitle{font-size:28px;font-weight:100;display:block;padding:16px 24px 15px 24px;line-height:24pt;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";margin:0}.isFluent .FirstRunDialog-descTitle{font-size:20px;font-weight:600;line-height:20px;height:24px;padding:0 0 20px}html[dir=ltr] .isFluent .FirstRunDialog-descTitle{text-align:left}html[dir=rtl] .isFluent .FirstRunDialog-descTitle{text-align:right}.FirstRunDialog-descTitle--heartIcon{vertical-align:top;height:30px;line-height:30px}.FirstRunDialog-descText{font-size:14px;font-weight:400;display:block;line-height:15pt;padding:0 24px 22px 24px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";margin:0}.isFluent .FirstRunDialog-descText{padding:12px 0}html[dir=ltr] .isFluent .FirstRunDialog-descText{text-align:left}html[dir=rtl] .isFluent .FirstRunDialog-descText{text-align:right}.isFluent.sm .FirstRunDialog-descText{min-height:60px}.isFluent.md .FirstRunDialog-descText{min-height:60px}.isFluent.lg .FirstRunDialog-descText{min-height:60px}.isFluent.xlg .FirstRunDialog-descText{min-height:60px}.isFluent.xxlg .FirstRunDialog-descText{min-height:60px}.FirstRunDialog-buttons{width:100%;height:auto;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";white-space:nowrap}.isFluent .FirstRunDialog-buttons{border-top:0;position:relative}.FirstRunDialog-buttons button{width:50%;font-size:14px;font-weight:400;display:inline-block;padding:18px 0 19px 0;text-align:center;text-transform:uppercase;cursor:pointer;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";background:0 0;border:0}.isFluent .FirstRunDialog-buttons button{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";width:auto;margin:0 18px;font-size:16px;height:16px;box-sizing:content-box;padding:14px 0}.isFluent .FirstRunDialog-buttons .FirstRunDialog-prevBtn{position:absolute;top:0}html[dir=ltr] .isFluent .FirstRunDialog-buttons .FirstRunDialog-prevBtn{left:0}html[dir=rtl] .isFluent .FirstRunDialog-buttons .FirstRunDialog-prevBtn{right:0}.isFluent .FirstRunDialog-buttons .FirstRunDialog-nextBtn{position:absolute;top:0}html[dir=ltr] .isFluent .FirstRunDialog-buttons .FirstRunDialog-nextBtn{right:0}html[dir=rtl] .isFluent .FirstRunDialog-buttons .FirstRunDialog-nextBtn{left:0}.FirstRunDialog-buttons>.FirstRunDialog-lightBtn{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.isFluent .FirstRunDialog-buttons>.FirstRunDialog-lightBtn{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}html[dir=ltr] .FirstRunDialog-buttons>.FirstRunDialog-nextBtn{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir=rtl] .FirstRunDialog-buttons>.FirstRunDialog-nextBtn{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir=ltr] .isFluent .FirstRunDialog-buttons>.FirstRunDialog-nextBtn{border-left:0 solid transparent}html[dir=rtl] .isFluent .FirstRunDialog-buttons>.FirstRunDialog-nextBtn{border-right:0 solid transparent}html[dir=ltr] .FirstRunDialog-buttons>.FirstRunDialog-optionalBtn{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir=rtl] .FirstRunDialog-buttons>.FirstRunDialog-optionalBtn{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir=ltr] .isFluent .FirstRunDialog-buttons>.FirstRunDialog-optionalBtn{border-left:0 solid transparent}html[dir=rtl] .isFluent .FirstRunDialog-buttons>.FirstRunDialog-optionalBtn{border-right:0 solid transparent}.FirstRunDialog-buttons>.FirstRunDialog-optionalBtnBlue{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.FirstRunDialog-buttons>.FirstRunDialog-optionalBtnGreen{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:#107C10}.FirstRunDialog-buttons>.FirstRunDialog-withOptional{width:33.33%}.FirstRunDialog-navigationSection{display:-ms-flexbox;display:flex;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";-ms-flex-pack:justify;justify-content:space-between;-ms-flex-align:center;align-items:center;border-radius:0 0 2px 2px;height:55px}.FirstRunDialog-pagination{width:100%;height:36px;opacity:1}.FirstRunDialog-pagination .FirstRunDialog-page{background-color:transparent;cursor:pointer;width:12px;height:12px;margin:12px 8px;border-radius:50%;border:solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:" 1px;display:inline-block}.FirstRunDialog-pagination .FirstRunDialog-curPage{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}"}])});
define("odsp-next/utilities/dragAndDropRobot/DragAndDropAnimationHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.isAnimation=r.createObservable(!1);r.isDialogClosed=r.createObservable(!1);r._isExperimentSeen=!1;r._initTime=null;r._fileUploaded=!1;r._isInitialized=!1;return r}t.prototype.getInitialized=function(){return this._isInitialized};t.prototype.getExperimentSeen=function(){return this._isExperimentSeen};t.prototype.setExperimentSeen=function(){this._isExperimentSeen=!0};t.prototype.setIntializeTime=function(){this._initTime=Date.now()};t.prototype.setIsInitialized=function(e){this._isInitialized=e};t.prototype.getExperimentInitTime=function(){return this._initTime};t.prototype.setFileUploaded=function(){this._fileUploaded=!0};t.prototype.getFileUploaded=function(){return this._fileUploaded};t.dependencies=n.__assign({},r.default.dependencies);return t}(r.default);t.default=s;t.resourceKey=i.createResolvedResourceKey(e("module").id,s)});
define("odsp-next/controls/firstRunExperience/FirstRunExperience.html",[],function(){return"\x3c!--ko component: {\r\n name: dialogTagName,\r\n params: dialogParams\r\n}--\x3e\x3c!--/ko--\x3e"});
define("odsp-next/controls/guidedTour/GuidedTour",["require","exports","./GuidedTourViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./GuidedTour.html","./GuidedTour.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-guided-tour",template:e("./GuidedTour.html"),viewModel:n.default});t.default=i});
define("odsp-next/controls/guidedTour/GuidedTourViewModel",["require","exports","tslib","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/string/StringHelper","../../bindings/element/ElementBinding","../guidedTourShareLightBox/GuidedTourShareLightBox","../../utilities/icons/Icon","../../bindings/keyboard/KeyboardBinding","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-shared/lib/base/ViewModel","../../utilities/accessibility/Accessibility","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../providers/engagement/Engagement","../detailsPane/IsDetailsPaneExpanded","../firstRunExperience/FirstRunExperience.resx","./GuidedTour.resx","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w,E="GuidedTour",S=5;!function(e){e[e.SignIn=0]="SignIn";e[e.Upload=1]="Upload";e[e.Mobile=2]="Mobile";e[e.Sync=3]="Sync";e[e.Share=4]="Share"}(w||(w={}));var x=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({element:u.default,keyboard:l.default});n.contentRoot=n.createObservable();n.taskElements=[];for(var i=0;i<S;++i)n.taskElements.push(n.createObservable());n.rocketAltText=y.strings.guidedTourRocketImageAltText;n.isReady=n.createObservable(!1);var o=n._engagement=n.resources.consume(v.resourceKey);n.isInfoPaneExpanded=n.resources.consume(m.resourceKey);n.lightboxComponent=n.createObservable();n._provider=n.resources.consume(s.guidedTour);n._userInfoProvider=n.resources.consume(s.userInfo);n.completedSteps=n.createObservable(0);n._actionMap=n.resources.consume(r.actionMap);n._getSyncMacNavigationAction=new(n.managed(n._actionMap.NavigationAction))({url:"https://go.microsoft.com/fwlink/?LinkId=248255",target:"_blank"});n._getSyncOtherNavigationAction=new(n.managed(n._actionMap.NavigationAction))({url:"https://go.microsoft.com/fwlink/p/?LinkId=248256",target:"_blank"});var a=n._provider.getMobileTargetUrl();n._getMobileNavigationAction=new(n.managed(n._actionMap.NavigationAction))({url:a,target:"_blank"});n._onClose=t.onClose;n.uploadHintButtonText=y.strings.uploadButtonText;n.tasks=n._getTasks();n.isInProgress=n.createPureComputed(function(){return n.completedSteps()<n.tasks.length});n.createBackgroundComputed(function(){if(!n.isInProgress()){n._userInfoProvider.updateGuidedTourData(!0,!1);n._userInfoProvider.getGuidedTourViewCount().then(function(e){o.logData({name:E+".CompleteTour",extraData:{viewCount:e}})})}});n.selectedTask=n.createObservable(null);n.headerText=n.createPureComputed(function(){if(n.isInProgress()){var e=n.selectedTask();return e&&e.subHeader?y.strings.guidedTourHeader:y.strings.guidedTourHeaderNoSubtitle}return y.strings.guidedTourConclusionHeader});n.selectedTaskAriaLabel=n.createComputed(n._computeSelectedTaskAriaLabel);n.imageUrl=n.createPureComputed(function(){var e=c.default.isRightToLeft?"_rtol":"";return window.require.toUrl("odsp-media/images/guidedtour/rocket_"+n.completedSteps()+"_steps_completed"+e+".svg")});n.closeButtonAriaLabel=g.strings.closeButtonAriaLabel;n.createComputed(function(){var e=n._provider.getUploadCompleted()();n.isReady()&&e&&n._markTaskAsComplete(n._uploadTask)});n._userInfoProvider.getCompletedGuidedTourActions().then(function(e){for(var t,r=0,i=n.tasks;r<i.length;r++){var s=i[r];void 0===s.userFactIdentifier||e.indexOf(s.userFactIdentifier)>-1?s.isCompleted(!0):t||(t=s)}n.completedSteps(e.length+1);n._goToTask(t);if(!n._provider.getSeenThisSession()){n._userInfoProvider.updateGuidedTourData(!1,!0);n._provider.setSeenThisSession()}n._userInfoProvider.getGuidedTourViewCount().then(function(e){var t=new b.Qos({name:"GuidedTour.Show"}),n={resultType:b.ResultTypeEnum.Success};t.end(n);o.logData({name:E+".Show",extraData:{viewCount:e}})});n.isReady(!0);t&&p.focusFirstTabStop(t.htmlElement.peek(),!0)});return n}t.prototype.onCloseButtonClick=function(){this._provider.setDismissedThisSession();this._engagement.logData({name:E+".Close",extraData:{isComplete:!this.isInProgress.peek(),completedTaskCount:this.completedSteps.peek(),selectedTask:this.selectedTask.peek().telemetryIdentifier}});this._onClose()};t.prototype.onTaskClicked=function(e){var t=this.tasks[e];this._engagement.logData({name:E+".ClickTask",isIntentional:!0,extraData:{task:t.telemetryIdentifier,isTaskComplete:t.isCompleted.peek()}});this._goToTask(t)};t.prototype.onRightKeyPressed=function(){var e,t=this.selectedTask.peek(),n=this.tasks.indexOf(t);e=n!==this.tasks.length-1?n+1:0;var r=this.tasks[e];this.selectedTask(r);p.focusFirstTabStop(r.htmlElement.peek(),!0)};t.prototype.onLeftKeyPressed=function(){var e,t=this.selectedTask.peek(),n=this.tasks.indexOf(t);e=0!==n?n-1:this.tasks.length-1;var r=this.tasks[e];this.selectedTask(r);p.focusFirstTabStop(r.htmlElement.peek(),!0)};t.prototype.onCTAButtonClicked=function(e){e.onClickButton();this._engagement.logData({name:E+".ClickCTAButton",isIntentional:!0,extraData:{task:e.telemetryIdentifier}});e.completeOnClickButton&&this._markTaskAsComplete(e)};t.prototype._markTaskAsComplete=function(e){if(!e.isCompleted.peek()){var t=this.tasks.filter(function(e){return!e.isCompleted.peek()});this.completedSteps(this.completedSteps.peek()+1);if(t.length>1&&e===this.selectedTask.peek()){var n=t.indexOf(e),r=t[(n+1)%t.length];this._goToTask(r);p.focusFirstTabStop(r.htmlElement.peek(),!0)}this._userInfoProvider.completeGuidedTourAction(e.userFactIdentifier);e.isCompleted(!0);this._engagement.logData({name:E+".CompleteTask",extraData:{task:e.telemetryIdentifier,completedTaskCount:this.completedSteps.peek()}})}};t.prototype._getIncompleteIcon=function(e,t){var n=this;return this.createPureComputed(function(){return new f.default(n.tasks[t].isCompleted()?"CheckMark":e)})};t.prototype._isTaskSelected=function(e){var t=this;return this.createPureComputed(function(){return t.selectedTask()===t.tasks[e]})};t.prototype._initializeLightBoxComponent=function(){this.lightboxComponent({name:a.default.tagName,params:{onClose:this._onCloseLightBoxComponent.bind(this)}})};t.prototype._onCloseLightBoxComponent=function(){this.lightboxComponent(null);this._markTaskAsComplete(this.tasks[4])};t.prototype._getSyncTask=function(){var e=this,t=this.resources.consume(d.platformDetection);return t.isIPad||t.isAndroid?this._makeSyncTask(y.strings.getSyncActionMobileSubheader,y.strings.getSyncActionMobileText,y.strings.getSyncActionWindows81MobileButtonText,function(){}):t.isMac?this._makeSyncTask(y.strings.getSyncActionMacSubheader,y.strings.getSyncActionMacText,y.strings.getSyncActionMacOtherButtonText,function(){e._getSyncMacNavigationAction.execute({})}):t.isWindows81?this._makeSyncTask(y.strings.getSyncActionPCSubheader,y.strings.getSyncActionWindows81Text,y.strings.getSyncActionWindows81MobileButtonText,function(){}):this._makeSyncTask(y.strings.getSyncActionPCSubheader,y.strings.getSyncActionOtherText,y.strings.getSyncActionMacOtherButtonText,function(){if(t.isWindows10){var n="odopen://sync?userEmail="+e.resources.consume(i.identity).getIdentity().email,r=document.createElement("iframe");r.setAttribute("src",n);r.style.display="none";r.style.width="1px";r.style.height="1px";document.documentElement.appendChild(r);e.async.setTimeout(function(){document.documentElement.removeChild(r)},1e3)}else e._getSyncOtherNavigationAction.execute({})})};t.prototype._makeSyncTask=function(e,t,n,r){return{subHeader:e,actionName:y.strings.getSyncActionName,actionText:t,buttonText:n,onClickButton:r,completeOnClickButton:!0,isCompleted:this.createObservable(!1),incompleteIcon:this._getIncompleteIcon("TVMonitor",w.Sync),isSelected:this._isTaskSelected(w.Sync),userFactIdentifier:2,telemetryIdentifier:"Sync",htmlElement:this.createObservable()}};t.prototype._getTasks=function(){var e=this,t={actionName:y.strings.noneCompletedActionName,actionText:this._provider.getSignInString(),isCompleted:this.createObservable(!0),incompleteIcon:this.createObservable(new f.default("CheckMark")),isSelected:this._isTaskSelected(w.SignIn),telemetryIdentifier:"SignIn",htmlElement:this.createObservable()};this._uploadTask={subHeader:y.strings.uploadActionSubheader,actionName:y.strings.uploadActionName,actionText:y.strings.uploadActionText,isCompleted:this.createObservable(!1),incompleteIcon:this._getIncompleteIcon("Upload",w.Upload),isSelected:this._isTaskSelected(w.Upload),userFactIdentifier:0,telemetryIdentifier:"Upload",htmlElement:this.createObservable()};var n={subHeader:y.strings.getMobileActionSubheader,actionName:y.strings.getMobileActionName,actionText:y.strings.getMobileActionText,buttonText:y.strings.getMobileActionButtonText,completeOnClickButton:!0,onClickButton:function(){e._getMobileNavigationAction.execute({})},isCompleted:this.createObservable(!1),incompleteIcon:this._getIncompleteIcon("CellPhone",w.Mobile),isSelected:this._isTaskSelected(w.Mobile),userFactIdentifier:1,telemetryIdentifier:"Mobile",htmlElement:this.createObservable()},r=this._getSyncTask(),i={subHeader:y.strings.shareActionSubheader,actionName:y.strings.shareActionName,actionText:this._provider.getShareString(),buttonText:y.strings.shareActionButtonText,onClickButton:function(){e._initializeLightBoxComponent()},completeOnClickButton:!1,isCompleted:this.createObservable(!1),incompleteIcon:this._getIncompleteIcon("Share",w.Share),isSelected:this._isTaskSelected(w.Share),userFactIdentifier:3,telemetryIdentifier:"Share",htmlElement:this.createObservable()};return[t,this._uploadTask,n,r,i]};t.prototype._goToTask=function(e){e!==this.selectedTask.peek()&&this._engagement.logData({name:E+".ViewTask",extraData:{task:e.telemetryIdentifier,isTaskComplete:e.isCompleted.peek()}});this.selectedTask(e)};t.prototype._computeSelectedTaskAriaLabel=function(){var e=this.selectedTask();if(!e)return"";var t=this.tasks.indexOf(e);return(1===this.completedSteps.peek()?o.format(y.strings.guidedTourTaskAriaLabelOneCompleted,e.actionName,e.isCompleted.peek()?y.strings.guidedTourAriaLabelComplete:"",t+1):o.format(y.strings.guidedTourTaskAriaLabelMultipleCompleted,e.actionName,e.isCompleted.peek()?y.strings.guidedTourAriaLabelComplete:"",t+1,this.completedSteps.peek()))+" "+(e.subHeader||"")+" "+e.actionText};return t}(h.default);t.default=x});
define("odsp-next/controls/guidedTourShareLightBox/GuidedTourShareLightBox",["require","exports","./GuidedTourShareLightBoxViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./GuidedTourShareLightBox.html","./GuidedTourShareLightBox.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-guided-tour-share-lightbox",template:e("./GuidedTourShareLightBox.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/guidedTourShareLightBox/GuidedTourShareLightBoxViewModel",["require","exports","tslib","../../bindings/html/BindableHtmlBinding","../../bindings/element/ElementBinding","../../bindings/focus/FocusTrapBinding","../../bindings/keyboard/KeyboardBinding","@ms/odsp-utilities/lib/locale/Locale","../overlays/Overlay","../../bindings/focus/PreserveFocusBinding","@ms/odsp-shared/lib/base/ViewModel","../../utilities/accessibility/Accessibility","../../controls/firstRunExperience/FirstRunExperience.resx","../guidedTour/GuidedTour.resx"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.overlayTagName=a.default.tagName;n._onClose=t.onClose;n.addBindingHandlers({element:i.default,bindableHtml:r.default,focusTrap:s.default,preserveFocus:f.default,keyboard:o.default});n.contentRoot=n.createObservable();var l=n.subscribe(n.contentRoot,function(e){c.focusFirstTabStop(e);l.dispose()});n.closeButtonAriaLabel=h.strings.closeButtonAriaLabel;n.imageAltText=p.strings.guidedTourShareLightboxImageAltText;n.title=p.strings.shareActionLightBoxHeader;n.text=p.strings.shareActionLightBoxBodyText;var d=u.default.isRightToLeft?"_rtol":"";n.imageUrl=window.require.toUrl("odsp-media/images/guidedtour/share_lightbox"+d+".svg");n.buttonText=p.strings.shareActionLightBoxButtonText;return n}t.prototype.onCloseButtonClick=function(){this._onClose()};return t}(l.default);t.default=d});
define("odsp-next/controls/guidedTourShareLightBox/GuidedTourShareLightBox.html",[],function(){return'\x3c!--ko component: {\r\n name: overlayTagName,\r\n params: {\r\n animation: {},\r\n alignToParent: false\r\n }\r\n}--\x3e<div class=od-GuidedTourShareLightBox-modal><div class=ms-ModalOverlay></div>\x3c!--ko focusTrap: {}--\x3e<div class=od-GuidedTourShareLightBox-main data-bind="preserveFocus: true, element: contentRoot"><div class=od-GuidedTourShareLightBox-animationArea><img data-bind="attr: { \'src\': imageUrl, \'alt\': imageAltText }"></div><div class=od-GuidedTourShareLightBox-desc><div><h2 id=od-GuidedTourShareLightBox-descTitle class=od-GuidedTourShareLightBox-descTitle data-bind="text: title"></h2><p id=od-GuidedTourShareLightBox-descText class=od-GuidedTourShareLightBox-descText data-bind="text: text"></p></div><div class=od-GuidedTourShareLightBox-buttonArea><button class="od-Button od-GuidedTourShareLightBox-GotIt" data-bind="click: onCloseButtonClick, text: buttonText"></button></div></div><button class=od-GuidedTourShareLightBox-closeButton data-bind="click: onCloseButtonClick, attr: { \'aria-label\': closeButtonAriaLabel }, keyboard: { allowButtonEvents: true, mappings: { Esc: $component.onCloseButtonClick } }"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/guidedTourShareLightBox/GuidedTourShareLightBox.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'.od-GuidedTourShareLightBox-modal{display:block;text-align:center;background-color:transparent;position:absolute;height:100%;width:100%;top:0}@media (max-width:639.99999px){.od-GuidedTourShareLightBox-modal{display:none}}[dir=ltr] .od-GuidedTourShareLightBox-modal{left:0}[dir=rtl] .od-GuidedTourShareLightBox-modal{right:0}.od-GuidedTourShareLightBox-modal::before{vertical-align:middle;display:inline-block;content:"";height:100%;width:0}.od-GuidedTourShareLightBox-modal .ms-ModalOverlay{background-color:rgba(51,51,51,.8);cursor:default}.od-GuidedTourShareLightBox-main{vertical-align:middle;display:inline-block;cursor:default;margin:auto;position:relative;box-shadow:0 0 16px 0 '},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";width:524px}@media (max-width:1023.99999px){.od-GuidedTourShareLightBox-main{width:524px}}.xlg .od-GuidedTourShareLightBox-main,.xxlg .od-GuidedTourShareLightBox-main,.xxxlg .od-GuidedTourShareLightBox-main,.xxxxlg .od-GuidedTourShareLightBox-main{width:620px}.od-GuidedTourShareLightBox-closeButton{position:absolute;top:0;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";cursor:pointer;font-size:16px;background:0 0;border:0;padding:10px 12px}[dir=ltr] .od-GuidedTourShareLightBox-closeButton{right:0}[dir=rtl] .od-GuidedTourShareLightBox-closeButton{left:0}html[dir=ltr] .od-GuidedTourShareLightBox-closeButton{text-align:right}html[dir=rtl] .od-GuidedTourShareLightBox-closeButton{text-align:left}.od-GuidedTourShareLightBox-animationArea{top:0;width:100%;height:auto;background-color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-GuidedTourShareLightBox-animationArea img{width:524px;height:226px}.xlg .od-GuidedTourShareLightBox-animationArea img,.xxlg .od-GuidedTourShareLightBox-animationArea img,.xxxlg .od-GuidedTourShareLightBox-animationArea img,.xxxxlg .od-GuidedTourShareLightBox-animationArea img{width:620px}.od-GuidedTourShareLightBox-desc{font-size:17px;font-weight:300;width:100%;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";min-height:188px;max-height:288px;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between;-ms-flex-direction:column;flex-direction:column}html[dir=ltr] .od-GuidedTourShareLightBox-desc{text-align:left}html[dir=rtl] .od-GuidedTourShareLightBox-desc{text-align:right}.od-GuidedTourShareLightBox-descTitle{font-size:28px;font-weight:100;display:block;padding:12px 24px;line-height:24pt;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";margin:auto}.od-GuidedTourShareLightBox-descText{font-size:14px;font-weight:400;display:block;line-height:15pt;padding:0 24px 12px 24px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";margin:auto}.od-GuidedTourShareLightBox-buttonArea{text-align:center;padding-bottom:12px}.od-GuidedTourShareLightBox-buttonArea .od-Button{background-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}"}])});
define("odsp-next/controls/guidedTour/GuidedTour.html",[],function(){return'\x3c!--ko if: isReady() && !isInfoPaneExpanded()--\x3e<div class=od-GuidedTour tabindex=0 data-bind="element: contentRoot, keyboard: { mappings: { Right: onRightKeyPressed, Left: onLeftKeyPressed, Esc: onCloseButtonClick }, allowButtonEvents: true }, attr: { \'aria-labelledby\': \'od-GuidedTour-titleText \' + \'od-GuidedTour-actionGlyph-\' + selectedTask().actionName }"><div class=od-GuidedTour-imageArea data-bind="css: { \'od-GuidedTour-imageArea-tourCompleted\': !isInProgress() }"><img data-bind="attr: { \'src\': imageUrl, \'alt\': rocketAltText }"></div><div class=od-GuidedTour-primaryTextArea data-bind="css: { \'od-GuidedTour-primaryTextArea-tourComplete\': !isInProgress() }"><div class=od-GuidedTour-headerArea><h2 id=od-GuidedTour-titleText class=od-GuidedTour-titleText data-bind="text: headerText(), css: { \'od-GuidedTour-titleText-tourComplete\': !isInProgress() }"></h2>\x3c!--ko if: isInProgress()--\x3e<h3 id=od-GuidedTour-primaryText class=od-GuidedTour-primaryText data-bind="text: selectedTask().subHeader"></h3>\x3c!--/ko--\x3e</div>\x3c!--ko if: isInProgress()--\x3e<div class=od-GuidedTour-actionGlyphArea>\x3c!--ko foreach: tasks--\x3e<button class=od-GuidedTour-actionGlyph tabindex=-1 data-bind="click: $parent.onTaskClicked.bind($parent, $index.peek()), css: { \'od-GuidedTour-actionGlyph-selected\': isSelected, \'od-GuidedTour-actionGlyph-completed\': isCompleted, \'od-GuidedTour-actionGlyph-completed-selected\': isCompleted && isSelected }, element: htmlElement, attr: { \'id\': \'od-GuidedTour-actionGlyph-\' + telemetryIdentifier, \'aria-label\': isSelected() ? $parent.selectedTaskAriaLabel : actionName }"><div class=od-GuidedTour-actionIcon data-bind="component: { name: \'od-icon-glyph\', params: { icon: incompleteIcon } }"></div><div class=od-GuidedTour-actionName data-bind="text: actionName"></div></button>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div><div class=od-GuidedTour-secondaryTextArea>\x3c!--ko if: isInProgress()--\x3e<p id=od-GuidedTour-actionText class=od-GuidedTour-actionText data-bind="text: selectedTask().actionText"></p>\x3c!--ko if: selectedTask().buttonText--\x3e<button class="od-Button od-Button--primary od-GuidedTour-CTAButton" data-bind="text: selectedTask().buttonText, click: onCTAButtonClicked.bind($data, selectedTask.peek()), disable: (selectedTask().disableButtonAfterCompletion && selectedTask().isCompleted)"></button>\x3c!--/ko--\x3e\x3c!--ko if: selectedTask().telemetryIdentifier === "Upload"--\x3e<button class="od-Button od-Button--primary od-GuidedTour-uploadHintButton" aria-hidden=true data-bind="text: uploadHintButtonText, disable: true"></button>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><div class=od-GuidedTour-closeButton><button data-bind="click: onCloseButtonClick, attr: { \'aria-label\': closeButtonAriaLabel }"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button></div></div>\x3c!--ko with: lightboxComponent--\x3e\x3c!--ko component: $data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});
define("odsp-next/controls/guidedTour/GuidedTour.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-GuidedTour-closeButton{cursor:pointer;position:absolute;top:0;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .od-GuidedTour-closeButton{right:0}[dir=rtl] .od-GuidedTour-closeButton{left:0}.od-GuidedTour-closeButton button{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";cursor:pointer;font-size:16px;background:0 0;border:0;padding:6px 8px}.od-GuidedTour-imageArea{display:none}@media screen and (min-width:801px){.od-GuidedTour-imageArea{display:block;bottom:0;position:absolute;height:188px;max-width:100%;overflow:hidden}[dir=ltr] .od-GuidedTour-imageArea{left:0}[dir=rtl] .od-GuidedTour-imageArea{right:0}.od-GuidedTour-imageArea img{height:188px}}.od-GuidedTour-imageArea-tourCompleted{display:block;bottom:0;position:absolute;height:188px;max-width:100%;overflow:hidden}[dir=ltr] .od-GuidedTour-imageArea-tourCompleted{left:0}[dir=rtl] .od-GuidedTour-imageArea-tourCompleted{right:0}.od-GuidedTour-imageArea-tourCompleted img{height:188px}.od-GuidedTour{border:none;height:188px;overflow:hidden;margin:32px 32px 0 32px;position:relative;display:none}.lg .od-GuidedTour,.xlg .od-GuidedTour,.xxlg .od-GuidedTour,.xxxlg .od-GuidedTour,.xxxxlg .od-GuidedTour{display:block}.isFluent .od-GuidedTour{border-radius:2px}.od-GuidedTour .od-GuidedTour-headerArea{margin-right:32px;height:56px;display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}.xxlg .od-GuidedTour .od-GuidedTour-headerArea,.xxxlg .od-GuidedTour .od-GuidedTour-headerArea,.xxxxlg .od-GuidedTour .od-GuidedTour-headerArea{display:block;margin-right:0;height:auto}.od-GuidedTour .od-GuidedTour-primaryTextArea{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:start;align-items:flex-start;box-sizing:border-box;border:0;width:100%;background-color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:";height:112px}[dir=ltr] .od-GuidedTour .od-GuidedTour-primaryTextArea{padding-left:24px}[dir=rtl] .od-GuidedTour .od-GuidedTour-primaryTextArea{padding-right:24px}@media screen and (min-width:801px){[dir=ltr] .od-GuidedTour .od-GuidedTour-primaryTextArea{padding-left:196px}[dir=rtl] .od-GuidedTour .od-GuidedTour-primaryTextArea{padding-right:196px}}.xxlg .od-GuidedTour .od-GuidedTour-primaryTextArea,.xxxlg .od-GuidedTour .od-GuidedTour-primaryTextArea,.xxxxlg .od-GuidedTour .od-GuidedTour-primaryTextArea{-ms-flex-align:center;align-items:center;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-ms-flex-pack:justify;justify-content:space-between;display:-ms-inline-flexbox;display:inline-flex;-ms-flex-direction:row;flex-direction:row}[dir=ltr] .xxlg .od-GuidedTour .od-GuidedTour-primaryTextArea,[dir=ltr] .xxxlg .od-GuidedTour .od-GuidedTour-primaryTextArea,[dir=ltr] .xxxxlg .od-GuidedTour .od-GuidedTour-primaryTextArea{padding-left:204px}[dir=rtl] .xxlg .od-GuidedTour .od-GuidedTour-primaryTextArea,[dir=rtl] .xxxlg .od-GuidedTour .od-GuidedTour-primaryTextArea,[dir=rtl] .xxxxlg .od-GuidedTour .od-GuidedTour-primaryTextArea{padding-right:204px}[dir=ltr] .od-GuidedTour .od-GuidedTour-primaryTextArea-tourComplete{padding-left:196px}[dir=rtl] .od-GuidedTour .od-GuidedTour-primaryTextArea-tourComplete{padding-right:196px}.od-GuidedTour .od-GuidedTour-primaryTextArea-tourComplete>.od-GuidedTour-headerArea{height:112px}.xxlg .od-GuidedTour .od-GuidedTour-primaryTextArea-tourComplete>.od-GuidedTour-headerArea,.xxxlg .od-GuidedTour .od-GuidedTour-primaryTextArea-tourComplete>.od-GuidedTour-headerArea,.xxxxlg .od-GuidedTour .od-GuidedTour-primaryTextArea-tourComplete>.od-GuidedTour-headerArea{height:auto}.od-GuidedTour .od-GuidedTour-titleText{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";margin:auto;display:inline;font-size:14px;font-weight:300;cursor:default}.isFluent .od-GuidedTour .od-GuidedTour-titleText{font-weight:600}.xxlg .od-GuidedTour .od-GuidedTour-titleText,.xxxlg .od-GuidedTour .od-GuidedTour-titleText,.xxxxlg .od-GuidedTour .od-GuidedTour-titleText{font-size:21px;padding-bottom:2px;display:block}.od-GuidedTour .od-GuidedTour-titleText-tourComplete{font-size:21px}.xxlg .od-GuidedTour .od-GuidedTour-titleText-tourComplete,.xxxlg .od-GuidedTour .od-GuidedTour-titleText-tourComplete,.xxxxlg .od-GuidedTour .od-GuidedTour-titleText-tourComplete{padding-bottom:0}.od-GuidedTour .od-GuidedTour-primaryText{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:14px;display:inline;margin-left:4px;font-weight:300;cursor:default}.isFluent .od-GuidedTour .od-GuidedTour-primaryText{font-weight:400}.xxlg .od-GuidedTour .od-GuidedTour-primaryText,.xxxlg .od-GuidedTour .od-GuidedTour-primaryText,.xxxxlg .od-GuidedTour .od-GuidedTour-primaryText{font-size:17px;margin:auto;display:block}.od-GuidedTour .od-GuidedTour-secondaryTextArea{-ms-flex-align:center;align-items:center;-ms-flex-wrap:nowrap;flex-wrap:nowrap;-ms-flex-pack:start;justify-content:flex-start;display:-ms-flexbox;display:flex;box-sizing:border-box;border:0;background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";height:76px;width:100%}[dir=ltr] .od-GuidedTour .od-GuidedTour-secondaryTextArea{padding-left:24px}[dir=rtl] .od-GuidedTour .od-GuidedTour-secondaryTextArea{padding-right:24px}[dir=ltr] .od-GuidedTour .od-GuidedTour-secondaryTextArea{padding-right:16px}[dir=rtl] .od-GuidedTour .od-GuidedTour-secondaryTextArea{padding-left:16px}@media screen and (min-width:801px){[dir=ltr] .od-GuidedTour .od-GuidedTour-secondaryTextArea{padding-left:196px}[dir=rtl] .od-GuidedTour .od-GuidedTour-secondaryTextArea{padding-right:196px}}.od-GuidedTour .od-GuidedTour-secondaryTextArea .od-Button{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";white-space:nowrap;min-width:inherit}[dir=ltr] .od-GuidedTour .od-GuidedTour-secondaryTextArea .od-Button{margin-left:24px}[dir=rtl] .od-GuidedTour .od-GuidedTour-secondaryTextArea .od-Button{margin-right:24px}.od-GuidedTour .od-GuidedTour-secondaryTextArea .od-Button.is-disabled,.od-GuidedTour .od-GuidedTour-secondaryTextArea .od-Button:disabled{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:";border:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.od-GuidedTour .od-GuidedTour-secondaryTextArea .od-GuidedTour-uploadHintButton.is-disabled,.od-GuidedTour .od-GuidedTour-secondaryTextArea .od-GuidedTour-uploadHintButton:disabled{color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";border:2px solid "},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";font-size:14px;font-weight:600}[dir=ltr] .xxlg .od-GuidedTour .od-GuidedTour-secondaryTextArea,[dir=ltr] .xxxlg .od-GuidedTour .od-GuidedTour-secondaryTextArea,[dir=ltr] .xxxxlg .od-GuidedTour .od-GuidedTour-secondaryTextArea{padding-left:204px}[dir=rtl] .xxlg .od-GuidedTour .od-GuidedTour-secondaryTextArea,[dir=rtl] .xxxlg .od-GuidedTour .od-GuidedTour-secondaryTextArea,[dir=rtl] .xxxxlg .od-GuidedTour .od-GuidedTour-secondaryTextArea{padding-right:204px}.od-GuidedTour .od-GuidedTour-actionText{font-size:12px;color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:";max-width:632px;margin:0;cursor:default}.xxlg .od-GuidedTour .od-GuidedTour-actionText,.xxxlg .od-GuidedTour .od-GuidedTour-actionText,.xxxxlg .od-GuidedTour .od-GuidedTour-actionText{font-size:14px}.od-GuidedTour .od-GuidedTour-actionGlyphArea{display:-ms-inline-flexbox;display:inline-flex;white-space:nowrap}[dir=ltr] .od-GuidedTour .od-GuidedTour-actionGlyphArea{padding-right:32px}[dir=rtl] .od-GuidedTour .od-GuidedTour-actionGlyphArea{padding-left:32px}.od-GuidedTour .od-GuidedTour-actionGlyph{height:56px;width:84px;padding:8px 4px;border:0;background:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:";text-align:center;display:inline-block;position:relative;cursor:pointer}.od-GuidedTour .od-GuidedTour-actionGlyph:hover{background:"},{theme:"themeTertiary",defaultValue:"#71afe5"},{rawString:"}.xxlg .od-GuidedTour .od-GuidedTour-actionGlyph,.xxxlg .od-GuidedTour .od-GuidedTour-actionGlyph,.xxxxlg .od-GuidedTour .od-GuidedTour-actionGlyph{width:100px;padding:12px 4px 16px 4px;height:inherit}.od-GuidedTour .od-GuidedTour-actionIcon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-GuidedTour .od-GuidedTour-actionIcon .ms-Icon{vertical-align:top;margin-bottom:8px;font-size:17px}.xxlg .od-GuidedTour .od-GuidedTour-actionIcon .ms-Icon,.xxxlg .od-GuidedTour .od-GuidedTour-actionIcon .ms-Icon,.xxxxlg .od-GuidedTour .od-GuidedTour-actionIcon .ms-Icon{padding:17.5px;font-size:21px;margin-bottom:6px;border-radius:50%;border:1px "},{theme:"white",defaultValue:"#ffffff"},{rawString:" dashed}.od-GuidedTour .od-GuidedTour-actionGlyph-selected{background:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-GuidedTour .od-GuidedTour-actionGlyph-selected:hover{background:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:"}.xxlg .od-GuidedTour .od-GuidedTour-actionGlyph-selected .od-GuidedTour-actionIcon .ms-Icon,.xxxlg .od-GuidedTour .od-GuidedTour-actionGlyph-selected .od-GuidedTour-actionIcon .ms-Icon,.xxxxlg .od-GuidedTour .od-GuidedTour-actionGlyph-selected .od-GuidedTour-actionIcon .ms-Icon{border:1px #6EC9CD solid}.od-GuidedTour .od-GuidedTour-actionGlyph-selected .od-GuidedTour-actionName{font-size:13px;font-weight:600}.isFluent .od-GuidedTour .od-GuidedTour-actionGlyph-selected .od-GuidedTour-actionName{font-weight:600}.xxlg .od-GuidedTour .od-GuidedTour-actionGlyph-selected .od-GuidedTour-actionName,.xxxlg .od-GuidedTour .od-GuidedTour-actionGlyph-selected .od-GuidedTour-actionName,.xxxxlg .od-GuidedTour .od-GuidedTour-actionGlyph-selected .od-GuidedTour-actionName{font-size:15px}.od-GuidedTour .od-GuidedTour-actionGlyph-completed:hover .od-GuidedTour-actionName{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-GuidedTour .od-GuidedTour-actionGlyph-completed:hover .od-GuidedTour-actionIcon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-GuidedTour .od-GuidedTour-actionGlyph-completed .od-GuidedTour-actionName{color:"},{theme:"themeTertiary",defaultValue:"#71afe5"},{rawString:"}.od-GuidedTour .od-GuidedTour-actionGlyph-completed .od-GuidedTour-actionIcon{color:"},{theme:"themeTertiary",defaultValue:"#71afe5"},{rawString:"}.od-GuidedTour .od-GuidedTour-actionGlyph-completed .od-GuidedTour-actionIcon .ms-Icon{border:0;font-size:14px;padding-top:3px}.xxlg .od-GuidedTour .od-GuidedTour-actionGlyph-completed .od-GuidedTour-actionIcon .ms-Icon,.xxxlg .od-GuidedTour .od-GuidedTour-actionGlyph-completed .od-GuidedTour-actionIcon .ms-Icon,.xxxxlg .od-GuidedTour .od-GuidedTour-actionGlyph-completed .od-GuidedTour-actionIcon .ms-Icon{padding:22px;border:0}.od-GuidedTour .od-GuidedTour-actionGlyph-completed-selected .od-GuidedTour-actionName{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-GuidedTour .od-GuidedTour-actionGlyph-completed-selected .od-GuidedTour-actionIcon{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-GuidedTour .od-GuidedTour-actionGlyph-completed-selected:hover .od-GuidedTour-actionName{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-GuidedTour .od-GuidedTour-actionGlyph-completed-selected:hover .od-GuidedTour-actionIcon{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-GuidedTour .od-GuidedTour-actionName{font-weight:400;font-size:12px;font-weight:300;color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";width:100%;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.isFluent .od-GuidedTour .od-GuidedTour-actionName{font-weight:400}.xxlg .od-GuidedTour .od-GuidedTour-actionName,.xxxlg .od-GuidedTour .od-GuidedTour-actionName,.xxxxlg .od-GuidedTour .od-GuidedTour-actionName{font-size:14px;height:20px}"}])});
define("odsp-next/controls/firstRunBanner/FirstRunBanner",["require","exports","./FirstRunBannerViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FirstRunBanner.html","./FirstRunBanner.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-first-run-banner",template:e("./FirstRunBanner.html"),viewModel:n.default});t.default=i});
define("odsp-next/controls/firstRunBanner/FirstRunBannerViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../models/upsell/UpsellTypes","../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/images/ImagePromise","../../bindings/css/VisibilityBinding","../../bindings/element/ElementBinding"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.upsellTypes=s.default;n.addBindingHandlers({visibility:l.default,element:c.default});n._upsellProvider=n.resources.consume(o.upsell);n._marketingRequestApiId=n._upsellProvider.getMarketingRequestApiId();n._userInfoProvider=n.resources.consume(o.userInfo);n.isIframeClosing=r.observable(!1);n.upsellIframe=r.observable(null);n.marketingRequest=r.observable("");n.isIframeVisible=r.observable(!1);n.isUpsellClosed=r.observable(!1);n.isContentLoaded=r.observable(!1);n._item=t.item;n.upsell=n.wrapObservable(t.upsell);n._init();return n}t.prototype.onCloseButtonClick=function(e,n){var i=this,s=r.utils.unwrapObservable(this.upsell);this._userInfoProvider.updateUpsellData(s,!0,!1).then(null,function(e){});this.events.off(window,"message");if(s.shouldSendMessageOnClose)if(0===s.renderType){var o=r.utils.unwrapObservable(this.upsellIframe);o&&o.contentWindow&&o.contentWindow.postMessage&&o.contentWindow.postMessage("dismiss","*")}else 1===s.renderType&&this._oneRmResponse&&this._userInfoProvider.sendCloseUpsell(this._oneRmResponse,$Config.upsellUserId,$Config.mkt);this.isIframeVisible(!1);this.isIframeClosing(!0);this.async.setInterval(function(){i.isUpsellClosed(!0)},t.MARKETING_REQUEST_TIMEOUT_LENGTH);this._dimissUrl&&f.request(this._dimissUrl).then(function(){},function(){})};t.prototype.dispose=function(){e.prototype.dispose.call(this);this._ajaxRequest&&this._ajaxRequest.cancel()};t.prototype._init=function(){var e=this,t=this.upsell();this.events.on(window,"message",this._onReceivedMarketingMessage);this._userInfoProvider.getUpsellIframeSrc(t,this._item()).then(function(n){if(0===t.renderType){e.marketingRequest(n);e._initMarketingRequest()}else 1===t.renderType&&e._makeAjaxRequest(n)},function(e){})};t.prototype._initMarketingRequest=function(){var e=this;this._marketingRequestTimeout=this.async.setTimeout(function(){new u.Qos({name:e._marketingRequestApiId+"-marketing-timeout"}).end({resultType:a.ResultTypeEnum.Failure});e.isUpsellClosed(!0);e.events.off(window,"message")},t.MARKETING_REQUEST_TIMEOUT_LENGTH)};t.prototype._onReceivedMarketingMessage=function(e){if(null!==e){var n=e,r=[t.UPSELL_MARKETING_HOST,t.TESTING_ONERM_MARKETING_HOST,t.O365_UPSELL_MARKETING_HOST,t.TESTING_UPSELL_MARKETING_HOST,t.ONERM_MARKETING_HOST];if(-1!==n.origin.indexOf(location.host)||-1!==r.indexOf(n.origin)){this.async.clearTimeout(this._marketingRequestTimeout);if(n.data){if("close"===n.data)this.onCloseButtonClick(null,n);else if("fre"===n.data.source&&n.data.success){new u.Qos({name:this._marketingRequestApiId}).end({resultType:a.ResultTypeEnum.Success});this.isIframeVisible(!0);this.isContentLoaded(!0);this._incrementUpsellCount();this._dimissUrl=n.data.dismissUrl||""}}else{new u.Qos({name:this._marketingRequestApiId}).end({resultType:a.ResultTypeEnum.Success});this.isUpsellClosed(!0);this.events.off(window,"message")}}}};t.prototype._makeAjaxRequest=function(e){var t=this,n=function(){t.isIframeVisible(!1);t.events.off(window,"message")};this._ajaxRequest=this._upsellProvider.getUpsellFromOneRm(e).then(function(e){t._oneRmResponse=e;if(!e)return n();if(2===e.ContentType){t.isIframeVisible(!1);t.isUpsellClosed(!0)}else if(0===e.ContentType){var r=t.upsellIframe.peek().contentWindow.document;r.open();r.write(e.Html);r.close();t.isIframeVisible(!0);t._userInfoProvider.sendShowUpsell(t._oneRmResponse,$Config.upsellUserId,$Config.mkt);t.isContentLoaded(!0)}else n()},function(e){n()})};t.prototype._incrementUpsellCount=function(){this._userInfoProvider.updateUpsellData(this.upsell(),!1,!0).then(null,function(e){})};t.MARKETING_REQUEST_TIMEOUT_LENGTH=1e4;t.ONERM_MARKETING_HOST="https://dynmsg.modpim.com";t.TESTING_ONERM_MARKETING_HOST="https://messaging-int.msonerm.com";t.UPSELL_MARKETING_HOST="https://sc.imp.live.com";t.O365_UPSELL_MARKETING_HOST="https://ocb.trafficmanager.net";t.TESTING_UPSELL_MARKETING_HOST="https://sc-ppe.imp.live.com";return t}(i.default);t.default=h});
define("odsp-next/controls/firstRunBanner/FirstRunBanner.html",[],function(){return'\x3c!--ko if: upsell() !== null && !isUpsellClosed()--\x3e<div class=FirstRunBanner data-bind="class: \'upsell-\' + upsell().id, css: { \'FirstRunBanner--isContentLoaded\': isContentLoaded }"><iframe class=FirstRunBanner-iframe data-bind="visible: isIframeVisible, attr: { src: marketingRequest }, css: { fre: upsell().type === upsellTypes.FRE, oneUnit: upsell().type === upsellTypes.ONEUNIT, \'FirstRunBanner--isIframeClosing\': isIframeClosing }, automation: \'fre-iframe\', element: upsellIframe" scrolling=no></iframe><div class=FirstRunBanner-loadingArea data-bind="visibility: !isIframeVisible()"></div><span class="FirstRunBanner-closeButton ms-Icon ms-Icon--Cancel" role=button data-bind="icon: true, visibility: isIframeVisible, click: onCloseButtonClick"></span></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/firstRunBanner/FirstRunBanner.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".FirstRunBanner{overflow:hidden;padding:0 29px 0 32px;right:0;left:0;position:relative;overflow:hidden}html[dir=rtl] .FirstRunBanner{padding:0 32px 0 29px}[dir=ltr] .FirstRunBanner{margin-right:3px}[dir=rtl] .FirstRunBanner{margin-left:3px}.FirstRunBanner-closeButton{cursor:pointer;position:absolute;top:15px;color:#666}[dir=ltr] .FirstRunBanner-closeButton{right:50px}[dir=rtl] .FirstRunBanner-closeButton{left:50px}.FirstRunBanner-iframe{border:none;width:100%}.FirstRunBanner-iframe.fre{height:260px}.FirstRunBanner-iframe.oneUnit{height:168px}.FirstRunBanner--isIframeClosing{display:none}"}])});
define("odsp-next/providers/firstRunExperience/FirstRunExperienceProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","../../resources/ProviderResourceKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._dataSource=n.resources.consume(i.firstRunExperience);n.isReady=n.createComputed(function(){return n._dataSource.isReady()});n.resources.isExposed(s.userInfo)&&(n._userInfoProvider=n.resources.consume(s.userInfo));return n}t.prototype.getFirstRunFlag=function(){return this._dataSource.getFirstRunFlag()};t.prototype.setFirstRunFlag=function(e){return this._dataSource.setFirstRunFlag(e)};t.prototype.getLaterButtonText=function(){return this._dataSource.getLaterButtonText()};t.prototype.getFirstRunPages=function(){return this._dataSource.getFirstRunPages()};t.prototype.getViewCount=function(){return this._userInfoProvider?this._userInfoProvider.getFirstRunExperienceViewCount():null};t.prototype.incrementViewCount=function(){return this._userInfoProvider?this._userInfoProvider.updateFirstRunExperienceData(!1,!0):null};t.prototype.getShouldDismissOnLater=function(){return this._dataSource.getShouldDismissOnLater()};t.prototype.getCurrentScenario=function(){if(this._dataSource.getCurrentScenario)return this._dataSource.getCurrentScenario()};t.prototype.timeoutGetUpgradeOptions=function(){this._dataSource.timeoutGetUpgradeOptions()};t.prototype.getPositioningPageType=function(){return this._dataSource.getPositioningPageType&&this._dataSource.getPositioningPageType()};t.prototype.getIsStandardPositioningReady=function(){return this._dataSource.getIsStandardPositioningReady&&this._dataSource.getIsStandardPositioningReady()};return t}(r.default);t.FirstRunExperienceProvider=o;t.default=o});
define("odsp-next/providers/guidedTour/GuidedTourProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/ControlResourceKeys","../../resources/ProviderResourceKeys","../../resources/DataSourceResourceKeys","../engagement/Engagement","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f="GuidedTour",l=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var r=e.call(this,t)||this;r._uploadCompleted=r.resources.consume(i.didUserUploadOrCreateFile);r._dataSource=r.resources.consume(o.guidedTour);r._uploadTimerStartTime=0;r._fileUploadedEventFired=!1;r._seenThisSession=!1;r._dismissedThisSession=!1;r._userInfoProvider=r.resources.consume(s.userInfo);var l=r.subscribe(r._uploadCompleted,function(e){e&&r._dismissedThisSession&&a.default.all({completedActions:r._userInfoProvider.getCompletedGuidedTourActions(),viewCount:r._userInfoProvider.getGuidedTourViewCount()}).then(function(e){var t=e.completedActions;e.viewCount;if(-1===t.indexOf(0)){r._userInfoProvider.completeGuidedTourAction(0);var i={completedTaskCount:t.length+1},s=r.resources.consume(u.resourceKey);s.logData({name:f+".CompleteTask",extraData:n.__assign({task:"Upload"},i)});s.logData({name:f+".CompleteUploadAfterDismissal",extraData:i})}l.dispose()})});return r}t.prototype.getFinalTaskParams=function(){return this._dataSource.getFinalTaskParams()};t.prototype.getFinalTaskCompleted=function(){return this._dataSource.getFinalTaskCompleted()};t.prototype.getUploadCompleted=function(){return this._uploadCompleted};t.prototype.setUploadTimerStartTime=function(e){this._uploadTimerStartTime=e};t.prototype.getUploadTimerStartTime=function(){return this._uploadTimerStartTime};t.prototype.setFileUploadedEventFired=function(){this._fileUploadedEventFired=!0};t.prototype.getFileUploadedEventFired=function(){return this._fileUploadedEventFired};t.prototype.setSeenThisSession=function(){this._seenThisSession=!0};t.prototype.getSeenThisSession=function(){return this._seenThisSession};t.prototype.getMobileTargetUrl=function(){return this._dataSource.getMobileTargetUrl()};t.prototype.setDismissedThisSession=function(){this._dismissedThisSession=!0};t.prototype.getDismissedThisSession=function(){return this._dismissedThisSession};t.prototype.getSignInString=function(){return this._dataSource.getSignInString()};t.prototype.getShareString=function(){return this._dataSource.getShareString()};return t}(r.default);t.GuidedTourProvider=l;t.default=l});
define("odsp-next/dataSources/firstRunExperience/odc/FirstRunExperienceDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../controls/firstRunExperience/FirstRunExperience.resx","../../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/Styling","../../../providers/inAppMessaging/InAppMessagingProvider.key"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.isReady=n.createObservable(!1);n._userInfoProvider=n.resources.consume(s.userInfo);n._iamProvider=n.resources.consumeAsync(a.resourceKey);n._shouldDismissOnLater=!1;n._isGetUpgradeOptionsTimedOut=n.createObservable(!1);n._tutorialPages=n._computeTutorialPages();n._laterButtonText=i.strings.finishLaterButtonText;n._isStandardPositioningReady=!1;n.createComputed(n._initializePositioningPage);return n}t.prototype.getFirstRunFlag=function(){return this._userInfoProvider.getFirstRunExperienceDismissed()};t.prototype.setFirstRunFlag=function(e){return this._userInfoProvider.updateFirstRunExperienceData(!0,!1).then(function(){})};t.prototype.getLaterButtonText=function(){return this._laterButtonText};t.prototype.getFirstRunPages=function(){return this._tutorialPages};t.prototype.getPositioningPageType=function(){return this._lightboxType};t.prototype.getIsStandardPositioningReady=function(){return this._isStandardPositioningReady};t.prototype.getShouldDismissOnLater=function(){return this._shouldDismissOnLater};t.prototype.timeoutGetUpgradeOptions=function(){this._isGetUpgradeOptionsTimedOut(!0)};t.prototype._computeTutorialPages=function(){var e=o.format(i.strings.versionBSecondPageTitle,'<i class="'+u.getIconClassName("HeartFill")+' ms-fontColor-red" style="position:relative; top:4px;">');new Array;return[{welcomeText:i.strings.versionABCWelcomeText,imageUrl:window.require.toUrl("odsp-media/images/firstrunexperience/versiona04_versionb01.png"),imageAltText:i.strings.versionABCFirstPageTitle,title:i.strings.versionABCFirstPageTitle,textHtml:i.strings.versionBFirstPageText},{imageUrl:window.require.toUrl("odsp-media/images/firstrunexperience/versionb02.png"),imageAltText:e,title:e,textHtml:i.strings.versionBSecondPageText},{imageUrl:window.require.toUrl("odsp-media/images/firstrunexperience/versionb03.png"),imageAltText:i.strings.versionBThirdPageTitle,title:i.strings.versionBThirdPageTitle,textHtml:i.strings.versionBThirdPageText}]};t.prototype._initializePositioningPage=function(){var e=this;this._iamProvider.then(function(e){return e.getPremiumUpsellType()}).then(function(t){e._lightboxType=t;if(2===e._lightboxType){e._tutorialPages[0].welcomeText="";e._isStandardPositioningReady=!0}else 101===e._lightboxType&&(e._isStandardPositioningReady=!0);e.isReady(!0)}).catch(function(t){e.isReady(!0)})};return t}(r.default);t.default=f});
define("odsp-next/dataSources/guidedTour/odc/GuidedTourDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../controls/guidedTour/GuidedTour.resx","../../../resources/ProviderResourceKeys","../../../actions/odc/SkyApiHelper","../../../resources/ControlResourceKeys","../../../utilities/attribution/AttributionHelper"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._finalTaskCompleted=n.createObservable(!1);n._storageOptionsProvider=n.resources.consume(s.storageOptions);n.createComputed(function(){n._storageOptionsProvider.isReady()&&n._finalTaskCompleted(n._storageOptionsProvider.hasOffice.peek())});n._didUserComeBack=n.createObservable(!1);n.createComputed(function(){n._didUserComeBack()&&!n._finalTaskCompleted.peek()&&n._storageOptionsProvider.getStorageOptions().then(function(e){n._finalTaskCompleted(e.hasCurrentOfficePlan)})});n._attributionHelper=n.resources.consume(a.resourceKey);return n}t.prototype.getFinalTaskParams=function(){var e=this,t=this.resources.consume(u.actionMap),n=this._attributionHelper.appendPurchaseAttribution({source:"GuidedTour",cta:"TryPremium",attributionEndpoint:"Web"},"https://go.microsoft.com/fwlink/?linkid=834613");return{subHeader:i.strings.premiumActionSubheader,actionName:i.strings.premiumActionName,actionText:i.strings.premiumActionText,buttonText:i.strings.premiumActionButtonText,onClickButton:function(){e._didUserComeBack(!1);o.refreshWhenVisible(e._didUserComeBack);new(e.managed(t.NavigationAction))({url:n,target:"_blank"}).execute({});e._attributionHelper.logAttributionViaAWA({uri:n})},isCompleted:this.createObservable(!1),incompleteIconName:"Diamond"}};t.prototype.getFinalTaskCompleted=function(){return this._finalTaskCompleted};t.prototype.getSignInString=function(){return i.strings.noneCompletedActionText};t.prototype.getShareString=function(){return i.strings.shareActionText};t.prototype.getMobileTargetUrl=function(){return"https://go.microsoft.com/fwlink/?linkid=835704"};return t}(r.default);t.GuidedTourDataSource=f;t.default=f});
define("odsp-next/dataSources/inAppMessaging/odc/InAppMessagingDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-graph/lib/Models","../../url/odc/UrlDataSource","../../../dataSources/base/vroom/VroomDataRequestor","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._pendingRequests={};r._cachedMessages=null;r._vroomDataRequestor=n.vroomDataRequestor;return r}t.prototype.getMessages=function(e){var n=this;void 0===e&&(e=!1);var r=this._getApiUrl()+"/messages";if(this._pendingRequests[r])return this._pendingRequests[r];if(null!=this._cachedMessages&&!e)return i.default.wrap(this._cachedMessages);var u={apiName:t.API_NAME,path:r,requestType:"GET",useAuthorizationHeaders:!0},a=new s.Qos({name:"InAppMessaging.GetMessages"}),f=this._vroomDataRequestor.send(u).then(function(e){delete n._pendingRequests[r];var t=e.messageIds;n._cachedMessages=t;a.end({resultType:s.ResultTypeEnum.Success,extraMetrics:{count:t.length}});return t},function(e){delete n._pendingRequests[r];a.end({resultType:s.ResultTypeEnum.Failure,resultCode:o.getResultCodeFromError(e),extraData:o.getQosExtraDataFromError(e)});return i.default.wrapError(e)});this._pendingRequests[r]=f;return f};t.prototype.markMessagesAsRead=function(e){if(0===e.length)return i.default.wrap();var n=this._getApiUrl()+"/messages",r={messageIds:e},u=new s.Qos({name:"InAppMessaging.MarkMessagesAsRead",extraMetrics:{count:e.length}}),a={apiName:t.API_NAME,path:n,requestType:"POST",postData:JSON.stringify(r),useAuthorizationHeaders:!0};this._cachedMessages=null;return this._vroomDataRequestor.send(a).then(function(){u.end({resultType:s.ResultTypeEnum.Success})},function(e){u.end({resultType:s.ResultTypeEnum.Failure,resultCode:o.getResultCodeFromError(e),extraData:o.getQosExtraDataFromError(e)});return i.default.wrapError(e)})};t.prototype._getApiUrl=function(){var e=u.default.getVroomBaseUrl(),t=e.lastIndexOf("/v1.0");-1!==t&&(e=e.substring(0,t));return e+="/inappmessaging/v1"};t.dependencies=n.__assign({},r.default.dependencies,{vroomDataRequestor:a.resourceKey});t.API_NAME="inAppMessaging";return t}(r.default);t.default=l;t.resourceKey=f.createResolvedResourceKey(e("module").id,l)});
define("odsp-next/models/inAppMessaging/MessagingType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})});
define("odsp-next/providers/inAppMessaging/InAppMessagingProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","../../models/inAppMessaging/MessagingTypeHelper","../../providers/engagement/Engagement","../../dataSources/inAppMessaging/odc/InAppMessagingDataSource.key","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.dataSource=n.inAppMessagingDataSource;r._userInfoDataSource=n.userInfoDataSource;r._engagement=n.engagement;return r}t.prototype.getPremiumUpsellType=function(){return this._getMessages().then(function(e){var t=e.map(function(e){return o.convertInAppMessageToPremiumUpsellType(e)}).filter(function(e){return void 0!==e});if(0!==t.length)return t[0]})};t.prototype.isNewUser=function(){return this.isAnyMessageActive(206)};t.prototype.markMessagesRead=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.dataSource.markMessagesAsRead(e)};t.prototype.markMessagesReadIfPresent=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this._getMessages().then(function(n){var r=t.filter(function(e){return-1!==n.indexOf(e)});return e.dataSource.markMessagesAsRead(r)})};t.prototype.isAnyMessageActive=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._getMessages().then(function(t){for(var n=0,r=t;n<r.length;n++)for(var i=r[n],s=0,o=e;s<o.length;s++){if(i===o[s])return!0}return!1})};t.prototype.areAllMessagesNotActive=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._getMessages().then(function(t){for(var n=0,r=t;n<r.length;n++){for(var i=r[n],s=!1,o=0,u=e;o<u.length;o++){if(i===u[o]){s=!0;break}}if(s)return!1}return!0})};t.prototype.logLightboxPositioningAttributionEvent=function(e){var t="unknown",n="ExistingPos";switch(e){case 1:t="PositioningStandard";break;case 101:t="PositioningStandard";n="FREPos";break;case 2:t="PositioningNew";n="FREPos";break;case 3:t="PositioningExisting";break;case 5:t="NewFeature";break;case 6:t="NewFeaturePremium"}this._logValidation(n,t)};t.prototype.logFREShownForValidation=function(){this._logValidation("ShowFRE")};t.prototype._logValidation=function(e,t){void 0===t&&(t=null);this._engagement.logData({name:"PositioningValidation."+e+"."+(t?t+".":"")+"iam"})};t.prototype._getMessages=function(e){void 0===e&&(e=!1);return this._userInfoDataSource.isAuthenticated()?this.dataSource.getMessages():i.default.wrap([])};t.dependencies=n.__assign({},r.default.dependencies,{inAppMessagingDataSource:a.resourceKey,engagement:u.resourceKey,userInfoDataSource:f.userInfo});return t}(r.default);t.default=l;t.resourceKey=s.createResolvedResourceKey(e("module").id,l)});