define("odsp-next/actions/OdcExecutors",["require","exports","./createFolder/odc/CreateFolderExecutor","./delete/odc/DeleteExecutor","./download/odc/DownloadExecutor","./download/DownloadItemsOperator","./embed/odc/EmbedExecutor","./emptyRecycleBin/odc/EmptyRecycleBinExecutor","./launchMoveCopyPanel/LaunchMoveCopyPanelExecutor","./userActivity/odc/UserActivityExecutor","./rename/odc/RenameExecutor","./setPhotosRoot/odc/SetPhotosRootExecutor","./reportAbuse/odc/ReportAbuseExecutor","./removeFromSharedList/odc/RemoveFromSharedListExecutor","./requestReview/odc/RequestReviewExecutor","./restoreAll/odc/RestoreAllExecutor","./save/SaveExecutor","./setAlbumCoverPhoto/odc/SetAlbumCoverPhotoExecutor","./showOperations/ShowOperationsExecutor","./showPermissions/ShowPermissionsExecutor","./showSuggestedFiles/ShowSuggestedFilesExecutor","./showVersionHistoryAction/ShowReactVersionHistoryExecutor","./switchPhotoFolderLayoutType/odc/SwitchPhotoFolderLayoutTypeExecutor","./addToAlbum/odc/AddToAlbumExecutor","./applyOfficeLens/odc/ApplyOfficeLensExecutor","./removeOfficeLens/odc/RemoveOfficeLensExecutor","./addToBundle/odc/AddToBundleExecutor","./feedback/odc/FeedbackExecutor","./createAlbumFromFolder/odc/CreateAlbumFromFolderExecutor","./orderPrints/odc/OrderPrintsExecutor","./showKeyboardMap/ShowKeyboardMapExecutor","./redeemCode/odc/RedeemCodeExecutor","./editTags/odc/EditTagsExecutor","./shareByLink/odc/ShareByLinkExecutor","./addPhotosToAlbum/AddPhotosToAlbumExecutor","./createAlbum/CreateAlbumExecutor","./printPdf/odc/PrintPdfExecutor","./saveAutoAlbum/odc/SaveAutoAlbumExecutor","./discardAutoAlbum/odc/DiscardAutoAlbumExecutor","./addToFolder/odc/AddToFolderExecutor","./vault/odc/VaultExecutor","./downloadZipContents/odc/DownloadZipContentsAction","./moveCopy/odc/MoveCopyAction","./createNewFolder/odc/CreateNewFolderAction"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})});
define("odsp-next/actions/createFolder/odc/CreateFolderExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/ItemRedeemer","../CreateFolderHelper","../../../resources/ProviderResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._item=t.item;n.name=t.actionName;n._forceRedeem=!n.resources.consume(o.userInfo).isAuthenticated();n._itemReedemer=new(n.managed(i.default));n._createFolderHelper=new(n.managed(s.default));return n}t.prototype.execute=function(){var e=this;return this._itemReedemer.redeemItem(this._item,this,this._forceRedeem).then(function(){return e._createFolderHelper.showDialog({maxNameLength:255,supportInlineSharing:!1})})};return t}(r.default);t.default=u});
define("odsp-next/actions/createFolder/CreateFolderHelper",["require","exports","tslib","knockout","../../utilities/icons/Icon","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/string/StringHelper","../../controls/commands/Commands.resx","../../providers/dialog/DialogProvider","../../resources/ControlResourceKeys","../../controls/folderBuilder/FolderBuilder","./CreateFolderOperator","../../controls/folderBuilder/FolderBuilder.resx","@ms/odsp-utilities/lib/object/ObjectUtil","../../controls/sharing/share/commands/ShareCommandKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._dialogProvider=n.resources.consume(f.resourceKey);n._currentItem=n.resources.consume(l.currentItem);n._actionMap=n.resources.consume(l.actionMap);n._createdFolder=n.createObservable(null);return n}t.prototype.showDialog=function(e){var t=this,n=e.maxNameLength,s=e.supportInlineSharing,f=void 0!==s&&s,l=e.isCreateShareableFolder,m=void 0!==l&&l,g=this.observables.create(""),y=this.observables.create(""),b=this.observables.create(!1),w=this.observables.create(!0),E=this.observables.create(!0),S=this.observables.create([]),x=this.observables.create(""),T=this.observables.create(!0),N=m?a.strings.CreateSharedFolder:a.strings.CreateFolder,C=m?a.strings.ContinueToShare:a.strings.CreateCommit,k=m?"createSharedFolderDialog":"createFolderDialog";return this._dialogProvider.requestDialog({title:N,component:{name:c.default.tagName,params:{name:g,automationId:k,status:y,hasError:b,isEnabled:w,maxNameLength:n,hasFocus:E,supportInlineSharing:f,selectedPeople:S,sharingNote:x,statusVisible:T}},actions:[{name:C,execute:function(){T(!1);var e={tasks:null};d.extend(e,r);e.tasks.runEarly();y(a.strings.CreateFolderCollapsed);T(!0);w(!1);b(!1);return t.resources.consumeAsync(h.typeResourceKey).then(function(e){var n=new e({parent:t._currentItem.peek(),folderName:g(),sharingNote:x(),selectedPeople:S().filter(function(e){return e.isResolved}),needItemDetails:!0,createdFolder:t._createdFolder});return t.trackPromise(n.start())}).then(function(){b(!1);w(!0);T(!1);var e=u.format(p.strings.CreateFolderSuccess,g());y(e);T(!0);return 2},function(e){b(!0);T(!1);t.async.setTimeout(function(){b(!0);w(!0);E(!0);y(e.message);T(!0)},200);return 1})},isAvailable:this.observables.pureCompute(function(){return!!g()&&w()}),isDefault:!0,icon:new i.default("Save"),automationId:k+"Commit"}]}).wait().then(function(){if(m){new(t.managed(t._actionMap.ShowShareAction))({focusItemResourceKey:v.shareFocusItemResourceKey,overrideItem:t._createdFolder(),scenarioId:"CreateSharedFolder"}).execute(event)}return{resultType:o.ResultTypeEnum.Success}})};return t}(s.default);t.default=m});
define("odsp-next/controls/folderBuilder/FolderBuilder",["require","exports","./FolderBuilderViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FolderBuilder.html","./FolderBuilder.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-folder-builder",template:e("./FolderBuilder.html"),viewModel:n.default});t.default=i});
define("odsp-next/controls/folderBuilder/FolderBuilderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./FolderBuilder.resx","../peoplePicker/PeoplePicker","knockout"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.namePlaceholder=i.strings.FolderNamePlaceholder;n.nameLabel=i.strings.FolderNameLabel;n.addEditors=i.strings.AddEditors;n.editorsLabel=i.strings.EditorsLabel;n.editorsDescription=i.strings.EditorsDescription;n.editorsNotePlaceholder=i.strings.EditorsNotePlaceholder;n.peoplePickerTagName=s.default.tagName;n.name=t.name;n.status=t.status||o.observable("");n.hasError=t.hasError||o.observable(!1);n.isEnabled=t.isEnabled||o.observable(!0);n.hasFocus=t.hasFocus||o.observable(!0);n.maxNameLength=t.maxNameLength;n.statusVisible=t.statusVisible||o.observable(!0);n.supportInlineSharing=t.supportInlineSharing;n.sharingNote=t.sharingNote;n.selectedPeople=t.selectedPeople;n.peoplePickerParams={selectedPeople:n.selectedPeople,peoplePickerQueryParams:void 0};n.areSharingFieldsVisible=o.observable(!1);return n}t.prototype.onAddEditorsClicked=function(){this.areSharingFieldsVisible(!0)};return t}(r.default);t.default=u});
define("odsp-next/controls/folderBuilder/FolderBuilder.html",[],function(){return'<div class=od-FolderBuilder><div class=od-TextField><input class="od-FolderBuilder-nameInput od-TextField-field" type=text data-bind="value: name, textInput: name, hasFocus: hasFocus, attr: { placeholder: namePlaceholder, maxlength: maxNameLength, \'aria-invalid\': hasError, \'aria-label\': nameLabel }, automation: automationId, css: { \'od-FolderBuilder-nameInput--error\': hasError }, enable: isEnabled">\x3c!--ko if: supportInlineSharing--\x3e<button class="od-FolderBuilder-addEditorsButton od-Button" data-bind="visible: !areSharingFieldsVisible(), click: onAddEditorsClicked, text: addEditors"></button><div class=od-FolderBuilder-sharingFields data-bind="visible: areSharingFieldsVisible"><label class="od-FolderBuilder-editorsLabel od-Label" data-bind="text: editorsLabel"></label><div class=od-FolderBuilder-peoplePicker data-bind="component: { name: peoplePickerTagName, params: peoplePickerParams }"></div><div><textarea class=od-FolderBuilder-noteInput data-bind="value: sharingNote, attr: { placeholder: editorsNotePlaceholder, maxlength: 4000 }"></textarea></div></div><div class="od-FolderBuilder-sharingDescription ms-font-s" data-bind="text: editorsDescription"></div>\x3c!--/ko--\x3e</div><div class=od-FolderBuilder-status role=alert aria-live=polite aria-relevant=text data-bind="visible: statusVisible, text: status, css: { \'od-FolderBuilder-status--error\': hasError }"></div></div>'});
define("odsp-next/controls/folderBuilder/FolderBuilder.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-FolderBuilder-status{margin-top:12px;font-size:12px;font-weight:400;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-FolderBuilder-status--error{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:";word-wrap:break-word}.od-FolderBuilder-input--error{border-color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"!important}.od-FolderBuilder-sharingFields{margin-top:20px}.od-FolderBuilder-addEditorsButton.od-Button{margin-top:20px}.od-FolderBuilder-sharingDescription{margin-top:5px}.od-FolderBuilder-peoplePicker .PeoplePicker-resolvedItem-persona .od-Persona-emailText{display:none}.od-FolderBuilder-peoplePicker .AutoFill{min-width:100%;max-width:100%}.od-FolderBuilder-noteInput{height:80px;width:100%;box-sizing:border-box;border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";overflow-y:auto;padding:5px;margin:10px 0 5px 0}"}])});
define("odsp-next/actions/createFolder/CreateFolderOperator",["require","exports","tslib","../../providers/operator/BaseOperator","../../providers/fileSystem/FileSystemProvider","../../models/operation/OperationType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.createdFolder,s=void 0===i?r.createObservable():i;r._context=t;r._fileSystemProvider=n.fileSystemProvider;r._payloads={createFolder:{parent:t.parent,createdFolder:s}};return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input,i=this._context.parent;n.type=s.default.createFolder;n.name=r;n.iconName=i.iconName;n.payloads=this._payloads;n.visibility=2;t.output&&this._payloads.createFolder.createdFolder(t.output);return n};t.prototype.onStart=function(e){return this._fileSystemProvider.createFolder(this._context,e)};t.dependencies=n.__assign({},r.default.dependencies,{fileSystemProvider:i.resourceKey});return t}(r.default);t.default=u;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,u)});
define("odsp-next/providers/fileSystem/FileSystemProvider",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../dataSources/item/DeletionType","../../dataSources/item/ItemTaskObserver","../../models/store/ItemsStore","@ms/odsp-utilities/lib/resources/Resources","../item/ItemProvider","../quota/UserStateProvider.key","../../models/itemsScope/ItemsScopeFeature.key","../../models/task/Task","../../resources/DataSourceResourceKeys","../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/graft/Graft"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(){function e(e,t){this._itemDataSource=t.itemDataSource;this._deleteRestoreDataSource=t.deleteRestoreDataSource;this._itemProvider=t.itemProvider;this._itemTaskObserver=new t.itemTaskObserverType;this._photoProvider=t.photoProvider;this._store=t.itemsStore;this._tagProvider=t.tagProvider;this._updateQuota=t.updateQuota;this._isItemsScopeEnabled=t.isItemsScopeEnabled;this._resources=t.resources}e.prototype.createFolder=function(e,t){var n=this,r=e.parent.key,i=e.folderName,s=new h.default(r+"&cf="+i,i);return this._performOperation([r],t,s,function(){return n._itemDataSource.createFolder(e)})};e.prototype.renameItem=function(e,t){var n=this,r=e.item,i=r.key,s=new h.default(i,r);return this._performOperation([e.parentKey,i],t,s,function(){return n._itemDataSource.renameItem(e)})};e.prototype.deleteItems=function(e,t){return this._handleDeleteOrRestore(e,t,this._handleDelete)};e.prototype.restoreItems=function(e,t){return this._handleDeleteOrRestore(e,t,this._handleRestore)};e.prototype.restoreAll=function(e){var t=this;return this._deleteRestoreDataSource.restoreAll(e).then(function(){t._itemProvider.invalidateItem(e.parentKey);t._updateQuota(!0);return!0})};e.prototype._handleDelete=function(e){var t=this,n=this._itemProvider;return this._deleteRestoreDataSource.deleteItems(e).then(function(r){var i;e.deletionType===s.default.Recycle&&(i={triggerFetch:!1,emptyAllOtherSets:!0});n.invalidateItem(e.parentKey,i);var o=e.items.map(function(e){return new h.default(e.key).succeed({item:{key:e.key,parentKey:v.remove()}})}),u=t._itemTaskObserver;u.update(o);u.flush();return r})};e.prototype._handleRestore=function(e){var t=this;return this._deleteRestoreDataSource.restoreItems(e).then(function(n){var r=i.deserializeQuery(e.parentKey);delete r.view;var s=i.serializeQuery(r);t._itemProvider.invalidateItem(s,{emptyAllOtherSets:!0});t._isItemsScopeEnabled&&t._resources.consumeAsync(p.itemInvalidator).then(function(e){e.invalidateItems(s)});return n})};e.prototype._handleDeleteOrRestore=function(e,t,n){var r=this,i={},s=e.items.map(function(e){return i[e.id]=new h.default(e.key,e)}),o=this._itemProvider;t.update(s);return n.call(this,e).then(function(n){for(var i=0,o=e.items;i<o.length;i++){var u=o[i];r._invalidatePhoto(u)}r._store.invalidateAllPhotos();r._invalidateAllTags();s=s.map(function(e){return e.succeed()});t.update(s)},function(n){o.invalidateItem(e.parentKey);var r=n.data&&n.data.items||[];s=[];for(var u=0,a=r;u<a.length;u++){var f=a[u],l=i[f.id];delete i[f.id];s.push(f.error?l.fail(f.error):l.succeed())}for(var c in i){l=i[c];s.push(l.cancel())}t.update(s)}).then(function(){r._updateQuota(!0)})};e.prototype._invalidatePhoto=function(e){var t=i.deserializeQuery(e.key);delete t.qt;this._store.invalidateItem(i.serializeQuery(t));if(e.tags)for(var n=0,r=e.tags;n<r.length;n++){var s=r[n];this._store.invalidateLocation(s.tag)}};e.prototype._invalidateAllTags=function(){var e=this._photoProvider,t=this._tagProvider;if(e&&t){var n=e.getAllPhotosSettings().peek();t.invalidateAllTags(n.rootId)}};e.prototype._performOperation=function(e,t,r,i){var s=this;t.update([r]);return i().then(function(n){for(var i=0,o=e;i<o.length;i++){var u=o[i];s._itemProvider.invalidateItem(u)}t.update([r.succeed(n)])},function(e){var i=new Error(e);t.update([r.fail(i)]);return n.default.wrapError(i)})};e.dependencies={itemDataSource:p.items,deleteRestoreDataSource:p.deleteRestore,itemProvider:f.resourceKey,itemsStore:u.resourceKey,itemTaskObserverType:o.resourceKey,photoProvider:d.photo.optional,tagProvider:d.tag.optional,updateQuota:l.resourceKey,isItemsScopeEnabled:c.isItemsScopeEnabledResourceKey,resources:a.resourceScopeKey};return e}();t.default=m;t.resourceKey=r.createResolvedResourceKey(e("module").id,m)});
define("odsp-next/actions/delete/odc/DeleteExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../base/ItemRedeemer","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../dataSources/item/DeletionType","../DeleteExecutor","../../../controls/commands/Commands.resx","../DeleteExecutor.resx","@ms/odsp-utilities/lib/string/StringHelper","../../../dataSources/url/odc/UrlDataSource","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../providers/dialog/DialogProvider","../../../utilities/features/Features","../../../controls/htmlContainer/HTMLContainer","../../../utilities/icons/Icon"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name=t.actionName;n._itemReedemer=new(n.managed(s.default));n._urlDataSource=n.resources.consume(h.resourceKey);n._navigation=n.resources.consume(p.navigation);return n}t.prototype.getDeleteExecutionInfo=function(e){var t,n,r=this.currentItem.queryType,i=u.default.Recycle;if(this._urlDataSource.isRecycleBin(r)){i=u.default.PermanantDelete;t=this._getRecycleBinDialogText(e);n=f.strings.recycleBinDeleteConfirmTitle}else if(0!==e[0].sharingRole)if(1===e.length){t=f.strings.deleteSharedSingleItem;n=f.strings.deleteSharedSingleItemPromptTitle}else{t=f.strings.deleteSharedMultipleItems;n=f.strings.deleteSharedMultipleItemPromptTitle}else if(v.isFeatureEnabled(v.DeleteConfirmDialogODC)){var s=e&&1===e.length&&e[0].name;n=s?c.format(f.strings.deleteConfirmTitleWithFileName,s):f.strings.deleteConfirmTitle;t=e&&e.length>1?l.strings.deleteMultiConfirmDescription:l.strings.deleteConfirmDescription}return{text:t,title:n,type:i,allowUndo:!0,emptyRecycleBin:!1}};t.prototype.executeDelete=function(t){var n=this,i=t.length;t.forEach(function(e){if(e.vault&&e.vault.root){n._vaultDeleteDialog(i);t=[]}});return t.length<1?r.default.resolve({resultType:o.ResultTypeEnum.ExpectedFailure,resultCode:"VaultDeleteNotExecuted",extraMetrics:{count:i}}):this._itemReedemer.redeemItems(t,this).then(function(){return e.prototype.executeDelete.call(n,t)})};t.prototype._vaultDeleteDialog=function(e){var t=this,n=this.resources.consume(d.resourceKey),s=l.strings.DisableVaultTextBatchDeleteParagraph1+"<p>"+l.strings.DisableVaultTextBatchDeleteParagraph2+"</p>",o=n.requestDialog({title:l.strings.DisableVaultTitle,component:{name:m.default.tagName,params:{html:e>1?s:l.strings.DisableVaultText}},actions:[{name:l.strings.DisableVaultSettings,execute:function(){return t._onVaultSettingsClick()},isAvailable:this.observables.create(!0),icon:new g.default("CheckMark"),isDefault:!0},{name:l.strings.DisableVaultCancel,execute:function(){i.Engagement.logData({name:"Vault.Delete.ConfirmationDialog.Cancelled"});return r.default.resolve(3)},isAvailable:this.observables.create(!0),icon:new g.default("Cancel")}]});i.Engagement.logData({name:"Vault.Delete.ConfirmationDialog.Shown"});o.wait().catch(function(){3===o.state.peek()&&i.Engagement.logData({name:"Vault.Delete.ConfirmationDialog.Dismissed"})})};t.prototype._onVaultSettingsClick=function(){i.Engagement.logData({name:"Vault.Delete.GoToSettings"});this._navigation.navigateTo({url:this._urlDataSource.getManageVaultUrl()});return r.default.resolve(3)};t.prototype._getRecycleBinDialogText=function(e){return 1===e.length?c.format(f.strings.recycleBinDeleteConfirmTextSingleSelection,e[0].name):f.strings.recycleBinDeleteConfirmTextMultiSelection};return t}(a.default);t.default=y});
define("odsp-next/actions/delete/DeleteExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../utilities/icons/Icon","@ms/odsp-shared/lib/base/BaseModel","../../models/item/ItemType","../../dataSources/item/DeletionType","@ms/odsp-utilities/lib/logging/events/Qos.event","../../controls/commands/Commands.resx","../../providers/dialog/DialogProvider","../../controls/textContainer/TextContainer","./DeleteItemsOperator","../../resources/DataSourceResourceKeys","../../models/itemsScope/ItemsScopeFeature.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.selectionHelper=t.selectionHelper;n.currentItem=t.currentItem;n.dialogProvider=n.resources.consume(l.resourceKey);return n}t.prototype.execute=function(e){var t=this;return this.currentItem?this.selectionHelper.resolveSelection().then(function(e){return e?t.executeDelete(e):t._getFailedQosData()}):r.default.wrap(this._getFailedQosData())};t.prototype.getDeleteExecutionInfo=function(e){return null};t.prototype.executeDelete=function(e){var t=this,n=this.getDeleteExecutionInfo(e);return(n.title?this._getConfirmationDialog(n):r.default.wrap()).then(function(){return t._executeDelete(e,n)})};t.prototype._getFailedQosData=function(){return{resultType:a.ResultTypeEnum.Failure,extraMetrics:{count:0}}};t.prototype._executeDelete=function(e,t){var n=this;this.selectionHelper.clearSelection();this.resources.consume(d.isItemsScopeEnabledInAllPhotosPivotResourceKey)&&this.resources.consumeAsync(p.itemInvalidator).then(function(t){for(var n=0,r=e;n<r.length;n++){var i=r[n];i.id&&t.invalidatePhotoAsDeleted(i.id)}});return this.resources.consumeAsync(h.typeResourceKey).then(function(r){var i=new r({items:e,deletionType:t.type,allowUndo:t.allowUndo,emptyRecycleBin:t.emptyRecycleBin,parentKey:n.currentItem.key});n.trackPromise(i.start());return i.wait()}).then(function(){var n={deletionType:u.default[t.type]},r={count:e.length};if(1===e.length){n.fileType=o.default[e[0].type];n.extension=e[0].extension||""}return{resultType:a.ResultTypeEnum.Success,extraData:n,extraMetrics:r}})};t.prototype._getConfirmationDialog=function(e){return this.dialogProvider.requestDialog({title:e.title,component:{name:c.default.tagName,params:{text:e.text}},actions:[{name:f.strings.DeleteItem,execute:function(){return r.default.wrap(2)},isAvailable:this.observables.create(!0),icon:new i.default("Delete"),isDefault:!1},{name:f.strings.cancelActionText,execute:function(){return r.default.wrap(3)},isAvailable:this.observables.create(!0),icon:new i.default("Cancel"),isDefault:!0}],focusOnPrimaryAction:!0}).wait()};return t}(s.default);t.default=v});
define("odsp-next/actions/delete/DeleteItemsOperator",["require","exports","tslib","../../models/task/Task","../../models/task/TaskObserver","../../providers/operator/BaseOperator","../../models/operation/OperationType","../../providers/fileSystem/FileSystemProvider","../../dataSources/item/DeletionType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,{},n)||this;r._fileSystemProvider=n.fileSystemProvider;r._context=t;r.registerActions({undo:r._onUndo,deleteLocked:r._onDeleteLocked});return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input.item;n.name=r.name;n.iconName=r.iconName;n.type=2===t.input.type?o.default.restoreItems:o.default.deleteItems;n.payloads.deleteItems={item:r,parent:r.parent};n.payloads.restoreItems={item:r};this._context.allowUndo&&this._canUndoItem(r)&&0===t.input.type&&1===t.status&&n.actions.push(this._onUndo);2===t.status&&t.error&&9001===t.error.code&&n.actions.push(this._onDeleteLocked);return n};t.prototype.onStart=function(e){var t=this._context.deletionType===a.default.PermanantDelete?1:0,n=this._context.overrideLock,i=this._context.items.map(function(e){return new r.default(e.key,{item:e,type:t,isOverride:n})});e.update(i);return this._fileSystemProvider.deleteItems({items:this._context.items,deletionType:this._context.deletionType,overrideLock:n,parentKey:this._context.parentKey,emptyRecycleBin:this._context.emptyRecycleBin},c(e,t,n))};t.prototype._canUndoItem=function(e){return!e.isAlbum};t.prototype._onDeleteLocked=function(e,t){e=e.map(function(e){return e.restart().changeInput(function(e){return{item:e.item,type:e.type,isOverride:!0}})});t.update(e);var n=e[0].input,r=n.type,i=n.isOverride;return this._fileSystemProvider.deleteItems({items:e.map(function(e){return e.input.item}),deletionType:this._context.deletionType,overrideLock:!0,parentKey:this._context.parentKey},c(t,r,i))};t.prototype._onUndo=function(e,t){e=e.map(function(e){return e.restart().changeInput(function(e){return{item:e.item,type:2,isOverride:!1}})});t.update(e);var n=e[0].input,r=n.type,i=n.isOverride;return this._fileSystemProvider.restoreItems({items:e.map(function(e){return e.input.item}),parentKey:this._context.parentKey,retainAcls:!0},c(t,r,i))};t.dependencies=n.__assign({},s.default.dependencies,{fileSystemProvider:u.resourceKey});return t}(s.default);t.default=l;function c(e,t,n){return i.default.map(e,function(e){return e.changeInput(function(e){return{item:e,type:t,isOverride:n}})})}t.typeResourceKey=f.createResolvedTypeResourceKey(e("module").id,l)});
define("odsp-next/actions/download/odc/DownloadExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../DownloadExecutor","../../../providers/dialog/DialogProvider","../../../controls/textContainer/TextContainer","../../../utilities/features/Features","../../../actions/odc/DownloadAction.resx","../../../resources/ODCResourceKeys","../../../models/item/ItemType","@ms/odsp-utilities/lib/object/ObjectUtil","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/logging/ErrorHelper","@ms/odsp-datasources/lib/utilities/permissions/Identity","cookies","../../../controls/downloadAsZip/DownloadAsZip"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=window.FilesConfig,g=m&&m.df?"s":"p",y=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(f.urlDataSource);n._identityDataSource=n.resources.consume(h.identity);return n}t.prototype.execute=function(t,n){var i=this;return this.selectionHelper.resolveSelection().then(function(s){if(s){var o=i._urlDataSource.getAuthKeyParamValue(),a=s.length>1||s[0].type===l.default.Folder;n.data.extraData||(n.data.extraData={});if(a&&u.isFeatureEnabled(u.DownloadAsZip)&&!i.isOneDriveWinApp){var f="",y=0,b=0,w=s.filter(function(e){return e}).map(function(e){if(e){var t=e.type===l.default.Folder;t&&b++;e.type===l.default.OneNote&&y++;var n=i._getDownloadUrl(e,t,o);f+=n;return{name:e.name+e.extension,size:e.size,docId:n,isFolder:t}}});c.extend(n.data.extraData,{oneNotesCount:y,filesCount:s.length-b,foldersCount:b});if(!w)return;var E=m&&m.appId,S="https://southcentralus1-media"+g+".svc.ms​​​/transform/zip?cs=V2VifE9EQw==";return e.prototype.executeVroomDownload.call(i,{itemsData:w,docIds:f,zipApiUrl:S,provider:"url",method:"POST",appId:E,loggingEvent:n})}if(a||s[0].vault||!u.isFeatureEnabled(u.VroomSingleFileDownload)&&!i.isOneDriveWinApp)return e.prototype.execute.call(i,t,n);var x=s[0].name+s[0].extension;(i.isOneDriveWinApp?r.default.resolve(i._getDownloadUrl(s[0],!1,o)):r.default.resolve(i.resources.consumeAsync(h.graph).then(function(e){var t="SingleFileDownload",n=!!v.get("BadgerAuth");n&&(t+=".PasswordProtected");return e.getDownloadUrl(s[0],{useDirectEndpoint:!0,apiName:t,qosExtraData:{isAuthenticated:i._identityDataSource.getIdentity().type!==d.IdentityType.anonymous,isPasswordProtected:n,fileExtension:s[0].extension||""}})}))).then(function(t){return e.prototype.executeVroomDownload.call(i,{itemsData:null,docIds:t,zipApiUrl:t,provider:"",method:"Get",appId:"",loggingEvent:n,fileDisplayName:x||""})}).catch(function(r){p.default.log(r);return e.prototype.execute.call(i,t,n)})}})};t.prototype.onPreDownloadItems=function(e){if(1===e.length&&e[0].type!==l.default.Folder)return r.default.wrap(!0);for(var t=0,n=0,i=e.length;n<i&&t<107374182400;n++)e[n]&&(t+=e[n].size);if(t>=107374182400){this.resources.consume(s.resourceKey).requestDialog({title:a.strings.NewSizeLimitError,component:{name:o.default.tagName,params:{text:""}}});return r.default.wrap(!1)}return r.default.wrap(!0)};t.prototype._getDownloadUrl=function(e,t,n){var r=this._urlDataSource.getApiBaseUrl(),i=e.graph&&e.graph.driveId&&e.graph.itemId?r+"/drives/"+e.graph.driveId+"/items":r+"/drive/items",s=r+"/shares",o="";if(FilesConfig.SuiteNavConfig&&FilesConfig.SuiteNavConfig.IsAuthenticated&&!n)o=i+"/"+e.id;else{var u="https://onedrive.live.com/redir?resid="+e.id;u+=n?"&authKey="+n:"";o=s+"/u!"+(o=window.btoa(u).replace("=","").replace("+","-").replace("/","_"))+"/root"}return o+(t?"":"/content")};return t}(i.default);t.default=y});
define("odsp-next/actions/download/DownloadExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../models/item/ItemType","@ms/odsp-utilities/lib/logging/events/Qos.event","../../providers/dialog/DialogProvider","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../providers/hiddenDom/HiddenDomProvider","../../providers/sessionManagement/SessionManagementProvider","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../utilities/features/Features","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/guid/Guid","../../providers/pushChannel/PushChannelProvider.key","../../providers/oAuthToken/OAuthTokenProvider","../../dataSources/microserviceEndPoint/MicroserviceEndPointDataSource.key","../../utilities/browser/WebViewDetector","../../providers/winApp/communication/WinAppCommunicator.key","@ms/utilities-error/lib/ApiError","../../models/winApp/communication/IWinAppCommunicator"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.downloadItemsOperatorTypeResourceKey=new d.ResourceKey({name:e("module").id,loader:new d.AliasResourceLoader(function(){return r.default.resolve(new Promise(function(t,n){e(["./DownloadItemsOperator"],t,n)})).then(function(e){return e.typeResourceKey})})});var x=function(e){n.__extends(i,e);function i(t){var n=e.call(this,t)||this;n._sessionManagementProvider=n.resources.consume(c.resourceKey.optional);n._platform=n.resources.consume(f.platformDetection);n._oAuthTokenProvider=n.resources.consume(g.resourceKey.optional);n._navigation=n.resources.consume(h.navigation);n._hiddenDomProvider=n.resources.consume(l.resourceKey);n.selectionHelper=t.selectionHelper;n.currentItem=t.currentItem;n.dialogProvider=n.resources.consume(u.resourceKey);n.isOneDriveWinApp=b.isOneDriveWinApp();return n}i.prototype.execute=function(e,t){var n,i=this,u=this.selectionHelper.selection;n={items:u.peek().map(function(e){return e.peek()})};return this.onPreDownloadItems(n.items).then(function(e){if(e){if(i.isOneDriveWinApp){1===n.items.length&&n.items[0].type!==s.default.Folder?i.resources.consumeAsync(a.download).then(function(e){var t=n.items[0];e.getDownloadUrl(t,{downloadType:0}).then(function(e){i.resources.consumeAsync(w.resourceKey).then(function(n){var r={command:"Download",type:S.WinAppDownloadType.DownloadSingleFile,downloadUrl:e,zipFileName:t.name};n.sendCommand({command:JSON.stringify({DownloadCommand:r})})})})}):i.resources.consumeAsync(a.download).then(function(e){e.getDownloadZipRequest(n).then(function(e){i.resources.consumeAsync(w.resourceKey).then(function(t){t.sendCommand({command:e})})})});return{resultType:o.ResultTypeEnum.Success}}return i.resources.consumeAsync(a.download).then(function(e){return e.downloadItems(n).then(function(){var e={},t={count:n.items.length};if(1===n.items.length){e.fileType=s.default[n.items[0].type];e.extension=n.items[0].extension||""}return{resultType:o.ResultTypeEnum.Success,extraData:e,extraMetrics:t}})})}return r.default.wrap({resultType:o.ResultTypeEnum.ExpectedFailure})})};i.prototype.executeVroomDownload=function(e){var t=this,n=e.itemsData,r=e.docIds,s=e.zipApiUrl,o=e.provider,u=(e.method,e.appId),a=(e.loggingEvent,e.fileDisplayName);if(!(i.doc_ids===r&&Date.now()-i.last_download<5e3)){i.last_download=Date.now();i.doc_ids=r;var f=function(){return t._doDownload(n,r,s,o,null,null,u,a||"")};if(n&&-1!==n[0].docId.indexOf("access_token")||"spo"===o&&this._oAuthTokenProvider)try{return this.resources.consumeAsync(y.resourceKey).then(function(e){return e.getMicroServiceEndPoints("media")}).then(function(e){return t._oAuthTokenProvider.getToken(e,!0)}).then(function(e){return t._doDownload(n,r,s,o,null,e,u,a||"")},f)}catch(e){return f()}return this._sessionManagementProvider.getToken().then(function(e){return t._doDownload(n,r,s,o,e,null,u,a||"")},function(e){if(e instanceof E.ApiError&&"unauthUser"===e.code)return f()})}};i.prototype.onPreDownloadItems=function(e){return r.default.wrap(!0)};i.prototype._doDownload=function(e,t,n,r,i,s,o,u){return e?this._completeDownloadasZip(e,n,r,i,s,o):this._completeDownloadFile(n,i,u)};i.prototype._completeDownloadFile=function(e,t,n){e+=t?"?access_token="+t.accessToken:"";this.isOneDriveWinApp&&this.resources.consumeAsync(w.resourceKey).then(function(t){var r={command:"Download",type:S.WinAppDownloadType.DownloadSingleFile,downloadUrl:e,zipFileName:n};t.sendCommand({command:JSON.stringify({DownloadCommand:r})})});if(this._platform.isMobile){this._navigation.navigateTo({url:e,frameId:"_self"});return r.default.wrap({resultType:o.ResultTypeEnum.Success})}if(this._platform.isIE){this._downloadForIE("od-download-tab",e);return r.default.wrap({resultType:o.ResultTypeEnum.Success})}var i=Math.random(),s=this._getDownloadIframe(i);document.body.appendChild(s);s.src=e;this.async.setTimeout(function(){s.remove()},2e4);return r.default.wrap({resultType:o.ResultTypeEnum.Success})};i.prototype._completeDownloadasZip=function(e,n,r,s,u,a){var f=this;i.zip_count++;var l=v.default.generate(),c="OneDrive_"+i.zip_count+"_"+(new Date).toLocaleDateString().replace(/\//g,"-").replace(/[^ -~]/g,"")+".zip";e&&1===e.length&&(c=e[0].name+".zip");return this.resources.consumeAsync(m.resourceKey.optional).then(function(i){var h,d=i&&i.getNotificationUrl()||"";d&&p.isFeatureEnabled(p.DownloadNotifications)&&f.resources.consumeAsync(t.downloadItemsOperatorTypeResourceKey).then(function(e){var t=new e({items:[],guid:l,zipFileName:c});f.trackPromise(t.start());t.wait()});var v=2e4;if(f._platform.isIE){h=f._downloadForIE("od-download-tab");v=5e3}if(f.isOneDriveWinApp){var m={files:JSON.stringify({items:e}),notificationUrlValue:d,guid:l,provider:r,zipFileName:c,oAuthToken:u||"",accessToken:s&&s.accessToken||"",appId:a},g={command:"Download",type:S.WinAppDownloadType.DownloadMultiFile,downloadUrl:n,zipFileName:c,postBody:JSON.stringify({request:m})};f.resources.consumeAsync(w.resourceKey).then(function(e){e.sendCommand({command:JSON.stringify({DownloadCommand:g})})});return{resultType:o.ResultTypeEnum.Success}}var y=Math.random(),b=f._getDownloadIframe(y),E=f._hiddenDomProvider.requestControl({name:"od-downloadaszip",params:{filesValue:JSON.stringify({items:e}),notificationUrlValue:d,guid:l,formAction:n,providerValue:r,id:y,zipFileName:c,target:f._platform.isIE?"od-download-tab":b.id,oAuthToken:u||"",accessToken:s&&s.accessToken||"",appId:a||"",resources:f.resources}}),x=document.getElementById("form_download_as_zip"+y);x.parentNode.appendChild(b);x.submit();var T=f.addDisposable({dispose:function(){f._hiddenDomProvider.disposeControl(E)}});f.async.setTimeout(function(){T.dispose();h&&h.close()},v);return{resultType:o.ResultTypeEnum.Success}})};i.prototype._getDownloadIframe=function(e){var t=document.createElement("iframe");t.id="od-download-iframe"+e;t.name=t.id;t.hidden=!0;return t};i.prototype._downloadForIE=function(e,t){void 0===t&&(t="");var n;n=window.open(t,e);this.async.setTimeout(function(){n.close()},5e3);return n};i.zip_count=0;return i}(i.default);t.default=x});
define("odsp-next/providers/oAuthToken/OAuthTokenProvider",["require","exports","tslib","../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-datasources/lib/providers/oAuthToken/OAuthTokenProvider","@ms/odsp-datasources/lib/dataSources/oAuthToken/OAuthTokenDataSource","@ms/odsp-datasources/lib/providers/oAuthToken/OAuthTokenProvider","whatwg-fetch"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(u,t);t.oAuthTokenDataSourceKey=new i.ResourceKey({name:e("module").id+".dataSource",factory:{dependencies:{pageContext:r.pageContext},create:function(e){var t=new o.default(e.pageContext);return{instance:t,disposable:t}}}});t.resourceKey=i.createResolvedResourceKey(e("module").id,s.default,{oAuthTokenDataSource:t.oAuthTokenDataSourceKey})});
define("@ms/odsp-datasources/lib/providers/oAuthToken/OAuthTokenProvider",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","whatwg-fetch"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.InteractionRequired=10013]="InteractionRequired"}(t.TokenFetchServerErrorCodes||(t.TokenFetchServerErrorCodes={}));var i=function(){function e(e,t){void 0===e&&(e={});this._dataSource=t.oAuthTokenDataSource}e.prototype.getToken=function(e,t){var i=new r.Qos({name:"getToken"});return this._dataSource.getToken(e,t).then(function(e){i.end({resultType:r.ResultTypeEnum.Success});return e},function(e){i.end({resultType:r.ResultTypeEnum.Failure});return n.default.reject(e)})};e.prototype.getInstrumentedToken=function(e,t){var i=new r.Qos({name:"getToken"});return this._dataSource.getInstrumentedToken(e,t).then(function(e){i.end({resultType:r.ResultTypeEnum.Success});return e},function(e){i.end({resultType:r.ResultTypeEnum.Failure});return n.default.reject(e)})};return e}();t.default=i});
define("whatwg-fetch",["require","exports","module"],function(e,t,n){!function(e){"use strict";if(!e.fetch){var t={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{new Blob;return!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(t.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=function(e){return e&&DataView.prototype.isPrototypeOf(e)},i=ArrayBuffer.isView||function(e){return e&&n.indexOf(Object.prototype.toString.call(e))>-1};l.prototype.append=function(e,t){e=u(e);t=a(t);var n=this.map[e];this.map[e]=n?n+","+t:t};l.prototype.delete=function(e){delete this.map[u(e)]};l.prototype.get=function(e){e=u(e);return this.has(e)?this.map[e]:null};l.prototype.has=function(e){return this.map.hasOwnProperty(u(e))};l.prototype.set=function(e,t){this.map[u(e)]=a(t)};l.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)};l.prototype.keys=function(){var e=[];this.forEach(function(t,n){e.push(n)});return f(e)};l.prototype.values=function(){var e=[];this.forEach(function(t){e.push(t)});return f(e)};l.prototype.entries=function(){var e=[];this.forEach(function(t,n){e.push([n,t])});return f(e)};t.iterable&&(l.prototype[Symbol.iterator]=l.prototype.entries);var s=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];m.prototype.clone=function(){return new m(this,{body:this._bodyInit})};v.call(m.prototype);v.call(b.prototype);b.prototype.clone=function(){return new b(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new l(this.headers),url:this.url})};b.error=function(){var e=new b(null,{status:0,statusText:""});e.type="error";return e};var o=[301,302,303,307,308];b.redirect=function(e,t){if(-1===o.indexOf(t))throw new RangeError("Invalid status code");return new b(null,{status:t,headers:{location:e}})};e.Headers=l;e.Request=m;e.Response=b;e.fetch=function(e,n){return new Promise(function(r,i){var s=new m(e,n),o=new XMLHttpRequest;o.onload=function(){var e={status:o.status,statusText:o.statusText,headers:y(o.getAllResponseHeaders()||"")};e.url="responseURL"in o?o.responseURL:e.headers.get("X-Request-URL");var t="response"in o?o.response:o.responseText;r(new b(t,e))};o.onerror=function(){i(new TypeError("Network request failed"))};o.ontimeout=function(){i(new TypeError("Network request failed"))};o.open(s.method,s.url,!0);"include"===s.credentials&&(o.withCredentials=!0);"responseType"in o&&t.blob&&(o.responseType="blob");s.headers.forEach(function(e,t){o.setRequestHeader(t,e)});o.send(void 0===s._bodyInit?null:s._bodyInit)})};e.fetch.polyfill=!0}function u(e){"string"!=typeof e&&(e=String(e));if(/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function a(e){"string"!=typeof e&&(e=String(e));return e}function f(e){var n={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};t.iterable&&(n[Symbol.iterator]=function(){return n});return n}function l(e){this.map={};e instanceof l?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function c(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function h(e){return new Promise(function(t,n){e.onload=function(){t(e.result)};e.onerror=function(){n(e.error)}})}function p(e){var t=new FileReader,n=h(t);t.readAsArrayBuffer(e);return n}function d(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);t.set(new Uint8Array(e));return t.buffer}function v(){this.bodyUsed=!1;this._initBody=function(e){this._bodyInit=e;if(e)if("string"==typeof e)this._bodyText=e;else if(t.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(t.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(t.arrayBuffer&&t.blob&&r(e)){this._bodyArrayBuffer=d(e.buffer);this._bodyInit=new Blob([this._bodyArrayBuffer])}else{if(!t.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!i(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=d(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))};if(t.blob){this.blob=function(){var e=c(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))};this.arrayBuffer=function(){return this._bodyArrayBuffer?c(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(p)}}this.text=function(){var e=c(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,n=h(t);t.readAsText(e);return n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)};t.formData&&(this.formData=function(){return this.text().then(g)});this.json=function(){return this.text().then(JSON.parse)};return this}function m(e,t){var n,r,i=(t=t||{}).body;if(e instanceof m){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url;this.credentials=e.credentials;t.headers||(this.headers=new l(e.headers));this.method=e.method;this.mode=e.mode;if(!i&&null!=e._bodyInit){i=e._bodyInit;e.bodyUsed=!0}}else this.url=String(e);this.credentials=t.credentials||this.credentials||"omit";!t.headers&&this.headers||(this.headers=new l(t.headers));this.method=(n=t.method||this.method||"GET",r=n.toUpperCase(),s.indexOf(r)>-1?r:n);this.mode=t.mode||this.mode||null;this.referrer=null;if(("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function g(e){var t=new FormData;e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}});return t}function y(e){var t=new l;e.split(/\r?\n/).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}});return t}function b(e,t){t||(t={});this.type="default";this.status="status"in t?t.status:200;this.ok=this.status>=200&&this.status<300;this.statusText="statusText"in t?t.statusText:"OK";this.headers=new l(t.headers);this.url=t.url||"";this._initBody(e)}}("undefined"!=typeof self?self:this)});
define("@ms/odsp-datasources/lib/dataSources/oAuthToken/OAuthTokenDataSource",["require","exports","tslib","../../utilities/oauthUtility/OAuthUtility","../base/DataSource","@ms/odsp-utilities/lib/async/Promise","../../interfaces/ISpPageContext","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){this._qos=new u.default({name:"OAuthTokenDataSource"})}e.prototype.writeSuccess=function(){this._qos.end({resultType:u.ResultTypeEnum.Success})};e.prototype.writeUnexpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:u.ResultTypeEnum.Failure,error:JSON.stringify(t)})};e.prototype.writeExpectedFailure=function(e,t){this._qos.end({resultCode:e,resultType:u.ResultTypeEnum.ExpectedFailure,error:JSON.stringify(t)})};return e}(),f=function(){function e(){}e.prototype.logWarning=function(e){};e.prototype.logError=function(e){};return e}(),l=function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,{},{pageContext:t})||this;i.logger=new f;if(n){n.logger&&(i.logger=n.logger);n.useAbsoluteUrlForOAuth&&(i._useAbsoluteUrlForOAuth=n.useAbsoluteUrlForOAuth)}i._oAuthUtility=new r.default(i);return i}t.prototype.qosMonitor=function(){return new a};Object.defineProperty(t.prototype,"webUrl",{get:function(){return this._useAbsoluteUrlForOAuth?this._pageContext.webAbsoluteUrl:o.getSafeWebServerRelativeUrl(this._pageContext)},enumerable:!0,configurable:!0});t.prototype.fetchWithDigest=function(e){var t=this;return e.text().then(function(n){var r=e.headers.get("Content-Type");e.headers.delete("Content-Type");return t._odspPromiseToEs6Promise(t.getData(function(){return e.url},function(e,t){return new Response(e,{status:t.getStatus(),headers:t.getResponseHeadersDictionary()})},"DelegationTokenDataSource",function(){return n},"POST",t._getRequestHeadersDictionary(e),r).then(function(e){return e},function(e){return new Response(JSON.stringify(e),{status:e.status})}))})};t.prototype.getToken=function(e,t){t&&this._oAuthUtility.clearCachedToken(e);return this._es6PromiseToOdspPromise(this._oAuthUtility.getOAuthToken(e,this.webUrl).then(function(e){return e.token}))};t.prototype.getInstrumentedToken=function(e,t){t&&this._oAuthUtility.clearCachedToken(e);return this._es6PromiseToOdspPromise(this._oAuthUtility.getInstrumentedOAuthToken(e,this.webUrl))};t.prototype._getRequestHeadersDictionary=function(e){var t=e.headers,n={};t.forEach(function(e,t){n[t]=e});return n};t.prototype._odspPromiseToEs6Promise=function(e){return new Promise(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})};t.prototype._es6PromiseToOdspPromise=function(e){return new s.default(function(t,n){e.then(function(e){t(e)},function(e){n(e)})})};return t}(i.default);t.default=l});
define("@ms/odsp-datasources/lib/utilities/oauthUtility/OAuthUtility",["require","exports","./Constants","./OAuthUtilityError"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){var t=this;this._context=e;this._dispose=this._dispose.bind(this);window.addEventListener("unload",this._dispose);window._spPageOnMediaTokenReceived=function(){t._receiveMediaServiceFlushedToken()};window._spMSBTLoaded=function(){t._receiveMediaServiceFlushedToken()}}e._getCorrelationId=function(e){return e.headers.get("sprequestguid")};e._extractRealError=function(e){return e.hasOwnProperty("error")?e.error:e};e.prototype.getOAuthToken=function(e,t){return this.getInstrumentedOAuthToken(e,t).then(function(e){if(e)return e.tokenInfo})};e.prototype.getInstrumentedOAuthToken=function(e,t){var r=this;this._receiveMediaServiceFlushedToken();var i=this._getCachedTokenData(e);if(i&&!this._isExpiring(i)){var s={token:i.accessToken,isGuest:!1,expirationTimeMs:i.expiresOn};return Promise.resolve({tokenInfo:s,spRequestId:i.correlationId,spRequestTimestamp:i.requestTimestamp})}return this._retriableFetchWithDigest(e,n.default.retries,t).then(function(t){r._storeTokenData(e,t);return{tokenInfo:{token:t.accessToken,isGuest:!1,expirationTimeMs:t.expiresOn},spRequestId:t.correlationId,spRequestTimestamp:t.requestTimestamp}})};e.prototype.clearCachedToken=function(e){var t=this._getCacheKey(e);window.sessionStorage.removeItem(t);var n=this._resourceKeys.indexOf(t);!isNaN(n)&&n>-1&&this._resourceKeys.splice(n)};Object.defineProperty(e.prototype,"_resourceKeys",{get:function(){this._keysToDispose||(this._keysToDispose=new Array);return this._keysToDispose},enumerable:!0,configurable:!0});e.prototype._retriableFetchWithDigest=function(t,n,i){var s=this,o=this._context.qosMonitor(),u=Date.now();return this._context.fetchWithDigest(this._buildTokenRequest(t,i)).then(function(a){if(200!==a.status){s._context.logger.logError("fetchWithDigest failed. Server responded with "+a.statusText);var f=new r.default(r.OAuthUtilityErrorType.unknownError,{httpResponseStatus:a.status,message:a.statusText,correlationId:e._getCorrelationId(a)});if(400!==a.status){o.writeUnexpectedFailure("UnknownError",f);return Promise.reject(f)}return a.json().then(function(r){var u=e._extractRealError(r),a=s._getErrorCodeFromResponseCode(u);if(!s._isRetriableError(a)||0===n){var f=s._buildErrorFromResponse(u);o.writeUnexpectedFailure("SharepointServerError",f);return Promise.reject(f)}s._context.logger.logError("fetchWithDigest failed. Retrying. Retries left: "+n);return s._retriableFetchWithDigest(t,n-1,i)})}return s._instrumentedParseResponseData(a,o,u)})};e.prototype._getCachedTokenData=function(e){return JSON.parse(window.sessionStorage.getItem(this._getCacheKey(e)))};e.prototype._storeTokenData=function(e,t){window.sessionStorage.setItem(this._getCacheKey(e),JSON.stringify(t))};e.prototype._getCacheKey=function(e){var t=["sp-client-shared",n.default.npmPackageVersion,"OAuthUtility",e].join(";");-1===this._resourceKeys.indexOf(t)&&this._resourceKeys.push(t);return t};e.prototype._isExpiring=function(e){return e.expiresOn-Date.now()/1e3<n.default.aboutToExpireIntervalSeconds};e.prototype._isRetriableError=function(e){return-1!==n.default.retriableErrorCodes.indexOf(e)};e.prototype._buildTokenRequest=function(e,t){var r=new Headers;r.append("Content-Type","application/json; charset=utf-8");r.append("Odata-Version","4.0");r.append("Accept","application/json;odata.metadata=minimal");var i={method:"POST",headers:r,body:JSON.stringify(this._buildRequestBody(e))},s=t;s&&s.lastIndexOf("/")===s.length-1&&(s=s.substr(0,s.length-1));return new Request(s+n.default.apiUrl,i)};e.prototype._buildRequestBody=function(e){return{resource:e}};e.prototype._buildErrorFromResponse=function(e){var t,i,s=this._getErrorCodeFromResponseCode(e);if(void 0===s)return new r.default(r.OAuthUtilityErrorType.malformedResponseBody,{httpResponseStatus:400,message:n.default.unexpectedErrorCodeFormat,correlationId:e.correlationId});if(e.message)if("string"==typeof e.message)t=e.message;else{t=e.message.value;i=e.message.lang}return new r.default(r.OAuthUtilityErrorType.serverError,{httpResponseStatus:400,message:t,cultureName:i,serverErrorCode:s,correlationId:e.correlationId,redirectUrl:e["error.redirectUrl"]||e["@error.redirectUrl"]})};e.prototype._getErrorCodeFromResponseCode=function(e){var t=e.code,n=Number(t);if(isNaN(n)&&"string"==typeof e.message){var r=t.indexOf(",");-1!==r&&(n=Number(t.substr(0,r)))}return n};e.prototype._instrumentedParseResponseData=function(t,i,s){try{return t.json().then(function(n){i.writeSuccess();return{accessToken:n.access_token,expiresOn:Number(n.expires_on),notBefore:Number(n.not_before),resource:n.resource,tokenType:n.token_type,correlationId:e._getCorrelationId(t),requestTimestamp:s}})}catch(s){i.writeUnexpectedFailure("ResponseParseError",s);return Promise.reject(new r.default(r.OAuthUtilityErrorType.malformedResponseBody,{httpResponseStatus:200,message:n.default.unexpectedTokenMessageFormat,correlationId:e._getCorrelationId(t)}))}};e.prototype._dispose=function(e){window.removeEventListener("unload",this._dispose);for(var t=0,n=this._resourceKeys;t<n.length;t++){var r=n[t];window.sessionStorage.removeItem(r)}};e.prototype._receiveMediaServiceFlushedToken=function(){if(window._spMSBT){var e={tokenType:window._spMSBT.TokenType,expiresOn:window._spMSBT.ExpiresOn,notBefore:void 0,resource:window._spMSBT.Resource,accessToken:window._spMSBT.AccessToken};this._storeTokenData(e.resource,e);window._spMSBT=void 0}};return e}();t.default=i});
define("@ms/odsp-datasources/lib/utilities/oauthUtility/Constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}e.tokenCacheSessionStorageId="tokenCache";e.aboutToExpireIntervalSeconds=600;e.apiUrl="/_api/SP.OAuth.Token/Acquire";e.retries=3;e.retriableErrorCodes=[10006,10008];e.unexpectedErrorCodeFormat="Expected error code format is <numericCode>, <exception class name>";e.unexpectedTokenMessageFormat="Your token request succeedeed but the token could not be parsed from the response.This is most probably caused by a change in the server response format";e.npmPackageVersion="0.1.5";return e}();t.default=n});
define("@ms/odsp-datasources/lib/utilities/oauthUtility/OAuthUtilityError",["require","exports","tslib"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e[e.unknownError=0]="unknownError";e[e.malformedResponseBody=1]="malformedResponseBody";e[e.serverError=2]="serverError"}(r=t.OAuthUtilityErrorType||(t.OAuthUtilityErrorType={}));var i=function(e){n.__extends(t,e);function t(n,r){var i=e.call(this,r.message)||this;i.__proto__=t.prototype;i._type=n;i._httpResponseStatus=r.httpResponseStatus;i._cultureName=r.cultureName;i._message=r.message;i._serverErrorCode=r.serverErrorCode;i._correlationId=r.correlationId;i._redirectUrl=r.redirectUrl;return i}Object.defineProperty(t.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"serverErrorCode",{get:function(){if(this.type!==r.serverError)throw new Error("ServerErrorCode can only be obtained for errors of type serverError");return this._serverErrorCode},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"httpResponseStatus",{get:function(){return this._httpResponseStatus},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"message",{get:function(){return this._message},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"cultureName",{get:function(){return this._cultureName},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"correlationId",{get:function(){return this._correlationId},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"redirectUrl",{get:function(){return this._redirectUrl},enumerable:!0,configurable:!0});return t}(Error);t.default=i});
define("@ms/odsp-datasources/lib/dataSources/base/DataSource",["require","exports","tslib","./DataRequestor"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){var i=this._pageContext=t.pageContext,s=t.dataRequestorType,o=void 0===s?function(e){n.__extends(t,e);function t(t){return e.call(this,t,{pageContext:i})||this}return t}(r.default):s,u=e.dataSourceName,a=void 0===u?"DataSource":u;this.dataSourceName=a;this.dataRequestor=new o({qosName:a})}e.prototype.needsRequestDigest=function(e){return!0};e.prototype.getData=function(e,t,n,r,i,s,o,u,a,f,l,c,h){void 0===i&&(i="POST");var p=e();return this.dataRequestor.getData({url:p,parseResponse:t,qosName:n,qosHandler:l,customQosLogger:c,additionalPostData:r&&r(),method:i,additionalHeaders:s,contentType:o,maxRetries:u,noRedirect:a,qosExtraData:h,crossSiteCollectionCall:f,needsRequestDigest:this.needsRequestDigest(p)})};return e}();t.DataSource=i;t.default=i});
define("odsp-next/dataSources/microserviceEndPoint/MicroserviceEndPointDataSource.key",["require","exports","tslib","@ms/odsp-datasources/lib/dataSources/microServiceEndPoint/MicroServiceEndPointDataSource","@ms/odsp-utilities/lib/resources/Resources","../../resources/SPOResourceKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t,n){return e.call(this,n.pageContext)||this}return t}(r.default);t.resourceKey=i.createResolvedResourceKey(e("module").id,o,{pageContext:s.pageContext})});
define("@ms/odsp-datasources/lib/dataSources/microServiceEndPoint/MicroServiceEndPointDataSource",["require","exports","tslib","../base/DataSource"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(t){return e.call(this,{dataSourceName:"MicroServiceEndPointDataSource"},{pageContext:t})||this}t.prototype.getMicroServiceEndPoints=function(e){var t=this._pageContext.webAbsoluteUrl+"/_api/microservicemanager/getserviceurls?service='"+e+"'";return this.dataRequestor.getData({url:t,method:"GET",qosName:"GetServiceUrls"}).then(function(e){return e&&e.d&&e.d.GetServiceUrls&&e.d.GetServiceUrls.results&&e.d.GetServiceUrls.results[0]})};return t}(r.default);t.default=i});
define("odsp-next/controls/downloadAsZip/DownloadAsZip",["require","exports","./DownloadAsZipViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./DownloadAsZip.html","./DownloadAsZip.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-downloadaszip",template:e("./DownloadAsZip.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/downloadAsZip/DownloadAsZipViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.formAction=t.formAction;n.filesValue=t.filesValue;n.providerValue=t.providerValue;n.id="form_download_as_zip"+t.id;n.notificationUrlValue=t.notificationUrlValue;n.accessToken=t.accessToken;n.zipFileName=t.zipFileName;n.target=t.target;n.oAuthToken=t.oAuthToken;n.guid=t.guid;n.method=t.method||"Post";n.appId=t.appId;return n}return t}(r.default);t.default=i});
define("odsp-next/controls/downloadAsZip/DownloadAsZip.html",[],function(){return'<div id=od-Download-As-Zip class=od-DownloadAsZip><form class=DownloadAsZipForm name=form_download_as_zip data-bind="attr: { action: formAction, target: target, id: id, method: method}"><input id=download_input_1 name=provider type=hidden data-bind="value: providerValue"> <input id=download_input_2 name=guid type=hidden data-bind="value: guid"> <input id=download_input_3 name=files type=hidden data-bind="value: filesValue"> <input id=download_input_4 name=notificationUrl type=hidden data-bind="value: notificationUrlValue"> <input id=download_input_5 name=accessToken type=hidden data-bind="value: accessToken"> <input id=download_input_6 name=zipFileName type=hidden data-bind="value: zipFileName"> <input id=download_input_7 name=oAuthToken type=hidden data-bind="value: oAuthToken"> <input id=download_input_8 name=appId type=hidden data-bind="value: appId"></form></div>'});
define("odsp-next/controls/downloadAsZip/DownloadAsZip.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-DownloadAsZip{visibility:hidden}"}])});
define("odsp-next/actions/download/DownloadItemsOperator",["require","exports","tslib","../../providers/operator/BaseOperator","../../providers/pushChannel/IPushChannelProvider","../../models/operation/OperationType","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","../../providers/pushChannel/PushChannelProvider.key","../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l;!function(e){e[e.Success=0]="Success";e[e.RemoteHostClosedConnection_HttpException=1]="RemoteHostClosedConnection_HttpException";e[e.FileAndFolderDownloadError=2]="FileAndFolderDownloadError";e[e.FolderDownloadError=3]="FolderDownloadError";e[e.FileDownloadError=4]="FileDownloadError"}(l=t.ZipPayloadErrorCode||(t.ZipPayloadErrorCode={}));var c=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._context=t;r._pushChannelProvider=n.pushChannelProvider;return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t);n.type=s.default.downloadAsZip;var r=t.input;n.name=r.name;t.output&&t.output.current>=0&&(n.progress={current:t.output.current,minimum:0,maximum:t.output.maximum});n.payloads={downloadAsZip:{fileName:this._context.zipFileName}};f.isOneDriveWinApp()&&(n.visibility=2);return n};t.prototype.onStart=function(e){var t=this;if(!this._pushChannelProvider)return o.default.wrap();var n=new r.Task("OverAllProgress",{key:this._context.guid}),s=[n=n.changeOutput(function(e){return{zipFileName:t._context.zipFileName}})];e.update(s);this._pushChannelProvider.setupNotificationHandler({source:i.NotificationSource.Meta,scenarios:[i.NotificationScenario.Zip],id:this._context.guid},function(n){if("ZipProgress"===n.type&&s&&t._context.guid===n.guid){s=s.map(function(e){if("OverAllProgress"===e.key){e=e.changeOutput(function(e){return{current:n.filesProcessed,maximum:n.totalFiles,zipFileName:t._context.zipFileName}});n.isComplete&&n.errorCode===l[l.RemoteHostClosedConnection_HttpException]?e=e.cancel():n.isComplete&&(e=e.succeed())}return e});e.update(s)}});return o.default.wrap()};t.dependencies=n.__assign({},r.default.dependencies,{pushChannelProvider:a.resourceKey.optional});return t}(r.default);t.default=c;t.typeResourceKey=u.createResolvedTypeResourceKey(e("module").id,c)});
define("odsp-next/actions/embed/odc/EmbedExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/ItemRedeemer","./EmbedHelper"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._helper=new(n.managed(s.default));n.name=t.actionName;n._selectionHelper=t.selectionHelper;n._itemReedemer=new(n.managed(i.default));return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveFirst().then(function(t){return e._itemReedemer.redeemItem(t,e).then(function(){return e._helper.shareItem(t)})})};return t}(r.default);t.default=o});
define("odsp-next/actions/embed/odc/EmbedHelper",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../utilities/icons/Icon","@ms/odsp-shared/lib/base/BaseModel","../../../models/item/SharingType","../../../resources/ODCResourceKeys","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/string/StringHelper","../../../providers/panel/PanelProvider","../../../controls/embedBuilder/EmbedBuilder","../../../providers/dialog/DialogProvider","../../../controls/embedBuilder/EmbedBuilder.resx","../../../controls/textContainer/TextContainer"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(u.urlDataSource);n._dialogProvider=n.resources.consume(h.resourceKey);n._panelProvider=n.resources.consume(l.resourceKey);return n}t.prototype.shareItem=function(e){return e.isSpecialFolder&&e.sharingType!==o.default.Public?this._showWarningDialog(e):this._showEmbedDialog(e)};t.prototype._showWarningDialog=function(e){var t=this,n={text:p.strings.specialFolderConfirmText},s=this._dialogProvider.requestDialog({title:p.strings.specialFolderConfirmTitle,size:"Medium",component:{name:d.default.tagName,params:n},actions:[{name:p.strings.specialFolderConfirmButton,execute:function(){return r.default.wrap(2)},isAvailable:this.observables.create(!0),icon:new i.default("Embed"),isDefault:!1}]});return s.wait().then(function(){2===s.state()&&t._showEmbedDialog(e);return{resultType:a.ResultTypeEnum.Success}})};t.prototype._showEmbedDialog=function(e){var t=f.format(p.strings.title,e.name),n={item:e,embedPageUrl:this._urlDataSource.getEmbedPageUrl(e)};return this._panelProvider.requestPanel({title:t,component:{name:c.default.tagName,params:n}}).wait().then(function(){return{resultType:a.ResultTypeEnum.Success}})};return t}(s.default);t.default=v});
define("odsp-next/controls/embedBuilder/EmbedBuilder",["require","exports","./EmbedBuilderViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./EmbedBuilder.html","./EmbedBuilder.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-embed-builder",template:e("./EmbedBuilder.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/embedBuilder/EmbedBuilderViewModel",["require","exports","tslib","knockout","./EmbedBuilder.resx","../../providers/sharing/SharingProvider","../../utilities/icons/OfficeFileNameHelper","../../resources/ProviderResourceKeys","../../utilities/browser/ResponsiveUI","../../bindings/focus/SelectOnFocusBinding","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/string/StringHelper","../../bindings/autoResizeHeight/AutoResizeHeightBinding","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../utilities/logging/odc/UsageNames","@ms/odsp-utilities/lib/logging/events/UsageType","@ms/odsp-utilities/lib/uri/Uri","../../models/item/ItemType","../loadingSpinner/LoadingSpinner"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=function(e){this.name=e.name;this.maxDim=e.maxDim;this.isOriginalSize=e.isOriginalSize};t.EmbeddedImageSize=b;var w=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._item=t.item;n._embedPageUrl=t.embedPageUrl;n._thumbnailSizes=null;n._thumbnails=null;n._sharingProvider=n.resources.consume(s.resourceKey);n._embedProvider=n.resources.consume(u.embed);n._responsiveUI=n.resources.consume(a.resourceKey);n._thumbnailProvider=n.resources.consume(u.thumbnail);n._instrumentationProvider=n.resources.consume(u.instrumentation);n.isLoading=r.observable(!0);n.isHandlingError=r.observable(!1);n.isPicture=r.observable(!1);n.photoUrl=r.observable("");n.iframeSrc=r.observable("");n.embedIconImgSrc=window.require.toUrl("odsp-media/images/embedpanel/embed.svg");n.embedCode=r.observable("");n.embedCode.subscribe(n.onEmbedCodeChange.bind(n));n.embedCodeDisplayed=r.observable("");n.configuratorUrl=r.observable("");n.embedConfiguratorClickUsageName=d.UsageName.EmbedConfiguratorClick;n.featureCssWrapperClass="od-embed-useModernEmbedPanel";n.htmlTagsOn=r.observable(!1);n.htmlTagsOn.subscribe(n.onHtmlTagsClicked.bind(n));n.previewWidth=r.observable(n._getPreviewWidth());n.previewHeight=r.observable(n._getPreviewHeight());n.instructionsText=r.observable("");n.generateText=i.strings.generate;n.disclaimerText=i.strings.disclaimer;n.loadingText=i.strings.loading;n.embedErrorText=i.strings.error;n.configuratorText=i.strings.configurator;n.imageSizeText=i.strings.imageSizeLabel;n.copyText=i.strings.embedTextLabel;n.loadingSpinnerComponentTag=y.default.tagName;n.loadingSpinnerComponentParams={loadingText:n.loadingText};n.updateSpinnerComponentParams={loadingText:""};var o=0,l=!0;if(n._item.photo)if(n._item.photo.width>n._item.photo.height){o=n._item.photo.width;l=!0}else{o=n._item.photo.height;l=!1}n._populateImageSizes(o,l);n.selectedImageSize.subscribe(n.onImageSizeChange.bind(n));n.htmlTagsText=i.strings.includeHTMLTags;n.isEmbedCodeUpdating=r.observable(!1);n._embedCodeUpdatingSpinnerTimeout=-1;n._getEmbedInfo();n.addBindingHandlers({selectOnFocus:f.default,autoResizeHeight:h.default});return n}t._getThumbnailSizeForMaxDim=function(e,t){return t?{width:e}:{height:e}};t._getEmbedCode=function(e,t){return t?'<img src="'+e.url+'" width="'+e.width+'" height="'+e.height+'" />':e.url};t.prototype.onGenerateClicked=function(){var e=this;this.isLoading(!0);this.isHandlingError(!1);this._sharingProvider.manageSharingLinks([this._item],{type:3,role:1,create:!0}).then(function(){e._getEmbedInfo()},function(){e.isLoading(!1);e.isHandlingError(!0)})};t.prototype.onImageSizeChange=function(e){this._updateEmbedCode(e,this.htmlTagsOn(),!0)};t.prototype.onHtmlTagsClicked=function(e){this._updateEmbedCode(this.selectedImageSize(),e,!1)};t.prototype.onEmbedCodeChange=function(){-1!==this._embedCodeUpdatingSpinnerTimeout&&this.async.clearTimeout(this._embedCodeUpdatingSpinnerTimeout);this.isEmbedCodeUpdating(!0);this.embedCodeDisplayed("");this._embedCodeUpdatingSpinnerTimeout=this.async.setTimeout(function(){this.embedCodeDisplayed(this.embedCode());this.isEmbedCodeUpdating(!1)},500)};t.prototype.reportConfiguratorUsage=function(e){p.default.logData({name:d.UsageName[e],location:d.LocationName[d.LocationName.EmbedPane],usageType:v.UsageType[v.UsageType.Click],currentPage:this._instrumentationProvider.currentPageName(),previousPage:this._instrumentationProvider.previousPageName()});return!0};t.prototype._updateEmbedCode=function(e,n,r){var i=this._item.photo;if(i&&this._thumbnails){var s=null,o=i.width>i.height;s=e.isOriginalSize?this._thumbnailProvider.getThumbnailForSize(this._thumbnails,i.width,i.height):this._thumbnailProvider.getThumbnailForLargestDimension(this._thumbnails,e.maxDim,o);this.embedCode(t._getEmbedCode(s,n));if(r){this.photoUrl(s.url);var u=this._getPreviewWidth(),a=this._getPreviewHeight();this.previewWidth(Math.min(u,s.width));this.previewHeight(Math.min(a,s.height))}}};t.prototype._getPreviewWidth=function(e){var t=165,n=this._item.photo||this._item.video;if(n)t=n.width>n.height?Math.min(n.width,320):n.height<320?n.width:Math.floor(n.width/n.height*320);else if(this._item.appMap&&e)switch(this._item.appMap){case o.wordType:case o.excelType:case o.powerpointType:case o.visioType:t=320}var r=this._responsiveUI.formFactorSize();t>300&&"Small"===r&&(t=300);return t};t.prototype._getPreviewHeight=function(e){var t=150,n=this._item.photo||this._item.video;if(n)t=n.height>n.width?Math.min(n.width,320):n.width<320?n.height:Math.floor(n.height/n.width*320);else if(this._item.appMap&&e)switch(this._item.appMap){case o.wordType:t=288;break;case o.excelType:t=346;break;case o.powerpointType:case o.visioType:t=327}var r=this._responsiveUI.formFactorSize();t>300&&"Small"===r&&(t=300);return t};t.prototype._getEmbedInfo=function(){var e=this,t=this._getItemType();this._embedProvider.getEmbedInfo(this._item).then(function(n){if(e._item.type===g.default.Media&&e._item.photo)if(n){e.isPicture(!0);e.previewWidth(e._getPreviewWidth(!0));e.previewHeight(e._getPreviewHeight(!0));e._thumbnailProvider.getThumbnails(e._item.graph,e._thumbnailSizes,e._getAuthKeyFromEmbedUrl(n.embedUrl)).then(function(t){e.isLoading(!1);e._thumbnails=t;e._updateEmbedCode(e.selectedImageSize(),e.htmlTagsOn(),!0)})}else{e.isLoading(!1);e.instructionsText(i.strings["generateInstructions"+t])}else{e.isLoading(!1);if(n){e.embedCode(n.embedCode);n.embedUrl&&e.iframeSrc(n.embedUrl);if(n.configuratorUrl){e.configuratorUrl(n.configuratorUrl);e.reportConfiguratorUsage(d.UsageName.EmbedConfiguratorLinkShown)}e.previewWidth(e._getPreviewWidth(!0));e.previewHeight(e._getPreviewHeight(!0))}else{e.instructionsText(i.strings["generateInstructions"+t]);e.iframeSrc(e._embedPageUrl)}}})};t.prototype._getAuthKeyFromEmbedUrl=function(e){return new m.default(e).getQueryParameter("authkey")};t.prototype._getItemType=function(){var e="File";this._item.photo?e="Photo":this._item.isAlbum?e="Album":this._item.folder&&(e="Folder");return e};t.prototype._populateImageSizes=function(e,n){var s=[];this._thumbnailSizes=[];var o=this._item.photo?c.format(i.strings.imageSizeOriginal,e):null;s.push(new b({name:o,maxDim:e,isOriginalSize:!0}));this._item.photo&&this._thumbnailSizes.push(this._item.photo);for(var u=0;u<t.DEFUALT_EMBEDDED_IMAGES_SIZES.length;u++){var a=t.DEFUALT_EMBEDDED_IMAGES_SIZES[u];if(a.maxDim<e){s.push(a);this._thumbnailSizes.push(t._getThumbnailSizeForMaxDim(a.maxDim,n))}}this.imageSizes=r.observable(s);this.selectedImageSize=r.observable(this.imageSizes()[0])};t.DEFUALT_EMBEDDED_IMAGES_SIZES=[{name:i.strings.imageSizeLarge,maxDim:1024,isOriginalSize:!1},{name:i.strings.imageSizeMedium,maxDim:660,isOriginalSize:!1},{name:i.strings.imageSizeSmall,maxDim:256,isOriginalSize:!1}];return t}(l.default);t.default=w});
define("odsp-next/bindings/autoResizeHeight/AutoResizeHeightBinding",["require","exports","knockout"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.update=function(e,t,r,i,s){var o=n.utils.unwrapObservable(t());if(o.enabled){n.utils.unwrapObservable(o.elementContents);e.style.height="1px";var u=e.scrollHeight;o.additionalPadding&&(u+=o.additionalPadding);e.style.height=u+"px"}};return e}();t.default=r});
define("odsp-next/controls/embedBuilder/EmbedBuilder.html",[],function(){return'<div class=EmbedBuilder data-bind="css: featureCssWrapperClass">\x3c!--ko if: isLoading--\x3e<span class=ms-font-m data-bind="component: { name: loadingSpinnerComponentTag, params: loadingSpinnerComponentParams }"></span>\x3c!--/ko--\x3e\x3c!--ko if: isHandlingError()--\x3e<div class=od-embed-error><p class="od-embed-disclaimer ms-font-m ms-fontColor-neutralSecondary" data-bind="text: embedErrorText"></p></div>\x3c!--/ko--\x3e\x3c!--ko if: !isLoading()--\x3e\x3c!--ko if: !isHandlingError()--\x3e<div class=od-embed-preview>\x3c!--ko if: !embedCode()--\x3e<img data-bind="attr: { src: embedIconImgSrc }" class=od-embed-generateIcon tabindex=-1>\x3c!--/ko--\x3e\x3c!--ko if: embedCode()--\x3e\x3c!--ko if: !isPicture()--\x3e<iframe data-bind="attr: { src: iframeSrc }, style: { width: previewWidth() + \'px\', height: previewHeight() + \'px\' }" tabindex=-1 frameborder=0 scrolling=no></iframe>\x3c!--/ko--\x3e\x3c!--ko if: isPicture()--\x3e<img data-bind="attr: { src: photoUrl}, style: { width: previewWidth() + \'px\', height: previewHeight() + \'px\' }" tabindex=-1>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e<div class=od-embed-details>\x3c!--ko if: !embedCode()--\x3e<p class="od-embed-instructions ms-font-l" data-bind="text: instructionsText"></p><button class="od-Button od-embed-button od-Button--primary" data-bind="click: onGenerateClicked"><span class=od-Button-label data-bind="text: generateText"></span></button>\x3c!--/ko--\x3e\x3c!--ko if: embedCode()--\x3e\x3c!--ko if: isPicture()--\x3e<div class=od-embed-pictureOptions><h2 class="od-embed-imageSize ms-font-l" data-bind="text: imageSizeText"></h2><div><select class=od-embed-sizePicker data-bind="options: imageSizes, optionsText: \'name\', value: selectedImageSize"></select></div><div class="od-embed-htmlTagsBox od-CheckBox"><input type=checkbox class="od-embed-htmlTagsCheckbox od-CheckBox-input" id=od-embed-htmlTagsBox data-bind="checked: htmlTagsOn"> <label class="ms-font-m ms-fontColor-neutralSecondary od-CheckBox-field" for=od-embed-htmlTagsBox data-bind="css: {\'is-checked\': htmlTagsOn}"><span class=od-Label data-bind="text: htmlTagsText"></span></label></div><h2 class="od-embed-copyText ms-font-l"><span data-bind="text: copyText"></span><div class="od-embed-updateSpinner ms-font-m" data-bind="css: { \'od-embed-updateSpinnerOn\': isEmbedCodeUpdating }, component: { name: loadingSpinnerComponentTag, params: updateSpinnerComponentParams }"></div></h2></div>\x3c!--/ko--\x3e<div class="od-TextField od-TextField--multiline"><textarea class=od-TextField-field readonly aria-live=polite data-bind="value: embedCodeDisplayed, selectOnFocus: { isPermanent: true }, autoResizeHeight: { enabled: true, elementContents: embedCodeDisplayed, additionalPadding: 2 }"></textarea></div>\x3c!--/ko--\x3e<p class="od-embed-disclaimer ms-font-m ms-fontColor-neutralSecondary" data-bind="text: disclaimerText"></p>\x3c!--ko if: configuratorUrl()--\x3e<p><a class=od-embed-configurator target=_blank data-bind="text: configuratorText, attr: { href: configuratorUrl }, click: reportConfiguratorUsage.bind($data, embedConfiguratorClickUsageName)"></a></p>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/embedBuilder/EmbedBuilder.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-embed-useEmbedDialog .od-embed-details{display:inline-block;vertical-align:top}.od-embed-useEmbedDialog .od-embed-disclaimer{display:inline-block;margin-top:10px}.od-embed-useEmbedDialog .od-embed-textbox{padding:1px 5px 2px 10px;width:90%;text-overflow:ellipsis}html[dir=rtl] .od-embed-useEmbedDialog .od-embed-textbox{padding:1px 10px 2px 5px}.od-embed-useModernEmbedPanel .od-embed-preview{margin-top:20px}.od-embed-useModernEmbedPanel .od-embed-generateIcon{height:255px}.od-embed-useModernEmbedPanel .od-embed-instructions{margin-top:16px;margin-bottom:20px}.sm .od-embed-useModernEmbedPanel .od-embed-instructions{margin-top:11px;margin-bottom:15px}.od-embed-useModernEmbedPanel .od-embed-imageSize{margin-top:16px;margin-bottom:18px}.lg .od-embed-useModernEmbedPanel .od-embed-imageSize,.md .od-embed-useModernEmbedPanel .od-embed-imageSize,.sm .od-embed-useModernEmbedPanel .od-embed-imageSize{margin-bottom:13px}.sm .od-embed-useModernEmbedPanel .od-embed-imageSize{margin-top:11px;margin-bottom:8px}.od-embed-useModernEmbedPanel .od-embed-disclaimer{display:inline-block;margin-top:20px}.od-embed-useModernEmbedPanel .od-embed-configurator{font-size:14px}.od-embed-useModernEmbedPanel .od-embed-copyText{margin-top:0;margin-bottom:20px}.sm .od-embed-useModernEmbedPanel .od-embed-copyText{margin-bottom:10px}.od-embed-useModernEmbedPanel .od-embed-sizePicker{margin-bottom:20px}.lg .od-embed-useModernEmbedPanel .od-embed-sizePicker,.md .od-embed-useModernEmbedPanel .od-embed-sizePicker,.sm .od-embed-useModernEmbedPanel .od-embed-sizePicker{margin-bottom:15px}.sm .od-embed-useModernEmbedPanel .od-embed-sizePicker{margin-bottom:12px}.od-embed-useModernEmbedPanel .od-embed-htmlTagsBox{margin-bottom:20px}.od-embed-useModernEmbedPanel .od-embed-htmlTagsCheckbox{vertical-align:middle}.od-embed-useModernEmbedPanel .od-embed-updateSpinner{visibility:hidden}html[dir=ltr] .od-embed-useModernEmbedPanel .od-embed-updateSpinner{float:right}html[dir=rtl] .od-embed-useModernEmbedPanel .od-embed-updateSpinner{float:left}.od-embed-useModernEmbedPanel .od-embed-updateSpinnerOn{visibility:visible}"}])});
define("odsp-next/actions/emptyRecycleBin/odc/EmptyRecycleBinExecutor",["require","exports","tslib","../../../resources/ODCResourceKeys","../../delete/odc/DeleteExecutor","./EmptyRecycleBinHelper"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name=t.actionName;n._usePollGetItemsForDeletion=t.usePollGetItemsForDeletion;n._recycleBinItemDataSource=n.resources.consume(r.recycleBinDataSource);n._emptyRecycleBinHelper=new(n.managed(s.default));return n}t.prototype.execute=function(t){if(this._usePollGetItemsForDeletion){if(!this.currentItem||this._recycleBinItemDataSource.isLargeRecycleBin())return this._emptyRecycleBinHelper.emptyAll();this.selectionHelper.selectAll();return e.prototype.execute.call(this,t)}return this._emptyRecycleBinHelper.emptyAllAsync()};t.prototype.getDeleteExecutionInfo=function(t){var n=e.prototype.getDeleteExecutionInfo.call(this,t);n.emptyRecycleBin=!0;return n};return t}(i.default);t.default=o});
define("odsp-next/actions/launchMoveCopyPanel/LaunchMoveCopyPanelExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../base/ItemRedeemer","./LaunchMoveCopyPanelHelper"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name=t.actionName;n._isMove=t.isMove;n._selectionHelper=t.selectionHelper;n._itemReedemer=new(n.managed(i.default));n._launchMoveCopyPanelHelper=new(n.managed(s.default));return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveSelection().then(function(t){return e._itemReedemer.redeemItems(t,e).then(function(){return e._launchMoveCopyPanelHelper.launchPanel(t,e._isMove)})})};return t}(r.default);t.default=o});
define("odsp-next/actions/launchMoveCopyPanel/LaunchMoveCopyPanelHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../utilities/features/Features","../../controls/folderSelect/FolderSelect","../../controls/folderTree/FolderTree","@ms/odsp-utilities/lib/logging/events/Qos.event","../../providers/panel/PanelProvider","../../providers/engagement/Engagement","@ms/odsp-utilities/lib/list/ShortcutUtilities","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../controls/commands/Commands.resx"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(h.url);n._currentItem=n.resources.consume(c.currentItem);n._panelProvider=n.resources.consume(a.resourceKey);n._engagement=n.resources.consume(f.resourceKey);return n}t.prototype.launchPanel=function(e,t){this._logEngagement(e,t);var n=this._currentItem(),r=this.observables.create({items:e,parentKey:n.key,targetId:null,targetKey:null,cid:this._urlDataSource.getOwnerId(),group:n.isGroup?1:0,isAsync:!1,isMove:t}),a=t?p.strings.moveItemDialogTitle:p.strings.copyItemDialogTitle,f=t?p.strings.moveItemsDialogTitle:p.strings.copyItemsDialogTitle,l=1===e.length?a:f,c=i.isFeatureEnabled(i.MoveCopyFolderSelectionUX),h=c?s.default.tagName:o.default.tagName,d=c?"Action.LaunchMoveCopyPanel.UseFolderSelectUX":"Action.LaunchMoveCopyPanel.UseFolderTreeUX";d+=t?".Move":".Copy";this._engagement.logData({name:d,extraData:{ItemCount:null!==e?e.length:0}});var v=this._panelProvider.requestPanel({hasCommandBar:!c,scrollMode:c?"hidden":"auto",noTitle:!0,title:l,component:{name:h,params:{context:r,onComplete:function(){v.state(1)},title:l,resources:this.resources}}});return v.wait().then(function(){return{resultType:u.ResultTypeEnum.Success}})};t.prototype._logEngagement=function(e,t){var n=this._engagement,r=e.filter(function(e){return l.default.isShortcutItem(e)}).length;r>0&&(t?n.logData({name:"ShortcutLink.MoveInitiateAggregate",extraData:{count:r}}):n.logData({name:"ShortcutLink.CopyInitiateAggregate",extraData:{count:r}}))};return t}(r.default);t.default=d});
define("odsp-next/controls/folderSelect/FolderSelect",["require","exports","./FolderSelectViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FolderSelect.html","./FolderSelectContent.html","./FolderSelect.css","../overlays/anchor/AnchorOverlay","../fileNameWithIcon/FileNameWithIcon"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-folder-select",template:e("./FolderSelect.html"),viewModel:n.default,synchronous:!0});r.registerTemplate("od-folder-select-content",e("./FolderSelectContent.html"));t.default=i});
define("odsp-next/controls/folderSelect/FolderSelectViewModel",["require","exports","tslib","knockout","../../resources/ControlResourceKeys","../../actions/createFolder/odb/CreateFolderAction","../../resources/DataSourceResourceKeys","../../bindings/element/ElementBinding","../../providers/engagement/Engagement","@ms/odsp-utilities/lib/events/EventGroup","../../utilities/features/Features","../fileTypeIcon/FileTypeIcon","./FolderSelect.resx","../../providers/item/ItemProvider","../inlineCreateFolder/InlineCreateFolder","../infoBar/InfoBar","../../providers/suiteNav/SuiteNavProvider","../../models/item/ItemType","../../models/item/ItemParentHelper","../../dataSources/web/odb/WebDataSource.key","../../bindings/keyboard/KeyboardBinding","@ms/odsp-utilities/lib/locale/Locale","../loadingSpinner/LoadingSpinner","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/PromiseDebouncer","@ms/odsp-utilities/lib/logging/events/Qos.event","../../bindings/selection/SelectionBinding","../../models/selection/SelectionModel","../siteIcon/SiteIcon","../../bindings/stickyFooter/StickyFooterBinding","../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/string/StringHelper","../stillSpinning/StillSpinning","@ms/odsp-utilities/lib/logging/events/Verbose.event","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","../../dataSources/url/QueryType","@ms/odsp-datasources/lib/dataSources/siteHeader/AcronymAndColorDataSource","../../bindings/dismiss/DismissBinding","../../dataSources/url/odb/ItemUrlHelper","../../bindings/focus/DelayedHasFocusBinding","../../utilities/uri/EnvironmentHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var U=8,z=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.chooseDestination=h.strings.chooseDestination;n.placesAltText=h.strings.placesAltText;n.stillSpinningTagName=_.default.tagName;n.loadingSpinnerTagName=S.default.tagName;n.siteIconTagName=L.default.tagName;n.fileTypeIconTagName=c.default.tagName;n.inlineCreateFolderTagName=d.default.tagName;n.infoBarTagName=v.default.tagName;n._suiteNavProvider=n.resources.consume(m.resourceKey);var s=n._engagement=n.resources.consume(a.resourceKey);n.loading=r.observable(!0);n.loadingOneDrive=r.observable(!0);var f=new N.Qos({name:"MoveCopySelect.LaunchPane"});n.context=t.context;n.itemOne=n._createContentItem();n.itemTwo=n._createContentItem();n._itemOneUsedLast=!1;n.waitingForItem=r.observable(!1);n.addFolderFocused=r.observable(!1);n.useLocationFocused=r.observable(!1);n.packageTooBig=r.observable(!1);n.newFolderActive=r.observable(!0);n.isSingleItem=n.isFileInfoVisible(n.context.peek().items);n.isSingleItem&&(n.fileItem=n.context.peek().items[0]);n.top=r.observable("0px");n.left=r.observable("12px");n.chooseLocationText=n.context().isMove?h.strings.moveButtonLabel:h.strings.copyButtonLabel;n.chooseLocationButtonEnabled=r.observable(!0);n.onComplete=t.onComplete;n.newFolderItem=r.observable(null);n.newFolderItemFocused=r.observable(!1);n.showMinimalPackageWarning=r.observable(!0);n.createComputed(function(){if(n.newFolderItem()){var e=n.getCurrentItem();if(n.newFolderItem().parentKey===n._getParentKey(e)){var t=n._createFolderItem(n.newFolderItem(),e);e.subItems.push(t);t.focused(!0);n.focusedItem(t);n.selectionModel.selectItem(t);n.newFolderItemFocused(!1);n.newFolderItem(null)}else D.Verbose.logData({name:"FolderSelect.AddFolder.InvalidParent",message:"Tried to add folder but current item is different than the folder that was just created."})}});n._serverDataPromise=new T.default;n.waitingForItemParams={stillWaitingTimeout:4e3,promise:null,showControl:n.waitingForItem};n._breadCrumbItems=r.observableArray([]);n.hasBackToRootButton=r.observable(!1);n.parentBreadCrumbClass=r.observable("");n._isBreadCrumbRootClickable=!0;n.parentFolderName=n.createComputed(function(){var e=n._breadCrumbItems().length;return e>1?n.unwrapObservable(n._breadCrumbItems()[e-2].title):""});n.currentFolderName=n.createComputed(function(){var e=n._breadCrumbItems().length;return e>0?n.unwrapObservable(n._breadCrumbItems()[e-1].title):""});1===t.context().items.length?n.moveCopyText=M.format(t.context().isMove?h.strings.moveSingleItem:h.strings.copySingleItem,t.context().items.length):n.moveCopyText=M.format(t.context().isMove?h.strings.moveMultipleItems:h.strings.copyMultipleItems,t.context().items.length);n._urlDataSource=n.resources.consume(o.url);n._itemProvider=n.resources.consume(p.resourceKey);n._actionMap=n.resources.consume(i.actionMap);n._moveCopyDataSource=n.resources.consume(o.copy);n._pageContext=n.resources.consume(O.pageContext);n._itemUrlHelper=n.resources.consume(I.resourceKey);n._itemParentHelper=n.resources.consume(y.resourceKey);n._sitesTitle=l.isFeatureEnabled(l.LeftNavTeamSiteLibraries)?r.observable(h.strings.sharedLibraries):n._getSitesTitle();n.onItemClick=function(e){return n._onItemClick(e)};n.onBreadCrumbParentClick=function(){if(n.isParentBreadCrumbClickable())return n._onBreadCrumbClick(!1)};n.onBreadCrumbRootClick=function(){return n._onBreadCrumbClick(!0)};n.onShowMoreClick=function(e){return n._onShowMoreClick(e)};n.onUseLocationClick=function(e,t){return n._onUseLocationClick(e,t)};n.onKeyEnter=function(e,t){n._onItemClick(e);return!0};n.focusedItem=r.observable();n.selectionModel=new k.default;n.addBindingHandlers({selection:C.default,keyboard:w.default,element:u.default,stickyFooter:A.default,dismiss:F.default,delayedHasFocus:q.default});var g=n.context().isMove?h.strings.itemTooBigInfoMove:h.strings.itemTooBigInfo;n.infoBarParams={type:r.observable(1),infoText:r.observable(g)};n.context().isMove?n.packageSizeWarning=1===n.context().items.length?h.strings.itemTooBigMove:h.strings.itemsTooBigMove:n.packageSizeWarning=1===n.context().items.length?h.strings.itemTooBig:h.strings.itemsTooBig;n.stickyFooterElement=r.observable();var b,E,P={title:h.strings.places,key:void 0,focused:r.observable(!1),selected:r.observable(!1),type:3,subItems:null,sections:[{title:n.chooseDestination,altTitle:h.strings.currentSite,items:r.observableArray(),listElement:r.observable(),focusedItem:r.observable(),showMore:r.observable(!1),showMoreInfo:r.observable(""),showMoreError:r.observable(""),showMoreFocused:n.createObservable(!1),showMoreLoading:n.createObservable(!1)}]},z=n.resources.consume(i.currentItem),W=n._getRootItem(z(),"list"),X=n._getRootItem(z(),"subsite");if(W){var V=n._itemUrlHelper.getItemUrlParts(W.key);n._siteAbsoluteUrl=X?n._itemUrlHelper.getItemUrlParts(X.key).fullItemUrl:n._pageContext.webAbsoluteUrl;n._siteTitle=X&&X.name?X.name:n._pageContext.webTitle;n._webId=X&&X.subsite&&X.subsite.id?X.subsite.id:n._pageContext.webId;n._siteId=X&&X.subsite&&X.subsite.itemReference&&X.subsite.itemReference.SiteId?X.subsite.itemReference.SiteId:n._pageContext.siteId;n._listTitle=W.name?W.name:n._pageContext.listTitle;n._siteLogoUrl=X?X.subsite.icon:n._pageContext.webLogoUrl;n._isOneDrive=W.list.templateType===H.default.mySiteDocumentLibrary;b=n._loadWebDataSource().then(function(e){return e.getMyOneDriveUrl()});var $=!1;n.context().items.forEach(function(e){e.isDocSet&&($=!0)});n._supportsCrossSite=(n._moveCopyDataSource.getCapabilities().supportsCopyCrossSite&&!n.context().isMove||n._moveCopyDataSource.getCapabilities().supportsMoveCrossSite&&n.context().isMove)&&(!n._pageContext||n._pageContext.isNoScriptEnabled||!1)&&n._pageContext&&n._pageContext.listBaseTemplate!==H.default.webPageLibrary&&W.list.isDocumentLibrary&&!$&&!R.isGallatin();var J=function(e,t,i,s){return{title:n._getLocalLibraryTitle(s),key:t,oneDriveItem:e,focused:r.observable(!1),selected:r.observable(!1),type:n._isOneDrive?5:1,siteIcon:null,folderIcon:"folder",subItems:null,sections:null,retrievedSharingPermissions:!1,sharingPermissions:null,sharingInfoText:null,listUrl:i,isCrossSite:!1,webId:n._webId,siteId:n._siteId}};(E=n._isOneDrive?b.then(function(e){return J(W,V.fullItemUrl,V.fullListUrl,e)},function(e){return J(W,V.fullItemUrl,V.fullListUrl)}):x.default.wrap(J(W,V.fullItemUrl,V.fullListUrl))).then(function(e){P.sections[0].items().length>0?P.sections[0].items.unshift(e):P.sections[0].items.push(e)});var K=n._isPackageSizeWithinLimit()}if(n._supportsCrossSite&&K){n._initialSitesQos=new N.Qos({name:"MoveCopySelect.GetInitialSites"});n._initialSitesQosDone=!1;var Q=new N.Qos({name:"MoveCopySelect.GetMyOneDriveCrossSite"});b.then(function(e){if(null!==e){if(e!==n._siteAbsoluteUrl){var t={title:h.strings.personalOneDriveRootfolder,key:e,focused:r.observable(!1),selected:r.observable(!1),type:5,siteIcon:null,folderIcon:null,subItems:null,sections:null,retrievedSharingPermissions:!1,sharingPermissions:null,sharingInfoText:null,isCrossSite:!0};P.sections[0].items.push(t)}Q.end({resultType:N.ResultTypeEnum.Success})}else{Q.end({resultType:N.ResultTypeEnum.ExpectedFailure});D.Verbose.logData({name:"MoveCopySelect.GetMyOneDriveCrossSite",message:"User does not have a my site provisioned"})}n.loadingOneDrive(!1)},function(e){Q.end({resultType:N.ResultTypeEnum.Failure});n.loadingOneDrive(!1)});var G={title:n._sitesTitle,altTitle:h.strings.frequentSitesAltText,type:3,lastIndex:0,listElement:r.observable(),focusedItem:r.observable(),items:r.observableArray(),showMore:r.observable(!0),showMoreLoading:r.observable(!1),showMoreInfo:r.observable(""),showMoreError:r.observable(""),showMoreFocused:r.observable(!1)};P.sections[1]=G;n._breadCrumbItems.push(P);n._acronymDataSource=new j.AcronymAndColorDataSource(n._pageContext);n._itemProvider.getItemSync({parentKey:n._urlDataSource.getRootItemKey(B.default.Subsites)});if(n._isOneDrive)n._getInitialSitesData(P.sections[1]);else{var Y=new N.Qos({name:"MoveCopySelect.GetCurrentTeamSiteAcronymAndColor"}),Z=new N.Qos({name:"MoveCopySelect.GetCurrentTeamSiteDocumentLibraryCount"}),ee=[];n._loadWebDataSource().then(function(e){ee.push(n._getInitialSitesData(P.sections[1]));ee.push(n._getCurrentSiteData(Y));ee.push(n._getHasMultipleDocumentLibraries(Z));x.default.all(ee).done(function(e){var t=e[0],n=e[1],r=e[2];if(t){n&&r&&t.unshift(n);t=t.slice(0,U);P.sections[1].items(t);P.sections[1].showMoreLoading(!1)}})})}n._initialLoadSuccess(P,f,!!W)}else if(W){n._breadCrumbItems.push(P);n._isBreadCrumbRootClickable=!1;n.loadingOneDrive(!1);if(!K&&n._supportsCrossSite){s.logData({name:"MoveCopySelect.PackageTooBig",extraData:{numItems:n.context.peek().items.length}});n.packageTooBig(!0)}E.then(function(e){var t=e;n._updateContextWithCurrentItem(t);n._getItemData(n._getParentKey(t),t.webId,t.siteId,!1,function(e){P=t;n._parseFolderItems(e,P);n._breadCrumbItems.push(P);n._initialLoadSuccess(P,f,!0)},function(){n._initialLoadFailure(P,f)})},function(e){n._initialLoadFailure(P,f)})}else{D.Verbose.logData({name:"MoveCopySelect.LaunchPane",message:"List root item is null"});n.loadingOneDrive(!1);n._initialLoadFailure(P,f)}return n}t.prototype.getStatusText=function(e){if(e&&e.subItems&&0===e.subItems().length)switch(e.type){case 2:case 1:return h.strings.noSubFolders;case 0:return h.strings.noLibraries}return null};t.prototype.isSite=function(e){return!!e&&0===e.type};t.prototype.isRootItem=function(e){return!!e&&3===e.type};t.prototype.isLibraryOrFolder=function(e){return!!e&&(1===e.type||2===e.type)};t.prototype.isLibraryOrFolderOrOneDrive=function(e){return!!e&&(this.isLibraryOrFolder(e)||this.isOneDrive(e))};t.prototype.isOneDrive=function(e){return!!e&&5===e.type};t.prototype.showAddFolder=function(){var e=this.getCurrentItem(),t=e.oneDriveItem,n=this._getRootItem(t,"list");return!(e.remote||!t||!n)&&s.isSpoCreateFolderAvailable(t,n)};t.prototype.showBottomLine=function(e){return!!(e&&e.subItems&&e.subItems().length>0||this.isLibraryOrFolderOrOneDrive(e)&&this.showAddFolder())};t.prototype.getListType=function(e){if(e)return e.title===h.strings.siteCurrentLibrary?M.format(h.strings.currentLibraryFolders,e.title):0===e.type?M.format(h.strings.docLibs,e.title):5===e.type||1===e.type?M.format(h.strings.libraryFolders,e.title):M.format(h.strings.folders,e.title)};t.prototype.getShowMoreText=function(e){return e&&3===e.type?l.isFeatureEnabled(l.LeftNavTeamSiteLibraries)?h.strings.moreSharedLibraries:h.strings.browseSites:h.strings.showMore};t.prototype.getShowMoreAccText=function(e){var t=h.strings.browseMoreSharedLibraries;e&&(0===e.type?t=h.strings.showMoreFollowedSites:1===e.type&&(t=h.strings.showMoreRecentSites));return t};t.prototype.getChooseLocationAccText=function(e){return this.context().isMove?M.format(h.strings.moveButtonAccText,e.title):M.format(h.strings.copyButtonAccText,e.title)};t.prototype.getCurrentItem=function(){return this._itemOneUsedLast?this.itemTwo.item():this.itemOne.item()};t.prototype.isParentBreadCrumbClickable=function(){return this._breadCrumbItems.peek().length>2||this._isBreadCrumbRootClickable};t.prototype.onInfoBarClick=function(){if(this.showMinimalPackageWarning.peek()){this.infoBarParams.type(0);this.infoBarParams.infoText(this.packageSizeWarning);this.showMinimalPackageWarning(!1)}return!1};t.prototype.isFileInfoVisible=function(e){return 1===e.length};t.prototype._initialLoadSuccess=function(e,t,n){void 0===n&&(n=!1);this._setCurrentItemClass("od-FolderSelect-itemInitial");this.loading(!1);this._setCurrentItem(e,n);t.end({resultType:N.ResultTypeEnum.Success})};t.prototype._initialLoadFailure=function(e,t){e.error=r.observable(h.strings.serverError);this.loading(!1);this._setCurrentItem(e);t.end({resultType:N.ResultTypeEnum.Failure})};t.prototype._getRootItem=function(e,t){var n=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,t));return n||null};t.prototype._loadWebDataSource=function(){return this.resources.consumeAsync(b.resourceKey)};t.prototype._loadSitesDataSource=function(){return this.resources.consumeAsync(o.sites)};t.prototype._onItemClick=function(e){var t=this,n=this._engagement;e.focused(!1);this._breadCrumbItems.push(e);this._updateBreadcrumb();this._exitCurrentItemLeft();0===e.type?n.logData({name:"MoveCopySelect.SelectSite.Click",isIntentional:!0}):n.logData({name:"MoveCopySelect.SelectLibraryOrFolder.Click",isIntentional:!0});if(null===e.subItems)if(0===e.type||5===e.type&&e.isCrossSite){this.waitingForItemParams.promise=new x.default(function(n,i){t._loadWebDataSource().then(function(i){var s;s=5===e.type?function(e){return i.getDefaultOneDriveLibrary(e)}:function(e){return i.getDocumentLibraries(e)};t._serverDataPromise.debounce(s(e.key)).then(function(i){for(var s=[],o=0;o<i.length;o++){var u={title:i[o].title,key:i[o].target,focused:r.observable(!1),selected:r.observable(!1),listUrl:i[o].customSettingsUrl,type:1,folderIcon:"folder",subItems:null,sections:null,isCrossSite:e.isCrossSite,webId:e.webId,siteId:e.siteId,rootItemType:e.type,remote:i[o].remote};s.push(u)}if(1===s.length){var a=s[0];a.title=e.title;t._breadCrumbItems()[t._breadCrumbItems().length-1]=a;t._getItemWithWaiting(a,!1).then(function(){n()}).catch(function(){t._getItemWithWaiting(e,!0).then(function(){n()})})}else{e.subItems=r.observableArray(s);n();t._enterNextItem(e,!1)}},function(r){t._handleGetItemError(r,e);n()})})});this.waitingForItem(!0)}else 1!==e.type&&2!==e.type&&5!==e.type||this._getItemWithWaiting(e,!1).catch(function(){t._getItemWithWaiting(e,!0)});else{this._serverDataPromise.clear();this._enterNextItem(e,!1)}return!1};t.prototype._onBreadCrumbClick=function(e){var t,n=this._engagement;if(e){n.logData({name:"MoveCopySelect.Breadcrumb.Root.Click",isIntentional:!0});if(this._isBreadCrumbRootClickable){t=this._breadCrumbItems.shift();this._breadCrumbItems([t])}else{var r=this._breadCrumbItems.slice(0,2);t=r[1];this._breadCrumbItems(r)}}else{n.logData({name:"MoveCopySelect.Breadcrumb.Click",isIntentional:!0});this._breadCrumbItems.pop();t=this._breadCrumbItems()[this._breadCrumbItems().length-1]}var i=this.getCurrentItem();i.error&&i.error()&&(i.error=null);this._serverDataPromise.isExecuting()?this._serverDataPromise.clear():this._exitCurrentItemRight();this._updateBreadcrumb();this._enterNextItem(t,!0);return!1};t.prototype._onShowMoreClick=function(e){var t=this,n=this._engagement,i=!1,s=function(){i=!0};if(3===e.type){n.logData({name:"MoveCopySelect.ShowMoreSites.Click",isIntentional:!0});e.showMoreFocused(!1);if(this._sitesFolderItem){this._breadCrumbItems.push(this._sitesFolderItem);this._exitCurrentItemLeft();this._enterNextItem(this._sitesFolderItem,!1)}else{e.showMoreLoading(!0);var o={title:this._sitesTitle,key:void 0,focused:r.observable(!1),selected:r.observable(!1),type:4,subItems:null,sections:[{title:h.strings.followed,altTitle:h.strings.followedSites,type:0,lastIndex:0,listElement:r.observable(),focusedItem:r.observable(),items:r.observableArray(),showMore:r.observable(!0),showMoreLoading:r.observable(!1),showMoreInfo:r.observable(""),showMoreError:r.observable(""),showMoreFocused:r.observable(!1)},{title:h.strings.recent,altTitle:h.strings.recentSites,type:1,lastIndex:0,listElement:r.observable(),focusedItem:r.observable(),items:r.observableArray(),showMore:r.observable(!0),showMoreLoading:r.observable(!1),showMoreInfo:r.observable(""),showMoreError:r.observable(""),showMoreFocused:r.observable(!1)}]},u=new N.Qos({name:"MoveCopySelect.GetFollowedSites"}),a=new N.Qos({name:"MoveCopySelect.GetRecentSites"});this._serverDataPromise.debounce(x.default.all([this._getSitesData(o.sections[0],u,s),this._getSitesData(o.sections[1],a,s)])).done(function(n){if(!i)if(o.sections[0].showMoreError()&&o.sections[1].showMoreError()){e.showMoreError(h.strings.serverError);e.showMore(!1)}else{t._breadCrumbItems.push(o);t._updateBreadcrumb();t._exitCurrentItemLeft();t._sitesFolderItem=o;t._enterNextItem(t._sitesFolderItem,!1)}e.showMoreLoading(!1)})}}else{n.logData({name:"MoveCopySelect.ShowMore.Click",isIntentional:!0,extraData:{Type:e.type}});var f=new N.Qos({name:"MoveCopySelect.ShowMoreSites"});this._serverDataPromise.debounce(this._getSitesData(e,f,s)).then(function(){if(i){e.showMoreLoading(!1);t._exitCurrentItemRight()}else e.listElement().focus()})}return!1};t.prototype._onUseLocationClick=function(e,t){var n=this._engagement;this.chooseLocationButtonEnabled(!1);var r=this.getCurrentItem(),i="MoveCopySelect.ChooseLocation",s=void 0!==r.rootItemType?r.rootItemType:r.type,o={ItemCount:this.context().items.length,FolderCount:this._getFolderCount(this.context().items),FileCount:this._getFileCount(this.context().items)};i+=this.context().isMove?".Move":".Copy";var u=this._getRootItem(r.oneDriveItem,"list");u&&!u.list.isDocumentLibrary&&(i+=".List");r.isCrossSite?i+=".CrossSite.Click":i+=0===s?".WithinSite.Click":".InLibrary.Click";n.logData({name:i,isIntentional:!0,extraData:o});if(r.isCrossSite){var a="MoveCopySelect.ChooseLocation";a+=this.context().isMove?".Move":".Copy";if(0!==s||this._isOneDrive)if(0===s&&this._isOneDrive)a+=".ODBToTeamSite.Click";else if(5!==s||this._isOneDrive)if(5===s&&this._isOneDrive)a+=".ODBToODB.Click";else{a+=".UnknownCrossSite.Click";D.Verbose.logData({name:"MoveCopySelect.ChooseLocation.UnknownCrossSite.Click",message:"rootItemType: "+s})}else a+=".TeamSiteToODB.Click";else a+=".TeamSiteToTeamSite.Click";n.logData({name:a,isIntentional:!0,extraData:o})}!this._initialSitesQosDone&&this._initialSitesQos&&this._initialSitesQos.end({resultType:N.ResultTypeEnum.ExpectedFailure,resultCode:"Cancelled",extraData:{Type:3}});r.webId&&(this.context.peek().webId=r.webId);r.siteId&&(this.context.peek().siteId=r.siteId);var f={context:this.context,onComplete:this.onComplete,isMove:this.context().isMove,isCrossSite:r.isCrossSite};new(this.managed(this._actionMap.MoveCopyAction))(f).execute(t);t.stopPropagation();return!1};t.prototype._getFolderCount=function(e){for(var t=0,n=0;n<e.length;n++)e[n].folder&&t++;return t};t.prototype._getFileCount=function(e){return e.length-this._getFolderCount(e)};t.prototype._getItem=function(e,t,n,r){var i={parentKey:e,requestAllChildren:!0,ownerId:this._urlDataSource.getOwnerId(e),filters:this._getFilters(),sortField:r?"ID":"LinkFilename",isAscending:!r,needSchema:!0,expandGroup:!0,ignoreListContext:!0,webId:t,siteId:n,noGroupReplace:!0};return this._itemProvider.getItem(i)};t.prototype._getItemData=function(e,t,n,r,i,s){return this._getItem(e,t,n,r).then(i,s)};t.prototype._getItemWithWaiting=function(e,t){var n=this;this.waitingForItemParams.promise=this._serverDataPromise.debounce(this._getItemData(this._getParentKey(e),e.webId,e.siteId,t,function(t){1!==e.type&&5!==e.type||(e.oneDriveItem=t.item());n._parseFolderItems(t,e);n._enterNextItem(e,!1)},function(r){if(r&&-2147024860===r.errorCode&&!t){r.retry=!0;return x.default.wrapError(r)}n._handleGetItemError(r,e)}));this.waitingForItem(!0);return this.waitingForItemParams.promise};t.prototype._handleGetItemError=function(e,t){if(!x.default.isCanceled(e)){e.status?404===e.status&&(t.error=r.observable(h.strings.itemNotFoundError)):0===t.type?t.error=r.observable(h.strings.loadLibrariesFailure):t.error=r.observable(h.strings.loadFoldersFailure);this._setNextItemClass("");this._setNextItem(t)}};t.prototype._parseFolderItems=function(e,t){t.subItems=r.observableArray();for(var n=e.content().items,i=0;i<n.length;i++){var s=n[i]();s.type===g.default.Folder&&t.subItems.push(this._createFolderItem(s,t))}};t.prototype._createFolderItem=function(e,t){return{title:e.name,key:e.id,focused:r.observable(!1),selected:r.observable(!1),listUrl:t.listUrl,oneDriveItem:e,type:2,siteIcon:null,folderIcon:e.iconName,subItems:null,sections:null,isCrossSite:t.isCrossSite,webId:t.webId,siteId:t.siteId,remote:t.remote,rootItemType:void 0!==t.rootItemType?t.rootItemType:t.type}};t.prototype._createContentItem=function(){var e=r.observable(),t={item:r.observable(),className:r.observable(""),element:e,regionElement:r.observable(),listElement:r.observable(),stickyFooterElement:r.observable(),resizeStickyFooter:r.observable(!1),isActive:r.observable(!1),eventGroup:new f.default(e),isEntering:!1};this.addDisposable(t.eventGroup);return t};t.prototype._addAnimationEvents=function(e,t){var n=this;void 0===t&&(t=!1);var r=function(){if(t||e.isEntering){e.isEntering=!1;var r=e.item.peek();r.subItems&&(0===r.subItems.peek().length?n.useLocationFocused(!0):n.selectionModel.selectItem(r.subItems.peek()[0]))}else e.isActive(!1)};e.element()?function(){if(t)r();else{e.eventGroup.on(e.element(),"transitionEnd",r);e.eventGroup.on(e.element(),"webkitTransitionEnd",r)}}():this.async.setTimeout(function(){n._addAnimationEvents(e,t)},10)};t.prototype._getSitesData=function(e,t,n){e.showMoreLoading(!0);var i,s=function(n){t.end({resultType:N.ResultTypeEnum.Success,extraData:{Length:n.length,Type:e.type}});e.lastIndex+=n.length;0===n.length&&0===e.lastIndex&&(0===e.type?e.showMoreInfo(h.strings.noFollowedSites):e.showMoreInfo(h.strings.loadRecentSitesFailure));for(var i=0;i<n.length;i++){var s={title:n[i].title,key:n[i].serverRelativeUrl,focused:r.observable(!1),selected:r.observable(!1),siteIcon:{iconUrl:n[i].icon,color:n[i].color,acronym:n[i].acronym},folderIcon:null,type:0,subItems:null,sections:null,isCrossSite:!0,webId:n[i].itemReference&&n[i].itemReference.WebId,siteId:n[i].itemReference&&n[i].itemReference.SiteId};e.items.push(s)}5!==n.length&&e.showMore(!1);e.showMoreLoading(!1)},o=function(r){if(x.default.isCanceled(r)){t.end({resultType:N.ResultTypeEnum.ExpectedFailure,resultCode:"Cancelled",extraData:{Type:e.type}});n&&n()}else{var i=!1;if(0===e.type)e.showMoreError(h.strings.loadFollowedSitesFailure);else if(1===e.type){if(500011===(r.responseData&&r.responseData.ErrorCode)){e.showMoreInfo(h.strings.noGraphRecentSitesFailure);i=!0}else e.showMoreError(h.strings.loadRecentSitesFailure)}else e.showMoreError(h.strings.loadSitesFailure);e.showMoreLoading(!1);i?t.end({resultType:N.ResultTypeEnum.ExpectedFailure,extraData:{Type:e.type}}):t.end({resultType:N.ResultTypeEnum.Failure,extraData:{Type:e.type}});e.showMore(!1)}};switch(e.type){case 0:i=this._loadSitesDataSource().then(function(t){return t.getFollowedSites(e.lastIndex,5).then(s,o)});break;case 1:i=this._loadSitesDataSource().then(function(t){return t.getRecentSites(e.lastIndex,5).then(s,o)});break;default:D.Verbose.logData({name:"FolderSelect.GetSites.InvalidSectionType",message:"Invalid section type:"+e.type.toString()})}return i};t.prototype._getInitialSitesData=function(e){var t=this;e.showMoreLoading(!0);return this._itemProvider.getItem({parentKey:this._urlDataSource.getRootItemKey(B.default.Subsites)}).then(function(n){for(var i=0,s=n.content().groupings[0].itemGroups,o=0;o<s.length;o++)i+=s[o].count;e.lastIndex+=i;if(0===i&&0===e.lastIndex){e.showMoreInfo(h.strings.noFollowedSites);e.showMoreLoading(!1);t._initialSitesQos.end({resultType:N.ResultTypeEnum.Success,extraData:{Length:i,Type:e.type}});t._initialSitesQosDone=!0;return null}for(var u=[],a={},f=0;f<i;f++){var l=t.peekUnwrapObservable(n.content().items[f]),c=t._itemUrlHelper.getItemUrlParts(l.key),p=c.fullItemUrl&&c.fullItemUrl.replace(/\/$/,"");if(t._isOneDrive||p!==t._siteAbsoluteUrl){var d={title:l.name,key:c.fullItemUrl,focused:r.observable(!1),selected:r.observable(!1),siteIcon:{iconUrl:l.subsite.icon,color:l.subsite.color,acronym:l.subsite.acronym},folderIcon:null,type:0,subItems:null,sections:null,isCrossSite:!0,webId:l.subsite.id,siteId:l.subsite.itemReference&&l.subsite.itemReference.SiteId};if(!a[c.fullItemUrl]){a[c.fullItemUrl]=!0;u.push(d)}}}if(t._isOneDrive){u=u.slice(0,U);e.items(u);e.showMoreLoading(!1)}t._initialSitesQos.end({resultType:N.ResultTypeEnum.Success,extraData:{Length:i,Type:e.type}});t._initialSitesQosDone=!0;return u},function(n){x.default.isCanceled(n)?t._initialSitesQos.end({resultType:N.ResultTypeEnum.ExpectedFailure,resultCode:"Cancelled",extraData:{Type:e.type}}):t._initialSitesQos.end({resultType:N.ResultTypeEnum.Failure,extraData:{Type:e.type}});t._initialSitesQosDone=!0;e.showMoreError(h.strings.loadSitesFailure);e.showMoreLoading(!1);return null})};t.prototype._getCurrentSiteData=function(e){var t={title:this._siteTitle,key:this._siteAbsoluteUrl,focused:r.observable(!1),selected:r.observable(!1),siteIcon:{iconUrl:"_layouts/15/images/siteicon.png"===this._siteLogoUrl?"":this._siteLogoUrl},folderIcon:null,type:0,subItems:null,sections:null,isCrossSite:!1,webId:this._webId,siteId:this._siteId};return this._acronymDataSource.getAcronymData(this._siteTitle).then(function(n){e.end({resultType:N.ResultTypeEnum.Success});t.siteIcon.color=n.color;t.siteIcon.acronym=n.acronym;return t},function(t){e.end({resultType:N.ResultTypeEnum.Failure});return null})};t.prototype._getHasMultipleDocumentLibraries=function(e){var t=this;return this._loadWebDataSource().then(function(n){return n.getDocumentLibraries(t._siteAbsoluteUrl).then(function(t){e.end({resultType:N.ResultTypeEnum.Success});return t.length>1})},function(t){e.end({resultType:N.ResultTypeEnum.Failure});return!0})};t.prototype._setCurrentItem=function(e,t){void 0===t&&(t=!1);var n;(n=this._itemOneUsedLast?this.itemTwo:this.itemOne).item(e);n.isActive(!0);this._addAnimationEvents(n,t)};t.prototype._setNextItem=function(e){var t,n,r=this;this._updateContextWithCurrentItem(e);if(this._itemOneUsedLast){t=this.itemOne;n=this.itemTwo}else{t=this.itemTwo;n=this.itemOne}this._itemOneUsedLast=!this._itemOneUsedLast;t.item(e);t.isActive(!0);n.isActive(!1);e.error||(t.isEntering=!0);this._addAnimationEvents(t);this.async.setTimeout(function(){r._setElementLeft(t.element(),0)},0)};t.prototype._setNextItemClass=function(e){this._itemOneUsedLast?this.itemOne.className(e):this.itemTwo.className(e)};t.prototype._setCurrentItemClass=function(e){this._itemOneUsedLast?this.itemTwo.className(e):this.itemOne.className(e)};t.prototype._setCurrentItemLeft=function(e){var t,n=(t=this._itemOneUsedLast?this.itemTwo.element():this.itemOne.element()).getBoundingClientRect().width+40;(e&&!E.default.isRightToLeft||!e&&E.default.isRightToLeft)&&(n=-n);this._setElementLeft(t,n)};t.prototype._setElementLeft=function(e,t){E.default.isRightToLeft?e.style.right=t+"px":e.style.left=t+"px"};t.prototype._exitCurrentItemLeft=function(){this._setCurrentItemLeft(!0)};t.prototype._exitCurrentItemRight=function(){this._setCurrentItemLeft(!1)};t.prototype._enterNextItem=function(e,t){t&&!E.default.isRightToLeft||!t&&E.default.isRightToLeft?this._setNextItemClass("od-FolderSelect-itemEnterLeft"):this._setNextItemClass("od-FolderSelect-itemEnterRight");this._setNextItem(e)};t.prototype._updateBreadcrumb=function(){this.hasBackToRootButton(this._breadCrumbItems().length>2);this.isParentBreadCrumbClickable()?this.parentBreadCrumbClass("od-FolderSelect-clickableCrumb"):this._isBreadCrumbRootClickable||this.parentBreadCrumbClass("")};t.prototype._updateContextWithCurrentItem=function(e){this.context().targetKey=this._getParentKey(e);this.context().targetId=e.key};t.prototype._getLocalLibraryTitle=function(e){var t=this._pageContext.isSiteAdmin&&this._isOneDrive;e&&(t=e===this._siteAbsoluteUrl);return this._isOneDrive?t?h.strings.personalOneDriveRootfolder:M.format(h.strings.oneDriveRootfolder,this._pageContext.webTitle):this._supportsCrossSite?h.strings.siteCurrentLibrary:this._listTitle};t.prototype._getFilters=function(){return this._moveCopyDataSource.getCapabilities().supportsMoveCopyFilterParams?{FilterField1:"FSObjType",FilterValue1:"1"}:{}};t.prototype._isPackageSizeWithinLimit=function(){if(!this._moveCopyDataSource.getCapabilities().supportsThrottling||l.isFeatureEnabled(l.MoveCopyCrossSiteMaxSizeIncrease))return!0;for(var e=this.context().items.length,t=0,n=0;n<e;n++){var r=this.context().items[n];r.folder||!r.size?t+=r.totalSize:t+=r.size}return t<=524288e3};t.prototype._getParentKey=function(e){var t,n=e.key,r=e.listUrl,i=this._itemUrlHelper.getUrlParts({path:n,listUrl:r});return this._urlDataSource.getKey(((t={}).id=i.serverRelativeItemUrl,t.listurl=i.normalizedListUrl,t))};t.prototype._getSitesTitle=function(){var e=this.createObservable();this.trackPromise(this._suiteNavProvider.loadData().then(function(e){return e.CompanyDisplayName})).done(function(t){e(t)});return this.createPureComputed(function(){return e()||h.strings.sites})};return t}(P.default);t.default=z});
define("odsp-next/actions/createFolder/odb/CreateFolderAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/url/QueryType","@ms/odsp-datasources/lib/Permissions","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys","../../../models/item/ItemParentHelper","../../../models/item/command/FileSystemItemCommandKeys"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(t){n.__extends(i,t);function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="CreateFolder";e.item?n._currentItem=e.item:n._currentItem=n.resources.consume(u.currentItem);n._itemParentHelper=n.resources.consume(a.resourceKey);n._isCreateShareableFolder=e.isCreateShareableFolder;return n}i.prototype.getExecutorPath=function(){return"odsp-next/actions/createFolder/odb/CreateFolderExecutor"};i.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/createFolder/odb/CreateFolderExecutor"],t,n)})}};i.prototype.getExecutorParameters=function(){return{currentItem:this._currentItem.peek(),isCreateShareableFolder:this._isCreateShareableFolder}};i.prototype.onIsAvailable=function(){var e=this._currentItem();return c(e,this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")))&&this.itemCommandHelper.isCommandSupported(e,f.createFolder)};return i}(o.default);t.default=l;function c(e,t){return!!e&&e.queryType===i.default.Files&&(!t||t.list.allowCreateFolder&&!t.list.isExternal)&&s.PermissionMask.hasItemPermission(e,s.PermissionMask.insertListItems)}t.isSpoCreateFolderAvailable=c});
define("odsp-next/controls/inlineCreateFolder/InlineCreateFolder",["require","exports","./InlineCreateFolderViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./InlineCreateFolder.html","./InlineCreateFolder.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-inline-create-folder",template:e("./InlineCreateFolder.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/inlineCreateFolder/InlineCreateFolderViewModel",["require","exports","tslib","knockout","../../resources/ControlResourceKeys","../../providers/engagement/Engagement","../folderBuilder/FolderBuilder.resx","../../providers/item/ItemProvider","../../bindings/keyboard/KeyboardBinding","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/base/ViewModel","../loadingSpinner/LoadingSpinner"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.namePlaceholder=o.strings.FolderNamePlaceholder;n.nameLabel=o.strings.FolderNameLabel;n.createLabel=o.strings.CreateFolderLabel;n.newFolderText=o.strings.NewFolderText;n.loadingSpinnerTagName=c.default.tagName;n.height=(t.height||38).toString()+"px";n.inputHeight=(t.height||32).toString()+"px";n._newFolderItem=t.newFolderItem;n._newItemFocused=t.newItemFocused;n.focused=t.focused;n._item=t.item;n.newFolderName=r.observable("");n.isFolderCreating=r.observable(!1);n.showAddFolderText=r.observable(!0);n.inputFocused=r.observable(!1);n._createActionStatus=r.observable("");n.errorText=r.observable("");n.successText=r.observable("");n.addBindingHandlers({keyboard:a.default});n._itemProvider=n.resources.consume(u.resourceKey);n._actionMap=n.resources.consume(i.actionMap);n._engagement=n.resources.consume(s.resourceKey);if(t.isActive){var f=new(n.managed(n._actionMap.CreateFolderAction))({item:r.observable(n._item)});n.createComputed(function(){t.isActive(f.isAvailable())})}return n}t.prototype.onEnterAddFolder=function(){this._newItemFocused&&this._newItemFocused(!0);this.onClickAddFolder()};t.prototype.onClickAddFolder=function(){this._engagement.logData({name:"InlineCreateFolder.NewFolder.Click",isIntentional:!0});this.showAddFolderText(!1);this.inputFocused(!0)};t.prototype.onExecuteClick=function(e,t){this._engagement.logData({name:"InlineCreateFolder.CreateFolder.Click",isIntentional:!0});this.createNewFolder(t)};t.prototype.onEnter=function(e,t){if(0!==this.newFolderName().length){this._engagement.logData({name:"InlineCreateFolder.CreateFolder.Enter",isIntentional:!0});this.createNewFolder(t);return!1}};t.prototype.onEscape=function(e,t){this._engagement.logData({name:"InlineCreateFolder.CreateFolder.Dismiss",isIntentional:!0});this._resetControl();t.stopPropagation();return!1};t.prototype.createNewFolder=function(e){var t=this;this.isFolderCreating(!0);this.inputFocused(!1);this.errorText("");var n={parentKey:this._item.key},r={status:this._createActionStatus};new(this.managed(this._actionMap.CreateNewFolderAction))({parentItem:this._item,newFolderName:this.newFolderName,options:r}).execute(e).then(function(){if(t._createActionStatus()){t.errorText(t._createActionStatus());t.isFolderCreating(!1)}else{t.successText(f.format(o.strings.CreateFolderSuccess,t.newFolderName.peek()));if(t._newFolderItem)t._itemProvider.getItem(n).then(function(e){for(var n=e.content().items,r=0;r<n.length;r++){var i=n[r]();if(i.displayName===t.newFolderName.peek()){t._resetControl();t._newFolderItem(i);t._itemProvider.invalidateItem(t._item.key)}}});else{t._resetControl();t._newFolderItem()}}});e.stopPropagation();return!1};t.prototype._resetControl=function(){this.showAddFolderText(!0);this.newFolderName("");this.isFolderCreating(!1);this.errorText("");this.focused(!1)};return t}(l.default);t.default=h});
define("odsp-next/controls/inlineCreateFolder/InlineCreateFolder.html",[],function(){return'<div class=od-InlineCreateFolder data-bind="attr: { \'aria-label\': newFolderText }, css: {\'is-focused\': focused }, style: { height: height }">\x3c!--ko if: isFolderCreating--\x3e<span class=od-InlineCreateFolder-icon data-bind="component: {name: loadingSpinnerTagName, params: { loadingText: \'\' }}"></span>\x3c!--/ko--\x3e\x3c!--ko ifnot: isFolderCreating--\x3e<i class="od-InlineCreateFolder-icon ms-Icon ms-Icon--FabricNewFolder" data-bind="icon: true"></i>\x3c!--/ko--\x3e\x3c!--ko if: showAddFolderText--\x3e<span role=button tabindex=0 class=od-InlineCreateFolder-addFolderText data-bind="text: newFolderText, click: onClickAddFolder, keyboard: { allowInputEvents: true, mappings: { Enter: onEnterAddFolder, Space: onEnterAddFolder } }, hasFocus: focused"></span>\x3c!--/ko--\x3e\x3c!--ko ifnot: showAddFolderText--\x3e<input class=od-InlineCreateFolder-textInput type=text data-bind="value: newFolderName, textInput: newFolderName, keyboard: { allowInputEvents: true, mappings: { Enter: onEnter, Esc: onEscape } }, attr: { maxlength: 255, placeholder: namePlaceholder, \'aria-label\': namePlaceholder, \'aria-busy\': isFolderCreating }, hasFocus: inputFocused, automation: automationId, style: { height: inputHeight }, enable: !isFolderCreating()"> <button class="od-Button od-Button--primary od-InlineCreateFolder-createButton" data-bind="style: { visibility : newFolderName() ? \'\' : \'hidden\' }, click: onExecuteClick, attr: { \'aria-label\': createLabel }, css: { \'is-disabled\': isFolderCreating }"><span class="ms-Icon ms-Icon--CheckMark od-InlineCreateFolder-createButtonIcon" data-bind="icon: true"></span></button>\x3c!--/ko--\x3e</div>\x3c!--ko if: errorText--\x3e<div class=od-InlineCreateFolder-error aria-live=assertive data-bind="text: errorText"></div>\x3c!--/ko--\x3e\x3c!--ko if: successText--\x3e<div class=ms-accessible aria-live=polite data-bind="text: successText"></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/inlineCreateFolder/InlineCreateFolder.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-FolderSelect-panel{position:absolute;top:0;height:100%;width:100%}[dir=ltr] .od-FolderSelect-panel{left:0}[dir=rtl] .od-FolderSelect-panel{right:0}.od-FolderSelect-region{padding-top:15px}[dir=ltr] .od-FolderSelect-region{padding-left:40px}[dir=rtl] .od-FolderSelect-region{padding-right:40px}.isFluent .od-FolderSelect-region{padding-top:22px}[dir=ltr] .isFluent .od-FolderSelect-region{padding-left:16px}[dir=rtl] .isFluent .od-FolderSelect-region{padding-right:16px}[dir=ltr] .isFluent .od-FolderSelect-region{padding-right:16px}[dir=rtl] .isFluent .od-FolderSelect-region{padding-left:16px}.od-FolderSelect-loading{padding-top:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-FolderSelect-title{font-size:21px;font-weight:100}.isFluent .od-FolderSelect-title{font-size:20px;font-weight:600;margin-bottom:26px}.od-FolderSelect-title-fileInfo{font-size:14px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:20px}[dir=ltr] .od-FolderSelect-title-fileInfo{padding-right:40px}[dir=rtl] .od-FolderSelect-title-fileInfo{padding-left:40px}.isFluent .od-FolderSelect-title-fileInfo{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-FolderSelect-breadCrumbContainer{padding:10px 40px 10px 0;font-size:14px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;cursor:default}html[dir=rtl] .od-FolderSelect-breadCrumbContainer{padding:10px 0 10px 40px}[dir=ltr] .od-FolderSelect-breadCrumbContainer{margin-left:-4px}[dir=rtl] .od-FolderSelect-breadCrumbContainer{margin-right:-4px}.isFluent .od-FolderSelect-breadCrumbContainer{padding:45px 16px 10px 0}html[dir=rtl] .isFluent .od-FolderSelect-breadCrumbContainer{padding:45px 0 10px 16px}.od-FolderSelect-breadCrumbItem{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 4px;padding-bottom:2px;height:30px;line-height:30px}.isFluent .od-FolderSelect-breadCrumbItem{height:20px;line-height:20px;padding-bottom:0}.od-FolderSelect-clickableCrumb{cursor:pointer}.od--isNonMobile .od-FolderSelect-clickableCrumb:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";outline:1px solid transparent}.od-FolderSelect-breadCrumbRootIcon{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:10px;height:30px;line-height:30px;font-weight:800}[dir=ltr] .od-FolderSelect-breadCrumbRootIcon{padding-right:4px}[dir=rtl] .od-FolderSelect-breadCrumbRootIcon{padding-left:4px}[dir=ltr] .od-FolderSelect-breadCrumbRootIcon{padding-left:2px}[dir=rtl] .od-FolderSelect-breadCrumbRootIcon{padding-right:2px}.od-FolderSelect-breadCrumbIcon{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:10px;font-weight:800;padding:0;font-family:FabricMDL2Icons;font-style:normal}.od-FolderSelect-ruledLine{border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}[dir=ltr] .od-FolderSelect-ruledLine{margin-left:-40px}[dir=rtl] .od-FolderSelect-ruledLine{margin-right:-40px}[dir=ltr] .isFluent .od-FolderSelect-ruledLine{margin-left:0}[dir=rtl] .isFluent .od-FolderSelect-ruledLine{margin-right:0}.od-FolderSelect-sectionHeader{margin-top:10px;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.isFluent .od-FolderSelect-sectionHeader{margin-top:12px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-FolderSelect-destinationHeader{padding-bottom:10px;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-FolderSelect-waitingForData{padding-top:10px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:12px}.od-FolderSelect-sectionContainer{padding-bottom:10px}.od-FolderSelect-itemsContainer{margin-top:10px;outline:0}.od-FolderSelect-itemsRegion{overflow-y:auto;overflow-x:hidden}[dir=ltr] .od-FolderSelect-itemsRegion{padding-left:40px}[dir=rtl] .od-FolderSelect-itemsRegion{padding-right:40px}[dir=ltr] .isFluent .od-FolderSelect-itemsRegion{padding-left:16px}[dir=rtl] .isFluent .od-FolderSelect-itemsRegion{padding-right:16px}.od-FolderSelect-addTopMargin{margin-top:10px}.od-FolderSelect-addBottomMargin{margin-bottom:10px}.od-FolderSelect-itemContainer,.od-FolderSelect-showMore{overflow:hidden;height:28px;padding-top:5px;padding-bottom:5px;width:100%;white-space:nowrap;text-overflow:ellipsis;min-height:28px}.isFluent .od-FolderSelect-itemContainer,.isFluent .od-FolderSelect-showMore{height:24px;min-height:24px}.od-FolderSelect-itemContainer .ms-Icon--OneDrive{vertical-align:top;line-height:28px;width:28px}.sm .od-FolderSelect-itemContainer .ms-Icon--OneDrive{line-height:20px}.isFluent .od-FolderSelect-itemContainer .ms-Icon--OneDrive{width:24px;line-height:24px}[dir=ltr] .od-FolderSelect-itemWrapper{padding-right:40px}[dir=rtl] .od-FolderSelect-itemWrapper{padding-left:40px}[dir=ltr] .isFluent .od-FolderSelect-itemWrapper{padding-right:16px}[dir=rtl] .isFluent .od-FolderSelect-itemWrapper{padding-left:16px}.od-folderSelect-showMoreExtra{display:block;font-size:13px;line-height:28px}.isFluent .od-folderSelect-showMoreExtra{box-sizing:border-box;height:38px;min-height:38px}[dir=ltr] .isFluent .od-folderSelect-showMoreExtra{padding-left:36px}[dir=rtl] .isFluent .od-folderSelect-showMoreExtra{padding-right:36px}.isFluent .od-folderSelect-showMoreExtra:hover{background:0 0}.od-FolderSelect-showMoreLoading{padding-top:5px;padding-bottom:5px}.od-FolderSelect-clickable{cursor:pointer}[dir=ltr] .od-FolderSelect-clickable{padding-left:5px}[dir=rtl] .od-FolderSelect-clickable{padding-right:5px}[dir=ltr] .od-FolderSelect-clickable{margin-left:-5px}[dir=rtl] .od-FolderSelect-clickable{margin-right:-5px}.od-FolderSelect-clickable .ms-Icon--OneDrive{color:#094ab2;font-size:23px;padding-top:0;vertical-align:middle}[dir=ltr] .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-left:3px}[dir=rtl] .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-right:3px}[dir=ltr] .isFluent .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-left:0}[dir=rtl] .isFluent .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-right:0}.od-FolderSelect-clickable .od-FolderSelect-itemTitle{font-size:14px;vertical-align:middle}[dir=ltr] .od-FolderSelect-clickable .od-FolderSelect-itemTitle{padding-left:8px}[dir=rtl] .od-FolderSelect-clickable .od-FolderSelect-itemTitle{padding-right:8px}.od-FolderSelect-clickable:focus{outline:1px solid transparent;background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-FolderSelect-clickable:focus{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.od-FolderSelect-clickable:focus{background:#00c0ff}}.od-FolderSelect-clickable.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:" inset;outline:1px solid transparent}.od--isNonMobile .od-FolderSelect-clickable:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";outline:1px solid transparent}.isFluent.od--isNonMobile .od-FolderSelect-clickable:hover{background:0 0}.od-FolderSelect-folderIcon{width:28px;text-align:center;display:inline-block}.od-FolderSelect-siteIcon{position:relative;display:inline-block;vertical-align:top;width:28px;height:28px}.isFluent .od-FolderSelect-siteIcon{width:24px;height:24px}[dir=ltr] .od-FolderSelect-stickyFooter{padding-left:40px}[dir=rtl] .od-FolderSelect-stickyFooter{padding-right:40px}.od-FolderSelect-statusLabel{font-size:14px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";padding-top:15px}[dir=ltr] .od-FolderSelect-statusLabel{padding-right:40px}[dir=rtl] .od-FolderSelect-statusLabel{padding-left:40px}.od-folderSelect-itemError{color:#a80000;font-size:13px;margin-top:10px}[dir=ltr] .od-folderSelect-itemError{padding-right:40px}[dir=rtl] .od-folderSelect-itemError{padding-left:40px}.od-folderSelect-itemInfo{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:13px}[dir=ltr] .od-folderSelect-itemInfo{padding-right:40px}[dir=rtl] .od-folderSelect-itemInfo{padding-left:40px}[dir=ltr] .od-folderSelect-itemErrorPadding{padding-left:40px}[dir=rtl] .od-folderSelect-itemErrorPadding{padding-right:40px}.od-FolderSelect-addFolder{margin-bottom:10px}.od-FolderSelect-hidden{display:none}.od-FolderSelect-addFolderContainer{min-height:38px}.od-FolderSelect-actionContainer{padding-top:20px;padding-bottom:20px;white-space:nowrap}.od-FolderSelect-itemAnimation{width:100%;position:absolute;transition:left .3s,right .3s;-webkit-transition:left .3s,right .3s}[dir=ltr] .od-FolderSelect-itemEnterLeft{left:-300px}[dir=rtl] .od-FolderSelect-itemEnterLeft{right:-300px}[dir=ltr] .od-FolderSelect-itemEnterRight{left:300px}[dir=rtl] .od-FolderSelect-itemEnterRight{right:300px}[dir=ltr] .od-FolderSelect-itemInitial{left:0}[dir=rtl] .od-FolderSelect-itemInitial{right:0}.od-FolderSelect-infoBar{padding-top:10px;cursor:default}[dir=ltr] .od-FolderSelect-infoBar{padding-right:40px}[dir=rtl] .od-FolderSelect-infoBar{padding-left:40px}.od-FolderSelect-infoBarClickable{cursor:pointer}.od-FolderSelect-sharingHint{width:32px;height:32px;padding:0 10px;background-color:transparent;margin:0 10px;border:none}html[dir=ltr] .od-FolderSelect-sharingHint{float:right}html[dir=rtl] .od-FolderSelect-sharingHint{float:left}html[dir=ltr] .od-FolderSelect-sharingHintTooltip{float:right}html[dir=rtl] .od-FolderSelect-sharingHintTooltip{float:left}.od-FolderSelect-sharingHintIcon{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";size:16pt;position:relative;cursor:pointer;padding:8px}[dir=ltr] .od-FolderSelect-sharingHintIcon{right:9px}[dir=rtl] .od-FolderSelect-sharingHintIcon{left:9px}.od-FolderSelect-sharingInfoText{width:150px;word-wrap:break-word}html[dir=ltr] .od-FolderSelect-sharingInfoText{text-align:left}html[dir=rtl] .od-FolderSelect-sharingInfoText{text-align:right}.od-FolderSelect-fileItemName{vertical-align:bottom}.od-InlineCreateFolder{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;cursor:pointer}.od-InlineCreateFolder.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:" inset;outline:1px solid transparent;background:"},{theme:"themeLighter",defaultValue:"#d7eaf9"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-InlineCreateFolder.is-focused{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.od-InlineCreateFolder.is-focused{background:#00c0ff}}.od-InlineCreateFolder.is-focused .od-InlineCreateFolder-addFolderText{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-InlineCreateFolder-textInput{-ms-flex-positive:1;flex-grow:1;font-size:14px;border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";outline:1px solid transparent;box-sizing:border-box;min-width:100px}[dir=ltr] .od-InlineCreateFolder-textInput{padding-left:10px}[dir=rtl] .od-InlineCreateFolder-textInput{padding-right:10px}[dir=ltr] .od-InlineCreateFolder-textInput{margin-left:7px}[dir=rtl] .od-InlineCreateFolder-textInput{margin-right:7px}.od-InlineCreateFolder-textInput:focus,.od-InlineCreateFolder-textInput:hover{outline:1px solid transparent;border-color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-InlineCreateFolder-createButton{display:inline-block;width:32px;min-width:32px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding:0 0 3px 0}[dir=ltr] .od-InlineCreateFolder-createButton{margin-right:5px}[dir=rtl] .od-InlineCreateFolder-createButton{margin-left:5px}.od-InlineCreateFolder-createButtonIcon{font-size:18px;vertical-align:middle}.od-InlineCreateFolder-addFolderText{-ms-flex-positive:1;flex-grow:1;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:14px;cursor:pointer;outline:0}[dir=ltr] .od-InlineCreateFolder-addFolderText{padding-left:10px}[dir=rtl] .od-InlineCreateFolder-addFolderText{padding-right:10px}.od-InlineCreateFolder-icon{width:30px;min-width:30px;text-align:center;font-size:16px;color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";padding-top:2px;position:relative}[dir=ltr] .od-InlineCreateFolder-icon{left:-1px}[dir=rtl] .od-InlineCreateFolder-icon{right:-1px}.od-InlineCreateFolder-icon .od-LoadingSpinner-loadingGif{vertical-align:inherit}.od-InlineCreateFolder-error{font-size:12px;color:#a80000}[dir=ltr] .od-InlineCreateFolder-error{padding-left:38px}[dir=rtl] .od-InlineCreateFolder-error{padding-right:38px}"}])});
define("odsp-next/controls/infoBar/InfoBar",["require","exports","./InfoBarViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./InfoBar.html","./InfoBar.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-infoBar",template:e("./InfoBar.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/infoBar/InfoBarViewModel",["require","exports","tslib","../../bindings/html/BindableHtmlBinding","knockout","@ms/odsp-shared/lib/base/ViewModel","office-ui-fabric-react/lib/Styling"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.infoText=t.infoText;n.clickHandler=t.clickHandler;n._initInfoBarClasses();n.iconClass=i.observable("");n.infoBarClass=i.observable("");n.createComputed(function(){n.infoBarClass(n._infoBarClasses[t.type()].infoBarClass);n.iconClass(n._infoBarClasses[t.type()].iconClass)});t.linkText&&t.linkUrl;n.addBindingHandlers({bindableHtml:r.default});return n}t.prototype._initInfoBarClasses=function(){var e;this._infoBarClasses=((e={})[0]={iconClass:o.getIconClassName("Info"),infoBarClass:"ms-bgColor-info"},e[1]={iconClass:o.getIconClassName("Info"),infoBarClass:""},e[2]={iconClass:"od-InfoBar-iconPlaceholder",infoBarClass:"ms-bgColor-success"},e[3]={iconClass:o.getIconClassName("Warning")+" ms-fontColor-alert",infoBarClass:"od-InfoBar-alert"},e[4]={iconClass:o.getIconClassName("DRM")+" ms-fontColor-error",infoBarClass:"ms-bgColor-error"},e[5]={iconClass:o.getIconClassName("ErrorBadge")+" ms-fontColor-error",infoBarClass:"ms-bgColor-info"},e)};return t}(s.default);t.default=u});
define("odsp-next/controls/infoBar/InfoBar.html",[],function(){return'<div class=od-InfoBar data-bind="class: infoBarClass"><i class="od-InfoBar-icon ms-Icon" data-bind="class: iconClass"></i> <span class=od-InfoBar-text data-bind="bindableHtml: infoText"></span></div>'});
define("odsp-next/controls/infoBar/InfoBar.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-InfoBar{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";padding:6px 8px 8px 8px;display:-ms-flexbox;display:flex;-ms-flex-align:start;align-items:flex-start}html[dir=rtl] .od-InfoBar{padding:6px 8px 8px 8px}.od-InfoBar-icon{font-size:16px;padding-top:2px}[dir=ltr] .od-InfoBar-icon{padding-left:1px}[dir=rtl] .od-InfoBar-icon{padding-right:1px}.od-InfoBar-iconPlaceholder{width:31px}.od-InfoBar-alert{background-color:#fed9cc}.od-InfoBar-text{font-size:12px}[dir=ltr] .od-InfoBar-text{padding-left:8px}[dir=rtl] .od-InfoBar-text{padding-right:8px}"}])});
define("odsp-next/dataSources/web/odb/WebDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./WebDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/bindings/stickyFooter/StickyFooterBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","knockout"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=i.unwrap(n.valueAccessor());n._scrollContainer=r.scrollableElement();n._forceResize=r.forceResize;n._forceResize(!1);n.events.on(window,"resize",n._sizeContainer);n.subscribe(n._forceResize,n._forceResizeContainer);n._sizeContainer();return n}t.prototype._forceResizeContainer=function(){if(this._forceResize()){this._sizeContainer();this._forceResize(!1)}};t.prototype._sizeContainer=function(){var e=window.innerHeight,t=this._scrollContainer.getBoundingClientRect(),n=this.element.offsetHeight,r=e-t.top-n;this._scrollContainer.style.maxHeight=r.toString()+"px"};return t}(r.default);t.default=s});
define("odsp-next/controls/stillSpinning/StillSpinning",["require","exports","./StillSpinningViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./StillSpinning.html","./StillSpinning.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-stillSpinning",template:e("./StillSpinning.html"),viewModel:n.default});t.default=i});
define("odsp-next/controls/stillSpinning/StillSpinningViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","./StillSpinning.resx","../../bindings/css/VisibilityBinding","../progressSpinnerFlat/ProgressSpinnerFlat","../../controls/loadingSpinner/LoadingSpinner"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(n){var i=e.call(this,n)||this;i.addBindingHandlers({visibility:o.default});i.params=n;i.resx=s.strings;i.showControl=i.params.showControl||r.observable(!0);i.showSpinner=r.observable(!1);i.showStillWaiting=r.observable(!1);i.showError=r.observable(!1);i.errorImgUrl=window.require.toUrl("odsp-media/images/sitehub/error_icecream.png");i.spinnerTagName=0===i.params.spinnerType?a.default.tagName:u.default.tagName;i.spinnerParams=0===i.params.spinnerType?{loadingText:""}:{};i._spinnerTimeoutId=i.async.setTimeout(function(){i.showSpinner(!0);var e=i.params.stillWaitingTimeout;e?i._stillWaitingTimeoutId=i.async.setTimeout(function(){i.showStillWaiting(!0);i._startErrorTimeout()},e):i._startErrorTimeout()},i.params.spinnerTimeout||t.SPINNER_TIMEOUT);i.params.promise.then(function(e){i.showControl(!1);i._clearDataSourceTimeouts()},function(e){if(e&&e.retry){i.showControl(!1);i._clearDataSourceTimeouts()}else{i.showSpinner(!1);i.showStillWaiting(!1);i.showError(!0);i._clearDataSourceTimeouts()}});return i}t.prototype._startErrorTimeout=function(){var e=this;this.params.errorTimeout&&(this._errorTimeoutId=this.async.setTimeout(function(){e.showSpinner(!1);e.showStillWaiting(!1);e.showError(!0)},this.params.errorTimeout))};t.prototype._clearDataSourceTimeouts=function(){this._spinnerTimeoutId&&this.async.clearTimeout(this._spinnerTimeoutId);this._stillWaitingTimeoutId&&this.async.clearTimeout(this._stillWaitingTimeoutId);this._errorTimeoutId&&this.async.clearTimeout(this._errorTimeoutId)};t.SPINNER_TIMEOUT=1e3;return t}(i.default);t.default=f});
define("odsp-next/controls/stillSpinning/StillSpinning.html",[],function(){return'<div data-bind="if: showControl()"><div data-bind="component: {name: spinnerTagName, params: spinnerParams }, visibility: showSpinner()"></div>\x3c!--ko if: showStillWaiting()--\x3e<div class=od-StillSpinning-text aria-live=polite data-bind="text: resx.StillWaiting"></div>\x3c!--/ko--\x3e\x3c!--ko if: showError()--\x3e<div class=od-StillSpinning-error><img class=od-StillSpinning-imgError role=presentation data-bind="attr: {src: errorImgUrl}"><div class="ms-fontWeight-semibold ms-font-l ms-fontColor-neutralSecondary" data-bind="text: resx.Error"></div><div class="ms-font-s ms-fontColor-neutralSecondary" data-bind="text: resx.Refresh"></div></div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/stillSpinning/StillSpinning.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-StillSpinning-text{text-align:center;padding-top:10px}.od-StillSpinning-error{text-align:center}.od-StillSpinning-imgError{padding-bottom:10px}"}])});
define("@ms/odsp-utilities/lib/logging/events/Verbose.event",["require","exports","tslib","@ms/telemetry-manager/lib/events/Verbose.event","@ms/telemetry-manager/lib/events/Verbose.event"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.Verbose});
define("@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r;!function(e){e[e.invalidType=-1]="invalidType";e[e.noListTemplate=0]="noListTemplate";e[e.genericList=100]="genericList";e[e.documentLibrary=101]="documentLibrary";e[e.survey=102]="survey";e[e.links=103]="links";e[e.announcements=104]="announcements";e[e.contacts=105]="contacts";e[e.events=106]="events";e[e.tasks=107]="tasks";e[e.pictureLibrary=109]="pictureLibrary";e[e.webTemplateCatalog=111]="webTemplateCatalog";e[e.webPartCatalog=113]="webPartCatalog";e[e.listTemplateCatalog=114]="listTemplateCatalog";e[e.xmlFormLibrary=115]="xmlFormLibrary";e[e.masterPageCatalog=116]="masterPageCatalog";e[e.webPageLibrary=119]="webPageLibrary";e[e.customGrid=120]="customGrid";e[e.solutionCatalog=121]="solutionCatalog";e[e.themeCatalog=123]="themeCatalog";e[e.designCatalog=124]="designCatalog";e[e.appDataCatalog=125]="appDataCatalog";e[e.ganttTasks=150]="ganttTasks";e[e.promotedLinks=170]="promotedLinks";e[e.tasksWithTimelineAndHierarchy=171]="tasksWithTimelineAndHierarchy";e[e.meetings=200]="meetings";e[e.externalList=600]="externalList";e[e.mySiteDocumentLibrary=700]="mySiteDocumentLibrary";e[e.publishingPageLibrary=850]="publishingPageLibrary";e[e.publishingAsset=851]="publishingAsset";e[e.issueTracking=1100]="issueTracking";e[e.contentCenterModelLibrary=1328]="contentCenterModelLibrary";e[e.contentCenterPrimeLibrary=1329]="contentCenterPrimeLibrary";e[e.contentCenterSampleLibrary=1330]="contentCenterSampleLibrary"}(n=t.ListTemplateType||(t.ListTemplateType={}));!function(e){e[e.invalidType=-1]="invalidType";e[e.GenericList=0]="GenericList";e[e.DocumentLibrary=1]="DocumentLibrary"}(r=t.ListBaseType||(t.ListBaseType={}));var i=[n.mySiteDocumentLibrary,n.documentLibrary,n.pictureLibrary,n.xmlFormLibrary,n.webPageLibrary,n.publishingPageLibrary,n.publishingAsset];t.isDocumentLibrary=function(e){var t=Number(e);return-1!==i.indexOf(t)};t.isDocLib=function(e){return Number(e)===r.DocumentLibrary};t.isGenericList=function(e){return e===n.genericList||e===n.announcements||e===n.issueTracking||e===n.contacts||e===n.customGrid};t.isPromotedLinksList=function(e){return Number(e)===n.promotedLinks};t.default=n});
define("@ms/odsp-datasources/lib/dataSources/siteHeader/AcronymAndColorDataSource",["require","exports","tslib","../../interfaces/ISpPageContext","../base/CachedDataSource","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/encoding/UriEncoding"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.lightBlue=0]="lightBlue";e[e.blue=1]="blue";e[e.darkBlue=2]="darkBlue";e[e.teal=3]="teal";e[e.lightGreen=4]="lightGreen";e[e.green=5]="green";e[e.darkGreen=6]="darkGreen";e[e.lightPink=7]="lightPink";e[e.pink=8]="pink";e[e.magenta=9]="magenta";e[e.purple=10]="purple";e[e.black=11]="black";e[e.orange=12]="orange";e[e.red=13]="red";e[e.darkRed=14]="darkRed"}(t.PersonaInitialsColor||(t.PersonaInitialsColor={}));t.COLOR_SERVICE_POSSIBLE_COLORS=["#0078d7","#088272","#107c10","#881798","#b4009e","#e81123","#da3b01","#006f94","#005e50","#004e8c","#a80000","#4e257f"];var u=function(e){n.__extends(i,e);function i(t){return e.call(this,{dataSourceName:"SiteHeaderLogoAcronym",id:"acronymAndColors",cacheTimeoutTime:864e5},{pageContext:t})||this}i.decodeAcronymColor=function(e){return t.COLOR_SERVICE_POSSIBLE_COLORS.indexOf(e)+1};i.prototype.getAcronymData=function(e){return this.getAcronyms([e]).then(function(e){return e[0]},function(){return{acronym:void 0,color:void 0,text:void 0}})};i.prototype.getAcronyms=function(e,t){var n=this;void 0===t&&(t={});if(this._pageContext.webServerRelativeUrl){var i=t.qosName,u=void 0===i?"GetSiteHeaderLogoAcronym":i;return this.getDataUtilizingCache({getUrl:function(){var t=e.map(function(e){return"{Text: "+o.default.encodeURIComponent('"'+e+'"')+"}"}).join(",");return r.getSafeWebServerRelativeUrl(n._pageContext)+"/_api/sphome/GetAcronymsAndColors?labels=["+t+"]"},parseResponse:function(e){return JSON.parse(e).d.GetAcronymsAndColors.results.map(function(e){return{acronym:e.Acronym,color:e.Color,text:e.Text}})},method:"GET",qosName:u})}return s.default.reject(new Error("No web URL specified for request."))};return i}(i.CachedDataSource);t.AcronymAndColorDataSource=u;t.default=u});
define("@ms/odsp-datasources/lib/dataSources/base/CachedDataSource",["require","exports","tslib","./DataSource","./RequestCache"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,s=n.pageContext,o=n.requestCacheType,u=void 0===o?i.RequestCache:o;r._requestCache=new u(t,{pageContext:s});return r}t.prototype.getDataUtilizingCache=function(e){var t=this,r=e,i=r.getUrl,s=r.getAdditionalPostData,o=r.cacheRequestKey,u=r.useStale,a=void 0!==u&&u,f=r.bypassCache,l=void 0!==f&&f,c=r.onlyCache,h=void 0!==c&&c,p=r.checkForInvalidation,d=void 0!==p&&p,v=r.setInvalidated,m=void 0!==v&&v,g=n.__rest(r,["getUrl","getAdditionalPostData","cacheRequestKey","useStale","bypassCache","onlyCache","checkForInvalidation","setInvalidated"]);(g=n.__assign({url:i&&i(),additionalPostData:s&&s(),method:"POST"},g)).url=g.url||i&&i();"needsRequestDigest"in g||(g.needsRequestDigest=this.needsRequestDigest(g.url));g.additionalPostData=g.additionalPostData||s&&s();o=o||this.getRequestKey(g.url,g.method,g.additionalPostData);return this._requestCache.getDataUtilizingCache({cacheRequestKey:o,useStale:a,bypassCache:l,onlyCache:h,checkForInvalidation:d,setInvalidated:m,getData:function(){return t.dataRequestor.getData(g)}})};t.prototype.isCachedDataInvalidated=function(e){return this._requestCache.isCachedDataInvalidated&&this._requestCache.isCachedDataInvalidated(e)};t.prototype.getRequestKey=function(e,t,n){return this._requestCache.getRequestKey(e,t,n)};Object.defineProperty(t.prototype,"cacheId",{get:function(){return this._requestCache.cacheId},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"cacheVersionId",{get:function(){return this._requestCache.cacheVersionId},enumerable:!0,configurable:!0});t.prototype.flushCache=function(e){this._requestCache.flushCache(e)};return t}(r.default);t.CachedDataSource=s;t.default=s});
define("@ms/odsp-datasources/lib/dataSources/base/RequestCache",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","./IRequestCache"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){var n=e.id,o=e.cacheType,u=void 0===o?i.default.session:o,a=e.cacheTimeoutTime,f=void 0===a?s.DEFAULT_CACHE_TIMEOUT_TIME:a,l=t.cacheIdPrefix,c=void 0===l?s.DEFAULT_CACHE_ID_PREFIX:l,h=t.pageContext;this._cacheTimeoutTime=f;this._id=n;this._version=h?h.siteClientTag+"_"+h.userDisplayName:"";this._store=new r.default(c,u);this._storeDefaultCacheType=u;this._initCache()}e.prototype.getDataUtilizingCache=function(e){var t=this,r=e.cacheRequestKey,s=e.useStale,o=void 0!==s&&s,u=e.bypassCache,a=void 0!==u&&u,f=e.onlyCache,l=void 0!==f&&f,c=e.checkForInvalidation,h=e.setInvalidated,p=e.getData,d=this._cache,v=d[r];if(l)return v?n.default.resolve(v._value):n.default.resolve(void 0);c=c&&!a&&this._storeDefaultCacheType!==i.default.local;var m=v&&this._isCacheExpired(v,r,c);return a||!v||m&&!o?p().then(function(e){var n=(new Date).valueOf();d[r]={_fetched:n,_value:e};h&&t._store.setValue(r,n-1,i.default.local);t._updateCache();return e}):n.default.resolve(v._value)};e.prototype.getRequestKey=function(e,t,n){var r=[];r.push(e);r.push(t);n&&r.push(n.toString());return r.join(",")};e.prototype.isCachedDataInvalidated=function(e){var t=this._cache[e];return this._isCachedDataInvalidated(t,e)};Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!0,configurable:!0});e.prototype.flushCache=function(e){if(e){delete this._cache[e];this._updateCache()}else this._clearCache()};e.prototype._initCache=function(){if(this._version!==this._store.getValue(this.cacheVersionId,void 0,!1)){this._clearCache();this._store.setValue(this.cacheVersionId,this._version,void 0,!1)}else this._cache=this._store.getValue(this.cacheId,void 0,!1)||{}};e.prototype._updateCache=function(){this._store.setValue(this.cacheId,this._cache,void 0,!1)};e.prototype._clearCache=function(){this._cache={};this._updateCache()};e.prototype._isCacheExpired=function(e,t,n){if(n&&this._isCachedDataInvalidated(e,t))return!0;var r=(new Date).valueOf()-this._cacheTimeoutTime;return e._fetched<=r};e.prototype._isCachedDataInvalidated=function(e,t){var n=Number(this._store.getValue(t,i.default.local));return!!(e&&n&&e._fetched<n)};return e}();t.RequestCache=o;t.default=o});
define("@ms/odsp-datasources/lib/dataSources/base/IRequestCache",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DEFAULT_CACHE_TIMEOUT_TIME=3e5;t.DEFAULT_CACHE_ID_PREFIX="odsp-ds-"});
define("odsp-next/dataSources/url/odb/ItemUrlHelper",["require","exports","../../../resources/SPOResourceKeys","@ms/odsp-datasources/lib/utilities/url/ItemUrlHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemUrlHelper=r.ItemUrlHelper;t.SiteRelation=r.SiteRelation;t.resourceKey=i.createResolvedResourceKey(e("module").id,r.ItemUrlHelper,{pageContext:n.pageContext});t.default=r.ItemUrlHelper});
define("@ms/odsp-datasources/lib/utilities/url/ItemUrlHelper",["require","exports","tslib","@ms/odsp-utilities/lib/uri/SimpleUri","@ms/odsp-utilities/lib/string/StringHelper","./ItemUrlHelperBasic","@ms/odsp-utilities/lib/navigation/AddressParser","./ItemUrlHelperBasic"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(u,t);var a;!function(e){e[e.sameSite=0]="sameSite";e[e.crossSite=1]="crossSite";e[e.unknown=2]="unknown"}(a=t.SiteRelation||(t.SiteRelation={}));var f=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}Object.defineProperty(t.prototype,"isCrossDomain",{get:function(){return this._getIsCrossDomain()},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"isCrossList",{get:function(){return this._getIsCrossList()},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"siteRelation",{get:function(){return this._getSiteRelation()},enumerable:!0,configurable:!0});t.prototype._getIsCrossDomain=function(){var e=this._getCurrentAuthority(),t=!i.equalsCaseInsensitive(new r.default(this._getServerUrl()).authority,e);this._getIsCrossDomain=function(){return t};return t};t.prototype._getIsCrossList=function(){var e=this._getFullListUrl(),t=this._getDefaultListUrl(),n=!i.equalsCaseInsensitive(e,t);this._getIsCrossList=function(){return n};return n};t.prototype._getSiteRelation=function(){var e=a.unknown;if(this._getIsCrossDomain())e=a.crossSite;else if(void 0!==this.webUrl)e=i.equalsCaseInsensitive(s.removeDelimiter(this.defaultFullWebUrl),s.removeDelimiter(this._getFullWebUrl()))?a.sameSite:a.crossSite;else{var t=new r.default(this.defaultFullWebUrl).path,n=this._getServerRelativeListUrl()||this._getServerRelativePath();if(void 0!==n)if(s.startsWith(s.appendDelimiter(n),s.appendDelimiter(t))){var o=new r.default(s.removeDelimiter(n)),u=new r.default(s.removeDelimiter(t));e=o.segments.length-1===u.segments.length||o.segments.length-2===u.segments.length&&"Lists"===o.segments[o.segments.length-2]?a.sameSite:a.unknown}else e=a.crossSite}this._getSiteRelation=function(){return e};return e};t.prototype._getFullWebUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeWebUrl();void 0!==n&&(e=""+t+n);this._getFullWebUrl=function(){return e};return e};return t}(s.ItemUrlPartsBasic);t.ItemUrlParts=f;var l=function(e){n.__extends(t,e);function t(t,n){var r=n.itemUrlPartsType,i=void 0===r?f:r;return e.call(this,{context:n.pageContext,itemUrlPartsType:i})||this}t.prototype.getUrlParts=function(t){return e.prototype.getUrlParts.call(this,t)};t.prototype.getItemUrlParts=function(e){var t=o.deserializeQuery(e);return this.getUrlParts({path:t.id,listUrl:t.listurl})};return t}(s.ItemUrlHelperBasic);t.ItemUrlHelper=l});
define("@ms/odsp-datasources/lib/utilities/url/ItemUrlHelperBasic",["require","exports","@ms/odsp-utilities/lib/uri/SimpleUri","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){var t=e.defaultFullWebUrl,n=e.defaultListUrl,r=e.options,i=void 0===r?{}:r,s=i.path,u=void 0===s?void 0:s,a=i.listUrl,f=void 0===a?void 0:a,l=i.webUrl,c=void 0===l?void 0:l,h=i.mayInferListUrl,p=void 0!==h&&h;this.defaultFullWebUrl=o(t);this.defaultListUrl=o(n);this.path=o(u);this.listUrl=o(f);this.webUrl=o(c);this.mayInferListUrl=p}Object.defineProperty(e.prototype,"serverRelativeItemUrl",{get:function(){return s(this._getServerRelativeItemUrl())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"serverRelativeListUrl",{get:function(){return s(this._getServerRelativeListUrl())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"fullListUrl",{get:function(){return this._getFullListUrl()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"normalizedListUrl",{get:function(){return s(this._getNormalizedListUrl())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"fullItemUrl",{get:function(){return this._getFullItemUrl()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"normalizedItemUrl",{get:function(){return s(this._getNormalizedItemUrl())},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"listRelativeItemUrl",{get:function(){return this._getListRelativeItemUrl()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"webRelativeItemUrl",{get:function(){return this._getWebRelativeItemUrl()},enumerable:!0,configurable:!0});e.prototype._getCurrentAuthority=function(){var e=new n.default(this.defaultFullWebUrl).authority;this._getCurrentAuthority=function(){return e};return e};e.prototype._getNormalizedItemUrl=function(){var e,t=this._getFullItemUrl();if(void 0!==t){var i=new n.default(t);e=r.equalsCaseInsensitive(i.authority,this._getCurrentAuthority())?i.path:t}this._getNormalizedItemUrl=function(){return e};return e};e.prototype._getNormalizedListUrl=function(){var e,t=this._getFullListUrl(),i=this._getDefaultListUrl();void 0===t||r.equalsCaseInsensitive(t,i)||(e=r.equalsCaseInsensitive(new n.default(t).authority,this._getCurrentAuthority())?this._getServerRelativeListUrl():t);this._getNormalizedListUrl=function(){return e};return e};e.prototype._getServerUrl=function(){var e=this.path&&new n.default(this.path).authority||this.listUrl&&new n.default(this.listUrl).authority||this.webUrl&&new n.default(this.webUrl).authority||this.defaultListUrl&&new n.default(this.defaultListUrl).authority||new n.default(this.defaultFullWebUrl).authority;this._getServerUrl=function(){return e};return e};e.prototype._getServerRelativeListUrl=function(){var e;if(void 0!==this.listUrl)e=new n.default(this.listUrl).path;else{var t=this._getDefaultListUrl(),r=this.mayInferListUrl;if(void 0!==t||r){var i=this._getServerRelativePath(),s=new n.default(t).path;if(void 0===i&&(void 0===this.webUrl||s&&a(u(s),u(this._getServerRelativeWebUrl())))||s&&a(u(i),u(s)))e=s;else if(void 0!==i&&(""===this.defaultListUrl||r)){var o=this._getServerRelativeWebUrl();if(a(u(i),u(o))){var f=new n.default(i).segments[new n.default(o).segments.length];e=""+u(o)+f}}}}this._getServerRelativeListUrl=function(){return e};return e};e.prototype._getFullListUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeListUrl();void 0!==n&&(e=""+t+n);return e};e.prototype._getFullItemUrl=function(){var e,t=this._getServerUrl(),n=this._getServerRelativeItemUrl();void 0!==n&&(e=""+t+n);this._getFullItemUrl=function(){return e};return e};e.prototype._getServerRelativeWebUrl=function(){var e,t;if(void 0!==this.webUrl)e=new n.default(this.webUrl).path;else if(!this.defaultListUrl&&!this.listUrl||this.mayInferListUrl||void 0===(t=this._getServerRelativeListUrl()))this.defaultFullWebUrl&&(e=new n.default(this.defaultFullWebUrl).path);else{var r=new n.default(t);e=""+r.segments.slice(0,-1).join("/")}this._getServerRelativeWebUrl=function(){return e};return e};e.prototype._getServerRelativePath=function(){var e;void 0!==this.path&&(e=new n.default(this.path).path);this._getServerRelativePath=function(){return e};return e};e.prototype._getServerRelativeItemUrl=function(){var e;this.path?e=this._getServerRelativePath():this.listUrl?e=this._getServerRelativeListUrl():this.webUrl?e=this._getServerRelativeWebUrl():this.defaultListUrl?e=this._getServerRelativeListUrl():this.defaultFullWebUrl&&(e=this._getServerRelativeWebUrl());this._getServerRelativeItemUrl=function(){return e};return e};e.prototype._getListRelativeItemUrl=function(){var e,t,n=this._getServerRelativePath(),r=this._getServerRelativeListUrl();void 0!==this.path&&void 0!==r&&a(u(n),t=u(r))&&(e=n&&n.substring(t.length));this._getListRelativeItemUrl=function(){return e};return e};e.prototype._getWebRelativeItemUrl=function(){var e,t,n=this._getServerRelativePath(),r=this._getServerRelativeWebUrl();void 0!==this.path&&void 0!==r&&a(u(n),t=u(r))&&(e=n&&n.substring(t.length));this._getWebRelativeItemUrl=function(){return e};return e};e.prototype._getDefaultListUrl=function(){var e;void 0!==this.defaultListUrl&&(e=new n.default(this.defaultListUrl).authority?this.defaultListUrl:""+this._getCurrentAuthority()+this.defaultListUrl);this._getDefaultListUrl=function(){return e};return e};return e}();t.ItemUrlPartsBasic=i;function s(e){return""===e?"/":e}function o(e){return"/"===e?"/":e}t.removeDelimiter=function(e){void 0===e&&(e="");return"/"===e[e.length-1]?e.substring(0,e.length-1):e};function u(e){void 0===e&&(e="");return"/"===e[e.length-1]?e:e+"/"}t.appendDelimiter=u;function a(e,t){var n=e.toUpperCase(),r=t&&t.toUpperCase();return n.substring(0,r&&r.length||0)===r}t.startsWith=a;var f=function(){function e(e){var t=e.context,n=e.itemUrlPartsType,r=void 0===n?i:n;this.itemUrlPartsType=r;this.itemUrlContext=t}e.prototype.getUrlParts=function(e){var t=this.itemUrlContext,n=t.webAbsoluteUrl,r=t.listUrl;return new this.itemUrlPartsType({defaultFullWebUrl:n,defaultListUrl:r,options:e})};return e}();t.ItemUrlHelperBasic=f});
define("odsp-next/utilities/uri/EnvironmentHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isGallatin=function(e){return e?"gallatin"===e:location.origin.indexOf(".cn")===location.origin.length-3};t.isBlackForest=function(e){return e?"blackforest"===e:location.origin.indexOf(".de")===location.origin.length-3};t.isGovernmentTenant=function(e){return"pathfinder"===e||"trailblazer"===e};t.isPPE=function(e){return"prodbubble"===e}});
define("odsp-next/controls/folderSelect/FolderSelect.html",[],function(){return'<div class=od-FolderSelect-panel><div class=od-FolderSelect-region><div class=od-FolderSelect-title data-bind="text: moveCopyText"></div><div class=od-FolderSelect-title-fileInfo>\x3c!--ko if: isSingleItem--\x3e\x3c!--ko component: { name: \'ms-fileName-with-icon\', params: { oneDriveItem: fileItem} }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if: packageTooBig--\x3e<div class=od-FolderSelect-infoBar data-bind="css: { \'od-FolderSelect-infoBarClickable\': showMinimalPackageWarning }, component: {name: infoBarTagName, params: infoBarParams}, click: onInfoBarClick"></div><div class=ms-accessible aria-live=polite data-bind="text: packageSizeWarning"></div>\x3c!--/ko--\x3e<div class=od-FolderSelect-breadCrumbContainer><span class="od-FolderSelect-breadCrumbRootIcon od-FolderSelect-clickableCrumb" role=button data-bind="click: onBreadCrumbRootClick, keyboard: { mappings: { Enter: onBreadCrumbRootClick, Space: onBreadCrumbRootClick } }, style: { display: hasBackToRootButton() ? \'\' : \'none\' }, attr: { title: placesAltText, tabindex: hasBackToRootButton() ? 0 : -1 , \'aria-label\': placesAltText }"><i class="ms-Icon ms-Icon--DoubleChevronLeft" data-bind="icon: true"></i></span> <span class="od-FolderSelect-breadCrumbItem ms-fontWeight-semilight" role=button data-bind="text: parentFolderName, class: parentBreadCrumbClass, click: onBreadCrumbParentClick, keyboard: { mappings: { Enter: onBreadCrumbParentClick, Space: onBreadCrumbParentClick } }, style: { display: parentFolderName() ? \'\' : \'none\' }, attr: { title: parentFolderName, tabindex: isParentBreadCrumbClickable() ? 0 : -1 , \'aria-label\': parentFolderName}"></span> <i class="od-FolderSelect-breadCrumbIcon ms-Icon ms-Icon--ChevronRight" data-bind="style: {display: parentFolderName() ? \'\' : \'none\'}" aria-hidden=true></i> <span class="od-FolderSelect-breadCrumbItem ms-fontWeight-semibold" data-bind="text: currentFolderName, attr: { title: currentFolderName }"></span></div><div class=od-FolderSelect-ruledLine aria-hidden=true></div>\x3c!--ko if:loading--\x3e<div class=od-FolderSelect-loading data-bind="component: {name: loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:loading--\x3e\x3c!--ko if: itemOne.isActive()--\x3e<div data-bind="automationType: \'FolderSelectContent\', template: { name: \'od-folder-select-content\', data: itemOne, afterRender: itemOne.resizeStickyFooter.bind(true) }"></div>\x3c!--/ko--\x3e\x3c!--ko if: itemTwo.isActive()--\x3e<div data-bind="automationType: \'FolderSelectContent\', template: { name: \'od-folder-select-content\', data: itemTwo, afterRender: itemTwo.resizeStickyFooter.bind(true) }"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if: waitingForItem--\x3e<div class=od-FolderSelect-waitingForData data-bind="component: {name: stillSpinningTagName, params: waitingForItemParams}"></div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/folderSelect/FolderSelectContent.html",[],function(){return'<div class=od-FolderSelect-itemAnimation data-bind="class: className, element: element">\x3c!--ko if: item().error--\x3e<div class="od-folderSelect-itemError od-folderSelect-itemErrorPadding" aria-live=assertive data-bind="text: item().error"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: item().error--\x3e\x3c!--ko if: item().sections--\x3e<div class=od-FolderSelect-itemsRegion data-bind="element: regionElement"><div class=od-FolderSelect-sectionContainer data-bind="foreach: item().sections">\x3c!--ko if: title--\x3e<div class=od-FolderSelect-sectionHeader data-bind="text: title"></div>\x3c!--/ko--\x3e\x3c!--ko if: items().length > 0--\x3e<div class=od-FolderSelect-itemsContainer tabindex=0 role=list data-bind="foreach: items, element: listElement, attr: { tabindex: focusedItem() ? -1 : 0, \'aria-label\': altTitle }, selection: { data: items, mode: \'single\', direction: \'vertical\', focused: focusedItem, selectFirstItemOnActivate: true, clearSelectionOnRemoval: true }"><div class=od-FolderSelect-itemWrapper><div class="od-FolderSelect-itemContainer od-FolderSelect-clickable" role=listitem data-bind="click: $component.onItemClick.bind($data), keyboard: { mappings: { Enter: $component.onKeyEnter, Space: $component.onKeyEnter }}, css: {\'is-focused\': focused }, attr: { tabindex: focused() || selected() ? 0 : -1, \'aria-label\': title }, hasFocus: focused"><i role=presentation class="ms-Icon ms-Icon--OneDrive" data-bind="icon: true, style: {display: $component.isOneDrive($data) ? \'\' : \'none\'}"></i>\x3c!--ko if: $component.isSite($data)--\x3e<span class=od-FolderSelect-siteIcon data-bind="component: { name: $component.siteIconTagName, params: siteIcon }"></span>\x3c!--/ko--\x3e\x3c!--ko if: $component.isLibraryOrFolder($data)--\x3e<span class=od-FolderSelect-folderIcon data-bind="component: { name: $component.fileTypeIconTagName, params: { iconName: folderIcon, desiredSize: 16 } }"></span>\x3c!--/ko--\x3e<span class=od-FolderSelect-itemTitle data-bind="text: title"></span></div></div></div>\x3c!--/ko--\x3e\x3c!--ko if: showMoreInfo--\x3e<div class=od-folderSelect-itemInfo aria-live=polite data-bind="text: showMoreInfo"></div>\x3c!--/ko--\x3e\x3c!--ko if: showMoreError--\x3e<div class=od-folderSelect-itemError aria-live=assertive data-bind="text: showMoreError"></div>\x3c!--/ko--\x3e\x3c!--ko if: showMore--\x3e<div>\x3c!--ko ifnot: showMoreLoading()--\x3e<div class=od-FolderSelect-itemWrapper><a class="od-FolderSelect-showMore od-folderSelect-showMoreExtra od-FolderSelect-clickable" role=button tabindex=0 data-bind="click: $component.onShowMoreClick.bind($data), keyboard: { mappings: { Enter: $component.onShowMoreClick.bind($data), Space: $component.onShowMoreClick.bind($data) }}, css: {\'is-focused\': showMoreFocused }, attr: { \'aria-label\': $component.getShowMoreAccText($data) }, hasFocus: showMoreFocused, text: $component.getShowMoreText($data), automationType: \'FolderSelectShowMoreSites\'"></a></div>\x3c!--/ko--\x3e\x3c!--ko if: showMoreLoading--\x3e<div class=od-FolderSelect-showMoreLoading aria-busy=true data-bind="component: {name: $component.loadingSpinnerTagName, params: { loadingText: \'\' }}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--ko if: item().subItems--\x3e<div class=od-FolderSelect-itemsRegion data-bind="element: regionElement">\x3c!--ko if: item().subItems().length > 0--\x3e<div class=od-FolderSelect-itemsContainer role=list data-bind="foreach: item().subItems, element: listElement, selection: { data: item().subItems, mode: \'single\', direction: \'vertical\', focused: $component.focusedItem, selectionModel: $component.selectionModel, selectFirstItemOnActivate: true, clearSelectionOnRemoval: true }, attr: { \'aria-label\': $component.getListType(item()), tabindex: $component.selectionModel.selection().length > 0 ? -1 : 0, }, css: { \'od-FolderSelect-addBottomMargin\' : !$component.showAddFolder() }">\x3c!--ko if: $index() === 0--\x3e<div class=od-FolderSelect-destinationHeader data-bind="text: $component.chooseDestination"></div>\x3c!--/ko--\x3e<div class=od-FolderSelect-itemWrapper><div class="od-FolderSelect-itemContainer od-FolderSelect-clickable" role=listitem data-bind="click: $component.onItemClick.bind($data), keyboard: { mappings: { Enter: $component.onKeyEnter, Space: $component.onKeyEnter }}, css: {\'is-focused\': focused, \'is-selected\': selected}, attr: { tabindex: focused() || selected() ? 0 : -1, \'aria-label\': title}, hasFocus: focused"><span class=od-FolderSelect-folderIcon data-bind="component: { name: $component.fileTypeIconTagName, params: { iconName: folderIcon, desiredSize: 16 } }"></span> <span class=od-FolderSelect-itemTitle data-bind="text: title"></span></div></div></div>\x3c!--/ko--\x3e\x3c!--ko if: $component.showAddFolder()--\x3e<div class=od-FolderSelect-addFolder data-bind="css: { \'od-FolderSelect-addTopMargin\' : item().subItems().length === 0 }"><div class=od-FolderSelect-itemWrapper data-bind="css: { \'od-FolderSelect-hidden\': !$component.newFolderActive() }"><div class="od-FolderSelect-addFolderContainer od-FolderSelect-clickable" data-bind="component: { name: $component.inlineCreateFolderTagName, params: { item: $component.getCurrentItem().oneDriveItem, newFolderItem: $component.newFolderItem, focused: $component.addFolderFocused, newItemFocused: $component.newFolderItemFocused, isActive: $component.newFolderActive }}"></div></div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e<div class=od-FolderSelect-stickyFooter data-bind="stickyFooter: { scrollableElement: regionElement, forceResize: resizeStickyFooter }">\x3c!--ko if: $component.showBottomLine(item())--\x3e<div class=od-FolderSelect-ruledLine role=separator aria-hidden=true></div>\x3c!--/ko--\x3e\x3c!--ko if: $component.getStatusText(item())--\x3e<div class=od-FolderSelect-statusLabel><span role=status data-bind="text: $component.getStatusText(item())"></span></div>\x3c!--/ko--\x3e\x3c!--ko if: $component.isLibraryOrFolderOrOneDrive(item())--\x3e<div class=od-FolderSelect-actionContainer><button class="od-Button od-Button--primary" data-bind="click: $component.onUseLocationClick, enable: $component.chooseLocationButtonEnabled, automationType: \'FolderSelectUseLocation\', delayedHasFocus: $component.useLocationFocused, attr: { \'aria-label\': $component.getChooseLocationAccText(item()) }"><span class=od-Button-label data-bind="text: $component.chooseLocationText"></span></button></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/folderSelect/FolderSelect.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-FolderSelect-panel{position:absolute;top:0;height:100%;width:100%}[dir=ltr] .od-FolderSelect-panel{left:0}[dir=rtl] .od-FolderSelect-panel{right:0}.od-FolderSelect-region{padding-top:15px}[dir=ltr] .od-FolderSelect-region{padding-left:40px}[dir=rtl] .od-FolderSelect-region{padding-right:40px}.isFluent .od-FolderSelect-region{padding-top:22px}[dir=ltr] .isFluent .od-FolderSelect-region{padding-left:16px}[dir=rtl] .isFluent .od-FolderSelect-region{padding-right:16px}[dir=ltr] .isFluent .od-FolderSelect-region{padding-right:16px}[dir=rtl] .isFluent .od-FolderSelect-region{padding-left:16px}.od-FolderSelect-loading{padding-top:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-FolderSelect-title{font-size:21px;font-weight:100}.isFluent .od-FolderSelect-title{font-size:20px;font-weight:600;margin-bottom:26px}.od-FolderSelect-title-fileInfo{font-size:14px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:20px}[dir=ltr] .od-FolderSelect-title-fileInfo{padding-right:40px}[dir=rtl] .od-FolderSelect-title-fileInfo{padding-left:40px}.isFluent .od-FolderSelect-title-fileInfo{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-FolderSelect-breadCrumbContainer{padding:10px 40px 10px 0;font-size:14px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;cursor:default}html[dir=rtl] .od-FolderSelect-breadCrumbContainer{padding:10px 0 10px 40px}[dir=ltr] .od-FolderSelect-breadCrumbContainer{margin-left:-4px}[dir=rtl] .od-FolderSelect-breadCrumbContainer{margin-right:-4px}.isFluent .od-FolderSelect-breadCrumbContainer{padding:45px 16px 10px 0}html[dir=rtl] .isFluent .od-FolderSelect-breadCrumbContainer{padding:45px 0 10px 16px}.od-FolderSelect-breadCrumbItem{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 4px;padding-bottom:2px;height:30px;line-height:30px}.isFluent .od-FolderSelect-breadCrumbItem{height:20px;line-height:20px;padding-bottom:0}.od-FolderSelect-clickableCrumb{cursor:pointer}.od--isNonMobile .od-FolderSelect-clickableCrumb:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";outline:1px solid transparent}.od-FolderSelect-breadCrumbRootIcon{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:10px;height:30px;line-height:30px;font-weight:800}[dir=ltr] .od-FolderSelect-breadCrumbRootIcon{padding-right:4px}[dir=rtl] .od-FolderSelect-breadCrumbRootIcon{padding-left:4px}[dir=ltr] .od-FolderSelect-breadCrumbRootIcon{padding-left:2px}[dir=rtl] .od-FolderSelect-breadCrumbRootIcon{padding-right:2px}.od-FolderSelect-breadCrumbIcon{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:10px;font-weight:800;padding:0;font-family:FabricMDL2Icons;font-style:normal}.od-FolderSelect-ruledLine{border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}[dir=ltr] .od-FolderSelect-ruledLine{margin-left:-40px}[dir=rtl] .od-FolderSelect-ruledLine{margin-right:-40px}[dir=ltr] .isFluent .od-FolderSelect-ruledLine{margin-left:0}[dir=rtl] .isFluent .od-FolderSelect-ruledLine{margin-right:0}.od-FolderSelect-sectionHeader{margin-top:10px;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.isFluent .od-FolderSelect-sectionHeader{margin-top:12px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-FolderSelect-destinationHeader{padding-bottom:10px;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-FolderSelect-waitingForData{padding-top:10px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:12px}.od-FolderSelect-sectionContainer{padding-bottom:10px}.od-FolderSelect-itemsContainer{margin-top:10px;outline:0}.od-FolderSelect-itemsRegion{overflow-y:auto;overflow-x:hidden}[dir=ltr] .od-FolderSelect-itemsRegion{padding-left:40px}[dir=rtl] .od-FolderSelect-itemsRegion{padding-right:40px}[dir=ltr] .isFluent .od-FolderSelect-itemsRegion{padding-left:16px}[dir=rtl] .isFluent .od-FolderSelect-itemsRegion{padding-right:16px}.od-FolderSelect-addTopMargin{margin-top:10px}.od-FolderSelect-addBottomMargin{margin-bottom:10px}.od-FolderSelect-itemContainer,.od-FolderSelect-showMore{overflow:hidden;height:28px;padding-top:5px;padding-bottom:5px;width:100%;white-space:nowrap;text-overflow:ellipsis;min-height:28px}.isFluent .od-FolderSelect-itemContainer,.isFluent .od-FolderSelect-showMore{height:24px;min-height:24px}.od-FolderSelect-itemContainer .ms-Icon--OneDrive{vertical-align:top;line-height:28px;width:28px}.sm .od-FolderSelect-itemContainer .ms-Icon--OneDrive{line-height:20px}.isFluent .od-FolderSelect-itemContainer .ms-Icon--OneDrive{width:24px;line-height:24px}[dir=ltr] .od-FolderSelect-itemWrapper{padding-right:40px}[dir=rtl] .od-FolderSelect-itemWrapper{padding-left:40px}[dir=ltr] .isFluent .od-FolderSelect-itemWrapper{padding-right:16px}[dir=rtl] .isFluent .od-FolderSelect-itemWrapper{padding-left:16px}.od-folderSelect-showMoreExtra{display:block;font-size:13px;line-height:28px}.isFluent .od-folderSelect-showMoreExtra{box-sizing:border-box;height:38px;min-height:38px}[dir=ltr] .isFluent .od-folderSelect-showMoreExtra{padding-left:36px}[dir=rtl] .isFluent .od-folderSelect-showMoreExtra{padding-right:36px}.isFluent .od-folderSelect-showMoreExtra:hover{background:0 0}.od-FolderSelect-showMoreLoading{padding-top:5px;padding-bottom:5px}.od-FolderSelect-clickable{cursor:pointer}[dir=ltr] .od-FolderSelect-clickable{padding-left:5px}[dir=rtl] .od-FolderSelect-clickable{padding-right:5px}[dir=ltr] .od-FolderSelect-clickable{margin-left:-5px}[dir=rtl] .od-FolderSelect-clickable{margin-right:-5px}.od-FolderSelect-clickable .ms-Icon--OneDrive{color:#094ab2;font-size:23px;padding-top:0;vertical-align:middle}[dir=ltr] .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-left:3px}[dir=rtl] .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-right:3px}[dir=ltr] .isFluent .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-left:0}[dir=rtl] .isFluent .od-FolderSelect-clickable .ms-Icon--OneDrive{padding-right:0}.od-FolderSelect-clickable .od-FolderSelect-itemTitle{font-size:14px;vertical-align:middle}[dir=ltr] .od-FolderSelect-clickable .od-FolderSelect-itemTitle{padding-left:8px}[dir=rtl] .od-FolderSelect-clickable .od-FolderSelect-itemTitle{padding-right:8px}.od-FolderSelect-clickable:focus{outline:1px solid transparent;background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-FolderSelect-clickable:focus{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.od-FolderSelect-clickable:focus{background:#00c0ff}}.od-FolderSelect-clickable.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:" inset;outline:1px solid transparent}.od--isNonMobile .od-FolderSelect-clickable:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";outline:1px solid transparent}.isFluent.od--isNonMobile .od-FolderSelect-clickable:hover{background:0 0}.od-FolderSelect-folderIcon{width:28px;text-align:center;display:inline-block}.od-FolderSelect-siteIcon{position:relative;display:inline-block;vertical-align:top;width:28px;height:28px}.isFluent .od-FolderSelect-siteIcon{width:24px;height:24px}[dir=ltr] .od-FolderSelect-stickyFooter{padding-left:40px}[dir=rtl] .od-FolderSelect-stickyFooter{padding-right:40px}.od-FolderSelect-statusLabel{font-size:14px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";padding-top:15px}[dir=ltr] .od-FolderSelect-statusLabel{padding-right:40px}[dir=rtl] .od-FolderSelect-statusLabel{padding-left:40px}.od-folderSelect-itemError{color:#a80000;font-size:13px;margin-top:10px}[dir=ltr] .od-folderSelect-itemError{padding-right:40px}[dir=rtl] .od-folderSelect-itemError{padding-left:40px}.od-folderSelect-itemInfo{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:13px}[dir=ltr] .od-folderSelect-itemInfo{padding-right:40px}[dir=rtl] .od-folderSelect-itemInfo{padding-left:40px}[dir=ltr] .od-folderSelect-itemErrorPadding{padding-left:40px}[dir=rtl] .od-folderSelect-itemErrorPadding{padding-right:40px}.od-FolderSelect-addFolder{margin-bottom:10px}.od-FolderSelect-hidden{display:none}.od-FolderSelect-addFolderContainer{min-height:38px}.od-FolderSelect-actionContainer{padding-top:20px;padding-bottom:20px;white-space:nowrap}.od-FolderSelect-itemAnimation{width:100%;position:absolute;transition:left .3s,right .3s;-webkit-transition:left .3s,right .3s}[dir=ltr] .od-FolderSelect-itemEnterLeft{left:-300px}[dir=rtl] .od-FolderSelect-itemEnterLeft{right:-300px}[dir=ltr] .od-FolderSelect-itemEnterRight{left:300px}[dir=rtl] .od-FolderSelect-itemEnterRight{right:300px}[dir=ltr] .od-FolderSelect-itemInitial{left:0}[dir=rtl] .od-FolderSelect-itemInitial{right:0}.od-FolderSelect-infoBar{padding-top:10px;cursor:default}[dir=ltr] .od-FolderSelect-infoBar{padding-right:40px}[dir=rtl] .od-FolderSelect-infoBar{padding-left:40px}.od-FolderSelect-infoBarClickable{cursor:pointer}.od-FolderSelect-sharingHint{width:32px;height:32px;padding:0 10px;background-color:transparent;margin:0 10px;border:none}html[dir=ltr] .od-FolderSelect-sharingHint{float:right}html[dir=rtl] .od-FolderSelect-sharingHint{float:left}html[dir=ltr] .od-FolderSelect-sharingHintTooltip{float:right}html[dir=rtl] .od-FolderSelect-sharingHintTooltip{float:left}.od-FolderSelect-sharingHintIcon{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";size:16pt;position:relative;cursor:pointer;padding:8px}[dir=ltr] .od-FolderSelect-sharingHintIcon{right:9px}[dir=rtl] .od-FolderSelect-sharingHintIcon{left:9px}.od-FolderSelect-sharingInfoText{width:150px;word-wrap:break-word}html[dir=ltr] .od-FolderSelect-sharingInfoText{text-align:left}html[dir=rtl] .od-FolderSelect-sharingInfoText{text-align:right}.od-FolderSelect-fileItemName{vertical-align:bottom}"}])});
define("odsp-next/controls/fileNameWithIcon/FileNameWithIcon",["require","exports","./FileNameWithIconViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FileNameWithIcon.html","./FileNameWithIcon.css","../fileTypeIcon/FileTypeIcon"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-fileName-with-icon",template:e("./FileNameWithIcon.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/fileNameWithIcon/FileNameWithIconViewModel",["require","exports","tslib","../fieldRender/iconField/IconFieldViewModel","@ms/odsp-shared/lib/base/ViewModel","../fileTypeIcon/FileTypeIcon","../../utilities/accessibility/AriaHelper","../fluentStyling/FluentStyling.key"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=16,f=20,l=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,i=t.oneDriveItem;n.fileName=i.name;n.fileTypeIconTagName=s.default.tagName;var l=n.createObservable(i);n._isFluentEnabled=n.resources.consume(u.resourceKey);n.fileTypeIconParams={iconName:i.iconName,iconUrl:i.iconUrl,extension:i.extension,desiredSize:n._isFluentEnabled?f:a,overlayType:r.default.getOverlayType(l),iconFieldAriaLabel:o.getIconFieldAriaLabelForItem(i)||"",hoverText:r.default.getHoverText(l)};return n}return t}(i.default);t.default=l});
define("odsp-next/controls/fileNameWithIcon/FileNameWithIcon.html",[],function(){return'<span><span class=od-FileNameWithIcon-icon data-bind="component: { name: fileTypeIconTagName, params: fileTypeIconParams }"></span> <span class=od-FileNameWithIcon-fileName data-bind="text: fileName"></span></span>'});
define("odsp-next/controls/fileNameWithIcon/FileNameWithIcon.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-FileNameWithIcon-fileName{vertical-align:bottom}[dir=ltr] .od-FileNameWithIcon-fileName{padding-left:3px}[dir=rtl] .od-FileNameWithIcon-fileName{padding-right:3px}.isFluent .od-FileNameWithIcon-fileName{vertical-align:middle}[dir=ltr] .isFluent .od-FileNameWithIcon-fileName{padding-left:5px}[dir=rtl] .isFluent .od-FileNameWithIcon-fileName{padding-right:5px}.od-FileNameWithIcon-icon .FileTypeIcon{width:20px;height:20px}"}])});
define("odsp-next/controls/folderTree/FolderTree",["require","exports","./FolderTreeViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FolderTree.html","./FolderTreeRow.html","../inlineFolderBuilder/InlineFolderBuilder","./FolderTree.css","../fileTypeIcon/FileTypeIcon"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-folder-tree",template:e("./FolderTree.html"),viewModel:n.default,synchronous:!0});r.registerTemplate("od-folder-tree-row",e("./FolderTreeRow.html"));t.default=i});
define("odsp-next/controls/folderTree/FolderTreeViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../resources/ControlResourceKeys","../../providers/item/ItemProvider","./FolderTreeUtility","../../bindings/selection/SelectionBinding","../../bindings/keyboard/KeyboardBinding","../../models/selection/SelectionModel","../../resources/DataSourceResourceKeys","./FolderTreeCommandSet","@ms/odsp-utilities/lib/async/Promise","./FolderTree.resx","../../dataSources/url/QueryType","../../providers/sharing/SharingProvider","../../models/item/IItemTypeFilter","../../utilities/features/Features","../../utilities/sharing/SharingHelper","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../loadingSpinner/LoadingSpinner","../../bindings/focus/DelayedHasFocusBinding","../commandBar/CommandBar.key","../../bindings/component/ControlBinding","../../actions/vault/VaultActionType","../../controls/fluentStyling/FluentStyling.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var L=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._folderTreeWidth=260;n._folderTreeIndent=20;n.loadingSpinnerTagName=S.default.tagName;n.context=t.context;n.onComplete=t.onComplete;n.title=t.title;n.dataUpdated=r.observable(!1);n.isDisabled=r.observable(!1);n.isNewFolderDisabled=r.observable(!1);n.hasData=r.observable(!1);n.height=document.body.clientHeight+"px";n._platform=n.resources.consume(E.platformDetection);n.isMobile=n._platform.isMobile;n.rootFolderItem=r.observable();n.sharedFolderItem=r.observable();n.focusedItem=r.observable();n.selectedItems=r.observableArray();n.selectionModel=new l.default;n.itemArrayForSelection=r.observableArray();n.isRtl=w.default.isRightToLeft;n.loadingImageUrl=window.require.toUrl("odsp-media/images/loading/loadingspinner.gif");n._urlDataSource=n.resources.consume(c.url);n._moveCopyDataSource=n.resources.consume(c.copy);n.newFolderName=r.observable("");n.needsRefocus=r.observable(!1);n.loadingText=d.strings.loadingText;n.addBindingHandlers({selection:a.default,delayedHasFocus:x.default,control:N.default,keyboard:f.default});n.keyboardOptions=[{target:null,useRtlMappings:!0,mappings:{Down:n.keyDown,Up:n.keyUp,Left:n.keyLeft,Right:n.keyRight,Enter:n.onEnter}},{useRtlMappings:!0,target:window,mappings:{}}];n.subscribe(n.dataUpdated,n._updateItemSet);n.subscribe(n.needsRefocus,n._setFocus);n._itemProvider=n.resources.consume(o.resourceKey);n._actionMap=n.resources.consume(s.actionMap);n._currentSet=n.resources.consume(s.currentItemSet);n._itemSet=r.observable(null);n._sharedItemSet=r.observable(null);n._sharingProvider=n.resources.consume(m.resourceKey);n.showStatusInfo=r.observable(!1);n.statusInfoText=r.observable("");n.isFluentEnabled=n.resources.consume(k.resourceKey);var i=n._currentSet().item();n.showSharedRoot=n._moveCopyDataSource.getCapabilities().supportsMoveCopyOnShared&&0!==i.sharingRole&&i.queryType!==v.default.SharedWithMe;n._fetchParentItem(i);n.titleAccessibilityHint=d.strings.titleAccessibilityHint;n.commandBarSpecification=N.toSpecification(T.resourceKey,{commandSet:new(n.managed(h.default))({componentViewModel:n})});return n}t.prototype.getWidth=function(e,t,n){return e._folderTreeWidth-e._folderTreeIndent*t.level};t.prototype.onClick=function(e,t,n){e.focusedItem()&&e.focusedItem().showNewFolderInput(!1);e._selectFolder(t);if(t.isOpen()){e._closeChildren(t);e._updateSelectionArray()}else{t.isLoading(!0);e._showChildren(t)}};t.prototype.getFluentRowPadding=function(e){return this.isRtl?"0 "+(17+30*e.level)+"px 0 0 ":"0 0 0 "+(17+30*e.level)+"px"};t.prototype.onStatusActionClick=function(){var e=this;new(this.managed(this._actionMap.VaultAction))({actionType:C.default.Unlock,usePopup:!0}).execute(null).then(function(){e._showChildren(e.focusedItem(),!0)})};t.prototype.keyLeft=function(e,t){this.focusedItem().showNewFolderInput(!1);if(this.focusedItem().isOpen()){e._closeChildren(this.focusedItem());e._updateSelectionArray()}else if(this.focusedItem().parent){var n=this.focusedItem().parent;e._changeSelection(n);e._selectFolder(n)}t.stopPropagation();return!0};t.prototype.keyRight=function(e,t){this.focusedItem().showNewFolderInput(!1);if(this.focusedItem().isOpen()){if(this.focusedItem().children().length>0){var n=this.focusedItem().children()[0]();e._changeSelection(n);e._selectFolder(n)}}else{e.focusedItem().isLoading(!0);e._showChildren(this.focusedItem())}t.stopPropagation();return!0};t.prototype.keyUp=function(e,t){this.focusedItem().showNewFolderInput(!1);var n=this.itemArrayForSelection.indexOf(this.focusedItem());0!==n&&e._selectFolder(this.itemArrayForSelection()[n-1]);return!0};t.prototype.keyDown=function(e,t){this.focusedItem().showNewFolderInput(!1);var n=this.itemArrayForSelection.indexOf(this.focusedItem());n!==this.itemArrayForSelection().length-1&&e._selectFolder(this.itemArrayForSelection()[n+1]);return!0};t.prototype.onEnter=function(e,t){this.isDisabled(!0);this.isNewFolderDisabled(!0);var n={context:this.context,onComplete:this.onComplete,isMove:this.context().isMove};new(this.managed(this._actionMap.MoveCopyAction))(n).execute(t);t.stopPropagation();return!1};t.prototype._selectFolder=function(e){var t=this._urlDataSource.getKeyParams(e.key),n=this._urlDataSource.saveItemTypeFilter({filters:[g.ItemTypeFilter.folder]});for(var r in n)delete t[r];var i=this._urlDataSource.getKey(t);this.context().targetId=e.id;this.context().targetKey=i;this.context().cid=this._urlDataSource.getOwnerId(i);this.isNewFolderDisabled(!1);y.isFeatureEnabled(y.FileMoveSharingHint)&&this._showSharingInformation(e)};t.prototype._changeSelection=function(e){this.selectionModel.selectItem(e)};t.prototype._setFocus=function(){if(this.needsRefocus()){this.focusedItem().focused(!0);this.isNewFolderDisabled(!1);this.needsRefocus(!1)}};t.prototype._updateItemSet=function(){this.focusedItem().isLoading(!0);this._showChildren(this.focusedItem())};t.prototype._showChildren=function(e,t){var n=this;void 0===t&&(t=!1);var r=e.oneDriveItem&&e.oneDriveItem.peek();if(e.retrievedChildren()&&!this.dataUpdated()){e.isLoading(!1);e.children().length>0?e.isOpen(!0):e.isOpen(!1);this._updateSelectionArray()}else if(r&&r.vault&&r.vault.isLocked&&!t)this.onStatusActionClick();else{var i={parentKey:e.key,requestAllChildren:!0,ownerId:this._urlDataSource.getOwnerId(e.key),skipCache:!0,filters:this._getFilters()};this._itemProvider.getItem(i).then(function(t){n._itemSet(t);e.children(u.default.convertChildren(e,n._itemSet().content().items));e.retrievedChildren(!0);e.isLoading(!1);e.children().length>0?e.isOpen(!0):e.isOpen(!1);0===e.children().length?e.iconVisible(!1):e.iconVisible(!0);if(n.dataUpdated()){for(var r=0;r<e.children().length;r++)if(e.children()[r]().name===n.newFolderName()){n._changeSelection(e.children()[r]());n._selectFolder(e.children()[r]())}n.isNewFolderDisabled(!1);n.dataUpdated(!1)}n._updateSelectionArray()})}};t.prototype._getFilters=function(){return this._moveCopyDataSource.getCapabilities().supportsMoveCopyFilterParams?{FilterField1:"FSObjType",FilterValue1:"1"}:{}};t.prototype._closeChildren=function(e){e.isOpen(!1);for(var t=0;t<e.children().length;t++)this._closeChildren(e.children()[t]())};t.prototype._fetchParentItem=function(e){var t=this,n=this._urlDataSource.saveItemTypeFilter({filters:[g.ItemTypeFilter.folder]}),r=this._urlDataSource.getKey(n),i={parentKey:r,requestAllChildren:!0,ownerId:this._urlDataSource.getOwnerId(r),filters:this._getFilters()},s=this._itemProvider.getItem(i).then(function(e){t._itemSet(e)}),o=p.default.wrap();if(this.showSharedRoot){var u=null;if(e.parent){for(var a=e;a.parent&&!a.parent.isStub&&a.parent.parent;)a=a.parent;u=a}else u=e;i={parentKey:u.key,ownerId:u.ownerId};o=this._itemProvider.getItem(i).then(function(e){t._sharedItemSet(e)},function(e){t.showSharedRoot=!1})}p.default.all([s,o]).done(this._createFolderItems.bind(this),this._createFolderItems.bind(this))};t.prototype._createFolderItems=function(){var e=null;if(this._sharedItemSet()){var t=this._getFolderItem(this._sharedItemSet());e=t;this.sharedFolderItem(t)}if(this._itemSet()){var n=this._getFolderItem(this._itemSet());n.isRoot=!0;e||(e=n);this.rootFolderItem(n);this._selectFolder(e);this._changeSelection(e);this._updateSelectionArray();this.hasData(!0)}};t.prototype._getFolderItem=function(e){var t=u.default.convertItem(null,e.item);t.children(u.default.convertChildren(t,e.content().items));t.isOpen(!0);t.retrievedChildren(!0);t.focused(!0);0===t.children().length&&t.iconVisible(!1);return t};t.prototype._updateSelectionArray=function(){var e=this._updateSelectionArrayHelper(this.rootFolderItem(),!0),t=this.sharedFolderItem()?this._updateSelectionArrayHelper(this.sharedFolderItem(),!0):[];this.itemArrayForSelection(t.concat(e))};t.prototype._updateSelectionArrayHelper=function(e,t){var n=[];t&&n.push(e);if(e.children().length>0)for(var r=0;r<e.children().length;r++)n=n.concat(this._updateSelectionArrayHelper(e.children()[r](),e.isOpen()));return n};t.prototype._showSharingInformation=function(e){var t=this;if(e.retrievedSharingPermissions){this.showStatusInfo(!!e.sharingInfoText);this.statusInfoText(e.sharingInfoText)}else{this.showStatusInfo(!1);this._sharingProvider.getSharingData({key:"",openUrl:e.id}).getPermissions().then(function(n){var r=n[0];e.retrievedSharingPermissions=!0;e.sharingPermissions=r;e.sharingInfoText=b.getSharingStatusText(r,e.name);if(e.selected()){t.showStatusInfo(!!e.sharingInfoText);t.statusInfoText(e.sharingInfoText)}},function(e){})}};return t}(i.default);t.default=L});
define("odsp-next/controls/folderTree/FolderTreeUtility",["require","exports","knockout","../../models/item/ItemType"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.convertItem=function(e,t){var r=t.peek();return{name:r.name,key:r.key,type:r.type,id:r.id,iconName:r.iconName,focused:n.observable(!1),isSelectable:!0,selected:n.observable(!1),children:n.observableArray(),isOpen:n.observable(!1),retrievedChildren:n.observable(!1),iconVisible:n.observable(!0),isRoot:!1,isLoading:n.observable(!1),level:0,parent:e,showNewFolderInput:n.observable(!1),focusNewFolderInput:n.observable(!1),retrievedSharingPermissions:!1,sharingPermissions:null,sharingInfoText:null,oneDriveItem:t}};e.convertChildren=function(t,i){for(var s=[],o=0;o<i.length;o++){var u=i[o],a=u&&u.peek();if(a&&(a.type===r.default.Folder||a.type===r.default.Error&&a.folder)){var f=n.observable(e.convertItem(t,u));f().level=t.level+1;s.push(f)}}return s};return e}();t.default=i});
define("odsp-next/controls/folderTree/FolderTreeCommandSet",["require","exports","tslib","knockout","../../utilities/icons/Icon","@ms/odsp-shared/lib/base/BaseModel","../commands/Commands.resx","../../resources/ControlResourceKeys","../commands/CommandViewModel","../../controls/fluentStyling/FluentStyling.key"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.commands=r.observableArray();var s=o.strings;n._actionMap=n.resources.consume(u.actionMap);n.componentViewModel=t.componentViewModel;n.context=t.componentViewModel.context;n.onComplete=t.componentViewModel.onComplete;n.isDisabled=t.componentViewModel.isDisabled;n.isNewFolderDisabled=t.componentViewModel.isNewFolderDisabled;n.isNewFolderHidden=r.observable(!0);n.createComputed(function(){if((!n._focusedItem||n._focusedItem()!==n.componentViewModel.focusedItem())&&n.componentViewModel.focusedItem()){n._focusedItem=n.componentViewModel.focusedItem;var e=n._focusedItem().oneDriveItem;n._createFolderAction=new(n.managed(n._actionMap.CreateFolderAction))({item:e})}n._createFolderAction&&n.isNewFolderHidden(!n._createFolderAction.isAvailable())});n.isFluentEnabled=n.resources.consume(f.resourceKey);var l={context:n.context,onComplete:n.onComplete,isMove:!0},c={context:n.context,onComplete:n.onComplete,isMove:!1};n.commands=r.observableArray([new a.default({text:s.moveConfirmButton,isDisabled:n.isDisabled,icon:n.isFluentEnabled?void 0:new i.default("CheckMark"),automationId:"folderTree-move",action:new(n.managed(n._actionMap.MoveCopyAction))(l),engagementName:"Move.FolderPanelTopMenu",classSuffix:"PrimaryButton"}),new a.default({text:s.copyConfirmButton,isDisabled:n.isDisabled,icon:n.isFluentEnabled?void 0:new i.default("CheckMark"),automationId:"folderTree-copy",action:new(n.managed(n._actionMap.MoveCopyAction))(c),engagementName:"Copy.FolderPanelTopMenu",classSuffix:"PrimaryButton"}),new(n.managed(a.default))({text:s.CreateFolderCommand,isHidden:n.isNewFolderHidden,isDisabled:n.isNewFolderDisabled,icon:n.isFluentEnabled?new i.default("Add"):new i.default("CirclePlus"),callback:function(){n.componentViewModel.focusedItem().showNewFolderInput(!0);n.componentViewModel.focusedItem().focusNewFolderInput(!0);n.isNewFolderDisabled(!0)},engagementName:"NewFolder.FolderPanelTopMenu"})]);return n}return t}(s.default);t.default=l});
define("odsp-next/utilities/sharing/SharingHelper",["require","exports","knockout","./SharingHelper.resx","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../controls/confirmation/Confirmation","@ms/odsp-utilities/lib/async/Promise","../../utilities/icons/Icon","../../controls/textContainer/TextContainer","../../controls/commands/Commands.resx","../../controls/sharing/shareByEmail/Sharing.resx","@ms/odsp-utilities/lib/string/StringHelper","../../utilities/features/Features","@ms/odsp-utilities/lib/logging/ABExperiment"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.disableLinkConfirm=function(e,t,a,f){var l=n.observable(!0);return a.requestDialog({title:r.strings.DisableLinkConfirmationTitle,size:"Medium",component:{name:s.default.tagName,params:{message:r.strings.DisableLinkConfirmationMessage}},actions:[{name:r.strings.DisableLinkConfirmationButton,execute:function(){i.Engagement.logData({name:"Confirm.DisableLink."+f+".Click",isIntentional:!0});l(!1);var n=e().then(function(e){return o.default.wrap(e?2:3)});t(n);return n},isDefault:!0,isAvailable:l,icon:new u.default("Save"),automationId:"UnshareConfirm"},{name:r.strings.KeepExistingLinkButton,execute:function(){i.Engagement.logData({name:"KeepExisting.DisableLink."+f+".Click",isIntentional:!0});return o.default.wrap(3)},isDefault:!1,icon:new u.default("Cancel"),automationId:"UnshareCancel"}],executeDefaultAction:!1})};t.displayMessage=function(e,t,r){return r.requestDialog({title:t,size:"Small",component:{name:a.default.tagName,params:{text:e}},actions:[{name:f.strings.Close,execute:function(){return o.default.wrap(2)},isAvailable:n.observable(!0),icon:new u.default("Save"),isDefault:!0}],executeDefaultAction:!1}).wait()};t.getSharingStatusText=function(e,t){for(var n=0,r=0,i=!1,s=0,o=e.people;s<o.length;s++){var u=o[s];if(2===u.entityType)r++;else if(0!==u.sharingInfo.role){n++;1===u.entityType&&(i=!0)}}var a="";r>0&&n>0?a=r>1?c.format(i?l.strings.SharedWithPeopleGroupsAndExternalUsers:l.strings.SharedWithPeopleAndGroups,t,r,n):c.format(i?l.strings.SharedWithPeopleGroupAndExternalUsers:l.strings.SharedWithPeopleAndGroup,t,n):1===r?a=c.format(l.strings.SharedWithGroup,t):r>1?a=c.format(l.strings.SharedWithGroups,t,r):n>0&&i?a=c.format(l.strings.SharedWithPeopleAndExternalUsers,t,n):n>1?a=c.format(l.strings.SharedWithPeople,t,n):1===n&&(a=c.format(l.strings.SharedWithPerson,t));return a};t.getNumberOfDaysUntilExpiry=function(e){if(!e)return 0;var t=e.getTime()-(new Date).getTime();return Math.ceil(t/864e5)};t.isShareByWithYouEnabled=function(){var e=!1;if(h.isFeatureEnabled(h.EnableShareWithAndByStringsFeature)){e=new p.ABExperiment({name:"EnableShareWithAndByStringsExperiment",startDate:"4/22/2019",version:p.ABExpHash.v2},h.EnableShareWithAndByStringsExperiment).IsExperimentOn()}return e}});
define("odsp-next/controls/confirmation/Confirmation",["require","exports","./ConfirmationViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./Confirmation.html","./Confirmation.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-confirmation",template:e("./Confirmation.html"),viewModel:n.default});t.default=i});
define("odsp-next/controls/confirmation/ConfirmationViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.message=t.message;return n}return t}(r.default);t.default=i});
define("odsp-next/controls/confirmation/Confirmation.html",[],function(){return'<div class=od-Confirmation><p class=od-Confirmation-message data-bind="text: message"></p></div>'});
define("odsp-next/controls/confirmation/Confirmation.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-Confirmation-message{padding:0;box-sizing:border-box;box-shadow:none;margin:0;padding:0;font-size:14px;font-weight:400}"}])});
define("odsp-next/controls/folderTree/FolderTree.html",[],function(){return'\x3c!--ko if: hasData--\x3e<div class="od-FolderTree-commandBar od--hasSelection" data-bind="control: commandBarSpecification"></div><div class=od-FolderTree-contentContainer><div class="od-FolderTree-sharingInfo ms-font-m" data-bind="visible: showStatusInfo, text: statusInfoText"></div><div class="od-Panel--hasPadding od-FolderTree-padding"><div class=od-FolderTree-title data-bind="text: title, css: { \'ms-fontWeight-semibold\': isFluentEnabled, \'ms-fontWeight-semilight\': !isFluentEnabled, \'ms-font-xl\': !isFluentEnabled }"></div><span class=ms-accessible data-bind="text: titleAccessibilityHint"></span>\x3c!--ko if: showSharedRoot && sharedFolderItem()--\x3e<div class=od-FolderTree role=tree data-bind="template: { name: \'od-folder-tree-row\', data: sharedFolderItem }, keyboard: keyboardOptions, selection: { data: itemArrayForSelection, mode: \'single\', direction: \'vertical\', key: sharedFolderItem().key, focused: focusedItem, selected: selectedItems, clearSelectionOnRemoval: false, selectFirstItemOnActivate: false, selectionModel: selectionModel }"></div>\x3c!--/ko--\x3e<div class=od-FolderTree role=tree data-bind="template: { name: \'od-folder-tree-row\', data: rootFolderItem }, keyboard: keyboardOptions, selection: { data: itemArrayForSelection, mode: \'single\', direction: \'vertical\', key: rootFolderItem().key, focused: focusedItem, selected: selectedItems, clearSelectionOnRemoval: false, selectFirstItemOnActivate: false, selectionModel: selectionModel }"></div></div></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: hasData--\x3e<span class=ms-font-m data-bind="component: { name: loadingSpinnerTagName, params: { loadingText: loadingText } }"></span>\x3c!--/ko--\x3e'});
define("odsp-next/controls/folderTree/FolderTreeRow.html",[],function(){return"<div class=od-FolderTree-row role=treeitem data-bind=\"css: { 'is-selected': selected, 'is-focused': focused, 'icon-visible': iconVisible }, style: { padding: $component.isFluentEnabled ? $component.getFluentRowPadding($data) : undefined }, click: $component.onClick.bind($data, $component), attr: { tabindex: selected() || focused() ? 0 : -1, 'aria-expanded': isOpen(), 'aria-selected': selected(), 'aria-label': name }, delayedHasFocus: { hasFocus: focused, timeout: 300 }\"><i class=\"ms-Icon ms-Icon--ChevronDown\" data-bind=\"icon: true, style: {display: !isLoading() && isOpen() ? 'inline-block' : 'none'}\"></i> <i class=ms-Icon data-bind=\"icon: true, style: {display: !isLoading() && !isOpen() ? 'inline-block' : 'none'}, css: { 'ms-Icon--ChevronRight': !$component.isRtl, 'ms-Icon--ChevronLeft': $component.isRtl }\"></i> <img class=od-FolderTree-loadingGif data-bind=\"attr: { src: $component.loadingImageUrl}, style: {display: isLoading() ? 'inline-block' : 'none'}\"> <i class=\"ms-Icon ms-Icon--OneDrive\" data-bind=\"icon: true, style: {display: isRoot ? 'inline-block' : 'none'}\"></i> <span class=od-FolderTree-folderIcon data-bind=\"component: { name: 'ms-file-type-icon', params: { iconName: iconName, desiredSize: 16, item: oneDriveItem() } }, style: {display: isRoot ? 'none' : 'inline-block'}\"></span> <span class=\"od-FolderTree-folderName ms-font-m\" data-bind=\"text: name\"></span></div><div class=od-FolderTree-inlineFolderBuilder data-bind=\"visible: showNewFolderInput, component: { name: 'ms-inline-folder-builder', params: { newFolderName: $component.newFolderName, iconName: iconName, width: $component.getWidth($component, $data), itemKey: key, optionalParams: { dataUpdated: $component.dataUpdated, showNewFolderInput: showNewFolderInput, hasFocus: focusNewFolderInput, needsRefocus: $component.needsRefocus } } }\"></div><ul class=od-FolderTree-children role=group data-bind=\"template: { name: 'od-folder-tree-row', foreach: children }, style: { display: isOpen() ? 'block' : 'none' }\"></ul>"});
define("odsp-next/controls/inlineFolderBuilder/InlineFolderBuilder",["require","exports","./InlineFolderBuilderViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./InlineFolderBuilder.html","./InlineFolderBuilder.css","../fileTypeIcon/FileTypeIcon"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-inline-folder-builder",template:e("./InlineFolderBuilder.html"),viewModel:n.default});t.default=i});
define("odsp-next/controls/inlineFolderBuilder/InlineFolderBuilderViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../providers/item/ItemProvider","../folderBuilder/FolderBuilder.resx","../../resources/ControlResourceKeys","../../bindings/keyboard/KeyboardBinding"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.namePlaceholder=o.strings.FolderNamePlaceholder;n.nameLabel=o.strings.FolderNameLabel;n.createLabel=o.strings.CreateFolderLabel;n.iconName=t.iconName;n.width=(t.width-57).toString()+"px";n.inputWidth=(t.width-89).toString()+"px";n.newFolderName=t.newFolderName||r.observable("");n.newFolderName("");n.buttonText=o.strings.CreateFolderLabel;n.itemKey=t.itemKey;n.isActive=r.observable(!0);var i=t.optionalParams;n.optionalParams={dataUpdated:i&&i.dataUpdated?i.dataUpdated:r.observable(!1),showNewFolderInput:i&&i.showNewFolderInput?i.showNewFolderInput:r.observable(!0),hasError:i&&i.hasError?i.hasError:r.observable(!1),status:i&&i.status?i.status:r.observable(""),hasFocus:i&&i.hasFocus?i.hasFocus:r.observable(!0),isEnabled:i&&i.isEnabled?i.isEnabled:r.observable(!0),needsRefocus:i&&i.needsRefocus?i.needsRefocus:r.observable(!1)};n.addBindingHandlers({keyboard:a.default});n._itemProvider=n.resources.consume(s.resourceKey);n._actionMap=n.resources.consume(u.actionMap);return n}t.prototype.onClick=function(e,t){e.createNewFolder(t)};t.prototype.onEnter=function(e,t){e.createNewFolder(t);return!0};t.prototype.onClickTextField=function(e,t){t.stopPropagation()};t.prototype.onEscape=function(e,t){this.optionalParams.showNewFolderInput(!1);this.newFolderName("");this.optionalParams.status("");this.optionalParams.isEnabled(!0);this.optionalParams.needsRefocus(!0);t.stopPropagation();return!1};t.prototype.createNewFolder=function(e){var t=this,n={parentKey:this.itemKey};this._itemProvider.getItem(n).then(function(n){var r=n.item();new(t.managed(t._actionMap.CreateNewFolderAction))({parentItem:r,newFolderName:t.newFolderName,options:t.optionalParams}).execute(e)});e.stopPropagation()};return t}(i.default);t.default=f});
define("odsp-next/controls/inlineFolderBuilder/InlineFolderBuilder.html",[],function(){return'<div class=od-InlineFolderBuilder data-bind="style: { width: width}, keyboard: { allowInputEvents: true, mappings: { Enter: onEnter.bind($component), Esc: onEscape.bind($component) } }"><span><span class=od-InlineFolderBuilder-folderIcon data-bind="component: { name: \'ms-file-type-icon\', params: { iconName: iconName, desiredSize: 16 } }"></span> <input class="od-InlineFolderBuilder-textInput od-TextField-field" type=text data-bind="value: newFolderName, textInput: newFolderName, click: onClickTextField.bind($component), hasFocus: optionalParams.hasFocus, style: { width: inputWidth }, attr: { maxlength: 255, placeholder: namePlaceholder, \'aria-label\': nameLabel }, automation: automationId, enable: optionalParams.isEnabled"></span><div class=od-InlineFolderBuilder-status aria-live=assertive data-bind="text: optionalParams.status, css: { \'od-InlineFolderBuilder-status--error\': optionalParams.hasError }"></div><div><button class="od-Button od-Button--primary od-InlineFolderBuilder-createButton" data-bind="visible: newFolderName() && optionalParams.isEnabled(), click: onClick.bind($component), attr: { \'aria-label\': createLabel }"><span class=od-Button-label data-bind="text: buttonText"></span></button></div></div>'});
define("odsp-next/controls/inlineFolderBuilder/InlineFolderBuilder.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-InlineFolderBuilder{overflow:visible;white-space:nowrap;word-wrap:break-word;display:inline-block}.od-InlineFolderBuilder-textInput{display:inline-block}[dir=ltr] .od-InlineFolderBuilder-textInput{margin-left:8px}[dir=rtl] .od-InlineFolderBuilder-textInput{margin-right:8px}.od-InlineFolderBuilder-createButton{margin-top:2px;line-height:0}html[dir=ltr] .od-InlineFolderBuilder-createButton{float:right}html[dir=rtl] .od-InlineFolderBuilder-createButton{float:left}.od-InlineFolderBuilder-status{margin-top:2px;font-size:12px;font-weight:400;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";white-space:pre-wrap;word-wrap:break-word;line-height:15px}.od-InlineFolderBuilder-status--error{color:#a80000}"}])});
define("odsp-next/controls/folderTree/FolderTree.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".isFluent .od-FolderTree{margin:0 -12px}.isFluent.sm .od-FolderTree{margin:0 -8px}.isFluent .od-FolderTree-row{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}.isFluent .od-FolderTree-row .ms-Icon--ChevronDown,.isFluent .od-FolderTree-row .ms-Icon--ChevronRight,.isFluent .od-FolderTree-row .od-FolderTree-loadingGif{padding:10px 14px 10px 0}html[dir=rtl] .isFluent .od-FolderTree-row .ms-Icon--ChevronDown,html[dir=rtl] .isFluent .od-FolderTree-row .ms-Icon--ChevronRight,html[dir=rtl] .isFluent .od-FolderTree-row .od-FolderTree-loadingGif{padding:10px 0 10px 14px}[dir=ltr] .isFluent .od-FolderTree-row .od-FolderTree-folderName{margin-left:0}[dir=rtl] .isFluent .od-FolderTree-row .od-FolderTree-folderName{margin-right:0}[dir=ltr] .isFluent .od-FolderTree-row .ms-Icon--OneDrive{margin-left:0}[dir=rtl] .isFluent .od-FolderTree-row .ms-Icon--OneDrive{margin-right:0}[dir=ltr] .isFluent .od-FolderTree-row .ms-Icon--OneDrive{margin-right:12px}[dir=rtl] .isFluent .od-FolderTree-row .ms-Icon--OneDrive{margin-left:12px}.od-FolderTree-row{overflow:hidden;cursor:default;height:34px;line-height:14px;position:relative;margin:2px 0;min-width:220px;white-space:nowrap;text-overflow:ellipsis}.isFluent .od-FolderTree-row{padding:0 16px;border-radius:2px;min-width:auto}.od-FolderTree-row.is-selected{background:"},{theme:"themeLighter",defaultValue:"#d7eaf9"},{rawString:"}.isFluent .od-FolderTree-row.is-selected{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-FolderTree-row.is-selected{background:#0000c0}}@media screen and (-ms-high-contrast:black-on-white){.od-FolderTree-row.is-selected{background:#00c0ff}}.od-FolderTree-row:focus{outline:1px solid transparent}.od-FolderTree-row .ms-Icon--ChevronDown{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";opacity:0;padding:10px;font-size:12px}.isFluent .od-FolderTree-row .ms-Icon--ChevronDown{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:14px}.od-FolderTree-row .ms-Icon--ChevronRight{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";opacity:0;padding:10px 8px 10px 14px;font-size:12px}html[dir=rtl] .od-FolderTree-row .ms-Icon--ChevronRight{padding:10px 14px 10px 8px}.isFluent .od-FolderTree-row .ms-Icon--ChevronRight{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:14px}.od-FolderTree-row.icon-visible .ms-Icon--ChevronRight{opacity:1}.od-FolderTree-row.icon-visible .ms-Icon--ChevronDown{opacity:1}.od-FolderTree-row .ms-Icon--OneDrive{font-size:16px;padding:10px 0;width:16px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";vertical-align:top}[dir=ltr] .od-FolderTree-row .ms-Icon--OneDrive{margin-left:-3px}[dir=rtl] .od-FolderTree-row .ms-Icon--OneDrive{margin-right:-3px}.od-FolderTree-row .od-FolderTree-loadingGif{vertical-align:bottom;padding:9px}.isFluent .od-FolderTree-row .od-FolderTree-loadingGif{width:14px;height:14px}.od-FolderTree-row>i{display:inline}.od-FolderTree-folderIcon{vertical-align:top;line-height:30px}[dir=ltr] .isFluent .od-FolderTree-folderIcon{margin-right:12px}[dir=rtl] .isFluent .od-FolderTree-folderIcon{margin-left:12px}.od--isNonMobile .od-FolderTree-row:hover{background:"},{theme:"themeLighterAlt",defaultValue:"#e6f2fb"},{rawString:"}.isFluent.od--isNonMobile .od-FolderTree-row:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od--isNonMobile .od-FolderTree-row:hover.is-selected{background:"},{theme:"themeLightAlt",defaultValue:"#beddf4"},{rawString:"}.isFluent.od--isNonMobile .od-FolderTree-row:hover.is-selected{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#dadada"},{rawString:"}.isFluent.od--isNonMobile .od-FolderTree-row:active{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-focus--enabled .od-FolderTree-row.is-focused{box-shadow:0 0 0 1px "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:" inset;outline:1px solid transparent}.od-FolderTree-folderName{cursor:pointer;position:relative;top:-1px;line-height:32px}[dir=ltr] .od-FolderTree-folderName{margin-left:3px}[dir=rtl] .od-FolderTree-folderName{margin-right:3px}.isFluent .od-FolderTree-folderName{top:1px}.od-FolderTree-children{margin:0}[dir=ltr] .od-FolderTree-children{padding-left:20px}[dir=rtl] .od-FolderTree-children{padding-right:20px}[dir=ltr] .isFluent .od-FolderTree-children{padding-left:0}[dir=rtl] .isFluent .od-FolderTree-children{padding-right:0}.od-FolderTree-title{margin-bottom:20px}.isFluent .od-FolderTree-title{font-size:20px}.od-FolderTree-commandBar{position:absolute;outline:0;margin:0;border:0;top:0;right:0;left:0;width:100%;padding:0;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-FolderTree-commandBar .ms-CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.5s;padding:0}@media (prefers-reduced-motion:reduce){.od-FolderTree-commandBar .ms-CommandBar{animation:none}}.isFluent .od-FolderTree-commandBar .ms-CommandBar{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.od-FolderTree-commandBar .ms-CommandBar .od-Command--PrimaryButton{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:inset 0 1px 0 0 #2488d8;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.isFluent .od-FolderTree-commandBar .ms-CommandBar .od-Command--PrimaryButton{height:auto;margin:6px 8px;border-radius:2px;padding:0 18px;box-shadow:none}.od-FolderTree-commandBar .ms-CommandBar .od-Command--PrimaryButton i{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderTree-commandBar .ms-CommandBar .od-Command--PrimaryButton:hover{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:none}.od-FolderTree-commandBar .ms-CommandBar .od-Command--PrimaryButton:focus{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:0 0 0 1px "},{theme:"white",defaultValue:"#ffffff"},{rawString:" inset}.isFluent .od-FolderTree-commandBar .ms-CommandBar .ms-Button--commandBar:not(.od-Command--PrimaryButton){background-color:inherit}.isFluent .od-FolderTree-commandBar .ms-CommandBar .ms-Button--commandBar:not(.od-Command--PrimaryButton):hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.isFluent .od-FolderTree-commandBar .ms-CommandBar .ms-Button--commandBar:not(.od-Command--PrimaryButton):active{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#dadada"},{rawString:"}.od-FolderTree-commandBar .CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.5s}@media (prefers-reduced-motion:reduce){.od-FolderTree-commandBar .CommandBar{animation:none}}.od-FolderTree-commandBar .CommandBar .CommandBarItem:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:inset 0 1px 0 0 #2488d8}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon .od-IconGlyph{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-commandText{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-linkWrapper{padding-left:12px;padding-right:12px}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child:hover{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:none}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-commandText{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child:focus{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-FolderTree-commandBar .CommandBar .CommandBarItem:first-child:focus .CommandBarItem-link:before{border:1px solid "},{theme:"themeDarker",defaultValue:"#004578"},{rawString:";margin:2px -8px}.od-FolderTree-contentContainer{position:absolute;overflow-y:scroll;top:40px;bottom:0}[dir=ltr] .od-FolderTree-contentContainer{left:0}[dir=rtl] .od-FolderTree-contentContainer{right:0}[dir=ltr] .od-FolderTree-contentContainer{right:0}[dir=rtl] .od-FolderTree-contentContainer{left:0}.od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding{padding-top:22px}.isFluent .od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding{padding-top:17px}.lg .od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding,.md .od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding,.sm .od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding{padding-top:10px}.isFluent.sm .od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding{padding-top:17px}.isFluent.md .od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding{padding-top:17px}.isFluent.lg .od-FolderTree-contentContainer .od-Panel--hasPadding.od-FolderTree-padding{padding-top:17px}.od-FolderTree-sharingInfo{background-color:"},{theme:"themeLighterAlt",defaultValue:"#e6f2fb"},{rawString:";padding:4px 6px}.od-FolderTree-inlineFolderBuilder{margin:2px 0;line-height:34px}[dir=ltr] .od-FolderTree-inlineFolderBuilder{padding-left:57px}[dir=rtl] .od-FolderTree-inlineFolderBuilder{padding-right:57px}"}])});
define("odsp-next/actions/userActivity/odc/UserActivityExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../providers/panel/PanelProvider","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../controls/userActivity/UserActivity","../../../controls/userActivity/UserActivity.resx"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._panelProvider=n.resources.consume(i.resourceKey);return n}t.prototype.execute=function(){var e;return(e=this._panelProvider.requestPanel({title:u.strings.ActivityFeedTitle,component:{name:o.default.tagName,params:{onActivityClick:function(){e.state(1)}}}})).wait().then(function(){return{resultType:s.ResultTypeEnum.Success}})};return t}(r.default);t.default=a});
define("odsp-next/controls/userActivity/UserActivity",["require","exports","./UserActivityViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./UserActivity.html","./UserActivity.css","./UserActivityTile"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-userActivity-feed",template:e("./UserActivity.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/userActivity/UserActivityViewModel",["require","exports","tslib","knockout","../infoPane/InfoPane.resx","../../resources/ProviderResourceKeys","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this)||this;n.statusText=r.observable(i.strings.sharingLoadingStatus);n.isLoading=r.observable(!0);n.activities=r.observableArray([]);n.onActivityClick=t.onActivityClick;n._activityProvider=n.resources.consume(s.userActivity);n._activityProvider.getActivities().done(function(e){var t=e.activities.slice();n.activities(t);n.isLoading(!1);n.statusText("")},function(e){n.statusText(i.strings.serverError)});return n}return t}(o.default);t.default=u});
define("odsp-next/controls/userActivity/UserActivity.html",[],function(){return"<div class=od-UserActivity-Feed>\x3c!--ko if: isLoading()--\x3e<div class=od-UserActivity-Feed-Status data-bind=\"text: statusText()\"></div>\x3c!--/ko--\x3e\x3c!--ko if: !isLoading()--\x3e<div class=od-UserActivity-Feed-List><div data-bind=\"foreach: { data: activities, as: 'activity' }\">\x3c!--ko component: { name: 'ms-userActivity-tile', params: { activity: activity, onActivityClick: $component.onActivityClick.bind($component) } }--\x3e\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e</div>"});
define("odsp-next/controls/userActivity/UserActivity.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-UserActivity-Feed{font-size:12px}.od-UserActivity-Feed-List a,.od-UserActivity-Feed-List a:hover,.od-UserActivity-Feed-List a:visited{cursor:pointer;text-decoration:none;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}"}])});
define("odsp-next/controls/userActivity/UserActivityTile",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./UserActivityTileViewModel","./UserActivityTile.html","./UserActivityTile.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.registerComponent({tagName:"ms-userActivity-tile",template:e("./UserActivityTile.html"),viewModel:r.default,synchronous:!0});t.default=i});
define("odsp-next/controls/userActivity/UserActivityTileViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/dateTime/DateTime","../../models/item/ItemType","../../dataSources/url/odc/UrlDataSource","../../resources/ODCResourceKeys","@ms/odsp-shared/lib/base/ViewModel","../../dataSources/url/PageType"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){var n,u=e.call(this,t)||this;u._urlDataSource=u.resources.consume(o.urlDataSource);u.activity=t.activity;u.onActivityClick=t.onActivityClick;u.timestamp=r.getRelativeDateTimeStringPast(u.activity.timestamp);u.personaSize=4;u.actorImageUrl=u.activity.actors[0].image;if(u.activity.item.itemType===i.default.File){u.itemUrl=s.default.getResourceRedirectUrl(u.activity.item.id);u.itemUrlTarget="_blank"}else{u.itemUrl=u._urlDataSource.getItemUrl(u._urlDataSource.getKey(((n={}).id=u.activity.item.id,n)),{page:a.default.Files});u.itemUrlTarget="_top"}return u}t.prototype.onClick=function(e,t){this.onActivityClick();return!0};return t}(u.default);t.default=f});
define("odsp-next/controls/userActivity/UserActivityTile.html",[],function(){return"<div class=od-UserActivityTile><a data-bind=\"attr: { 'href': itemUrl, 'target': itemUrlTarget }, click: onClick\"><div class=od-UserActivityTile-ActorPhoto data-bind=\"component: { name: 'od-persona', params: { person: activity.actors[0], personaSize: $component.personaSize, showPresence: true, showName: false, iconType: 'Contact' } }\"></div><div class=od-UserActivityTile-Text><div class=od-UserActivityTile-Message data-bind=\"text: activity.message\"></div><div class=od-UserActivityTile-Timestamp data-bind=\"text: timestamp\"></div></div></a></div>"});
define("odsp-next/controls/userActivity/UserActivityTile.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-UserActivityTile{padding:10px 0;min-height:50px}.od-UserActivityTile-ActorPhoto{position:absolute}.od-UserActivityTile-Text{position:relative}[dir=ltr] .od-UserActivityTile-Text{margin-left:58px}[dir=rtl] .od-UserActivityTile-Text{margin-right:58px}"}])});
define("odsp-next/actions/rename/odc/RenameExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/ItemRedeemer","../RenameHelper"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name=t.actionName;n._selectionHelper=t.selectionHelper;n._renameHelper=new(n.managed(s.default));n._itemReedemer=new(n.managed(i.default));return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveFirst().then(function(t){return e._itemReedemer.redeemItem(t,e).then(function(){return e._renameHelper.renameItem(t,!1)})})};return t}(r.default);t.default=o});
define("odsp-next/actions/rename/RenameHelper",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../utilities/icons/Icon","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../controls/commands/Commands.resx","../../providers/dialog/DialogProvider","./RenameItemOperator","../../resources/ControlResourceKeys","../../controls/itemNameEditor/ItemNameEditor","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._dialogProvider=n.resources.consume(a.resourceKey);n._urlDataSource=n.resources.consume(h.url);n._parentItem=n.resources.consume(l.currentItem);return n}t.prototype.renameItem=function(e,t){var n=this,s=e.properties.FileName||e.name,a=e.extension;if(t){s+=e.extension;a=null}var l=this.observables.create(s),h=this.observables.create(""),p=this.observables.create(!1),d=this.observables.create(!0),v=this.observables.create(!0);return this._dialogProvider.requestDialog({title:u.strings.Rename,component:{name:c.default.tagName,params:{name:l,extension:a,status:h,hasError:p,isEnabled:d,hasFocus:v}},actions:[{name:u.strings.RenameCommit,execute:function(){var i=n.unwrapObservable(l);if(i===s)return r.default.wrap(2);if(i&&""===i.trim())return r.default.wrap(1);v(!1);d(!1);p(!1);return n.resources.consumeAsync(f.typeResourceKey).then(function(r){var s=new r({parentKey:n._parentItem().key,newName:i,nameHasExtension:t,item:e,ownerId:n._urlDataSource?n._urlDataSource.getOwnerId():""});return n.trackPromise(s.start())}).then(function(){return 2},function(e){p(!0);d(!0);v(!0);h(e.message);return 1})},isDefault:!0,isAvailable:this.observables.pureCompute(function(){return!!l().trim()&&d()}),automationId:"renameDialogCommit",icon:new i.default("Save")}]}).wait().then(function(){return{resultType:o.ResultTypeEnum.Success}})};return t}(s.default);t.default=p});
define("odsp-next/actions/rename/RenameItemOperator",["require","exports","tslib","../../providers/operator/BaseOperator","../../providers/fileSystem/FileSystemProvider","../../models/operation/OperationType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._context=t;r._fileSystemProvider=n.fileSystemProvider;return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input;n.type=s.default.renameItems;n.name=r.name;n.iconName=r.iconName;n.payloads.renameItems={item:r,parent:r.parent};n.visibility=2;return n};t.prototype.onStart=function(e){return this._fileSystemProvider.renameItem(this._context,e)};t.dependencies=n.__assign({},r.default.dependencies,{fileSystemProvider:i.resourceKey});return t}(r.default);t.default=u;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,u)});
define("odsp-next/actions/setPhotosRoot/odc/SetPhotosRootExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/url/odc/UrlDataSource","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._photoProvider=t.photoProvider;n._itemProvider=t.itemProvider;n._urlDataSource=t.urlDataSource;n._rootId=t.rootId;return n}t.prototype.execute=function(e){var t=this;return this._findFolderId(this._rootId).then(function(e){return t._photoProvider.setAllPhotosSettings({cid:s.default.viewerId,allPhotosFolderId:e,allPhotosSortDirection:"2",rset:"odweb",id:"root"}).then(function(e){t._photoProvider.getAllPhotosSettings(!0);return{resultType:o.ResultTypeEnum.Success}},function(e){return{resultType:o.ResultTypeEnum.Failure}})})};t.prototype._findFolderId=function(e){if("ROOT"===this._rootId)return i.default.wrap("root");if("ALLPHOTOSFOLDER"===this._rootId){var t=this._getContextForPhoto();this._itemProvider.getItemSync(t);return this._itemProvider.getItem(t).then(function(e){return e.item&&e.item.peek().id},function(e){return i.default.resolve("root")})}if(u.isFeatureEnabled(u.SamsungGalleryFilter)&&"SAMSUNGFOLDER"===this._rootId){t=this._getContextForSpecial();this._itemProvider.getItemSync(t);return this._itemProvider.getItem(t).then(function(e){return e.item&&e.item.peek().id},function(e){return i.default.resolve("root")})}return i.default.wrap("root")};t.prototype._getContextForPhoto=function(){var e;return{parentKey:this._urlDataSource.getKey((e={},e.id="photos",e)),skipCache:!0,skipInMemoryCache:!0,pageSize:1}};t.prototype._getContextForSpecial=function(){var e;return{parentKey:this._urlDataSource.getKey((e={},e.id="samsungGallery",e)),skipCache:!0,skipInMemoryCache:!0,pageSize:1}};return t}(r.default);t.default=a});
define("odsp-next/actions/reportAbuse/odc/ReportAbuseExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../utilities/icons/Icon","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../providers/dialog/DialogProvider","../../../controls/reportAbuseDialog/ReportAbuseDialog","../../../controls/reportAbuseDialog/ReportAbuseDialog.resx","../../../models/item/AbuseType","../../../providers/item/ItemProvider"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=f.strings,p=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._abuseText=n.observables.create(null);n._abuseType=n.observables.create(null);n._selectionHelper=t.selectionHelper;n._provider=n.resources.consume(c.resourceKey);n._dialogProvider=n.resources.consume(u.resourceKey);return n}t.prototype.execute=function(){return this._executeReportAbuse()};t.prototype._executeReportAbuse=function(){var e=this;return this._selectionHelper.resolveFirst().then(function(t){return e._getReportAbuseDialog().then(function(){return e._provider.reportAbuse({item:t,rao:e._abuseType.peek(),desc:e._abuseText.peek()}).then(function(){return{resultType:o.ResultTypeEnum.Success}})})})};t.prototype._getReportAbuseDialog=function(){var e=this;return this._dialogProvider.requestDialog({title:h.title,component:{name:a.default.tagName,params:{abuseType:this._abuseType,abuseText:this._abuseText}},actions:[{name:h.title,execute:function(){return r.default.wrap(2)},isAvailable:this.createComputed(function(){return e._abuseType&&(e._abuseType()||0===e._abuseType())&&e._abuseType()!==l.default.copyrightInfringement}),isDefault:!0,icon:new i.default("EditNote"),automationId:"reportAbuseConfirm"}]}).wait()};return t}(s.default);t.default=p});
define("odsp-next/controls/reportAbuseDialog/ReportAbuseDialog",["require","exports","./ReportAbuseDialogViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ReportAbuseDialog.html","./ReportAbuseDialog.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-report-abuse",template:e("./ReportAbuseDialog.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/reportAbuseDialog/ReportAbuseDialogViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../models/item/AbuseType","./ReportAbuseDialog.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.abuseTypeEnum=i.default;n.strings=s.strings;n.spamUrl="https://go.microsoft.com/fwlink/?LinkId=117951";n.privacyUrl="https://go.microsoft.com/fwlink/?LinkId=521839";n.copyrightUrl="https://www.microsoft.com/info/cpyrtInfrg.aspx";n.codeOfConductUrl="https://go.microsoft.com/fwlink/?LinkId=521839";n.abuseType=t.abuseType;n.abuseText=t.abuseText;return n}return t}(r.default);t.default=o});
define("odsp-next/models/item/AbuseType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.spam=0]="spam";e[e.nudityOrPornography=1]="nudityOrPornography";e[e.harassmentOrThreatening=2]="harassmentOrThreatening";e[e.childEndangermentOrExploitation=3]="childEndangermentOrExploitation";e[e.other=4]="other";e[e.copyrightInfringement=5]="copyrightInfringement"}(n||(n={}));t.default=n});
define("odsp-next/controls/reportAbuseDialog/ReportAbuseDialog.html",[],function(){return'<div class=ReportAbuseDialog><div><span data-bind="text: strings.headerPart1"></span> <a target=_blank data-bind="text: strings.headerPart2, attr: { href: codeOfConductUrl }" a></a></div><div class=ms-reportAbuseDialog-option><input type=radio name=abuseType id=abuseTypeSpam data-bind="checked: abuseType, checkedValue: abuseTypeEnum.spam"> <a target=_blank data-bind="text: strings.spam, attr: { href: spamUrl}"></a></div><div class=ms-reportAbuseDialog-option><input type=radio id=abuseTypeNudityOrPornography name=abuseType data-bind="checked: abuseType, checkedValue: abuseTypeEnum.nudityOrPornography"> <label for=abuseTypeNudityOrPornography data-bind="text: strings.nudityOrPornography"></label></div><div class=ms-reportAbuseDialog-option><input type=radio name=abuseType id=abuseTypeHarassmentOrThreatening data-bind="checked: abuseType, checkedValue: abuseTypeEnum.harassmentOrThreatening"> <label for=abuseTypeHarassmentOrThreatening data-bind="text: strings.harassmentOrThreatening"></label></div><div class=ms-reportAbuseDialog-option><input type=radio name=abuseType id=abuseTypechildEndangermentOrExploitation data-bind="checked: abuseType, checkedValue: abuseTypeEnum.childEndangermentOrExploitation"> <label for=abuseTypechildEndangermentOrExploitation data-bind="text: strings.childEndangermentOrExploitation"></label></div><div class=ms-reportAbuseDialog-option><input type=radio name=abuseType id=abuseTypeCopyrightInfringement data-bind="checked: abuseType, checkedValue: abuseTypeEnum.copyrightInfringement"> <span>\x3c!--ko if: abuseType() !== abuseTypeEnum.copyrightInfringement--\x3e<label for=abuseTypeCopyrightInfringement data-bind="text: strings.copyrightInfringementShort">&nbsp;</label>\x3c!--/ko--\x3e\x3c!--ko if: abuseType() === abuseTypeEnum.copyrightInfringement--\x3e<label for=abuseTypeCopyrightInfringement data-bind="text: strings.copyrightInfringementLong1"></label> <a target=_blank data-bind="text: strings.copyrightInfringementLong2, attr: { href: copyrightUrl}"></a>\x3c!--/ko--\x3e</span></div><div class=ms-reportAbuseDialog-option><input type=radio name=abuseType id=abuseTypeOther data-bind="checked: abuseType, checkedValue: abuseTypeEnum.other"> <label for=abuseTypeOther data-bind="text: strings.other"></label></div><div class=ms-reportAbuseDialog-text-header><span data-bind="text: strings.detailsTextHeader"></span></div><textarea class=ms-reportAbuseDialog-text-area data-bind="enable: (abuseType() !== abuseTypeEnum.copyrightInfringement && abuseType() !== abuseTypeEnum.spam), value: abuseText"> </textarea><div class=ms-reportAbuseDialog-privacy><a id=privLnk target=_blank data-bind="text: strings.privacyStatement, attr: { href: privacyUrl }" a></a></div></div>'});
define("odsp-next/controls/reportAbuseDialog/ReportAbuseDialog.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-reportAbuseDialog-option{margin-top:10px}.ms-reportAbuseDialog-text-header{margin-top:15px}.ms-reportAbuseDialog-text-area{margin-top:5px;width:80%;height:40px;resize:none}"}])});
define("odsp-next/actions/removeFromSharedList/odc/RemoveFromSharedListExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../controls/removeFromSharedList/RemoveFromSharedList","../../../controls/removeFromSharedList/RemoveFromSharedList.resx","../../../models/item/ItemType","../../../utilities/icons/Icon","../../../providers/item/ItemProvider","../../../providers/dialog/DialogProvider"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._selectionHelper=t.selectionHelper;n._itemProvider=n.resources.consume(l.resourceKey);n._dialogProvider=n.resources.consume(c.resourceKey);n._currentItem=t.currentItem;return n}t.prototype.execute=function(){var e=this,t=this.observables.create(!1),n=this.observables.create(""),i=this.observables.create(!1),l=this._currentItem&&this._currentItem.key;return this._selectionHelper.resolveSelection().then(function(c){return e._dialogProvider.requestDialog({title:c.length>1?u.strings.itemsTitle:c[0].type===a.default.File?u.strings.fileTitle:u.strings.folderTitle,component:{name:o.default.tagName,params:{isSpam:t,selection:c,removeAccess:!0,hasError:i,status:n}},actions:[{name:u.strings.actionText,execute:function(){return r.default.wrap(2)},isAvailable:e.observables.create(!0),isDefault:!0,icon:new f.default("Cancel"),automationId:"removeFromSharedListConfirm"}]}).wait().then(function(){return e._itemProvider.removeFromSharedList({items:c,markAsSpam:t(),parentKey:l}).then(function(){return{resultType:s.ResultTypeEnum.Success}})})})};return t}(i.default);t.default=h});
define("odsp-next/controls/removeFromSharedList/RemoveFromSharedList",["require","exports","./RemoveFromSharedListViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./RemoveFromSharedList.html","./RemoveFromSharedList.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-remove-from-sharedlist",template:e("./RemoveFromSharedList.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/removeFromSharedList/RemoveFromSharedListViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./RemoveFromSharedList.resx","../../models/item/ItemType"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.strings,u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,{})||this;n.allowSpam=!!t.isSpam;n.isSpam=t.isSpam;n.status=t.status;n.hasError=t.hasError;var r=t.selection;t.hasError()?n.subText="":t.removeAccess?n.subText=r.length>1?o.itemsSubText:r[0].type===s.default.File?o.fileSubText:o.folderSubText:n.subText=r.length>1?o.itemsSubTextWithAccess:r[0].type===s.default.File?o.fileSubTextWithAccess:o.folderSubTextWithAccess;n.spamText=r.length>1?o.itemsSpamText:r[0].type===s.default.File?o.fileSpamText:o.folderSpamText;return n}return t}(r.default);t.default=u});
define("odsp-next/controls/removeFromSharedList/RemoveFromSharedList.html",[],function(){return'<div class=od-RemoveFromSharedList><div class=od-RemoveFromSharedList-SubText data-bind="text: subText"></div><span data-bind="if: allowSpam"><input id=RemoveFromSharedList-isSpam type=checkbox name=isSpam class=od-isSpam data-bind="checked: isSpam"> <label for=RemoveFromSharedList-isSpam class=spamText data-bind="text: spamText"></label></span><div class=od-RemoveFromSharedList-Status data-bind="text: status, css: { \'od-RemoveFromSharedList-Status--error\': hasError }"></div></div>'});
define("odsp-next/controls/removeFromSharedList/RemoveFromSharedList.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-RemoveFromSharedList-Status{padding-top:5px}.od-RemoveFromSharedList-Status--error{color:#a80000}"}])});
define("odsp-next/actions/requestReview/odc/RequestReviewExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../utilities/icons/Icon","../../../controls/requestReviewDialog/RequestReviewDialog","../../../controls/requestReviewDialog/RequestReviewDialog.resx","../../../providers/item/ItemProvider","../../../providers/dialog/DialogProvider"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name=t.actionName;n._selectionHelper=t.selectionHelper;n._itemProvider=n.resources.consume(f.resourceKey);n._dialogProvider=n.resources.consume(l.resourceKey);return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveSelection().then(function(t){return e._dialogProvider.requestDialog({title:a.strings.title,component:{name:u.default.tagName,params:{items:t}},actions:[{name:a.strings.actionButtonText,execute:function(){return r.default.wrap(2)},isAvailable:e.observables.create(!0),isDefault:!0,icon:new o.default("EditNote"),automationId:"requestReviewConfirm"}]}).wait().then(function(){return e._itemProvider.requestReview({items:t}).then(function(){return{resultType:s.ResultTypeEnum.Success}})})})};return t}(i.default);t.default=c});
define("odsp-next/controls/requestReviewDialog/RequestReviewDialog",["require","exports","./RequestReviewDialogViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./RequestReviewDialog.html"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-requestreview-dialog",template:e("./RequestReviewDialog.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/requestReviewDialog/RequestReviewDialogViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","./RequestReviewDialog.resx","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.strings=s.strings;n.codeOfConductUrl="https://go.microsoft.com/fwlink/?LinkId=117951";n.contactString=r.observable(null);n.contactString(o.format(n.strings.reviewContact,$Config.email));n.confirmPart1=o.pluralSelect(t.items.length,n.strings.confirmPart1Single,n.strings.confirmPart1Multiple);return n}return t}(i.default);t.default=u});
define("odsp-next/controls/requestReviewDialog/RequestReviewDialog.html",[],function(){return'<div><span data-bind="text: confirmPart1"></span> <a target=_blank data-bind="text: strings.confirmPart2, attr: { href: codeOfConductUrl }"></a> <span data-bind="text: contactString"></span></div>'});
define("odsp-next/actions/restoreAll/odc/RestoreAllExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../utilities/icons/Icon","../../../controls/commands/Commands.resx","../../../providers/fileSystem/FileSystemProvider","../../../providers/dialog/DialogProvider","../../../controls/textContainer/TextContainer"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name=t.actionName;n._currentItem=t.currentItem;n._fileSystemProvider=n.resources.consume(a.resourceKey);n._dialogProvider=n.resources.consume(f.resourceKey);return n}t.prototype.execute=function(){var e=this;return this._dialogProvider.requestDialog({title:u.strings.recycleBinRestoreAllConfirmText,component:{name:l.default.tagName,params:{text:u.strings.recycleBinRestoreAllSubText}},actions:[{name:u.strings.restore,execute:function(){return r.default.wrap(2)},isAvailable:this.observables.create(!0),icon:new o.default("RevToggleKey"),isDefault:!0}]}).wait().then(function(){return e._fileSystemProvider.restoreAll({parentKey:e._currentItem.peek().key}).then(function(){return{resultType:s.ResultTypeEnum.Success}})})};return t}(i.default);t.default=c});
define("odsp-next/actions/save/SaveExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../providers/operator/SaveOperator","../../providers/item/ItemContentProvider","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._selectionHelper=t.selectionHelper;n._currentItem=t.currentItem;n._itemContentsProvider=n.resources.consume(o.resourceKey);return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveFirst().then(function(t){var n=e._itemContentsProvider.getItemContent(t),r=n.memoryContent.peek(),o=e.getFullFileName(t),a=new Blob([r.text],{type:t.textEditorMimeType});a.name=o;a.eTag=n.correspondingETag;return e.resources.consumeAsync(s.typeResourceKey).then(function(n){var r=new n({files:[a],parentItem:e._currentItem,wasDragAndDropped:!1,type:u.UploadProcessorType.Html5file,item:t});e.trackPromise(r.start());return r.wait()}).then(function(){return{resultType:i.ResultTypeEnum.Success}},function(e){return{resultType:i.ResultTypeEnum.Failure,error:e?e.message||e:"Unkown error occurred whil trying to save a file"}})})};t.prototype.getFullFileName=function(e){return e.name+e.extension};return t}(r.default);t.default=a});
define("odsp-next/providers/operator/SaveOperator",["require","exports","tslib","./UploadOperator","../../models/operation/OperationType","../../models/operation/OperationState","@ms/odsp-datasources/lib/dataSources/upload/Upload","@ms/odsp-utilities/lib/async/Promise","../../providers/item/ItemContentProvider","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t,n){var r=this;t.behavior=1;t.scenario="SaveFile";r=e.call(this,t,n)||this;var i=n.itemContentProvider;r._itemContentsProvider=i;r.registerActions({restart:null,compare:r._onCompare,overwrite:r._onReplace});return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input;n.type=i.default.saveItem;n.name=r.fileName.peek();n.iconName=r.iconName.peek();n.payloads.uploadItems={parent:this._context.parentItem,name:r.fileName.peek()};0===r.state.peek()&&(n.state=s.default.created);n.progress.maximum=r.totalBytes.peek();n.progress.current=r.uploadedBytes.peek();switch(t.status){case 0:this._handleStart(n);break;case 1:this._handleSucceeded(n);break;case 2:this._handleFailed(n,t.error)}return n};t.prototype.onCancel=function(t,n){if(this._context.item){var r=this._itemContentsProvider.getItemContent(this._context.item);r.saveSucceded();for(var i=0,s=t;i<s.length;i++){0===s[i].status&&r.saveFailed()}}return e.prototype.onCancel.call(this,t,n)};t.prototype._handleStart=function(e){e.actions.push(this.onCancel);if(this._context.item){this._itemContentsProvider.getItemContent(this._context.item).startingSave()}};t.prototype._handleSucceeded=function(e){if(this._context.item){this._itemContentsProvider.getItemContent(this._context.item).saveSucceded()}};t.prototype._handleFailed=function(e,t){t&&(e.error.payloads.upload={error:t});if(t&&t.errorType===o.UploadErrorType.versionMismatch){e.actions.push(this._onCompare);e.actions.push(this._onReplace)}if(this._context.item){this._itemContentsProvider.getItemContent(this._context.item).saveFailed()}};t.prototype._onReplace=function(e,t){for(var n=0,r=e;n<r.length;n++){var i=r[n];i.input.nameConflictBehavior(3);i.input.restart()}return u.default.wrap()};t.prototype._onCompare=function(e,t){if(this._context.item){this._itemContentsProvider.getItemContent(this._context.item).outDated(!0);this.itemProvider.invalidateItem(this._context.item.key,{triggerFetch:!0})}return this.onCancel(e,t)};t.dependencies=n.__assign({},r.default.dependencies,{itemContentProvider:a.resourceKey});return t}(r.default);t.default=l;t.typeResourceKey=f.createResolvedTypeResourceKey(e("module").id,l)});
define("odsp-next/providers/operator/UploadOperator",["require","exports","tslib","./BaseUploadOperator","knockout","../../providers/item/ItemProvider","../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/resources/Resources","../../resources/DataSourceResourceKeys","../../models/itemsScope/ItemsScopeFeature.key"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=4e3,c=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=n.itemProvider,s=n.didUserUploadOrCreateFile,o=n.isItemsScopeEnabled;r.itemProvider=i;r._isItemsScopeEnabled=o();r._invalidateItem=r.createBackgroundComputed(r._computeInvalidateItem).extend({rateLimit:{timeout:l}});r._shouldInvalidate=!t.skipInvalidation||r._isItemsScopeEnabled;r._context.itemSet&&(r._currentItem=r._context.itemSet.item.peek());r._didUserUploadOrCreateFile=s;r._context.onItemUploaded&&(r._onItemUploadedCallback=r._context.onItemUploaded);return r}t.prototype.dispose=function(){this._shouldInvalidate&&this._invalidateItem();e.prototype.dispose.call(this)};t.prototype.onItemUploaded=function(e){if(this._currentItem){this._didUserUploadOrCreateFile&&this._didUserUploadOrCreateFile(!0);this._onItemUploadedCallback&&this._onItemUploadedCallback(e)}};t.prototype.onOperationFinished=function(t){this._shouldInvalidate&&this._invalidateItem();e.prototype.onOperationFinished.call(this,t)};t.prototype._computeInvalidateItem=function(){var e=this;this._lastUploadedItem();if(!i.computedContext.isInitial()&&this._shouldInvalidate){this.itemProvider.invalidateItem(this._context.parentItem.key,{triggerFetch:!0});this._context.item&&this.itemProvider.invalidateItem(this._context.item.key,{triggerFetch:!0});this._isItemsScopeEnabled&&this.resources.consumeAsync(a.itemInvalidator).then(function(t){t.invalidateItems(e._context.parentItem.key)})}};t.dependencies=n.__assign({},r.default.dependencies,{itemProvider:s.resourceKey,didUserUploadOrCreateFile:o.didUserUploadOrCreateFile.optional,isItemsScopeEnabled:f.isItemsScopeEnabledResourceKey.lazy});return t}(r.default);t.default=c;t.typeResourceKey=u.createResolvedTypeResourceKey(e("module").id,c)});
define("odsp-next/providers/operator/BaseUploadOperator",["require","exports","tslib","./BaseOperator","../../models/operation/OperationType","../../models/operation/OperationState","@ms/odsp-datasources/lib/dataSources/upload/Upload","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","@ms/odsp-shared/lib/utilities/logging/events/UploadOperation.event","@ms/odsp-utilities/lib/path/Path","../quota/UserStateProvider.key","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../actions/vault/VaultActionType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,{},n)||this;r._context=t;r._uploader=new(r.scope.attached(n.batchUploaderType))(t);r._updateQuota=n.updateQuota;r._actionMap=n.actionMap;r.registerActions({cancel:r.onCancel,overwrite:r._onOverwrite,rename:r._onRename,restart:r._onRestart,unlockVault:r._onUnlockVault});r._lastUploadedItem=r.createObservable();return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input,u=t.error;n.type=i.default.uploadItems;n.name=r.fileName.peek();n.iconName=r.iconName.peek();n.payloads.uploadItems={parent:this._context.parentItem,name:t.output.name,item:t.input.item};0===t.output.state&&(n.state=s.default.created);0===t.status&&t.output.uploadedBytes<t.output.totalBytes&&n.actions.push(this.onCancel);n.progress.maximum=t.output.totalBytes;n.progress.current=t.output.uploadedBytes;if(2===t.status){u&&(n.error.payloads.upload={error:u});if(!r.nameConflictBehavior.peek()&&u&&u.errorType===o.UploadErrorType.conflict){n.actions.push(this._onOverwrite);r.allowRename&&n.actions.push(this._onRename)}u.errorType===o.UploadErrorType.unlockRequired&&n.actions.push(this._onUnlockVault)}2!==t.status||u&&u.errorType!==o.UploadErrorType.general||n.actions.push(this._onRestart);return n};t.prototype.onStart=function(e){this._event=new l.UploadOperation({name:"UploadOperation",dragAndDrop:this._context.wasDragAndDropped,uploadType:f.UploadProcessorType[this._context.type]});this._processUploader(this._uploader,e);return this._uploader.start()};t.prototype.onCancel=function(e,t){for(var n=0,r=e;n<r.length;n++){r[n].input.abort()}return u.default.wrap()};t.prototype.onOperationFinished=function(e){var t,n,r,i=e.state.peek(),u=e.states.peek(),l=e.operations.peek(),h=e.error.peek();if(i===s.default.completed){t=a.ResultTypeEnum.Success;this._updateQuota(!0)}else t=i===s.default.canceled?a.ResultTypeEnum.ExpectedFailure:a.ResultTypeEnum.Failure;n=1===l.length?c.getFileExtension(e.payloads.peek().uploadItems.name):"";r=h?h.payloads.upload?h.payloads.upload.error.errorType:o.UploadErrorType.other:o.UploadErrorType.none;this._event&&this._event.end({size:e.progress.maximum.peek(),count:l.length,failCount:u.failed,successCount:u.completed,abortCount:u.canceled,resultType:t,dragAndDrop:this._context.wasDragAndDropped,uploadType:f.UploadProcessorType[this._context.type],extension:n,extraData:{uploadOperation_ErrorType:o.UploadErrorType[r]}})};t.prototype.onItemUploaded=function(e){};t.prototype._updateTaskOutput=function(e,t){return t};t.prototype._processUploader=function(e,t){var n=this;this.addDisposable(e);var r=function(e){t.update([e])},i=0;this.addDisposable(e.filesUploading.map({mappingWithDisposeCallback:function(e){var t="&u="+ ++i,s=n._createUploaderTaskSubscription(e,t,r);return{mappedValue:t,dispose:function(){s.dispose();var i=n._computeTask(e,t);0===i.status&&(i=i.cancel());r(i)}}}}))};t.prototype._onRestart=function(e,t){for(var n=0,r=e;n<r.length;n++){r[n].input.restart()}return u.default.wrap()};t.prototype._onOverwrite=function(e,t){for(var n=0,r=e;n<r.length;n++){var i=r[n];i.input.nameConflictBehavior(1);i.input.restart()}return u.default.wrap()};t.prototype._onRename=function(e,t){for(var n=0,r=e;n<r.length;n++){var i=r[n];i.input.nameConflictBehavior(2);i.input.restart()}return u.default.wrap()};t.prototype._onUnlockVault=function(e,t){for(var n=function(e){if(e.input.error.peek().fixItUrl){return{value:new(r.managed(r._actionMap.VaultAction))({actionType:v.default.Unlock,fixItUrl:e.input.error.peek().fixItUrl,usePopup:!0,item:e.input.item}).execute({}).then(function(t){t.resultType===a.ResultTypeEnum.Success&&e.input.restart()})}}},r=this,i=0,s=e;i<s.length;i++){var o=n(s[i]);if("object"==typeof o)return o.value}return u.default.wrap()};t.prototype._createUploaderTaskSubscription=function(e,t,n){var r=this,i=!1,s=this.createComputed(function(){var o=r._computeTask(e,t);i=1===o.status||3===o.status;if(1===o.status){var u=r.unwrapObservable(e.item);u&&r.onItemUploaded(u);r._lastUploadedItem(u)}n(o);i&&s&&s.dispose()}).extend({rateLimit:{timeout:0}});i&&s.dispose();return s};t.prototype._computeTask=function(e,t){var n=new r.Task(t,e),i=e.state(),s=e.error(),o=e.totalBytes(),u=e.uploadedBytes();3===i?n=n.cancel():4===i?n=n.fail(s):2===i&&(n=n.succeed());n=n.changeOutput(function(t){return{state:i,totalBytes:o,uploadedBytes:u,name:e.fileName()}});return n=this._updateTaskOutput(e,n)};t.dependencies=n.__assign({},r.default.dependencies,{updateQuota:h.resourceKey,batchUploaderType:d.batchUploaderType,actionMap:p.actionMap,currentItem:p.currentItem});return t}(r.default);t.default=g;t.typeResourceKey=m.createResolvedTypeResourceKey(e("module").id,g)});
define("@ms/odsp-shared/lib/utilities/logging/events/UploadOperation.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/logging/events/ResultTypeEnum"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ResultTypeEnum=i.ResultTypeEnum;t.UploadOperation=n.createPairedEvent({eventName:"UploadOperation,Qos,",shortEventName:"UploadOperation"},{dragAndDrop:3,size:2,count:2,failCount:2,abortCount:2,successCount:2,extension:1,uploadType:1,errorType:1},r.Qos);t.default=t.UploadOperation});
define("odsp-next/actions/setAlbumCoverPhoto/odc/SetAlbumCoverPhotoExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../SetAlbumCoverPhotoOperator","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.itemSelectionHelper,i=t.currentItem;n._itemSelectionHelper=r;n._currentItem=i;return n}t.prototype.execute=function(e){var t=this,n=this._currentItem;return this._itemSelectionHelper.resolveSelection().then(function(e){return t.resources.consumeAsync(i.typeResourceKey).then(function(r){var i=new r({album:n,items:e});return t.trackPromise(i.start())}).then(function(){return{resultType:s.ResultTypeEnum.Success}},function(e){return{resultType:s.ResultTypeEnum.Failure}})})};return t}(r.default);t.default=o});
define("odsp-next/actions/setAlbumCoverPhoto/SetAlbumCoverPhotoOperator",["require","exports","tslib","../../providers/operator/BaseOperator","../../providers/album/AlbumProvider.key","../../models/operation/OperationType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._context=t;r._albumProvider=n.albumProvider;return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t);n.type=s.default.setAlbumCoverPhoto;n.name=this._context.album.name;n.payloads.setAlbumCoverPhoto={album:this._context.album,item:this._context.items[0]};n.visibility=0;return n};t.prototype.onStart=function(e){return this._albumProvider.setCoverPhoto(this._context,e)};t.dependencies=n.__assign({},r.default.dependencies,{albumProvider:i.resourceKey});return t}(r.default);t.default=u;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,u)});
define("odsp-next/actions/showOperations/ShowOperationsExecutor",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ShowOperationsExecutorViewModel","./ShowOperationsExecutor.html"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.registerComponent({tagName:"od-show-operations-executor",template:e("./ShowOperationsExecutor.html"),viewModel:r.default,synchronous:!0});t.default=i});
define("odsp-next/actions/showOperations/ShowOperationsExecutorViewModel",["require","exports","tslib","../base/ControlExecutorViewModel","../../controls/overlays/panel/PanelOverlay","../../providers/operation/OperationProvider","../../controls/operation/monitor/OperationMonitor.resx","../../controls/operation/monitor/OperationMonitor","../../bindings/component/ControlBinding"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({control:a.default});n.panelOverlayTagName=i.default.tagName;n.operationMonitorSpecification=a.toSpecification(u.resourceKey,{onExecuteAction:n._onExecuteAction.bind(n)});n.panelTitle=o.strings.title;n._operationProvider=n.resources.consume(s.resourceKey);n.addDisposable(n._operationProvider.lock());return n}t.prototype.onClosePanel=function(){this.action.complete()};t.prototype._onExecuteAction=function(e){e&&e.closeHostOnExecute&&this.onClosePanel()};return t}(r.default);t.default=f});
define("odsp-next/controls/overlays/panel/PanelOverlay",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./PanelOverlayViewModel","./PanelOverlay.html","../../panelHost/PanelHost.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.registerComponent({tagName:"od-panel-overlay",template:e("./PanelOverlay.html"),viewModel:r.default,synchronous:!0});t.default=i});
define("odsp-next/controls/overlays/panel/PanelOverlayViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../Overlay","../../../bindings/dismiss/DismissBinding","../../../bindings/host/HostBinding","../../../bindings/interactionScope/InteractionScopeBinding","../../../bindings/scrollContainer/ScrollContainerBinding","../../../bindings/focus/FocusTrapBinding","../../../bindings/focus/PreserveFocusBinding","../../../bindings/focus/RecoverFocusBinding","../../../bindings/element/ElementBinding","../../../utilities/browser/ResponsiveUI","../../panelHost/PanelHost.resx","../../fluentStyling/FluentStyling.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m={},g=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.overlayTagName=i.default.tagName;n.closePanelLabel=d.strings.closePanelLabel;n.addBindingHandlers({dismiss:s.default,element:h.default,host:o.default,interactionScope:u.default,focusTrap:f.default,recoverFocus:c.default,preserveFocus:l.default,scrollContainer:a.default});var r=t.size,p=void 0===r?"Small":r,g=t.title,y=void 0===g?"":g,b=t.onClose,w=t.ariaLabel,E=void 0===w?"":w,S=t.showCloseButton,x=void 0===S||S,T=t.isOpen,N=t.width,C=void 0===N?"":N,k=t.virtualParentElement;n._size=p;n._onClose=b;n.contentElement=n.createObservable();n.title=n.wrapObservable(y);n._ariaLabel=n.wrapObservable(E);n.showCloseButton=n.createObservable(!!n._onClose&&x);n.isOpen=T;n.widthClass=n.createPureComputed(n._computeWidthClass,{deferEvaluation:!0});n.style=C?{width:C+"px"}:m;n.ariaLabel=n.createPureComputed(n._computeAriaLabel);n.virtualParentElement=k;n.isFluentFlight=n.resources.consume(v.resourceKey);return n}t.prototype.onClose=function(e,t){this._onClose&&this._onClose(t);return!1};t.prototype.onDismiss=function(e,t){this._onClose&&this._onClose(t);return!1};t.prototype.isPanelOpen=function(e){return this.isOpen?this.isOpen():e()};t.prototype._computeWidthClass=function(){return this.style===m?"od-Panel--"+p.default.determineCssClass(this._size):""};t.prototype._computeAriaLabel=function(){return this.unwrapObservable(this.title)||this.unwrapObservable(this._ariaLabel)};return t}(r.default);t.default=g});
define("odsp-next/controls/overlays/panel/PanelOverlay.html",[],function(){return'\x3c!--ko component: {\r\n name: overlayTagName,\r\n params: {\r\n animation: {\r\n afterAdd: 1,\r\n beforeRemove: 500,\r\n isOpen: isOpen\r\n },\r\n alignToParent: false,\r\n virtualParentElement: virtualParentElement\r\n }\r\n}--\x3e<div class=od-Panel-container data-bind="focusTrap: {}, css: { \'od-Panel--hidden\': !isPanelOpen($host.isOpen) }"><div class="ms-ModalOverlay od-PanelOverlay"></div><div class="od-Panel od-Panel--hasPadding od-Panel--autoScroll" role=dialog tabindex=-1 data-bind="interactionScope: { isScope: true }, preserveFocus, recoverFocus: { isEnabled: isPanelOpen($host.isOpen) }, scrollContainer, dismiss: { isOpen: isOpen || $host.isOpen, close: $component.onDismiss.bind($component), useLocalEvents: true }, class: widthClass(), attr: { \'aria-label\': ariaLabel }, style: style, element: $component.contentElement">\x3c!--ko if: title--\x3e<div class=od-Panel-title role=heading aria-level=1 data-bind="text: title, css: { \'ms-fontWeight-semilight\': !$component.isFluentFlight, \'ms-fontWeight-semibold\': $component.isFluentFlight, \'ms-font-xl\': !$component.isFluentFlight }"></div>\x3c!--/ko--\x3e<div class=od-Panel-content data-bind="host: {}"></div>\x3c!--ko if: showCloseButton--\x3e<button class="od-Panel-button od-Panel-button--close" data-bind="click: $component.onClose.bind($component), attr: { \'aria-label\': $component.closePanelLabel }"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/operation/monitor/OperationMonitor",["require","exports","./OperationMonitorViewModel","../../../bindings/component/ControlBinding","./OperationMonitor.html","./OperationMonitor.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"ms-operation-monitor",name:e("module").id,template:e("./OperationMonitor.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/operation/monitor/OperationMonitorViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../providers/operation/OperationProvider","./OperationGroupViewModel","../../../bindings/preRender/PreRenderBinding","../../progress/bar/ProgressBar","../../fileTypeIcon/FileTypeIcon","./OperationMonitor.resx","../../notifyExperiment/NotifyExperiment","../../../bindings/component/ControlBinding","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","../../fluentStyling/FluentStyling.key","@ms/odsp-shared/lib/utilities/knockout/Projections"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.noOperationsText=f.strings.noOperationsText;r.progressBarTagName=u.default.tagName;r.fileTypeIconTagName=a.default.tagName;var i=n.operationProvider,p=n.useFluentStyling,d=t.expandGroups,v=void 0===d||d,m=t.groups,g=void 0===m?i.groups:m,y=t.onViewAll,b=t.onExecuteAction,w=t.showCloseAction;r.addBindingHandlers({preRender:o.default,control:c.default});r._groupOperations=g;r.groups=r.addDisposable(g.map({mappingWithDisposeCallback:function(e){var t=new(r.managed(s.default))({group:e,showIndividualOperations:v,onViewAll:y,onExecuteAction:b,showCloseAction:w});return{mappedValue:t,dispose:function(){t.dispose()}}}}));r.isFluentFlight=p;r.showNotifyExperiment=r.observables.createCallback(h.forSingleValue(!1));r.hideNotifyExperimentInProgressPane=v;r.notifyExperimentSpecification=c.toSpecification(l.resourceKey,{groups:r._groupOperations,showNotifyExperiment:r.showNotifyExperiment,onExecuteAction:b});return r}t.dependencies=n.__assign({},r.default.dependencies,{operationProvider:i.resourceKey,useFluentStyling:p.resourceKey});return t}(r.default);t.default=d});
define("odsp-next/controls/operation/monitor/OperationGroupViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/async/Promise","./OperationViewModel","./OperationActionViewModel","../../../models/operation/OperationState","../../../models/operation/OperationType","../strings/OperationStringMappings","../../../providers/operation/OperationProvider","../../../bindings/html/BindableHtmlBinding","./OperationMonitor.resx","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","../../shareAfterUpload/ShareAfterUpload","../../../bindings/component/ControlBinding"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.viewAllText=h.strings.viewAllText;n.showActionDetailsAccessibleHintText=h.strings.showActionDetailsAccessibleHintText;n.addBindingHandlers({bindableHtml:c.default,control:v.default});n._group=t.group;n._showIndividualOperations=t.showIndividualOperations;n._showOneOperation=t.showOneOperation;n._onExecuteAction=t.onExecuteAction;n._onViewAll=t.onViewAll;n._disallowedActions={};n._allowCloseAction=t.showCloseAction;n.progress=n._group.progress;n.context={count:n._group.count,states:n._group.states,progress:n._group.progress,payloads:n._group.payloads,error:n._group.error};t.stringMappings?n._stringMappings=t.stringMappings:n._stringMappings=f.default;n._operationProvider=n.resources.consume(l.resourceKey);n._showCloseAction=n.createPureComputed(n._computeShowCloseAction);n._operations=n._getOperations();var r=n._getActions(),i=r.buttonActions,s=r.iconActions;n.buttonActions=i;n.iconActions=s;var o=n._getOperationViewModels(),u=o.operations,a=o.showViewAll;n.operations=u;n.showViewAll=a;n.title=n.createComputed(n._computeTitle);n.description=n.createComputed(n._computeDescription);n.showProgress=n.createPureComputed(n._computeShowProgress);n.showDescription=n.createPureComputed(n._computeShowDescription);n.css=n.createComputed(n._computeCss);n.showShareButton=n.observables.createCallback(p.forSingleValue(!1));n.shareAfterUpload=v.toSpecification(d.resourceKey,{group:n._group,showShareButton:n.showShareButton,onExecuteAction:n._onExecuteAction});return n}t.prototype.onClickViewAll=function(e,t){if(this._onViewAll){this._onViewAll();t.stopPropagation();t.preventDefault()}};t.prototype._computeTitle=function(){var e=u.default[this._group.state()],t=a.default[a.default.multiple],n=this._getMappingForType(),r=n.states[e],i=f.default.types[t],s=i.states[e],o=r&&r.title||n.title||s&&s.title||i.title;return f.resolveEntry(o,this.context)};t.prototype._computeDescription=function(){var e=u.default[this._group.state()],t=a.default[a.default.multiple],n=this._getMappingForType().states[e],r=f.default.types[t].states[e],i=n&&n.description||r&&r.description;return f.resolveEntry(i,this.context)};t.prototype._computeShowProgress=function(){var e=this._getMappingForType().showProgress;if(e)return f.resolveEntry(e,this.context);var t=this._group;return this._showIndividualOperations&&(t.state()===u.default.started||t.progress.current()>t.progress.minimum())};t.prototype._computeShowDescription=function(){var e=this._getMappingForType().showDescription;return e?f.resolveEntry(e,this.context):this._showIndividualOperations&&(this._group.state()!==u.default.failed||!!this.buttonActions().length)};t.prototype._computeShowCloseAction=function(){var e=this._group.state();if(!1===this._allowCloseAction)return!1;if(e!==u.default.canceled&&e!==u.default.completed&&e!==u.default.failed)return!1;var t=this._group.actions().cancel;return!t||!1===t.isAvailable()};t.prototype._computeCss=function(){return"OperationMonitor-item--"+u.default[this._group.state()]};t.prototype._getMappingForType=function(){var e=this._stringMappings.types,t=a.default[this._group.type()];return e[t+"Group"]||e[t]};t.prototype._getActions=function(){var e=this,t=this.observables.createArray(),n=this._group,r={key:"close",count:n.count,isAvailable:this._showCloseAction,execute:function(){return i.default.wrap().then(function(){e._operationProvider.deleteGroupOperation(n)})}};this._group.actions().close=r;this.createComputed(function(){t(Object.keys(n.actions()).map(function(e){return n.actions.peek()[e]}))});var s=this._disallowedActions,l=this.addDisposable(t.filter(function(t){var r=a.default[n.type()],i=e._stringMappings.types[r].actions,o=i&&i[t.key],l=f.default.actions[t.key],c=o&&o.mode||l.mode||0,h=1!==c&&t.count()>3||1===c,p=!e._showIndividualOperations&&e._group.state()!==u.default.failed||!!l.icon||h,d=!h||3===c;s[t.key]?s[t.key](!d):s[t.key]=e.createObservable(!d);return p&&t.isAvailable()})),c=this.addDisposable(l.map({mappingWithDisposeCallback:function(t){var n=new(e.managed(o.default))({action:t,onExecuteAction:e._onExecuteAction,actionMapping:e._stringMappings.actions,operationType:e._group.type});return{mappedValue:n,dispose:function(){n.dispose()}}}}));return{buttonActions:this.addDisposable(c.filter(function(e){return!e.icon})),iconActions:this.addDisposable(c.filter(function(e){return!!e.icon}))}};t.prototype._getOperations=function(){var e=this,t=this._group,n=this.createPureComputed(function(){return 1===t.operations().length}),r=this.createPureComputed(function(){return t.operations().length>10}),i=this.createPureComputed(function(){return t.states().started<10}),s=this.createPureComputed(function(){return t.states().created+t.states().started<10});return this.addDisposable(t.operations.filter(function(t){return!(!e._showIndividualOperations&&!n()&&t.state()!==u.default.failed)&&(!(!e._showOneOperation&&n()&&t.state()!==u.default.failed)&&(!r()||t.state()===u.default.failed||(!(!s()||t.state()!==u.default.created)||!(!i()||t.state()!==u.default.started))))}))};t.prototype._getOperationViewModels=function(){var e,t=this,n=this.observables;if(this._showIndividualOperations)e=this._operations;else{e=n.createArray();n.compute(function(){e.splice.apply(e,[0,1/0].concat(t._operations().slice(0,1)))})}return{operations:this.addDisposable(e.map({mappingWithDisposeCallback:function(e){var n=new(t.managed(s.default))({operation:e,onExecuteAction:t._onExecuteAction,disallowedActions:t._disallowedActions,stringMapping:t._stringMappings});return{mappedValue:n,dispose:function(){n.dispose()}}}})),showViewAll:n.pureCompute(function(){return!!t._onViewAll&&e().length<t._operations().length})}};return t}(r.default);t.default=m});
define("odsp-next/controls/operation/monitor/OperationViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../models/operation/OperationState","../../../models/operation/OperationType","./OperationActionViewModel","../strings/OperationStringMappings","../../../bindings/html/BindableHtmlBinding","knockout"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({bindableHtml:a.default});n._operation=t.operation;n._onExecuteAction=t.onExecuteAction;n._disallowedActions=t.disallowedActions||{};t.stringMapping?n._stringMappings=t.stringMapping:n._stringMappings=u.default;n.context={count:n._operation.count,states:n.createComputed(n._computeStates),progress:n._operation.progress,payloads:n._operation.payloads,error:n._operation.error};n.progress=n._operation.progress;n.iconName=n._operation.iconName;n._initializeActions();n.title=n.createComputed(n._computeTitle);n.description=n.createComputed(n._computeDescription);n.css=n.createPureComputed(n._computeCss);n.showProgress=n.createPureComputed(n._computeShowProgress);return n}t.prototype._computeStates=function(){var e={created:0,started:0,completed:0,failed:0,canceled:0,expired:0};e[i.default[this._operation.state()]]=1;return e};t.prototype._computeTitle=function(){return this._operation.name};t.prototype._computeDescription=function(){var e=i.default[this._operation.state()],t=s.default[this._operation.type()],n=s.default[s.default.multiple],r=this._stringMappings.types[t].states[e],o=u.default.types[n].states[e],a=r&&r.description||o&&o.description;return this._evaluateOperationEntry(a)};t.prototype._initializeActions=function(){var e=this,t=f.observableArray();this.createComputed(function(){t(Object.keys(e._operation.actions()).map(function(t){return e._operation.actions.peek()[t]}))});var n=this.addDisposable(t.filter(function(t){return(!e._disallowedActions[t.key]||!e._disallowedActions[t.key]())&&t.isAvailable()})),r=this.addDisposable(n.map({mappingWithDisposeCallback:function(t){var n=new(e.managed(o.default))({action:t,onExecuteAction:e._onExecuteAction,actionMapping:e._stringMappings.actions,operationType:e._operation.type});return{mappedValue:n,dispose:function(){n.dispose()}}}}));this.buttonActions=this.addDisposable(r.filter(function(e){return!e.icon}));this.iconActions=this.addDisposable(r.filter(function(e){return!!e.icon}))};t.prototype._computeCss=function(){return"OperationMonitor-item--"+i.default[this._operation.state()]};t.prototype._computeShowProgress=function(){var e=this._operation;return e.state()!==i.default.created&&e.progress.current()>e.progress.minimum()||this._evaluateOperationEntry(this._stringMappings.types[s.default[e.type.peek()]].showProgress)};t.prototype._evaluateOperationEntry=function(e){return"function"==typeof e?e(this.context):e};return t}(r.default);t.default=l});
define("odsp-next/controls/operation/monitor/OperationActionViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../models/operation/OperationType","../strings/OperationStringMappings","@ms/odsp-utilities/lib/async/Promise","../../../providers/engagement/Engagement","@ms/utilities-strings/lib/index"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._action=t.action;n._onExecuteAction=t.onExecuteAction;n._engagement=n.resources.consume(u.resourceKey);n._context={count:n._action.count,states:n.createObservable({}),payloads:n.createObservable({}),progress:null,error:n.createObservable()};n._operationType=t.operationType;n.key=n._action.key;var r=t.actionMapping,i=void 0===r?s.default.actions:r;n._actionMapping=i[n.key];n.icon=n._actionMapping.icon;n.title=n.createPureComputed(n._computeTitle);n.iconCss=n.createPureComputed(n._computeIconCss);return n}t.prototype.execute=function(){var e=this;this._engagement.logData({name:""+a.capitalize(i.default[this._operationType.peek()])+a.capitalize(this._action.key)+".OperationAction.Click",isIntentional:!0});o.default.wrap().then(function(){return e._action.execute()}).done();this._onExecuteAction&&this._onExecuteAction(this._action)};t.prototype._computeTitle=function(){return s.resolveEntry(this._actionMapping.name,this._context)};t.prototype._computeIconCss=function(){return this.icon&&this.icon.getClass()||""};return t}(r.default);t.default=f});
define("odsp-next/controls/shareAfterUpload/ShareAfterUpload",["require","exports","./ShareAfterUploadViewModel","../../bindings/component/ControlBinding","./ShareAfterUpload.html","./ShareAfterUpload.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"od-share-link",name:e("module").id,template:e("./ShareAfterUpload.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/shareAfterUpload/ShareAfterUploadViewModel",["require","exports","tslib","../../models/operation/OperationState","../../models/operation/OperationType","@ms/odsp-shared/lib/base/ViewModel","../../utilities/features/Features","../../resources/SPOResourceKeys","../../resources/ControlResourceKeys","../../controls/sharing/share/commands/ShareCommandKeys","../../models/item/ItemType","./ShareAfterUpload.resx","../../bindings/component/ControlBinding","../../resources/DataSourceResourceKeys","../../pages/files/UseItemsScope.key","./ShareAfterUpload.key","@ms/odsp-datasources/lib/dataSources/web/WebTemplateType"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._group=t.group;r._showShareButton=r.observables.pureCompute(r._computeShowShareButton);r.scope.attach(t.showShareButton.register(r._showShareButton));r._pageContext=n.pageContext;r._actionMap=n.actionMap;r._urlDataSource=r.resources.consume(p.url);r.addBindingHandlers({control:h.default});r.shareButtonText=c.strings.shareActionText;r.useItemsScope=r.resources.consume(d.resourceKey).peek();var i=r._group.payloads.peek().uploadItems,s=i&&i.item&&i.item.peek(),o=!!s;r.useItemsScopeShareAfterUpload=r.useItemsScope&&o;r.useItemsScopeShareAfterUpload&&(r.shareAfterUploadSpecification=h.toSpecification(v.resourceKey,{props:{storeKey:s.key,urlDataSource:r._urlDataSource}}));return r}t.prototype.onClickShareButton=function(e){new(this.managed(this._actionMap.ShowShareAction))({focusItemResourceKey:f.shareFocusItemResourceKey,overrideItem:this._group.payloads().uploadItems.item(),scenarioId:"ShareAfterUpload"}).execute(e)};t.prototype._computeShowShareButton=function(){var e=!1;if(o.isFeatureEnabled(o.EnableShareLinkAfterUpload)&&this._group.state()===r.default.completed&&this._group.type()===i.default.uploadItems&&1===this._group.count()&&this._group.payloads().uploadItems){var t=this._group.payloads().uploadItems.item(),n=new RegExp(this._pageContext.listUrl+"/Forms/"),s=t.id&&t.id.match(n);Number(this._pageContext.webTemplate)===m.default.mySite&&t.type===l.default.File&&!s&&(e=!0)}return e};t.dependencies=n.__assign({},s.default.dependencies,{pageContext:u.pageContext.optional,actionMap:a.actionMap});return t}(s.default);t.default=g});
define("odsp-next/controls/shareAfterUpload/ShareAfterUpload.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./react/ShareAfterUpload"],t,n)}).then(function(e){return e.knockoutResourceKey.local})})});t.default=t.resourceKey});
define("odsp-next/controls/shareAfterUpload/ShareAfterUpload.html",[],function(){return'\x3c!--ko if: useItemsScopeShareAfterUpload--\x3e\x3c!--ko control: shareAfterUploadSpecification--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot: useItemsScopeShareAfterUpload--\x3e<div class=od-operationMonitor-ShareLink><button class="od-Button od-Button--primary od-operationMonitor-ShareLinkButton" data-bind="text: shareButtonText, click: onClickShareButton"></button></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/shareAfterUpload/ShareAfterUpload.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-operationMonitor-ShareLink{padding:16px 0}.od-Button.od-Button--primary.od-operationMonitor-ShareLinkButton{display:-ms-flexbox;display:flex;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}[dir=ltr] .od-Button.od-Button--primary.od-operationMonitor-ShareLinkButton{margin-left:auto}[dir=rtl] .od-Button.od-Button--primary.od-operationMonitor-ShareLinkButton{margin-right:auto}"}])});
define("odsp-next/bindings/preRender/PreRenderBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","knockout"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){for(var n=e.call(this,t)||this,r=[],s=0,o=i.virtualElements.childNodes(n.element);s<o.length;s++){var u=o[s];r.push(u)}i.virtualElements.emptyNode(n.element);var a=document.createElement(n.element.tagName);i.applyBindingsToNode(a,{template:{nodes:r}},n.bindingContext);n.element.appendChild(a);n.controlsDescendantBindings=!0;return n}return t}(r.default);t.default=s});
define("odsp-next/controls/notifyExperiment/NotifyExperiment",["require","exports","./NotifyExperimentViewModel","../../bindings/component/ControlBinding","./NotifyExperiment.html","./NotifyExperiment.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"od-notify-experiment",name:e("module").id,template:e("./NotifyExperiment.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/notifyExperiment/NotifyExperimentViewModel",["require","exports","tslib","../../providers/peoplePicker/PeoplePickerProvider","../../utilities/peoplePicker/GraphPeoplePickerHelper","../../providers/sharing/SharingProvider","../../providers/suiteNav/SuiteNavProvider","../../providers/policyTip/PolicyTipProvider","../../resources/SPOResourceKeys","../../resources/ControlResourceKeys","@ms/odsp-shared/lib/base/ViewModel","../../models/operation/OperationState","../../models/operation/OperationType","@ms/odsp-datasources/lib/dataSources/web/WebTemplateType","@ms/odsp-shared-sharing/lib/Share","@ms/odsp-utilities/lib/icons/ItemType","../sharing/share/react/Share","../../bindings/react/ReactBinding","../../bindings/focus/FocusTrapBinding","../../bindings/focus/AutoFocusBinding","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../providers/sharing/react/SharingStore"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=d.ClientId.sharePoint,x=d.Mode.notify,T=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onDismiss=function(){var e=r._itemToShare(),t={name:"Notify.Dismissed",clientId:S,mode:x,appMap:e.appMap};w.Engagement.logData(t);r._onExecuteAction()};r.addBindingHandlers({react:g.default,focusTrap:y.default,autoFocus:b.default});var i=t.groups,s=t.onExecuteAction;r._pageContext=n.pageContext;r._actionMap=n.actionMap;r._peoplePickerProvider=n.peoplePickerProvider;r._graphPeoplePickerHelper=n.graphPeoplePickerHelper;r._sharingProvider=n.sharingProvider;r._suiteNavProvider=n.suiteNavProvider;r._policyTipProvider=n.policyTipProvider;r._groupOperations=i;r._onExecuteAction=s;r.element=r.observables.create(null);r._itemToShare=r.observables.pureCompute(r._computeItemToShare);r.showNotifyExperiment=r.observables.pureCompute(r._computeShowNotifyExperiment);r.scope.attach(t.showNotifyExperiment.register(r.showNotifyExperiment));r.shareComponent=m.default;r.shareComponentProps=r.createPureComputed(r._computeShareProps);return r}t.prototype._computeShowNotifyExperiment=function(){if(!this._policyTipProvider||!this._pageContext||!this._graphPeoplePickerHelper)return!1;var e=Number(this._pageContext.webTemplate);if(e===p.default.teamSite||e===p.default.group){var t=this._itemToShare();if(t){var n=new RegExp(this._pageContext.listUrl+"/Forms/"),r=t.id&&t.id.match(n);return t.type!==v.ItemType.Folder&&!!t.properties.uniqueId&&!r}}return!1};t.prototype._computeShareProps=function(){var e=this._itemToShare(),t=new E.default({item:e,accessChecked:!1,sharingInformation:null,defaultRecipients:null,mode:x,sharingContextInformation:null},{sharingProvider:this._sharingProvider,suiteNavProvider:this._suiteNavProvider,peoplePickerProvider:this._peoplePickerProvider,policyTipProvider:this._policyTipProvider,graphPeoplePickerHelper:this._graphPeoplePickerHelper});return{clientId:S,actionMap:this._actionMap,item:e,onDismiss:this._onDismiss,peoplePickerProvider:this._peoplePickerProvider,graphPeoplePickerHelper:this._graphPeoplePickerHelper,resources:this.resources,sharingProvider:this._sharingProvider,policyTipProvider:this._policyTipProvider,mode:x,sharingStore:t}};t.prototype._computeItemToShare=function(){var e=this._groupOperations();if(1===e.length){var t=e[0].operations();if(1===t.length){var n=t[0];if(n.state()===c.default.completed&&n.type()===h.default.uploadItems){var r=n.payloads().uploadItems;if(r)return r.item()}}}};t.dependencies=n.__assign({},l.default.dependencies,{pageContext:a.pageContext.optional,actionMap:f.actionMap,peoplePickerProvider:r.resourceKey,graphPeoplePickerHelper:i.resourceKey.optional,sharingProvider:s.resourceKey,suiteNavProvider:o.resourceKey,policyTipProvider:u.resourceKey.optional});return t}(l.default);t.default=T});
define("odsp-next/utilities/peoplePicker/GraphPeoplePickerHelper",["require","exports","tslib","../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-datasources/lib/utilities/peoplePicker/GraphPeoplePickerHelper","../../providers/oAuthToken/OAuthTokenProvider","@ms/odsp-datasources/lib/utilities/peoplePicker/GraphPeoplePickerHelper"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(u,t);t.resourceKey=i.createResolvedResourceKey(e("module").id,s.GraphPeoplePickerHelper,{oAuthTokenProvider:o.resourceKey,pageContext:r.pageContext,sharingContextInformation:r.sharingContextInformation.optional})});
define("@ms/odsp-datasources/lib/utilities/peoplePicker/GraphPeoplePickerHelper",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/features/FeatureOverrides","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PeoplePickerGraph={ODB:387};var u=function(){function e(e,t){this._pageContext=t.pageContext;this._sharingContextInformation=t.sharingContextInformation;this._oAuthTokenProvider=t.oAuthTokenProvider;this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._graphToken=this._sharingContextInformation.additionalTokens.graphToken);this.initializeDataStore()}e.prototype.canUseGraph=function(){if(this._graphToken)return!0;if(this._pageContext&&!this._pageContext.isSPO)return!1;if(this._pageContext&&this._pageContext.authToken)return!1;var e=this._pageContext&&this._oAuthTokenProvider&&r.default.isFeatureEnabled(t.PeoplePickerGraph);this._dataStore&&(e=e&&!this._dataStore.getValue("DisableGraph",o.default.session));return e};e.prototype.disableGraphCallsForPicker=function(){this.initializeDataStore();this._dataStore.setValue("DisableGraph",!0,o.default.session)};e.prototype.getGraphToken=function(){var e=this;if(this._graphToken)return n.default.resolve(this._graphToken);if(this._oAuthTokenProvider){var t=new i.Qos({name:"PeoplePicker.GetGraphToken"});return this._oAuthTokenProvider.getToken("https://graph.microsoft.com").then(function(e){t.end({resultType:i.ResultTypeEnum.Success});return e},function(r){if(n.default.isCanceled(r)){t.end({resultType:i.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"});return n.default.reject(r)}t.end({resultCode:"PeoplePicker.GetGraphTokenError",resultType:i.ResultTypeEnum.Failure,extraData:{serverErrorCode:r._serverErrorCode,message:r.message}});e.disableGraphCallsForPicker();return null})}return null};e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new s.default("PeoplePicker",o.default.session))};return e}();t.GraphPeoplePickerHelper=u});
define("odsp-next/providers/policyTip/PolicyTipProvider",["require","exports","tslib","@ms/odsp-utilities/lib/resources/Resources","../../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataSource=n.policyTipDataSource;return r}t.prototype.getPolicyTip=function(e){return this._dataSource.getPolicyTip(e)};t.prototype.updatePolicy=function(e){return this._dataSource.updatePolicy(e)};t.dependencies=n.__assign({},s.default.dependencies,{policyTipDataSource:i.policyTip});return t}(s.default);t.default=o;t.resourceKey=r.createResolvedResourceKey(e("module").id,o)});
define("@ms/odsp-shared-sharing/lib/Share",["require","exports","tslib","./components/Share/index","./components/Share/index","./components/ShareNotification/ShareNotification","./interfaces/SharingInterfaces","./interfaces/enums/OutlookAvailability"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.Share;t.ShareNotification=s.ShareNotification;t.Mode=o.Mode;t.SharingAudience=o.SharingAudience;t.ClientId=o.ClientId;t.OutlookAvailability=u.default});
define("@ms/odsp-shared-sharing/lib/components/Share/index",["require","exports","tslib","./Share"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/odsp-shared-sharing/lib/components/Share/Share",["require","exports","tslib","../CopyLink/CopyLink","../Header/Header","../../interfaces/SharingInterfaces","../ModifyPermissions/ModifyPermissions","../PermissionsList/PermissionsList","../ShareMain/ShareMain","../ShareNotification/ShareNotification","../SharePolicyDetails/SharePolicyDetails","office-ui-fabric-react/lib/Spinner","react","react","prop-types","../../utilities/PeoplePickerHelper","../../utilities/ClientIdHelper","office-ui-fabric-react/lib/Fabric","../ActivityIndicator/ActivityIndicator","office-ui-fabric-react/lib/Button","../AtMention/AtMention","../Notify/Notify","../../utilities/ShareHelper","@ms/odsp-utilities/lib/uri/Uri","../Share.resx","../../utilities/SharingAbilitiesHelper","../../utilities/ShareCommunicationManager","@ms/odsp-utilities/lib/events/EventGroup","../AddPeople/AddPeople","../Error/Error","office-ui-fabric-react/lib/Styling","../../utilities/ShareHelper","../PermissionsList/ShareLink/ConfirmationDialog/ConfirmationDialog","@ms/odsp-utilities/lib/killswitch/Killswitch","./Share.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var P=function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._viewStates=[];i._shareMainControl=p.createRef();i._copyLinkOnCancelClicked=function(){i.setState({viewState:3},function(){i._store.getEngagementHelper().linkSettingsCancelClicked(i._engagementExtraData)})};i._copyLinkOnApplyClicked=function(e){i.setState({currentSettings:e,linkRecipients:e.specificPeople},function(){i._store.getEngagementHelper().linkSettingsApplyClicked(i._engagementExtraData);i._onCopyLinkClicked(!0)})};i._closeButtonOnBlur=function(){i.setState({isCloseButtonOnFocus:!1})};i._closeButtonOnFocus=function(){i.setState({isCloseButtonOnFocus:!0})};i.onEditChange=function(e){var t=i.state.currentSettings,r=S.getLinkKind(t.audience,2===e);i.setState(n.__assign({},i.state,{currentSettings:n.__assign({},t,{sharingRole:e,isEdit:2===e,sharingLinkKind:r})}))};i._onShareTargetClicked=function(e){if(e===s.ShareType.copy){C.copyLinkShareTargetClicked();i._onCopyLinkClicked()}else e===s.ShareType.outlook?i._onOutlookClicked():e===s.ShareType.nonOutlook?i._onNonOutlookClicked():e===s.ShareType.teams?i._onTeamsClicked():e===s.ShareType.moreApps&&i._onMoreAppsClicked()};i._onLinkPermissionsApplyClicked=function(e){i._store.getEngagementHelper().linkSettingsApplyClicked(i._engagementExtraData);i._onSelectedPermissionsChange(e);i.props.mode===s.Mode.linkSettings&&i.setState({shareType:s.ShareType.share,applyLinkSettingsClicked:!0},function(){i._store.shareLink({settings:i.state.currentSettings,recipients:i.state.linkRecipients,copyLinkCommand:!1})})};i._onLinkPermissionsCancelClicked=function(){i.props.mode===s.Mode.linkSettings&&C.dismiss();i.setState({viewState:0},function(){i._store.getEngagementHelper().linkSettingsCancelClicked(i._engagementExtraData)})};i._onBackButtonClicked=function(){i.setState({viewState:i._viewStates.pop()})};i._hideElementsInManageAccess=function(e){i.props.hideElementsInManageAccess&&i.props.hideElementsInManageAccess(e)};i._onLinkPermissionsReady=function(){i.props.mode===s.Mode.linkSettings&&C.pageFinishedLoading(i._shareClickTime,i.props.clientId,s.Mode.linkSettings,i.props.scenarioId)};i._onSelectedPeopleChange=function(e){var t=i.state.permissionsMap;i.state.currentSettings.audience===s.SharingAudience.existing&&i._store.checkPermissions(e);i._store.resetPeoplePickerError();i.setState({linkRecipients:e,permissionsMap:t},function(){i._store.getEngagementHelper().peoplePickerLinkedinSuggestionSelected(i._engagementExtraData,e);i._store.fetchGroupsMemberCount(e)})};i._onSendLinkClicked=function(e,t){var n=i.state.linkRecipients;i.setState({shareType:s.ShareType.share,recipientsCount:n.length,externalRecipientsCount:v.getExternalPeopleCount(n),linkedinRecipientsCount:v.getLinkedInPeopleCount(n),hasMessage:!!e,hasSubject:!!t,messageLength:e?e.length:0,shareTargetClicked:!0},function(){C.sendLinkClicked();i._store.shareLink({settings:i.state.currentSettings,recipients:n,emailMessage:e,emailSubject:t})})};i._onViewPolicyTipClicked=function(){i.setState({viewState:6})};i._onSendLinkMessageChange=function(e){i.setState({messageText:e})};i._onSendLinkSubjectChange=function(e){i.setState({subjectText:e})};i._onShareTargetsRendered=function(e){var t=n.__assign({},i._engagementExtraData,{shareTargets:e});i._store.getEngagementHelper().shareTargets(t)};i._onInterruptUseNew=function(){i._store.getEngagementHelper().copyLinkInterruptEditLinkChosen(i._engagementExtraData);i.setState({shareType:s.ShareType.copy,shareTargetClicked:!0,showCopyLinkInterrupt:!1},function(){i._store.shareLink({settings:i.state.currentSettings,recipients:i.state.linkRecipients,copyLinkCommand:!1})})};i._onInterruptUseExisting=function(){i._store.getEngagementHelper().copyLinkInterruptExistingLinkChosen(i._engagementExtraData);i.setState({shareType:s.ShareType.copy,shareTargetClicked:!0,showCopyLinkInterrupt:!1},function(){i._store.shareLink({settings:i.state.currentSettings,recipients:i.state.linkRecipients,copyLinkCommand:!0})})};i._onInterruptCancel=function(){i._store.getEngagementHelper().copyLinkInterruptCancelled(i._engagementExtraData);i.setState({showCopyLinkInterrupt:!1});i._shareMainControl.current.shouldShowActivityIndicator(!1)};i._showModifyPermissions=function(e){i.setState({viewState:2},function(){i._store.getEngagementHelper().linkSettingsOpened(i._engagementExtraData)})};i._showPermissionsList=function(){i._store.getEngagementHelper().manageAccessOpened(i._engagementExtraData);var e=i.props,t=e.invokeManageAccess,n=e.onManageAccessClicked,r=n&&!t;t?C.invokeManageAccess():r?n():i.setState({viewState:4})};i._showPolicy=function(){i.setState({viewState:6})};i._dismiss=r.onDismiss;i._resize=r.resize;i._store=r.sharingStore;i._shareClickTime=r.shareClickTime;i._isPeopleSharingLinksEnabled=!1;var o=C.isDarkMode();(t.theme||o)&&i._loadTheme(o?S.getDarkTheme():t.theme);i.state={companyName:null,currentSettings:null,sharingInformation:null,sharingLinkCreated:null,viewState:0,readyToCopy:!1,shareType:s.ShareType.share,groupsMemberCount:0,policyTipInformation:null,linkRecipients:[],shareTargetClicked:!1,applyLinkSettingsClicked:!1,showActivityIndicator:!1,permissionsMap:{},messageText:t.messageText||"",subjectText:t.subjectText||"",isLoadingDefaultRecipients:i._store.isValidatingDefaultRecipients(),isCloseButtonOnFocus:!1,showCopyLinkInterrupt:!1};i._engagementExtraData={clientId:t.clientId,scenarioId:t.scenarioId,correlationId:t.correlationId||"",mode:t.mode||(t.copyLinkShortcut?s.Mode.copy:s.Mode.share)};return i}t.prototype.componentDidMount=function(){var e=this;this._store.getEngagementHelper().opened(this._engagementExtraData);var t=this._store;new k.default(this).on(window,"keydown",function(t){t&&27===t.keyCode&&e._handleEscKeyPress(t)});t.addListener(function(){var r=t.getSharingInformation(),i=t.getSharingLinkCreated(),o=t.getCompanyName(),u=t.getGroupsMemberCount(),a=t.getPolicyTipInformation(),f=t.getPermissionsMap(),l=t.getDefaultRecipients();e._outlookAvailability=t.getOutlookAvailability();e._isPeopleSharingLinksEnabled=t.isPeopleSharingLinksEnabled();if(r){r.webTemplateId&&(e._engagementExtraData.webTemplateId=r.webTemplateId);r.itemUniqueId&&(e._engagementExtraData.itemUniqueId=r.itemUniqueId);var c=e._getSettings(r);if(i&&(e.state.shareTargetClicked||e.props.copyLinkShortcut||e.state.applyLinkSettingsClicked)){e._modifiedSharingLinkUrl=e._trackClickThru(i,c,r);var h=e.state.shareType,p=e.state.currentSettings,d=p?p.isEdit:c.isEdit,v=p?p.preventDownload:c.preventDownload,g=n.__assign({},e._engagementExtraData,{shareType:h,audience:i.audience,isEdit:d,recipientsCount:e.state.recipientsCount,externalRecipientsCount:e.state.externalRecipientsCount,linkedinRecipientsCount:e.state.linkedinRecipientsCount,hasMessage:e.state.hasMessage,hasSubject:e.state.hasSubject,messageLength:e.state.messageLength,daysUntilExpiry:e._getNumberOfDaysUntilExpiry(i),isDefaultLink:r.defaultSharingLink.sharingLinkKind===i.sharingLinkKind,linkBlocksDownload:!!v});e._store.getEngagementHelper().shareCompleted(g);var y=S.getVroomScopeFromSharingLinkKind(i.sharingLinkKind);C.shareCompleted(e.state.shareType,y);if(h===s.ShareType.outlook||h===s.ShareType.nonOutlook)if(m.showOWAShareTarget(e.props.clientId)){e._store.navigateToOwa(e._getRecipientEmails(e.state.linkRecipients),e._modifiedSharingLinkUrl);C.outlookClicked();e._dismiss()}else try{window.external.SendViaOutlookWithContext(e._getRecipientEmails(e.state.linkRecipients),e.state.linkRecipients.length,e.state.messageText,e._modifiedSharingLinkUrl)}catch(e){}else if(h===s.ShareType.teams){e._dismiss();C.teamsClicked(i)}else if(h===s.ShareType.moreApps)try{e.setState({viewState:3,companyName:o,sharingLinkCreated:i,showActivityIndicator:!1});window.external.SendLinkViaMoreApps(i.url)}catch(e){}else e.props.mode===s.Mode.linkSettings?C.linkSettingsCompleted(i,o,e.props.customLabeledAudienceConfig,e.props.clientId):e.setState({viewState:3,sharingLinkCreated:i,companyName:o,showActivityIndicator:!1,sharingInformation:r,currentSettings:e._getSettings(r)})}else{if(e.props.copyLinkShortcut&&r&&!e.props.shareId&&!r.error&&!e._copyLinkShortcutInvoked){e._copyLinkShortcutInvoked=!0;e._onCopyLinkClicked(!0,c)}var b=n.__assign({},e.state,{sharingInformation:r,companyName:o,groupsMemberCount:u,currentSettings:c,policyTipInformation:a,isLoadingDefaultRecipients:t.isValidatingDefaultRecipients(),showActivityIndicator:!1,permissionsMap:f});if(l&&!l.isConsumed){b.linkRecipients=l.recipients;e._store.consumeDefaultRecipients()}e.setState(b)}}});t.fetchSuiteNavInformation();t.fetchSharingInformation(this.props.copyLinkShortcut||this.props.mode===s.Mode.linkSettings||this.props.mode===s.Mode.manageAccess||this.props.mode===s.Mode.notify);t.fetchPolicyTipInformation();if(this.props.useVroomCreateDefaultLink&&!this._copyLinkShortcutInvoked&&this.props.mode===s.Mode.copy&&!this.props.shareId&&m.isTeams(this.props.clientId)){this._copyLinkShortcutInvoked=!0;this._store.shareLink({settings:this.state.currentSettings,recipients:this.state.linkRecipients,copyLinkCommand:!0});this.setState({shareType:s.ShareType.copy,shareTargetClicked:!0})}};t.prototype.componentDidUpdate=function(e,t){this._resize()};t.prototype.render=function(){var e,t=T.default,o=this.props,u=o.copyLinkShortcut,a=o.clientId,f=o.showExistingAccessOption,l=o.mode,p=this.state,d=p.sharingInformation,v=p.currentSettings,y=p.showActivityIndicator,b=p.companyName,S=p.sharingLinkCreated,x=p.viewState,N=p.groupsMemberCount,k=p.linkRecipients,L={maxHeight:m.isMobile(this.props.clientId)?"none":this.props.maxHeight||"none"};if(d&&d.error){C.pageError(this._shareClickTime,this.props.clientId,this.props.mode,this.props.scenarioId,d);e=h.createElement("div",{className:"od-Share"},h.createElement(i.Header,{viewState:7}),h.createElement(A.Error,{sharingInformation:d,showReportProblem:this._store.isReportProblemSupported()}))}else if(d&&v&&!u&&l===s.Mode.share){var O=y?" od-Share--hasActivity":"";e=h.createElement("div",{className:"od-Share"+O,style:L},this._renderBackButton(),this._renderViews(),this._renderActivityIndicator())}else if(d&&v&&u&&S)e=h.createElement("div",{className:"od-Share",style:L},h.createElement(r.CopyLink,{clientId:a,shareId:this.props.shareId,mode:this.props.mode,scenarioId:this.props.scenarioId,companyName:b,currentSettings:v,item:d.item,onLinkPermissionsApplyClicked:this._copyLinkOnApplyClicked,onLinkPermissionsCancelClicked:this._copyLinkOnCancelClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,onShareHintClicked:this._getNotificationHintClickHandler(S.createdViaCopyLinkCommand),sharingInformation:d,showExistingAccessOption:f,viewState:x,groupsMemberCount:N,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,displayUrl:this._modifiedSharingLinkUrl,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience}));else if(d&&v&&l===s.Mode.atMention)e=h.createElement("div",null,h.createElement(w.AtMention,{clientId:a,scenarioId:this.props.scenarioId,currentSettings:v,sharingInformation:d,recipients:k}));else if(v&&l===s.Mode.linkSettings){O=y?" od-Share--hasActivity":"";e=h.createElement("div",{className:"od-Share"+O,style:L},this._renderModifyPermissions(8),this._renderActivityIndicator())}else if(v&&l===s.Mode.manageAccess)e=h.createElement("div",{className:"od-Share",style:L},this._renderPermissionsList());else if(l===s.Mode.share){e=h.createElement("div",{className:"od-Share od-Share--hasShimmer",style:L},this._renderShareMainShimmer());this._viewStates.push(1)}else if(d&&l===s.Mode.notify){v.sharingLinkKind=1;v.audience=s.SharingAudience.existing;this._engagementExtraData=n.__assign({},this._engagementExtraData,{appMap:d.item.appmap});e=h.createElement(E.Notify,{clientId:a,scenarioId:this.props.scenarioId,currentSettings:v,sharingInformation:d,engagementExtraData:this._engagementExtraData,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig})}else e=d&&l===s.Mode.addPeople?h.createElement("div",{className:"od-Share",style:L},this._renderAddPeople()):h.createElement("div",{className:"od-Share"},h.createElement("div",{className:"od-Share-spinnerHolder"},h.createElement(c.Spinner,{className:"od-Share-spinner",label:t.componentLoading,size:c.SpinnerSize.large})));var M=m.isTeams(this.props.clientId)?" teams":"";return h.createElement(g.Fabric,null,h.createElement("div",{role:"presentation",className:M},e))};t.prototype._getSettings=function(e){var t=this,n=this.state.currentSettings,r=e&&e.error,i=e.sharingLinks&&e.sharingLinks.length&&this.props.shareId;if(!n&&!r){var s=e.defaultSharingLink;if(i){var o=e.sharingLinks.filter(function(e){return e.shareId===t.props.shareId&&e.isActive})[0];o&&(s=o)}n=this._initializeCurrentSettings(s,e,this.props.copyLinkShortcut)}return n};t.prototype._getRecipientEmails=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n].email;i&&t.push(i)}return t};t.prototype._getNumberOfDaysUntilExpiry=function(e){var t=e.expiration&&new Date(e.expiration),n=new Date;if(t){var r=(t.getTime()-n.getTime())/864e5;return Math.floor(r)}};t.prototype._handleEscKeyPress=function(e){var t=this.state.viewState,n=2===t,r=4===t,i=this.props.mode===s.Mode.share;i&&n?this._onLinkPermissionsCancelClicked():i&&r?this._onBackButtonClicked():this._dismiss();e.stopPropagation()};t.prototype._initializeCurrentSettings=function(e,t,n){if(t.requiresAccessApproval&&n)return{allowEditing:!0,audience:s.SharingAudience.existing,expiration:null,isEdit:!0,sharingLinkKind:1,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:""};if(t.defaultSharingLink===e&&t.sharingAbilities)return this._initializeCurrentSettingsWithSharingAbilities(e,t,n);if(e.audience===s.SharingAudience.specificPeople)if(!t.canManagePermissions||t.blockPeoplePickerAndSharing)e.audience=s.SharingAudience.existing;else if(this._isPeopleSharingLinksEnabled)return{allowEditing:!0,audience:s.SharingAudience.specificPeopleFlex,expiration:null,isEdit:!0,sharingLinkKind:6,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:""};if(e.audience===s.SharingAudience.specificPeopleFlex&&n){e.audience=s.SharingAudience.existing;e.sharingLinkKind=1}var r=e.sharingLinkKind,i=5===r||3===r||1===r||6===r,o=[];this.props.shareId&&e.principals&&(o=M.getLinkParticipants(e));return{allowEditing:i,audience:this.props.preferCustomLabeledAudience&&e.audience===s.SharingAudience.specificPeopleFlex?s.SharingAudience.customLabeledSpecificPeople:e.audience,expiration:e.expiration||null,isEdit:e.isEdit&&2===t.defaultShareLinkPermission,sharingLinkKind:e.sharingLinkKind,specificPeople:o,updatePassword:!1,password:"",preventDownload:e.blockDownload,shareId:""}};t.prototype._initializeCurrentSettingsWithSharingAbilities=function(e,t,n){var r=t.sharingAbilities,i="00000000-0000-0000-0000-000000000000"===this.props.shareId,o=i?1:t.defaultSharingLink.sharingLinkKind,u=this._store.isValidatingDefaultRecipients()||this.state.linkRecipients.length>0,a=M.isCustomLabeledSpecificPeopleSupported(this.props.clientId,this.props.mode,this.props.customLabeledAudienceConfig,u)?s.SharingAudience.customLabeledSpecificPeople:s.SharingAudience.specificPeople;if(t.defaultShareLinkToExistingAccess){a=s.SharingAudience.existing;o=1}else switch(o){case 5:case 4:a=s.SharingAudience.anyone;break;case 3:case 2:a=s.SharingAudience.organization;break;case 1:default:if(i||!t.canManagePermissions||t.blockPeoplePickerAndSharing)a=s.SharingAudience.existing;else if(this._isPeopleSharingLinksEnabled){a!==s.SharingAudience.customLabeledSpecificPeople&&(a=s.SharingAudience.specificPeopleFlex);D.Killswitch.isActivated("78387c02-96db-42f2-87ff-2b40f18d8f00","05/08/2019","Update defaultLinkKind from direct to flexible based on audience")||(o=6)}else a=s.SharingAudience.existing}if(a===s.SharingAudience.specificPeopleFlex&&n){a=s.SharingAudience.existing;o=1}var f=null,l=N.getSharingAbilitiesByAudience(a,r).linkExpiration;(l?l.defaultExpirationInDays:null)>0&&(f=new Date((new Date).toDateString())).setDate(f.getDate()+l.defaultExpirationInDays);var c=N.isEditingAllowed(a,r);return{allowEditing:c,audience:a,expiration:f,isEdit:c&&2===t.defaultShareLinkPermission,sharingLinkKind:o,specificPeople:[],updatePassword:!1,password:"",shareId:""}};t.prototype._loadTheme=function(e){try{var t=e;O.loadTheme(t)}catch(e){}};t.prototype._onCopyLinkClicked=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r,i=this;return n.__generator(this,function(o){switch(o.label){case 0:r=n.__assign({sendInvitation:!1},t,this.state.currentSettings);return[4,this._store.shouldInterruptCopyLink(r.isEdit)];case 1:if(o.sent()){this._store.getEngagementHelper().copyLinkInterruptOpened(this._engagementExtraData);this.setState({showCopyLinkInterrupt:!0})}else this.setState({shareType:s.ShareType.copy,shareTargetClicked:!0},function(){i._store.shareLink({settings:r,recipients:i.state.linkRecipients,copyLinkCommand:e})});return[2]}})})};t.prototype._onOutlookClicked=function(){var e=this;this.setState({shareType:s.ShareType.outlook,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1})})};t.prototype._onNonOutlookClicked=function(){var e=this;this.setState({shareType:s.ShareType.nonOutlook,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1})})};t.prototype._onTeamsClicked=function(){var e=this;this.setState({shareType:s.ShareType.teams,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1})})};t.prototype._onMoreAppsClicked=function(){var e=this;this.setState({shareType:s.ShareType.moreApps,shareTargetClicked:!0},function(){e._store.shareLink({settings:e.state.currentSettings,recipients:e.state.linkRecipients,copyLinkCommand:!1})})};t.prototype._onSelectedPermissionsChange=function(e){var t=this.state.permissionsMap;e.audience===s.SharingAudience.existing?this._store.checkPermissions(this.state.linkRecipients):t={};this.setState({viewState:0,currentSettings:{allowEditing:e.allowEditing,audience:e.audience,expiration:e.expiration,isEdit:e.isEdit,isReview:e.isReview,sharingRole:e.sharingRole,sharingLinkKind:e.sharingLinkKind,specificPeople:e.specificPeople,updatePassword:e.updatePassword,password:e.password,hasPassword:e.hasPassword,preventDownload:e.preventDownload,shareId:e.shareId,requireSignIn:e.audience===s.SharingAudience.specificPeople},permissionsMap:t})};t.prototype._renderBackButton=function(){if(6===this.state.viewState)return h.createElement(b.IconButton,{className:"od-Share-backButton",onClick:this._onBackButtonClicked,iconProps:{iconName:"Back"}},h.createElement("label",{className:"od-Share-screenReaderOnly"},T.default.backButtonLabel),h.createElement("br",null))};t.prototype._renderViews=function(){switch(this.state.viewState){case 2:return this._renderModifyPermissions(2);case 8:return this._renderModifyPermissions(8);case 3:return this._renderNotification();case 4:return this._renderPermissionsList();case 6:return this._renderPolicyDetails();default:return this._renderShareMain(this.state.sharingInformation,this.state.currentSettings)}};t.prototype._renderShareMain=function(e,t){this._viewStates.push(0);return h.createElement("div",null,h.createElement(a.ShareMain,{key:"share",ref:this._shareMainControl,clientId:this.props.clientId,scenarioId:this.props.scenarioId,companyName:this.state.companyName,currentSettings:t,item:e.item,onPolicyClick:this._showPolicy,onSelectedPeopleChange:this._onSelectedPeopleChange,onSendLinkClicked:this._onSendLinkClicked,onShareHintClicked:this._showModifyPermissions,onShowPermissionsListClicked:this._showPermissionsList,sharingInformation:e,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,linkRecipients:this.state.linkRecipients,permissionsMap:this.state.permissionsMap,messageText:this.state.messageText,subjectText:this.state.subjectText,onSendLinkMessageChange:this._onSendLinkMessageChange,onSendLinkSubjectChange:this._onSendLinkSubjectChange,onShareTargetClicked:this._onShareTargetClicked,onShareTargetsRendered:this._onShareTargetsRendered,hideShareDialogOverflowButton:this.props.hideShareDialogOverflowButton,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,outlookAvailability:this._outlookAvailability,engagementExtraData:this._engagementExtraData,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,closeButtonOnFocus:this._closeButtonOnFocus,closeButtonOnBlur:this._closeButtonOnBlur,onEditChange:this.onEditChange}),this.state.showCopyLinkInterrupt&&this._renderCopyLinkInterrupt({updatePassword:!!t.password}))};t.prototype._renderPolicyDetails=function(){return h.createElement(l.SharePolicyDetails,{clientId:this.props.clientId,sharingInformation:this.state.sharingInformation,policyTipInformation:this.state.policyTipInformation})};t.prototype._renderCopyLinkInterrupt=function(e){var t=e.updatePassword;return h.createElement(_.ConfirmationDialog,{confirmationCode:t?_.ConfirmationCode.copyInterruptUpdate:_.ConfirmationCode.copyInterruptRemove,participant:null,onApply:t?this._onInterruptUseNew:this._onInterruptUseExisting,onCancel:this._onInterruptCancel,onDiscard:t?this._onInterruptUseExisting:this._onInterruptUseNew})};t.prototype._renderModifyPermissions=function(e){this._viewStates.push(e);return h.createElement(o.ModifyPermissions,{clientId:this.props.clientId,shareId:this.props.shareId,mode:this.props.mode,companyName:this.state.companyName,currentSettings:this.state.currentSettings,doesCreate:!0,onCancel:this._onLinkPermissionsCancelClicked,onReady:this._onLinkPermissionsReady,onSelectedPermissionsChange:this._onLinkPermissionsApplyClicked,onSelectedPeopleChange:this._onSelectedPeopleChange,sharingInformation:this.state.sharingInformation,showExistingAccessOption:!0,groupsMemberCount:this.state.groupsMemberCount,onViewPolicyTipClicked:this._onViewPolicyTipClicked,createPeopleSharingLinks:this._isPeopleSharingLinksEnabled,copyLinkShortcut:!1,engagementExtraData:this._engagementExtraData,recipients:this.state.linkRecipients,isLoadingDefaultRecipients:this.state.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience})};t.prototype._renderNotification=function(){var e=this.state,t=e.sharingInformation,n=e.sharingLinkCreated,r={companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:t,clientId:this.props.clientId,onShareHintClick:this._getNotificationHintClickHandler(n.createdViaCopyLinkCommand),linkRecipients:e.shareType===s.ShareType.share?this.state.linkRecipients:null,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig};return h.createElement(f.ShareNotification,{shareType:e.shareType,itemName:t.item.name,linkUrl:this._modifiedSharingLinkUrl,clientId:this.props.clientId,sharingHintProps:r,shouldCopyLinkToClipboard:!0,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig})};t.prototype._getNotificationHintClickHandler=function(e){return e?this._showModifyPermissions.bind(this,e):null};t.prototype._renderShareMainShimmer=function(){var e={allowEditing:!1,audience:s.SharingAudience.existing,expiration:void 0,isEdit:!1,sharingLinkKind:0,specificPeople:[],updatePassword:!1,password:"",preventDownload:!1,shareId:""},t={anonymousLinkExpirationRestrictionDays:0,blockPeoplePickerAndSharing:!0,canAddExternalPrincipal:!1,canAddInternalPrincipal:!1,canManagePermissions:!1,defaultSharingLink:void 0,defaultShareLinkToExistingAccess:!1,hasInheritedLinks:!1,isShared:!1,item:this.props.sharingItemInformation?this.props.sharingItemInformation:{name:"",childCount:0,hasDlpPolicy:!1},sharingLinks:[],sharingPrincipals:[],peoplePickerSettings:{},userDisplayName:"",defaultShareLinkPermission:1,defaultLinkKind:0,userRole:0,hasPermissionsInformation:!1,sharingAbilities:null,directLink:null,sharingLinkTemplates:null,webTemplateId:void 0,itemUniqueId:void 0};return this._renderShareMain(t,e)};t.prototype._renderPermissionsList=function(){this.state.sharingInformation&&this.state.sharingInformation.hasPermissionsInformation||this._store.fetchSharingInformation(!0);return h.createElement(u.PermissionsList,{clientId:this.props.clientId,scenarioId:this.props.scenarioId,mode:this.props.mode,companyName:this.state.companyName,sharingInformation:this.state.sharingInformation,linkRecipients:this.state.linkRecipients,groupsMemberCount:this.state.groupsMemberCount,viewState:this.state.viewState,backButtonClicked:this._onBackButtonClicked,hideElementsInManageAccess:this._hideElementsInManageAccess,shareCommandsExperiment:!!this.props.shareCommandsExperiment})};t.prototype._renderAddPeople=function(){return h.createElement(L.AddPeople,{sharingInformation:this.state.sharingInformation,currentSettings:this.state.currentSettings,clientId:this.props.clientId,onViewPolicyTipClicked:this._onViewPolicyTipClicked})};t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return h.createElement(y.ActivityIndicator,{message:T.default.applyingLinkSettings})};t.prototype._trackClickThru=function(e,t,n){var r=this.state.shareType,i=e.url;if(r!==s.ShareType.copy&&r!==s.ShareType.outlook)return i;var o=this._getBase62Id();this._logClickThru(o,e,t,n);var u=new x.default(i);u.setQueryParameter("e",o);var a=this._store.getNavId();a&&u.setQueryParameter("nav",a);return u.toString()};t.prototype._logClickThru=function(e,t,r,i){var o=this.state,u=n.__assign({},this._engagementExtraData,{shareType:o.shareType,audience:t.audience,isEdit:r.isEdit,recipientsCount:this.state.recipientsCount,externalRecipientsCount:this.state.externalRecipientsCount,linkedinRecipientsCount:this.state.linkedinRecipientsCount,hasMessage:this.state.hasMessage,hasSubject:this.state.hasSubject,messageLength:this.state.messageLength,daysUntilExpiry:this._getNumberOfDaysUntilExpiry(t),isDefaultLink:i.defaultSharingLink.sharingLinkKind===t.sharingLinkKind,clickThruId:e,clickThruScenario:s.ShareType[o.shareType]});this._store.getEngagementHelper().trackClickThru(u)};t.prototype._getBase62Id=function(){var e=new Uint8Array(6);(window.crypto||window.msCrypto).getRandomValues(e);for(var t=[],n=0;n<e.length;n++)t.push("abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"[e[n]%62]);return t.join("")};t.contextTypes={resize:d.func.isRequired,onDismiss:d.func.isRequired,sharingStore:d.object.isRequired,breakpoint:d.object.isRequired,shareClickTime:d.number};return t}(h.Component);t.Share=P});
define("@ms/odsp-shared-sharing/lib/components/CopyLink/CopyLink",["require","exports","tslib","../../interfaces/SharingInterfaces","../ModifyPermissions/ModifyPermissions","../ShareNotification/ShareNotification","../Share.resx","office-ui-fabric-react/lib/Spinner","react","../../utilities/ShareCommunicationManager","prop-types"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._initialLinkShown=!1;r._onLinkSettingsCancelClick=function(){r.setState({shouldCopyLinkToClipboard:!1},function(){r.props.onLinkPermissionsCancelClicked()})};r._onLinkSettingsApplyClicked=function(e){r.setState({shouldCopyLinkToClipboard:!0},function(){r.props.onLinkPermissionsApplyClicked(e)})};r._shareClickTime=n.shareClickTime;r.state={shouldCopyLinkToClipboard:!0};return r}t.prototype.render=function(){var e=this.props,t=e.sharingInformation;switch(this.props.viewState){case 3:var n={clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:t,onShareHintClick:e.onShareHintClicked,linkRecipients:null,customLabeledAudienceConfig:e.customLabeledAudienceConfig};if(!this._initialLinkShown){f.pageFinishedLoading(this._shareClickTime,this.props.clientId,r.Mode.copy,this.props.scenarioId);this._initialLinkShown=!0}return a.createElement(s.ShareNotification,{shareType:r.ShareType.copy,itemName:t.item.name,linkUrl:e.displayUrl,clientId:e.clientId,sharingHintProps:n,shouldCopyLinkToClipboard:this.state.shouldCopyLinkToClipboard,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig});case 2:return a.createElement(i.ModifyPermissions,{clientId:e.clientId,shareId:e.shareId,mode:e.mode,companyName:e.companyName,currentSettings:e.currentSettings,doesCreate:!0,onCancel:this._onLinkSettingsCancelClick,onSelectedPermissionsChange:this._onLinkSettingsApplyClicked,sharingInformation:e.sharingInformation,showExistingAccessOption:!0,groupsMemberCount:e.groupsMemberCount,onViewPolicyTipClicked:e.onViewPolicyTipClicked,createPeopleSharingLinks:e.createPeopleSharingLinks,copyLinkShortcut:!0,engagementExtraData:this.props.engagementExtraData,recipients:this.props.recipients,isLoadingDefaultRecipients:this.props.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,onSelectedPeopleChange:function(){}});default:return a.createElement("div",{className:"od-Share-spinnerHolder"},a.createElement(u.Spinner,{className:"od-Share-spinner",label:o.default.componentLoading,type:u.SpinnerType.large}))}};t.contextTypes={shareClickTime:l.number};return t}(a.Component);t.CopyLink=c});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/ModifyPermissions",["require","exports","tslib","../../interfaces/SharingInterfaces","../ActivityIndicator/ActivityIndicator","../PermissionsList/ShareLink/ConfirmationDialog/ConfirmationDialog","../Header/Header","./PermissionsSettings/PermissionsSettings","office-ui-fabric-react/lib/Button","../../utilities/ShareHelper","@ms/odsp-utilities/lib/dateTime/DateTime","../Share.resx","../../utilities/PeoplePickerHelper","../../utilities/ClientIdHelper","react","prop-types","../../utilities/SharingAbilitiesHelper","../../utilities/ShareHelper","./ModifyPermissions.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._currentPassword="";r._shouldUsePassword=!1;r._matchingTemplate=null;r._currentPassword="";r._shouldUsePassword=!1;r.state=r._initializeState();r._preventDownloadToggle=!!r.state.selectedPermissions.preventDownload;r._initializeState=r._initializeState.bind(r);r._onApplyClicked=r._onApplyClicked.bind(r);r._onCancel=r._onCancel.bind(r);r._onPeoplePickerChange=r._onPeoplePickerChange.bind(r);r._updateExpirationErrorCode=r._updateExpirationErrorCode.bind(r);r.onAudienceChange=r.onAudienceChange.bind(r);r.onEditChange=r.onEditChange.bind(r);r.onRoleChange=r.onRoleChange.bind(r);r.onExpirationChange=r.onExpirationChange.bind(r);r._getShareLinkTemplate=r._getShareLinkTemplate.bind(r);r._findMatchingShareLinkTemplate=r._findMatchingShareLinkTemplate.bind(r);r._calculateRole=r._calculateRole.bind(r);r._onPasswordChange=r._onPasswordChange.bind(r);r._resetPasswordVariables=r._resetPasswordVariables.bind(r);r._onToggleChange=r._onToggleChange.bind(r);r._onConfirmationUseExisting=r._onConfirmationUseExisting.bind(r);r._onConfirmationUseNew=r._onConfirmationUseNew.bind(r);return r}t.prototype.componentDidMount=function(){this.props.onReady&&this.props.onReady()};t.prototype.render=function(){var e=this.state.showActivityIndicator?" blocker":"",t=p.invertPermissionsButtonsOrder(this.props.clientId),n="od-ModifyPermissions-section";this.context.sharingStore&&this.context.sharingStore.getSupportedAudienceOptions().length<=1&&(n+=" od-ModifyPermissions-section-noAudienceMod");return d.createElement("div",{className:"od-ModifyPermissions"+e},d.createElement(o.Header,{clientId:this.props.clientId,item:this.props.sharingInformation.item,viewState:2,mode:this.props.mode}),d.createElement("div",{className:n},d.createElement(u.PermissionsSettings,{mode:this.props.mode,shareId:this.props.shareId,companyName:g.truncateOrganizationName(this.props.companyName),clientId:this.props.clientId,currentSettings:this.props.currentSettings,onAudienceChange:this.onAudienceChange,onEditChange:this.onEditChange,onRoleChange:this.onRoleChange,onExpirationChange:this.onExpirationChange,onPeoplePickerChange:this._onPeoplePickerChange,peoplePickerError:this.state.peoplePickerError,selectedPermissions:this.state.selectedPermissions,sharingInformation:this.props.sharingInformation,showExistingAccessOption:this.props.showExistingAccessOption,updateExpirationErrorCode:this._updateExpirationErrorCode,groupsMemberCount:this.props.groupsMemberCount,createPeopleSharingLinks:this.props.createPeopleSharingLinks,copyLinkShortcut:this.props.copyLinkShortcut,onPasswordChange:this._onPasswordChange,onToggleChange:this._onToggleChange,engagementExtraData:this.props.engagementExtraData,recipients:this.props.recipients,isLoadingDefaultRecipients:this.props.isLoadingDefaultRecipients,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig,omitCustomLabeledAudience:this.props.omitCustomLabeledAudience,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience})),t?d.createElement("div",{className:"od-ModifyPermissions-actions"},this._renderDefaultButton(),this._renderPrimaryButton()):d.createElement("div",{className:"od-ModifyPermissions-actions"},this._renderPrimaryButton(),this._renderDefaultButton()),this._renderActivityIndicator(),this.state.showConfirmationDialog&&this._renderConfirmationDialog())};t.prototype.onAudienceChange=function(e){var t=this.state.selectedPermissions,i=t.isEdit,s=this._isAllowEditingEnabled(e),o=s&&i,u=f.getLinkKind(e,o),a={allowEditing:s,audience:e,expiration:e===r.SharingAudience.anyone||e===r.SharingAudience.specificPeople&&this.context.sharingStore.isSpecificPeopleExpirationAllowed()?t.expiration:f.getDefaultExpirationDateValue(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays),isEdit:o,sharingLinkKind:u,specificPeople:[],updatePassword:!1,hasPassword:!1,password:"",shareId:""};this.setState(n.__assign({},this.state,{peoplePickerError:null,selectedPermissions:a}))};t.prototype.onEditChange=function(e){var t=this.state.selectedPermissions,r=f.getLinkKind(t.audience,e);this._resetPasswordVariables();this.setState(n.__assign({},this.state,{selectedPermissions:n.__assign({},t,{isEdit:e,sharingLinkKind:r,preventDownload:!1}),preventDownloadDisabled:e}));this._preventDownloadToggle=!1};t.prototype.onRoleChange=function(e){var t=this.state.selectedPermissions,r=6==e,i=r?6:f.getLinkKind(t.audience,2===e),s=f.getDefaultExpirationDateValue(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);this.setState(n.__assign({},this.state,{selectedPermissions:n.__assign({},t,{sharingRole:e,isEdit:2===e,isReview:r,expiration:s,sharingLinkKind:i}),preventDownloadDisabled:2===e}))};t.prototype.onExpirationChange=function(e){e||(e=f.getDefaultExpirationDateValue(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays));this.setState(n.__assign({},this.state,{selectedPermissions:n.__assign({},this.state.selectedPermissions,{expiration:e})}))};t.prototype._renderDefaultButton=function(){return d.createElement(a.DefaultButton,{onClick:this._onCancel},c.default.cancelButtonText)};t.prototype._renderPrimaryButton=function(){return d.createElement(a.PrimaryButton,{className:"od-ModifyPermissions-apply",disabled:this._computeIsApplyButtonDisabled(),onClick:this._onApplyClicked},c.default.applyButtonText)};t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return d.createElement(i.ActivityIndicator,{message:c.default.activityMessageCreatingLink})};t.prototype._initializeState=function(){var e=this.props,t=e.currentSettings,n=e.sharingInformation,r=h.renderPickerError({selectedItems:t.specificPeople,sharingLinkKind:1,canAddExternalPrincipal:n.canAddExternalPrincipal,sharingInformation:n,viewPolicyTipCallback:e.onViewPolicyTipClicked});return{expirationErrorCode:f.ExpirationErrorCode.none,peoplePickerError:r,selectedPermissions:{allowEditing:this._isAllowEditingEnabled(t.audience),audience:t.audience,isEdit:t.isEdit,sharingRole:t.sharingRole,expiration:t.expiration||f.getDefaultExpirationDateValue(this.props.sharingInformation.anonymousLinkExpirationRestrictionDays),sharingLinkKind:t.sharingLinkKind,specificPeople:t.specificPeople,updatePassword:t.updatePassword,password:t.password,hasPassword:t.hasPassword,preventDownload:t.preventDownload,shareId:t.shareId},showActivityIndicator:!1,preventDownloadDisabled:this._isAllowEditingEnabled(t.audience),showConfirmationDialog:!1}};t.prototype._computeIsApplyButtonDisabled=function(){return this.state.expirationErrorCode!==f.ExpirationErrorCode.none||!!this.state.peoplePickerError};t.prototype._updateExpirationErrorCode=function(e){e!==this.state.expirationErrorCode&&this.setState(n.__assign({},this.state,{expirationErrorCode:e}))};t.prototype._onCancel=function(){this.props.onCancel()};t.prototype._onApplyClicked=function(){var e=this,t=this.state,i=t.selectedPermissions,s=document.querySelector(".od-Share-PeoplePicker .ms-BasePicker-input");if(s&&s.value)this.setState(n.__assign({},this.state,{peoplePickerError:d.createElement("span",null,c.default.unresolvedTextError)}));else if(i.audience!==r.SharingAudience.specificPeopleFlex||0!==i.specificPeople.length||!this.props.copyLinkShortcut&&this.props.mode!==r.Mode.linkSettings){var o=this.props.doesCreate,u=i.audience===r.SharingAudience.anyone||i.audience===r.SharingAudience.specificPeople&&this.context.sharingStore.isSpecificPeopleExpirationAllowed()?i.expiration:null,a=this._shouldRenderPopUp(u),f=!!this._matchingTemplate&&this._matchingTemplate.passwordProtected;a?this.setState(n.__assign({},t,{selectedPermissions:n.__assign({},i,{expiration:u,updatePassword:this._shouldUsePassword,password:this._currentPassword,preventDownload:this._preventDownloadToggle,shareId:this._templateShareId,hasPassword:f}),showActivityIndicator:o,showConfirmationDialog:!0})):this.setState(n.__assign({},t,{selectedPermissions:n.__assign({},i,{expiration:u,updatePassword:this._shouldUsePassword,password:this._currentPassword,preventDownload:this._preventDownloadToggle}),showActivityIndicator:o,showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)})}else this.setState(n.__assign({},this.state,{peoplePickerError:d.createElement("span",null,c.default.recipientsRequiredError)}))};t.prototype._shouldRenderPopUp=function(e){if(this.state.selectedPermissions.audience!==r.SharingAudience.anyone)return!1;var t=this._shouldUsePassword,n=this._getShareLinkTemplate(t,!0);if(!n||!n.linkDetails)return!1;if(t&&n.passwordProtected)return!0;var i=n.linkDetails.expiration;return null!==e&&null!==i&&(e.getMonth()!==i.getMonth()||e.getDate()!==i.getDate())};t.prototype._onPeoplePickerChange=function(e){var t=h.renderPickerError({selectedItems:e,sharingLinkKind:1,canAddExternalPrincipal:this.props.sharingInformation.canAddExternalPrincipal,sharingInformation:this.props.sharingInformation,viewPolicyTipCallback:this.props.onViewPolicyTipClicked});if(!this.props.createPeopleSharingLinks&&this.state.selectedPermissions.audience===r.SharingAudience.specificPeople){for(var i=!1,s=!1,o=0,u=e;o<u.length;o++){var a=u[o];i||(i=a.isExternal&&!a.providerName);s||(s=!a.isExternal||a.isExternal&&!!a.providerName)}i&&s&&(t=d.createElement("span",null,c.default.mixedRecipientErrorMessage))}this.props.onSelectedPeopleChange&&this.props.onSelectedPeopleChange(e);this.setState(n.__assign({},this.state,{peoplePickerError:t,selectedPermissions:n.__assign({},this.state.selectedPermissions,{specificPeople:e})}))};t.prototype._getShareLinkTemplate=function(e,t){var n=this._findMatchingShareLinkTemplate(e);if(t&&n){this._matchingTemplate=n;n.passwordProtected&&n.linkDetails?this._templateShareId=n.linkDetails.shareId:this._templateShareId=""}return n};t.prototype._findMatchingShareLinkTemplate=function(e){var t,n,r=this.props.sharingInformation.sharingLinkTemplates;if(!r||0===r.length)return null;var i,s=this._calculateRole();i=!!e||this._currentPassword.length>0;for(var o=0,u=r;o<u.length;o++){var a=u[o];if(a.role===s&&0===a.scope){if(i&&a.passwordProtected)return a;a.passwordProtected?t=a:n=a}}return null===t||null===t.linkDetails||this._deletedPassword||!e?n:t};t.prototype._calculateRole=function(){return this.state.selectedPermissions.preventDownload?7:this.state.selectedPermissions.isEdit?2:1};t.prototype._onPasswordChange=function(e){this._currentPassword=e;this._shouldUsePassword=e.length>0;this._deletedPassword=0===e.length;this.setState(n.__assign({},this.state))};t.prototype._resetPasswordVariables=function(){this._currentPassword="";this._shouldUsePassword=!1;this._deletedPassword=!1;this._templateShareId=""};t.prototype._onToggleChange=function(e){this._preventDownloadToggle=e;this._resetPasswordVariables();this.setState(n.__assign({},this.state,{selectedPermissions:n.__assign({},this.state.selectedPermissions,{preventDownload:e})}))};t.prototype._isAllowEditingEnabled=function(e){var t=this.props.sharingInformation.sharingAbilities;return m.isEditingAllowed(e,t)};t.prototype._getShareDialogConfirmationCode=function(e,t){var n=this.state.selectedPermissions.expiration,r=t.linkDetails.expiration,i=e&&t.passwordProtected,o=null!==n&&null!==r&&(n.getMonth()!==r.getMonth()||n.getDate()!==r.getDate());return i&&o?s.ConfirmationCode.shareDialogPasswordAndExpiration:i?s.ConfirmationCode.shareDialogPasswordOnly:s.ConfirmationCode.shareDialogExpirationOnly};t.prototype._renderConfirmationDialog=function(){var e=this._shouldUsePassword,t=this._matchingTemplate,n=this._getShareDialogConfirmationCode(e,t),r=t&&t.linkDetails&&null!==t.linkDetails.passwordLastModifiedBy?t.linkDetails.passwordLastModifiedBy.primaryText:"",i=t&&t.linkDetails&&null!==t.linkDetails.expiration?l.getShortDisplayDate(t.linkDetails.expiration):"";return d.createElement(s.ConfirmationDialog,{confirmationCode:n,participant:null,onApply:this._onConfirmationUseNew,onCancel:this._onConfirmationUseExisting,linkPasswordSetBy:r,linkExpiration:i})};t.prototype._onConfirmationUseNew=function(){var e=this;this.setState(n.__assign({},this.state,{showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)})};t.prototype._onConfirmationUseExisting=function(){var e=this,t=this.state.selectedPermissions,r=this._matchingTemplate&&this._matchingTemplate.linkDetails?this._matchingTemplate.linkDetails.expiration:null,i=!(!this._matchingTemplate||!this._matchingTemplate.linkDetails)&&this._matchingTemplate.passwordProtected;this.setState(n.__assign({},this.state,{selectedPermissions:n.__assign({},t,{expiration:r,updatePassword:!1,password:"",hasPassword:i}),showConfirmationDialog:!1}),function(){e.props.onSelectedPermissionsChange(e.state.selectedPermissions)})};t.contextTypes={sharingStore:v.object.isRequired};return t}(d.Component);t.ModifyPermissions=y});
define("@ms/odsp-shared-sharing/lib/components/ActivityIndicator/ActivityIndicator",["require","exports","tslib","react","office-ui-fabric-react/lib/Spinner","./ActivityIndicator.scss"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement("div",{className:"od-ActivityIndicator","aria-live":"assertive"},r.createElement("div",null,r.createElement(i.Spinner,{type:i.SpinnerType.large})),r.createElement("span",{role:"alert"},this.props.message))};return t}(r.Component);t.ActivityIndicator=s});
define("@ms/odsp-shared-sharing/lib/components/ActivityIndicator/ActivityIndicator.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ActivityIndicator{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);z-index:2;text-align:center}.od-ActivityIndicator .ms-Spinner{display:inline-block;width:28px}.od-ActivityIndicator span{font-size:14px;font-weight:400}"}])});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLink/ConfirmationDialog/ConfirmationDialog",["require","exports","tslib","react","office-ui-fabric-react/lib/Dialog","office-ui-fabric-react/lib/Button","@ms/odsp-utilities/lib/string/StringHelper","../../../Share.resx","./ConfirmationDialog.scss"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a;!function(e){e[e.none=0]="none";e[e.link=1]="link";e[e.participant=2]="participant";e[e.linkSettings=3]="linkSettings";e[e.back=4]="back";e[e.shareDialogPasswordOnly=5]="shareDialogPasswordOnly";e[e.shareDialogExpirationOnly=6]="shareDialogExpirationOnly";e[e.shareDialogPasswordAndExpiration=7]="shareDialogPasswordAndExpiration";e[e.copyInterruptUpdate=8]="copyInterruptUpdate";e[e.copyInterruptRemove=9]="copyInterruptRemove"}(a=t.ConfirmationCode||(t.ConfirmationCode={}));var f=function(e){n.__extends(t,e);function t(t,n){return e.call(this,t)||this}t.prototype.render=function(){var e,t,n,f=this.props,l=f.confirmationCode,c=f.participant,h="od-confirmationDialog";switch(l){case a.link:e=u.default.deleteLinkDialogTitle;t=u.default.deleteLinkButtonText;n=u.default.cancelButtonText;break;case a.linkSettings:e=u.default.changeLinkSettingsDialogTitle;t=u.default.changeItButtonText;n=u.default.cancelButtonText;break;case a.participant:e=o.format(u.default.deleteLinkParticipantDialogTitle,c.name);t=u.default.removeButtonText;n=u.default.cancelButtonText;break;case a.back:e=u.default.leaveLinkSettingsDialogTitle;t=u.default.saveButtonText;n=u.default.cancelButtonText;break;case a.shareDialogPasswordOnly:e=u.default.updateLinkDialogTitle;t=u.default.useNewPasswordText;n=u.default.useExistingPasswordText;h+=" shareDialog";break;case a.shareDialogExpirationOnly:e=u.default.updateLinkDialogTitle;t=u.default.useNewExpirationText;n=u.default.useExistingExpirationText;h+=" shareDialog";break;case a.shareDialogPasswordAndExpiration:e=u.default.updateLinkDialogTitle;t=u.default.useNewSettingsText;n=u.default.useExistingSettingsText;h+=" shareDialog";break;case a.copyInterruptUpdate:e=u.default.copyInterruptUpdateTitle;t=u.default.copyInterruptContinue;n=u.default.copyInterruptOldPassword;h+=" shareDialog";break;case a.copyInterruptRemove:e=u.default.copyInterruptRemoveTitle;t=u.default.copyInterruptContinue;n=u.default.copyInterruptRemovePassword;h+=" shareDialog"}return r.createElement("div",null,r.createElement(i.Dialog,{hidden:!1,className:h,onDismiss:this.props.onCancel,dialogContentProps:{type:i.DialogType.close,title:e},modalProps:{isDarkOverlay:!0,isBlocking:!0}},this._getDialogSubText(),l===a.back?r.createElement(i.DialogFooter,{className:"od-confirmationDialog-footer"},r.createElement(s.DefaultButton,{className:"od-confirmationDialog-discard",onClick:this.props.onDiscard?this.props.onDiscard:this.props.onCancel,text:u.default.discardButtonText}),r.createElement("div",{className:"od-confirmationDialog-saveCancel"},r.createElement(s.PrimaryButton,{onClick:this.props.onApply,text:t}),r.createElement(s.DefaultButton,{onClick:this.props.onCancel,text:n}))):l===a.copyInterruptUpdate||l===a.copyInterruptRemove?r.createElement(i.DialogFooter,null,r.createElement(s.PrimaryButton,{className:"od-ConfirmationDialog-copyLinkInterruptButtons",onClick:this.props.onApply,text:t}),r.createElement(s.DefaultButton,{className:"od-ConfirmationDialog-copyLinkInterruptButtons",onClick:this.props.onDiscard||this.props.onCancel,text:n})):r.createElement(i.DialogFooter,null,r.createElement(s.PrimaryButton,{onClick:this.props.onApply,text:t}),r.createElement(s.DefaultButton,{onClick:this.props.onCancel,text:n}))))};t.prototype._getDialogSubText=function(){var e="";switch(this.props.confirmationCode){case a.link:return r.createElement("div",{className:"od-ConfirmationDialog-subText"},r.createElement("span",null,r.createElement("strong",null,u.default.deleteLinkLeadText)),r.createElement("span",null,u.default.deleteLinkEndText));case a.linkSettings:return r.createElement("div",{className:"od-ConfirmationDialog-subText"},r.createElement("span",null,u.default.applyLinkSettingsText));case a.participant:return;case a.shareDialogPasswordOnly:e=o.format(u.default.overwritePasswordText,this.props.linkPasswordSetBy);return r.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert"},r.createElement("span",null,e));case a.shareDialogExpirationOnly:e=o.format(u.default.overwriteExpirationText,this.props.linkExpiration);return r.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert"},r.createElement("span",null,e));case a.shareDialogPasswordAndExpiration:e=o.format(u.default.overwriteSettingsText,this.props.linkExpiration,this.props.linkPasswordSetBy);return r.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert"},r.createElement("span",null,e));case a.copyInterruptUpdate:e=u.default.copyInterruptUpdateContent;return r.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert"},r.createElement("span",null,e));case a.copyInterruptRemove:e=u.default.copyInterruptRemoveContent;return r.createElement("div",{className:"od-ConfirmationDialog-subText",role:"alert"},r.createElement("span",null,e))}};return t}(r.Component);t.ConfirmationDialog=f});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLink/ConfirmationDialog/ConfirmationDialog.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ConfirmationDialog-subText{font-size:12px}.od-ConfirmationDialog-subText--nowrap{white-space:nowrap}.od-confirmationDialog .ms-Dialog-main{width:95%}.od-confirmationDialog .od-confirmationDialog-footer{display:inline-block}.od-confirmationDialog .od-confirmationDialog-footer .ms-Button{min-width:70px;max-width:70px}[dir=ltr] .od-confirmationDialog-discard{float:left}[dir=rtl] .od-confirmationDialog-discard{float:right}.od-confirmationDialog-saveCancel{display:inline}.od-confirmationDialog-saveCancel .ms-Button{margin:0 4px}[dir=ltr] .od-confirmationDialog-copyLinkInterruptButtons{padding-right:8px}[dir=rtl] .od-confirmationDialog-copyLinkInterruptButtons{padding-left:8px}.od-ConfirmationDialog-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}])});
define("@ms/odsp-shared-sharing/lib/components/Header/Header",["require","exports","tslib","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/ContextualMenu","../../interfaces/SharingInterfaces","react","react","prop-types","@ms/odsp-utilities/lib/string/StringHelper","../../utilities/ClientIdHelper","../../utilities/ShareHelper","../Share.resx","@ms/odsp-utilities/lib/browser/ResponsiveUI","./Header.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._closeButton=u.createRef();r._dismissComponent=function(e){e.stopPropagation();e.preventDefault();r._onDismiss()};r.state={showContextualMenu:!1,target:null};r._onDismiss=n.onDismiss;r._platformDetection=n.platformDetection;r._breakpoint=n.breakpoint;r._store=n.sharingStore;r._onDismissMoreContextualMenu=r._onDismissMoreContextualMenu.bind(r);r._onManageExistingAccessClick=r._onManageExistingAccessClick.bind(r);r._onSendLinkClick=r._onSendLinkClick.bind(r);r._onMoreClick=r._onMoreClick.bind(r);return r}t.prototype.render=function(){var e=this.props;if(e.mode===s.Mode.linkSettings)return o.createElement("h3",{className:"od-ShareHeader-linkSettings"},this._getViewName(),o.createElement("div",{className:"od-ShareHeader-buttons-right"},this._renderCloseButton()));var t=3===e.viewState||7===e.viewState||9===e.viewState,n=l.isMobile(this.props.clientId)||this._platformDetection.isMobile,r=n&&this._breakpoint>=p.default.DEFAULT_BREAKPOINTS.Large,i=t?"":" od-ShareHeader-backgroundColor",u=t?"":o.createElement("div",{className:"od-ShareHeader"+i},o.createElement("div",{className:"od-ShareHeader-title"},o.createElement("h1",{className:"od-ShareHeader-viewName"},this._getViewName()),this._renderItemName())),a=n?o.createElement("div",{className:"od-ShareHeader-buttons-left"},this._renderCloseButton()):"";return o.createElement("div",null,a,u,this._renderRightHeaderButtons(n,r,t,e.viewState),this._renderContextualMenu())};t.prototype._renderMoreButton=function(){if(0===this.props.viewState&&!this.props.hideShareDialogOverflowButton&&!this._store.isBundleShare())return o.createElement("button",{className:"od-ShareHeader-button","aria-label":h.default.moreOptionsLabel,onClick:this._onMoreClick,"aria-haspopup":!0,"aria-expanded":this.state.showContextualMenu,title:h.default.moreOptionsLabel,role:"button"},o.createElement(r.Icon,{iconName:"More"}))};t.prototype._renderCloseButton=function(){if(this._onDismiss&&l.showCloseButton(this.props.clientId)&&4!==this.props.viewState)return o.createElement("button",{className:"od-ShareHeader-button","aria-label":h.default.closeButtonLabel,onClick:this._dismissComponent,ref:this._closeButton,onBlur:this.props.closeButtonOnBlur,title:h.default.closeButtonLabel},o.createElement(r.Icon,{iconName:"Cancel"}))};t.prototype._renderRightHeaderButtons=function(e,t,n,r){return e&&!n&&0===r?o.createElement("div",{className:"od-ShareHeader-buttons-right"},this._renderMoreButton()):e&&(n||0!==r)?"":o.createElement("div",{className:"od-ShareHeader-buttons-right"},this._renderMoreButton(),this._renderCloseButton())};t.prototype._renderItemName=function(){var e=this.props,t=e.item;if(t){var n=t.childCount>1?" ("+f.format(h.default.folderHeader,t.childCount)+")":"";return l.hideItemName(e.clientId,this._platformDetection)?void 0:o.createElement("div",{className:"od-ShareHeader-itemName"},c.truncateItemNameForHeader(t.name+" "+n))}};t.prototype._renderContextualMenu=function(){var e=[];e.push({key:"editable",name:h.default.manageExistingAccessLabel,onClick:this._onManageExistingAccessClick});if(this.state.showContextualMenu)return o.createElement(i.ContextualMenu,{ariaLabel:h.default.moreOptionsLabel,className:"od-ShareHeader-moreContextualMenu",items:e,onDismiss:this._onDismissMoreContextualMenu,target:this.state.target,isBeakVisible:!0})};t.prototype._onMoreClick=function(e){this.setState({showContextualMenu:!this.state.showContextualMenu,target:e.nativeEvent.target})};t.prototype._onDismissMoreContextualMenu=function(){this.setState(n.__assign({},this.state,{showContextualMenu:!1}))};t.prototype._onManageExistingAccessClick=function(){this.props.onManageExistingAccessClick()};t.prototype._onSendLinkClick=function(e){this.props.onSendLinkClick(this.props.messageText,this.props.subjectText)};t.prototype._getViewName=function(){var e=h.default;switch(this.props.viewState){case 0:return e.shareLinkHeader;case 2:return e.modifyPermissionsHeader;case 4:return e.manageExistingAccessLabel;case 6:return e.policyDetailsHeader;case 5:return e.grantAccessPageLabel;case 10:return e.addPeopleLabel;case 11:return e.requestAccessLabel;default:return e.shareLinkHeader}};t.prototype.focusCloseButton=function(){if(this._closeButton.current){this._closeButton.current.focus();this.props.closeButtonOnFocus&&this.props.closeButtonOnFocus()}};t.contextTypes={onDismiss:a.func,platformDetection:a.object.isRequired,breakpoint:a.object.isRequired,sharingStore:a.object.isRequired};return t}(o.Component);t.Header=d});
define("@ms/odsp-shared-sharing/lib/utilities/ClientIdHelper",["require","exports","../interfaces/SharingInterfaces"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e){return a(e)||l(e)||f(e)||c(e)||h(e)||d(e)}t.isOfficeProduct=r;function i(e){return e===n.ClientId.odb||e===n.ClientId.sharePoint||e===n.ClientId.odc}t.isODSP=i;t.isOutlook=function(e){return e===n.ClientId.outlookWeb||e===n.ClientId.outlookWindows||e===n.ClientId.outlookMac};function s(e){return e===n.ClientId.odIos||e===n.ClientId.wordIos||e===n.ClientId.excelIos||e===n.ClientId.visioIos||e===n.ClientId.onenoteIos||e===n.ClientId.powerpointIos||e===n.ClientId.teamsIos||e===n.ClientId.officemobileIos}t.isIos=s;function o(e){return e===n.ClientId.odAndroid||e===n.ClientId.wordAndroid||e===n.ClientId.excelAndroid||e===n.ClientId.visioAndroid||e===n.ClientId.onenoteAndroid||e===n.ClientId.powerpointAndroid||e===n.ClientId.teamsAndroid||e===n.ClientId.officemobileAndroid}t.isAndroid=o;function u(e){return s(e)||o(e)}t.isMobile=u;t.hideItemName=function(e,t){return r(e)&&!t.isMac&&e!==n.ClientId.onenoteUWP&&e!==n.ClientId.onenoteIos};t.showCloseButton=function(e){return i(e)||e===n.ClientId.onenoteWeb||e===n.ClientId.outlookWeb||e===n.ClientId.officecom||e===n.ClientId.teams||e===n.ClientId.sample||e===n.ClientId.outlookGroupsWeb||u(e)};t.showOWAShareTarget=function(e){return i(e)||e===n.ClientId.officecom||e===n.ClientId.wac};t.invertPermissionsButtonsOrder=function(e){return u(e)||p(e)};function a(e){return e===n.ClientId.word||e===n.ClientId.wordAndroid||e===n.ClientId.wordIos}t.isWord=a;function f(e){return e===n.ClientId.excel||e===n.ClientId.excelAndroid||e===n.ClientId.excelIos}t.isExcel=f;function l(e){return e===n.ClientId.powerpoint||e===n.ClientId.powerpointAndroid||e===n.ClientId.powerpointIos}t.isPowerPoint=l;function c(e){return e===n.ClientId.visio||e===n.ClientId.visioIos||e===n.ClientId.visioAndroid}t.isVisio=c;function h(e){return e===n.ClientId.onenote||e===n.ClientId.onenoteWeb||e===n.ClientId.onenoteUWP||e===n.ClientId.onenoteIos||e===n.ClientId.onenoteAndroid}t.isOneNote=h;function p(e){return e===n.ClientId.teams||e===n.ClientId.teamsIos||e===n.ClientId.teamsAndroid}t.isTeams=p;function d(e){return e===n.ClientId.officemobileIos||e===n.ClientId.officemobileAndroid}t.isUnionApp=d});
define("@ms/odsp-shared-sharing/lib/utilities/ShareHelper",["require","exports","tslib","../interfaces/SharingInterfaces","@ms/odsp-utilities/lib/string/StringHelper","../components/Share.resx","../utilities/ClientIdHelper","@ms/odsp-utilities/lib/icons/OfficeFileNameHelper","@ms/odsp-utilities/lib/icons/ItemType"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.days=[s.default.sunday,s.default.monday,s.default.tuesday,s.default.wednesday,s.default.thursday,s.default.friday,s.default.saturday];t.shortDays=[s.default.shortSunday,s.default.shortMonday,s.default.shortTuesday,s.default.shortWednesday,s.default.shortThursday,s.default.shortFriday,s.default.shortSaturday];t.shortMonths=[s.default.shortJanuary,s.default.shortFebruary,s.default.shortMarch,s.default.shortApril,s.default.shortMay,s.default.shortJune,s.default.shortJuly,s.default.shortAugust,s.default.shortSeptember,s.default.shortOctober,s.default.shortNovember,s.default.shortDecember];t.months=[s.default.january,s.default.february,s.default.march,s.default.april,s.default.may,s.default.june,s.default.july,s.default.august,s.default.september,s.default.october,s.default.november,s.default.december];t.MAX_DAYS_FOR_EXPIRING_LINK=730;var f;!function(e){e[e.none=0]="none";e[e.pastDate=1]="pastDate";e[e.adminPolicy=2]="adminPolicy";e[e.overMax=3]="overMax";e[e.adminRequired=4]="adminRequired"}(f=t.ExpirationErrorCode||(t.ExpirationErrorCode={}));t.truncateItemNameForHeader=function(e){return l(e,26)};t.truncateOrganizationName=function(e,t){return l(e,t=t||25)};t.truncateItemNameForShareNotification=function(e,t){return l(e,t=t||20)};function l(e,t){if(!e)return"";var n=t,r=n/2;return e.length<=n?e:e.slice(0,r)+"..."+e.slice(e.length-r)}t.isLoadingData=function(e){return 0===e.userRole&&0===e.defaultLinkKind};t.getSharingLinkKindFromVroomScope=function(e,t){switch(e){case"anonymous":return t?5:4;case"organization":return t?3:2;case"users":return 6;default:return 1}};t.getSharingAudienceFromVroomScope=function(e){switch(e){case"anonymous":return r.SharingAudience.anyone;case"organization":return r.SharingAudience.organization;case"users":return r.SharingAudience.specificPeople;default:return r.SharingAudience.existing}};t.getVroomScopeFromSharingLinkKind=function(e){switch(e){case 5:case 4:return"anonymous";case 3:case 2:return"organization";case 6:return"users";default:return"existingAccess"}};t.getLinkIconUrl=function(e,t,n){var i=t.sharingLinkKind,s=t.audience,u="https://static2.sharepointonline.com/files/fabric/assets/icons/sharing",a=o.isOutlook(e)?"directrecipients.svg":"peopleinchat.svg";switch(i){case 2:case 3:return u+"/companyonly.svg";case 4:case 5:return u+"/anyone.svg";case 6:return t.audience===r.SharingAudience.customLabeledSpecificPeople?n&&n.iconUrl||u+"/"+a:u+"/specificpeople.svg";default:return s===r.SharingAudience.customLabeledSpecificPeople?n&&n.iconUrl||u+"/"+a:u+"/existingaccess.svg?v2"}};t.getLinkIconName=function(e){if(e.isCreateOnlyLink)return"FileRequest";switch(e.sharingLinkKind){case 2:case 3:return"Work";case 4:case 5:return"Globe";case 6:return e.audience===r.SharingAudience.anyone?"Globe":e.audience===r.SharingAudience.organization?"Work":"PeopleAdd";default:return"Link"}};t.getDarkTheme=function(){return{palette:{themePrimary:"#3A96DD",themeLighterAlt:"#eff6fc",themeLighter:"#deecf9",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeSecondary:"#2b88d8",themeDarkAlt:"#106ebe",themeDark:"#004578",themeDarker:"#34365c",neutralLighterAlt:"#292827",neutralLighter:"#323130",neutralLight:"#3B3A39",neutralQuaternaryAlt:"#484644",neutralQuaternary:"#605E5C",neutralTertiaryAlt:"#484644",neutralTertiary:"#A19F9D",neutralSecondary:"#BEBBB8",neutralPrimaryAlt:"#E1DFDD",neutralPrimary:"#F3F2F1",neutralDark:"#FAF9F8",redDark:"#FF4343",black:"#FFFFFF",white:"#252423",primaryBackground:"#f9f8f7",primaryText:"#252423",bodyBackground:"#252423",bodyText:"#252423",disabledBackground:"#3B3A39",disabledText:"#c8c8c8"}}};function c(e,t,n){var r=o.isOutlook(e);switch(n&&n.audienceType||r&&"recipient"){case"channel":switch(t){case"edit":return s.default.peopleInChannelEditLabel;case"review":return s.default.peopleInChannelReviewLabel;default:return s.default.peopleInChannelViewLabel}break;case"team":switch(t){case"edit":return s.default.peopleInTeamEditLabel;case"review":return s.default.peopleInTeamReviewLabel;default:return s.default.peopleInTeamViewLabel}break;case"recipient":switch(t){case"edit":return s.default.recipientsCanEditLabel;case"review":return s.default.recipientsCanReviewLabel;default:return s.default.recipientsCanViewLabel}break;default:switch(t){case"edit":return s.default.peopleInChatEditLabel;case"review":return s.default.peopleInChatReviewLabel;default:return s.default.peopleInChatViewLabel}}}t.getCustomLinkLabel=c;t.getLinkLabel=function(e,t,n,o){var u=e.sharingLinkKind,a=e.audience;if(e.isCreateOnlyLink)return s.default.fileRequestDescription;switch(u){case 2:return i.format(s.default.cslViewDescription,t);case 3:return i.format(s.default.cslEditDescription,t);case 4:return s.default.anonViewDescription;case 5:return s.default.anonEditDescription;case 1:return a===r.SharingAudience.customLabeledSpecificPeople?e.isEdit?o&&o.entityName?i.format(s.default.customLabeledEditLabel,o.entityName):c(n,"edit",o):e.isReview?o&&o.entityName?i.format(s.default.customLabeledReviewLabel,o.entityName):c(n,"review",o):o&&o.entityName?i.format(s.default.customLabeledViewLabel,o.entityName):c(n,"view",o):s.default.existingPeopleDescription;case 6:return a===r.SharingAudience.anyone?e.blockDownload?e.hasPassword?s.default.anonymousViewOnlyWithPassword:s.default.anonymousViewOnlyHint:e.hasPassword?e.isReview?s.default.anonPasswordReviewDescription:e.isEdit?s.default.anonPasswordEditDescription:s.default.anonPasswordViewDescription:e.isReview?s.default.anonReviewDescription:e.isEdit?s.default.anonEditDescription:s.default.anonViewDescription:a===r.SharingAudience.customLabeledSpecificPeople?e.isEdit?o&&o.entityName?i.format(s.default.customLabeledEditLabel,o.entityName):c(n,"edit",o):!0===e.isReview?o&&o.entityName?i.format(s.default.customLabeledReviewLabel,o.entityName):c(n,"review",o):o&&o.entityName?i.format(s.default.customLabeledViewLabel,o.entityName):c(n,"view",o):e.audience===r.SharingAudience.organization?e.blockDownload?i.format(s.default.cslViewOnlyHint,t):e.isEdit?i.format(s.default.cslEditDescription,t):e.isReview?i.format(s.default.cslReviewDescription,t):i.format(s.default.cslViewDescription,t):e.blockDownload?s.default.specificPeopleViewOnlyHint:e.isEdit?s.default.pslEditLabel:e.isReview?s.default.pslReviewLabel:s.default.pslViewLabel;default:return""}};t.getLinkParticipants=function(e){for(var t=[],n=e.principals,r=e.invitees,i=0,s=n;i<s.length;i++){var o=s[i];t.push({id:o.id,name:o.primaryText,image:o.imageUrl,isResolved:!0,principalName:o.loginName,userId:o.loginName,email:o.email,job:o.secondaryText,isExternal:o.isExternal,loginName:o.loginName,principalType:o.type})}for(var u=function(e){0===(!0===e.isExternal?t.filter(function(t){return t.email===e.email}):t.filter(function(t){return t.principalName===e.loginName})).length&&t.push({id:e.id,name:e.primaryText,image:e.imageUrl,isResolved:!0,principalName:e.loginName,userId:e.loginName,email:e.email,job:e.secondaryText,isExternal:e.isExternal,loginName:e.loginName,principalType:e.type})},a=0,f=r;a<f.length;a++){u(f[a])}return t};t.getEncodedMessageLength=function(e){if(!e)return 0;var t=0,n=e.length,r=0,i=!1;if(0===e.length)return 0;for(var s="&#160;",o="<br />",u="&quot;&quot;&quot;",a="&amp;",f="&#39;",l="&lt;",c="&gt;",h=" ";r<n;){var p=null,d=e[r];if(" "===d)p=r+1<n&&" "===e[r+1]||i?s:" ";else if("\n"===d){p=o;i=!0}else{'"'===d?p=u:"&"===d?p=a:"'"===d?p=f:"<"===d?p=l:">"===d?p=c:"\r"===d&&(p=h);i=!1}t+=null!==p?p.length:1;r++}return t};t.getFileShareTypeFromAudience=function(e){return e===r.SharingAudience.anyone?0:e===r.SharingAudience.organization?1:e===r.SharingAudience.existing?4:2};t.getRoleIconNameAndTitle=function(e){var t,n;switch(e){case 2:t="Edit";n=s.default.canEditRole;break;case 1:t="View";n=s.default.canViewRole;break;case 6:t="Feedback";n=s.default.canReviewRole}return{name:t,title:n}};t.getExpirationErrorCode=function(e,n){var r=f.none,i=n;if(!e||e.getTime()===new Date(0).getTime())return r;var s=new Date;s.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());var o=Math.floor((e.getTime()-s.getTime())/864e5);o<1?r=f.pastDate:o>t.MAX_DAYS_FOR_EXPIRING_LINK?r=f.overMax:o>i&&-1!==i&&(r=f.adminPolicy);return r};t.getLinkKind=function(e,t){return e===r.SharingAudience.anyone?t?5:4:e===r.SharingAudience.organization?t?3:2:e===r.SharingAudience.specificPeople||e===r.SharingAudience.existing?1:6};t.getExpirationDatePickerErrorMessage=function(e,n){var r=s.default;switch(e){case f.pastDate:return r.pastDateExpirationError;case f.adminPolicy:return i.format(r.adminExpirationError,n);case f.overMax:return i.format(r.maxExpirationError,t.MAX_DAYS_FOR_EXPIRING_LINK);case f.adminRequired:return s.default.requireExpirationError;default:return""}};t.isCustomLabeledSpecificPeopleSupported=function(e,t,n,i){return o.isOutlook(e)||i&&t===r.Mode.linkSettings&&o.isTeams(e)&&n&&(!!n.entityName||!!n.audienceType)};t.getDefaultExpirationDateValue=function(e){var t=e;if(-1===t)return null;var n=new Date;n.setDate(n.getDate()+t);return n};t.copySharingLinkToClipboard=function(e,t,r){return n.__awaiter(this,void 0,void 0,function(){var i,s,u;return n.__generator(this,function(n){switch(n.label){case 0:i=!1;if(o.isMobile(e))return[3,4];try{t.focus();t.setSelectionRange(0,t.value.length);i=document.execCommand("copy")}catch(e){}if(i||!window.navigator||!window.navigator.clipboard)return[3,4];n.label=1;case 1:n.trys.push([1,3,,4]);return[4,window.navigator.clipboard.writeText(t.value)];case 2:n.sent();i=!0;return[3,4];case 3:n.sent();return[3,4];case 4:try{s=window.external;u=s.CopyToClipboard(r);i=u||void 0===u}catch(e){}return[2,i]}})})};t.isNonOfficeFileCommentsAvailable=function(e){var t=e.extension&&e.extension.replace(/^\./,"");e.appmap=t&&u.OfficeIconFileTypeMap[t];var n=e.appmap&&".pdf"!==e.extension,r=e.itemType===a.ItemType.File||e.itemType===a.ItemType.Media||e.itemType===a.ItemType.Unknown||e.itemType===a.ItemType.Shortcut;return!n&&r}});
define("@ms/odsp-utilities/lib/browser/ResponsiveUI",["require","exports","../events/EventGroup","../scope/Scope"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ResponsiveUIEvents={formFactorChange:"formFactorChange",hamburgerVisibilityChange:"hamburgerVisibilityChange",showLabelsChange:"showCommandLabelsChange"};var i={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},s={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0},o=function(){function e(e,t){this._scope=new r.default;this._events=new(this._scope.attached(n.default))(this);this._events.on(window,"resize, orientationchange",this._onContainerResize.bind(this));var i=t.breakpoints;this._breakpoints="function"==typeof i?i:function(){return i};this._windowWidth=0;this._windowHeight=0;this._onContainerResize()}e.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}};e.determineWindowSize=function(e,t){void 0===t&&(t=s);if(0===e)return"Medium";for(var n in s)if(e<t[n])return n};e.determineCssClass=function(e){return i[e]};e.getScrollbarWidth=function(){var e=document.createElement("div"),t=document.createElement("div"),n=e.style;n.visibility="hidden";n.width="100px";n.msOverflowStyle="scrollbar";n.overflow="scroll";t.style.width="100%";document.body.appendChild(e);e.appendChild(t);var r=e.offsetWidth,i=t.offsetWidth;e.parentNode.removeChild(e);var s=r-i;this.getScrollbarWidth=function(){return s};return s};Object.defineProperty(e.prototype,"windowWidth",{get:function(){return this._windowWidth},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"windowHeight",{get:function(){return this._windowHeight},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"formFactorSize",{get:function(){return this._formFactorSize},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"isHamburgerVisible",{get:function(){return this._isHamburgerVisible},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"showLabels",{get:function(){return this._showLabels},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"cssClass",{get:function(){return this._cssClass},enumerable:!0,configurable:!0});e.prototype.dispose=function(){this._scope.dispose()};e.prototype.compareSize=function(e,t){var n=this._breakpoints();return n[e]-n[t]};e.prototype._afterContainerResize=function(){};e.prototype._onContainerResize=function(){var n=document.body,r=document.documentElement,i=this._windowHeight=r.clientWidth||n.clientWidth;this._windowWidth=r.clientHeight||n.clientHeight;var o=this._formFactorSize,u=this._formFactorSize=e.determineWindowSize(i,this._breakpoints());this._cssClass=e.determineCssClass(u);var a=this._isHamburgerVisible;this._isHamburgerVisible=i<s.Large;var f=this._showLabels;this._showLabels=this.compareSize(u,"Medium")>0;o&&u!==o&&this._events.raise(t.ResponsiveUIEvents.formFactorChange);"boolean"==typeof a&&a!==this._isHamburgerVisible&&this._events.raise(t.ResponsiveUIEvents.hamburgerVisibilityChange);"boolean"==typeof f&&f!==this._showLabels&&this._events.raise(t.ResponsiveUIEvents.showLabelsChange);this._afterContainerResize()};e.DEFAULT_BREAKPOINTS=s;e.MAC_SCROLL_BAR_WIDTH=8;return e}();t.ResponsiveUI=o;t.default=o});
define("@ms/odsp-shared-sharing/lib/components/Header/Header.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHeader{-webkit-box-align:center;-ms-flex-align:center;align-items:center;color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";display:-webkit-box;display:-ms-flexbox;display:flex;height:40px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:4px;border-bottom-style:solid;border-bottom-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";border-bottom-width:1px}.isFluent .od-ShareHeader{padding:16px 16px 12px;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;border-bottom-width:0}.od-ShareHeader-linkSettings{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";display:-webkit-box;display:-ms-flexbox;display:flex;padding:0;margin-bottom:5px;font-size:17px;font-weight:700}[dir=ltr] .od-ShareHeader-linkSettings{margin-left:20px}[dir=rtl] .od-ShareHeader-linkSettings{margin-right:20px}.teams .od-ShareHeader-linkSettings{font-weight:700;margin-top:32px}.od-ShareHeader-backgroundColor{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.isFluent .od-ShareHeader-backgroundColor{background-color:transparent}.teams .od-ShareHeader-backgroundColor{background-color:transparent}.od-ShareHeader-moreContextualMenu .is-open{border:none;width:auto}.od-ShareHeader-buttons-left{padding-top:16px;position:absolute;top:0}[dir=ltr] .od-ShareHeader-buttons-left{padding-left:8px}[dir=rtl] .od-ShareHeader-buttons-left{padding-right:8px}[dir=ltr] .od-ShareHeader-buttons-left{left:0}[dir=rtl] .od-ShareHeader-buttons-left{right:0}.od-ShareHeader-button-send-right{padding-top:12px;position:absolute;top:0}[dir=ltr] .od-ShareHeader-button-send-right{padding-right:8px}[dir=rtl] .od-ShareHeader-button-send-right{padding-left:8px}[dir=ltr] .od-ShareHeader-button-send-right{right:0}[dir=rtl] .od-ShareHeader-button-send-right{left:0}.od-ShareHeader-buttons-right{padding-top:16px;position:absolute;top:0}[dir=ltr] .od-ShareHeader-buttons-right{padding-right:8px}[dir=rtl] .od-ShareHeader-buttons-right{padding-left:8px}[dir=ltr] .od-ShareHeader-buttons-right{right:0}[dir=rtl] .od-ShareHeader-buttons-right{left:0}.od-ShareHeader-button{background:0 0;border:none;padding:0;width:30px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:16px;cursor:pointer;font:-apple-system-body}.ms-Fabric .od-ShareHeader-button::-moz-focus-inner{border:0}.ms-Fabric .od-ShareHeader-button{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-ShareHeader-button:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-ShareHeader-button:focus:after{border-color:ActiveBorder}}.od-ShareHeader-title{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.isFluent .od-ShareHeader-title{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.od-ShareHeader-viewName{font-size:17px;font-weight:300;font-weight:400;font:-apple-system-headline;margin:0}.isFluent .od-ShareHeader-viewName{font-size:20px;font-weight:600}.od-ShareHeader-itemName{font-size:11px;font-weight:400;overflow:hidden;text-align:center;text-overflow:ellipsis;white-space:nowrap;width:175px;font:-apple-system-caption2}.isFluent .od-ShareHeader-itemName{text-align:initial;font-size:12px}@media screen and (-ms-high-contrast:active){.od-Share .od-ShareHeader-button{outline:1px solid "},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}}"}])});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/PermissionsSettings/PermissionsSettings",["require","exports","tslib","../AudienceChoiceGroup/AudienceChoiceGroup","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Checkbox","../ExpirationDatePicker/ExpirationDatePicker","../PasswordField/PasswordField","../../../utilities/ShareHelper","../../../data/Icons/FileShareIconMap","../../../interfaces/SharingInterfaces","../../PermissionsList/ShareLink/ChangePermission/ChangePermission","../../../utilities/PeoplePickerHelper","react","react","prop-types","../../../utilities/SharingAbilitiesHelper","@ms/odsp-utilities/lib/string/StringHelper","../../PeoplePicker/PeoplePicker","../../Share.resx","../PreventDownload/PreventDownload","../../../utilities/ClientIdHelper","office-ui-fabric-react/lib/TeachingBubble","office-ui-fabric-react/lib/Icon","../../../utilities/ShareHelper","../../../utilities/ReviewPermissionExperimentHelper","./PermissionsSettings.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C=function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._allowEditCheckbox=d.createRef();i._pickerUpsellDiv=d.createRef();i._passwordUpsellDiv=d.createRef();i._learnMoreClicked=function(){i.context.sharingStore.getEngagementHelper().linkSettingsLearnMoreClicked(i.props.engagementExtraData)};i._onPeoplePickerChange=function(e){i.setState(n.__assign({},i.state,{externalRecipientWarning:h.getOversharingExternalsWarning(e),groupRecipientWarning:h.getOversharingGroupsWarning(e,i.props.groupsMemberCount)}),function(){i.props.onPeoplePickerChange(e)})};i._setSpecificPeopleReadOnlyExpanded=function(){i.setState({isSpecificPeopleReadOnlyExpanded:!0})};i._onAllowRoleChange=function(e){var t=!1,r=!1;2===e&&(t=!0);6===e&&(r=!0);i.setState(n.__assign({},i.state,{preventDownloadDisabled:t||r}),function(){i.props.onRoleChange(e)})};i._onResolvedSuggestions=function(e){i.context.sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestions(i.props.engagementExtraData,e);return e};i._resize=r.resize;var s=t.selectedPermissions.specificPeople;i.state={expirationErrorCode:a.ExpirationErrorCode.none,externalRecipientWarning:h.getOversharingExternalsWarning(s),groupRecipientWarning:h.getOversharingGroupsWarning(s,t.groupsMemberCount),preventDownloadDisabled:i.props.selectedPermissions.isEdit||i.props.selectedPermissions.isReview,showPickerTeachingBubble:!1,showPasswordTeachingBubble:!1,isSpecificPeopleReadOnlyExpanded:!1};i._onAllowEditChange=i._onAllowEditChange.bind(i);i._onChoiceGroupChange=i._onChoiceGroupChange.bind(i);i._onSelectDate=i._onSelectDate.bind(i);i._renderExpirationDatePicker=i._renderExpirationDatePicker.bind(i);i._renderExpirationDatePickerErrorMessage=i._renderExpirationDatePickerErrorMessage.bind(i);i._renderPeoplePicker=i._renderPeoplePicker.bind(i);i._showReview=N.default.checkExperimentisOn();i._isNonOfficeCommentsAvailable=T.isNonOfficeFileCommentsAvailable(i.props.sharingInformation.item);i._permissionsOptions=i._getAudienceChoiceGroupOptions();i._supportedAudienceOptions=r.sharingStore.getSupportedAudienceOptions();return i}t.prototype.componentDidMount=function(){var e=this;this._disablePremiumFeatures=!this.context.sharingStore.isPremiumExperienceAllowed();if(this._disablePremiumFeatures){if(this._pickerUpsellDiv.current){this._pickerUpsellDiv.current.addEventListener("click",function(t){e._togglePickerTeachingBubble()});this._pickerUpsellDiv.current.addEventListener("keydown",function(t){t.keyCode!==i.KeyCodes.enter&&t.keyCode!==i.KeyCodes.space||e._togglePickerTeachingBubble()})}if(this._passwordUpsellDiv.current){this._passwordUpsellDiv.current.addEventListener("click",function(t){e._togglePasswordTeachingBubble()});this._passwordUpsellDiv.current.addEventListener("keydown",function(t){t.keyCode!==i.KeyCodes.enter&&t.keyCode!==i.KeyCodes.space||e._togglePasswordTeachingBubble()})}}var t,n,r=document.getElementsByClassName("od-PermissionsSettings-allowEdit")[0];if(r){t=r.getElementsByClassName("ms-Checkbox-text")[0];n=r.children[0]}t&&t.setAttribute("aria-hidden","true");if(n){n.setAttribute("aria-label",b.default.allowEditLabel);this.context.sharingStore.isPremiumExperienceAllowed()||n.focus()}};t.prototype.componentDidUpdate=function(e,t){this._resize()};t.prototype.render=function(){var e=this.props;this._disablePremiumFeatures=!this.context.sharingStore.isPremiumExperienceAllowed();return this._getAudienceOptions().length>1?p.createElement("div",{className:"od-PermissionsSettings"},p.createElement("div",{className:"od-PermissionsSettings-section"},p.createElement("div",{className:"od-PermissionsSettings-description od-ModifyPermissions-margins"},b.default.permissionsSettingsHeader,this.context.sharingStore.showAudienceLearnMore()&&p.createElement("a",{className:"od-PermissionsSettings-learnMore","aria-label":b.default.learnMoreLabel+": "+b.default.permissionsSettingsHeader,href:"https://go.microsoft.com/fwlink/?linkid=846149",target:"_blank",onClick:this._learnMoreClicked},b.default.learnMoreLabel)),p.createElement("div",{className:"od-PermissionsSettings-bottomBorder"}),p.createElement(r.AudienceChoiceGroup,{items:this._getAudienceOptions(),onChange:this._onChoiceGroupChange,onAudienceChange:e.onAudienceChange,companyName:e.companyName,clientId:e.clientId}),this._renderPeoplePicker()),this._renderOtherSettings()):p.createElement("div",{className:"od-PermissionsSettings"},p.createElement("div",{className:"od-PermissionsSettings-section"},p.createElement("div",{className:"od-PermissionsSettings-bottomBorder"})),this._renderOtherSettings())};t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this,r=e.selectedPermissions,i=r.specificPeople;0===i.length&&e.recipients.length>0&&this._onPeoplePickerChange(e.recipients);this.setState(n.__assign({},this.state,{expirationErrorCode:a.getExpirationErrorCode(r.expiration,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays),externalRecipientWarning:h.getOversharingExternalsWarning(i),groupRecipientWarning:h.getOversharingGroupsWarning(i,e.groupsMemberCount),preventDownloadDisabled:r.isEdit||r.isReview}),function(){t.props.updateExpirationErrorCode(t.state.expirationErrorCode)})};t.prototype._togglePickerTeachingBubble=function(){this.setState({showPickerTeachingBubble:!this.state.showPickerTeachingBubble})};t.prototype._togglePasswordTeachingBubble=function(){this.setState({showPasswordTeachingBubble:!this.state.showPasswordTeachingBubble})};t.prototype._renderOtherSettings=function(){if(this.props.selectedPermissions.audience!==l.SharingAudience.existing)return p.createElement("div",{className:"od-PermissionsSettings-section od-ModifyPermissions-margins"},p.createElement("div",{className:"od-PermissionsSettings-description"},b.default.otherSettings),p.createElement("div",{role:"group","aria-label":b.default.otherSettings},p.createElement("div",{className:"od-PermissionsSettings-setting"},this._renderRolesDropDown()),this._renderExpirationDatePicker(),this._renderPasswordField(),this._renderPreventDownloadToggle()))};t.prototype._getSpecificPeopleOption=function(){return this.props.createPeopleSharingLinks?{disabledText:b.default.disabledAudienceChoiceLabel2,icon:f.FileShareIconMap[2],isChecked:!1,isDisabled:!1,key:l.SharingAudience.specificPeopleFlex,label:b.default.permissionsSpecificPeopleString,linkKinds:[6],permissionsType:2}:{disabledText:b.default.disabledAudienceChoiceLabel2,icon:f.FileShareIconMap[2],isChecked:!1,isDisabled:!1,key:l.SharingAudience.specificPeople,label:b.default.permissionsSpecificPeopleString,linkKinds:[1],permissionsType:2}};t.prototype._getAudienceChoiceGroupOptions=function(){var e=[{disabledText:b.default.disabledAudienceChoiceLabel2,icon:f.FileShareIconMap[0],isChecked:!1,isDisabled:!1,key:l.SharingAudience.anyone,label:b.default.permissionsAnyoneString,linkKinds:[4,5],permissionsType:0},{disabledText:b.default.disabledAudienceChoiceLabel2,icon:f.FileShareIconMap[1],isChecked:!1,isDisabled:!1,key:l.SharingAudience.organization,label:g.format(b.default.permissionsCompanyString,this.props.companyName),linkKinds:[2,3],permissionsType:1},this._getSpecificPeopleOption()];if(this.props.showExistingAccessOption||!this.props.sharingInformation.canManagePermissions||this.props.sharingInformation.blockPeoplePickerAndSharing){var t={icon:f.FileShareIconMap[1],isChecked:!1,isDisabled:!1,key:l.SharingAudience.existing,label:b.default.permissionsExistingPeopleString,linkKinds:[1],permissionsType:4};e.splice(2,0,t)}return e};t.prototype._renderPeoplePicker=function(){var e=this.props,t=this.state;return e.selectedPermissions.audience!==l.SharingAudience.specificPeople&&e.selectedPermissions.audience!==l.SharingAudience.specificPeopleFlex||!e.copyLinkShortcut&&e.mode!==l.Mode.linkSettings?void 0:E.isOutlook(this.props.clientId)?p.createElement("div",{className:"od-PermissionsSetting-specificPeople-container"},e.currentSettings.specificPeople.length>0?this._renderReadOnlySpecificPeople():void 0):p.createElement("div",{className:"od-ModifyPermissions-margins od-PermissionsSettings-PeoplePicker"},p.createElement(y.default,{defaultSelectedItems:e.selectedPermissions.specificPeople,onChange:this._onPeoplePickerChange,oversharingExternalsWarning:t.externalRecipientWarning,oversharingGroupsWarning:t.groupRecipientWarning,pickerSettings:e.sharingInformation.peoplePickerSettings,error:e.peoplePickerError,sharingInformation:e.sharingInformation,clientId:this.props.clientId,onResolvedSuggestions:this._onResolvedSuggestions}))};t.prototype._renderReadOnlySpecificPeople=function(){for(var e="",t=this.props.currentSettings.specificPeople,n=this.state.isSpecificPeopleReadOnlyExpanded?t.length:5,r=t.length-n,i=0;i<Math.min(t.length,n);i++)e+=t[i].name+(t.length-1>i?", ":"");var s=r>0&&!this.state.isSpecificPeopleReadOnlyExpanded?p.createElement("a",{href:"javascript:void(0)",onClick:this._setSpecificPeopleReadOnlyExpanded}," +"+r):void 0;return p.createElement("div",{className:"od-PermissionsSetting-specificPeople-list"},e,s)};t.prototype._renderRolesDropDown=function(){var e=this.props;return this._showReview&&this._isNonOfficeCommentsAvailable?p.createElement("div",{className:"od-PermissionsSettings-changePermission"},p.createElement(c.ChangePermission,{selectedPermissions:e.selectedPermissions,onRoleChange:this._onAllowRoleChange,item:e.sharingInformation.item,canChangePermission:!1,showReview:this._showReview})):p.createElement(s.Checkbox,{className:"od-PermissionsSettings-allowEdit",label:b.default.allowEditLabel,onChange:this._onAllowEditChange,checked:e.selectedPermissions.isEdit,disabled:!e.selectedPermissions.allowEditing,componentRef:this._allowEditCheckbox})};t.prototype._renderExpirationDatePicker=function(){var e=this.props,t=e.selectedPermissions;return this.context.sharingStore.isExpirationDateModificationAllowed()&&(t.audience===l.SharingAudience.anyone||this.context.sharingStore.isSpecificPeopleExpirationAllowed()&&t.audience===l.SharingAudience.specificPeople)?this._disablePremiumFeatures?p.createElement("div",{ref:this._pickerUpsellDiv,className:"od-PermissionsSettings-wrapper",tabIndex:0},p.createElement("div",{className:"od-PermissionsSettings-blocker","aria-hidden":"true"},p.createElement("div",{className:"od-PermissionsSettings-setting"},p.createElement("div",{className:"od-PermissionsSettings-datePicker"},p.createElement(o.ExpirationDatePicker,{clientId:this.props.clientId,onSelectDate:this._onSelectDate,value:t.expiration,expiryRestriction:e.sharingInformation.anonymousLinkExpirationRestrictionDays,disableAutoFocus:this._disablePremiumFeatures,hideRemoveDateButton:this._disablePremiumFeatures,showGleam:this._disablePremiumFeatures,tabIndex:-1})),this._renderExpirationTeachingBubble(),p.createElement("span",{className:"od-PermissionsSettings-expirationError",role:"alert","aria-live":"assertive"},this._renderExpirationDatePickerErrorMessage())))):p.createElement("div",{className:"od-PermissionsSettings-setting"},p.createElement("div",{className:"od-PermissionsSettings-datePicker"},p.createElement(o.ExpirationDatePicker,{clientId:this.props.clientId,onSelectDate:this._onSelectDate,value:t.expiration,expiryRestriction:e.sharingInformation.anonymousLinkExpirationRestrictionDays,disableAutoFocus:this._disablePremiumFeatures,hideRemoveDateButton:this._disablePremiumFeatures,showGleam:this._disablePremiumFeatures})),this._renderExpirationTeachingBubble(),p.createElement("span",{className:"od-PermissionsSettings-expirationError",role:"alert","aria-live":"assertive"},this._renderExpirationDatePickerErrorMessage())):void 0};t.prototype._renderExpirationTeachingBubble=function(){var e=this;if(this.state.showPickerTeachingBubble){var t={targetElement:this._pickerUpsellDiv.current,onDismiss:function(t){return e.setState({showPickerTeachingBubble:!1})},headline:b.default.expirationTeachingBubbleHeadline,mainText:b.default.expirationTeachingBubbleText};return this._renderUpsellTeachingBubble(t)}};t.prototype._renderExpirationDatePickerErrorMessage=function(){var e=this.state.expirationErrorCode;return a.getExpirationDatePickerErrorMessage(e,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays)};t.prototype._renderPasswordField=function(){var e=this.props,t=this.context.sharingStore.isPasswordModificationAllowed(),n=e.selectedPermissions;return t&&n.audience===l.SharingAudience.anyone?this._disablePremiumFeatures?p.createElement("div",{ref:this._passwordUpsellDiv,className:"od-PermissionsSettings-wrapper",tabIndex:0},p.createElement("div",{className:"od-PermissionsSettings-blocker","aria-hidden":"true"},p.createElement("div",{className:"od-PermissionsSettings-setting"},p.createElement(u.PasswordField,{onPasswordChange:this.props.onPasswordChange,readOnly:!0,showGleam:!0,tabIndex:-1}),this._renderPasswordTeachingBubble()))):p.createElement("div",{className:"od-PermissionsSettings-setting"},p.createElement(u.PasswordField,{onPasswordChange:this.props.onPasswordChange})):void 0};t.prototype._renderPasswordTeachingBubble=function(){var e=this;if(this.state.showPasswordTeachingBubble){var t={targetElement:this._passwordUpsellDiv.current,onDismiss:function(t){return e.setState({showPasswordTeachingBubble:!1})},headline:b.default.passwordTeachingBubbleHeader,mainText:b.default.passwordTeachingBubbleText};return this._renderUpsellTeachingBubble(t)}};t.prototype._getAudienceOptions=function(){var e=this.props.sharingInformation.sharingAbilities,t=this.props.sharingInformation,n=[],r=this.props.currentSettings,i=void 0;for(var s in e)if(e.hasOwnProperty(s)){var o=e[s],u=m.getSharingAbilitiesAudience(s);if(!u)continue;if(u===l.SharingAudience.specificPeopleFlex&&!this.props.createPeopleSharingLinks){i=this._getSpecificPeopleOption();t.canManagePermissions&&!t.blockPeoplePickerAndSharing?i.isChecked=i.key===r.audience||l.SharingAudience.specificPeopleFlex===r.audience:i.isDisabled=!0;this._supportedAudienceOptions.indexOf(l.SharingAudience.specificPeople)>-1&&n.push(i);continue}var c=this._getAudienceOption(u);if(c){c.isDisabled=!(o.canManageEditLink.enabled||o.canManageReadLink.enabled);c.isChecked=c.key===r.audience;n.push(c)}}var h={icon:f.FileShareIconMap[1],isChecked:r.audience===l.SharingAudience.existing,isDisabled:!1,key:l.SharingAudience.existing,label:b.default.permissionsExistingPeopleString,linkKinds:[1],permissionsType:4};this._supportedAudienceOptions.indexOf(l.SharingAudience.existing)>-1&&n.splice(2,0,h);var p=n.filter(function(e){return e.key===l.SharingAudience.specificPeople&&!e.isDisabled||e.key===l.SharingAudience.specificPeopleFlex&&!e.isDisabled?e:null}).length>0,d=!this.props.omitCustomLabeledAudience&&a.isCustomLabeledSpecificPeopleSupported(this.props.clientId,this.props.mode,this.props.customLabeledAudienceConfig,r.audience===l.SharingAudience.customLabeledSpecificPeople||this.props.recipients.length>0||this.props.isLoadingDefaultRecipients);if(p&&d){var v=this._getAudienceOption(l.SharingAudience.customLabeledSpecificPeople);n.splice(2,0,v);v.isDisabled=!(this.props.sharingInformation.canAddInternalPrincipal||this.props.sharingInformation.canAddExternalPrincipal);v.isChecked=r.audience===l.SharingAudience.customLabeledSpecificPeople||this.props.preferCustomLabeledAudience&&r.audience===l.SharingAudience.specificPeopleFlex}this.props.mode!==l.Mode.linkSettings||!E.isOutlook(this.props.clientId)||this.props.shareId&&r.audience===l.SharingAudience.specificPeopleFlex||!p||n.splice(n.indexOf(p),1);return n};t.prototype._renderPreventDownloadToggle=function(){var e=this.props.selectedPermissions,t=!!e.preventDownload,n=this.context.sharingStore.isPreventDownloadAllowed();return!!!this.context.sharingStore.getNavId()&&n&&m.supportsRestrictedView(e.audience,this.props.sharingInformation.sharingAbilities)?p.createElement("div",{className:"od-PermissionsSettings-setting"},p.createElement("div",{className:"od-PermissionsSettings-setting--PreventDownload"},p.createElement(w.PreventDownload,{onToggleChange:this.props.onToggleChange,isToggled:t,clientId:this.props.clientId,mode:this.props.mode,disablePreventDownload:this.state.preventDownloadDisabled,isNonOfficeFileReview:!(!this._showReview||!this._isNonOfficeCommentsAvailable)}))):void 0};t.prototype._renderUpsellTeachingBubble=function(e){var t,n=function(){return window.open("https://onedrive.live.com/about/plans/")};if(this.context.goPremium)n=this.context.goPremium;else try{var r=window.external;r.IsGoPremiumAvailable()&&(n=function(){try{r.GoPremium("https://onedrive.live.com/about/plans/")}catch(e){}})}catch(e){}if(this.context.premiumLearnMore)t={children:b.default.teachingBubbleLearnMoreButton,onClick:this.context.premiumLearnMore};else try{var i=window.external;if(i.IsPremiumLearnMoreAvailable()){t={children:b.default.teachingBubbleLearnMoreButton,onClick:function(){try{i.PremiumLearnMore()}catch(e){}}}}}catch(e){}return p.createElement(S.TeachingBubble,{targetElement:e.targetElement,onDismiss:e.onDismiss,hasCloseIcon:!0,headline:e.headline,primaryButtonProps:{children:b.default.teachingBubbleUpgradeButton,onClick:n},secondaryButtonProps:t,calloutProps:{className:"od-PermissionsSettings-teachingBubble"},hasSmallHeadline:!0},p.createElement(x.Icon,{iconName:"Diamond",className:"od-PermissionsSettings-teachingBubbleIcon"}),e.mainText)};t.prototype._getAudienceOption=function(e){var t=b.default;if(e===l.SharingAudience.anyone&&this._supportedAudienceOptions.indexOf(l.SharingAudience.anyone)>-1)return{disabledText:t.disabledAudienceChoiceLabel2,icon:f.FileShareIconMap[0],isChecked:!1,isDisabled:!1,key:l.SharingAudience.anyone,label:b.default.permissionsAnyoneString,linkKinds:[4,5],permissionsType:0};if(e===l.SharingAudience.organization&&this._supportedAudienceOptions.indexOf(l.SharingAudience.organization)>-1)return{disabledText:t.disabledAudienceChoiceLabel2,icon:f.FileShareIconMap[1],isChecked:!1,isDisabled:!1,key:l.SharingAudience.organization,label:g.format(b.default.permissionsCompanyString,this.props.companyName),linkKinds:[2,3],permissionsType:1};if(e===l.SharingAudience.specificPeopleFlex&&this._supportedAudienceOptions.indexOf(l.SharingAudience.specificPeopleFlex)>-1)return{disabledText:t.disabledAudienceChoiceLabel2,icon:f.FileShareIconMap[2],isChecked:!1,isDisabled:!1,key:l.SharingAudience.specificPeopleFlex,label:t.permissionsSpecificPeopleString,linkKinds:[6],permissionsType:2};if(e===l.SharingAudience.customLabeledSpecificPeople&&this._supportedAudienceOptions.indexOf(l.SharingAudience.customLabeledSpecificPeople)>-1){var n=E.isOutlook(this.props.clientId),r=n?6:5,i="",s=this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.audienceType;i=n||"recipient"===s?t.permissionsRecipientsOfThisMessageString:"channel"===s?t.permissionsPeopleInChannelString:"team"===s?t.permissionsPeopleinTeamString:t.permissionsPeopleInChatString;return{disabledText:b.default.disabledAudienceChoiceLabel2,icon:!(this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl)&&f.FileShareIconMap[r],iconUrl:this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl,isChecked:!1,isDisabled:!1,key:l.SharingAudience.customLabeledSpecificPeople,label:this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?g.format(t.permissionsOnlyCustomLabeledString,this.props.customLabeledAudienceConfig.entityName):i,linkKinds:[6],permissionsType:!(this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl)&&r}}};t.prototype._onChoiceGroupChange=function(e){for(var t=0,n=this._permissionsOptions;t<n.length;t++){var r=n[t];r.isChecked=e===r.key}};t.prototype._onSelectDate=function(e){var t=this,r=a.getExpirationErrorCode(e,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays);this.setState(n.__assign({},this.state,{expirationErrorCode:r}),function(){t.props.updateExpirationErrorCode(r);t.props.onExpirationChange(e)})};t.prototype._onAllowEditChange=function(e,t){this.props.onEditChange(t);this.setState(n.__assign({},this.state,{preventDownloadDisabled:t}))};t.contextTypes={resize:v.func.isRequired,sharingStore:v.bool.isRequired,goPremium:v.func,premiumLearnMore:v.func};return t}(p.Component);t.PermissionsSettings=C});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/AudienceChoiceGroup/AudienceChoiceGroup",["require","exports","tslib","office-ui-fabric-react/lib/FocusZone","../../ShareLinkDescription/ShareLinkDescription","react","prop-types","../../Share.resx","@ms/odsp-utilities/lib/string/StringHelper","../../../utilities/ClientIdHelper","./AudienceChoiceGroup.scss"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._onActiveElementChanged=function(e){if(!r._platformDetection.isMobile&&!f.isMobile(r.props.clientId)&&e&&e.hasAttribute("data-key")){var t=parseInt(e.getAttribute("data-key"),10);"true"===e.getAttribute("aria-disabled")||r._onRowClick(t,null)}};r.state={selectedKey:r._getSelectedIndex(t)};r._platformDetection=n.platformDetection;return r}t.prototype._getSelectedIndex=function(e){for(var t=0,n=e.items;t<n.length;t++){var r=n[t];if(r.isChecked)return r.key}};t.prototype.render=function(){var e=this.props.items.map(this._renderItem,this);return s.createElement("div",{"aria-label":u.default.permissionsSettingsHeader,role:"radiogroup"},s.createElement(r.FocusZone,{direction:r.FocusZoneDirection.vertical,defaultActiveElement:".od-AudienceChoiceGroup-row.is-selected",onActiveElementChanged:this._onActiveElementChanged},e))};t.prototype._renderItem=function(e){var t=e.key,n=!this._platformDetection.isFirefox,r=e.isDisabled&&e.disabledText?e.disabledText:"",o=this.state.selectedKey===t;return s.createElement("div",{key:t},s.createElement("button",{role:"radio","aria-checked":o,key:t,onClick:e.isDisabled?function(){}:this._onRowClick.bind(this,t),className:this._getRowClasses(e),autoFocus:o,"aria-disabled":e.isDisabled,disabled:e.isDisabled,"aria-label":e.label+" "+r,"data-key":t},s.createElement("span",{tabIndex:-1,role:"status","aria-live":"polite","aria-label":o?a.format(u.default.audienceSelectedStatus,e.label):"",className:"od-Share-screenReaderOnly"},o?a.format(u.default.audienceSelectedStatus,e.label):""),s.createElement("div",{className:"od-AudienceChoiceGroup-description"},s.createElement(i.ShareLinkDescription,{label:e.label,permissionsType:e.permissionsType,showLabel:!0,iconUrl:e.iconUrl,infoButtonMessage:n?r:""})),s.createElement("div",{className:"tickIcon","aria-hidden":!0})),s.createElement("div",{className:"od-AudienceChoiceGroup-bottomBorder"}))};t.prototype._getRowClasses=function(e){var t="od-ModifyPermissions-margins od-AudienceChoiceGroup-row";this.state.selectedKey===e.key&&(t+=" is-selected");e.isDisabled&&(t+=" is-disabled");return t};t.prototype._onRowClick=function(e,t){var n=this.props;this.setState({selectedKey:e});n.onChange(e);n.onAudienceChange(e)};t.contextTypes={platformDetection:o.object.isRequired};return t}(s.Component);t.AudienceChoiceGroup=l});
define("@ms/odsp-shared-sharing/lib/components/ShareLinkDescription/ShareLinkDescription",["require","exports","tslib","../../data/Icons/FileShareIconMap","../ModifyPermissions/AudienceChoiceGroup/InfoButton/InfoButton","office-ui-fabric-react/lib/Icon","react","./ShareLinkDescription.scss"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=r.FileShareIconMap[this.props.permissionsType],t=this.props.iconUrl?o.createElement("img",{"aria-hidden":"true",className:"od-ShareLinkDescription-image",src:this.props.iconUrl,alt:this.props.label}):o.createElement(s.Icon,{"aria-hidden":"true",iconName:e});return o.createElement("div",{className:"od-ShareLinkDescription"},o.createElement("div",{className:"od-ShareLinkDescription-icon icon-"+e,"aria-hidden":"true"},t),this._renderLabel())};t.prototype._renderLabel=function(){var e=this.props.infoButtonMessage,t=e?o.createElement(i.InfoButton,{message:e}):"";if(this.props.showLabel)return o.createElement("div",{className:"od-ShareLinkDescription-label"},this.props.label,t)};return t}(o.Component);t.ShareLinkDescription=u});
define("@ms/odsp-shared-sharing/lib/data/Icons/FileShareIconMap",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;t.FileShareIconMap=((n={})[0]="Globe",n[3]="Lock",n[2]="PeopleAdd",n[1]="Work",n[4]="SecurityGroup",n[5]="Chat",n[6]="Mail",n)});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/AudienceChoiceGroup/InfoButton/InfoButton",["require","exports","tslib","office-ui-fabric-react/lib/Callout","office-ui-fabric-react/lib/Icon","react","prop-types","./InfoButton.scss"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._onShowCallout=function(){i.setState(n.__assign({},i.state,{isCalloutVisible:!0}))};i._onDismissCallout=function(){i.setState(n.__assign({},i.state,{isCalloutVisible:!1}))};i._onInfoButton=function(e){i._infoButton=e};i.state={isCalloutVisible:!1};return i}t.prototype.render=function(){var e=this.props,t=this.state;return s.createElement("div",null,s.createElement("div",{className:"od-InfoButton-button",onClick:this._onShowCallout,ref:this._onInfoButton},s.createElement(i.Icon,{iconName:"Info",className:"od-InfoButton-infoIcon",onMouseOver:this._onShowCallout,onMouseLeave:this._onDismissCallout})),t.isCalloutVisible&&s.createElement(r.Callout,{directionalHint:r.DirectionalHint.topCenter,gapSpace:2,onDismiss:this._onDismissCallout,target:this._infoButton,setInitialFocus:!0},s.createElement("div",{className:"od-InfoButton-content"},s.createElement("span",{className:"od-InfoButton-message"},e.message))))};t.contextTypes={strings:o.object.isRequired};return t}(s.Component);t.InfoButton=u});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/AudienceChoiceGroup/InfoButton/InfoButton.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-InfoButton-infoIcon{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";padding:5px 4px 4px 4px;font-size:12px}.od-InfoButton-button{background:0 0;border:none;padding:0}.od-InfoButton-content{font-size:12px;font-weight:400;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:10px;width:250px}"}])});
define("@ms/odsp-shared-sharing/lib/components/ShareLinkDescription/ShareLinkDescription.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareLinkDescription{-webkit-box-align:top;-ms-flex-align:top;align-items:top;display:-webkit-box;display:-ms-flexbox;display:flex;padding:6px 0 2px 0;width:100%}.isFluent .od-ShareLinkDescription{padding:4px 0}.od-ShareLinkDescription-label{font-size:14px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";display:-webkit-box;display:-ms-flexbox;display:flex;overflow:hidden;text-overflow:ellipsis;vertical-align:top;font:-apple-system-subheadline;width:80%;padding-top:2px}[dir=ltr] .od-ShareLinkDescription-label{margin-left:8px}[dir=rtl] .od-ShareLinkDescription-label{margin-right:8px}[dir=ltr] .od-ShareLinkDescription-label{text-align:left}[dir=rtl] .od-ShareLinkDescription-label{text-align:right}.isFluent .od-ShareLinkDescription-label{padding-top:0;position:relative;top:2px}.od-ShareLinkDescription-image{width:16px;height:16px}.od-ShareLinkDescription-icon{-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-radius:50%;border-style:solid;border-width:1px;-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-ms-flexbox;display:flex;height:24px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;width:24px}.isFluent .od-ShareLinkDescription-icon{font-size:14px}.od-ShareLinkDescription-icon .ms-Icon{font-size:14px}.od-ShareLinkDescription-icon.icon-PeopleAdd{color:#393939;background:#f2f2f2;border:1px solid #393939}.od-ShareLinkDescription-icon.icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c}.od-ShareLinkDescription-icon.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-ShareLinkDescription-icon.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-ShareLinkDescription-icon.icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b}.od-ShareLinkDescription-icon.icon-SecurityGroup{color:#8e562e;background:#f4efeb;border:1px solid #8e562e}.od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);color:"},{theme:"orangeLight",defaultValue:"#ea4300"},{rawString:";position:relative;display:inline-block;border-radius:50%;width:24px;height:24px;border:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}[dir=ltr] .od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{padding-right:10px}[dir=rtl] .od-ShareLinkDescription-icon .ms-Icon--PeopleAdd{padding-left:10px}"}])});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/AudienceChoiceGroup/AudienceChoiceGroup.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}[dir=ltr] .teams .od-AudienceChoiceGroup-row{padding-left:0}[dir=rtl] .teams .od-AudienceChoiceGroup-row{padding-right:0}.teams .od-AudienceChoiceGroup-row.is-selected .od-ShareLinkDescription-label{font-weight:700}.od-AudienceChoiceGroup-row{background:0 0;border:none;cursor:pointer;margin-top:4px;width:90%;font:-apple-system-caption1}.isFluent .od-AudienceChoiceGroup-row{padding:0;width:calc(100% - 24px)}.od-AudienceChoiceGroup-row.is-selected .od-ShareLinkDescription-label{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";font-weight:600}.od-AudienceChoiceGroup-row.is-selected .tickIcon::after{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";content:'\\e73e';font-family:FabricMDL2Icons;font-size:16px;margin-top:8px}[dir=ltr] .od-AudienceChoiceGroup-row.is-selected .tickIcon::after{float:right}[dir=rtl] .od-AudienceChoiceGroup-row.is-selected .tickIcon::after{float:left}.isFluent .od-AudienceChoiceGroup-row.is-selected .tickIcon::after{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:12px;margin-top:10px}.od-AudienceChoiceGroup-row.is-disabled .od-ShareLinkDescription-label{color:#a19f9d}.od-AudienceChoiceGroup-row.is-disabled .od-ShareLinkDescription-icon{color:#a19f9d;background-color:#fafaf9;border-color:#a19f9d}@media screen and (-ms-high-contrast:active){.od-AudienceChoiceGroup-row{outline:1px solid transparent}}@media screen and (-ms-high-contrast:black-on-white){.od-AudienceChoiceGroup-row{outline:1px solid transparent}}.ms-Fabric.is-focusVisible .od-AudienceChoiceGroup-row:focus{-webkit-box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset;box-shadow:0 0 0 1px "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:" inset}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-AudienceChoiceGroup-row:focus{-webkit-box-shadow:0 0 0 1px #1aebff inset;box-shadow:0 0 0 1px #1aebff inset}}@media screen and (-ms-high-contrast:black-on-white){.ms-Fabric.is-focusVisible .od-AudienceChoiceGroup-row:focus{-webkit-box-shadow:0 0 0 1px #37006e inset;box-shadow:0 0 0 1px #37006e inset}}.od-AudienceChoiceGroup-bottomBorder{border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.isFluent .od-AudienceChoiceGroup-bottomBorder{border-bottom:0}.teams .od-AudienceChoiceGroup-bottomBorder{border-bottom:0}.od-AudienceChoiceGroup-description{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;overflow:hidden;width:90%}[dir=ltr] .od-AudienceChoiceGroup-description{float:left}[dir=rtl] .od-AudienceChoiceGroup-description{float:right}"}])});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/ExpirationDatePicker/ExpirationDatePicker",["require","exports","tslib","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/DatePicker","office-ui-fabric-react/lib/Icon","../../../utilities/ShareHelper","../../Share.resx","react","office-ui-fabric-react/lib/Tooltip","@ms/odsp-utilities/lib/string/StringHelper","prop-types","../../../utilities/ClientIdHelper","./ExpirationDatePicker.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=i.DatePicker,d=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._onSelectDateForExpirationPicker=function(e){r._expirationDateRemoved=!1;var t=e<new Date(Date.now());r._platformDetection.isIE||r._datePicker.focus();r.setState({hasExpired:t,selectedDate:e});r.props.onSelectDate(e)};r._onDeleteDate=function(){r._expirationDateRemoved=!0;r.setState({selectedDate:null},function(){r.props.onSelectDate(null)})};r._formatDate=function(e){if(e){var t=e.getDay(),n=e.getMonth();return r._datePickerStrings.days[t]+" "+r._datePickerStrings.shortMonths[n]+" "+e.getDate()+" "+e.getFullYear()}return""};var i=r.props.value<new Date(Date.now());r.state={hasExpired:i,selectedDate:null};r._platformDetection=n.platformDetection;var s=new Date(Date.now());r._minDate=new Date(s.getFullYear(),s.getMonth(),s.getDate()+1,s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds());t.expiryRestriction>0?r._maxDate=new Date(s.getFullYear(),s.getMonth(),s.getDate()+t.expiryRestriction,s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()):r._maxDate=new Date(s.getFullYear()+2,s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds());r._isMobile=r._platformDetection.isMobile||h.isMobile(r.props.clientId);r._datePickerStrings={months:o.months,shortMonths:o.shortMonths,days:o.days,shortDays:o.shortDays,goToToday:u.default.goToToday,setExpirationDate:u.default.setExpirationDate,nextMonthAriaLabel:u.default.nextMonthAriaLabel,prevMonthAriaLabel:u.default.prevMonthAriaLabel,ariaLabel:r._formattedExpirationDateAriaLabel(),pickerAriaLabel:u.default.expirationDatePickerAriaLabel,closeButtonAriaLabel:r._isMobile&&u.default.calendarCloseButton||""};return r}t.prototype.render=function(){var e=this.props.value,t=e&&this.state.hasExpired;this._datePickerStrings.ariaLabel=this._formattedExpirationDateAriaLabel();return a.createElement("div",{className:"od-ExpirationDatePicker"+(t?" od-ExpirationDatePicker-expired":"")},a.createElement("div",{className:"od-ExpirationDatePicker-label"+(t?" od-ExpirationDatePicker-expired":"")},a.createElement(s.Icon,{"aria-hidden":"true",iconName:t?"EventDateMissed12":"Calendar"}),a.createElement("div",{className:"od-ExpirationDatePicker-hidden","aria-label":u.default.datePickerIconAlt},u.default.datePickerIconAlt)),a.createElement("div",{className:"od-ExpirationDatePicker-content"+(t?" od-ExpirationDatePicker-content-expired":"")},this._renderExpiresLabel(),a.createElement(p,{componentRef:this._resolveRef("_datePicker"),strings:this._datePickerStrings,placeholder:this._datePickerStrings.setExpirationDate,isMonthPickerVisible:!1,onSelectDate:this._onSelectDateForExpirationPicker,value:e,formatDate:this._formatDate,minDate:this._minDate,maxDate:this._maxDate,allowTextInput:this._platformDetection.isIE,ariaLabel:this._datePickerStrings.ariaLabel,pickerAriaLabel:this._datePickerStrings.pickerAriaLabel,showGoToToday:!1,showCloseButton:this._isMobile,allFocusable:!1,calloutProps:{preventDismissOnScroll:this._isMobile},disableAutoFocus:this.props.disableAutoFocus,tabIndex:this.props.tabIndex}),this._renderRemoveDateButton()),this._renderPremiumGleam())};t.prototype._renderExpiresLabel=function(){if(this.props.value){var e="od-ExpirationDate-expiresLabel"+(this._platformDetection.isIE?" od-ExpirationDate-expiresLabelIE":"");return a.createElement("span",{className:e,role:"alert","aria-live":"assertive"},this.state.hasExpired?u.default.expired:u.default.expires)}};t.prototype._renderRemoveDateButton=function(){var e=this.state.selectedDate;if(!this.props.hideRemoveDateButton){if(this.props.expiryRestriction>0){var t=l.format(u.default.expirationDateToolTip,this.props.expiryRestriction);return a.createElement("div",{className:"od-ExpirationDatePicker-info","aria-label":t},a.createElement(f.TooltipHost,{id:"od-ExpirationDatePicker-tooltip-id",hostClassName:"od-ExpirationDatePicker-tooltip",content:t,directionalHint:f.DirectionalHint.topCenter,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},a.createElement("div",{tabIndex:0,className:"od-ExpirationDatePicker-tooltipWrapper",role:"note"},a.createElement(s.Icon,{iconName:"Info",className:"ms-Icon ms-Icon--Info"}))))}return a.createElement(f.TooltipHost,{content:u.default.removeExpirationLabel,id:"expirationDateRemovedButton",calloutProps:{gapSpace:0}},a.createElement("button",{className:"od-ExpirationDatePicker-delete",onClick:this._onDeleteDate,disabled:!e,"aria-label":u.default.removeExpirationLabel},a.createElement(s.Icon,{iconName:"Cancel",role:"alert","aria-live":"assertive","aria-label":this._expirationDateRemoved?u.default.expirationDateRemoved:u.default.removeExpirationLabel})))}};t.prototype._formattedExpirationDateAriaLabel=function(){return this.state.selectedDate?l.format(u.default.expirationDateValueAriaLabel,""):this._platformDetection.isIOS?u.default.setExpirationDate:""};t.prototype._renderPremiumGleam=function(){return this.props.showGleam?a.createElement("img",{role:"presentation",src:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/gleam.svg",className:"od-ExpirationDatePicker-premiumGleam"}):void 0};t.contextTypes={platformDetection:c.object.isRequired};return t}(r.BaseComponent);t.ExpirationDatePicker=d});
define("office-ui-fabric-react/lib/DatePicker",["require","exports","tslib","./components/DatePicker/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("office-ui-fabric-react/lib/components/DatePicker/index",["require","exports","tslib","./DatePicker","./DatePicker.base","../Calendar/Calendar.types"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t)});
define("office-ui-fabric-react/lib/components/DatePicker/DatePicker",["require","exports","../../Utilities","./DatePicker.base","./DatePicker.styles"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DatePicker=n.styled(r.DatePickerBase,i.styles,void 0,{scope:"DatePicker"})});
define("office-ui-fabric-react/lib/components/DatePicker/DatePicker.base",["require","exports","tslib","react","../../Utilities","../../Calendar","../../utilities/dateValues/DateValues","../../Callout","../../common/DirectionalHint","../../TextField","../../utilities/dateMath/DateMath","../../FocusTrapZone"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=i.classNamesFunction(),p={months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["S","M","T","W","T","F","S"],goToToday:"Go to today",prevMonthAriaLabel:"Go to previous month",nextMonthAriaLabel:"Go to next month",prevYearAriaLabel:"Go to previous year",nextYearAriaLabel:"Go to next year",prevYearRangeAriaLabel:"Previous year range",nextYearRangeAriaLabel:"Next year range",closeButtonAriaLabel:"Close date picker",weekNumberFormatString:"Week number {0}"},d=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._calendar=r.createRef();n._datePickerDiv=r.createRef();n._textField=r.createRef();n._onSelectDate=function(e){var t=n.props,r=t.formatDate,i=t.onSelectDate;n.props.calendarProps&&n.props.calendarProps.onSelectDate&&n.props.calendarProps.onSelectDate(e);n.setState({selectedDate:e,formattedDate:r&&e?r(e):""});i&&i(e);n._calendarDismissed()};n._onCalloutPositioned=function(){var e=!0;n.props.calloutProps&&void 0!==n.props.calloutProps.setInitialFocus&&(e=n.props.calloutProps.setInitialFocus);n._calendar.current&&e&&n._calendar.current.focus()};n._onTextFieldFocus=function(e){n.props.disableAutoFocus||n.props.allowTextInput||(n._preventFocusOpeningPicker?n._preventFocusOpeningPicker=!1:n._showDatePickerPopup())};n._onTextFieldBlur=function(e){n._validateTextInput()};n._onTextFieldChanged=function(e,t){if(n.props.allowTextInput){n.state.isDatePickerShown&&n._dismissDatePickerPopup();var r=n.props,i=r.isRequired,s=r.value,o=r.strings;n.setState({errorMessage:i&&!s?o.isRequiredErrorMessage||" ":void 0,formattedDate:t})}};n._onTextFieldKeyDown=function(e){switch(e.which){case i.KeyCodes.enter:e.preventDefault();e.stopPropagation();if(n.state.isDatePickerShown)n.props.allowTextInput&&n._dismissDatePickerPopup();else{n._validateTextInput();n._showDatePickerPopup()}break;case i.KeyCodes.escape:n._handleEscKey(e)}};n._onTextFieldClick=function(e){n.state.isDatePickerShown||n.props.disabled?n.props.allowTextInput&&n.setState({isDatePickerShown:!1}):n._showDatePickerPopup()};n._onIconClick=function(e){e.stopPropagation();n._onTextFieldClick(e)};n._dismissDatePickerPopup=function(){n.state.isDatePickerShown&&n.setState({isDatePickerShown:!1},function(){n._validateTextInput()})};n._calendarDismissed=function(){n._preventFocusOpeningPicker=!0;n._dismissDatePickerPopup()};n._handleEscKey=function(e){n.state.isDatePickerShown&&e.stopPropagation();n._calendarDismissed()};n._validateTextInput=function(){var e=n.props,t=e.isRequired,r=e.allowTextInput,i=e.strings,s=e.parseDateFromString,o=e.onSelectDate,u=e.formatDate,a=e.minDate,f=e.maxDate,l=n.state.formattedDate;if(!n.state.isDatePickerShown)if(r){var c=null;if(l){if(n.state.selectedDate&&u&&u(n.state.selectedDate)===l)return;if(!(c=s(l))||isNaN(c.getTime())){if(u){c=n.state.selectedDate;n.setState({formattedDate:u(c).toString()})}n.setState({errorMessage:i.invalidInputErrorMessage||" "})}else if(n._isDateOutOfBounds(c,a,f))n.setState({errorMessage:i.isOutOfBoundsErrorMessage||" "});else{n.setState({selectedDate:c,errorMessage:""});u&&u(c)!==l&&n.setState({formattedDate:u(c).toString()})}}else n.setState({errorMessage:t?i.isRequiredErrorMessage||" ":""});o&&o(c)}else t&&!l&&n.setState({errorMessage:i.isRequiredErrorMessage||" "})};n.state=n._getDefaultState();n._id=t.id||i.getId("DatePicker");n._preventFocusOpeningPicker=!1;return n}t.prototype.componentWillReceiveProps=function(e){var t=e.formatDate,n=e.value;if(!(l.compareDates(this.props.minDate,e.minDate)&&l.compareDates(this.props.maxDate,e.maxDate)&&this.props.isRequired===e.isRequired&&l.compareDates(this.state.selectedDate,n)&&this.props.formatDate===t)){this._setErrorMessage(!0,e);this._id=e.id||this._id;var r=this.state.selectedDate;l.compareDates(r,n)&&this.props.formatDate===t||this.setState({selectedDate:n||void 0,formattedDate:t&&n?t(n):""})}};t.prototype.componentDidUpdate=function(e,t){t.isDatePickerShown&&!this.state.isDatePickerShown&&this.props.onAfterMenuDismiss&&this.props.onAfterMenuDismiss()};t.prototype.render=function(){var e=this.props,t=e.firstDayOfWeek,o=e.strings,l=e.label,p=e.theme,d=e.className,v=e.styles,m=e.initialPickerDate,g=e.isRequired,y=e.disabled,b=e.ariaLabel,w=e.pickerAriaLabel,E=e.placeholder,S=e.allowTextInput,x=e.borderless,T=e.minDate,N=e.maxDate,C=e.showCloseButton,k=e.calendarProps,L=e.calloutProps,A=e.textField,O=e.underlined,M=e.allFocusable,_=e.calendarAs,D=void 0===_?s.Calendar:_,P=e.tabIndex,H=this.state,B=H.isDatePickerShown,j=H.formattedDate,F=H.selectedDate,I=h(v,{theme:p,className:d,disabled:y,label:!!l,isDatePickerShown:B}),q=i.getId("DatePicker-Callout"),R=i.getNativeProps(this.props,i.divProperties,["value"]),U=A&&A.iconProps;return r.createElement("div",n.__assign({},R,{className:I.root}),r.createElement("div",{ref:this._datePickerDiv,role:"combobox","aria-expanded":B,"aria-haspopup":"true","aria-owns":B?q:void 0},r.createElement(f.TextField,n.__assign({label:l,ariaLabel:b,"aria-controls":B?q:void 0,required:g,disabled:y,errorMessage:this._getErrorMessage(),placeholder:E,borderless:x,value:j,componentRef:this._textField,underlined:O,tabIndex:P,readOnly:!S},A,{id:this._id+"-label",className:i.css(I.textField,A&&A.className),iconProps:n.__assign({iconName:"Calendar"},U,{className:i.css(I.icon,U&&U.className),onClick:this._onIconClick}),onKeyDown:this._onTextFieldKeyDown,onFocus:this._onTextFieldFocus,onBlur:this._onTextFieldBlur,onClick:this._onTextFieldClick,onChange:this._onTextFieldChanged}))),B&&r.createElement(u.Callout,n.__assign({id:q,role:"dialog",ariaLabel:w,isBeakVisible:!1,gapSpace:0,doNotLayer:!1,target:this._datePickerDiv.current,directionalHint:a.DirectionalHint.bottomLeftEdge},L,{className:i.css(I.callout,L&&L.className),onDismiss:this._calendarDismissed,onPositioned:this._onCalloutPositioned}),r.createElement(c.FocusTrapZone,{isClickableOutsideFocusTrap:!0,disableFirstFocus:this.props.disableAutoFocus,forceFocusInsideTrap:!1},r.createElement(D,n.__assign({},k,{onSelectDate:this._onSelectDate,onDismiss:this._calendarDismissed,isMonthPickerVisible:this.props.isMonthPickerVisible,showMonthPickerAsOverlay:this.props.showMonthPickerAsOverlay,today:this.props.today,value:F||m,firstDayOfWeek:t,strings:o,highlightCurrentMonth:this.props.highlightCurrentMonth,highlightSelectedMonth:this.props.highlightSelectedMonth,showWeekNumbers:this.props.showWeekNumbers,firstWeekOfYear:this.props.firstWeekOfYear,showGoToToday:this.props.showGoToToday,dateTimeFormatter:this.props.dateTimeFormatter,minDate:T,maxDate:N,componentRef:this._calendar,showCloseButton:C,allFocusable:M})))))};t.prototype.focus=function(){this._textField.current&&this._textField.current.focus()};t.prototype.reset=function(){this.setState(this._getDefaultState())};t.prototype._setErrorMessage=function(e,t){var n=t||this.props,r=n.isRequired,i=n.strings,s=n.value,o=n.minDate,u=n.maxDate,a=n.initialPickerDate||!r||s?void 0:i.isRequiredErrorMessage||" ";!a&&s&&(a=this._isDateOutOfBounds(s,o,u)?i.isOutOfBoundsErrorMessage||" ":void 0);e&&this.setState({errorMessage:a});return a};t.prototype._showDatePickerPopup=function(){if(!this.state.isDatePickerShown){this._preventFocusOpeningPicker=!0;this.setState({isDatePickerShown:!0})}};t.prototype._getDefaultState=function(e){void 0===e&&(e=this.props);return{selectedDate:e.value||void 0,formattedDate:e.formatDate&&e.value?e.formatDate(e.value):"",isDatePickerShown:!1,errorMessage:this._setErrorMessage(!1)}};t.prototype._isDateOutOfBounds=function(e,t,n){return!!t&&l.compareDatePart(t,e)>0||!!n&&l.compareDatePart(n,e)<0};t.prototype._getErrorMessage=function(){if(!this.state.isDatePickerShown)return this.state.errorMessage};t.defaultProps={allowTextInput:!1,formatDate:function(e){return e?e.toDateString():""},parseDateFromString:function(e){var t=Date.parse(e);return t?new Date(t):null},firstDayOfWeek:s.DayOfWeek.Sunday,initialPickerDate:new Date,isRequired:!1,isMonthPickerVisible:!0,showMonthPickerAsOverlay:!1,strings:p,highlightCurrentMonth:!1,highlightSelectedMonth:!1,borderless:!1,pickerAriaLabel:"Calendar",showWeekNumbers:!1,firstWeekOfYear:o.FirstWeekOfYear.FirstDay,showGoToToday:!0,dateTimeFormatter:void 0,showCloseButton:!1,underlined:!1,allFocusable:!1};return t}(i.BaseComponent);t.DatePickerBase=d});
define("office-ui-fabric-react/lib/Calendar",["require","exports","tslib","./components/Calendar/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("office-ui-fabric-react/lib/components/Calendar/index",["require","exports","tslib","./Calendar","./Calendar.types"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("office-ui-fabric-react/lib/components/Calendar/Calendar",["require","exports","tslib","react","../../utilities/dateValues/DateValues","./CalendarDay","./CalendarMonth","../../utilities/dateMath/DateMath","../../Utilities","./Calendar.scss"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=f,c={leftNavigation:"Up",rightNavigation:"Down",closeIcon:"CalculatorMultiply"},h=[i.DayOfWeek.Monday,i.DayOfWeek.Tuesday,i.DayOfWeek.Wednesday,i.DayOfWeek.Thursday,i.DayOfWeek.Friday],p={formatMonthDayYear:function(e,t){return t.months[e.getMonth()]+" "+e.getDate()+", "+e.getFullYear()},formatMonthYear:function(e,t){return t.months[e.getMonth()]+" "+e.getFullYear()},formatDay:function(e){return e.getDate().toString()},formatYear:function(e){return e.getFullYear().toString()}},d=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._dayPicker=r.createRef();n._monthPicker=r.createRef();n._navigateDayPickerDay=function(e){n.setState({navigatedDayDate:e,navigatedMonthDate:e})};n._navigateMonthPickerDay=function(e){n.setState({navigatedMonthDate:e})};n._onNavigateDayDate=function(e,t){n._navigateDayPickerDay(e);n._focusOnUpdate=t};n._onNavigateMonthDate=function(e,t){if(t){!n.props.showMonthPickerAsOverlay&&!n.props.isDayPickerVisible&&n._onSelectDate(e);n._navigateDayPickerDay(e)}else{n._navigateMonthPickerDay(e);n._focusOnUpdate=t}};n._onSelectDate=function(e,t){var r=n.props.onSelectDate;n.setState({selectedDate:e});r&&r(e,t)};n._onHeaderSelect=function(e){n.setState({isDayPickerVisible:!n.state.isDayPickerVisible,isMonthPickerVisible:!n.state.isMonthPickerVisible});e&&(n._focusOnUpdate=!0)};n._onGotoToday=function(){var e=n.props,t=e.dateRangeType,r=e.firstDayOfWeek,i=e.today,s=e.workWeekDays;if(e.selectDateOnClick){var o=u.getDateRangeArray(i,t,r,s);n._onSelectDate(i,o)}n._navigateDayPickerDay(i);n._focusOnUpdate=!0};n._onGotoTodayClick=function(e){n._onGotoToday()};n._onGotoTodayKeyDown=function(e){if(e.which===a.KeyCodes.enter){e.preventDefault();n._onGotoToday()}};n._onDatePickerPopupKeyDown=function(e){switch(e.which){case a.KeyCodes.enter:case a.KeyCodes.backspace:e.preventDefault();break;case a.KeyCodes.escape:n._handleEscKey(e)}};n._handleEscKey=function(e){n.props.onDismiss&&n.props.onDismiss()};var i=t.value&&!isNaN(t.value.getTime())?t.value:t.today||new Date;n.state={selectedDate:i,navigatedDayDate:i,navigatedMonthDate:i,isMonthPickerVisible:!n.props.showMonthPickerAsOverlay&&n.props.isMonthPickerVisible,isDayPickerVisible:!!n.props.showMonthPickerAsOverlay||n.props.isDayPickerVisible};n._focusOnUpdate=!1;return n}t.prototype.componentWillReceiveProps=function(e){var t=e.autoNavigateOnSelection,n=e.value,r=e.today,i=void 0===r?new Date:r;t&&!u.compareDates(n,this.props.value)&&this.setState({navigatedMonthDate:n,navigatedDayDate:n});this.setState({selectedDate:n||i})};t.prototype.componentDidUpdate=function(){if(this._focusOnUpdate){this.focus();this._focusOnUpdate=!1}};t.prototype.render=function(){var e,t=this.props,i=t.firstDayOfWeek,u=t.dateRangeType,f=t.strings,c=t.showMonthPickerAsOverlay,h=t.autoNavigateOnSelection,p=t.showGoToToday,d=t.highlightCurrentMonth,v=t.highlightSelectedMonth,m=t.navigationIcons,g=t.minDate,y=t.maxDate,b=t.restrictedDates,w=t.className,E=t.showCloseButton,S=t.allFocusable,x=t.yearPickerHidden,T=t.today,N=a.getNativeProps(this.props,a.divProperties,["value"]),C=this.state,k=C.selectedDate,L=C.navigatedDayDate,A=C.navigatedMonthDate,O=C.isMonthPickerVisible,M=C.isDayPickerVisible,_=c?this._onHeaderSelect:void 0,D=!c&&!M,P=c&&p,H=p;H&&L&&A&&T&&(H=L.getFullYear()!==T.getFullYear()||L.getMonth()!==T.getMonth()||A.getFullYear()!==T.getFullYear()||A.getMonth()!==T.getMonth());return r.createElement("div",{className:a.css("ms-DatePicker",l.root,w),role:"application"},r.createElement("div",n.__assign({},N,{className:a.css("ms-DatePicker-picker ms-DatePicker-picker--opened ms-DatePicker-picker--focused",l.picker,l.pickerIsOpened,l.pickerIsFocused,O&&"ms-DatePicker-monthPickerVisible "+l.monthPickerVisible,O&&M&&"ms-DatePicker-calendarsInline "+l.calendarsInline,D&&"ms-DatePicker-monthPickerOnly "+l.monthPickerOnly,c&&"ms-DatePicker-monthPickerAsOverlay "+l.monthPickerAsOverlay)}),r.createElement("div",{className:a.css("ms-DatePicker-holder ms-slideDownIn10",l.holder,P&&l.holderWithButton),onKeyDown:this._onDatePickerPopupKeyDown},r.createElement("div",{className:a.css("ms-DatePicker-frame",l.frame)},r.createElement("div",{className:a.css("ms-DatePicker-wrap",l.wrap,p&&l.goTodaySpacing)},M&&r.createElement(s.CalendarDay,{selectedDate:k,navigatedDate:L,today:this.props.today,onSelectDate:this._onSelectDate,onNavigateDate:this._onNavigateDayDate,onDismiss:this.props.onDismiss,firstDayOfWeek:i,dateRangeType:u,autoNavigateOnSelection:h,strings:f,onHeaderSelect:_,navigationIcons:m,showWeekNumbers:this.props.showWeekNumbers,firstWeekOfYear:this.props.firstWeekOfYear,dateTimeFormatter:this.props.dateTimeFormatter,showSixWeeksByDefault:this.props.showSixWeeksByDefault,minDate:g,maxDate:y,restrictedDates:b,workWeekDays:this.props.workWeekDays,componentRef:this._dayPicker,showCloseButton:E,allFocusable:S}),M&&O&&r.createElement("div",{className:l.divider}),O&&r.createElement(o.CalendarMonth,{navigatedDate:A,selectedDate:L,strings:f,onNavigateDate:this._onNavigateMonthDate,today:this.props.today,highlightCurrentMonth:d,highlightSelectedMonth:v,onHeaderSelect:_,navigationIcons:m,dateTimeFormatter:this.props.dateTimeFormatter,minDate:g,maxDate:y,componentRef:this._monthPicker,yearPickerHidden:x||c}),p&&r.createElement("button",{role:"button",className:a.css("ms-DatePicker-goToday js-goToday",l.goToday,(e={},e[l.goTodayInlineMonth]=O,e[l.goToTodayIsDisabled]=!H,e)),onClick:this._onGotoTodayClick,onKeyDown:this._onGotoTodayKeyDown,tabIndex:0,disabled:!H,type:"button"},f.goToToday))))))};t.prototype.focus=function(){this.state.isDayPickerVisible&&this._dayPicker.current?this._dayPicker.current.focus():this.state.isMonthPickerVisible&&this._monthPicker.current&&this._monthPicker.current.focus()};t.defaultProps={onSelectDate:void 0,onDismiss:void 0,isMonthPickerVisible:!0,isDayPickerVisible:!0,showMonthPickerAsOverlay:!1,value:void 0,today:new Date,firstDayOfWeek:i.DayOfWeek.Sunday,dateRangeType:i.DateRangeType.Day,autoNavigateOnSelection:!1,showGoToToday:!0,strings:null,highlightCurrentMonth:!1,highlightSelectedMonth:!1,navigationIcons:c,showWeekNumbers:!1,firstWeekOfYear:i.FirstWeekOfYear.FirstDay,dateTimeFormatter:p,showSixWeeksByDefault:!1,workWeekDays:h,showCloseButton:!1,allFocusable:!1};return t}(a.BaseComponent);t.Calendar=d});
define("office-ui-fabric-react/lib/utilities/dateValues/DateValues",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Sunday=0]="Sunday";e[e.Monday=1]="Monday";e[e.Tuesday=2]="Tuesday";e[e.Wednesday=3]="Wednesday";e[e.Thursday=4]="Thursday";e[e.Friday=5]="Friday";e[e.Saturday=6]="Saturday"}(t.DayOfWeek||(t.DayOfWeek={}));!function(e){e[e.January=0]="January";e[e.February=1]="February";e[e.March=2]="March";e[e.April=3]="April";e[e.May=4]="May";e[e.June=5]="June";e[e.July=6]="July";e[e.August=7]="August";e[e.September=8]="September";e[e.October=9]="October";e[e.November=10]="November";e[e.December=11]="December"}(t.MonthOfYear||(t.MonthOfYear={}));!function(e){e[e.FirstDay=0]="FirstDay";e[e.FirstFullWeek=1]="FirstFullWeek";e[e.FirstFourDayWeek=2]="FirstFourDayWeek"}(t.FirstWeekOfYear||(t.FirstWeekOfYear={}));!function(e){e[e.Day=0]="Day";e[e.Week=1]="Week";e[e.Month=2]="Month";e[e.WorkWeek=3]="WorkWeek"}(t.DateRangeType||(t.DateRangeType={}))});
define("office-ui-fabric-react/lib/components/Calendar/CalendarDay",["require","exports","tslib","react","../../Utilities","../../utilities/dateValues/DateValues","../../FocusZone","../../Icon","../../utilities/dateMath/DateMath","./Calendar.scss"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=f,c=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.days={};n._onKeyDown=function(e,t){t.which!==i.KeyCodes.enter&&t.which!==i.KeyCodes.space||e()};n._onDayKeyDown=function(e,t,r){return function(s){s.which===i.KeyCodes.enter?n._onSelectDate(e,s):n._navigateMonthEdge(s,e,t,r)}};n._onDayMouseDown=function(e,t,r,i){return function(r){i===s.DateRangeType.Month?n._applyFunctionToDayRefs(function(t,n){t&&n.originalDate.getMonth()===e.getMonth()&&n.isInBounds&&t.classList.add(l.dayPress)}):n._applyFunctionToDayRefs(function(e,n,r){if(e&&r===t&&n.isInBounds){e.classList.add(l.dayPress);e.classList.add(l.dayIsHighlighted)}else e&&e.classList.remove(l.dayIsHighlighted)})}};n._onDayMouseUp=function(e,t,r,i){return function(r){i===s.DateRangeType.Month?n._applyFunctionToDayRefs(function(t,n){t&&n.originalDate.getMonth()===e.getMonth()&&n.isInBounds&&t.classList.remove(l.dayPress)}):n._applyFunctionToDayRefs(function(e,n,r){e&&r===t&&n.isInBounds&&e.classList.remove(l.dayPress)})}};n._onDayMouseOver=function(e,t,r,i){return function(r){i===s.DateRangeType.Month?n._applyFunctionToDayRefs(function(t,n){t&&n.originalDate.getMonth()===e.getMonth()&&n.isInBounds&&t.classList.add(l.dayHover)}):n._applyFunctionToDayRefs(function(e,n,r){e&&r===t&&n.isInBounds&&e.classList.add(l.dayHover)})}};n._onDayMouseLeave=function(e,t,r,i){return function(r){i===s.DateRangeType.Month?n._applyFunctionToDayRefs(function(t,n){t&&n.originalDate.getMonth()===e.getMonth()&&n.isInBounds&&t.classList.remove(l.dayHover)}):n._applyFunctionToDayRefs(function(e,n,r){e&&r===t&&n.isInBounds&&e.classList.remove(l.dayHover)})}};n._onTableMouseLeave=function(e){e.target.contains&&e.relatedTarget&&e.relatedTarget.contains&&e.target.contains(e.relatedTarget)||n._applyFunctionToDayRefs(function(e,t){if(e){e.classList.remove(l.dayHover);e.classList.remove(l.dayPress)}})};n._onTableMouseUp=function(e){e.target.contains&&e.relatedTarget&&e.relatedTarget.contains&&e.target.contains(e.relatedTarget)||n._applyFunctionToDayRefs(function(e,t){e&&e.classList.remove(l.dayPress)})};n._onSelectDate=function(e,t){var r=n.props,i=r.onSelectDate,o=r.dateRangeType,u=r.firstDayOfWeek,f=r.navigatedDate,l=r.autoNavigateOnSelection,c=r.minDate,h=r.maxDate,p=r.workWeekDays;t&&t.stopPropagation();var d=a.getDateRangeArray(e,o,u,p);o!==s.DateRangeType.Day&&(d=n._getBoundedDateRange(d,c,h));d=d.filter(function(e){return!n._getIsRestrictedDate(e)});i&&i(e,d);if(l&&e.getMonth()!==f.getMonth()){var v=a.compareDatePart(e,f);v<0?n._onSelectPrevMonth():v>0&&n._onSelectNextMonth()}};n._onSelectNextMonth=function(){n.props.onNavigateDate(a.addMonths(n.props.navigatedDate,1),!1)};n._onSelectPrevMonth=function(){n.props.onNavigateDate(a.addMonths(n.props.navigatedDate,-1),!1)};n._onClose=function(){n.props.onDismiss&&n.props.onDismiss()};n._onHeaderSelect=function(){var e=n.props.onHeaderSelect;e&&e(!0)};n._onHeaderKeyDown=function(e){var t=n.props.onHeaderSelect;!t||e.which!==i.KeyCodes.enter&&e.which!==i.KeyCodes.space||t(!0)};n._onPrevMonthKeyDown=function(e){e.which===i.KeyCodes.enter&&n._onKeyDown(n._onSelectPrevMonth,e)};n._onNextMonthKeyDown=function(e){e.which===i.KeyCodes.enter&&n._onKeyDown(n._onSelectNextMonth,e)};n._onCloseButtonKeyDown=function(e){e.which===i.KeyCodes.enter&&n._onKeyDown(n._onClose,e)};n.state={activeDescendantId:i.getId("DatePickerDay-active"),weeks:n._getWeeks(t)};n._onSelectNextMonth=n._onSelectNextMonth.bind(n);n._onSelectPrevMonth=n._onSelectPrevMonth.bind(n);n._onClose=n._onClose.bind(n);return n}t.prototype.componentWillReceiveProps=function(e){this.setState({weeks:this._getWeeks(e)})};t.prototype.render=function(){var e,t,n=this,f=this.state,c=f.activeDescendantId,h=f.weeks,p=this.props,d=p.firstDayOfWeek,v=p.strings,m=p.navigatedDate,g=p.selectedDate,y=p.dateRangeType,b=p.navigationIcons,w=p.showWeekNumbers,E=p.firstWeekOfYear,S=p.dateTimeFormatter,x=p.minDate,T=p.maxDate,N=p.showCloseButton,C=p.allFocusable,k=i.getId("DatePickerDay-dayPicker"),L=i.getId("DatePickerDay-monthAndYear"),A=b.leftNavigation,O=b.rightNavigation,M=b.closeIcon,_=w?a.getWeekNumbersInMonth(h.length,d,E,m):null,D=w?a.getWeekNumber(g,d,E):void 0,P=this._getWeekCornerStyles(h,y),H=!x||a.compareDatePart(x,a.getMonthStart(m))<0,B=!T||a.compareDatePart(a.getMonthEnd(m),T)<0;return r.createElement("div",{className:i.css("ms-DatePicker-dayPicker",l.dayPicker,w&&(i.getRTL()?l.showWeekNumbersRTL:l.showWeekNumbers)),id:k},r.createElement("div",{className:i.css("ms-DatePicker-header",l.header)},r.createElement("div",{"aria-live":"polite","aria-relevant":"text","aria-atomic":"true",id:L,className:l.monthAndYear},this.props.onHeaderSelect?r.createElement("div",{className:i.css("ms-DatePicker-monthAndYear js-showMonthPicker",l.headerToggleView),onClick:this._onHeaderSelect,onKeyDown:this._onHeaderKeyDown,"aria-label":S.formatMonthYear(m,v),role:"button",tabIndex:0},S.formatMonthYear(m,v)):r.createElement("div",{className:i.css("ms-DatePicker-monthAndYear",l.monthAndYear)},S.formatMonthYear(m,v))),r.createElement("div",{className:i.css("ms-DatePicker-monthComponents",l.monthComponents)},r.createElement("div",{className:i.css("ms-DatePicker-navContainer",l.navContainer)},r.createElement("button",{className:i.css("ms-DatePicker-prevMonth js-prevMonth",l.prevMonth,(e={},e["ms-DatePicker-prevMonth--disabled "+l.prevMonthIsDisabled]=!H,e)),disabled:!C&&!H,"aria-disabled":!H,onClick:H?this._onSelectPrevMonth:void 0,onKeyDown:H?this._onPrevMonthKeyDown:void 0,"aria-controls":k,title:v.prevMonthAriaLabel?v.prevMonthAriaLabel+" "+v.months[a.addMonths(m,-1).getMonth()]:void 0,role:"button",type:"button"},r.createElement(u.Icon,{iconName:A})),r.createElement("button",{className:i.css("ms-DatePicker-nextMonth js-nextMonth",l.nextMonth,(t={},t["ms-DatePicker-nextMonth--disabled "+l.nextMonthIsDisabled]=!B,t)),disabled:!C&&!B,"aria-disabled":!B,onClick:B?this._onSelectNextMonth:void 0,onKeyDown:B?this._onNextMonthKeyDown:void 0,"aria-controls":k,title:v.nextMonthAriaLabel?v.nextMonthAriaLabel+" "+v.months[a.addMonths(m,1).getMonth()]:void 0,role:"button",type:"button"},r.createElement(u.Icon,{iconName:O})),N&&r.createElement("button",{className:i.css("ms-DatePicker-closeButton js-closeButton",l.closeButton),onClick:this._onClose,onKeyDown:this._onCloseButtonKeyDown,title:v.closeButtonAriaLabel,role:"button",type:"button"},r.createElement(u.Icon,{iconName:M}))))),r.createElement(o.FocusZone,null,r.createElement("table",{className:i.css("ms-DatePicker-table",l.table),"aria-readonly":"true","aria-multiselectable":"false","aria-labelledby":L,"aria-activedescendant":c,role:"grid"},r.createElement("thead",null,r.createElement("tr",null,w&&r.createElement("th",{className:i.css("ms-DatePicker-weekday",l.weekday)}),v.shortDays.map(function(e,t){return r.createElement("th",{className:i.css("ms-DatePicker-weekday",l.weekday),role:"columnheader",scope:"col",key:t,title:v.days[(t+d)%7],"aria-label":v.days[(t+d)%7],"data-is-focusable":!!C||void 0},v.shortDays[(t+d)%7])}))),r.createElement("tbody",{onMouseLeave:y!==s.DateRangeType.Day?this._onTableMouseLeave:void 0,onMouseUp:y!==s.DateRangeType.Day?this._onTableMouseUp:void 0},h.map(function(e,t){return r.createElement("tr",{key:_?_[t]:t},w&&_&&r.createElement("th",{className:i.css("ms-DatePicker-weekNumbers","ms-DatePicker-weekday",l.weekday,l.weekNumbers),key:t,title:_&&v.weekNumberFormatString&&i.format(v.weekNumberFormatString,_[t]),"aria-label":_&&v.weekNumberFormatString&&i.format(v.weekNumberFormatString,_[t]),scope:"row"},r.createElement("div",{className:i.css("ms-DatePicker-day",l.day,(o={},o["ms-DatePicker-week--highlighted "+l.weekIsHighlighted]=D===_[t],o))},r.createElement("span",null,_[t]))),e.map(function(e,o){var u,f,h=a.compareDates(m,e.originalDate);return r.createElement("td",{key:e.key,onClick:e.isInBounds?e.onSelected:void 0,className:i.css(l.dayWrapper,"ms-DatePicker-day",n._getHighlightedCornerStyle(P,o,t),(u={},u["ms-DatePicker-weekBackground "+l.weekBackground]=e.isSelected&&(y===s.DateRangeType.Week||y===s.DateRangeType.WorkWeek),u["ms-DatePicker-dayBackground "+l.dayBackground]=y===s.DateRangeType.Day,u["ms-DatePicker-day--highlighted "+l.dayIsHighlighted]=e.isSelected&&y===s.DateRangeType.Day,u["ms-DatePicker-day--infocus "+l.dayIsFocused]=e.isInBounds&&e.isInMonth,u["ms-DatePicker-day--outfocus "+l.dayIsUnfocused]=e.isInBounds&&!e.isInMonth,u[l.daySelection]=y===s.DateRangeType.Day,u[l.weekSelection]=y===s.DateRangeType.Week||y===s.DateRangeType.WorkWeek,u[l.monthSelection]=y===s.DateRangeType.Month,u)),ref:function(t){return n._setDayCellRef(t,e,h)},onMouseOver:y!==s.DateRangeType.Day&&e.isInBounds?n._onDayMouseOver(e.originalDate,t,o,y):void 0,onMouseLeave:y!==s.DateRangeType.Day&&e.isInBounds?n._onDayMouseLeave(e.originalDate,t,o,y):void 0,onMouseDown:y!==s.DateRangeType.Day&&e.isInBounds?n._onDayMouseDown(e.originalDate,t,o,y):void 0,onMouseUp:y!==s.DateRangeType.Day&&e.isInBounds?n._onDayMouseUp(e.originalDate,t,o,y):void 0,role:"gridcell"},r.createElement("button",{key:e.key+"button",onClick:e.isInBounds?e.onSelected:void 0,className:i.css(l.day,"ms-DatePicker-day-button",(f={},f["ms-DatePicker-day--disabled "+l.dayIsDisabled]=!e.isInBounds,f["ms-DatePicker-day--today "+l.dayIsToday]=e.isToday,f)),role:"gridcell",onKeyDown:n._onDayKeyDown(e.originalDate,t,o),"aria-label":S.formatMonthDayYear(e.originalDate,v),id:h?c:void 0,"aria-readonly":!0,"aria-selected":e.isInBounds?e.isSelected:void 0,"data-is-focusable":C||!!e.isInBounds||void 0,ref:function(t){return n._setDayRef(t,e,h)},disabled:!C&&!e.isInBounds,"aria-disabled":!e.isInBounds,type:"button"},r.createElement("span",{"aria-hidden":"true"},S.formatDay(e.originalDate))))}));var o})))))};t.prototype.focus=function(){if(this.navigatedDay){this.navigatedDay.tabIndex=0;this.navigatedDay.focus()}};t.prototype._setDayRef=function(e,t,n){n&&(this.navigatedDay=e)};t.prototype._setDayCellRef=function(e,t,n){this.days[t.key]=e};t.prototype._getWeekCornerStyles=function(e,t){var n=this,r={};switch(t){case s.DateRangeType.Month:e.forEach(function(t,n){t.forEach(function(t,s){var o=e[n-1]&&e[n-1][s]&&e[n-1][s].originalDate.getMonth()===e[n][s].originalDate.getMonth(),u=e[n+1]&&e[n+1][s]&&e[n+1][s].originalDate.getMonth()===e[n][s].originalDate.getMonth(),a=e[n][s-1]&&e[n][s-1].originalDate.getMonth()===e[n][s].originalDate.getMonth(),f=e[n][s+1]&&e[n][s+1].originalDate.getMonth()===e[n][s].originalDate.getMonth(),c=!o&&!f,h=!u&&!a,p=!u&&!f,d="";!o&&!a&&(d=i.getRTL()?d.concat(l.topRightCornerDate+" "):d.concat(l.topLeftCornerDate+" "));c&&(d=i.getRTL()?d.concat(l.topLeftCornerDate+" "):d.concat(l.topRightCornerDate+" "));h&&(d=i.getRTL()?d.concat(l.bottomRightCornerDate+" "):d.concat(l.bottomLeftCornerDate+" "));p&&(d=i.getRTL()?d.concat(l.bottomLeftCornerDate+" "):d.concat(l.bottomRightCornerDate+" "));o||(d=d.concat(l.topDate+" "));u||(d=d.concat(l.bottomDate+" "));f||(d=d.concat(l.rightDate+" "));a||(d=d.concat(l.leftdate+" "));r[n+"_"+s]=d})});break;case s.DateRangeType.Week:case s.DateRangeType.WorkWeek:e.forEach(function(e,t){var s=i.findIndex(e,function(e){return e.isInBounds}),o=n._findLastIndex(e,function(e){return e.isInBounds}),u=l.topLeftCornerDate+" "+l.bottomLeftCornerDate,a=l.topRightCornerDate+" "+l.bottomRightCornerDate;r[t+"_"+s]=i.getRTL()?a:u;r[t+"_"+o]=i.getRTL()?u:a})}return r};t.prototype._getHighlightedCornerStyle=function(e,t,n){return e[n+"_"+t]?e[n+"_"+t]:""};t.prototype._navigateMonthEdge=function(e,t,n,r){var s=this.props,o=s.minDate,u=s.maxDate,f=void 0;0===n&&e.which===i.KeyCodes.up?f=a.addWeeks(t,-1):n===this.state.weeks.length-1&&e.which===i.KeyCodes.down?f=a.addWeeks(t,1):0===r&&e.which===i.getRTLSafeKeyCode(i.KeyCodes.left)?f=a.addDays(t,-1):6===r&&e.which===i.getRTLSafeKeyCode(i.KeyCodes.right)&&(f=a.addDays(t,1));if(f&&(!o||a.compareDatePart(o,f)<1)&&(!u||a.compareDatePart(f,u)<1)){this.props.onNavigateDate(f,!0);e.preventDefault()}};t.prototype._applyFunctionToDayRefs=function(e){var t=this;this.state.weeks&&this.state.weeks.map(function(n,r){n.map(function(n){var i=t.days[n.key];e(i,n,r)})})};t.prototype._getWeeks=function(e){for(var t=e.navigatedDate,n=e.selectedDate,r=e.dateRangeType,i=e.firstDayOfWeek,o=e.today,u=e.minDate,f=e.maxDate,l=e.showSixWeeksByDefault,c=e.workWeekDays,h=new Date(t.getFullYear(),t.getMonth(),1),p=o||new Date,d=[];h.getDay()!==i;)h.setDate(h.getDate()-1);var v=!1,m=r===s.DateRangeType.WorkWeek?s.DateRangeType.Week:r,g=a.getDateRangeArray(n,m,i,c);r!==s.DateRangeType.Day&&(g=this._getBoundedDateRange(g,u,f));for(var y=!0,b=0;y;b++){var w=[];v=!0;for(var E=0;E<7;E++){var S=new Date(h.toString()),x={key:h.toString(),date:h.getDate().toString(),originalDate:S,isInMonth:h.getMonth()===t.getMonth(),isToday:a.compareDates(p,h),isSelected:a.isInDateRangeArray(h,g),onSelected:this._onSelectDate.bind(this,S),isInBounds:(!u||a.compareDatePart(u,h)<1)&&(!f||a.compareDatePart(h,f)<1)&&!this._getIsRestrictedDate(h)};w.push(x);x.isInMonth&&(v=!1);h.setDate(h.getDate()+1)}(y=l?!v||b<=5:!v)&&d.push(w)}return d};t.prototype._getIsRestrictedDate=function(e){var t=this.props.restrictedDates;return!!t&&!!i.find(t,function(t){return a.compareDates(t,e)})};t.prototype._getBoundedDateRange=function(e,t,n){var r=e.slice();t&&(r=r.filter(function(e){return a.compareDatePart(e,t)>=0}));n&&(r=r.filter(function(e){return a.compareDatePart(e,n)<=0}));return r};t.prototype._findLastIndex=function(e,t){for(var n=e.length-1;n>=0;n--){if(t(e[n]))return n}return-1};return t}(i.BaseComponent);t.CalendarDay=c});
define("office-ui-fabric-react/lib/utilities/dateMath/DateMath",["require","exports","../dateValues/DateValues","../dateValues/TimeConstants","../../Utilities"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t){var n=new Date(e.getTime());n.setDate(n.getDate()+t);return n}t.addDays=s;t.addWeeks=function(e,t){return s(e,t*r.default.DaysInOneWeek)};function o(e,t){var n=new Date(e.getTime()),i=n.getMonth()+t;n.setMonth(i);n.getMonth()!==(i%r.default.MonthInOneYear+r.default.MonthInOneYear)%r.default.MonthInOneYear&&(n=s(n,-n.getDate()));return n}t.addMonths=o;t.addYears=function(e,t){var n=new Date(e.getTime());n.setFullYear(e.getFullYear()+t);n.getMonth()!==(e.getMonth()%r.default.MonthInOneYear+r.default.MonthInOneYear)%r.default.MonthInOneYear&&(n=s(n,-n.getDate()));return n};t.getMonthStart=function(e){return new Date(e.getFullYear(),e.getMonth(),1,0,0,0,0)};t.getMonthEnd=function(e){return new Date(e.getFullYear(),e.getMonth()+1,0,0,0,0,0)};t.getYearStart=function(e){return new Date(e.getFullYear(),0,1,0,0,0,0)};t.getYearEnd=function(e){return new Date(e.getFullYear()+1,0,0,0,0,0,0)};t.setMonth=function(e,t){return o(e,t-e.getMonth())};function u(e,t){return!e&&!t||!(!e||!t)&&(e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate())}t.compareDates=u;t.compareDatePart=function(e,t){return l(e)-l(t)};t.getDateRangeArray=function(e,t,a,l){var c,h=new Array,p=null;l||(l=[n.DayOfWeek.Monday,n.DayOfWeek.Tuesday,n.DayOfWeek.Wednesday,n.DayOfWeek.Thursday,n.DayOfWeek.Friday]);switch(t){case n.DateRangeType.Day:p=s(c=f(e),1);break;case n.DateRangeType.Week:case n.DateRangeType.WorkWeek:c=function(e,t){var n=t-e.getDay();n>0&&(n-=r.default.DaysInOneWeek);return s(e,n)}(f(e),a);p=s(c,r.default.DaysInOneWeek);break;case n.DateRangeType.Month:p=o(c=new Date(e.getFullYear(),e.getMonth(),1),1);break;default:return i.assertNever(t)}var d=c;do{t!==n.DateRangeType.WorkWeek?h.push(d):-1!==l.indexOf(d.getDay())&&h.push(d);d=s(d,1)}while(!u(d,p));return h};t.isInDateRangeArray=function(e,t){for(var n=0,r=t;n<r.length;n++){if(u(e,r[n]))return!0}return!1};t.getWeekNumbersInMonth=function(e,t,i,s){var o=s.getFullYear(),u=s.getMonth(),f=1,l=new Date(o,u,f),c=f+(t+r.default.DaysInOneWeek-1)-function(e,t){return e!==n.DayOfWeek.Sunday&&t<e?t+r.default.DaysInOneWeek:t}(t,l.getDay()),h=new Date(o,u,c);f=h.getDate();for(var p=[],d=0;d<e;d++){p.push(a(h,t,i));f+=r.default.DaysInOneWeek;h=new Date(o,u,f)}return p};function a(e,t,i){switch(i){case n.FirstWeekOfYear.FirstFullWeek:return c(e,t,r.default.DaysInOneWeek);case n.FirstWeekOfYear.FirstFourDayWeek:return c(e,t,4);default:return function(e,t){var n=h(e)-1,i=(e.getDay()-n%r.default.DaysInOneWeek-t+2*r.default.DaysInOneWeek)%r.default.DaysInOneWeek;return Math.floor((n+i)/r.default.DaysInOneWeek+1)}(e,t)}}t.getWeekNumber=a;function f(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function l(e){return e.getDate()+(e.getMonth()<<5)+(e.getFullYear()<<9)}function c(e,t,i){var s=h(e)-1,o=e.getDay()-s%r.default.DaysInOneWeek,u=h(new Date(e.getFullYear()-1,n.MonthOfYear.December,31))-1,a=(t-o+2*r.default.DaysInOneWeek)%r.default.DaysInOneWeek;0!==a&&a>=i&&(a-=r.default.DaysInOneWeek);var f=s-a;if(f<0){0!==(a=(t-(o-=u%r.default.DaysInOneWeek)+2*r.default.DaysInOneWeek)%r.default.DaysInOneWeek)&&a+1>=i&&(a-=r.default.DaysInOneWeek);f=u-a}return Math.floor(f/r.default.DaysInOneWeek+1)}function h(e){for(var t=e.getMonth(),n=e.getFullYear(),r=0,i=0;i<t;i++)r+=p(i+1,n);return r+=e.getDate()}function p(e,t){return new Date(t,e,0).getDate()}});
define("office-ui-fabric-react/lib/utilities/dateValues/TimeConstants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={MillisecondsInOneDay:864e5,MillisecondsIn1Sec:1e3,MillisecondsIn1Min:6e4,MillisecondsIn30Mins:18e5,MillisecondsIn1Hour:36e5,MinutesInOneDay:1440,MinutesInOneHour:60,DaysInOneWeek:7,MonthInOneYear:12}});
define("office-ui-fabric-react/lib/components/Calendar/Calendar.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".root_c2e3dad8{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-shadow:none;box-shadow:none;margin:0;padding:0}.root_c2e3dad8 *::-moz-focus-inner{border:0}.root_c2e3dad8 *{outline:transparent}.root_c2e3dad8 *{position:relative}.ms-Fabric--isFocusVisible .root_c2e3dad8 *:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.picker_c2e3dad8{color:"},{theme:"black",defaultValue:"#000000"},{rawString:";font-size:14px;position:relative}html[dir='ltr'] .picker_c2e3dad8{text-align:left}html[dir='rtl'] .picker_c2e3dad8{text-align:right}.holder_c2e3dad8{-webkit-overflow-scrolling:touch;-webkit-box-sizing:border-box;box-sizing:border-box;display:none}.picker_c2e3dad8.pickerIsOpened_c2e3dad8 .holder_c2e3dad8{-webkit-box-sizing:border-box;box-sizing:border-box;display:inline-block}.pickerIsOpened_c2e3dad8{position:relative}.frame_c2e3dad8{position:relative}.wrap_c2e3dad8{min-height:212px;padding:12px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-sizing:content-box;box-sizing:content-box}.wrap_c2e3dad8.goTodaySpacing_c2e3dad8{min-height:228px}.dayPicker_c2e3dad8{display:block}.header_c2e3dad8{position:relative;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;height:28px;line-height:44px;width:100%}.divider_c2e3dad8{top:0;margin-top:-12px;margin-bottom:-12px}html[dir='ltr'] .divider_c2e3dad8{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir='rtl'] .divider_c2e3dad8{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.monthAndYear_c2e3dad8,.year_c2e3dad8,.decade_c2e3dad8{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;font-size:14px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-weight:600;padding:0 5px}.monthAndYear_c2e3dad8:hover,.currentYear_c2e3dad8:hover,.currentDecade_c2e3dad8:hover{cursor:default}.table_c2e3dad8{text-align:center;border-collapse:collapse;border-spacing:0;table-layout:fixed;font-size:inherit;margin-top:4px;width:197px}.table_c2e3dad8 td{margin:0;padding:0}.dayWrapper_c2e3dad8,.weekday_c2e3dad8{width:28px;height:28px;padding:0;line-height:28px;font-size:12px;font-size:15px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;cursor:default}.dayWrapper_c2e3dad8 *::-moz-focus-inner,.weekday_c2e3dad8 *::-moz-focus-inner{border:0}.dayWrapper_c2e3dad8 *,.weekday_c2e3dad8 *{outline:transparent}.dayWrapper_c2e3dad8 *,.weekday_c2e3dad8 *{position:relative}.ms-Fabric--isFocusVisible .dayWrapper_c2e3dad8 *:focus:after,.ms-Fabric--isFocusVisible .weekday_c2e3dad8 *:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.day_c2e3dad8{width:24px;height:24px;border-radius:2px;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;border:none;padding:0;background-color:transparent;line-height:100%;font-size:inherit;color:inherit;font-weight:inherit}@media screen and (-ms-high-contrast: active){.daySelection_c2e3dad8 .day_c2e3dad8:hover,.daySelection_c2e3dad8 .day_c2e3dad8:active{outline:1px solid highlight}}@media screen and (-ms-high-contrast: active){.daySelection_c2e3dad8 .day_c2e3dad8:active{color:highlight}}.dayIsToday_c2e3dad8,.dayIsToday_c2e3dad8:hover{position:relative;background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}@media screen and (-ms-high-contrast: active){.dayIsToday_c2e3dad8,.dayIsToday_c2e3dad8:hover{background-color:highlight;border-radius:2px}}@media screen and (-ms-high-contrast: active){.dayIsToday_c2e3dad8 span,.dayIsToday_c2e3dad8:hover span{-ms-high-contrast-adjust:none;color:window}}.dayIsToday_c2e3dad8:hover,.dayIsToday_c2e3dad8:hover:hover{border-radius:0px}.dayIsDisabled_c2e3dad8:before{border-top-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.dayIsUnfocused_c2e3dad8{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-weight:400}.dayIsFocused_c2e3dad8:hover,.dayIsUnfocused_c2e3dad8:hover{cursor:pointer;background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.daySelection_c2e3dad8.dayIsHighlighted_c2e3dad8:hover,.pickerIsFocused_c2e3dad8 .dayIsHighlighted_c2e3dad8.daySelection_c2e3dad8{cursor:pointer}@media screen and (-ms-high-contrast: active){.daySelection_c2e3dad8.dayIsHighlighted_c2e3dad8:hover,.pickerIsFocused_c2e3dad8 .dayIsHighlighted_c2e3dad8.daySelection_c2e3dad8{border:2px solid Highlight}.daySelection_c2e3dad8.dayIsHighlighted_c2e3dad8:hover :not(.dayIsToday_c2e3dad8) span,.pickerIsFocused_c2e3dad8 .dayIsHighlighted_c2e3dad8.daySelection_c2e3dad8 :not(.dayIsToday_c2e3dad8) span{color:Highlight}}@media screen and (-ms-high-contrast: active){.dayIsHighlighted_c2e3dad8 button.dayIsToday_c2e3dad8{border-radius:0px}}@media screen and (-ms-high-contrast: active){.dayIsHighlighted_c2e3dad8 button.dayIsToday_c2e3dad8 span{color:Window}}.dayIsFocused_c2e3dad8:active,.dayIsHighlighted_c2e3dad8{background:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.dayIsFocused_c2e3dad8:active.day_c2e3dad8,.dayIsHighlighted_c2e3dad8.day_c2e3dad8{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-weight:600}.dayIsHighlighted_c2e3dad8.dayDisabled_c2e3dad8,.dayIsHighlighted_c2e3dad8.dayDisabled_c2e3dad8:hover{background:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.dayBackground_c2e3dad8,.dayBackground_c2e3dad8:hover,.dayBackground_c2e3dad8:active{border-radius:2px}.dayHover_c2e3dad8,.dayHover_c2e3dad8:hover{cursor:pointer;background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.dayPress_c2e3dad8,.dayPress_c2e3dad8:hover{cursor:pointer;font-weight:600;background:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.dayPress_c2e3dad8 .dayIsToday_c2e3dad8,.dayPress_c2e3dad8:hover .dayIsToday_c2e3dad8{background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.dayIsUnfocused_c2e3dad8:active,.dayIsFocused_c2e3dad8:active,.dayIsHighlighted_c2e3dad8,.dayIsHighlighted_c2e3dad8:hover,.dayIsHighlighted_c2e3dad8:active,.weekBackground_c2e3dad8,.weekBackground_c2e3dad8:hover,.weekBackground_c2e3dad8:active{background:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-weight:600}.dayIsToday_c2e3dad8,.pickerIsFocused_c2e3dad8 .dayIsToday_c2e3dad8,.dayIsToday_c2e3dad8.day_c2e3dad8:active{position:relative;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-weight:600;background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.showWeekNumbers_c2e3dad8 .weekNumbers_c2e3dad8{border-right:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box;width:28px;padding:0}.showWeekNumbers_c2e3dad8 .weekNumbers_c2e3dad8 .dayWrapper_c2e3dad8{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.showWeekNumbers_c2e3dad8 .weekNumbers_c2e3dad8 .dayWrapper_c2e3dad8.weekIsHighlighted_c2e3dad8{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.showWeekNumbers_c2e3dad8 .table_c2e3dad8{width:225px}.showWeekNumbers_c2e3dad8 .table_c2e3dad8 .dayWrapper_c2e3dad8,.showWeekNumbers_c2e3dad8 .table_c2e3dad8 .weekday_c2e3dad8{width:30px}.showWeekNumbersRTL_c2e3dad8 .weekNumbers_c2e3dad8{border-left:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box}.showWeekNumbersRTL_c2e3dad8 .weekNumbers_c2e3dad8 .dayWrapper_c2e3dad8{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.showWeekNumbersRTL_c2e3dad8 .weekNumbers_c2e3dad8 .dayWrapper_c2e3dad8.weekIsHighlighted_c2e3dad8{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.showWeekNumbersRTL_c2e3dad8 .table_c2e3dad8{width:225px}.showWeekNumbersRTL_c2e3dad8 .table_c2e3dad8 .dayWrapper_c2e3dad8,.showWeekNumbersRTL_c2e3dad8 .table_c2e3dad8 .weekday_c2e3dad8{width:30px}.monthComponents_c2e3dad8,.yearComponents_c2e3dad8,.decadeComponents_c2e3dad8{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-ms-flex-item-align:end;align-self:flex-end}.closeButton_c2e3dad8,.prevMonth_c2e3dad8,.nextMonth_c2e3dad8,.prevYear_c2e3dad8,.nextYear_c2e3dad8,.prevDecade_c2e3dad8,.nextDecade_c2e3dad8{width:28px;height:28px;display:block;text-align:center;line-height:28px;text-align:center;font-size:12px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";border-radius:2px;position:relative;background-color:transparent;border:none;padding:0}.closeButton_c2e3dad8:hover,.prevMonth_c2e3dad8:hover,.nextMonth_c2e3dad8:hover,.prevYear_c2e3dad8:hover,.nextYear_c2e3dad8:hover,.prevDecade_c2e3dad8:hover,.nextDecade_c2e3dad8:hover{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";cursor:pointer;outline:1px solid transparent}.prevMonthIsDisabled_c2e3dad8,.nextMonthIsDisabled_c2e3dad8,.prevYearIsDisabled_c2e3dad8,.nextYearIsDisabled_c2e3dad8,.prevDecadeIsDisabled_c2e3dad8,.nextDecadeIsDisabled_c2e3dad8{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";pointer-events:none}.headerToggleView_c2e3dad8{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:4px 8px}.headerToggleView_c2e3dad8:hover{color:"},{theme:"black",defaultValue:"#000000"},{rawString:";cursor:pointer}@media screen and (-ms-high-contrast: active){.headerToggleView_c2e3dad8:hover{outline:1px solid highlight}}@media screen and (-ms-high-contrast: active){.headerToggleView_c2e3dad8:hover:active{color:highlight}}.currentYear_c2e3dad8,.currentDecade_c2e3dad8{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;padding:0 5px;font-size:14px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";height:28px;line-height:28px;font-weight:600}html[dir='ltr'] .currentYear_c2e3dad8,html[dir='ltr'] .currentDecade_c2e3dad8{margin-left:5px}html[dir='rtl'] .currentYear_c2e3dad8,html[dir='rtl'] .currentDecade_c2e3dad8{margin-right:5px}.optionGrid_c2e3dad8{position:relative;height:210px;width:196px;margin:4px 0 0 0}html[dir='rtl'] .optionGrid_c2e3dad8{margin:4px 0 0 0}.monthOption_c2e3dad8,.yearOption_c2e3dad8{width:60px;height:60px;line-height:100%;cursor:pointer;margin:0 10px 10px 0;font-size:13px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";text-align:center;border:none;padding:0;background-color:transparent;border-radius:2px}html[dir='ltr'] .monthOption_c2e3dad8,html[dir='ltr'] .yearOption_c2e3dad8{float:left}html[dir='rtl'] .monthOption_c2e3dad8,html[dir='rtl'] .yearOption_c2e3dad8{float:right}html[dir='rtl'] .monthOption_c2e3dad8,html[dir='rtl'] .yearOption_c2e3dad8{margin:0 0 10px 10px}.monthOption_c2e3dad8:hover,.yearOption_c2e3dad8:hover{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";outline:1px solid transparent}@media screen and (-ms-high-contrast: active){.monthOption_c2e3dad8:hover,.yearOption_c2e3dad8:hover{outline-color:highlight}}@media screen and (-ms-high-contrast: active){.monthOption_c2e3dad8:active,.yearOption_c2e3dad8:active{color:highlight}}.monthOption_c2e3dad8.isHighlighted_c2e3dad8,.yearOption_c2e3dad8.isHighlighted_c2e3dad8{background-color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.dayIsDisabled_c2e3dad8,.monthOptionIsDisabled_c2e3dad8,.yearOptionIsDisabled_c2e3dad8{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";pointer-events:none}.goToday_c2e3dad8{bottom:0;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";cursor:pointer;font-size:12px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";height:30px;line-height:30px;padding:0 10px;background-color:transparent;border:none;position:absolute !important;-webkit-box-sizing:content-box;box-sizing:content-box}[dir='ltr'] .goToday_c2e3dad8{right:13px}[dir='rtl'] .goToday_c2e3dad8{left:13px}.goToday_c2e3dad8:hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";outline:1px solid transparent}@media screen and (-ms-high-contrast: active){.goToday_c2e3dad8:hover{outline-color:highlight}}.goToday_c2e3dad8:active{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}@media screen and (-ms-high-contrast: active){.goToday_c2e3dad8:active{color:highlight}}.goToTodayIsDisabled_c2e3dad8{color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";pointer-events:none}.goTodayInlineMonth_c2e3dad8{top:212px}.wrap_c2e3dad8.goTodaySpacing_c2e3dad8{padding-bottom:28px}.root_c2e3dad8.isPickingYears_c2e3dad8 .dayPicker_c2e3dad8,.root_c2e3dad8.isPickingYears_c2e3dad8 .monthComponents_c2e3dad8{display:none}.root_c2e3dad8.isPickingYears_c2e3dad8 .monthPicker_c2e3dad8{display:none}.root_c2e3dad8.isPickingYears_c2e3dad8 .yearPicker_c2e3dad8{display:block}@media (min-device-width: 460px){.wrap_c2e3dad8{padding:12px}.dayPicker_c2e3dad8,.monthPicker_c2e3dad8{min-height:200px}.header_c2e3dad8{height:28px;line-height:28px;width:100%}.dayWrapper_c2e3dad8,.weekday_c2e3dad8{width:28px;height:28px;line-height:28px;font-size:12px}.closeButton_c2e3dad8,.prevMonth_c2e3dad8,.nextMonth_c2e3dad8,.prevYear_c2e3dad8,.nextYear_c2e3dad8,.prevDecade_c2e3dad8,.nextDecade_c2e3dad8{font-size:12px;width:28px;height:28px;line-height:28px}.holder_c2e3dad8{display:inline-block;height:auto;overflow:hidden}.monthAndYear_c2e3dad8,.year_c2e3dad8,.decade_c2e3dad8{font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.yearComponents_c2e3dad8{margin-left:1px}.goToday_c2e3dad8{padding:0 3px}[dir='ltr'] .goToday_c2e3dad8{right:20px}[dir='rtl'] .goToday_c2e3dad8{left:20px}.showWeekNumbers_c2e3dad8 .table_c2e3dad8 .dayWrapper_c2e3dad8,.showWeekNumbers_c2e3dad8 .table_c2e3dad8 .weekday_c2e3dad8{width:28px}.showWeekNumbersRTL_c2e3dad8 .table_c2e3dad8 .dayWrapper_c2e3dad8,.showWeekNumbersRTL_c2e3dad8 .table_c2e3dad8 .weekday_c2e3dad8{width:28px}.monthPickerVisible_c2e3dad8 .wrap_c2e3dad8{padding:12px}.monthPickerVisible_c2e3dad8 .dayPicker_c2e3dad8{margin:-10px 0;padding:10px 0}.monthPickerVisible_c2e3dad8 .dayPicker_c2e3dad8{-webkit-box-sizing:border-box;box-sizing:border-box;width:212px;min-height:200px}.monthPickerVisible_c2e3dad8 .monthPicker_c2e3dad8{display:block}.monthPickerVisible_c2e3dad8 .optionGrid_c2e3dad8{height:150px;width:196px}.monthPickerVisible_c2e3dad8 .toggleMonthView_c2e3dad8{display:none}.monthPickerVisible_c2e3dad8 .currentYear_c2e3dad8,.monthPickerVisible_c2e3dad8 .currentDecade_c2e3dad8{font-size:14px;margin:0;height:28px;line-height:28px;display:inline-block}.monthPickerVisible_c2e3dad8 .monthOption_c2e3dad8,.monthPickerVisible_c2e3dad8 .yearOption_c2e3dad8{width:40px;height:40px;line-height:100%;font-size:12px;margin:0 12px 16px 0}html[dir='rtl'] .monthPickerVisible_c2e3dad8 .monthOption_c2e3dad8,html[dir='rtl'] .monthPickerVisible_c2e3dad8 .yearOption_c2e3dad8{margin:0 0 16px 12px}.monthPickerVisible_c2e3dad8 .monthOption_c2e3dad8:hover,.monthPickerVisible_c2e3dad8 .yearOption_c2e3dad8:hover{outline:1px solid transparent}.monthPickerVisible_c2e3dad8 .monthOption_c2e3dad8:nth-child(4n+4),.monthPickerVisible_c2e3dad8 .yearOption_c2e3dad8:nth-child(4n+4){margin:0 0px 16px 0}html[dir='rtl'] .monthPickerVisible_c2e3dad8 .monthOption_c2e3dad8:nth-child(4n+4),html[dir='rtl'] .monthPickerVisible_c2e3dad8 .yearOption_c2e3dad8:nth-child(4n+4){margin:0 0 16px 0px}.monthPickerVisible_c2e3dad8 .goToday_c2e3dad8{font-size:12px;height:28px;line-height:28px;padding:0 10px}[dir='ltr'] .monthPickerVisible_c2e3dad8 .goToday_c2e3dad8{right:8px}[dir='rtl'] .monthPickerVisible_c2e3dad8 .goToday_c2e3dad8{left:8px}html[dir='ltr'] .monthPickerVisible_c2e3dad8 .goToday_c2e3dad8{text-align:right}html[dir='rtl'] .monthPickerVisible_c2e3dad8 .goToday_c2e3dad8{text-align:left}.monthPickerVisible_c2e3dad8 .root_c2e3dad8.isPickingYears_c2e3dad8 .dayPicker_c2e3dad8,.monthPickerVisible_c2e3dad8 .root_c2e3dad8.isPickingYears_c2e3dad8 .monthComponents_c2e3dad8{display:block}.monthPickerVisible_c2e3dad8 .root_c2e3dad8.isPickingYears_c2e3dad8 .monthPicker_c2e3dad8{display:none}.monthPickerVisible_c2e3dad8 .root_c2e3dad8.isPickingYears_c2e3dad8 .yearPicker_c2e3dad8{display:block}.calendarsInline_c2e3dad8 .wrap_c2e3dad8{padding:12px}.calendarsInline_c2e3dad8 .holder_c2e3dad8{height:auto}html[dir='ltr'] .calendarsInline_c2e3dad8 .table_c2e3dad8{margin-right:12px}html[dir='rtl'] .calendarsInline_c2e3dad8 .table_c2e3dad8{margin-left:12px}.calendarsInline_c2e3dad8 .dayPicker_c2e3dad8{width:auto}html[dir='ltr'] .calendarsInline_c2e3dad8 .monthPicker_c2e3dad8{margin-left:12px}html[dir='rtl'] .calendarsInline_c2e3dad8 .monthPicker_c2e3dad8{margin-right:12px}html[dir='ltr'] .calendarsInline_c2e3dad8 .yearPicker_c2e3dad8{margin-left:12px}html[dir='rtl'] .calendarsInline_c2e3dad8 .yearPicker_c2e3dad8{margin-right:12px}.calendarsInline_c2e3dad8 .goToday_c2e3dad8{padding:0 10px}[dir='ltr'] .calendarsInline_c2e3dad8 .goToday_c2e3dad8{right:14px}[dir='rtl'] .calendarsInline_c2e3dad8 .goToday_c2e3dad8{left:14px}html[dir='ltr'] .calendarsInline_c2e3dad8 .monthComponents_c2e3dad8{margin-right:12px}html[dir='rtl'] .calendarsInline_c2e3dad8 .monthComponents_c2e3dad8{margin-left:12px}.monthPickerOnly_c2e3dad8 .wrap_c2e3dad8{padding:12px}.monthPickerAsOverlay_c2e3dad8 .wrap_c2e3dad8{padding-bottom:28px;margin-bottom:6px}.monthPickerAsOverlay_c2e3dad8 .holder_c2e3dad8{height:240px;min-height:240px}.monthPickerAsOverlay_c2e3dad8 .holderWithButton_c2e3dad8{padding-top:6px;height:auto}}@media (max-device-width: 459px){.calendarsInline_c2e3dad8 .monthPicker_c2e3dad8,.calendarsInline_c2e3dad8 .yearPicker_c2e3dad8{display:none}.yearComponents_c2e3dad8{margin-top:2px}}.goToday_c2e3dad8{width:auto}.closeButton_c2e3dad8,.nextMonth_c2e3dad8,.prevMonth_c2e3dad8,.nextYear_c2e3dad8,.prevYear_c2e3dad8,.nextDecade_c2e3dad8,.prevDecade_c2e3dad8{display:inline-block}.closeButton_c2e3dad8:hover,.nextMonth_c2e3dad8:hover,.prevMonth_c2e3dad8:hover,.nextYear_c2e3dad8:hover,.prevYear_c2e3dad8:hover,.nextDecade_c2e3dad8:hover,.prevDecade_c2e3dad8:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}@media screen and (-ms-high-contrast: active){.closeButton_c2e3dad8:hover,.nextMonth_c2e3dad8:hover,.prevMonth_c2e3dad8:hover,.nextYear_c2e3dad8:hover,.prevYear_c2e3dad8:hover,.nextDecade_c2e3dad8:hover,.prevDecade_c2e3dad8:hover{outline:1px solid highlight}}.closeButton_c2e3dad8:active,.nextMonth_c2e3dad8:active,.prevMonth_c2e3dad8:active,.nextYear_c2e3dad8:active,.prevYear_c2e3dad8:active,.nextDecade_c2e3dad8:active,.prevDecade_c2e3dad8:active{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}@media screen and (-ms-high-contrast: active){.closeButton_c2e3dad8:active,.nextMonth_c2e3dad8:active,.prevMonth_c2e3dad8:active,.nextYear_c2e3dad8:active,.prevYear_c2e3dad8:active,.nextDecade_c2e3dad8:active,.prevDecade_c2e3dad8:active{color:highlight}}.monthIsHighlighted_c2e3dad8{font-weight:600;background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.monthIsHighlighted_c2e3dad8.monthOption_c2e3dad8:hover{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}@media screen and (-ms-high-contrast: active){.monthIsHighlighted_c2e3dad8{color:highlight;border:2px solid highlight;border-radius:2px}.monthIsHighlighted_c2e3dad8:hover{outline:0 !important}}.monthIsCurrentMonth_c2e3dad8{font-weight:600;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.monthIsCurrentMonth_c2e3dad8.monthOption_c2e3dad8:hover{font-weight:600;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.monthOption_c2e3dad8:active{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.yearIsHighlighted_c2e3dad8{font-weight:600;background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.yearIsHighlighted_c2e3dad8.yearOption_c2e3dad8:hover{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.yearIsCurrentYear_c2e3dad8{font-weight:600;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.yearIsCurrentYear_c2e3dad8.yearOption_c2e3dad8:hover{font-weight:600;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.yearOption_c2e3dad8:active{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.topLeftCornerDate_c2e3dad8{border-top-left-radius:2px}.topRightCornerDate_c2e3dad8{border-top-right-radius:2px}.bottomLeftCornerDate_c2e3dad8{border-bottom-left-radius:2px}.bottomRightCornerDate_c2e3dad8{border-bottom-right-radius:2px}@media screen and (-ms-high-contrast: active){.weekBackground_c2e3dad8{border-top:1px solid highlight;border-bottom:1px solid highlight}.weekBackground_c2e3dad8.bottomRightCornerDate_c2e3dad8.topRightCornerDate_c2e3dad8{border-right:1px solid highlight;border-left:none;padding-left:1px}.weekBackground_c2e3dad8.bottomLeftCornerDate_c2e3dad8.topLeftCornerDate_c2e3dad8{border-left:1px solid highlight;border-right:none;padding-right:1px}.weekBackground_c2e3dad8 :not(.dayIsToday_c2e3dad8) span{color:highlight}.weekSelection_c2e3dad8.dayHover_c2e3dad8{border-top:1px solid highlight;border-bottom:1px solid highlight}.weekSelection_c2e3dad8.dayHover_c2e3dad8.bottomLeftCornerDate_c2e3dad8.topLeftCornerDate_c2e3dad8{border-left:1px solid highlight;padding-right:1px}.weekSelection_c2e3dad8.dayHover_c2e3dad8.bottomRightCornerDate_c2e3dad8.topRightCornerDate_c2e3dad8{border-right:1px solid highlight;padding-left:1px}.weekSelection_c2e3dad8.dayHover_c2e3dad8.dayPress_c2e3dad8 :not(.dayIsToday_c2e3dad8) span{color:highlight}.monthSelection_c2e3dad8.dayHover_c2e3dad8.bottomLeftCornerDate_c2e3dad8,.monthSelection_c2e3dad8.dayHover_c2e3dad8.topLeftCornerDate_c2e3dad8{border-left:1px solid highlight;padding-right:1px}.monthSelection_c2e3dad8.dayHover_c2e3dad8.bottomRightCornerDate_c2e3dad8,.monthSelection_c2e3dad8.dayHover_c2e3dad8.topRightCornerDate_c2e3dad8{border-right:1px solid highlight;padding-left:1px}.monthSelection_c2e3dad8.dayIsFocused_c2e3dad8.dayHover_c2e3dad8.topDate_c2e3dad8,.monthSelection_c2e3dad8.dayIsUnfocused_c2e3dad8.dayHover_c2e3dad8.topDate_c2e3dad8{border-top:1px solid highlight;padding-bottom:1px}.monthSelection_c2e3dad8.dayIsFocused_c2e3dad8.dayHover_c2e3dad8.rightDate_c2e3dad8,.monthSelection_c2e3dad8.dayIsUnfocused_c2e3dad8.dayHover_c2e3dad8.rightDate_c2e3dad8{border-right:1px solid highlight;padding-left:1px}.monthSelection_c2e3dad8.dayIsFocused_c2e3dad8.dayHover_c2e3dad8.bottomDate_c2e3dad8,.monthSelection_c2e3dad8.dayIsUnfocused_c2e3dad8.dayHover_c2e3dad8.bottomDate_c2e3dad8{border-bottom:1px solid highlight;padding-top:1px}.monthSelection_c2e3dad8.dayIsFocused_c2e3dad8.dayHover_c2e3dad8.leftdate_c2e3dad8,.monthSelection_c2e3dad8.dayIsUnfocused_c2e3dad8.dayHover_c2e3dad8.leftdate_c2e3dad8{border-left:1px solid highlight;padding-right:1px}.monthSelection_c2e3dad8.dayIsFocused_c2e3dad8.dayHover_c2e3dad8.dayPress_c2e3dad8 :not(.dayIsToday_c2e3dad8) span,.monthSelection_c2e3dad8.dayIsUnfocused_c2e3dad8.dayHover_c2e3dad8.dayPress_c2e3dad8 :not(.dayIsToday_c2e3dad8) span{color:highlight}}\n"}]);t.root="root_c2e3dad8";t.picker="picker_c2e3dad8";t.holder="holder_c2e3dad8";t.pickerIsOpened="pickerIsOpened_c2e3dad8";t.frame="frame_c2e3dad8";t.wrap="wrap_c2e3dad8";t.goTodaySpacing="goTodaySpacing_c2e3dad8";t.dayPicker="dayPicker_c2e3dad8";t.header="header_c2e3dad8";t.divider="divider_c2e3dad8";t.monthAndYear="monthAndYear_c2e3dad8";t.year="year_c2e3dad8";t.decade="decade_c2e3dad8";t.currentYear="currentYear_c2e3dad8";t.currentDecade="currentDecade_c2e3dad8";t.table="table_c2e3dad8";t.dayWrapper="dayWrapper_c2e3dad8";t.weekday="weekday_c2e3dad8";t.day="day_c2e3dad8";t.daySelection="daySelection_c2e3dad8";t.dayIsToday="dayIsToday_c2e3dad8";t.dayIsDisabled="dayIsDisabled_c2e3dad8";t.dayIsUnfocused="dayIsUnfocused_c2e3dad8";t.dayIsFocused="dayIsFocused_c2e3dad8";t.dayIsHighlighted="dayIsHighlighted_c2e3dad8";t.pickerIsFocused="pickerIsFocused_c2e3dad8";t.dayDisabled="dayDisabled_c2e3dad8";t.dayBackground="dayBackground_c2e3dad8";t.dayHover="dayHover_c2e3dad8";t.dayPress="dayPress_c2e3dad8";t.weekBackground="weekBackground_c2e3dad8";t.showWeekNumbers="showWeekNumbers_c2e3dad8";t.weekNumbers="weekNumbers_c2e3dad8";t.weekIsHighlighted="weekIsHighlighted_c2e3dad8";t.showWeekNumbersRTL="showWeekNumbersRTL_c2e3dad8";t.monthComponents="monthComponents_c2e3dad8";t.yearComponents="yearComponents_c2e3dad8";t.decadeComponents="decadeComponents_c2e3dad8";t.closeButton="closeButton_c2e3dad8";t.prevMonth="prevMonth_c2e3dad8";t.nextMonth="nextMonth_c2e3dad8";t.prevYear="prevYear_c2e3dad8";t.nextYear="nextYear_c2e3dad8";t.prevDecade="prevDecade_c2e3dad8";t.nextDecade="nextDecade_c2e3dad8";t.prevMonthIsDisabled="prevMonthIsDisabled_c2e3dad8";t.nextMonthIsDisabled="nextMonthIsDisabled_c2e3dad8";t.prevYearIsDisabled="prevYearIsDisabled_c2e3dad8";t.nextYearIsDisabled="nextYearIsDisabled_c2e3dad8";t.prevDecadeIsDisabled="prevDecadeIsDisabled_c2e3dad8";t.nextDecadeIsDisabled="nextDecadeIsDisabled_c2e3dad8";t.headerToggleView="headerToggleView_c2e3dad8";t.optionGrid="optionGrid_c2e3dad8";t.monthOption="monthOption_c2e3dad8";t.yearOption="yearOption_c2e3dad8";t.isHighlighted="isHighlighted_c2e3dad8";t.monthOptionIsDisabled="monthOptionIsDisabled_c2e3dad8";t.yearOptionIsDisabled="yearOptionIsDisabled_c2e3dad8";t.goToday="goToday_c2e3dad8";t.goToTodayIsDisabled="goToTodayIsDisabled_c2e3dad8";t.goTodayInlineMonth="goTodayInlineMonth_c2e3dad8";t.isPickingYears="isPickingYears_c2e3dad8";t.monthPicker="monthPicker_c2e3dad8";t.yearPicker="yearPicker_c2e3dad8";t.monthPickerVisible="monthPickerVisible_c2e3dad8";t.toggleMonthView="toggleMonthView_c2e3dad8";t.calendarsInline="calendarsInline_c2e3dad8";t.monthPickerOnly="monthPickerOnly_c2e3dad8";t.monthPickerAsOverlay="monthPickerAsOverlay_c2e3dad8";t.holderWithButton="holderWithButton_c2e3dad8";t.monthIsHighlighted="monthIsHighlighted_c2e3dad8";t.monthIsCurrentMonth="monthIsCurrentMonth_c2e3dad8";t.yearIsHighlighted="yearIsHighlighted_c2e3dad8";t.yearIsCurrentYear="yearIsCurrentYear_c2e3dad8";t.topLeftCornerDate="topLeftCornerDate_c2e3dad8";t.topRightCornerDate="topRightCornerDate_c2e3dad8";t.bottomLeftCornerDate="bottomLeftCornerDate_c2e3dad8";t.bottomRightCornerDate="bottomRightCornerDate_c2e3dad8";t.weekSelection="weekSelection_c2e3dad8";t.monthSelection="monthSelection_c2e3dad8";t.topDate="topDate_c2e3dad8";t.rightDate="rightDate_c2e3dad8";t.bottomDate="bottomDate_c2e3dad8";t.leftdate="leftdate_c2e3dad8"});
define("office-ui-fabric-react/lib/components/Calendar/CalendarMonth",["require","exports","tslib","react","../../Utilities","../../FocusZone","../../utilities/dateMath/DateMath","../../Icon","./Calendar.scss","./CalendarYear"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a,c=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onCalendarYearRef=function(e){n._calendarYearRef=e};n._onKeyDown=function(e,t){t.which===i.KeyCodes.enter&&e()};n._onSelectYear=function(e){n._focusOnUpdate=!0;var t=n.props,r=t.navigatedDate,i=t.onNavigateDate,s=t.maxDate,u=t.minDate;if(r.getFullYear()!==e){var a=new Date(r.getTime());a.setFullYear(e);s&&a>s?a=o.setMonth(a,s.getMonth()):u&&a<u&&(a=o.setMonth(a,u.getMonth()));i(a,!0)}n.setState({isYearPickerVisible:!1})};n._yearToString=function(e){var t=n.props,r=t.navigatedDate,i=t.dateTimeFormatter;if(i){var s=new Date(r.getTime());s.setFullYear(e);return i.formatYear(s)}return String(e)};n._yearRangeToString=function(e){return n._yearToString(e.fromYear)+" - "+n._yearToString(e.toYear)};n._yearRangeToNextDecadeLabel=function(e){var t=n.props.strings;return t.nextYearRangeAriaLabel?t.nextYearRangeAriaLabel+" "+n._yearRangeToString(e):""};n._yearRangeToPrevDecadeLabel=function(e){var t=n.props.strings;return t.prevYearRangeAriaLabel?t.prevYearRangeAriaLabel+" "+n._yearRangeToString(e):""};n._onRenderYear=function(e){return n._yearToString(e)};n._onSelectNextYear=function(){var e=n.props,t=e.navigatedDate;(0,e.onNavigateDate)(o.addYears(t,1),!1)};n._onSelectNextYearKeyDown=function(e){e.which===i.KeyCodes.enter&&n._onKeyDown(n._onSelectNextYear,e)};n._onSelectPrevYear=function(){var e=n.props,t=e.navigatedDate;(0,e.onNavigateDate)(o.addYears(t,-1),!1)};n._onSelectPrevYearKeyDown=function(e){e.which===i.KeyCodes.enter&&n._onKeyDown(n._onSelectPrevYear,e)};n._onSelectMonthKeyDown=function(e){return function(t){return n._onKeyDown(function(){return n._onSelectMonth(e)},t)}};n._onSelectMonth=function(e){var t=n.props,r=t.navigatedDate,i=t.onNavigateDate,s=t.onHeaderSelect;s&&s(!0);i(o.setMonth(r,e),!0)};n._onHeaderSelect=function(){var e=n.props,t=e.onHeaderSelect;if(e.yearPickerHidden)t&&t(!0);else{n._focusOnUpdate=!0;n.setState({isYearPickerVisible:!0})}};n._onYearPickerHeaderSelect=function(e){n._focusOnUpdate=e;n.setState({isYearPickerVisible:!1})};n._onHeaderKeyDown=function(e){!n._onHeaderSelect||e.which!==i.KeyCodes.enter&&e.which!==i.KeyCodes.space||n._onHeaderSelect()};n._selectMonthCallbacks=[];t.strings.shortMonths.map(function(e,t){n._selectMonthCallbacks[t]=n._onSelectMonth.bind(n,t)});n._isCurrentMonth=n._isCurrentMonth.bind(n);n._onSelectNextYear=n._onSelectNextYear.bind(n);n._onSelectPrevYear=n._onSelectPrevYear.bind(n);n._onSelectMonth=n._onSelectMonth.bind(n);n.state={isYearPickerVisible:!1};return n}t.prototype.componentDidUpdate=function(){if(this._focusOnUpdate){this.focus();this._focusOnUpdate=!1}};t.prototype.render=function(){var e=this,t=this.props,n=t.navigatedDate,a=t.selectedDate,c=t.strings,h=t.today,p=t.highlightCurrentMonth,d=t.highlightSelectedMonth,v=t.navigationIcons,m=t.dateTimeFormatter,g=t.minDate,y=t.maxDate,b=t.yearPickerHidden;if(this.state.isYearPickerVisible){var w=n?n.getFullYear():void 0;return r.createElement(f.CalendarYear,{key:"calendarYear_"+(w&&w.toString()),minYear:g?g.getFullYear():void 0,maxYear:y?y.getFullYear():void 0,onSelectYear:this._onSelectYear,navigationIcons:v,onHeaderSelect:this._onYearPickerHeaderSelect,selectedYear:w,onRenderYear:this._onRenderYear,strings:{rangeAriaLabel:this._yearRangeToString,prevRangeAriaLabel:this._yearRangeToPrevDecadeLabel,nextRangeAriaLabel:this._yearRangeToNextDecadeLabel},ref:this._onCalendarYearRef})}for(var E=[],S=0;S<c.shortMonths.length/4;S++)E.push(S);var x,T,N=v.leftNavigation,C=v.rightNavigation,k=!g||o.compareDatePart(g,o.getYearStart(n))<0,L=!y||o.compareDatePart(o.getYearEnd(n),y)<0;return r.createElement("div",{className:i.css("ms-DatePicker-monthPicker",l.monthPicker)},r.createElement("div",{className:i.css("ms-DatePicker-header",l.header)},this.props.onHeaderSelect||!b?r.createElement("div",{className:i.css("ms-DatePicker-currentYear js-showYearPicker",l.currentYear,l.headerToggleView),onClick:this._onHeaderSelect,onKeyDown:this._onHeaderKeyDown,"aria-label":m.formatYear(n),role:"button","aria-atomic":!0,"aria-live":"polite",tabIndex:0},m.formatYear(n)):r.createElement("div",{className:i.css("ms-DatePicker-currentYear js-showYearPicker",l.currentYear)},m.formatYear(n)),r.createElement("div",{className:i.css("ms-DatePicker-yearComponents",l.yearComponents)},r.createElement("div",{className:i.css("ms-DatePicker-navContainer",l.navContainer)},r.createElement("button",{className:i.css("ms-DatePicker-prevYear js-prevYear",l.prevYear,(x={},x["ms-DatePicker-prevYear--disabled "+l.prevYearIsDisabled]=!k,x)),disabled:!k,onClick:k?this._onSelectPrevYear:void 0,onKeyDown:k?this._onSelectPrevYearKeyDown:void 0,title:c.prevYearAriaLabel?c.prevYearAriaLabel+" "+m.formatYear(o.addYears(n,-1)):void 0,role:"button",type:"button"},r.createElement(u.Icon,{iconName:i.getRTL()?C:N})),r.createElement("button",{className:i.css("ms-DatePicker-nextYear js-nextYear",l.nextYear,(T={},T["ms-DatePicker-nextYear--disabled "+l.nextYearIsDisabled]=!L,T)),disabled:!L,onClick:L?this._onSelectNextYear:void 0,onKeyDown:L?this._onSelectNextYearKeyDown:void 0,title:c.nextYearAriaLabel?c.nextYearAriaLabel+" "+m.formatYear(o.addYears(n,1)):void 0,role:"button",type:"button"},r.createElement(u.Icon,{iconName:i.getRTL()?N:C}))))),r.createElement(s.FocusZone,null,r.createElement("div",{className:i.css("ms-DatePicker-optionGrid",l.optionGrid),role:"grid","aria-readonly":"true"},E.map(function(t){var s=c.shortMonths.slice(4*t,4*(t+1));return r.createElement("div",{key:"monthRow_"+t,role:"row"},s.map(function(s,u){var f,v=4*t+u,b=o.setMonth(n,v),w=e._isCurrentMonth(v,n.getFullYear(),h),E=n.getMonth()===v,S=a.getMonth()===v,x=a.getFullYear()===n.getFullYear(),T=(!g||o.compareDatePart(g,o.getMonthEnd(b))<1)&&(!y||o.compareDatePart(o.getMonthStart(b),y)<1);return r.createElement("button",{role:"gridcell",className:i.css("ms-DatePicker-monthOption",l.monthOption,(f={},f["ms-DatePicker-day--today "+l.monthIsCurrentMonth]=p&&w,f["ms-DatePicker-day--highlighted "+l.monthIsHighlighted]=(p||d)&&S&&x,f["ms-DatePicker-monthOption--disabled "+l.monthOptionIsDisabled]=!T,f)),disabled:!T,key:v,onClick:T?e._selectMonthCallbacks[v]:void 0,onKeyDown:T?e._onSelectMonthKeyDown(v):void 0,"aria-label":m.formatMonthYear(b,c),"aria-selected":w||E,"data-is-focusable":!!T||void 0,ref:E?"navigatedMonth":void 0,type:"button"},s)}))}))))};t.prototype.focus=function(){if(this._calendarYearRef)this._calendarYearRef.focus();else if(this.refs.navigatedMonth){this.refs.navigatedMonth.tabIndex=0;this.refs.navigatedMonth.focus()}};t.prototype._isCurrentMonth=function(e,t,n){return n.getFullYear()===t&&n.getMonth()===e};return t}(i.BaseComponent);t.CalendarMonth=c});
define("office-ui-fabric-react/lib/components/Calendar/CalendarYear",["require","exports","tslib","react","../../Utilities","../../FocusZone","./Calendar.scss","../../Icon"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o,f=12,l={prevRangeAriaLabel:void 0,nextRangeAriaLabel:void 0},c={leftNavigation:"Up",rightNavigation:"Down",closeIcon:"CalculatorMultiply"},h=function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._buttonRef=r.createRef();t._onRenderYear=function(){var e=t.props,n=e.year,r=e.onRenderYear;return r?r(n):n};t._onClick=function(){t.props.onSelectYear&&t.props.onSelectYear(t.props.year)};t._onKeyDown=function(e){t.props.onSelectYear&&e.which===i.KeyCodes.enter&&t.props.onSelectYear(t.props.year)};return t}t.prototype.focus=function(){this._buttonRef.current&&this._buttonRef.current.focus()};t.prototype.render=function(){var e,t=this.props,n=t.year,s=t.selected,o=t.disabled,u=t.onSelectYear;return r.createElement("button",{className:i.css("ms-DatePicker-yearOption",a.yearOption,(e={},e["ms-DatePicker-day--highlighted "+a.yearIsHighlighted]=s,e["ms-DatePicker-yearOption--disabled "+a.yearOptionIsDisabled]=o,e)),type:"button",role:"gridcell",onClick:!o&&u?this._onClick:void 0,onKeyDown:!o&&u?this._onKeyDown:void 0,disabled:o,"aria-label":String(n),"aria-selected":s,ref:this._buttonRef},this._onRenderYear())};return t}(r.Component),p=function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._selectedCellRef=r.createRef();t._currentCellRef=r.createRef();t._renderCell=function(e){var n=e===t.props.selectedYear,i=t.props,s=i.minYear,o=i.maxYear,u=i.onSelectYear,a=void 0!==s&&e<s||void 0!==o&&e>o,f=e===(new Date).getFullYear();return r.createElement(h,{key:e,year:e,selected:n,current:f,disabled:a,onSelectYear:u,ref:n?t._selectedCellRef:f?t._currentCellRef:void 0})};return t}t.prototype.focus=function(){this._selectedCellRef.current?this._selectedCellRef.current.focus():this._currentCellRef.current&&this._currentCellRef.current.focus()};t.prototype.render=function(){for(var e=this.props,t=e.fromYear,n=e.toYear,o=t,u=[];o<=n;){u.push(this._renderCell(o));o++}return r.createElement(s.FocusZone,null,r.createElement("div",{className:i.css("ms-DatePicker-optionGrid",a.optionGrid),role:"grid"},r.createElement("div",{role:"row"},u)))};return t}(r.Component),d=function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onSelectPrev=function(){!t.isDisabled&&t.props.onSelectPrev&&t.props.onSelectPrev()};t._onKeyDown=function(e){e.which===i.KeyCodes.enter&&t._onSelectPrev()};return t}t.prototype.render=function(){var e,t=this.props.navigationIcons||c,n=(this.props.strings||l).prevRangeAriaLabel,s={fromYear:this.props.fromYear-f,toYear:this.props.toYear-f},o=n?"string"==typeof n?n:n(s):void 0,h=this.isDisabled,p=this.props.onSelectPrev;return r.createElement("button",{className:i.css("ms-DatePicker-prevDecade",a.prevDecade,(e={},e["ms-DatePicker-prevDecade--disabled "+a.prevDecadeIsDisabled]=h,e)),onClick:!h&&p?this._onSelectPrev:void 0,onKeyDown:!h&&p?this._onKeyDown:void 0,type:"button",tabIndex:0,title:o,disabled:h},r.createElement(u.Icon,{iconName:i.getRTL()?t.rightNavigation:t.leftNavigation}))};Object.defineProperty(t.prototype,"isDisabled",{get:function(){var e=this.props.minYear;return void 0!==e&&this.props.fromYear<e},enumerable:!0,configurable:!0});return t}(r.Component),v=function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onSelectNext=function(){!t.isDisabled&&t.props.onSelectNext&&t.props.onSelectNext()};t._onKeyDown=function(e){e.which===i.KeyCodes.enter&&t._onSelectNext()};return t}t.prototype.render=function(){var e,t=this.props.navigationIcons||c,n=(this.props.strings||l).nextRangeAriaLabel,s={fromYear:this.props.fromYear+f,toYear:this.props.toYear+f},o=n?"string"==typeof n?n:n(s):void 0,h=this.props.onSelectNext,p=this.isDisabled;return r.createElement("button",{className:i.css("ms-DatePicker-nextDecade",a.nextDecade,(e={},e["ms-DatePicker-nextDecade--disabled "+a.nextDecadeIsDisabled]=p,e)),onClick:!p&&h?this._onSelectNext:void 0,onKeyDown:!p&&h?this._onKeyDown:void 0,type:"button",tabIndex:0,title:o,disabled:this.isDisabled},r.createElement(u.Icon,{iconName:i.getRTL()?t.leftNavigation:t.rightNavigation}))};Object.defineProperty(t.prototype,"isDisabled",{get:function(){var e=this.props.maxYear;return void 0!==e&&this.props.fromYear+f>e},enumerable:!0,configurable:!0});return t}(r.Component),m=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement("div",{className:i.css("ms-DatePicker-decadeComponents",a.decadeComponents)},r.createElement("div",{className:i.css("ms-DatePicker-navContainer",a.navContainer)},r.createElement(d,n.__assign({},this.props)),r.createElement(v,n.__assign({},this.props))))};return t}(r.Component),g=function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onHeaderSelect=function(){t.props.onHeaderSelect&&t.props.onHeaderSelect(!0)};t._onHeaderKeyDown=function(e){!t.props.onHeaderSelect||e.which!==i.KeyCodes.enter&&e.which!==i.KeyCodes.space||t.props.onHeaderSelect(!0)};t._onRenderYear=function(e){return t.props.onRenderYear?t.props.onRenderYear(e):e};return t}t.prototype.render=function(){var e=this.props,t=e.fromYear,n=e.toYear;if(e.onHeaderSelect){var s=(this.props.strings||l).rangeAriaLabel,o=s?"string"==typeof s?s:s(this.props):void 0;return r.createElement("div",{className:i.css("ms-DatePicker-currentDecade js-showYearPicker",a.currentDecade,a.headerToggleView),onClick:this._onHeaderSelect,onKeyDown:this._onHeaderKeyDown,"aria-label":o,role:"button","aria-atomic":!0,"aria-live":"polite",tabIndex:0},this._onRenderYear(t)," - ",this._onRenderYear(n))}return r.createElement("div",{className:i.css("ms-DatePicker-currentDecade js-showYearPicker",a.currentDecade)},this._onRenderYear(t)," - ",this._onRenderYear(n))};return t}(r.Component),y=function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onRenderTitle=function(){return t.props.onRenderTitle?t.props.onRenderTitle(t.props):r.createElement(g,n.__assign({},t.props))};t._onRenderNav=function(){return r.createElement(m,n.__assign({},t.props))};return t}t.prototype.render=function(){return r.createElement("div",{className:i.css("ms-DatePicker-header",a.header)},this._onRenderTitle(),this._onRenderNav())};return t}(r.Component),b=function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._gridRef=r.createRef();i._onNavNext=function(){i.setState({fromYear:i.state.fromYear+f})};i._onNavPrev=function(){i.setState({fromYear:i.state.fromYear-f})};i._renderHeader=function(){return r.createElement(y,n.__assign({},i.props,{fromYear:i.state.fromYear,toYear:i.state.fromYear+f-1,onSelectPrev:i._onNavPrev,onSelectNext:i._onNavNext}))};i._renderGrid=function(){return r.createElement(p,n.__assign({},i.props,{fromYear:i.state.fromYear,toYear:i.state.fromYear+f-1,ref:i._gridRef}))};i.state=i._calculateInitialStateFromProps(t);return i}t.prototype.focus=function(){this._gridRef.current&&this._gridRef.current.focus()};t.prototype.render=function(){return r.createElement("div",{className:i.css("ms-DatePicker-yearPicker",a.yearPicker)},this._renderHeader(),this._renderGrid())};t.prototype._calculateInitialStateFromProps=function(e){var t=e.selectedYear,n=e.navigatedYear,r=t||n||(new Date).getFullYear();return{fromYear:10*Math.floor(r/10),navigatedYear:n,selectedYear:t}};return t}(r.Component);t.CalendarYear=b});
define("office-ui-fabric-react/lib/components/Calendar/Calendar.types",["require","exports","../../utilities/dateValues/DateValues"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DayOfWeek=n.DayOfWeek;t.FirstWeekOfYear=n.FirstWeekOfYear;t.DateRangeType=n.DateRangeType});
define("office-ui-fabric-react/lib/components/DatePicker/DatePicker.styles",["require","exports","../../Styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={root:"ms-DatePicker",callout:"ms-DatePicker-callout",withLabel:"ms-DatePicker-event--with-label",withoutLabel:"ms-DatePicker-event--without-label",disabled:"msDatePickerDisabled "};t.styles=function(e){var t=e.className,i=e.theme,s=e.disabled,o=e.label,u=e.isDatePickerShown,a=i.palette,f=i.semanticColors,l=n.getGlobalClassNames(r,i),c={color:a.neutralSecondary,fontSize:n.FontSizes.icon,lineHeight:"18px",pointerEvents:"none",position:"absolute",right:"9px"};return{root:[l.root,i.fonts.medium,u&&"is-open",n.normalize,t],textField:[{position:"relative",selectors:{"& input[readonly]":{cursor:"pointer"},input:{selectors:{"::-ms-clear":{display:"none"}}}}},s&&{selectors:{"& input[readonly]":{cursor:"default"}}}],callout:[l.callout],icon:[c,!o&&[l.withoutLabel,{top:"7px"}],o&&[l.withLabel,{bottom:"5px"}],!s&&[l.disabled,{pointerEvents:"initial",cursor:"pointer"}],s&&{color:f.disabledText,cursor:"default"}]}}});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/ExpirationDatePicker/ExpirationDatePicker.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ExpirationDatePicker{margin-top:4px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;height:32px}.od-ExpirationDatePicker-content{border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.isFluent .od-ExpirationDatePicker-content{border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-ExpirationDatePicker-content,.od-ExpirationDatePicker-content-expired{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ExpirationDatePicker-content-expired:hover,.od-ExpirationDatePicker-content:hover{border-bottom-color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";cursor:pointer}.od-ExpirationDatePicker-content .ms-DatePicker,.od-ExpirationDatePicker-content-expired .ms-DatePicker{display:inline-block;margin-bottom:0;padding:0;width:100%}.od-ExpirationDatePicker-content .ms-DatePicker i,.od-ExpirationDatePicker-content-expired .ms-DatePicker i{display:none}.od-ExpirationDatePicker-content .ms-TextField-field,.od-ExpirationDatePicker-content .od-ExpirationDate-expiresLabel,.od-ExpirationDatePicker-content-expired .ms-TextField-field,.od-ExpirationDatePicker-content-expired .od-ExpirationDate-expiresLabel{height:28px;padding:0;-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex}[dir=ltr] .od-ExpirationDatePicker-content .ms-TextField-field.od-ExpirationDate-expiresLabelIE,[dir=ltr] .od-ExpirationDatePicker-content .od-ExpirationDate-expiresLabel.od-ExpirationDate-expiresLabelIE,[dir=ltr] .od-ExpirationDatePicker-content-expired .ms-TextField-field.od-ExpirationDate-expiresLabelIE,[dir=ltr] .od-ExpirationDatePicker-content-expired .od-ExpirationDate-expiresLabel.od-ExpirationDate-expiresLabelIE{padding-right:14px}[dir=rtl] .od-ExpirationDatePicker-content .ms-TextField-field.od-ExpirationDate-expiresLabelIE,[dir=rtl] .od-ExpirationDatePicker-content .od-ExpirationDate-expiresLabel.od-ExpirationDate-expiresLabelIE,[dir=rtl] .od-ExpirationDatePicker-content-expired .ms-TextField-field.od-ExpirationDate-expiresLabelIE,[dir=rtl] .od-ExpirationDatePicker-content-expired .od-ExpirationDate-expiresLabel.od-ExpirationDate-expiresLabelIE{padding-left:14px}.od-ExpirationDatePicker-content .ms-TextField-fieldGroup,.od-ExpirationDatePicker-content-expired .ms-TextField-fieldGroup{background:0 0}.od-ExpirationDatePicker-content .ms-TextField,.od-ExpirationDatePicker-content-expired .ms-TextField{margin-bottom:0;width:100%}.od-ExpirationDatePicker-content .ms-DatePicker .ms-TextField div,.od-ExpirationDatePicker-content-expired .ms-DatePicker .ms-TextField div{border-color:transparent;padding:0;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ExpirationDatePicker-content .ms-TextField-errorMessage,.od-ExpirationDatePicker-content-expired .ms-TextField-errorMessage{display:none}.od-ExpirationDatePicker-content .ms-Icon,.od-ExpirationDatePicker-content-expired .ms-Icon{font-size:20px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";margin-top:4px}.od-ExpirationDatePicker-label{display:inline-block;margin-top:7px}[dir=ltr] .od-ExpirationDatePicker-label{margin-right:8px}[dir=rtl] .od-ExpirationDatePicker-label{margin-left:8px}.isFluent .od-ExpirationDatePicker-label{font-size:16px}[dir=ltr] .isFluent .od-ExpirationDatePicker-label{margin-right:12px}[dir=rtl] .isFluent .od-ExpirationDatePicker-label{margin-left:12px}.od-ExpirationDatePicker-info{display:-webkit-box;display:-ms-flexbox;display:flex}[dir=ltr] .od-ExpirationDatePicker-info{margin-left:auto}[dir=rtl] .od-ExpirationDatePicker-info{margin-right:auto}.od-ExpirationDatePicker-info .ms-Icon{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";cursor:pointer;font-size:12px}[dir=ltr] .od-ExpirationDatePicker-info .ms-Icon{margin-left:10px}[dir=rtl] .od-ExpirationDatePicker-info .ms-Icon{margin-right:10px}.od-ExpirationDatePicker-delete{background-color:transparent;background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";cursor:pointer;font-size:16px;line-height:0;padding:0;height:16px}[dir=ltr] .od-ExpirationDatePicker-delete{margin-left:10px}[dir=rtl] .od-ExpirationDatePicker-delete{margin-right:10px}.ms-Fabric .od-ExpirationDatePicker-delete::-moz-focus-inner{border:0}.ms-Fabric .od-ExpirationDatePicker-delete{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-ExpirationDatePicker-delete:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-ExpirationDatePicker-delete:focus:after{border-color:ActiveBorder}}.od-ExpirationDatePicker-hidden{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.od-ExpirationDatePicker-expired{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.od-ExpirationDatePicker-content-expired{border-bottom:1px solid "},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.od-ExpirationDatePicker-content-expired .ms-TextField-field{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.od-ExpirationDatePicker-premiumGleam{height:12px;margin-top:2px;color:"},{theme:"yellow",defaultValue:"#ffb900"},{rawString:"}[dir=ltr] .od-ExpirationDatePicker-premiumGleam{padding-right:5px}[dir=rtl] .od-ExpirationDatePicker-premiumGleam{padding-left:5px}.ms-Fabric .od-ExpirationDatePicker-tooltipWrapper::-moz-focus-inner{border:0}.ms-Fabric .od-ExpirationDatePicker-tooltipWrapper{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-ExpirationDatePicker-tooltipWrapper:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-ExpirationDatePicker-tooltipWrapper:focus:after{border-color:ActiveBorder}}"}])});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/PasswordField/PasswordField",["require","exports","tslib","../PasswordStrengthMeter/PasswordStrengthMeter","office-ui-fabric-react/lib/TextField","office-ui-fabric-react/lib/Icon","../../Share.resx","@ms/odsp-utilities/lib/string/StringHelper","react","./PasswordField.scss","../../PermissionsList/ShareLink/ShareLink.scss"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._currentStrengthMeterValue="";i._onUpdatePassword=function(e,t){void 0===t&&(t="");var r=t.length>0;i.setState(n.__assign({},i.state,{currentPassword:t,displayRemovePasswordButton:r&&i.props.detailsPane}),function(){i.props.onPasswordChange(t)})};if(i.props.detailsPane){i.state={currentPassword:"************",disablePasswordField:!0,displayRemovePasswordButton:!0,displayNotificationText:!0,hasExistingPassword:!0}}else i.state=n.__assign({},i.state,{currentPassword:"",disablePasswordField:!1,displayRemovePasswordButton:!1,displayNotificationText:!1,hasExistingPassword:!1});i._renderShareReminder=i._renderShareReminder.bind(i);i._onFocusPasswordFieldDetails=i._onFocusPasswordFieldDetails.bind(i);i._onFocusPasswordField=i._onFocusPasswordField.bind(i);i._onBlurPasswordField=i._onBlurPasswordField.bind(i);i._onDeletePassword=i._onDeletePassword.bind(i);i._getPasswordFieldAriaLabel=i._getPasswordFieldAriaLabel.bind(i);i._getStrengthMeterValue=i._getStrengthMeterValue.bind(i);return i}t.prototype.render=function(){var e=this.props.detailsPane?this._onFocusPasswordFieldDetails:this._onFocusPasswordField,t=this._getPasswordFieldAriaLabel(),n=this.state.displayRemovePasswordButton?{iconName:"Cancel",onClick:this._onDeletePassword,className:"od-PasswordField-delete",ariaLabel:o.default.removePassword,tabIndex:0}:void 0;return a.createElement("div",{className:"od-PasswordField"},a.createElement("div",{className:"od-PasswordField-passwordFieldLine"},a.createElement("div",{className:"od-PasswordField-label"},a.createElement(s.Icon,{iconName:"Lock"})),a.createElement("div",{className:"od-ShareLink-passwordFieldContent"},a.createElement(i.TextField,{type:"password",autoComplete:"off",disabled:this.state.disablePasswordField,placeholder:o.default.setPasswordFieldText,value:this.state.currentPassword,onChange:this._onUpdatePassword,onFocus:e,onBlur:this._onBlurPasswordField,borderless:!0,ariaLabel:t,iconProps:n,readOnly:this.props.readOnly,tabIndex:this.props.tabIndex,"aria-describedby":"shareReminderText"})),this._renderPremiumGleam()),this._renderShareReminder())};t.prototype._renderShareReminder=function(){var e="od-PasswordField-shareReminder";this.props.detailsPane&&(e+="-detailsPane");return this.state.displayNotificationText?this.state.hasExistingPassword?this.props.detailsPane?a.createElement("div",{className:"odPasswordField-lastModifiedBy"},a.createElement("div",{className:e,id:"shareReminderText"},o.default.passwordFieldPasswordSetBy+this.props.lastModifiedBy)):void 0:this.state.currentPassword.length>0?a.createElement("div",{className:e},a.createElement(r.PasswordStrengthMeter,{currentPassword:this.state.currentPassword,getStrengthMeterValue:this._getStrengthMeterValue})):a.createElement("div",{className:e},o.default.passwordFieldShareReminder):a.createElement("div",{className:e},"")};t.prototype._renderPremiumGleam=function(){return this.props.showGleam?a.createElement("img",{role:"presentation",src:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/gleam.svg",className:"od-PasswordField-premiumGleam"}):void 0};t.prototype._onFocusPasswordFieldDetails=function(){var e=this;this.setState(n.__assign({},this.state,{currentPassword:"",displayNotificationText:!0,displayRemovePasswordButton:!1,hasExistingPassword:!1}),function(){e.props.onPasswordChange("")})};t.prototype._onFocusPasswordField=function(){this.setState(n.__assign({},this.state,{displayNotificationText:!0}))};t.prototype._onBlurPasswordField=function(){this.state.currentPassword.length>0||this.setState(n.__assign({},this.state,{displayNotificationText:!1}))};t.prototype._onDeletePassword=function(){var e=this;this.setState(n.__assign({},this.state,{currentPassword:"",disablePasswordField:!1,displayRemovePasswordButton:!1,hasExistingPassword:!1}),function(){e.props.onPasswordChange("")})};t.prototype._getPasswordFieldAriaLabel=function(){return this.state.currentPassword.length>0?u.format(o.default.currentStrength,this._currentStrengthMeterValue):o.default.passwordFieldName};t.prototype._getStrengthMeterValue=function(e){this._currentStrengthMeterValue=e};return t}(a.Component);t.PasswordField=f});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/PasswordStrengthMeter/PasswordStrengthMeter",["require","exports","tslib","react","office-ui-fabric-react/lib/ProgressIndicator","office-ui-fabric-react/lib/Tooltip","@ms/odsp-utilities/lib/string/StringHelper","../../Share.resx","./PasswordStrengthMeter.scss"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=[u.default.passwordStrengthMeterStrengthLevel0,u.default.passwordStrengthMeterStrengthLevel1,u.default.passwordStrengthMeterStrengthLevel2,u.default.passwordStrengthMeterStrengthLevel3,u.default.passwordStrengthMeterStrengthLevel4],f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._calculatePasswordStrength=n._calculatePasswordStrength.bind(n);n._renderStrengthText=n._renderStrengthText.bind(n);n._renderStrengthBar=n._renderStrengthBar.bind(n);return n}t.prototype.render=function(){var e=this._calculatePasswordStrength(this.props.currentPassword),t=o.format(u.default.currentStrength,a[e]);this.props.getStrengthMeterValue&&this.props.getStrengthMeterValue(a[e]);return r.createElement("div",{className:"od-PasswordStrengthMeter"},r.createElement(s.TooltipHost,{tooltipProps:{maxWidth:"300px",onRenderContent:function(){return r.createElement("div",null,r.createElement("ul",{style:{margin:0,padding:0}},r.createElement("div",{className:"od-PasswordStrengthMeter-StrengthExplanation"},u.default.passwordStrengthMeterStrengthExplanation1," ",r.createElement("br",null)),u.default.passwordStrengthMeterStrengthExplanation2," ",r.createElement("br",null),u.default.passwordStrengthMeterStrengthExplanation3," ",r.createElement("br",null),u.default.passwordStrengthMeterStrengthExplanation4))}}},r.createElement("div",{className:"od-PasswordStrengthMeter-test",tabIndex:0,"aria-label":t},this._renderStrengthText(e),this._renderStrengthBar(e))))};t.prototype._renderStrengthText=function(e){var t=a[e];return r.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationText"},r.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationText-StrengthText"},u.default.passwordStrengthMeterStrengthBarText),r.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationText "+t},t))};t.prototype._renderStrengthBar=function(e){var t=a[e];return r.createElement("div",{className:"od-PasswordStrengthMeter-StrengthNotificationBar "+t,"aria-hidden":!0,role:"presentation"},r.createElement(i.ProgressIndicator,{percentComplete:.25*e,barHeight:4}))};t.prototype._calculatePasswordStrength=function(e){var t=0;e.length>8&&t++;/[A-Z]/.test(e)&&/[a-z]/.test(e)&&t++;/\d/.test(e)&&t++;/[^A-Za-z0-9]/g.test(e)&&t++;return t};return t}(r.Component);t.PasswordStrengthMeter=f});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/PasswordStrengthMeter/PasswordStrengthMeter.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}[dir=ltr] .od-PasswordStrengthMeter{padding-left:6px}[dir=rtl] .od-PasswordStrengthMeter{padding-right:6px}.od-PasswordStrengthMeter .display-linebreak{white-space:pre-line}.od-PasswordStrengthMeter-StrengthExplanation{font-weight:700}.od-PasswordStrengthMeter-StrengthNotificationText{display:inline}.od-PasswordStrengthMeter-StrengthNotificationText.Weak{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationText.Fair{color:"},{theme:"orangeLight",defaultValue:"#ea4300"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationText.Good{color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationText.Strong{color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationText-StrengthText{display:inline;font-weight:700}.od-PasswordStrengthMeter-StrengthNotificationBar{width:auto}.od-PasswordStrengthMeter-StrengthNotificationBar.Weak .ms-ProgressIndicator-progressBar{background-color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationBar.Fair .ms-ProgressIndicator-progressBar{background-color:"},{theme:"orangeLight",defaultValue:"#ea4300"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationBar.Good .ms-ProgressIndicator-progressBar{background-color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}.od-PasswordStrengthMeter-StrengthNotificationBar.Strong .ms-ProgressIndicator-progressBar{background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-PasswordStrengthMeter-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}])});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/PasswordField/PasswordField.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-PasswordField{margin-top:4px;height:100%;width:100%;display:block}.od-PasswordField .od-PasswordField-passwordFieldLine{display:-webkit-box;display:-ms-flexbox;display:flex}.od-PasswordField .od-ShareLink-passwordFieldContent{height:32px;width:100%;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.isFluent .od-PasswordField .od-ShareLink-passwordFieldContent{border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-PasswordField .od-ShareLink-passwordFieldContent:hover{border-bottom-color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.od-PasswordField .ms-PasswordField .ms-TextField input::-webkit-input-placeholder{width:100%;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:14px}.od-PasswordField .ms-PasswordField .ms-TextField input::-moz-placeholder{width:100%;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:14px}.od-PasswordField .ms-PasswordField .ms-TextField input::-ms-input-placeholder{width:100%;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:14px}.od-PasswordField .ms-PasswordField .ms-TextField input::placeholder{width:100%;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:14px}.od-PasswordField .ms-TextField{width:100%;display:inline-block;padding:2px;height:28px;min-width:0;cursor:pointer;border-color:transparent}.od-PasswordField .ms-TextField .ms-TextField-fieldGroup{background:0 0}.od-PasswordField .ms-TextField-field{display:inline-block;padding:0;height:28px;min-width:0;width:100%;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-PasswordField .ms-Icon{font-size:20px;display:inline-block;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";margin-top:4px}.od-PasswordField-delete{-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:transparent;background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";cursor:pointer;display:-webkit-box;display:-ms-flexbox;display:flex;font-size:16px;line-height:0;padding:0}[dir=ltr] .od-PasswordField-delete{margin-left:auto}[dir=rtl] .od-PasswordField-delete{margin-right:auto}.od-PasswordField-label{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-top:7px}[dir=ltr] .od-PasswordField-label{margin-right:8px}[dir=rtl] .od-PasswordField-label{margin-left:8px}.isFluent .od-PasswordField-label{font-size:16px}[dir=ltr] .isFluent .od-PasswordField-label{margin-right:12px}[dir=rtl] .isFluent .od-PasswordField-label{margin-left:12px}.od-PasswordField-cancel{display:inline-block;vertical-align:top;margin-top:1px}.odPasswordField-lastModifiedBy{font-style:italic}.od-PasswordField-shareReminder{display:block;margin-top:3px;font-size:12px}[dir=ltr] .od-PasswordField-shareReminder{padding-left:22px}[dir=rtl] .od-PasswordField-shareReminder{padding-right:22px}.od-PasswordField-shareReminder-detailsPane{display:block;margin-top:8px;font-size:12px}[dir=ltr] .od-PasswordField-shareReminder-detailsPane{padding-left:36px}[dir=rtl] .od-PasswordField-shareReminder-detailsPane{padding-right:36px}.od-PasswordField-passwordField{display:-webkit-box;display:-ms-flexbox;display:flex}.od-PermissionsSettings-delete{background-color:transparent;background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";cursor:pointer;font-size:16px;line-height:0;padding:0}.ms-Fabric .od-PermissionsSettings-delete::-moz-focus-inner{border:0}.ms-Fabric .od-PermissionsSettings-delete{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-PermissionsSettings-delete:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-PermissionsSettings-delete:focus:after{border-color:ActiveBorder}}[dir=ltr] .od-PermissionsSettings-delete{margin-left:auto}[dir=rtl] .od-PermissionsSettings-delete{margin-right:auto}.od-PasswordField-premiumGleam{height:12px;margin-top:12px;color:"},{theme:"yellow",defaultValue:"#ffb900"},{rawString:"}[dir=ltr] .od-PasswordField-premiumGleam{padding-right:5px}[dir=rtl] .od-PasswordField-premiumGleam{padding-left:5px}"}])});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLink/ShareLink.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareLink{padding:26px 0 12px}.od-ShareLink.flightOff{padding:0}.od-ShareLink .od-ShareLink-main{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;position:relative}.od-ShareLink .od-ShareLink-main .ms-Button--default{border-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:12px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";min-width:54px;margin:0;padding:0}.ms-Fabric .od-ShareLink .od-ShareLink-main .ms-Button--default::-moz-focus-inner{border:0}.ms-Fabric .od-ShareLink .od-ShareLink-main .ms-Button--default{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-ShareLink .od-ShareLink-main .ms-Button--default:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-ShareLink .od-ShareLink-main .ms-Button--default:focus:after{border-color:ActiveBorder}}[dir=ltr] .od-ShareLink .od-ShareLink-main .ms-Button--default{border-left:0 solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}[dir=rtl] .od-ShareLink .od-ShareLink-main .ms-Button--default{border-right:0 solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.od-ShareLink-icon{position:relative;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:25px;border-radius:50%;width:50px;min-width:50px;height:50px}[dir=ltr] .od-ShareLink-icon{margin-right:10px}[dir=rtl] .od-ShareLink-icon{margin-left:10px}.od-ShareLink-icon i{position:absolute;top:50%}[dir=ltr] .od-ShareLink-icon i{left:50%}[dir=rtl] .od-ShareLink-icon i{right:50%}html[dir=ltr] .od-ShareLink-icon i{-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}html[dir=rtl] .od-ShareLink-icon i{-webkit-transform:translate(50%,-50%);transform:translate(50%,-50%)}.od-ShareLink-icon2{position:relative;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:17px;border-style:solid;border-width:1px;border-radius:50%;-webkit-box-sizing:border-box;box-sizing:border-box;width:32px;min-width:32px;height:32px}[dir=ltr] .od-ShareLink-icon2{margin-right:10px}[dir=rtl] .od-ShareLink-icon2{margin-left:10px}.od-ShareLink-icon2 i{position:absolute;top:50%}[dir=ltr] .od-ShareLink-icon2 i{left:50%}[dir=rtl] .od-ShareLink-icon2 i{right:50%}html[dir=ltr] .od-ShareLink-icon2 i{-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}html[dir=rtl] .od-ShareLink-icon2 i{-webkit-transform:translate(50%,-50%);transform:translate(50%,-50%)}.od-ShareLink-icon2.icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b}.od-ShareLink-icon2.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-ShareLink-icon2.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-ShareLink-icon2.icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c}.od-ShareLink-icon2.icon-FileRequest{color:#333;background:#fff;border:#fff;font-size:20px}.od-ShareLink-icon2.icon-PeopleAdd{color:#393939;background:#f2f2f2;border:1px solid #393939}.od-ShareLink-icon2.icon-SecurityGroup{color:#8e562e;background:#f4efeb;border:1px solid #8e562e}.od-ShareLink-details{-webkit-box-flex:1;-ms-flex:1;flex:1}.od-ShareLink-actionButton{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.ms-Fabric .od-ShareLink-actionButton::-moz-focus-inner{border:0}.ms-Fabric .od-ShareLink-actionButton{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-ShareLink-actionButton:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-ShareLink-actionButton:focus:after{border-color:ActiveBorder}}.od-ShareLink-description{padding-top:8px;font-size:12px}[dir=ltr] .od-ShareLink-description{padding-left:42px}[dir=rtl] .od-ShareLink-description{padding-right:42px}.od-ShareLink-description.flightOff{padding-top:0}[dir=ltr] .od-ShareLink-description.flightOff{padding-left:60px}[dir=rtl] .od-ShareLink-description.flightOff{padding-right:60px}.od-PermissionsList .od-ShareLink-description{cursor:pointer}.od-ShareLink-description .od-ShareLink-description-label{display:inline-block;font-size:11px}[dir=ltr] .od-ShareLink-description .od-ShareLink-description-label{margin-right:4px}[dir=rtl] .od-ShareLink-description .od-ShareLink-description-label{margin-left:4px}.od-ShareLink--inviteesHolder{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center}[dir=ltr] .od-ShareLink--inviteesHolder{padding-left:42px}[dir=rtl] .od-ShareLink--inviteesHolder{padding-right:42px}[dir=ltr] .od-ShareLink--inviteesHolder{padding-right:38px}[dir=rtl] .od-ShareLink--inviteesHolder{padding-left:38px}.ms-Fabric .od-ShareLink--inviteesHolder::-moz-focus-inner{border:0}.ms-Fabric .od-ShareLink--inviteesHolder{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-ShareLink--inviteesHolder:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-ShareLink--inviteesHolder:focus:after{border-color:ActiveBorder}}[dir=ltr] .od-ShareLink--inviteesHolder.flightOff{padding-left:60px}[dir=rtl] .od-ShareLink--inviteesHolder.flightOff{padding-right:60px}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%}[dir=ltr] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .ms-Facepile-members>*{margin-right:10px}[dir=rtl] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .ms-Facepile-members>*{margin-left:10px}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .ms-Persona-details{display:none}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerExpanded{font-size:12px;font-weight:600}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}[dir=ltr] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron{margin-left:auto}[dir=rtl] .od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron{margin-right:auto}.od-ShareLink--inviteesHolder .od-ShareLink--inviteesHolder-header .od-ShareLink--inviteesHolder-headerChevron .ms-Button-icon{font-size:12px}.od-ShareLink--inviteesHolder .od-ShareLink-participants{width:100%}ul.od-ShareLink-participants{cursor:default;list-style:none;padding:0}.od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{content:'';background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";display:block;height:7px}[dir=ltr] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-left:-62px}[dir=rtl] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-right:-62px}[dir=ltr] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-right:-58px}[dir=rtl] .od-ShareLink--inviteesHolder ul.od-ShareLink-participants::after{margin-left:-58px}.od-ShareLink-personaItem{padding:18px 0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ShareLink-personaItem .ms-Persona{width:100%}.od-ShareLink-personaItem .ms-Persona .ms-Persona-primaryText,.od-ShareLink-personaItem .ms-Persona .ms-Persona-secondaryText{overflow-y:hidden;overflow-x:hidden;white-space:nowrap;text-overflow:ellipsis}.od-ShareLink-personaItem .ms-Persona .ms-Persona-primaryText{font-size:15px;font:-apple-system-body}.od-ShareLink-personaItem .ms-Persona .ms-Persona-secondaryText{font-size:11px;color:#605e5c;font:-apple-system-caption1}.od-ShareLink-personaItem .ms-Button-icon{font-size:12px}.ms-Fabric .od-ShareLink-personaItem .ms-Button-icon::-moz-focus-inner{border:0}.ms-Fabric .od-ShareLink-personaItem .ms-Button-icon{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-ShareLink-personaItem .ms-Button-icon:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-ShareLink-personaItem .ms-Button-icon:focus:after{border-color:ActiveBorder}}.od-ShareLink-details-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.ms-Fabric .od-ShareLink-linkMember::-moz-focus-inner{border:0}.ms-Fabric .od-ShareLink-linkMember{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-ShareLink-linkMember:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-ShareLink-linkMember:focus:after{border-color:ActiveBorder}}"}])});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLink/ChangePermission/ChangePermission",["require","exports","tslib","react","../../../RoleSelector/RoleSelector","../../../Share.resx","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Tooltip"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._onAllowRoleChange=function(e){r.setState({selectedKey:e},function(){r.props.onRoleChange(e)})};r.state={selectedKey:r._getSelectedKey(t)};return r}t.prototype.render=function(){var e=this.props;return r.createElement(i.RoleSelector,{disabled:e.canChangePermission,role:this.state.selectedKey,onRoleChange:this._onAllowRoleChange,item:e.item,showReview:e.showReview},e.canChangePermission&&this._renderInfoIcon())};t.prototype._getSelectedKey=function(e){return e.selectedPermissions.sharingRole?e.selectedPermissions.sharingRole:e.selectedPermissions.isEdit?2:1};t.prototype._renderInfoIcon=function(){return r.createElement("div",{className:"od-changePermissions--info","aria-label":s.default.createNewLinkTooltip,"aria-haspopup":!0},r.createElement(u.TooltipHost,{id:"od-changePermissions--tooltip",content:s.default.createNewLinkTooltip,directionalHint:u.DirectionalHint.topLeftEdge,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"320px"}},r.createElement(o.Icon,{iconName:"Info","data-is-focusable":!0,"aria-describedby":"od-changePermissions--tooltip"})))};return t}(r.Component);t.ChangePermission=a});
define("@ms/odsp-shared-sharing/lib/components/RoleSelector/RoleSelector",["require","exports","tslib","react","office-ui-fabric-react/lib/Dropdown","office-ui-fabric-react/lib/Icon","../../utilities/ShareHelper","../Share.resx","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/utilities/decorators/withResponsiveMode","../../utilities/ShareHelper","./RoleSelector.scss"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t)||this;i._onRenderTitle=function(e){return r.createElement("span",null,e[0].text)};i._onRenderOption=function(e){var t=o.getRoleIconNameAndTitle(e.key);return r.createElement("div",{className:"od-RoleSelector-roleDropdownOption"},r.createElement("div",{className:"od-RoleSelector-roleDropdownOptionMainContent"},r.createElement(s.Icon,{className:"od-RoleSelector-settingIcon",iconName:t.name,title:t.title}),r.createElement("span",{className:"od-RoleSelector-roleDropdownOptionText"}," ",e.text," ")),r.createElement("span",{className:"od-RoleSelector-roleDropdownOptionSubtext"},e.data))};i._onAllowRoleChange=function(e){i.props.onRoleChange(e.key)};return i}t.prototype.render=function(){var e=this.props,t=o.getRoleIconNameAndTitle(e.role),n=!!this.props.showReview&&l.isNonOfficeFileCommentsAvailable(e.item)?[{key:1,text:u.default.canViewRole,data:u.default.canViewRoleSubText,ariaLabel:a.format(u.default.roleSelectorOptionAriaLabel,u.default.canViewRole,u.default.canViewRoleSubText)},{key:2,text:u.default.canEditRole,data:u.default.canEditRoleSubText,ariaLabel:a.format(u.default.roleSelectorOptionAriaLabel,u.default.canEditRole,u.default.canEditRoleSubText)},{key:6,text:u.default.canReviewRole,data:u.default.canReviewRoleSubText,ariaLabel:a.format(u.default.roleSelectorOptionAriaLabel,u.default.canReviewRole,u.default.canReviewRoleSubText)}]:[{key:1,text:u.default.canViewRole,data:u.default.canViewRoleSubText,ariaLabel:a.format(u.default.roleSelectorOptionAriaLabel,u.default.canViewRole,u.default.canViewRoleSubText)},{key:2,text:u.default.canEditRole,data:u.default.canEditRoleSubText,ariaLabel:a.format(u.default.roleSelectorOptionAriaLabel,u.default.canEditRole,u.default.canEditRoleSubText)}];return r.createElement("div",{className:"od-RoleSelector-wrapper"},r.createElement(s.Icon,{className:"od-RoleSelector-settingIcon",iconName:t.name,title:t.title}),r.createElement(i.Dropdown,{className:"od-RoleSelector-rolesDropdown",disabled:!!this.props.disabled,label:"",onRenderTitle:this._onRenderTitle,onRenderOption:this._onRenderOption,onChanged:this._onAllowRoleChange,defaultSelectedKey:this.props.role,calloutProps:{className:"od-RoleSelector-rolesDropdownOptionsCallout"},responsiveMode:f.ResponsiveMode.large,options:n,ariaLabel:this.props.ariaLabel}),this.props.children)};return t}(r.Component);t.RoleSelector=c});
define("@ms/odsp-shared-sharing/lib/components/RoleSelector/RoleSelector.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-RoleSelector-wrapper{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%}.od-RoleSelector-wrapper .ms-TooltipHost{position:absolute;top:9px;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .od-RoleSelector-wrapper .ms-TooltipHost{right:0}[dir=rtl] .od-RoleSelector-wrapper .ms-TooltipHost{left:0}.od-RoleSelector-wrapper .ms-Dropdown-container{width:100%}.od-RoleSelector-rolesDropdownOptionsCallout .ms-Dropdown-item{margin:0}[dir=ltr] .od-RoleSelector-rolesDropdownOptionsCallout .ms-Dropdown-item{padding-left:0}[dir=rtl] .od-RoleSelector-rolesDropdownOptionsCallout .ms-Dropdown-item{padding-right:0}.od-RoleSelector-rolesDropdown{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-RoleSelector-rolesDropdown .ms-Dropdown-title{border-top:none;border-left:none;border-right:none;border-bottom-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}[dir=ltr] .isFluent .od-RoleSelector-rolesDropdown .ms-Dropdown-title{padding-left:0}[dir=rtl] .isFluent .od-RoleSelector-rolesDropdown .ms-Dropdown-title{padding-right:0}.od-RoleSelector-rolesDropdown.is-open,.od-RoleSelector-rolesDropdown:hover{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-RoleSelector-rolesDropdown.is-open .ms-Dropdown-title,.od-RoleSelector-rolesDropdown.is-open:hover .ms-Dropdown-title{border-bottom-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-RoleSelector-rolesDropdown.is-disabled .ms-Dropdown-title{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}[dir=ltr] .od-RoleSelector-rolesDropdown.is-disabled .ms-Dropdown-caretDownWrapper{right:32px}[dir=rtl] .od-RoleSelector-rolesDropdown.is-disabled .ms-Dropdown-caretDownWrapper{left:32px}.od-RoleSelector-roleDropdownOption{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.od-RoleSelector-roleDropdownOption .od-RoleSelector-roleDropdownOptionMainContent{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-RoleSelector-roleDropdownOption .od-RoleSelector-roleDropdownOptionMainContent .od-RoleSelector-roleDropdownOptionText{font-weight:600}.od-RoleSelector-roleDropdownOption .od-RoleSelector-roleDropdownOptionSubtext{font-size:12px;line-height:1.3}[dir=ltr] .od-RoleSelector-roleDropdownOption .od-RoleSelector-roleDropdownOptionSubtext{padding-left:37px}[dir=rtl] .od-RoleSelector-roleDropdownOption .od-RoleSelector-roleDropdownOptionSubtext{padding-right:37px}[dir=ltr] .od-RoleSelector-roleDropdownOption .od-RoleSelector-roleDropdownOptionSubtext{text-align:left}[dir=rtl] .od-RoleSelector-roleDropdownOption .od-RoleSelector-roleDropdownOptionSubtext{text-align:right}.od-RoleSelector-settingIcon{font-size:17px}[dir=ltr] .od-RoleSelector-settingIcon{padding-left:8px}[dir=rtl] .od-RoleSelector-settingIcon{padding-right:8px}[dir=ltr] .od-RoleSelector-settingIcon{padding-right:12px}[dir=rtl] .od-RoleSelector-settingIcon{padding-left:12px}.isFluent .od-RoleSelector-settingIcon{font-size:16px}[dir=ltr] .isFluent .od-RoleSelector-settingIcon{padding-left:0}[dir=rtl] .isFluent .od-RoleSelector-settingIcon{padding-right:0}"}])});
define("@ms/odsp-shared-sharing/lib/utilities/PeoplePickerHelper",["require","exports","@ms/odsp-utilities/lib/string/StringHelper","react","office-ui-fabric-react/lib/Link","../components/Share.resx","@ms/odsp-datasources/lib/dataSources/roleAssignments/PrincipalType","../components/Share.resx"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getExternalPeopleCount=function(e){return e&&0!==e.length?e.filter(function(e){return 1===e.entityType}).length:0};t.getLinkedInPeopleCount=function(e){return e&&0!==e.length?e.filter(function(e){return 4===e.entityType}).length:0};t.getOversharingExternalsWarning=function(e){var t=e.filter(function(e){return 1===e.entityType}),n=t.length,r=t.map(function(e){return e.name});if(2===n){var i=(o=r.join(", ")).lastIndexOf(",");return o.substring(0,i)+" "+s.default.and+" "+o.substring(i+1)+" "+s.default.outsideOfYourOrgPlural}if(n>2){var o;i=(o=r.join(", ")).lastIndexOf(",");return o.substring(0,i+1)+" "+s.default.and+" "+o.substring(i+1)+" "+s.default.outsideOfYourOrgPlural}return 1===n?r[0]+" "+s.default.outsideOfYourOrgSingular:""};t.getOversharingGroupsWarning=function(e,t){var r=e.filter(function(e){return 2===e.entityType}).length,i="";1===r?i=s.default.oneGroupInvited:r>1&&(i=n.format(s.default.multipleGroupsInvited,r));t>=1e3?i+=" "+s.default.groupsMemberCountLargeLabel:t>=25&&(i+=" "+n.format(s.default.groupsMemberCountLabel,t));return i};t.renderPickerError=function(e){for(var t=e.selectedItems,n=e.sharingLinkKind,f=e.canAddExternalPrincipal,l=e.sharingInformation,c=e.viewPolicyTipCallback,h=e.permissionsMap,p=r.createElement("div",null,r.createElement("span",null,s.default.ptErrorMessage," "),r.createElement(i.Link,{onClick:c},s.default.ptViewPolicyTipLabel)),d=l.item.hasDlpPolicy||l.sharingAbilities&&7===l.sharingAbilities.directSharingAbilities.canAddExternalPrincipal.disabledReason,v=0,m=t;v<m.length;v++){var g=m[v];if(!g.isResolved)return d&&!f?p:g.rawData?a(g.rawData,l.customizedExternalSharingServiceUrl):r.createElement("span",null,s.default.noExactMatch);if(g.isExternal&&d&&!f)return p;if(g.isExternal&&g.principalType===o.default.distributionList&&2===g.entityType)return r.createElement("span",null,u.default.peoplePickerErrorDLNotSupported);var y=3===n||2===n;if(g.isExternal&&y)return r.createElement("span",null,s.default.peoplePickerErrorCsl)}if(h&&1===n){var b=0;for(var w in h)1===h[w]&&b++;if(1===b)return r.createElement("span",null,s.default.insufficientPermissionsError);if(b>1)return r.createElement("span",null,s.default.insufficientPermissionsErrorPlural)}return l.peoplePickerError?r.createElement("span",null,l.peoplePickerError):null};function a(e,t){var i=e.EntityData&&e.EntityData.BlockingSharingPolicy||0;return 0===i?r.createElement("span",null,e.Description):i>=401&&i<=404?t?r.createElement("div",null,n.formatToArray(s.default.externalSharingAllowDenyListWithLink,i,r.createElement("a",{href:t,target:"_blank"},s.default.noExternalSharingLearnMoreHere))):r.createElement("span",null,n.format(s.default.externalSharingAllowDenyList,i)):i>=200&&i<=209||i>=301&&i<=305?t?r.createElement("div",null,n.formatToArray(s.default.externalSharingDisabledWithLink,i,r.createElement("a",{href:t,target:"_blank"},s.default.noExternalSharingLearnMoreHere))):r.createElement("span",null,n.format(s.default.externalSharingDisabled,i)):void 0}});
define("@ms/odsp-shared-sharing/lib/utilities/SharingAbilitiesHelper",["require","exports","../interfaces/SharingInterfaces"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSharingAbilitiesAudience=function(e){return"anonymousLinkAbilities"===e?n.SharingAudience.anyone:"organizationLinkAbilities"===e?n.SharingAudience.organization:"peopleSharingLinkAbilities"===e?n.SharingAudience.specificPeopleFlex:void 0};function r(e,t){return e===n.SharingAudience.anyone?t.anonymousLinkAbilities:e===n.SharingAudience.organization?t.organizationLinkAbilities:e===n.SharingAudience.specificPeopleFlex?t.peopleSharingLinkAbilities:t.directSharingAbilities}t.getSharingAbilitiesByAudience=r;t.isEditingAllowed=function(e,t){var n=r(e,t);return!n.canManageEditLink||n.canManageEditLink.enabled};t.supportsRestrictedView=function(e,t){var n=r(e,t);return!!n.supportsRestrictedView&&n.supportsRestrictedView.enabled}});
define("@ms/odsp-shared-sharing/lib/components/PeoplePicker/PeoplePicker",["require","exports","tslib","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/MessageBar","@ms/odsp-shared-react/lib/PeoplePicker","../../interfaces/SharingInterfaces","react","prop-types","../Share.resx","@ms/odsp-utilities/lib/string/StringHelper","../../utilities/ClientIdHelper","../../utilities/ShareCommunicationManager","office-ui-fabric-react/lib/Spinner","@ms/odsp-utilities/lib/guid/Guid","./PeoplePicker.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PeoplePickerGraph={ODB:387};var v=function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._onItemsChange=function(e){var t=i.state.selectedItems.concat(e);i.setState({selectedItems:t},function(){i.props.onChange(t)});e.forEach(function(e){i._onAutoResolve(e)})};i._onInputChange=function(e){i._hasTakenErrorFocus=!1;if(e&&e.indexOf(";")>-1){var t=e.split(";").map(function(e){var t=/<[^\]]*>/g.exec(e);t&&t[0]&&(e=t[0].substring(1,t[0].length-1));if(e=e.trim())return i._createGenericPerson(e)}).filter(function(e){return e});i._onItemsChange(t);return""}var n=/['"].*['"]/g.exec(e);return n&&n[0]?n[0].substring(1,n[0].length-1):e};i._onGetMoreResults=function(e){var t=i.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:i._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!1,forceResolve:!0};return i._peoplePickerProvider.sharePointSearch(e,n)};i._onSuggestionSelected=function(e){var t=i.props.pickerSettings,n={principalSource:t.PrincipalSource,principalType:i._convertPrincipalType(t.PrincipalAccountType),querySettings:t.QuerySettings,allowEmailAddresses:t.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!1,forceResolve:!0};if(!1===e.isExternal||e.isExternal&&e.providerName)return e;if(e.principalType===o.PrincipalType.distributionList){n.isGraphDistributionList=!0;n.useGraph=!0}return i._peoplePickerProvider.resolve(e.userId,n).then(function(t){!t.email&&t.rawData&&t.rawData.EntityData&&(t.email=t.rawData.EntityData.OtherMails);!t.name&&t.rawData&&t.rawData.EntityData&&(t.name=t.rawData.EntityData.OtherMails);4===e.entityType&&(t.entityType=e.entityType);return t})};i._onRenderItem=function(e){var t=i.props.permissionsMap,r=i._computeAllowExternalUsers(i.props.sharingLinkKind,i.props.sharingInformation.canAddExternalPrincipal),o=e.item.isExternal&&!r||1===i.props.sharingLinkKind&&t&&(void 0!==t[e.item.email]&&1===t[e.item.email]||void 0!==t[e.item.userId]&&1===t[e.item.userId])||!e.item.isResolved&&!e.item.isResolving,a=e.item.name;e.removeButtonAriaLabel=l.format(f.default.removePersonLabel,a);e.item.imageAlt=l.format(f.default.userPhotoAriaLabel,a);return o?u.createElement("div",{className:"od-Share-PeoplePicker-selectedItem--error"},u.createElement(s.SelectedItemDefault,n.__assign({},e))):e.item.isResolving?u.createElement(p.Spinner,{className:"od-Share-PeoplePicker-resolve-spinner"}):u.createElement(s.SelectedItemDefault,n.__assign({},e))};i._onToggleGetMoreResults=function(e){i.state&&(e&&!i.state.searchForMoreText||!e&&i.state.searchForMoreText)&&i.setState({searchForMoreText:i._getSearchForMoreText(e)})};i._peoplePickerProvider=r.peoplePickerProvider;i._resize=r.resize;i._platformDetection=r.platformDetection;i._hasTakenErrorFocus=!1;i.state={selectedItems:t.defaultSelectedItems,searchForMoreText:i._getSearchForMoreText(t.sharingInformation.isGraphAvailable),addedUsers:[],removedUsers:[]};return i}t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.defaultSelectedItems,n=this.props.defaultSelectedItems,r=[];n.forEach(function(e){var n=t.filter(function(t){return t.name===e.name});n.length>0&&r.push(n[0].name)});this.setState({selectedItems:t,addedUsers:r})};t.prototype.componentDidUpdate=function(e,t){this._peoplePicker.scrollTop=this._peoplePicker.scrollHeight;var n=t.addedUsers,r=this.state.addedUsers,i=this.state.removedUsers;null!==this.props.error&&null===e.error&&this._resize();if(n.length>r.length){i=n.filter(function(e){return-1===r.indexOf(e)});this.setState({removedUsers:i})}else n.length!==r.length&&i.length>0&&this.setState({removedUsers:[]})};t.prototype.componentDidMount=function(){var e=this._platformDetection.isIE;!this._peoplePickerControl||c.isMobile(this.props.clientId)||e||this._peoplePickerControl.focusInput()};t.prototype.render=function(){var e=this,t={placeholder:this._computePlaceholderText(),onFocus:function(t){e._onFocus()},"aria-label":this._computeAddAnotherAriaLabel()},n=this.props.pickerSettings,r={principalSource:n.PrincipalSource,principalType:this._convertPrincipalType(n.PrincipalAccountType),querySettings:n.QuerySettings,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!!this.props.allowSPGroups,forceResolve:!0,useGraph:!this.props.disableGraph,useSubstrate:!0,onToggleGetMoreResults:this._onToggleGetMoreResults,conversationId:d.default.generate()},i=this.props.error?"od-Share-PeoplePicker ms-Share-PeoplePicker--error":"od-Share-PeoplePicker",o=c.isMobile(this.props.clientId)||this._platformDetection.isMobile,a={preventDismissOnScroll:o,preventDismissOnResize:!0},l=o?f.default.fabricPickerSuggestionsAvailableMobile:f.default.fabricPickerSuggestionsAvailable;return u.createElement("div",{className:"od-Share-PeoplePicker-wrapper",role:"presentation",ref:function(t){e._peoplePicker=t}},u.createElement("span",{role:"alert","aria-live":"assertive",className:"od-Share-screenReaderOnly"},this._computePeoplePickerLabel()),u.createElement(s.PeoplePicker,{componentRef:this._resolveRef("_peoplePickerControl"),className:i,dataProvider:this._peoplePickerProvider,selectedItems:this.state.selectedItems,inputProps:t,loadingText:f.default.loadingLabel,noResultsFoundText:f.default.noResultsLabel,onSelectedPersonasChange:this.props.onChange,peoplePickerQueryParams:r,suggestionsClassName:"od-Share-PeoplePicker-Suggestions"+(this._peoplePickerProvider.sharePointSearch?" od-Share-PeoplePicker-Suggestions-condensed":""),onRenderItem:this._onRenderItem,onSuggestionSelected:this._onSuggestionSelected,onResolvedSuggestions:this.props.onResolvedSuggestions,itemLimit:100,onInputChange:this._onInputChange,onGetMoreResults:this._peoplePickerProvider.sharePointSearch?this._onGetMoreResults:null,searchForMoreText:this._peoplePickerProvider.sharePointSearch?this.state.searchForMoreText:null,suggestionsAvailableAlertText:l,enableSelectedSuggestionAlert:this._platformDetection.isIE,role:"presentation",pickerCalloutProps:a}),this._renderError(),this._renderWarnings(),u.createElement("span",{role:"alert",className:"od-Share-screenReaderOnly"},this.props.error))};t.prototype._createGenericPerson=function(e){return{userId:e,name:e,email:e,isResolving:!0}};t.prototype._onAutoResolve=function(e){var t=this,r=this.props.pickerSettings,i={principalSource:r.PrincipalSource,principalType:this._convertPrincipalType(r.PrincipalAccountType),querySettings:r.QuerySettings,allowEmailAddresses:r.AllowEmailAddresses,filterExternalUsers:!1,maximumEntitySuggestions:30,allowSharePointGroups:!1,forceResolve:!0};this._peoplePickerProvider.resolve(e.email,i).then(function(n){!n.email&&n.rawData&&n.rawData.EntityData&&(n.email=n.rawData.EntityData.OtherMails);!n.name&&n.rawData&&n.rawData.EntityData&&(n.name=n.rawData.EntityData.OtherMails);var r=[];t.state.selectedItems.forEach(function(t){t.email===e.email?r.push(n):r.push(t)});t.setState({selectedItems:r},function(){t.props.onChange(r)})}).catch(function(){var r=n.__assign({},e,{isResolving:!1}),i=[];t.state.selectedItems.forEach(function(t){t.email===e.email?i.push(r):i.push(t)});t.setState({selectedItems:i},function(){t.props.onChange(i)})})};t.prototype._isResolveInProgress=function(){for(var e=0,t=this.state.selectedItems;e<t.length;e++){if(t[e].isResolving)return!0}return!1};t.prototype._computePlaceholderText=function(){return this.props.inputTextPlaceholder&&this.props.inputTextPlaceholder.length>0?this.props.inputTextPlaceholder:0===this.props.defaultSelectedItems.length?f.default.peoplePickerPlaceholder:f.default.peoplePickerPlaceholderWithSelection};t.prototype._computePeoplePickerLabel=function(){var e=this.state,t=e.addedUsers,n=e.removedUsers,r=[];t.length>0&&(r=r.concat(t.map(function(e){return l.format(f.default.peoplePickerPersonAddedAlert,e)})));n.length>0&&(r=r.concat(n.map(function(e){return l.format(f.default.peoplePickerPersonRemovedAlert,e)})));return r.length>0?r.toString():""};t.prototype._convertPrincipalType=function(e){if(!e)return o.PrincipalType.none;for(var t=o.PrincipalType.none,n=0,r=e.split(",");n<r.length;n++){var i=r[n];"User"===i&&(t|=o.PrincipalType.user);"DL"===i&&(t|=o.PrincipalType.distributionList);"SecGroup"===i&&(t|=o.PrincipalType.securityGroup);"SPGroup"===i&&(t|=o.PrincipalType.sharePointGroup)}return t};t.prototype._computeAllowExternalUsers=function(e,t){return!(2===e||3===e)&&t};t.prototype._renderError=function(){var e=this.props.error;if(e&&!this._isResolveInProgress()){if(this._peoplePickerControl&&!c.isMobile(this.props.clientId)&&!this._hasTakenErrorFocus){this._peoplePickerControl.focusInput();this._hasTakenErrorFocus=!0}return u.createElement("span",{className:"od-Share-PeoplePicker-error",role:"alert"},e)}};t.prototype._renderWarnings=function(){var e=this.props.oversharingExternalsWarning,t=this.props.oversharingGroupsWarning,n=[];if(!this.props.error){100===this.state.selectedItems.length&&n.push(u.createElement(i.MessageBar,{ariaLabel:f.default.peoplePickerLimitMessage},f.default.peoplePickerLimitMessage));e&&n.push(u.createElement(i.MessageBar,{ariaLabel:e},e));t&&n.push(u.createElement(i.MessageBar,{ariaLabel:t},t));return n.length>0?u.createElement("div",{"aria-live":"assertive",role:"status",className:"od-Share-PeoplePicker-warning"},n):void 0}};t.prototype._getSearchForMoreText=function(e){return e?f.default.searchForMoreText:void 0};t.prototype._onFocus=function(){h.peoplePickerFocused()};t.prototype._computeAddAnotherAriaLabel=function(){return 0===this.props.defaultSelectedItems.length?f.default.selectedItemListLabel:f.default.selectedItemAddAnotherAriaLabel};t.contextTypes={peoplePickerProvider:a.object.isRequired,resize:a.func.isRequired,platformDetection:a.object.isRequired};return t}(r.BaseComponent);t.default=v});
define("office-ui-fabric-react/lib/MessageBar",["require","exports","tslib","./components/MessageBar/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("office-ui-fabric-react/lib/components/MessageBar/index",["require","exports","tslib","./MessageBar","./MessageBar.base","./MessageBar.types"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t)});
define("office-ui-fabric-react/lib/components/MessageBar/MessageBar",["require","exports","../../Utilities","./MessageBar.base","./MessageBar.styles"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MessageBar=n.styled(r.MessageBarBase,i.getStyles,void 0,{scope:"MessageBar"})});
define("office-ui-fabric-react/lib/components/MessageBar/MessageBar.base",["require","exports","tslib","react","../../Utilities","../../Button","../../Icon","./MessageBar.types"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i.classNamesFunction(),f=function(e){n.__extends(t,e);function t(t){var n,r=e.call(this,t)||this;r.ICON_MAP=((n={})[u.MessageBarType.info]="Info",n[u.MessageBarType.warning]="Info",n[u.MessageBarType.error]="ErrorBadge",n[u.MessageBarType.blocked]="Blocked2",n[u.MessageBarType.remove]="Blocked",n[u.MessageBarType.severeWarning]="Warning",n[u.MessageBarType.success]="Completed",n);r._onClick=function(e){r.setState({expandSingleLine:!r.state.expandSingleLine})};r.state={labelId:i.getId("MessageBar"),showContent:!1,expandSingleLine:!1};return r}t.prototype.render=function(){var e=this.props.isMultiline;this._classNames=this._getClassNames();return e?this._renderMultiLine():this._renderSingleLine()};t.prototype._getActionsDiv=function(){return this.props.actions?r.createElement("div",{className:this._classNames.actions},this.props.actions):null};t.prototype._getDismissDiv=function(){return this.props.onDismiss?r.createElement(s.IconButton,{disabled:!1,className:this._classNames.dismissal,onClick:this.props.onDismiss,iconProps:{iconName:"Clear"},ariaLabel:this.props.dismissButtonAriaLabel}):null};t.prototype._getDismissSingleLine=function(){return this.props.onDismiss?r.createElement("div",{className:this._classNames.dismissSingleLine},this._getDismissDiv()):null};t.prototype._getExpandSingleLine=function(){return!this.props.actions&&this.props.truncated?r.createElement("div",{className:this._classNames.expandSingleLine},r.createElement(s.IconButton,{disabled:!1,className:this._classNames.expand,onClick:this._onClick,iconProps:{iconName:this.state.expandSingleLine?"DoubleChevronUp":"DoubleChevronDown"},ariaLabel:this.props.overflowButtonAriaLabel,"aria-expanded":this.state.expandSingleLine,"aria-controls":this.state.labelId})):null};t.prototype._getIconSpan=function(){return r.createElement("div",{className:this._classNames.iconContainer,"aria-hidden":!0},r.createElement(o.Icon,{iconName:this.ICON_MAP[this.props.messageBarType],className:this._classNames.icon}))};t.prototype._renderMultiLine=function(){var e=this.props.theme;return r.createElement("div",{style:{background:e.semanticColors.bodyBackground}},r.createElement("div",{className:this._classNames.root},r.createElement("div",{className:this._classNames.content},this._getIconSpan(),this._renderInnerText(),this._getDismissDiv()),this._getActionsDiv()))};t.prototype._renderSingleLine=function(){var e=this.props.theme;return r.createElement("div",{style:{background:e.semanticColors.bodyBackground}},r.createElement("div",{className:this._classNames.root},r.createElement("div",{className:this._classNames.content},this._getIconSpan(),this._renderInnerText(),this._getExpandSingleLine(),this._getActionsDiv(),this._getDismissSingleLine())))};t.prototype._renderInnerText=function(){var e=i.getNativeProps(this.props,i.htmlElementProperties,["className"]);return r.createElement("div",{className:this._classNames.text,id:this.state.labelId},r.createElement("span",n.__assign({className:this._classNames.innerText,role:"status","aria-live":this._getAnnouncementPriority()},e),r.createElement(i.DelayedRender,null,r.createElement("span",null,this.props.children))))};t.prototype._getClassNames=function(){var e=this.props,t=e.theme,n=e.className,r=e.messageBarType,i=e.onDismiss,s=e.actions,o=e.truncated,f=e.isMultiline,l=this.state.expandSingleLine;return a(this.props.styles,{theme:t,messageBarType:r||u.MessageBarType.info,onDismiss:void 0!==i,actions:void 0!==s,truncated:o,isMultiline:f,expandSingleLine:l,className:n})};t.prototype._getAnnouncementPriority=function(){switch(this.props.messageBarType){case u.MessageBarType.blocked:case u.MessageBarType.error:case u.MessageBarType.severeWarning:return"assertive"}return"polite"};t.defaultProps={messageBarType:u.MessageBarType.info,onDismiss:void 0,isMultiline:!0};return t}(i.BaseComponent);t.MessageBarBase=f});
define("office-ui-fabric-react/lib/components/MessageBar/MessageBar.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.info=0]="info";e[e.error=1]="error";e[e.blocked=2]="blocked";e[e.severeWarning=3]="severeWarning";e[e.success=4]="success";e[e.warning=5]="warning";e[e.remove=9e4]="remove"}(t.MessageBarType||(t.MessageBarType={}))});
define("office-ui-fabric-react/lib/components/MessageBar/MessageBar.styles",["require","exports","tslib","../../Styling","./MessageBar.types"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={root:"ms-MessageBar",error:"ms-MessageBar--error",blocked:"ms-MessageBar--blocked",severeWarning:"ms-MessageBar--severeWarning",success:"ms-MessageBar--success",warning:"ms-MessageBar--warning",multiline:"ms-MessageBar-multiline",singleline:"ms-MessageBar-singleline",dismissalSingleLine:"ms-MessageBar-dismissalSingleLine",expandingSingleLine:"ms-MessageBar-expandingSingleLine",content:"ms-MessageBar-content",iconContainer:"ms-MessageBar-icon",text:"ms-MessageBar-text",innerText:"ms-MessageBar-innerText",dismissSingleLine:"ms-MessageBar-dismissSingleLine",expandSingleLine:"ms-MessageBar-expandSingleLine",dismissal:"ms-MessageBar-dismissal",expand:"ms-MessageBar-expand",actions:"ms-MessageBar-actions",actionsSingleline:"ms-MessageBar-actionsSingleLine"},o=function(e,t,n){switch(e){case i.MessageBarType.error:case i.MessageBarType.blocked:return n.errorBackground;case i.MessageBarType.severeWarning:return n.blockingBackground;case i.MessageBarType.success:return n.successBackground;case i.MessageBarType.warning:return n.warningBackground}return t.neutralLighter},u=function(e,t,n){switch(e){case i.MessageBarType.error:case i.MessageBarType.blocked:case i.MessageBarType.severeWarning:return n.errorText;case i.MessageBarType.success:return t.green;case i.MessageBarType.warning:return n.warningText}return t.neutralSecondary};t.getStyles=function(e){var t,a,f,l,c,h,p,d,v,m,g,y,b=e.theme,w=e.className,E=e.messageBarType,S=e.onDismiss,x=e.actions,T=e.truncated,N=e.isMultiline,C=e.expandSingleLine,k=b.semanticColors,L=b.palette,A=b.fonts,O=r.getScreenSelector(0,r.ScreenWidthMaxSmall),M=r.getGlobalClassNames(s,b),_={fontSize:12,height:12,lineHeight:"12px",color:L.neutralPrimary,selectors:(t={},t[r.HighContrastSelector]={MsHighContrastAdjust:"none",color:"window"},t)},D={display:"flex",selectors:{"& .ms-Button-icon":_}},P=[r.getFocusStyle(b,{inset:1,highContrastStyle:{outlineOffset:"-4px",outlineColor:"Window"},borderColor:"transparent"}),{flexShrink:0,margin:8,marginLeft:0,selectors:(a={"& .ms-Button-icon":_},a[O]={margin:"0px 0px 0px 8px"},a)}],H=r.getFocusStyle(b,{borderColor:L.black});return{root:[M.root,b.fonts.medium,E===i.MessageBarType.error&&M.error,E===i.MessageBarType.blocked&&M.blocked,E===i.MessageBarType.severeWarning&&M.severeWarning,E===i.MessageBarType.success&&M.success,E===i.MessageBarType.warning&&M.warning,N?M.multiline:M.singleline,!N&&S&&M.dismissalSingleLine,!N&&T&&M.expandingSingleLine,{background:o(E,L,k),color:L.neutralPrimary,minHeight:32,width:"100%",boxSizing:"border-box",display:"flex",wordBreak:"break-word",selectors:(f={"& .ms-Link":n.__assign({color:L.themeDark},A.small)},f[r.HighContrastSelector]={background:"windowText",color:"Window"},f)},N&&{flexDirection:"column"},!N&&{selectors:(l={},l[O]={flexDirection:"column"},l)},T&&{flexDirection:"column",selectors:{"& .ms-Button-icon":_}},w],content:[M.content,{display:"flex",lineHeight:"normal",width:"100%",boxSizing:"border-box"},!N&&{selectors:(c={},c[O]={flexDirection:"row"},c)},(T||N)&&{flexDirection:"row"}],iconContainer:[M.iconContainer,{fontSize:16,minWidth:16,minHeight:16,display:"flex",color:L.neutralSecondary,flexShrink:0,margin:16,marginRight:0,selectors:(h={},h[O]={margin:"8px 0px 8px 8px"},h)}],icon:{color:u(E,L,k),selectors:(p={},p[r.HighContrastSelector]={MsHighContrastAdjust:"none",color:"window"},p)},text:[M.text,n.__assign({minWidth:0,display:"flex",flexGrow:1,margin:"16px 8px"},A.small,{selectors:(d={},d[O]={margin:"8px 0px 8px 8px"},d[r.HighContrastSelector]={MsHighContrastAdjust:"none",color:"window"},d)}),!S&&{marginRight:16,selectors:(v={},v[O]={marginRight:8},v)},N&&x&&{marginBottom:8,selectors:(m={},m[O]={marginBottom:0},m)},!N&&x&&{selectors:(g={},g[O]={marginBottom:0},g)}],innerText:[M.innerText,{lineHeight:16,selectors:{"& span":{selectors:{"& a":{paddingLeft:4}}}}},T&&{overflow:"visible",whiteSpace:"pre-wrap"},!N&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},!N&&!T&&{selectors:(y={},y[O]={overflow:"visible",whiteSpace:"pre-wrap"},y)},C&&{overflow:"visible",whiteSpace:"pre-wrap"}],dismissSingleLine:[M.dismissSingleLine,D],expandSingleLine:[M.expandSingleLine,D],dismissal:[M.dismissal,P,H],expand:[M.expand,P,H],actions:[N?M.actions:M.actionsSingleline,{display:"flex",flexGrow:0,flexShrink:0,flexBasis:"auto",flexDirection:"row-reverse",alignItems:"center",margin:"8px 8px 8px 0",selectors:{"& button:nth-child(n+2)":{marginLeft:8}}},N&&{margin:"0px 12px 12px 0",selectors:{"& button:nth-child(n+2)":{marginLeft:12}}}]}}});
define("@ms/odsp-shared-react/lib/PeoplePicker",["require","exports","tslib","./components/PeoplePicker/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/odsp-shared-react/lib/components/PeoplePicker/index",["require","exports","tslib","./PeoplePicker","./PeoplePicker.Props","./PeoplePickerDefaultItems"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t)});
define("@ms/odsp-shared-react/lib/components/PeoplePicker/PeoplePicker",["require","exports","tslib","@ms/shared-react-people-picker/lib/PeoplePicker","@ms/shared-react-people-picker/lib/PeoplePicker"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.PeoplePicker});
define("@ms/shared-react-people-picker/lib/PeoplePicker",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Pickers","@ms/odsp-datasources/lib/PeoplePicker","@ms/odsp-datasources/lib/dataSources/roleAssignments/PrincipalType","./PeoplePickerDefaultItems","./PeoplePicker.Props","./PeoplePicker.resx","./PeoplePicker.scss"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=s.BasePicker,h=s.BasePickerListBelow,p=function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r._onResolveSuggestions=function(e){if(r._peoplePickerSearchPromise){r._peoplePickerSearchPromise.cancel();r._peoplePickerSearchPromise=void 0}if((e=e.trim()).length<2)return r.props.onResolvedSuggestions?r.props.onResolvedSuggestions([],e):[];var t=r._dataProvider.search(e.trim(),r._getPeoplePickerQueryParams());if(!t)return r.props.onResolvedSuggestions?r.props.onResolvedSuggestions([],e):[];var n=t.cached?t.cached:[];r._peoplePickerSearchPromise=t.promise;return r._peoplePickerSearchPromise.then(function(e){r._peoplePickerSearchPromise=void 0;return e?n.concat(e):[]}).then(function(t){return r.props.onResolvedSuggestions?r.props.onResolvedSuggestions(t,e):t})};r._onGetMoreResults=function(e){var t;if(r.props.peoplePickerQueryParams){(t=n.__assign({},r.props.peoplePickerQueryParams)).useGraph=!1;t.useSubstrate=!1}return r._dataProvider&&r._dataProvider.sharePointSearch&&t?r._dataProvider.sharePointSearch(e,t):[]};if(t.dataProvider)r._dataProvider=t.dataProvider;else{if(!t.context)throw new Error("No pageContext available for PeoplePickerProvider.");r._dataProvider=new o.PeoplePickerProvider({pageContext:t.context,peoplePickerDataSource:t.dataSource})}r._handleGetMoreResultsInBaseClass=!!(r._dataProvider.canUseGraph&&r.props.peoplePickerQueryParams&&r._dataProvider.canUseGraph(r.props.peoplePickerQueryParams))&&!r.props.onGetMoreResults;r.state={hasUnresolvedText:!1,searchForMoreText:r._getSearchForMoreText(r._handleGetMoreResultsInBaseClass)};return r}Object.defineProperty(t.prototype,"selectedPeople",{get:function(){return this._peoplePicker&&this._peoplePicker.items||[]},enumerable:!0,configurable:!0});t.prototype.render=function(){var e=this.props,t=e.className,i=e.onRenderItem,s=e.onRenderSuggestionsItem,o=e.defaultSelectedItems,u=e.onSelectedPersonasChange,l=e.suggestionsHeaderText,p=e.suggestionsClassName,d=e.noResultsFoundText,v=e.loadingText,m=e.inputProps,g=e.onSuggestionSelected,y=e.suggestionsAvailableAlertText,b=e.enableSelectedSuggestionAlert,w=e.selectedItems,E=e.itemLimit,S=e.onInputChange,x=e.onGetMoreResults,T=e.searchForMoreText,N=e.pickerCalloutProps,C={className:t,onRenderSuggestionsItem:s||a.SuggestionItemDefault,onResolveSuggestions:this._onResolveSuggestions,defaultSelectedItems:o,selectedItems:w,onChange:u,inputProps:m,enableSelectedSuggestionAlert:b,pickerSuggestionsProps:{suggestionsHeaderText:l,loadingText:v,noResultsFoundText:d,className:p,suggestionsAvailableAlertText:y,searchForMoreText:T||(this._handleGetMoreResultsInBaseClass?this.state.searchForMoreText:void 0)},onItemSelected:g,itemLimit:E,onInputChange:S,onGetMoreResults:x||(this._handleGetMoreResultsInBaseClass?this._onGetMoreResults:void 0),pickerCalloutProps:N};switch(this.props.peoplePickerType){case f.PeoplePickerType.listBelow:C.onRenderItem=i||a.SelectedItemBelowDefault;return r.createElement(h,n.__assign({},C,{componentRef:this._resolveRef("_peoplePicker")}));default:C.onRenderItem=i||a.SelectedItemDefault;return r.createElement(c,n.__assign({},C,{componentRef:this._resolveRef("_peoplePicker")}))}};t.prototype.focusInput=function(){this._peoplePicker&&this._peoplePicker.focusInput()};t.prototype._getPeoplePickerQueryParams=function(){if(this.props.peoplePickerQueryParams){!this.props.peoplePickerQueryParams.onToggleGetMoreResults&&this._handleGetMoreResultsInBaseClass&&(this.props.peoplePickerQueryParams.onToggleGetMoreResults=this._onToggleGetMoreResults);return this.props.peoplePickerQueryParams}return{allowEmailAddresses:!1,groupID:0,maximumEntitySuggestions:30,principalSource:15,blockExternalUsers:!0,principalType:u.default.user|u.default.securityGroup|u.default.sharePointGroup}};t.prototype._onToggleGetMoreResults=function(e){this.state&&(e&&!this.state.searchForMoreText||!e&&this.state.searchForMoreText)&&this.setState({searchForMoreText:this._getSearchForMoreText(e)})};t.prototype._getSearchForMoreText=function(e){return e?l.default.searchForMoreText:void 0};return t}(i.BaseComponent);t.PeoplePicker=p;t.default=p});
define("office-ui-fabric-react/lib/Pickers",["require","exports","tslib","./components/pickers/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("office-ui-fabric-react/lib/components/pickers/index",["require","exports","tslib","./Suggestions/Suggestions","./Suggestions/Suggestions.types","./Suggestions/SuggestionsItem","./Suggestions/SuggestionsController","./AutoFill/BaseAutoFill","./BasePicker","./BasePicker.types","./PeoplePicker/PeoplePicker","./PeoplePicker/PeoplePickerItems/PeoplePickerItem","./PeoplePicker/PeoplePickerItems/PeoplePickerItemSuggestion","./TagPicker/TagPicker","./TagPicker/TagItem","./TagPicker/TagItemSuggestion"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t);n.__exportStar(f,t);n.__exportStar(l,t);n.__exportStar(c,t);n.__exportStar(h,t);n.__exportStar(p,t);n.__exportStar(d,t);n.__exportStar(v,t)});
define("office-ui-fabric-react/lib/components/pickers/Suggestions/Suggestions",["require","exports","tslib","react","../../../Utilities","../../../Button","../../../Spinner","./Suggestions.types","./SuggestionsItem","./SuggestionsItem.styles","./Suggestions.scss"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=l,h=i.classNamesFunction(),p=i.styled(a.SuggestionsItem,f.getStyles,void 0,{scope:"SuggestionItem"}),d=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._forceResolveButton=r.createRef();n._searchForMoreButton=r.createRef();n._selectedElement=r.createRef();n.tryHandleKeyDown=function(e,t){var r=!1,s=null,o=n.state.selectedActionType,a=n.props.suggestions.length;if(e===i.KeyCodes.down)switch(o){case u.SuggestionActionType.forceResolve:if(a>0){n._refocusOnSuggestions(e);s=u.SuggestionActionType.none}else s=n._searchForMoreButton.current?u.SuggestionActionType.searchMore:u.SuggestionActionType.forceResolve;break;case u.SuggestionActionType.searchMore:if(n._forceResolveButton.current)s=u.SuggestionActionType.forceResolve;else if(a>0){n._refocusOnSuggestions(e);s=u.SuggestionActionType.none}else s=u.SuggestionActionType.searchMore;break;case u.SuggestionActionType.none:-1===t&&n._forceResolveButton.current&&(s=u.SuggestionActionType.forceResolve)}else if(e===i.KeyCodes.up)switch(o){case u.SuggestionActionType.forceResolve:if(n._searchForMoreButton.current)s=u.SuggestionActionType.searchMore;else if(a>0){n._refocusOnSuggestions(e);s=u.SuggestionActionType.none}break;case u.SuggestionActionType.searchMore:if(a>0){n._refocusOnSuggestions(e);s=u.SuggestionActionType.none}else n._forceResolveButton.current&&(s=u.SuggestionActionType.forceResolve);break;case u.SuggestionActionType.none:-1===t&&n._searchForMoreButton.current&&(s=u.SuggestionActionType.searchMore)}if(null!==s){n.setState({selectedActionType:s});r=!0}return r};n._getMoreResults=function(){n.props.onGetMoreResults&&n.props.onGetMoreResults()};n._forceResolve=function(){n.props.createGenericItem&&n.props.createGenericItem()};n._shouldShowForceResolve=function(){return!!n.props.showForceResolve&&n.props.showForceResolve()};n._onClickTypedSuggestionsItem=function(e,t){return function(r){n.props.onSuggestionClick(r,e,t)}};n._refocusOnSuggestions=function(e){"function"==typeof n.props.refocusSuggestions&&n.props.refocusSuggestions(e)};n._onRemoveTypedSuggestionsItem=function(e,t){return function(r){(0,n.props.onSuggestionRemove)(r,e,t);r.stopPropagation()}};n.state={selectedActionType:u.SuggestionActionType.none};return n}t.prototype.componentDidMount=function(){this.scrollSelected();this.activeSelectedElement=this._selectedElement?this._selectedElement.current:null};t.prototype.componentDidUpdate=function(){if(this._selectedElement.current&&this.activeSelectedElement!==this._selectedElement.current){this.scrollSelected();this.activeSelectedElement=this._selectedElement.current}};t.prototype.render=function(){var e=this,t=this.props,a=t.forceResolveText,f=t.mostRecentlyUsedHeaderText,l=t.searchForMoreText,p=t.className,d=t.moreSuggestionsAvailable,v=t.noResultsFoundText,m=t.suggestions,g=t.isLoading,y=t.isSearching,b=t.loadingText,w=t.onRenderNoResultFound,E=t.searchingText,S=t.isMostRecentlyUsedVisible,x=t.resultsMaximumNumber,T=t.resultsFooterFull,N=t.resultsFooter,C=t.isResultsFooterVisible,k=void 0===C||C,L=t.suggestionsAvailableAlertText,A=t.suggestionsHeaderText,O=t.suggestionsClassName,M=t.theme,_=t.styles;this._classNames=_?h(_,{theme:M,className:p,suggestionsClassName:O,forceResolveButtonSelected:this.state.selectedActionType===u.SuggestionActionType.forceResolve,searchForMoreButtonSelected:this.state.selectedActionType===u.SuggestionActionType.searchMore}):{root:i.css("ms-Suggestions",p,c.root),title:i.css("ms-Suggestions-title",c.suggestionsTitle),searchForMoreButton:i.css("ms-SearchMore-button",c.actionButton,(F={},F["is-selected "+c.buttonSelected]=this.state.selectedActionType===u.SuggestionActionType.searchMore,F)),forceResolveButton:i.css("ms-forceResolve-button",c.actionButton,(I={},I["is-selected "+c.buttonSelected]=this.state.selectedActionType===u.SuggestionActionType.forceResolve,I)),suggestionsAvailable:i.css("ms-Suggestions-suggestionsAvailable",c.suggestionsAvailable),suggestionsContainer:i.css("ms-Suggestions-container",c.suggestionsContainer,O),noSuggestions:i.css("ms-Suggestions-none",c.suggestionsNone)};var D=this._classNames.subComponentStyles?this._classNames.subComponentStyles.spinner:void 0,P=_?{styles:D}:{className:i.css("ms-Suggestions-spinner",c.suggestionsSpinner)},H=function(){return v?r.createElement("div",{role:"alert",className:e._classNames.noSuggestions},v):null},B=A;S&&f&&(B=f);var j=void 0;k&&(j=m.length>=x?T:N);var F,I,q=!(m&&m.length||g);return r.createElement("div",{className:this._classNames.root},B?r.createElement("div",{className:this._classNames.title},B):null,a&&this._shouldShowForceResolve()&&r.createElement(s.CommandButton,{componentRef:this._forceResolveButton,className:this._classNames.forceResolveButton,onClick:this._forceResolve},a),g&&r.createElement(o.Spinner,n.__assign({},P,{label:b})),q?w?w(void 0,H):H():this._renderSuggestions(),l&&d&&r.createElement(s.CommandButton,{componentRef:this._searchForMoreButton,className:this._classNames.searchForMoreButton,iconProps:{iconName:"Search"},onClick:this._getMoreResults},l),y?r.createElement(o.Spinner,n.__assign({},P,{label:E})):null,!j||d||S||y?null:r.createElement("div",{className:this._classNames.title},j(this.props)),r.createElement("span",{role:"alert","aria-live":"polite",className:this._classNames.suggestionsAvailable},!g&&!y&&m&&m.length>0&&L?L:null))};t.prototype.hasSuggestedAction=function(){return void 0!==this._searchForMoreButton.current||void 0!==this._forceResolveButton.current};t.prototype.hasSuggestedActionSelected=function(){return this.state.selectedActionType!==u.SuggestionActionType.none};t.prototype.executeSelectedAction=function(){switch(this.state.selectedActionType){case u.SuggestionActionType.forceResolve:this._forceResolve();break;case u.SuggestionActionType.searchMore:this._getMoreResults()}};t.prototype.focusAboveSuggestions=function(){this._forceResolveButton.current?this.setState({selectedActionType:u.SuggestionActionType.forceResolve}):this._searchForMoreButton.current&&this.setState({selectedActionType:u.SuggestionActionType.searchMore})};t.prototype.focusBelowSuggestions=function(){this._searchForMoreButton.current?this.setState({selectedActionType:u.SuggestionActionType.searchMore}):this._forceResolveButton.current&&this.setState({selectedActionType:u.SuggestionActionType.forceResolve})};t.prototype.focusSearchForMoreButton=function(){this._searchForMoreButton.current&&this._searchForMoreButton.current.focus()};t.prototype.scrollSelected=function(){this._selectedElement.current&&void 0!==this._selectedElement.current.scrollIntoView&&this._selectedElement.current.scrollIntoView(!1)};t.prototype._renderSuggestions=function(){var e=this,t=this.props,n=t.onRenderSuggestion,i=t.removeSuggestionAriaLabel,s=t.suggestionsItemClassName,o=t.resultsMaximumNumber,u=t.showRemoveButtons,a=t.suggestionsContainerAriaLabel,f=t.suggestionsListId,l=this.props.suggestions,c=p,h=-1;l.some(function(e,t){if(e.selected){h=t;return!0}return!1});o&&(l=h>=o?l.slice(h-o+1,h+1):l.slice(0,o));return 0===l.length?null:r.createElement("div",{className:this._classNames.suggestionsContainer,id:f,role:"listbox","aria-label":a},l.map(function(t,o){return r.createElement("div",{ref:t.selected?e._selectedElement:void 0,key:t.item.key?t.item.key:o,id:"sug-"+o,"aria-selected":t.selected,role:"option","aria-label":t.ariaLabel},r.createElement(c,{suggestionModel:t,RenderSuggestion:n,onClick:e._onClickTypedSuggestionsItem(t.item,o),className:s,showRemoveButton:u,removeButtonAriaLabel:i,onRemoveItem:e._onRemoveTypedSuggestionsItem(t.item,o)}))}))};return t}(i.BaseComponent);t.Suggestions=d});
define("office-ui-fabric-react/lib/components/pickers/Suggestions/Suggestions.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.none=0]="none";e[e.forceResolve=1]="forceResolve";e[e.searchMore=2]="searchMore"}(t.SuggestionActionType||(t.SuggestionActionType={}))});
define("office-ui-fabric-react/lib/components/pickers/Suggestions/SuggestionsItem",["require","exports","tslib","react","../../../Utilities","../../../Button","./Suggestions.scss"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=o,a=i.classNamesFunction(),f=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e,t=this.props,n=t.suggestionModel,o=t.RenderSuggestion,f=t.onClick,l=t.className,c=t.onRemoveItem,h=t.isSelectedOverride,p=t.removeButtonAriaLabel,d=t.styles,v=t.theme,m=d?a(d,{theme:v,className:l,suggested:n.selected||h}):{root:i.css("ms-Suggestions-item",u.suggestionsItem,(e={},e["is-suggested "+u.suggestionsItemIsSuggested]=n.selected||h,e),l),itemButton:i.css("ms-Suggestions-itemButton",u.itemButton),closeButton:i.css("ms-Suggestions-closeButton",u.closeButton)};return r.createElement("div",{className:m.root},r.createElement(s.CommandButton,{onClick:f,className:m.itemButton},o(n.item,this.props)),this.props.showRemoveButton?r.createElement(s.IconButton,{iconProps:{iconName:"Cancel",styles:{root:{fontSize:"12px"}}},title:p,ariaLabel:p,onClick:c,className:m.closeButton}):null)};return t}(i.BaseComponent);t.SuggestionsItem=f});
define("office-ui-fabric-react/lib/components/pickers/Suggestions/Suggestions.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".root_18d80577{min-width:260px}.suggestionsItem_18d80577{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;position:relative;overflow:hidden}.suggestionsItem_18d80577:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.suggestionsItem_18d80577:hover .closeButton_18d80577{display:block}.suggestionsItem_18d80577.suggestionsItemIsSuggested_18d80577{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.suggestionsItem_18d80577.suggestionsItemIsSuggested_18d80577:hover{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}@media screen and (-ms-high-contrast: active){.suggestionsItem_18d80577.suggestionsItemIsSuggested_18d80577:hover{background:Highlight;color:HighlightText}}@media screen and (-ms-high-contrast: active){.suggestionsItem_18d80577.suggestionsItemIsSuggested_18d80577{background:Highlight;color:HighlightText;-ms-high-contrast-adjust:none}}.suggestionsItem_18d80577.suggestionsItemIsSuggested_18d80577 .closeButton_18d80577:hover{background:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}@media screen and (-ms-high-contrast: active){.suggestionsItem_18d80577.suggestionsItemIsSuggested_18d80577 .itemButton_18d80577{color:HighlightText}}.suggestionsItem_18d80577 .closeButton_18d80577{display:none;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.suggestionsItem_18d80577 .closeButton_18d80577:hover{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.actionButton_18d80577{background:none;background-color:transparent;border:0;cursor:pointer;margin:0;position:relative;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";height:40px;width:100%;font-size:12px}[dir='ltr'] .actionButton_18d80577{padding-left:8px}[dir='rtl'] .actionButton_18d80577{padding-right:8px}html[dir='ltr'] .actionButton_18d80577{text-align:left}html[dir='rtl'] .actionButton_18d80577{text-align:right}.actionButton_18d80577:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";cursor:pointer}.actionButton_18d80577:focus,.actionButton_18d80577:active{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.actionButton_18d80577 .ms-Button-icon{font-size:16px;width:25px}.actionButton_18d80577 .ms-Button-label{margin:0 4px 0 9px}html[dir='rtl'] .actionButton_18d80577 .ms-Button-label{margin:0 9px 0 4px}.buttonSelected_18d80577{background-color:"},{theme:"themeLight",defaultValue:"#c7e0f4"},{rawString:"}.suggestionsTitle_18d80577{padding:0 12px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:12px;line-height:40px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.suggestionsContainer_18d80577{overflow-y:auto;overflow-x:hidden;max-height:300px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.suggestionsNone_18d80577{text-align:center;color:#767676;font-size:12px;line-height:30px}.suggestionsSpinner_18d80577{margin:5px 0;white-space:nowrap;line-height:20px;font-size:12px}html[dir='ltr'] .suggestionsSpinner_18d80577{padding-left:14px}html[dir='rtl'] .suggestionsSpinner_18d80577{padding-right:14px}html[dir='ltr'] .suggestionsSpinner_18d80577{text-align:left}html[dir='rtl'] .suggestionsSpinner_18d80577{text-align:right}.suggestionsSpinner_18d80577 .ms-Spinner-circle{display:inline-block;vertical-align:middle}.suggestionsSpinner_18d80577 .ms-Spinner-label{display:inline-block;margin:0px 10px 0 16px;vertical-align:middle}html[dir='rtl'] .suggestionsSpinner_18d80577 .ms-Spinner-label{margin:0px 16px 0 10px}.itemButton_18d80577.itemButton_18d80577{width:100%;padding:0px;min-width:0;height:100%}@media screen and (-ms-high-contrast: active){.itemButton_18d80577.itemButton_18d80577{color:WindowText}}.itemButton_18d80577.itemButton_18d80577:hover{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.closeButton_18d80577.closeButton_18d80577{padding:0 4px;height:auto;width:32px}@media screen and (-ms-high-contrast: active){.closeButton_18d80577.closeButton_18d80577{color:WindowText}}.closeButton_18d80577.closeButton_18d80577:hover{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.suggestionsAvailable_18d80577{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);t.root="root_18d80577";t.suggestionsItem="suggestionsItem_18d80577";t.closeButton="closeButton_18d80577";t.suggestionsItemIsSuggested="suggestionsItemIsSuggested_18d80577";t.itemButton="itemButton_18d80577";t.actionButton="actionButton_18d80577";t.buttonSelected="buttonSelected_18d80577";t.suggestionsTitle="suggestionsTitle_18d80577";t.suggestionsContainer="suggestionsContainer_18d80577";t.suggestionsNone="suggestionsNone_18d80577";t.suggestionsSpinner="suggestionsSpinner_18d80577";t.suggestionsAvailable="suggestionsAvailable_18d80577"});
define("office-ui-fabric-react/lib/components/pickers/Suggestions/SuggestionsItem.styles",["require","exports","../../../Styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SuggestionsItemGlobalClassNames={root:"ms-Suggestions-item",itemButton:"ms-Suggestions-itemButton",closeButton:"ms-Suggestions-closeButton",isSuggested:"is-suggested"};t.getStyles=function(e){var r,i,s,o=e.className,u=e.theme,a=e.suggested,f=u.palette,l=n.getGlobalClassNames(t.SuggestionsItemGlobalClassNames,u);return{root:[l.root,{display:"flex",alignItems:"stretch",boxSizing:"border-box",width:"100%",position:"relative",selectors:{"&:hover":{background:f.neutralLighter},"&:hover .ms-Suggestions-closeButton":{display:"block"}}},o],itemButton:[l.itemButton,{width:"100%",padding:0,border:"none",height:"100%",minWidth:0,overflow:"hidden",selectors:(r={},r[n.HighContrastSelector]={color:"WindowText",selectors:{":hover":{background:"Highlight",color:"HighlightText",MsHighContrastAdjust:"none"}}},r[":hover"]={color:f.neutralDark},r)},a&&[l.isSuggested,{background:f.neutralLight,selectors:(i={":hover":{background:f.neutralTertiaryAlt}},i[n.HighContrastSelector]={background:"Highlight",color:"HighlightText",MsHighContrastAdjust:"none"},i)}]],closeButton:[l.closeButton,{display:"none",color:f.neutralSecondary,padding:"0 4px",height:"auto",width:32,selectors:(s={":hover, :active":{background:f.neutralTertiaryAlt,color:f.neutralDark}},s[n.HighContrastSelector]={color:"WindowText"},s)},a&&{selectors:{":hover, :active":{background:f.neutralTertiary,color:f.neutralPrimary}}}]}}});
define("office-ui-fabric-react/lib/components/pickers/Suggestions/SuggestionsController",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){var e=this;this._isSuggestionModel=function(e){return void 0!==e.item};this._ensureSuggestionModel=function(t){return e._isSuggestionModel(t)?t:{item:t,selected:!1,ariaLabel:t.name||t.primaryText}};this.suggestions=[];this.currentIndex=-1}e.prototype.updateSuggestions=function(e,t){if(e&&e.length>0){this.suggestions=this.convertSuggestionsToSuggestionItems(e);this.currentIndex=t||0;if(-1===t)this.currentSuggestion=void 0;else if(void 0!==t){this.suggestions[t].selected=!0;this.currentSuggestion=this.suggestions[t]}}else{this.suggestions=[];this.currentIndex=-1;this.currentSuggestion=void 0}};e.prototype.nextSuggestion=function(){if(this.suggestions&&this.suggestions.length){if(this.currentIndex<this.suggestions.length-1){this.setSelectedSuggestion(this.currentIndex+1);return!0}if(this.currentIndex===this.suggestions.length-1){this.setSelectedSuggestion(0);return!0}}return!1};e.prototype.previousSuggestion=function(){if(this.suggestions&&this.suggestions.length){if(this.currentIndex>0){this.setSelectedSuggestion(this.currentIndex-1);return!0}if(0===this.currentIndex){this.setSelectedSuggestion(this.suggestions.length-1);return!0}}return!1};e.prototype.getSuggestions=function(){return this.suggestions};e.prototype.getCurrentItem=function(){return this.currentSuggestion};e.prototype.getSuggestionAtIndex=function(e){return this.suggestions[e]};e.prototype.hasSelectedSuggestion=function(){return!!this.currentSuggestion};e.prototype.removeSuggestion=function(e){this.suggestions.splice(e,1)};e.prototype.createGenericSuggestion=function(e){var t=this.convertSuggestionsToSuggestionItems([e])[0];this.currentSuggestion=t};e.prototype.convertSuggestionsToSuggestionItems=function(e){return Array.isArray(e)?e.map(this._ensureSuggestionModel):[]};e.prototype.deselectAllSuggestions=function(){if(this.currentIndex>-1){this.suggestions[this.currentIndex].selected=!1;this.currentIndex=-1}};e.prototype.setSelectedSuggestion=function(e){if(e>this.suggestions.length-1||e<0){this.currentIndex=0;this.currentSuggestion.selected=!1;this.currentSuggestion=this.suggestions[0];this.currentSuggestion.selected=!0}else{this.currentIndex>-1&&(this.suggestions[this.currentIndex].selected=!1);this.suggestions[e].selected=!0;this.currentIndex=e;this.currentSuggestion=this.suggestions[e]}};return e}();t.SuggestionsController=n});
define("office-ui-fabric-react/lib/components/pickers/AutoFill/BaseAutoFill",["require","exports","tslib","../../Autofill/Autofill"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("office-ui-fabric-react/lib/components/Autofill/Autofill",["require","exports","tslib","react","../../Utilities"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._inputElement=r.createRef();n._autoFillEnabled=!0;n._onCompositionStart=function(e){n._autoFillEnabled=!1};n._onCompositionEnd=function(e){var t=n._getCurrentInputValue();n._tryEnableAutofill(t,n.value,!1,!0);var r="ko"===e.nativeEvent.locale;n._async.setTimeout(function(){var e=r?n.value:n._getCurrentInputValue();n._updateValue(e)},0)};n._onClick=function(){n._value&&""!==n._value&&n._autoFillEnabled&&(n._autoFillEnabled=!1)};n._onKeyDown=function(e){n.props.onKeyDown&&n.props.onKeyDown(e);if(!e.nativeEvent.isComposing)switch(e.which){case i.KeyCodes.backspace:n._autoFillEnabled=!1;break;case i.KeyCodes.left:case i.KeyCodes.right:if(n._autoFillEnabled){n._value=n.state.displayValue;n._autoFillEnabled=!1}break;default:n._autoFillEnabled||-1!==n.props.enableAutofillOnKeyPress.indexOf(e.which)&&(n._autoFillEnabled=!0)}};n._onInputChanged=function(e){var t=n._getCurrentInputValue(e);n._tryEnableAutofill(t,n._value,e.nativeEvent.isComposing);n._updateValue(t)};n._onChanged=function(){};n._updateValue=function(e){if(e||e!==n._value){n._value=n.props.onInputChange?n.props.onInputChange(e):e;n.setState({displayValue:n._getDisplayValue(n._value,n.props.suggestedDisplayValue)},function(){return n._notifyInputChange(n._value)})}};n._value=t.defaultVisibleValue||"";n.state={displayValue:t.defaultVisibleValue||""};return n}Object.defineProperty(t.prototype,"cursorLocation",{get:function(){if(this._inputElement.current){var e=this._inputElement.current;return"forward"!==e.selectionDirection?e.selectionEnd:e.selectionStart}return-1},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"isValueSelected",{get:function(){return Boolean(this.inputElement&&this.inputElement.selectionStart!==this.inputElement.selectionEnd)},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"selectionStart",{get:function(){return this._inputElement.current?this._inputElement.current.selectionStart:-1},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"selectionEnd",{get:function(){return this._inputElement.current?this._inputElement.current.selectionEnd:-1},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"inputElement",{get:function(){return this._inputElement.current},enumerable:!0,configurable:!0});t.prototype.componentWillReceiveProps=function(e){var t;this.props.updateValueInWillReceiveProps&&(t=this.props.updateValueInWillReceiveProps());"string"==typeof(t=this._getDisplayValue(t||this._value,e.suggestedDisplayValue))&&this.setState({displayValue:t})};t.prototype.componentDidUpdate=function(){var e=this._value,t=this.props,n=t.suggestedDisplayValue,r=t.shouldSelectFullInputValueInComponentDidUpdate,i=0;if(!t.preventValueSelection&&this._autoFillEnabled&&e&&n&&this._doesTextStartWith(n,e)){var s=!1;r&&(s=r());if(s&&this._inputElement.current)this._inputElement.current.setSelectionRange(0,n.length,"backward");else{for(;i<e.length&&e[i].toLocaleLowerCase()===n[i].toLocaleLowerCase();)i++;i>0&&this._inputElement.current&&this._inputElement.current.setSelectionRange(i,n.length,"backward")}}};t.prototype.render=function(){var e=this.state.displayValue,t=i.getNativeProps(this.props,i.inputProperties);return r.createElement("input",n.__assign({},t,{ref:this._inputElement,value:e,autoCapitalize:"off",autoComplete:"off",onCompositionStart:this._onCompositionStart,onCompositionEnd:this._onCompositionEnd,onChange:this._onChanged,onInput:this._onInputChanged,onKeyDown:this._onKeyDown,onClick:this.props.onClick?this.props.onClick:this._onClick,"data-lpignore":!0}))};t.prototype.focus=function(){this._inputElement.current&&this._inputElement.current.focus()};t.prototype.clear=function(){this._autoFillEnabled=!0;this._updateValue("");this._inputElement.current&&this._inputElement.current.setSelectionRange(0,0)};t.prototype._getCurrentInputValue=function(e){return e&&e.target&&e.target.value?e.target.value:this.inputElement&&this.inputElement.value?this.inputElement.value:""};t.prototype._tryEnableAutofill=function(e,t,n,r){!n&&e&&this._inputElement.current&&this._inputElement.current.selectionStart===e.length&&!this._autoFillEnabled&&(e.length>t.length||r)&&(this._autoFillEnabled=!0)};t.prototype._notifyInputChange=function(e){this.props.onInputValueChange&&this.props.onInputValueChange(e)};t.prototype._getDisplayValue=function(e,t){var n=e;t&&e&&this._doesTextStartWith(t,n)&&this._autoFillEnabled&&(n=t);return n};t.prototype._doesTextStartWith=function(e,t){return!(!e||!t)&&0===e.toLocaleLowerCase().indexOf(t.toLocaleLowerCase())};t.defaultProps={enableAutofillOnKeyPress:[i.KeyCodes.down,i.KeyCodes.up]};return t}(i.BaseComponent);t.Autofill=s;var o=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t}(s);t.BaseAutoFill=o});
define("office-ui-fabric-react/lib/components/pickers/BasePicker",["require","exports","tslib","react","../../Utilities","../../FocusZone","../../Callout","../../utilities/selection/index","./Suggestions/Suggestions","./Suggestions/Suggestions.styles","./Suggestions/SuggestionsController","./BasePicker.types","../Autofill/index","./BasePicker.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=p,v=i.classNamesFunction();var m=function(e){n.__extends(t,e);function t(t){var n,s=e.call(this,t)||this;s.root=r.createRef();s.input=r.createRef();s.focusZone=r.createRef();s.suggestionElement=r.createRef();s.SuggestionOfProperType=a.Suggestions;s._styledSuggestions=(n=s.SuggestionOfProperType,i.styled(n,f.getStyles,void 0,{scope:"Suggestions"}));s.dismissSuggestions=function(e){var t=function(){s.props.onDismiss&&s.props.onDismiss(e,s.suggestionStore.currentSuggestion?s.suggestionStore.currentSuggestion.item:void 0);(!e||e&&!e.defaultPrevented)&&s.canAddItems()&&s.suggestionStore.hasSelectedSuggestion()&&s.state.suggestedDisplayValue&&s.addItemByIndex(0)};s.currentPromise?s.currentPromise.then(function(){return t()}):t();s.setState({suggestionsVisible:!1})};s.refocusSuggestions=function(e){s.resetFocus();s.suggestionStore.suggestions&&s.suggestionStore.suggestions.length>0&&(e===i.KeyCodes.up?s.suggestionStore.setSelectedSuggestion(s.suggestionStore.suggestions.length-1):e===i.KeyCodes.down&&s.suggestionStore.setSelectedSuggestion(0))};s.onInputChange=function(e){s.updateValue(e);s.setState({moreSuggestionsAvailable:!0,isMostRecentlyUsedVisible:!1})};s.onSuggestionClick=function(e,t,n){s.addItemByIndex(n);s.setState({suggestionsVisible:!1})};s.onSuggestionRemove=function(e,t,n){s.props.onRemoveSuggestion&&s.props.onRemoveSuggestion(t);s.suggestionStore.removeSuggestion(n)};s.onInputFocus=function(e){if(!s.state.isFocused){s.setState({isFocused:!0});s.selection.setAllSelected(!1);if(s.input.current&&""===s.input.current.value&&s.props.onEmptyInputFocus){s.onEmptyInputFocus();s.setState({isMostRecentlyUsedVisible:!0,moreSuggestionsAvailable:!1,suggestionsVisible:!0})}else s.input.current&&s.input.current.value&&s.setState({isMostRecentlyUsedVisible:!1,suggestionsVisible:!0});s.props.inputProps&&s.props.inputProps.onFocus&&s.props.inputProps.onFocus(e)}};s.onInputBlur=function(e){s.props.inputProps&&s.props.inputProps.onBlur&&s.props.inputProps.onBlur(e)};s.onBlur=function(e){if(s.state.isFocused){var t=e.relatedTarget;null===e.relatedTarget&&(t=document.activeElement);if(t&&!i.elementContains(s.root.current,t)){s.setState({isFocused:!1});s.props.onBlur&&s.props.onBlur(e)}}};s.onKeyDown=function(e){var t=e.which;switch(t){case i.KeyCodes.escape:if(s.state.suggestionsVisible){s.setState({suggestionsVisible:!1});e.preventDefault();e.stopPropagation()}break;case i.KeyCodes.tab:case i.KeyCodes.enter:if(s.suggestionElement.current&&s.suggestionElement.current.hasSuggestedActionSelected())s.suggestionElement.current.executeSelectedAction();else if(!e.shiftKey&&s.suggestionStore.hasSelectedSuggestion()&&s.state.suggestionsVisible){s.completeSuggestion();e.preventDefault();e.stopPropagation()}else s._onValidateInput();break;case i.KeyCodes.backspace:s.props.disabled||s.onBackspace(e);e.stopPropagation();break;case i.KeyCodes.del:if(!s.props.disabled)if(s.input.current&&e.target===s.input.current.inputElement&&s.state.suggestionsVisible&&-1!==s.suggestionStore.currentIndex){s.props.onRemoveSuggestion&&s.props.onRemoveSuggestion(s.suggestionStore.currentSuggestion.item);s.suggestionStore.removeSuggestion(s.suggestionStore.currentIndex);s.forceUpdate()}else s.onBackspace(e);e.stopPropagation();break;case i.KeyCodes.up:if(s.input.current&&e.target===s.input.current.inputElement&&s.state.suggestionsVisible)if(s.suggestionElement.current&&s.suggestionElement.current.tryHandleKeyDown(t,s.suggestionStore.currentIndex)){e.preventDefault();e.stopPropagation()}else if(s.suggestionElement.current&&s.suggestionElement.current.hasSuggestedAction()&&0===s.suggestionStore.currentIndex){e.preventDefault();e.stopPropagation();s.suggestionElement.current.focusAboveSuggestions();s.suggestionStore.deselectAllSuggestions();s.forceUpdate()}else if(s.suggestionStore.previousSuggestion()){e.preventDefault();e.stopPropagation();s.onSuggestionSelect()}break;case i.KeyCodes.down:if(s.input.current&&e.target===s.input.current.inputElement&&s.state.suggestionsVisible)if(s.suggestionElement.current&&s.suggestionElement.current.tryHandleKeyDown(t,s.suggestionStore.currentIndex)){e.preventDefault();e.stopPropagation()}else if(s.suggestionElement.current&&s.suggestionElement.current.hasSuggestedAction()&&s.suggestionStore.currentIndex+1===s.suggestionStore.suggestions.length){e.preventDefault();e.stopPropagation();s.suggestionElement.current.focusBelowSuggestions();s.suggestionStore.deselectAllSuggestions();s.forceUpdate()}else if(s.suggestionStore.nextSuggestion()){e.preventDefault();e.stopPropagation();s.onSuggestionSelect()}}};s.onItemChange=function(e,t){var n=s.state.items;if(t>=0){var r=n;r[t]=e;s._updateSelectedItems(r)}};s.onGetMoreResults=function(){s.setState({isSearching:!0},function(){if(s.props.onGetMoreResults&&s.input.current){var e=s.props.onGetMoreResults(s.input.current.value,s.state.items),t=e,n=e;if(Array.isArray(t)){s.updateSuggestions(t);s.setState({isSearching:!1})}else n.then&&n.then(function(e){s.updateSuggestions(e);s.setState({isSearching:!1})})}else s.setState({isSearching:!1});s.input.current&&s.input.current.focus();s.setState({moreSuggestionsAvailable:!1,isResultsFooterVisible:!0})})};s.addItemByIndex=function(e){s.addItem(s.suggestionStore.getSuggestionAtIndex(e).item);s.input.current&&s.input.current.clear();s.updateValue("")};s.addItem=function(e){var t=s.props.onItemSelected?s.props.onItemSelected(e):e;if(null!==t){var n=t,r=t;if(r&&r.then)r.then(function(e){var t=s.state.items.concat([e]);s._updateSelectedItems(t)});else{var i=s.state.items.concat([n]);s._updateSelectedItems(i)}s.setState({suggestedDisplayValue:""})}};s.removeItem=function(e,t){var n=s.state.items,r=n.indexOf(e);if(r>=0){var i=n.slice(0,r).concat(n.slice(r+1));s._updateSelectedItems(i,t?r:void 0)}};s.removeItems=function(e){var t=s.state.items,n=t.filter(function(t){return-1===e.indexOf(t)}),r=e[0],i=t.indexOf(r);s._updateSelectedItems(n,i)};s._isFocusZoneInnerKeystroke=function(e){if(s.state.suggestionsVisible)switch(e.which){case i.KeyCodes.up:case i.KeyCodes.down:return!0}return e.which===i.KeyCodes.enter};var o=t.selectedItems||t.defaultSelectedItems||[];s._id=i.getId();s._ariaMap={selectedItems:"selected-items-"+s._id,selectedSuggestionAlert:"selected-suggestion-alert-"+s._id,suggestionList:"suggestion-list-"+s._id};s.suggestionStore=new l.SuggestionsController;s.selection=new u.Selection({onSelectionChanged:function(){return s.onSelectionChange()}});s.selection.setItems(o);s.state={items:o,suggestedDisplayValue:"",isMostRecentlyUsedVisible:!1,moreSuggestionsAvailable:!1,isFocused:!1,isSearching:!1,selectedIndices:[]};return s}Object.defineProperty(t.prototype,"items",{get:function(){return this.state.items},enumerable:!0,configurable:!0});t.prototype.componentWillUpdate=function(e,t){t.items&&t.items!==this.state.items&&this.selection.setItems(t.items)};t.prototype.componentDidMount=function(){this.selection.setItems(this.state.items);this._onResolveSuggestions=this._async.debounce(this._onResolveSuggestions,this.props.resolveDelay)};t.prototype.componentWillReceiveProps=function(e){var t=this,n=e.selectedItems;if(n){var r;n.length<this.state.items.length&&(r=this.state.items.indexOf(this.selection.getSelection()[0]));this.setState({items:e.selectedItems},function(){t.state.isFocused&&t.resetFocus(r)})}};t.prototype.componentWillUnmount=function(){e.prototype.componentWillUnmount.call(this);this.currentPromise&&(this.currentPromise=void 0)};t.prototype.focus=function(){this.focusZone.current&&this.focusZone.current.focus()};t.prototype.focusInput=function(){this.input.current&&this.input.current.focus()};t.prototype.completeSuggestion=function(){if(this.suggestionStore.hasSelectedSuggestion()&&this.input.current){this.addItem(this.suggestionStore.currentSuggestion.item);this.updateValue("");this.input.current.clear()}};t.prototype.render=function(){var e=this.state,t=e.suggestedDisplayValue,o=e.isFocused,a=e.items,f=this.props,l=f.className,c=f.inputProps,p=f.disabled,m=f.theme,g=f.styles,y=this.props.enableSelectedSuggestionAlert?this._ariaMap.selectedSuggestionAlert:"",b=this.state.suggestionsVisible?this._ariaMap.suggestionList:"",w=g?v(g,{theme:m,className:l,isFocused:o,disabled:p,inputClassName:c&&c.className}):{root:i.css("ms-BasePicker",l||""),text:i.css("ms-BasePicker-text",d.pickerText,this.state.isFocused&&d.inputFocused),itemsWrapper:d.pickerItems,input:i.css("ms-BasePicker-input",d.pickerInput,c&&c.className),screenReaderText:d.screenReaderOnly};return r.createElement("div",{ref:this.root,className:w.root,onKeyDown:this.onKeyDown,onBlur:this.onBlur},r.createElement(s.FocusZone,{componentRef:this.focusZone,direction:s.FocusZoneDirection.bidirectional,isInnerZoneKeystroke:this._isFocusZoneInnerKeystroke},this.getSuggestionsAlert(w.screenReaderText),r.createElement(u.SelectionZone,{selection:this.selection,selectionMode:u.SelectionMode.multiple},r.createElement("div",{className:w.text},a.length>0&&r.createElement("span",{id:this._ariaMap.selectedItems,className:w.itemsWrapper,role:"list"},this.renderItems()),this.canAddItems()&&r.createElement(h.Autofill,n.__assign({spellCheck:!1},c,{className:w.input,componentRef:this.input,onFocus:this.onInputFocus,onBlur:this.onInputBlur,onInputValueChange:this.onInputChange,suggestedDisplayValue:t,"aria-activedescendant":this.getActiveDescendant(),"aria-expanded":!!this.state.suggestionsVisible,"aria-haspopup":"true","aria-describedby":a.length>0?this._ariaMap.selectedItems:void 0,autoCapitalize:"off",autoComplete:"off",role:"combobox",disabled:p,"aria-controls":b+" "+y||void 0,"aria-owns":b||void 0,"aria-autocomplete":"both",onInputChange:this.props.onInputChange}))))),this.renderSuggestions())};t.prototype.canAddItems=function(){var e=this.state.items,t=this.props.itemLimit;return void 0===t||e.length<t};t.prototype.renderSuggestions=function(){var e=this._styledSuggestions;return this.state.suggestionsVisible&&this.input?r.createElement(o.Callout,n.__assign({isBeakVisible:!1,gapSpace:5,target:this.input.current?this.input.current.inputElement:void 0,onDismiss:this.dismissSuggestions,directionalHint:o.DirectionalHint.bottomLeftEdge,directionalHintForRTL:o.DirectionalHint.bottomRightEdge},this.props.pickerCalloutProps),r.createElement(e,n.__assign({onRenderSuggestion:this.props.onRenderSuggestionsItem,onSuggestionClick:this.onSuggestionClick,onSuggestionRemove:this.onSuggestionRemove,suggestions:this.suggestionStore.getSuggestions(),componentRef:this.suggestionElement,onGetMoreResults:this.onGetMoreResults,moreSuggestionsAvailable:this.state.moreSuggestionsAvailable,isLoading:this.state.suggestionsLoading,isSearching:this.state.isSearching,isMostRecentlyUsedVisible:this.state.isMostRecentlyUsedVisible,isResultsFooterVisible:this.state.isResultsFooterVisible,refocusSuggestions:this.refocusSuggestions,removeSuggestionAriaLabel:this.props.removeButtonAriaLabel,suggestionsListId:this._ariaMap.suggestionList},this.props.pickerSuggestionsProps))):null};t.prototype.renderItems=function(){var e=this,t=this.props,n=t.disabled,r=t.removeButtonAriaLabel,i=this.props.onRenderItem,s=this.state,o=s.items,u=s.selectedIndices;return o.map(function(t,s){return i({item:t,index:s,key:t.key?t.key:s,selected:-1!==u.indexOf(s),onRemoveItem:function(){return e.removeItem(t,!0)},disabled:n,onItemChange:e.onItemChange,removeButtonAriaLabel:r})})};t.prototype.resetFocus=function(e){var t=this.state.items;if(t.length&&e>=0){var n=this.root.current&&this.root.current.querySelectorAll("[data-selection-index]")[Math.min(e,t.length-1)];n&&this.focusZone.current&&this.focusZone.current.focusElement(n)}else this.canAddItems()?this.input.current&&this.input.current.focus():this.resetFocus(t.length-1)};t.prototype.onSuggestionSelect=function(){if(this.suggestionStore.currentSuggestion){var e=this.input.current?this.input.current.value:"",t=this._getTextFromItem(this.suggestionStore.currentSuggestion.item,e);this.setState({suggestedDisplayValue:t})}};t.prototype.onSelectionChange=function(){this.setState({selectedIndices:this.selection.getSelectedIndices()})};t.prototype.updateSuggestions=function(e){this.suggestionStore.updateSuggestions(e,0);this.forceUpdate()};t.prototype.onEmptyInputFocus=function(){var e=(0,this.props.onEmptyInputFocus)(this.state.items);this.updateSuggestionsList(e)};t.prototype.updateValue=function(e){this._onResolveSuggestions(e)};t.prototype.updateSuggestionsList=function(e,t){var n=this,r=e,i=e;if(Array.isArray(r))this._updateAndResolveValue(t,r);else if(i&&i.then){this.setState({suggestionsLoading:!0});this.suggestionStore.updateSuggestions([]);void 0!==t?this.setState({suggestionsVisible:!!this.input.current&&(""!==this.input.current.value&&this.input.current.inputElement===document.activeElement)}):this.setState({suggestionsVisible:!!this.input.current&&this.input.current.inputElement===document.activeElement});var s=this.currentPromise=i;s.then(function(e){s===n.currentPromise&&n._updateAndResolveValue(t,e)})}};t.prototype.resolveNewValue=function(e,t){var n=this;this.updateSuggestions(t);var r=void 0;this.suggestionStore.currentSuggestion&&(r=this._getTextFromItem(this.suggestionStore.currentSuggestion.item,e));this.setState({suggestedDisplayValue:r,suggestionsVisible:!!this.input.current&&(""!==this.input.current.value&&this.input.current.inputElement===document.activeElement)},function(){return n.setState({suggestionsLoading:!1})})};t.prototype.onChange=function(e){this.props.onChange&&this.props.onChange(e)};t.prototype.onBackspace=function(e){(this.state.items.length&&!this.input.current||this.input.current&&!this.input.current.isValueSelected&&0===this.input.current.cursorLocation)&&(this.selection.getSelectedCount()>0?this.removeItems(this.selection.getSelection()):this.removeItem(this.state.items[this.state.items.length-1]))};t.prototype.getActiveDescendant=function(){var e=this.suggestionStore.currentIndex;return e>-1&&!this.state.suggestionsLoading?"sug-"+e:void 0};t.prototype.getSuggestionsAlert=function(e){void 0===e&&(e=d.screenReaderOnly);var t=this.suggestionStore.currentIndex;if(this.props.enableSelectedSuggestionAlert){var n=t>-1?this.suggestionStore.getSuggestionAtIndex(this.suggestionStore.currentIndex):void 0,i=n?n.ariaLabel:void 0;return r.createElement("div",{className:e,role:"alert",id:this._ariaMap.selectedSuggestionAlert,"aria-live":"assertive"},i," ")}};t.prototype._updateAndResolveValue=function(e,t){if(void 0!==e)this.resolveNewValue(e,t);else{this.suggestionStore.updateSuggestions(t,-1);this.state.suggestionsLoading&&this.setState({suggestionsLoading:!1})}};t.prototype._updateSelectedItems=function(e,t){var n=this;this.props.selectedItems?this.onChange(e):this.setState({items:e},function(){n._onSelectedItemsUpdated(e,t)})};t.prototype._onSelectedItemsUpdated=function(e,t){this.resetFocus(t);this.onChange(e)};t.prototype._onResolveSuggestions=function(e){var t=this.props.onResolveSuggestions(e,this.state.items);null!==t&&this.updateSuggestionsList(t,e)};t.prototype._onValidateInput=function(){if(this.props.onValidateInput&&this.input.current&&this.props.onValidateInput(this.input.current.value)!==c.ValidationState.invalid&&this.props.createGenericItem){var e=this.props.createGenericItem(this.input.current.value,this.props.onValidateInput(this.input.current.value));this.suggestionStore.createGenericSuggestion(e);this.completeSuggestion()}};t.prototype._getTextFromItem=function(e,t){return this.props.getTextFromItem?this.props.getTextFromItem(e,t):""};return t}(i.BaseComponent);t.BasePicker=m;var g=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.state,t=e.suggestedDisplayValue,o=e.isFocused,a=this.props,f=a.className,l=a.inputProps,c=a.disabled,p=a.theme,m=a.styles,g=this.props.enableSelectedSuggestionAlert?this._ariaMap.selectedSuggestionAlert:"",y=this.state.suggestionsVisible?this._ariaMap.suggestionList:"",b=m?v(m,{theme:p,className:f,isFocused:o,inputClassName:l&&l.className}):{root:i.css("ms-BasePicker",f||""),text:i.css("ms-BasePicker-text",d.pickerText,this.state.isFocused&&d.inputFocused),input:i.css("ms-BasePicker-input",d.pickerInput,l&&l.className),screenReaderText:d.screenReaderOnly};return r.createElement("div",{ref:this.root,onBlur:this.onBlur},r.createElement("div",{className:b.root,onKeyDown:this.onKeyDown},this.getSuggestionsAlert(b.screenReaderText),r.createElement("div",{className:b.text},r.createElement(h.Autofill,n.__assign({},l,{className:b.input,componentRef:this.input,onFocus:this.onInputFocus,onBlur:this.onInputBlur,onInputValueChange:this.onInputChange,suggestedDisplayValue:t,"aria-activedescendant":this.getActiveDescendant(),"aria-expanded":!!this.state.suggestionsVisible,"aria-haspopup":"true",autoCapitalize:"off",autoComplete:"off",role:"combobox",disabled:c,"aria-controls":y+" "+g||void 0,"aria-owns":y||void 0,onInputChange:this.props.onInputChange})))),this.renderSuggestions(),r.createElement(u.SelectionZone,{selection:this.selection,selectionMode:u.SelectionMode.single},r.createElement(s.FocusZone,{componentRef:this.focusZone,className:"ms-BasePicker-selectedItems",isCircularNavigation:!0,direction:s.FocusZoneDirection.bidirectional,isInnerZoneKeystroke:this._isFocusZoneInnerKeystroke,id:this._ariaMap.selectedItems},this.renderItems())))};t.prototype.onBackspace=function(e){};return t}(m);t.BasePickerListBelow=g});
define("office-ui-fabric-react/lib/components/pickers/Suggestions/Suggestions.styles",["require","exports","../../../Styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={root:"ms-Suggestions",suggestionsContainer:"ms-Suggestions-container",title:"ms-Suggestions-title",forceResolveButton:"ms-forceResolve-button",searchForMoreButton:"ms-SearchMore-button",spinner:"ms-Suggestions-spinner",noSuggestions:"ms-Suggestions-none",suggestionsAvailable:"ms-Suggestions-suggestionsAvailable",isSelected:"is-selected"};t.getStyles=function(e){var t=e.className,i=e.suggestionsClassName,s=e.theme,o=e.forceResolveButtonSelected,u=e.searchForMoreButtonSelected,a=s.palette,f=n.getGlobalClassNames(r,s),l={background:"none",backgroundColor:"transparent",border:0,cursor:"pointer",margin:0,paddingLeft:8,position:"relative",borderTop:"1px solid "+a.neutralLight,height:40,textAlign:"left",width:"100%",fontSize:n.FontSizes.small,selectors:{":hover":{backgroundColor:a.neutralLight,cursor:"pointer"},":focus, :active":{backgroundColor:a.themeLight},".ms-Button-icon":{fontSize:n.FontSizes.icon,width:25},".ms-Button-label":{margin:"0 4px 0 9px"}}},c={backgroundColor:a.themeLight};return{root:[f.root,{minWidth:260},t],suggestionsContainer:[f.suggestionsContainer,{overflowY:"auto",overflowX:"hidden",maxHeight:300,borderBottom:"1px solid "+a.neutralLight},i],title:[f.title,{padding:"0 12px",fontSize:n.FontSizes.small,color:a.themePrimary,lineHeight:40,borderBottom:"1px solid "+a.neutralLight}],forceResolveButton:[f.forceResolveButton,l,o&&[f.isSelected,c]],searchForMoreButton:[f.searchForMoreButton,l,u&&[f.isSelected,c]],noSuggestions:[f.noSuggestions,{textAlign:"center",color:a.neutralSecondary,fontSize:n.FontSizes.small,lineHeight:30}],suggestionsAvailable:[f.suggestionsAvailable,n.hiddenContentStyle],subComponentStyles:{spinner:{root:[f.spinner,{margin:"5px 0",paddingLeft:14,textAlign:"left",whiteSpace:"nowrap",lineHeight:20,fontSize:n.FontSizes.small}],circle:{display:"inline-block",verticalAlign:"middle"},label:{display:"inline-block",verticalAlign:"middle",margin:"0 10px 0 16px"}}}}}});
define("office-ui-fabric-react/lib/components/pickers/BasePicker.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.valid=0]="valid";e[e.warning=1]="warning";e[e.invalid=2]="invalid"}(t.ValidationState||(t.ValidationState={}))});
define("office-ui-fabric-react/lib/components/Autofill/index",["require","exports","tslib","./Autofill"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("office-ui-fabric-react/lib/components/pickers/BasePicker.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".pickerText_de6ce0eb{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-sizing:border-box;box-sizing:border-box;border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";min-width:180px;min-height:30px}.pickerText_de6ce0eb:hover{border-color:"},{theme:"inputBorderHovered",defaultValue:"#333333"},{rawString:"}.pickerText_de6ce0eb.inputFocused_de6ce0eb{border-color:"},{theme:"inputFocusBorderAlt",defaultValue:"#0078d4"},{rawString:"}.pickerInput_de6ce0eb{height:34px;border:none;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;outline:none;padding:0 6px 0px;-ms-flex-item-align:end;align-self:flex-end}.pickerItems_de6ce0eb{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}.screenReaderOnly_de6ce0eb{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);t.pickerText="pickerText_de6ce0eb";t.inputFocused="inputFocused_de6ce0eb";t.pickerInput="pickerInput_de6ce0eb";t.pickerItems="pickerItems_de6ce0eb";t.screenReaderOnly="screenReaderOnly_de6ce0eb"});
define("office-ui-fabric-react/lib/components/pickers/PeoplePicker/PeoplePicker",["require","exports","tslib","react","../../../Utilities","../BasePicker","../BasePicker.types","./PeoplePickerItems/PeoplePickerItem","./PeoplePickerItems/PeoplePickerItemSuggestion","../BasePicker.styles"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t}(s.BasePicker);t.BasePeoplePicker=l;var c=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t}(s.BasePickerListBelow);t.MemberListPeoplePicker=c;var h=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.defaultProps={onRenderItem:function(e){return r.createElement(u.PeoplePickerItem,n.__assign({},e))},onRenderSuggestionsItem:function(e,t){return r.createElement(a.PeoplePickerItemSuggestion,{personaProps:e,suggestionsProps:t})},createGenericItem:v};return t}(l);t.NormalPeoplePickerBase=h;var p=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.defaultProps={onRenderItem:function(e){return r.createElement(u.PeoplePickerItem,n.__assign({},e))},onRenderSuggestionsItem:function(e,t){return r.createElement(a.PeoplePickerItemSuggestion,{personaProps:e,suggestionsProps:t,compact:!0})},createGenericItem:v};return t}(l);t.CompactPeoplePickerBase=p;var d=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.defaultProps={onRenderItem:function(e){return r.createElement(u.PeoplePickerItem,n.__assign({},e))},onRenderSuggestionsItem:function(e,t){return r.createElement(a.PeoplePickerItemSuggestion,{personaProps:e,suggestionsProps:t})},createGenericItem:v};return t}(c);t.ListPeoplePickerBase=d;function v(e,t){var n={key:e,primaryText:e,imageInitials:"!",ValidationState:t};t!==o.ValidationState.warning&&(n.imageInitials=i.getInitials(e,i.getRTL()));return n}t.createGenericItem=v;t.NormalPeoplePicker=i.styled(h,f.getStyles,void 0,{scope:"NormalPeoplePicker"});t.CompactPeoplePicker=i.styled(p,f.getStyles,void 0,{scope:"CompactPeoplePicker"});t.ListPeoplePicker=i.styled(d,f.getStyles,void 0,{scope:"ListPeoplePickerBase"})});
define("office-ui-fabric-react/lib/components/pickers/PeoplePicker/PeoplePickerItems/PeoplePickerItem",["require","exports","tslib","react","../../../../Utilities","../../../../Persona","../../../../Button","../../BasePicker.types","./PeoplePickerItem.styles"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=i.classNamesFunction();t.PeoplePickerItemBase=function(e){var t=e.item,a=e.onRemoveItem,l=e.index,c=e.selected,h=e.removeButtonAriaLabel,p=e.styles,d=e.theme,v=e.className,m=e.disabled,g=i.getId(),y=f(p,{theme:d,className:v,selected:c,disabled:m,invalid:t.ValidationState===u.ValidationState.warning}),b=y.subComponentStyles?y.subComponentStyles.persona:void 0,w=y.subComponentStyles?y.subComponentStyles.personaCoin:void 0;return r.createElement("div",{className:y.root,"data-is-focusable":!m,"data-is-sub-focuszone":!0,"data-selection-index":l,role:"listitem","aria-labelledby":"selectedItemPersona-"+g},r.createElement("div",{className:y.itemContent,id:"selectedItemPersona-"+g},r.createElement(s.Persona,n.__assign({size:s.PersonaSize.size24,styles:b,coinProps:{styles:w}},t))),r.createElement(o.IconButton,{onClick:a,disabled:m,iconProps:{iconName:"Cancel",styles:{root:{fontSize:"12px"}}},className:y.removeButton,ariaLabel:h}))};t.PeoplePickerItem=i.styled(t.PeoplePickerItemBase,a.getStyles,void 0,{scope:"PeoplePickerItem"})});
define("office-ui-fabric-react/lib/components/pickers/PeoplePicker/PeoplePickerItems/PeoplePickerItem.styles",["require","exports","../../../../Styling","../../../Button/BaseButton.classNames"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={root:"ms-PickerPersona-container",itemContent:"ms-PickerItem-content",removeButton:"ms-PickerItem-removeButton",isSelected:"is-selected",isInvalid:"is-invalid"},s=24;t.getStyles=function(e){var t,o,u,a,f,l,c=e.className,h=e.theme,p=e.selected,d=e.invalid,v=e.disabled,m=h.palette,g=h.semanticColors,y=n.getGlobalClassNames(i,h),b=[p&&!d&&!v&&{color:m.white,selectors:(t={},t[n.HighContrastSelector]={color:"HighlightText"},t)},(d&&!p||d&&p&&v)&&{color:m.redDark,borderBottom:"2px dotted "+m.redDark,selectors:{"$root:hover &":{color:m.redDark}}},d&&p&&!v&&{color:m.white,borderBottom:"2px dotted "+m.white},v&&{selectors:(o={},o[n.HighContrastSelector]={color:"GrayText"},o)}],w=[d&&{fontSize:20}];return{root:[y.root,n.getFocusStyle(h,{inset:-2}),{borderRadius:15,display:"inline-flex",alignItems:"center",background:m.neutralLighter,margin:"1px 2px",cursor:"default",userSelect:"none",maxWidth:300,verticalAlign:"middle",minWidth:0,selectors:(u={":hover":{background:p||v?"":m.neutralLight}},u[n.HighContrastSelector]=[{border:"1px solid WindowText"},v&&{borderColor:"GrayText"}],u)},p&&!v&&[y.isSelected,{background:m.themePrimary,selectors:(a={},a[n.HighContrastSelector]={borderColor:"HighLight",background:"Highlight",MsHighContrastAdjust:"none"},a)}],d&&[y.isInvalid],d&&p&&!v&&{background:m.redDark},c],itemContent:[y.itemContent,{flex:"0 1 auto",minWidth:0,maxWidth:"100%",overflow:"hidden"}],removeButton:[y.removeButton,{borderRadius:15,flex:"0 0 auto",width:s,height:s,flexBasis:s,selectors:{":hover":{background:m.neutralTertiaryAlt,color:m.neutralDark}}},p&&[{color:m.white,selectors:(f={":hover":{color:m.white,background:m.themeDark}},f[n.HighContrastSelector]={color:"HighlightText"},f)},d&&{selectors:{":hover":{background:m.red}}}],v&&{selectors:(l={},l["."+r.ButtonGlobalClassNames.msButtonIcon]={color:g.buttonText},l)}],subComponentStyles:{persona:{primaryText:b},personaCoin:{initials:w}}}}});
define("office-ui-fabric-react/lib/components/pickers/PeoplePicker/PeoplePickerItems/PeoplePickerItemSuggestion",["require","exports","tslib","react","../../../../Utilities","../../../../Persona","./PeoplePickerItemSuggestion.styles"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i.classNamesFunction();t.PeoplePickerItemSuggestionBase=function(e){var t=e.personaProps,i=e.suggestionsProps,o=e.compact,a=e.styles,f=e.theme,l=e.className,c=u(a,{theme:f,className:i&&i.suggestionsItemClassName||l}),h=c.subComponentStyles&&c.subComponentStyles.persona?c.subComponentStyles.persona:void 0;return r.createElement("div",{className:c.root},r.createElement(s.Persona,n.__assign({size:s.PersonaSize.size24,styles:h,className:c.personaWrapper,showSecondaryText:!o},t)))};t.PeoplePickerItemSuggestion=i.styled(t.PeoplePickerItemSuggestionBase,o.getStyles,void 0,{scope:"PeoplePickerItemSuggestion"})});
define("office-ui-fabric-react/lib/components/pickers/PeoplePicker/PeoplePickerItems/PeoplePickerItemSuggestion.styles",["require","exports","../../../../Styling","../../Suggestions/SuggestionsItem.styles"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={root:"ms-PeoplePicker-personaContent",personaWrapper:"ms-PeoplePicker-Persona"};t.getStyles=function(e){var t,s,o,u=e.className,a=e.theme,f=n.getGlobalClassNames(i,a),l={selectors:(t={},t["."+r.SuggestionsItemGlobalClassNames.isSuggested+" &"]={selectors:(s={},s[n.HighContrastSelector]={color:"HighlightText"},s)},t["."+f.root+":hover &"]={selectors:(o={},o[n.HighContrastSelector]={color:"HighlightText"},o)},t)};return{root:[f.root,{width:"100%",padding:"4px 12px"},u],personaWrapper:[f.personaWrapper,{width:180}],subComponentStyles:{persona:{primaryText:l,secondaryText:l}}}}});
define("office-ui-fabric-react/lib/components/pickers/BasePicker.styles",["require","exports","../../Styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={root:"ms-BasePicker",text:"ms-BasePicker-text",itemsWrapper:"ms-BasePicker-itemsWrapper",input:"ms-BasePicker-input"};t.getStyles=function(e){var t=e.className,i=e.theme,s=e.isFocused,o=e.inputClassName,u=e.disabled;if(!i)throw new Error("theme is undefined or null in base BasePicker getStyles function.");var a,f=i.semanticColors,l=f.inputBorder,c=f.inputBorderHovered,h=f.inputFocusBorderAlt,p=n.getGlobalClassNames(r,i);return{root:[p.root,t],text:[p.text,{display:"flex",position:"relative",flexWrap:"wrap",alignItems:"center",boxSizing:"border-box",minWidth:180,minHeight:30,border:"1px solid "+l},!s&&!u&&{selectors:{":hover":{borderColor:c}}},s&&!u&&{borderColor:h},u&&{borderColor:"transparent",selectors:(a={":after":{content:'""',position:"absolute",top:0,right:0,bottom:0,left:0,background:"rgba(218, 218, 218, 0.29)"}},a[n.HighContrastSelector]={borderColor:"GrayText",selectors:{":after":{background:"none"}}},a)}],itemsWrapper:[p.itemsWrapper,{display:"flex",flexWrap:"wrap",maxWidth:"100%"}],input:[p.input,{height:30,border:"none",flexGrow:1,outline:"none",padding:"0 6px 0",alignSelf:"flex-end",selectors:{"::-ms-clear":{display:"none"}}},o],screenReaderText:n.hiddenContentStyle}}});
define("office-ui-fabric-react/lib/components/pickers/TagPicker/TagPicker",["require","exports","tslib","react","../../../Utilities","../BasePicker","../BasePicker.styles","./TagItem","./TagItemSuggestion"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.defaultProps={onRenderItem:function(e){return r.createElement(u.TagItem,n.__assign({},e),e.item.name)},onRenderSuggestionsItem:function(e){return r.createElement(a.TagItemSuggestion,null,e.name)}};return t}(s.BasePicker);t.TagPickerBase=f;t.TagPicker=i.styled(f,o.getStyles,void 0,{scope:"TagPicker"})});
define("office-ui-fabric-react/lib/components/pickers/TagPicker/TagItem",["require","exports","react","../../../Utilities","../../../Button","./TagItem.styles"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.classNamesFunction();t.TagItemBase=function(e){var t=e.theme,r=e.styles,s=e.selected,u=e.disabled,a=e.enableTagFocusInDisabledPicker,f=e.children,l=e.className,c=e.index,h=e.onRemoveItem,p=e.removeButtonAriaLabel,d=o(r,{theme:t,className:l,selected:s,disabled:u});return n.createElement("div",{className:d.root,role:"listitem",key:c,"data-selection-index":c,"data-is-focusable":(a||!u)&&!0},n.createElement("span",{className:d.text,"aria-label":f},f),n.createElement(i.IconButton,{onClick:h,disabled:u,iconProps:{iconName:"Cancel",styles:{root:{fontSize:"12px"}}},className:d.close,ariaLabel:p}))};t.TagItem=r.styled(t.TagItemBase,s.getStyles,void 0,{scope:"TagItem"})});
define("office-ui-fabric-react/lib/components/pickers/TagPicker/TagItem.styles",["require","exports","../../../Styling","../../Button/BaseButton.classNames"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={root:"ms-TagItem",text:"ms-TagItem-text",close:"ms-TagItem-close",isSelected:"is-selected"},s=26;t.getStyles=function(e){var t,o,u,a,f,l=e.className,c=e.theme,h=e.selected,p=e.disabled,d=c.palette,v=n.getGlobalClassNames(i,c);return{root:[v.root,n.getFocusStyle(c),{boxSizing:"content-box",flexShrink:"1",margin:2,height:s,lineHeight:s,cursor:"default",userSelect:"none",display:"flex",flexWrap:"nowrap",maxWidth:300,background:!h||p?d.neutralLighter:d.themePrimary,selectors:(t={":hover":[!p&&!h&&{background:d.neutralLight,selectors:{".ms-TagItem-close":{color:d.neutralPrimary}}},p&&{background:d.neutralLighter},h&&!p&&{background:d.themePrimary}]},t[n.HighContrastSelector]={border:"1px solid "+(h?"WindowFrame":"WindowText")},t)},p&&{selectors:(o={},o[n.HighContrastSelector]={borderColor:"GrayText"},o)},h&&!p&&[v.isSelected,{color:d.white}],l],text:[v.text,{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",minWidth:30,margin:"0 8px"},p&&{selectors:(u={},u[n.HighContrastSelector]={color:"GrayText"},u)}],close:[v.close,{color:d.neutralSecondary,width:30,height:"100%",flex:"0 0 auto",selectors:{":hover":{background:d.neutralQuaternaryAlt,color:d.neutralPrimary}}},h&&{color:d.white,selectors:(a={":hover":{color:d.white,background:d.themeDark}},a[n.HighContrastSelector]={color:"HighlightText"},a)},p&&{selectors:(f={},f["."+r.ButtonGlobalClassNames.msButtonIcon]={color:d.neutralSecondary},f)}]}}});
define("office-ui-fabric-react/lib/components/pickers/TagPicker/TagItemSuggestion",["require","exports","react","../../../Utilities","./TagItemSuggestion.styles"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.classNamesFunction();t.TagItemSuggestionBase=function(e){var t=e.styles,r=e.theme,i=e.children,o=s(t,{theme:r});return n.createElement("div",{className:o.suggestionTextOverflow}," ",i," ")};t.TagItemSuggestion=r.styled(t.TagItemSuggestionBase,i.getStyles,void 0,{scope:"TagItemSuggestion"})});
define("office-ui-fabric-react/lib/components/pickers/TagPicker/TagItemSuggestion.styles",["require","exports","../../../Styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={suggestionTextOverflow:"ms-TagItem-TextOverflow"};t.getStyles=function(e){var t=e.className,i=e.theme;return{suggestionTextOverflow:[n.getGlobalClassNames(r,i).suggestionTextOverflow,{overflow:"hidden",textOverflow:"ellipsis",maxWidth:"60vw",padding:"6px 12px 7px",whiteSpace:"nowrap"},t]}}});
define("@ms/odsp-datasources/lib/PeoplePicker",["require","exports","tslib","./dataSources/peoplePicker/spo/PeoplePickerDataSource","./dataSources/peoplePicker/IPerson","./dataSources/peoplePicker/IPresenceType","./providers/peoplePicker/odb/PeoplePickerProvider"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t)});
define("@ms/odsp-datasources/lib/dataSources/peoplePicker/spo/PeoplePickerDataSource",["require","exports","tslib","../../../interfaces/ISpPageContext","../../base/DataSource","../../roleAssignments/PrincipalType","@ms/odsp-utilities/lib/async/Promise","../../../utilities/peoplePicker/SubstratePeoplePickerHelper","../../../utilities/url/ApiUrlHelper","../../../utilities/url/ItemUrlHelper","../../../utilities/url/UserPhotoUrlHelper","@ms/odsp-graph/lib/base/dataRequestor/DataRequestor","@ms/odsp-graph/lib/models/error/Error","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-utilities/lib/string/EmailAddressParser","@ms/odsp-utilities/lib/uri/Uri"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){n.__extends(t,e);function t(t,n){var r=this,i=g(t)?t:n.pageContext;r=e.call(this,{},{pageContext:i})||this;var s=g(t)?t.apiUrlHelper:n.apiUrlHelper;r._imageAbsoluteWebUrl=t.imageAbsoluteWebUrl||"";r._apiUrlHelper=s||new a.ApiUrlHelper({},{itemUrlHelper:new f.ItemUrlHelper({},{pageContext:i}),pageContext:i});r._capabilities={supportsMruCaching:!0};if(n){r._dataRequestor=n.dataRequestor;r._graphPeoplePickerHelper=n.graphPeoplePickerHelper;r._substratePeoplePickerHelper=n.substratePeoplePickerHelper;r._getAuthToken=n.getAuthToken}return r}t.prototype.getCapabilities=function(){return this._capabilities};t.prototype.getPersonaDetails=function(e){var t=this;return o.default.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("sp.publishing.personmagazine.GetPersonMagazineUserProfileDataForUser").parameter("accountName",e).toString(),qosName:"GetPersonaDetails",authToken:n,parseResponse:function(e){var n=function(e){return{name:e.DisplayName,email:e.Email,userId:e.AccountName,office:e.Office,image:e.PictureUrl,job:e.Title,department:e.DepartmentName,phone:e.Phone,sip:e.Lync}},i=JSON.parse(e).d.GetPersonMagazineUserProfileDataForUser,s={personDetails:n(i.Primary),managerChain:i.ManagerChain.results.map(n),directReports:i.DirectReports.results.map(n)};s.personDetails.profilePage=r.getServerUrl(t._pageContext)+"/_layouts/15/me.aspx?p="+encodeURIComponent(s.personDetails.sip)+"&origin=ProfileODBCard";return s}})})};t.prototype.getPickerEntityInformation=function(e){var t=this,n=0;e.principalType===s.default.sharePointGroup&&(n=Number(e.rawPersonData.EntityData.SPGroupID));var r=JSON.stringify({entityInformationRequest:{PrincipalType:e.principalType,EmailAddress:e.email,GroupId:n}});return o.default.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(n){return t.dataRequestor.getData({url:t._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.GetPickerEntityInformation").toString(),additionalPostData:r,qosName:"getPickerEntityInformation",authToken:n,noRedirect:!0,parseResponse:function(t){return{totalMemberCount:JSON.parse(t).d.TotalMemberCount,person:e}}})})};t.prototype.resolve=function(e,t){var n=this;return o.default.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(r){return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerResolveUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Resolve",authToken:r,parseResponse:function(e){var r=JSON.parse(e),i=JSON.parse(r.d.ClientPeoplePickerResolveUser),o=[];o[0]=i;p.Killswitch.isActivated("067ca2b4-2244-4153-8dfa-d11e6b4487bb","03/19/2018","Only overwrite display text if it is null or empty")?i.IsResolved||(o[0].DisplayText=i.Key):i.IsResolved||i.EntityData.IsBlockedOnODB&&"true"===i.EntityData.IsBlockedOnODB.toLowerCase()||(o[0].DisplayText=i.Key);var u=(o=n._transformData(o,t.filterExternalUsers))[0];if(t.filterExternalUsers&&u&&1===u.entityType){u.isResolved=!1;u.entityType=0}else if(t.blockViaPolicy&&!t.filterExternalUsers&&u&&!u.isResolved&&0===u.multipleMatches.length){u.isResolved=!0;u.isExternal=!0;u.entityType=1}if(t.isGraphDistributionList&&t.useGraph&&u.isExternal){u.entityType=2;u.principalType=s.default.distributionList}return u}})})};t.prototype.canUseGraph=function(e){var t=e&&e.useGraph&&this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();t&&!this._dataRequestor&&(this._dataRequestor=new c.default({},{}));return t};t.prototype.canUseSubstrate=function(e){var t=e.useSubstrate&&this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();t&&!this._dataRequestor&&(this._dataRequestor=new c.default({},{}));return t};t.prototype.search=function(e,t){return this.canUseSubstrate(t)?this._substrateSearch(e,t):this.canUseGraph(t)?this._graphSearch(e,t):this.sharePointSearch(e,t)};t.prototype.sharePointSearch=function(e,t){var n=this;t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!1);return o.default.resolve(this._getAuthToken&&this._getAuthToken(this._pageContext.webAbsoluteUrl)).then(function(r){return n.dataRequestor.getData({url:n._apiUrlHelper.build().segment("SP.UI.ApplicationPages.ClientPeoplePickerWebServiceInterface.ClientPeoplePickerSearchUser").toString(),additionalPostData:n._constructPostBody(e,t),qosName:"Search",authToken:r,parseResponse:function(r){var i=t.allowSharePointGroups,o=void 0===i||i,u=t.filterExternalUsers,a=t.forceResolve,f=JSON.parse(r),l=JSON.parse(f.d.ClientPeoplePickerSearchUser),c=n._transformData(l,u);u&&(c=c.filter(function(e){return 1!==e.entityType}));var h=!c.length;c=c.filter(function(e){return e.principalType===s.default.sharePointGroup?o:e.principalType===s.default.securityGroup?o||n._isValidEmail(e.email,!0):n._isValidEmail(e.email,!1)});if(p.Killswitch.isActivated("cc7520a8-6922-4e12-81c1-179764750212","3/29/2018","Disable limiting no results behavior to e-mail addresses."))a&&h&&c.push({name:e,userId:e,email:e});else if(!1!==t.resolveEmailIfNoResults&&0===c.length&&n._isValidEmail(e,!1)){var d={Key:e,IsResolved:!1};c.push({email:e,entityType:1,isResolved:!0,job:e,name:e,userId:e,rawData:d,rawPersonData:d,isExternal:!0})}return c}})})};t.prototype.subscribePresence=function(e,t){var n=this;try{this._ensureSkypePresence();if(!O365Shell_Shim.SkypeIntegration.isAvailable())return null;var r=function(e){try{switch(e){case 0:t(0);break;case 1:t(1);break;case 2:t(2);break;case 3:t(3);break;case 4:t(4);break;case 5:t(5);break;case 6:t(6);break;case 8:t(7);break;default:t(0)}}catch(e){}};this._skypeIntegration.TrackPresence(e,r);return{dispose:function(){try{n._skypeIntegration.UntrackPresence(e,r)}catch(e){}}}}catch(e){}return null};t.prototype.sendSourceName=function(){return"PeoplePickerDataSource"};t.prototype._constructPostBody=function(e,t){var n={queryParams:{QueryString:e,MaximumEntitySuggestions:t.maximumEntitySuggestions,AllowEmailAddresses:t.allowEmailAddresses,AllowOnlyEmailAddresses:t.allowOnlyEmailAddresses,PrincipalType:t.principalType,PrincipalSource:t.principalSource,SharePointGroupID:t.groupID,QuerySettings:t.querySettings}};return JSON.stringify(n)};t.prototype._ensureSkypePresence=function(){var e=this;try{if(!Boolean(this._skypeIntegration)){var t=new O365Shell_Shim.SkypeIntegration;t.OnApiReady(function(){e._skypeIntegration=t})}}catch(e){}};t.prototype._graphSearch=function(e,t){var n=this;return this._graphPeoplePickerHelper.getGraphToken().then(function(r){if(!r)return n.sharePointSearch(e,t);var i=new v.default("https://graph.microsoft.com/v1.0/me/people");e&&i.setQueryFromObject({$search:'"'+e+'"',$top:"30",$select:"displayName,scoredEmailAddresses,personType,department,jobTitle,userPrincipalName",$filter:"personType/subclass ne 'PublicDistributionList'"});return n._dataRequestor.send({apiName:"Graph.PeopleSearch",path:i.toString(),headers:{Authorization:"Bearer "+r,"X-PeopleQuery-QuerySources":"Mailbox,Directory"},needsAuthorization:!1}).then(function(r){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);var i=r.value,o=[];i.forEach(function(e){var t=e.scoredEmailAddresses[0]?e.scoredEmailAddresses[0].address:"",r=e.userPrincipalName&&n._isValidEmail(e.userPrincipalName,!1)?e.userPrincipalName:t,i={Key:r,IsResolved:!1},u="ImplicitContact"===e.personType.subclass,a="OrganizationUser"===e.personType.subclass,f="Group"===e.personType.class&&"UnifiedGroup"===e.personType.subclass,c="PublicDistributionList"===e.personType.subclass,h={department:e.department,email:t,image:u?void 0:l.getUserPhotoUrl({userLoginName:t}),job:e.jobTitle||t,name:e.displayName,providerName:a?"Provider":void 0,userId:r,rawData:i,rawPersonData:i,isExternal:!a};if(a){h.entityType=0;h.principalType=s.default.user;h.isResolved=!0}else if(f){h.entityType=2;h.principalType=s.default.securityGroup;h.isResolved=!1;h.userId=e.id}else{h.principalType=c?s.default.distributionList:s.default.none;h.entityType="Group"===e.personType.class?2:1;h.isResolved=!1;h.providerName=void 0}h.userId&&o.push(h)});if(!1!==t.resolveEmailIfNoResults&&0===o.length&&n._isValidEmail(e,!1)){var u={Key:e,IsResolved:!1};o.push({email:e,entityType:1,isResolved:!0,job:e,name:e,userId:e,rawData:u,rawPersonData:u,isExternal:!0})}return o},function(r){if(h.isGraphError(r))switch(r.status){case 400:case 401:case 403:case 404:n._graphPeoplePickerHelper.disableGraphCallsForPicker();return n.sharePointSearch(e,t);default:return n.sharePointSearch(e,t)}else"Canceled"!==r.name&&n._graphPeoplePickerHelper.disableGraphCallsForPicker();return"Canceled"===r.name?null:n.sharePointSearch(e,t)})})};t.prototype._substrateSearch=function(e,t){var n=this;return this._substratePeoplePickerHelper.getSubstrateToken().then(function(r){return r?n._dataRequestor.send({apiName:"Substrate.PeopleSearch",path:u.SUBSTRATE_SEARCH_URL+"/api/v1/suggestions",headers:{Authorization:"Bearer "+r,"X-User-Context":"litoken="+r},needsAuthorization:!1,requestType:"POST",postData:JSON.stringify({EntityRequests:[{EntityType:"People",ProvenanceMergeMode:"Fallback",Provenances:["Mailbox","Directory","LinkedIn"],Query:{QueryString:e},From:0,Size:25,Fields:["DisplayName","EmailAddresses","CompanyName","JobTitle","OfficeLocation","Department","UserPrincipalName","PeopleType","PeopleSubtype"]}],TimeZone:"UTC",Cvid:t.conversationId,Scenario:{Name:"documentshare"}})}).then(function(r){t.onToggleGetMoreResults&&t.onToggleGetMoreResults(!0);var i=r.Groups[0]?r.Groups[0].Suggestions:[],o=[];i.forEach(function(e){var t=e.EmailAddresses[0]||e.QueryText||"",r=e.UserPrincipalName&&n._isValidEmail(e.UserPrincipalName,!1)?e.UserPrincipalName:t,i={Key:r,IsResolved:!1},u="ImplicitContact"===e.PeopleSubtype,a="OrganizationUser"===e.PeopleSubtype,f="LinkedIn"===e.PeopleSubtype,c="Group"===e.PeopleType&&"UnifiedGroup"===e.PeopleSubtype,h="PublicDistributionList"===e.PeopleSubtype,p={department:e.Department,office:e.OfficeLocation,email:t,image:u?void 0:l.getUserPhotoUrl({userLoginName:t}),job:e.JobTitle||t,name:e.DisplayName,providerName:"Provider",userId:r,rawData:i,rawPersonData:i,isExternal:!a};if(a){p.entityType=0;p.principalType=s.default.user;p.isResolved=!0}else if(c){p.entityType=2;p.principalType=s.default.securityGroup;p.isResolved=!1}else if(f)p.entityType=4;else{p.principalType=h?s.default.distributionList:s.default.none;p.entityType="Group"===e.PeopleType?2:1;p.isResolved=!1;p.providerName=void 0}p.userId&&o.push(p)});if(!1!==t.resolveEmailIfNoResults&&0===o.length&&n._isValidEmail(e,!1)){var u={Key:e,IsResolved:!1};o.push({email:e,entityType:1,isResolved:!0,job:e,name:e,userId:e,rawData:u,rawPersonData:u,isExternal:!0})}return o},function(r){if("Canceled"!==r.name){n._substratePeoplePickerHelper.disableSubstrateCallsForPicker();n.sharePointSearch(e,t)}return null}):n.sharePointSearch(e,t)})};t.prototype._isValidEmail=function(e,t){return e?!(e.indexOf(" ")>-1||e.indexOf(";")>-1)&&d.default.isValidEmailSyntax(e,!1):!t};t.prototype._transformData=function(e,t){var n=this;return e.map(function(e){var r=e.EntityData,i={name:e.DisplayText,email:r.Email,userId:e.Key,job:r.Title,department:r.Department,phone:r.MobilePhone,providerName:e.ProviderDisplayName,entityType:e.EntityType,isResolved:e.IsResolved,multipleMatches:e.MultipleMatches,rawPersonData:e,rawData:e};if(i.multipleMatches.length>0){i.multipleMatches=n._transformData(i.multipleMatches,t);t&&(i.multipleMatches=i.multipleMatches.filter(function(e){return 1!==e.entityType}))}var o=i.email;i.isResolved&&(i.image=o?n._imageAbsoluteWebUrl+l.getUserPhotoUrl({userLoginName:o}):null);var u=r.PrincipalType||e.EntityType;switch(u){case"UNVALIDATED_EMAIL_ADDRESS":case"GUEST_USER":i.entityType=1;i.principalType=s.default.user;i.isExternal=!0;break;case"SecGroup":case"SharePointGroup":case"FormsRole":i.entityType=2;i.principalType="SharePointGroup"===u?s.default.sharePointGroup:s.default.securityGroup;break;default:i.entityType=0;i.principalType=s.default.user}return i})};return t}(i.default);t.PeoplePickerDataSource=m;function g(e){return!!e.webAbsoluteUrl}});
define("@ms/odsp-datasources/lib/utilities/peoplePicker/SubstratePeoplePickerHelper",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-graph/lib/base/dataRequestor/DataRequestor","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","@ms/odsp-utilities/lib/features/FeatureOverrides"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SUBSTRATE_SEARCH_URL="https://outlook.office.com/search";t.PeoplePickerSubstrate={ODB:1286};var a=function(){function e(e,t){this._dataRequestor=new i.DataRequestor({},{});this._pageContext=t.pageContext;this._oAuthTokenProvider=t.oAuthTokenProvider;this._sharingContextInformation&&this._sharingContextInformation.additionalTokens&&(this._substrateToken=this._sharingContextInformation.additionalTokens.substrateToken);this.initializeDataStore()}e.prototype.canUseSubstrate=function(){if(this._substrateToken)return!0;var e=!1;if(this._pageContext&&!this._pageContext.isSPO)return e;if(this._pageContext&&this._pageContext.authToken)return e;this._pageContext&&this._oAuthTokenProvider&&u.default.isFeatureEnabled(t.PeoplePickerSubstrate)&&(e=!0);this._dataStore&&(e=e&&!this._dataStore.getValue("DisableSubstrateSearch",o.default.session));return e};e.prototype.disableSubstrateCallsForPicker=function(){this.initializeDataStore();this._dataStore.setValue("DisableSubstrateSearch",!0,o.default.session)};e.prototype.getSubstrateToken=function(){var e=this;if(this._substrateToken)return n.default.resolve(this._substrateToken);if(this._oAuthTokenProvider){var i=new r.Qos({name:"PeoplePicker.GetSubstrateToken"});return this._oAuthTokenProvider.getToken(t.SUBSTRATE_SEARCH_URL).then(function(e){i.end({resultType:r.ResultTypeEnum.Success});return e},function(t){if(n.default.isCanceled(t)){i.end({resultType:r.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"});return n.default.reject(t)}i.end({resultCode:"PeoplePicker.GetSubstrateTokenError",resultType:r.ResultTypeEnum.Failure,extraData:{serverErrorCode:t._serverErrorCode,message:t.message}});e.disableSubstrateCallsForPicker();return null})}return null};e.prototype.init=function(e){var n=t.SUBSTRATE_SEARCH_URL+"/api/v1/init?scenario=documentshare";this._dataRequestor.send({apiName:"Substrate.PeopleSearch.Init",path:n,headers:{Authorization:"Bearer "+e,"X-User-Context":"litoken="+e},needsAuthorization:!1})};e.prototype.initializeDataStore=function(){this._dataStore||(this._dataStore=new s.default("PeoplePicker",o.default.session))};return e}();t.SubstratePeoplePickerHelper=a});
define("@ms/odsp-datasources/lib/utilities/url/ApiUrlHelper",["require","exports","tslib","./ItemUrlHelper","./ApiUrlHelperBasic","./ApiUrlHelperBasic"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(s,t);var o=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,{webAbsoluteUrl:n.pageContext.webAbsoluteUrl,encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this;r._pageContext=n.pageContext;r._shouldEncodeWebAbsoluteUrl=n.encodeWebAbsoluteUrl;r._itemUrlHelper=n.itemUrlHelper;return r}t.prototype.webByUrl=function(e){return this.webByItemUrl(this._itemUrlHelper.getUrlParts(e))};t.prototype.webByItemUrl=function(e){var t=e.siteRelation,n=e.isCrossDomain,i=e.fullItemUrl,s=this;(n||t===r.SiteRelation.crossSite)&&(s=s.method("SP.RemoteWeb",i));return s.segment("web")};t.prototype.listById=function(e,t){return this.webByItemUrl(e).segment("lists").method("GetById",t)};t.prototype.clone=function(){return new t({webAbsoluteUrl:this._pageContext.webAbsoluteUrl},{pageContext:this._pageContext,itemUrlHelper:this._itemUrlHelper,encodeWebAbsoluteUrl:this._shouldEncodeWebAbsoluteUrl})};return t}(i.ApiUrlBasic);t.ApiUrl=o;var u=function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,{webAbsoluteUrl:r&&r.pageContext?r.pageContext.webAbsoluteUrl:"",encodeWebAbsoluteUrl:r.encodeWebAbsoluteUrl})||this,s=r.itemUrlHelper,u=r.pageContext,a=r.encodeWebAbsoluteUrl,f=r.apiUrlType,l=void 0===f?function(e){n.__extends(t,e);function t(){return e.call(this,{},{itemUrlHelper:s,pageContext:u,encodeWebAbsoluteUrl:a})||this}return t}(o):f;i._apiUrlType=l;return i}t.prototype.build=function(){return new this._apiUrlType};return t}(i.ApiUrlHelperBasic);t.ApiUrlHelper=u});
define("@ms/odsp-datasources/lib/utilities/url/ApiUrlHelperBasic",["require","exports","tslib","@ms/odsp-utilities/lib/encoding/UriEncoding"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this._webAbsoluteUrl=e.webAbsoluteUrl;this._encodeWebAbsoluteUrl=e.encodeWebAbsoluteUrl;this._segments=[];this._parameters=[];this._rawParameters=[];this._lastParameterId=0}e.prototype.toString=function(){var e,t=[];this._parameters.length&&t.push(this._parameters.map(function(e){return e.name+"="+e.serializedValue}).join("&"));t.push.apply(t,this._rawParameters);e=t.length?"?"+t.join("&"):"";var n=this._webUrl,r=void 0===n?this._webAbsoluteUrl:n;return""+[this._encodeWebAbsoluteUrl?encodeURI(r):r,"_api"].concat(this._segments).join("/")+e};e.prototype.segment=function(e){return this._extend({segments:[e]})};e.prototype.segments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._extend({segments:e})};e.prototype.methodWithAliases=function(e,t){for(var n=this,r=[],i=0,s=Object.keys(t);i<s.length;i++){var o=s[i],u=t[o],a=n._autoParameter(u);n=a.apiUrl;r.push(o+"="+a.name)}return n.segment(e+"("+r.join(",")+")")};e.prototype.method=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=this,i=[],s=0,o=t;s<o.length;s++){var u=o[s],a=r._autoParameter(u);r=a.apiUrl;i.push(a.name)}return r.segment(e+"("+i.join(",")+")")};e.prototype.parameter=function(e,t){return this._parameter(e,t)};e.prototype.parameters=function(e){for(var t=this,n=0,r=Object.keys(e);n<r.length;n++){var i=r[n],s=e[i];t=t.parameter(i,s)}return t};e.prototype.oDataParameter=function(e,t){return this.parameter(e,{raw:t})};e.prototype.rawParameter=function(e){return this._extend({rawParameters:[e]})};e.prototype._autoParameter=function(e){var t=this._lastParameterId+1,n="@a"+t;return{name:n,apiUrl:this._extend({lastParameterId:t})._parameter(n,e)}};e.prototype._parameter=function(e,t){var n;n=function(e){return!!e&&"object"==typeof e&&"json"in e}(t)?r.default.encodeRestUriStringToken(JSON.stringify(t.json)):function(e){return!!e&&"object"==typeof e&&"guid"in e}(t)?"guid'"+t.guid+"'":function(e){return!!e&&"object"==typeof e&&"raw"in e}(t)?t.raw:"number"==typeof t?""+t:"boolean"==typeof t?""+t:"'"+r.default.encodeRestUriStringToken(t)+"'";return this._extend({parameters:[{name:e,serializedValue:n}]})};e.prototype.clone=function(){return new e({webAbsoluteUrl:this._webAbsoluteUrl,encodeWebAbsoluteUrl:this._encodeWebAbsoluteUrl})};e.prototype._extend=function(e){void 0===e&&(e={});var t,n,r,i,s,o,u=this.clone();u._webUrl=this._webUrl;u._lastParameterId=this._lastParameterId;(t=u._parameters).push.apply(t,this._parameters);(n=u._segments).push.apply(n,this._segments);(r=u._rawParameters).push.apply(r,this._rawParameters);"webUrl"in e&&(u._webUrl=e.webUrl);"lastParameterId"in e&&(u._lastParameterId=e.lastParameterId);"parameters"in e&&(i=u._parameters).push.apply(i,e.parameters);"rawParameters"in e&&(s=u._rawParameters).push.apply(s,e.rawParameters);"segments"in e&&(o=u._segments).push.apply(o,e.segments);return u};return e}();t.ApiUrlBasic=i;var s=function(){function e(e){this._apiUrlType=function(t){n.__extends(r,t);function r(){return t.call(this,{webAbsoluteUrl:e.webAbsoluteUrl,encodeWebAbsoluteUrl:e.encodeWebAbsoluteUrl})||this}return r}(i)}e.prototype.build=function(){return new this._apiUrlType};e.prototype.contextInfoUrl=function(e){var t,n=e.indexOf("/_layouts/");if(n>-1)t=e.substring(0,n);else{var r=e.lastIndexOf("/"),i=e.lastIndexOf(".");t=i>r?e.substring(0,i)+"_"+e.substring(i+1):e}return t+"/_api/contextinfo"};return e}();t.ApiUrlHelperBasic=s});
define("@ms/odsp-datasources/lib/utilities/url/UserPhotoUrlHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e.Small="S";e.Medium="M";e.Large="L"}(n=t.UserPhotoSize||(t.UserPhotoSize={}));t.getUserPhotoUrl=function(e){var t=e.webUrl||"",r=e.size||n.Small;return t+"/_layouts/15/userphoto.aspx?accountname="+e.userLoginName+"&size="+r}});
define("@ms/odsp-datasources/lib/dataSources/peoplePicker/IPerson",["require","exports","../roleAssignments/PrincipalType"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PrincipalType=n.default;!function(e){e[e.regularUser=0]="regularUser";e[e.externalUser=1]="externalUser";e[e.group=2]="group";e[e.application=3]="application";e[e.linkedinUser=4]="linkedinUser"}(t.EntityType||(t.EntityType={}))});
define("@ms/odsp-datasources/lib/dataSources/peoplePicker/IPresenceType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Unknown=0]="Unknown";e[e.Online=1]="Online";e[e.Busy=2]="Busy";e[e.DoNotDisturb=3]="DoNotDisturb";e[e.BeRightBack=4]="BeRightBack";e[e.Away=5]="Away";e[e.Offline=6]="Offline";e[e.Hidden=7]="Hidden"}(t.PresenceType||(t.PresenceType={}))});
define("@ms/odsp-datasources/lib/providers/peoplePicker/odb/PeoplePickerProvider",["require","exports","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/peoplePicker/spo/PeoplePickerDataSource","../../../models/store/PeopleStore"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e){this._dataSource=e.peoplePickerDataSource?e.peoplePickerDataSource:new r.PeoplePickerDataSource({imageAbsoluteWebUrl:e.imageAbsoluteWebUrl},{pageContext:e.pageContext,apiUrlHelper:e.apiUrlHelper});this._ppCapabilities=this._dataSource.getCapabilities();if(this._ppCapabilities.supportsMruCaching){this._mruCache=new i.PeopleStore;this.MaxCacheSuggestions=5}else this.MaxCacheSuggestions=0}e.prototype.search=function(e,t){var r,i,s=this,o={cached:null,promise:null};this._mruCache&&!t.groupID&&(i=this.searchMruCache(e,t&&t.filterExternalUsers)).length>0&&(o.cached=i);o.promise=new n.default(function(n,o){r=s._dataSource.search(e,t).then(function(e){if(e)if(i){i.length>0&&(i=s._removeStaleCacheResults(i,e));var t=i.map(function(e){return e.userId});n(e.filter(function(e){return t.indexOf(e.userId)<0}))}else n(e)},function(e){o(e)})},function(){r&&r.cancel()});return o};e.prototype.resolve=function(e,t){var n=this;return this._dataSource.resolve(e,t).then(function(e){n._mruCache&&e.isResolved&&n.addToMruCache(e);return e})};e.prototype.getPersonaDetails=function(e){return this._dataSource.getPersonaDetails(e).then(function(e){return e})};e.prototype.subscribePresence=function(e,t){return this._dataSource.subscribePresence(e,t)};e.prototype.addToMruCache=function(e){var t=this._mruCache;t&&e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"!==e.rawPersonData.EntityData.PrincipalType&&t.setItem(e)};e.prototype.getPickerEntityInformation=function(e){return this._dataSource.getPickerEntityInformation(e)};e.prototype.sharePointSearch=function(e,t){return this._dataSource.sharePointSearch(e,t).then(function(e){return e})};e.prototype.canUseGraph=function(e){return this._dataSource.canUseGraph(e)};e.prototype.canUseSubstrate=function(e){return this._dataSource.canUseSubstrate(e)};e.prototype.searchMruCache=function(e,t){var n=[],r=this._mruCache;if(r){n=r.getItems(e,t);var i=this.MaxCacheSuggestions;n.length>i&&(n=n.splice(0,i))}return n};e.prototype._removeStaleCacheResults=function(e,t){var n=e.map(function(e){return e.userId}),r=[];t.forEach(function(t){var s=n.indexOf(t.userId);if(s>-1){var o=e[s];i.PeopleStore.isCacheEntryFresh(o,t)&&r.push(o)}});return r};return e}();t.PeoplePickerProvider=s});
define("@ms/odsp-datasources/lib/models/store/PeopleStore",["require","exports","tslib","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","@ms/odsp-utilities/lib/killswitch/Killswitch"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(){var n=e.call(this,t._Key,t._DataStoreCachingType)||this;n._MaxItems=200;n._Version=5;n._buffer=n.getValue(t._StorageKey);n._buffer&&n._buffer.version===n._Version&&n._buffer.lastCachePrune||n.initializeBuffer();n._data={};if(Date.now()<n._buffer.lastCachePrune+6048e5||s.Killswitch.isActivated("e96e6a47-9f55-4ea4-8395-c9f48a655b2a","8/07/2018","PeopleStorePruning"))for(var r=0;r<n._buffer.dataArray.length;r++)n._data[n._buffer.dataArray[r].email]=n._buffer.dataArray[r];else{n.initializeBuffer();n.setValue(t._StorageKey,n._buffer)}return n}t.clear=function(){new r.default(t._Key,t._DataStoreCachingType).remove(t._StorageKey)};t.isCacheEntryFresh=function(e,t){return e.name===t.name&&e.email===t.email&&e.job===t.job&&e.office===t.office&&e.department===t.department&&e.phone===t.phone};t.prototype.setItem=function(e){var n=this._data[e.email];if(n){if(t.isCacheEntryFresh(n,e))return;var r=this._buffer.dataArray.map(function(e){return e.userId}).indexOf(e.userId);this._buffer.dataArray[r]=e}else if(this._buffer.dataArray.length===this._MaxItems){this._buffer.index++;this._buffer.index>=this._MaxItems&&(this._buffer.index=0);var i=this._buffer.dataArray[this._buffer.index];delete this._data[i.email];this._buffer.dataArray[this._buffer.index]=e}else{this._buffer.dataArray.push(e);this._buffer.index++}this._data[e.email]=e;this.setValue(t._StorageKey,this._buffer)};t.prototype.getItems=function(e,t){for(var n=[],r=0;r<this._buffer.dataArray.length;r++){var i=(this._buffer.index-r+this._MaxItems)%this._MaxItems;!(this._buffer.dataArray[i].email&&this._buffer.dataArray[i].email.toLowerCase().indexOf(e.toLowerCase())>=0||this._buffer.dataArray[i].name&&this._buffer.dataArray[i].name.toLowerCase().indexOf(e.toLowerCase())>=0)||t&&1===this._buffer.dataArray[i].entityType||n.push(this._buffer.dataArray[i])}return n};t.prototype.containsItem=function(e){return Boolean(this._data[e.email])};t.prototype.initializeBuffer=function(){this._buffer={};this._buffer.dataArray=[];this._buffer.index=-1;this._buffer.version=this._Version;this._buffer.lastCachePrune=Date.now()};t._Key="ClientPeoplePicker";t._StorageKey="MRU";t._DataStoreCachingType=i.default.local;return t}(r.default);t.PeopleStore=o});
define("@ms/shared-react-people-picker/lib/PeoplePickerDefaultItems",["require","exports","tslib","react","office-ui-fabric-react/lib/Persona","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Utilities","./PickerItem.scss"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function a(e){return{text:e.name?e.name:"",imageUrl:e.image?e.image:"",tertiaryText:e.email?e.email:"",secondaryText:e.job?e.job:"",imageInitials:"",imageAlt:e.imageAlt}}t.SuggestionItemDefault=function(e){var t=a(e);return r.createElement("div",{className:"ms-PeoplePicker-personaContent"},r.createElement(i.Persona,n.__assign({},t,{presence:i.PersonaPresence.none,size:i.PersonaSize.small,className:"ms-PeoplePicker-pickerPersona"})),4===e.entityType&&r.createElement(o.Icon,{className:"od-PeoplePicker-linkedInLogo",iconName:"LinkedInLogo"}))};t.SelectedItemDefault=function(e){var t=e.item,o=e.onRemoveItem,f=e.index,l=e.selected,c=e.removeButtonAriaLabel,h=a(t);return r.createElement("div",{className:u.css("ms-PickerPersona-container",{"is-selected":!!l}),"data-is-focusable":!0,"data-selection-index":f,key:f,role:"listitem"},r.createElement("div",{className:"ms-PickerItem-content"},r.createElement(i.Persona,n.__assign({},h,{presence:i.PersonaPresence.none,size:i.PersonaSize.extraSmall}))),r.createElement(s.IconButton,{onClick:o,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!1,ariaLabel:c}))};t.SelectedItemBelowDefault=function(e){var t=e.item,o=e.onRemoveItem,f=e.index,l=e.selected,c=a(t);return r.createElement("div",{className:u.css("ms-PickerPersona-container is-listbelow",{"is-selected":!!l}),"data-is-focusable":!0,"data-selection-index":f,key:f},r.createElement("div",{className:"ms-PickerPersona-content"},r.createElement(i.Persona,n.__assign({},c,{presence:i.PersonaPresence.none,size:i.PersonaSize.small}))),r.createElement("div",{className:"ms-PickerItem-sideContent"},r.createElement(s.IconButton,{onClick:o,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!1})))};t.SelectedItemBelowCustomMenu=function(e,t){var o=e.item,f=e.onRemoveItem,l=e.index,c=e.selected,h=a(o);return r.createElement("div",{className:u.css("ms-PickerPersona-container is-listbelow",{"is-selected":!!c}),"data-is-focusable":!0,"data-selection-index":l,key:l},r.createElement("div",{className:"ms-PickerPersona-content"},r.createElement(i.Persona,n.__assign({},h,{presence:i.PersonaPresence.none,size:i.PersonaSize.small}),t||null)),r.createElement("div",{className:"ms-PickerItem-sideContent"},r.createElement(s.IconButton,{onClick:f,iconProps:{iconName:"Cancel"},className:"ms-PickerItem-content","data-is-focusable":!1})))}});
define("@ms/shared-react-people-picker/lib/PickerItem.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".ms-PickerPersona-container{position:relative;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;vertical-align:top;background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";margin:1px;vertical-align:top;white-space:nowrap;cursor:default;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ms-PickerPersona-container::-moz-focus-inner{border:0}.ms-PickerPersona-container{outline:transparent}.ms-PickerPersona-container{position:relative}.ms-Fabric--isFocusVisible .ms-PickerPersona-container:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"focusBorder",defaultValue:"#666666"},{rawString:"}.ms-PickerPersona-container:hover{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.ms-PickerPersona-container.is-selected{background:"},{theme:"neutralQuaternary",defaultValue:"#d0d0d0"},{rawString:"}.ms-PickerPersona-container.is-selected:hover{background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#dadada"},{rawString:"}.ms-PickerPersona-container.is-listbelow{width:100%}.ms-PickerItem-sideContent{display:inline-block}.ms-PickerPersona-content{-webkit-box-flex:1;-ms-flex:1;flex:1;vertical-align:middle;min-width:100px}.ms-PeoplePicker-personaContent{min-width:100px;padding:7px 12px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-PeoplePicker-linkedInLogo{color:#0077B5}\n"}])});
define("@ms/shared-react-people-picker/lib/PeoplePicker.Props",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.normal=0]="normal";e[e.listBelow=1]="listBelow"}(t.PeoplePickerType||(t.PeoplePickerType={}))});
define("@ms/shared-react-people-picker/lib/PeoplePicker.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".ms-Suggestions{width:260px}\n"}])});
define("@ms/odsp-shared-react/lib/components/PeoplePicker/PeoplePicker.Props",["require","exports","tslib","@ms/shared-react-people-picker/lib/PeoplePicker.Props"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/odsp-shared-react/lib/components/PeoplePicker/PeoplePickerDefaultItems",["require","exports","tslib","@ms/shared-react-people-picker/lib/PeoplePickerDefaultItems"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/odsp-shared-sharing/lib/utilities/ShareCommunicationManager",["require","exports","../interfaces/SharingInterfaces","@ms/odsp-utilities/lib/logging/events/Qos.event","../utilities/ShareHelper"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=!1;t.copyLinkShareTargetClicked=function(){window.parent.postMessage(JSON.stringify({name:"share_copyLinkClicked"}),"*")};t.dismiss=function(){try{window.external.Dismiss()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_dismiss"}),"*")}};t.shareCompleted=function(e,t){try{window.external.ShareCompleted(e)}catch(r){var n={name:"share_completed",shareType:e,scope:t};window.parent.postMessage(JSON.stringify(n),"*")}};t.teamsClicked=function(e){try{window.external.SendLinkViaTeams(e.url)}catch(e){window.parent.postMessage(JSON.stringify({name:"share_teamsClicked"}),"*")}};t.grantAccessCompleted=function(e){try{window.external.GrantAccessCompleted(e)}catch(n){var t={name:"share_grantAccessCompleted",successful:e};window.parent.postMessage(JSON.stringify(t),"*")}};t.pageError=function(e,t,n,r,i){o(e,t,n,r,i.errorMessage||"unknown error");try{window.external.PageError(i.error,i.errorCategory,i.errorMessage,i.debugErrorMessage)}catch(e){var s={name:"share_error",error:i.error,errorCategory:i.errorCategory,errorMessage:i.errorMessage,debugErrorMessage:i.debugErrorMessage};window.parent.postMessage(JSON.stringify(s),"*")}};t.outlookClicked=function(){window.parent.postMessage(JSON.stringify({name:"share_outlookClicked"}),"*")};function o(e,t,i,o,u){if(!s){s=!0;if(e){new r.default({name:"ShareV3."+n.Mode[i]+"."+(n.ClientId[t]||"unknown")+".PageLoaded",startTimeOverride:e}).end({resultType:r.ResultTypeEnum.Success,extraData:{clientId:t,scenarioId:o,isError:!!u}})}}}t.pageFinishedLoading=function(e,t,n,r){o(e,t,n,r);try{window.external.PageFinishedLoading()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_ready"}),"*")}};t.readyForRecipients=function(){window.parent.postMessage(JSON.stringify({name:"share_readyForRecipients"}),"*")};t.sendLinkClicked=function(){window.parent.postMessage(JSON.stringify({name:"share_sendClicked"}),"*")};t.peoplePickerFocused=function(){try{window.external.PeoplePickerFocused()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_peoplePickerFocused"}),"*")}};t.linkSettingsCompleted=function(e,t,r,s){var o=i.getLinkIconUrl(s,e,r),u=i.getLinkLabel(e,t,s,r),a=i.getVroomScopeFromSharingLinkKind(e.sharingLinkKind),f=e.audience===n.SharingAudience.existing?"00000000-0000-0000-0000-000000000000":e.shareId,l=!1;try{(c=window.external).LinkSettingsCompleted(f,e.url,o,u,a);l=!0}catch(e){}try{var c=window.external,h=JSON.stringify({id:f,hasPassword:!!e.hasPassword,link:{blocksDownload:!!e.blockDownload,createOnly:!!e.isCreateOnlyLink,iconUrl:o,localizedDescription:u,webUrl:e.url,scope:a,customLabeledAudience:e.audience===n.SharingAudience.customLabeledSpecificPeople}});c.LinkSettingsCompletedV2(h);l=!0}catch(e){}if(!l){var p={name:"share_linkSettingsCompleted",shareId:f,linkUrl:e.url,iconUrl:o,linkDescription:u,scope:a,blocksDownload:!!e.blockDownload,customLabeledAudience:e.audience===n.SharingAudience.customLabeledSpecificPeople};window.parent.postMessage(JSON.stringify(p),"*")}};t.isDarkMode=function(){var e=!1;try{e=window.external.IsDarkMode()}catch(e){}return e};t.invokeManageAccess=function(){window.parent.postMessage(JSON.stringify({name:"share_manageAccessClicked"}),"*")}});
define("@ms/odsp-shared-sharing/lib/components/PeoplePicker/PeoplePicker.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share-PeoplePicker-wrapper{max-height:150px;overflow-y:auto}.od-Share-PeoplePicker .ms-BasePicker-text{min-height:26px;border:none;padding:0;border-bottom:1px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Share-PeoplePicker .ms-BasePicker-input{font-size:13px;font-weight:400;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}[dir=ltr] .od-Share-PeoplePicker .ms-BasePicker-input{padding-left:0}[dir=rtl] .od-Share-PeoplePicker .ms-BasePicker-input{padding-right:0}.od-Share-PeoplePicker.ms-Share-PeoplePicker--error .ms-BasePicker-text{border-color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.od-Share-PeoplePicker .ms-BasePicker-input::before{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline .ms-TextField-field{font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-webkit-input-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea::-moz-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-ms-input-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-TextField.ms-TextField--multiline textarea:-moz-placeholder{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:13px;font-weight:400}.od-Share-PeoplePicker .ms-PickerPersona-container{border-radius:16px;margin-bottom:8px}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-top:3px}[dir=ltr] .od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-left:1px}[dir=rtl] .od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona{padding-right:1px}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded{background-color:transparent;border:1px solid "},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}[dir=ltr] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-left:12px}[dir=rtl] .od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Persona-details{padding-right:12px}.od-Share-PeoplePicker .ms-PickerPersona-container.is-excluded .ms-Button-icon{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.od-Share-PeoplePicker .ms-PickerItem-content{max-width:250px;border-radius:16px}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container{max-height:200px}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-primaryText{font:-apple-system-body}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-secondaryText{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions .ms-Suggestions-container .ms-Persona-details div.ms-Persona-tertiaryText{font:-apple-system-caption1}.od-Share-PeoplePicker-Suggestions.od-Share-PeoplePicker-Suggestions-condensed .ms-Suggestions-container{max-height:150px}.od-Share-PeoplePicker-error{font-size:12px;font-weight:400;color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:";display:block;margin-bottom:4px;font:-apple-system-caption2}.od-Share-PeoplePicker-warning{word-break:break-word;font:-apple-system-caption2}.od-Share-PeoplePicker-warning .ms-MessageBar{display:block;padding:6px}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-text{margin:0}.od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 5px 0 0}[dir=rtl] .od-Share-PeoplePicker-warning .ms-MessageBar .ms-MessageBar-icon{margin:0 0 0 5px}.od-Share-PeoplePicker-selectedItem--error .ms-PickerPersona-container{border-style:solid;border-width:1px;color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:";border-color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:";background-color:RGBA("},{theme:"redDark",defaultValue:"#a80000"},{rawString:", .06);font:-apple-system-caption2}.od-Share-PeoplePicker-resolve-spinner{padding:3px}@media screen and (-ms-high-contrast:active){.ms-Button.is-suggested .ms-Persona .ms-Persona-details .ms-Persona-primaryText{color:HighlightText}}@media screen and (-ms-high-contrast:active){.ms-Button:hover .ms-Persona .ms-Persona-details .ms-Persona-primaryText{color:HighlightText}}"}])});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/PreventDownload/PreventDownload",["require","exports","tslib","react","office-ui-fabric-react/lib/Toggle","office-ui-fabric-react/lib/Icon","../../Share.resx","office-ui-fabric-react/lib/Tooltip","@ms/odsp-utilities/lib/string/StringHelper","prop-types","./PreventDownload.scss"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r.state={preventDownloadToggle:!1};r._onChanged=r._onChanged.bind(r);return r}t.prototype.render=function(){var e=this.props.disablePreventDownload,t=!e&&this.props.isToggled,f=!this.props.detailsPane&&this.props.disablePreventDownload,l=f?this.props.isNonOfficeFileReview?o.default.preventDownloadInfoIconNotView:a.format(o.default.preventDownloadInfoIcon,o.default.allowEditLabel):o.default.preventDownloadLabel;this.props.detailsPane&&(t=!0);return r.createElement("div",{className:"od-PreventDownloadToggle"},r.createElement("div",{className:"od-PermissionsSettings-setting--PreventDownload-Icon"},r.createElement(s.Icon,n.__assign({iconName:"Blocked2"},{alt:o.default.imageAltPreventDownloadIcon}))),r.createElement(i.Toggle,{checked:t,disabled:e,label:o.default.preventDownloadLabel,ariaLabel:l,onChanged:this._onChanged}),f&&r.createElement("div",{className:"od-PreventDownloadToggle--info","aria-label":l},r.createElement(u.TooltipHost,{hostClassName:"od-preventDownload-tooltip",content:l,directionalHint:u.DirectionalHint.topCenter,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},r.createElement("div",{tabIndex:0,className:"od-preventDownload-tooltipWrapper"},r.createElement("div",{className:"od-preventDownload-hidden","aria-label":l},l),r.createElement(s.Icon,{"aria-hidden":"true",iconName:"Info",className:"ms-Icon ms-Icon--Info"})))))};t.prototype._onChanged=function(e){var t=this;this.context.sharingStore.getEngagementHelper().log("PreventDownload.ToggleChanged",{clientId:this.props.clientId,scenarioId:"",mode:this.props.mode});this.setState({preventDownloadToggle:e},function(){t.props.onToggleChange(e)})};t.contextTypes={sharingStore:f.object.isRequired};return t}(r.Component);t.PreventDownload=l});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/PreventDownload/PreventDownload.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-PreventDownloadToggle{vertical-align:top;height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;line-height:32px}.od-PreventDownloadToggle .ms-Toggle{width:100%}.od-PreventDownloadToggle .ms-Toggle-slider{position:absolute;top:6px}[dir=ltr] .od-PreventDownloadToggle .ms-Toggle-slider{right:30px}[dir=rtl] .od-PreventDownloadToggle .ms-Toggle-slider{left:30px}[dir=ltr] .od-PreventDownloadToggle .ms-Toggle-slider{float:right}[dir=rtl] .od-PreventDownloadToggle .ms-Toggle-slider{float:left}.od-PreventDownloadToggle .ms-Toggle-label{padding:0;display:inline-block;margin:0 4px 0 8px;font-size:14px;cursor:pointer;width:calc(100% - 70px)}[dir=rtl] .od-PreventDownloadToggle .ms-Toggle-label{margin:0 8px 0 4px}.isFluent .od-PreventDownloadToggle .ms-Toggle-label{margin:0 4px 0 12px}[dir=rtl] .isFluent .od-PreventDownloadToggle .ms-Toggle-label{margin:0 12px 0 4px}.od-PreventDownloadToggle .ms-Toggle-innerContainer{line-height:32px;margin-top:4px}[dir=ltr] .od-PreventDownloadToggle .ms-Toggle-innerContainer{float:right}[dir=rtl] .od-PreventDownloadToggle .ms-Toggle-innerContainer{float:left}.od-preventDownload-tooltip .ms-Icon{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";cursor:pointer;font-size:12px}[dir=ltr] .od-preventDownload-tooltip .ms-Icon{margin-left:10px}[dir=rtl] .od-preventDownload-tooltip .ms-Icon{margin-right:10px}.ms-Fabric .od-preventDownload-tooltipWrapper::-moz-focus-inner{border:0}.ms-Fabric .od-preventDownload-tooltipWrapper{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-preventDownload-tooltipWrapper:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-preventDownload-tooltipWrapper:focus:after{border-color:ActiveBorder}}.od-preventDownload-hidden{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}])});
define("@ms/odsp-shared-sharing/lib/utilities/ReviewPermissionExperimentHelper",["require","exports","@ms/odsp-utilities/lib/features/Features","@ms/odsp-utilities/lib/logging/ABExperiment"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){var t,i={ODB:772},s={ODB:1363},o=!1;e.checkExperimentisOn=function(){if(o)return t;if(n.default.isFeatureEnabled(i))t=!0;else if(n.default.isFeatureEnabled(s)){var e=new r.ABExperiment({name:"ReviewPermission",startDate:"07-02-2019",version:r.ABExpHash.v2});o=!0;t=e.IsExperimentOn()}else t=!1;return t}}(i||(i={}));t.default=i});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/PermissionsSettings/PermissionsSettings.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-PermissionsSettings .ms-Checkbox{min-height:0}.od-PermissionsSettings .ms-Checkbox-label{margin-top:0}.od-PermissionsSettings .ms-Checkbox-label::before{width:20px;height:20px}.od-PermissionsSettings .ms-Checkbox-label::after{font-size:16px;line-height:20px;width:20px}.od-PermissionsSettings .ms-PeoplePicker{margin-top:5px}.od-PermissionsSettings-section{padding-bottom:20px}.od-PermissionsSettings-description{padding-bottom:10px;font-size:12px;font:-apple-system-caption2}.isFluent .od-PermissionsSettings-description{padding-bottom:8px;font-size:14px;font-weight:600}.od-PermissionsSetting-specificPeople-container{margin-top:5px;font-size:14px}[dir=ltr] .od-PermissionsSetting-specificPeople-container{margin-left:27px}[dir=rtl] .od-PermissionsSetting-specificPeople-container{margin-right:27px}[dir=ltr] .od-PermissionsSetting-specificPeople-container{margin-right:10px}[dir=rtl] .od-PermissionsSetting-specificPeople-container{margin-left:10px}.od-PermissionsSetting-specificPeople-list{max-height:60px;overflow-y:auto;padding-bottom:2px}.od-PermissionsSetting-specificPeople-list a{text-decoration:none}.ms-Fabric .od-PermissionsSetting-specificPeople-list a::-moz-focus-inner{border:0}.ms-Fabric .od-PermissionsSetting-specificPeople-list a{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-PermissionsSetting-specificPeople-list a:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-PermissionsSetting-specificPeople-list a:focus:after{border-color:ActiveBorder}}.od-PermissionsSettings-bottomBorder{border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.isFluent .od-PermissionsSettings-bottomBorder{border-bottom:0}.teams .od-PermissionsSettings-bottomBorder{border:0}.teams .od-PermissionsSettings-description.od-ModifyPermissions-margins{margin:0}[dir=ltr] .teams .od-PermissionsSettings-description.od-ModifyPermissions-margins{padding-left:20px}[dir=rtl] .teams .od-PermissionsSettings-description.od-ModifyPermissions-margins{padding-right:20px}.od-PermissionsSettings-setting{margin-bottom:8px}.isFluent .od-PermissionsSettings-setting{margin-bottom:12px}.od-PermissionsSettings-setting span.ms-Checkbox-text{font:-apple-system-caption1}.od-PermissionsSettings-expirationError{font-size:12px;color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.od-PermissionsSettings-PeoplePicker{margin-top:6px}.od-PermissionsSettings-learnMore{text-decoration:none;margin:0 3px;white-space:nowrap;font:-apple-system-caption2}.ms-Fabric .od-PermissionsSettings-learnMore::-moz-focus-inner{border:0}.ms-Fabric .od-PermissionsSettings-learnMore{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-PermissionsSettings-learnMore:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-PermissionsSettings-learnMore:focus:after{border-color:ActiveBorder}}.od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{vertical-align:top}[dir=ltr] .od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{padding-left:3px}[dir=rtl] .od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionText{padding-right:3px}.od-PermissionsSettings-rolesDropdown .od-PermissionsSettings-roleDropdownOptionIcon{display:inline-block}.od-PermissionsSettings-changePermission{margin-bottom:12px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-PermissionsSettings-setting--PreventDownload{width:100%;height:32px}[dir=ltr] .od-PermissionsSettings-setting--PreventDownload{margin-right:0}[dir=rtl] .od-PermissionsSettings-setting--PreventDownload{margin-left:0}[dir=ltr] .od-PermissionsSettings-setting--PreventDownload{padding-right:0}[dir=rtl] .od-PermissionsSettings-setting--PreventDownload{padding-left:0}.od-PermissionsSettings-setting--PreventDownload-Icon{display:inline-block}.isFluent .od-PermissionsSettings-setting--PreventDownload-Icon{font-size:16px}.od-PermissionsSettings-setting--PreventDownload-Icon .ms-Icon{display:inline-block;font-size:16px;margin:0 14px 0 8px;position:relative;height:32px;line-height:32px}[dir=rtl] .od-PermissionsSettings-setting--PreventDownload-Icon .ms-Icon{margin:0 8px 0 14px}.od-PermissionsSettings-wrapper{width:100%}.ms-Fabric .od-PermissionsSettings-wrapper::-moz-focus-inner{border:0}.ms-Fabric .od-PermissionsSettings-wrapper{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-PermissionsSettings-wrapper:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-PermissionsSettings-wrapper:focus:after{border-color:ActiveBorder}}.od-PermissionsSettings-blocker{pointer-events:none}.ms-Callout-container .od-PermissionsSettings-teachingBubble{max-width:275px}.od-PermissionsSettings-teachingBubbleIcon{font-size:24px;position:absolute;top:25px;z-index:1}[dir=ltr] .od-PermissionsSettings-teachingBubbleIcon{padding-left:5px}[dir=rtl] .od-PermissionsSettings-teachingBubbleIcon{padding-right:5px}.od-PermissionsSettings-teachingBubble .ms-TeachingBubble-headline{padding-top:50px}"}])});
define("@ms/odsp-shared-sharing/lib/components/ModifyPermissions/ModifyPermissions.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ModifyPermissions.blocker:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:.8}.od-ModifyPermissions .ms-Dialog-main{width:450px;max-width:none}.od-ModifyPermissions .ms-Dialog-header{display:none}.od-ModifyPermissions .ms-Dialog-actions{margin:20px}[dir=ltr] .teams .od-ModifyPermissions{margin-right:32px}[dir=rtl] .teams .od-ModifyPermissions{margin-left:32px}[dir=ltr] .teams .od-ModifyPermissions{margin-left:12px}[dir=rtl] .teams .od-ModifyPermissions{margin-right:12px}.od-ModifyPermissions-header{padding:12px 0;text-align:center;height:44px;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.od-ModifyPermissions-actions{padding:0 20px 20px 20px}[dir=ltr] .od-ModifyPermissions-actions{text-align:right}[dir=rtl] .od-ModifyPermissions-actions{text-align:left}.od-ModifyPermissions-actions div.ms-Button-label{font:-apple-system-headline}.teams .od-ModifyPermissions-actions{padding-bottom:32px}[dir=ltr] .teams .od-ModifyPermissions-actions{padding-right:0}[dir=rtl] .teams .od-ModifyPermissions-actions{padding-left:0}.od-ModifyPermissions-section{padding:20px 0 0 0}.isFluent .od-ModifyPermissions-section{padding:0}.teams .od-ModifyPermissions-section{padding-top:10px}.od-ModifyPermissions-section-noAudienceMod{padding-top:0}[dir=ltr] .od-ModifyPermissions-actions{text-align:right}[dir=rtl] .od-ModifyPermissions-actions{text-align:left}.od-ModifyPermissions-margins{margin:0 20px 0 20px}.isFluent .od-ModifyPermissions-margins{margin:0 14px 0 10px;padding:0 6px}[dir=rtl] .isFluent .od-ModifyPermissions-margins{margin:0 10px 0 14px}.od-confirmationDialog.shareDialog .ms-Dialog-actionsRight .ms-Button{width:100%;margin-top:4px;margin-bottom:4px}[dir=ltr] .od-confirmationDialog.shareDialog .ms-Dialog-actionsRight .ms-Button{margin-left:-4px}[dir=rtl] .od-confirmationDialog.shareDialog .ms-Dialog-actionsRight .ms-Button{margin-right:-4px}"}])});
define("@ms/odsp-shared-sharing/lib/components/ShareNotification/ShareNotification",["require","exports","tslib","../Header/Header","../../interfaces/SharingInterfaces","../ShareHint/ShareHint","office-ui-fabric-react/lib/TextField","react","prop-types","@ms/odsp-utilities/lib/string/StringHelper","../../utilities/ShareHelper","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Callout","office-ui-fabric-react/lib/Icon","../Share.resx","./ShareNotification.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._onShowNameTooltip=function(){i.setState(n.__assign({},i.state,{isNameTooltipVisible:!0}))};i._onHideNameTooltip=function(){i.setState(n.__assign({},i.state,{isNameTooltipVisible:!1}))};i._copySharingLinkToClipboard=function(){return n.__awaiter(i,void 0,void 0,function(){var e=this;return n.__generator(this,function(t){l.copySharingLinkToClipboard(this.props.clientId,this._textField,this.props.linkUrl).then(function(t){e.setState(n.__assign({},e.state,{successfullyCopied:t}))});return[2]})})};i._onNotificationLabel=function(e){i._notificationLabel=e};i.state={successfullyCopied:!1,isNameTooltipVisible:!1};i._resize=r.resize;i._sharingStore=r.sharingStore;i._platformDetection=r.platformDetection;return i}t.prototype.componentDidMount=function(){var e=this;this.props.shareType===i.ShareType.copy&&this.props.shouldCopyLinkToClipboard&&this._copySharingLinkToClipboard();this._platformDetection.isEdge&&setTimeout(function(){e._textField.focus()},500)};t.prototype.componentDidUpdate=function(){this._resize()};t.prototype.render=function(){var e=this,t=this._getNotificationLabel(),n=this._getNotificationLabel(!0),s=this._getNotificationAriaLabel(),a=this.props.shareType===i.ShareType.copy,f=!!this._sharingStore&&this._sharingStore.hasAccessRequestBeenCreated(),l=this.props.shareType,v=l===i.ShareType.share||l===i.ShareType.moreApps||l===i.ShareType.copy&&this.state.successfullyCopied,m=v?"od-ShareNotification-successPadding":"od-ShareNotification-failPadding";return f?u.createElement("div",{className:"od-ShareNotification"},u.createElement(r.Header,{viewState:3,clientId:this.props.clientId}),u.createElement("div",{className:"od-ShareNotification-content ms-font-su"},u.createElement(p.Icon,{iconName:"PeopleAlert",className:"od-ShareNotification-accessRequestIcon"}),u.createElement("div",{className:"od-ShareNotification-accessRequestHeader ms-fontWeight-regular"},d.default.accessRequestNotificationHeader),u.createElement("div",{className:"od-ShareNotification-accessRequestBody"},d.default.accessRequestNotificationBody))):u.createElement("div",{className:"od-ShareNotification "+m},u.createElement(r.Header,{viewState:3,clientId:this.props.clientId}),this._renderCheckMark(v),u.createElement("div",{className:"od-ShareNotification-content"},u.createElement("div",{className:"ms-font-l",ref:this._onNotificationLabel,onMouseOver:this._onShowNameTooltip,onMouseLeave:this._onHideNameTooltip},t),this.state.isNameTooltipVisible&&t!==n&&u.createElement(h.Callout,{directionalHint:h.DirectionalHint.topCenter,gapSpace:2,onDismiss:this._onHideNameTooltip,target:this._notificationLabel,calloutWidth:300},u.createElement("div",{className:"od-ShareNotification-content-tooltip"},n)),a&&this._renderCopyCta(),a&&u.createElement("div",{className:"od-ShareNotification-urlText"},u.createElement(o.TextField,{autoFocus:!0,"aria-live":"polite",ariaLabel:s,onClick:this._copySharingLinkToClipboard,readOnly:!0,componentRef:function(t){e._textField=t},type:"text",defaultValue:this.props.linkUrl,className:"od-ShareNotification-urlTextField"}),u.createElement(c.PrimaryButton,{className:"od-ShareNotification-copyButton",text:d.default.copyButtonLabel,onClick:this._copySharingLinkToClipboard}))),a&&this._renderShareHint())};t.prototype._renderCheckMark=function(e){if(e)return u.createElement("div",{className:"od-ShareNotification-icon"},u.createElement(p.Icon,{iconName:"CheckMark"}))};t.prototype._renderCopyCta=function(){var e=this.props,t=this.state;if(e.shareType===i.ShareType.copy&&!t.successfullyCopied)return u.createElement("span",{className:"od-ShareNotification-copyCta"},d.default.notificationCopyFailedCta)};t.prototype._renderShareHint=function(){var e=this.props.sharingHintProps;return e?u.createElement("div",{className:"od-ShareNotification-footer"},u.createElement(s.ShareHint,{clientId:e.clientId,companyName:e.companyName,currentSettings:e.currentSettings,sharingInformation:e.sharingInformation,onShareHintClick:e.sharingInformation.requiresAccessApproval?void 0:e.onShareHintClick,linkRecipients:e.linkRecipients,customLabeledAudienceConfig:e.customLabeledAudienceConfig})):null};t.prototype._getNotificationLabel=function(e){var t=d.default,n=e?this.props.itemName:l.truncateItemNameForShareNotification(this.props.itemName),r=this.props.shareType,s=n?f.format(t.notificationCopied,n):d.default.notificationCopiedLabel,o=n?f.format(t.notificationCopyFailed,n):d.default.notificationCopyFailedLabel,u=n?f.format(t.notificationSent,n):d.default.notificationSentLabel;return r===i.ShareType.copy?this.state.successfullyCopied?s:o:r===i.ShareType.share?u:r===i.ShareType.moreApps?o:""};t.prototype._getNotificationAriaLabel=function(){var e=this.props.shareType;return e===i.ShareType.copy?this.state.successfullyCopied?d.default.notificationCopiedLabel:d.default.notificationCopyFailedLabel:e===i.ShareType.share?d.default.notificationSentLabel:e===i.ShareType.moreApps?d.default.notificationCopyFailedLabel:""};t.contextTypes={resize:a.func.isRequired,sharingStore:a.object.isRequired,platformDetection:a.object.isRequired};return t}(u.Component);t.ShareNotification=v});
define("@ms/odsp-shared-sharing/lib/components/ShareHint/ShareHint",["require","exports","tslib","./ShareHintDetail/ShareHintDetail","../ShareLinkDescription/ShareLinkDescription","../../interfaces/SharingInterfaces","react","react","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/locale/Locale","../Share.resx","../../utilities/ShareHelper","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Coachmark","office-ui-fabric-react/lib/TeachingBubble","office-ui-fabric-react/lib/common/DirectionalHint","@ms/odsp-utilities/lib/features/FeatureOverrides","@ms/odsp-utilities/lib/logging/ABExperiment","prop-types","./ShareHint.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b={ODB:1176},w=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._targetButton=u.createRef();r._odShareHintchevron=u.createRef();r._onDismiss=function(){r.setState({isCoachmarkVisible:!1})};r._platformDetection=n.platformDetection;r._isOnExperiment=!1;if(m.default.isFeatureEnabled(b)){var i=new g.ABExperiment({name:"CoachMark",startDate:"08/2/2018",version:g.ABExpHash.v2});r._isOnExperiment=i.IsExperimentOn()}r.state={isCoachmarkVisible:r._isOnExperiment};return r}t.prototype.componentDidMount=function(){this._platformDetection.isIE&&this._targetButton.current&&this._targetButton.current.focus()};t.prototype.render=function(){var e,t,u=this.props,a=this._getFileShareTypeFromAudience(),h=this._getLabelFromPermissionsType(a),m=!!this.props.onShareHintClick,g="od-ShareHint "+(c.isLoadingData(u.sharingInformation)?"":"od-ShareHint--shimmerFadeout od-ShareHint--loaded"),y="od-ShareHint-data "+(m?"od-ShareHint--clickable":"");e=o.createElement("div",{className:"od-ShareHint-shimmer"},o.createElement("div",{className:"od-ShareHint-iconHolder-shimmer"},o.createElement("svg",{viewBox:"0 0 15 10",width:"36",height:"24"},o.createElement("path",{d:"M0,0 L15,0 L15,10 L0,10 L0,0 Z M0,5 C0,7.76142375 2.23857625,10 5,10 C7.76142375,10 10,7.76142375 10,5 C10,2.23857625 7.76142375,2.22044605e-16 5,0 C2.23857625,-2.22044605e-16 0,2.23857625 0,5 L0,5 Z"}))),o.createElement("div",{className:"od-ShareHint-text-shimmer"}));var b=this.props.currentSettings.audience===s.SharingAudience.customLabeledSpecificPeople&&this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.iconUrl;t=u.onShareHintClick?o.createElement("button",{className:y,ref:this._targetButton,onClick:this._openLinkPermissions.bind(this)},o.createElement("div",{className:"od-ShareHint-iconHolder"},o.createElement(i.ShareLinkDescription,{label:h,permissionsType:a,iconUrl:b,showLabel:!1})),o.createElement(r.ShareHintDetail,{clientId:u.clientId,companyName:u.companyName,currentSettings:u.currentSettings,sharingInformation:u.sharingInformation,linkRecipients:u.linkRecipients,customLabeledAudienceConfig:u.customLabeledAudienceConfig}),this._renderChevron(m)):o.createElement("div",n.__assign({className:y},{autoFocus:!0}),o.createElement("div",{className:"od-ShareHint-iconHolder"},o.createElement(i.ShareLinkDescription,{label:h,permissionsType:a,iconUrl:b,showLabel:!1})),o.createElement(r.ShareHintDetail,{clientId:u.clientId,companyName:u.companyName,currentSettings:u.currentSettings,sharingInformation:u.sharingInformation,linkRecipients:u.linkRecipients,customLabeledAudienceConfig:u.customLabeledAudienceConfig}),this._renderChevron(m));return o.createElement("div",{"aria-label":l.default.modifyPermissionsHeader,className:g},t,e,this.state.isCoachmarkVisible&&o.createElement(p.Coachmark,{target:this._odShareHintchevron.current,positioningContainerProps:{directionalHint:f.default.isRightToLeft?v.DirectionalHint.bottomLeftEdge:v.DirectionalHint.bottomRightEdge}},o.createElement(d.TeachingBubbleContent,{calloutProps:{directionalHint:f.default.isRightToLeft?v.DirectionalHint.bottomLeftEdge:v.DirectionalHint.bottomRightEdge,gapSpace:0},headline:l.default.modifyPermissionsHeader,hasCondensedHeadline:!0,hasCloseIcon:!0,closeButtonAriaLabel:l.default.closeButtonLabel,onDismiss:this._onDismiss},l.default.linkSettingsExplanation1,o.createElement("br",null),l.default.linkSettingsExplanation2)))};t.prototype._renderChevron=function(e){if(e)return o.createElement("div",{ref:this._odShareHintchevron},o.createElement(h.Icon,{iconName:f.default.isRightToLeft?"ChevronLeft":"ChevronRight",className:"od-ShareHint-chevron"}))};t.prototype._openLinkPermissions=function(){var e=this.props.onShareHintClick;e&&e()};t.prototype._getFileShareTypeFromAudience=function(){var e=this.props.currentSettings.audience;return e===s.SharingAudience.anyone?0:e===s.SharingAudience.organization?1:e===s.SharingAudience.existing?4:e===s.SharingAudience.customLabeledSpecificPeople?5:2};t.prototype._getLabelFromPermissionsType=function(e){var t=l.default;return 0===e?t.permissionsAnyoneString:1===e?a.format(t.permissionsCompanyString,this.props.companyName):4===e?t.permissionsExistingPeopleString:2===e?t.permissionsSpecificPeopleString:void 0};t.contextTypes={platformDetection:y.object.isRequired};return t}(o.Component);t.ShareHint=w});
define("@ms/odsp-shared-sharing/lib/components/ShareHint/ShareHintDetail/ShareHintDetail",["require","exports","tslib","office-ui-fabric-react/lib/Icon","../../../interfaces/SharingInterfaces","office-ui-fabric-react/lib/Tooltip","react","@ms/odsp-utilities/lib/string/StringHelper","../../Share.resx","@ms/odsp-utilities/lib/dateTime/DateTime","../../../utilities/ShareHelper","./ShareHintDetail.scss"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._renderStatusIcons=r._renderStatusIcons.bind(r);return r}t.prototype.render=function(){var e=this._getLabel(this.props.currentSettings);return o.createElement("div",{className:"od-ShareHintDetail"},o.createElement("div",{className:"od-ShareHintDetail-description"},o.createElement("div",{className:"od-ShareHintDetail-status"},o.createElement("span",{className:"od-ShareHintDetail-statusText"},e),this._renderStatusIcons())))};t.prototype._renderStatusIcons=function(){var e=this.props.currentSettings.expiration,t=this.props.currentSettings.password,n=this.props.currentSettings.preventDownload,i=this.props.currentSettings.shareId,l=[];e&&e.getTime()!==new Date(0).getTime()&&l.push({icon:"Calendar",tooltip:""+u.format(a.default.expiresIn2,f.getShortDisplayDate(e))});(i&&i.length>0||t.length>0)&&l.push({icon:"Lock",tooltip:a.default.sharePasswordReminderText});n&&l.push({icon:"Blocked2",tooltip:a.default.preventDownloadHint});var c=l.map(function(e,t){return o.createElement("i",{className:"od-ShareHintDetail-item"},o.createElement(s.TooltipHost,{content:e.tooltip,id:e.icon},o.createElement(r.Icon,{iconName:e.icon,"aria-describedby":e.icon})))});return o.createElement("div",{className:"od-ShareHintDetail-iconsList"},c)};t.prototype._getLabel=function(e){if(!e)return"";var t=a.default,n=this.props.companyName;if(e.preventDownload){if(e.audience===i.SharingAudience.anyone)return t.anonymousViewOnlyHint;if(e.audience===i.SharingAudience.organization)return u.format(t.cslViewOnlyHint,n);if(e.audience===i.SharingAudience.specificPeopleFlex)return t.specificPeopleViewOnlyHint}switch(e.sharingLinkKind){case 1:return e.audience===i.SharingAudience.specificPeople?e.sharingRole?2===e.sharingRole?t.specificPeopleEditHint:6===e.sharingRole?a.default.specificPeopleReviewHint:t.specificPeopleViewHint:e.isEdit?t.specificPeopleEditHint:t.specificPeopleViewHint:t.existingPeopleDescription;case 2:return u.format(t.cslViewDescription,n);case 3:return u.format(t.cslEditDescription,n);case 4:return t.anonViewDescription;case 5:return t.anonEditDescription;case 6:if(e.audience===i.SharingAudience.specificPeopleFlex)return e.sharingRole?2===e.sharingRole?t.specificPeopleEditHint:6===e.sharingRole?a.default.specificPeopleReviewHint:t.specificPeopleViewHint:e.isEdit?t.specificPeopleEditHint:t.specificPeopleViewHint;if(e.audience===i.SharingAudience.customLabeledSpecificPeople)return e.isEdit?this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?u.format(a.default.customLabeledEditLabel,this.props.customLabeledAudienceConfig.entityName):l.getCustomLinkLabel(this.props.clientId,"edit",this.props.customLabeledAudienceConfig):6===e.sharingRole?this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?u.format(a.default.customLabeledReviewLabel,this.props.customLabeledAudienceConfig.entityName):l.getCustomLinkLabel(this.props.clientId,"review",this.props.customLabeledAudienceConfig):this.props.customLabeledAudienceConfig&&this.props.customLabeledAudienceConfig.entityName?u.format(a.default.customLabeledViewLabel,this.props.customLabeledAudienceConfig.entityName):l.getCustomLinkLabel(this.props.clientId,"view",this.props.customLabeledAudienceConfig);if(e.audience===i.SharingAudience.organization){if(6===e.sharingRole)return u.format(t.cslReviewDescription,n)}else if(e.audience===i.SharingAudience.anyone&&6===e.sharingRole)return a.default.anonReviewDescription;return"";default:return""}};return t}(o.Component);t.ShareHintDetail=c});
define("@ms/odsp-shared-sharing/lib/components/ShareHint/ShareHintDetail/ShareHintDetail.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHintDetail{overflow:hidden}.od-ShareHintDetail-status{font-size:12px;padding:0 8px;vertical-align:middle}.od-ShareHintDetail-statusText{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";font:-apple-system-caption1}[dir=ltr] .od-ShareHintDetail-statusText{margin-right:4px}[dir=rtl] .od-ShareHintDetail-statusText{margin-left:4px}.od-ShareHintDetail-statusDetails{position:absolute;top:0}[dir=ltr] .od-ShareHintDetail-statusDetails{right:-36px}[dir=rtl] .od-ShareHintDetail-statusDetails{left:-36px}[dir=ltr] .od-ShareHintDetail-statusDetails{text-align:right}[dir=rtl] .od-ShareHintDetail-statusDetails{text-align:left}.od-ShareHintDetail-expirationText{font-size:12px;color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.od-ShareHintDetail-iconsList{display:inline-block}.od-ShareHintDetail-item{display:inline-block;margin-bottom:0;font-size:10px}[dir=ltr] .od-ShareHintDetail-item{margin-right:4px}[dir=rtl] .od-ShareHintDetail-item{margin-left:4px}.od-ShareHintDetail-item .ms-Icon{background-color:transparent;position:relative}.od-ShareHintDetail-item .ms-Icon:after{position:absolute;width:12px;height:12px;background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-ShareHintDetail-item-expired{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}[dir=ltr] .od-ShareHintDetail-description{text-align:left}[dir=rtl] .od-ShareHintDetail-description{text-align:right}"}])});
define("@ms/odsp-shared-sharing/lib/components/ShareHint/ShareHint.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareHint{background:0 0;margin:16px 16px 0 16px;position:relative}.isFluent .od-ShareHint{margin:0 16px}.od-ShareHint.od-ShareHint--shimmerFadeout .od-ShareHint-shimmer{opacity:0;visibility:hidden}.od-ShareHint.od-ShareHint--loaded .od-ShareHint-data{opacity:1;line-height:16px}.od-ShareHint .ms-Label{font-size:12px;padding:5px 8px;vertical-align:top}.od-ShareHint .ms-Icon--CaretDownSolid8{vertical-align:top;font-size:10px;padding-top:9px;color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3c3c3c"},{rawString:"}.od-ShareHint .od-ShareHint-data,.od-ShareHint .od-ShareHint-shimmer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ShareHint .od-ShareHint-data{font-size:14px;font-weight:400;background:0 0;border:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";padding:10px;margin:0;opacity:0;-webkit-transition:opacity .2s;transition:opacity .2s}@media screen and (-ms-high-contrast:active){.od-ShareHint .od-ShareHint-data{border:1px solid WindowText}}.isFluent .od-ShareHint .od-ShareHint-data{border-radius:2px}.ms-Fabric .od-ShareHint .od-ShareHint-data::-moz-focus-inner{border:0}.ms-Fabric .od-ShareHint .od-ShareHint-data{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-ShareHint .od-ShareHint-data:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-ShareHint .od-ShareHint-data:focus:after{border-color:ActiveBorder}}.od-ShareHint .od-ShareHint-data .od-ShareHint-iconHolder{vertical-align:top}.od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{display:inline-block;vertical-align:top;margin-top:4px;font-size:10px;color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}[dir=ltr] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-left:auto}[dir=rtl] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{margin-right:auto}[dir=ltr] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-left:4px}[dir=rtl] .od-ShareHint .od-ShareHint-data .od-ShareHint-chevron{padding-right:4px}.od-ShareHint div.od-ShareHint-data{border:0}.od-ShareHint button.od-ShareHint-data{width:100%}.od-ShareHint .od-ShareHint--clickable{cursor:pointer}.od-ShareHint .od-ShareHint--clickable:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-ShareHint .od-ShareHint-shimmer{width:100%;position:absolute;top:0;-webkit-box-sizing:border-box;box-sizing:border-box;border:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";padding:14px 10px;background:-webkit-gradient(linear, left top, right top, from("},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"), color-stop(50%, "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"), to("},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"));background:linear-gradient(to right, "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:" 0, "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:" 50%, "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:" 100%);background-size:90% 100%;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";background-clip:content-box;background-repeat:no-repeat;-webkit-animation:2s ease-in-out infinite placeholderShimmer;animation:2s ease-in-out infinite placeholderShimmer;-webkit-transition:opacity .2s,visibility .2s;transition:opacity .2s,visibility .2s}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer{width:36px;height:24px}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-iconHolder-shimmer svg{fill:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShareHint .od-ShareHint-shimmer .od-ShareHint-text-shimmer{color:transparent;width:100%;height:24px;border-bottom:4px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-top:4px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";-webkit-box-sizing:border-box;box-sizing:border-box}.teams .od-ShareHint-data .od-ShareHint-chevron{-webkit-transform:rotate(90deg);transform:rotate(90deg);margin-top:0}.ms-TeachingBubble-closebutton{color:#fff}@-webkit-keyframes placeholderShimmer{0%{background-position:-900%}100%{background-position:1000%}}@keyframes placeholderShimmer{0%{background-position:-900%}100%{background-position:1000%}}"}])});
define("@ms/odsp-shared-sharing/lib/components/ShareNotification/ShareNotification.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareNotification{text-align:center;position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.od-ShareNotification-successPadding{padding-top:24px}.od-ShareNotification-failPadding{padding-top:50px}[dir=ltr] .isFluent .od-ShareNotification-failPadding .od-ShareNotification-content{text-align:left}[dir=rtl] .isFluent .od-ShareNotification-failPadding .od-ShareNotification-content{text-align:right}[dir=ltr] .isFluent .od-ShareNotification-failPadding .ms-TextField{margin-right:8px}[dir=rtl] .isFluent .od-ShareNotification-failPadding .ms-TextField{margin-left:8px}.od-ShareNotification-icon{position:relative;margin-bottom:16px;opacity:0;-webkit-transform:translateX(-50%) scale(.5,.5);transform:translateX(-50%) scale(.5,.5);-webkit-transform-origin:50% 50%;transform-origin:50% 50%;background-color:#599b00;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:21px;border-radius:50%;width:44px;height:44px;-webkit-animation:bounce .45s;animation:bounce .45s;-webkit-animation-fill-mode:both;animation-fill-mode:both;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin-left:44px}.isFluent .od-ShareNotification-icon{background-color:#498205}.od-ShareNotification-content{width:90%}[dir=ltr] .od-ShareNotification-content{padding-left:16px}[dir=rtl] .od-ShareNotification-content{padding-right:16px}[dir=ltr] .od-ShareNotification-content{padding-right:16px}[dir=rtl] .od-ShareNotification-content{padding-left:16px}.isFluent .od-ShareNotification-content .ms-font-l{font-weight:500}.od-ShareNotification-content-tooltip{margin:5px}.od-ShareNotification-permissionText{margin-bottom:24px;padding:0 20px}.od-ShareNotification-urlText{padding:10px 4px 12px 4px;display:-webkit-box;display:-ms-flexbox;display:flex}.isFluent .od-ShareNotification-urlText{padding:12px 0}.od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding:0}[dir=ltr] .od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding-left:8px}[dir=rtl] .od-ShareNotification-urlText .ms-TextField .ms-TextField-field{padding-right:8px}.od-ShareNotification-urlText .ms-TextField .ms-TextField-fieldGroup{height:32px}.od-ShareNotification-close{position:absolute;top:16px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:12px;width:12px;height:12px;cursor:pointer}[dir=ltr] .od-ShareNotification-close{right:12px}[dir=rtl] .od-ShareNotification-close{left:12px}.od-ShareNotification-footer{margin-top:-10px;width:100%}@-webkit-keyframes bounce{0%{-webkit-transform:translateX(-50%) scaleX(.8) scaleY(.8);transform:translateX(-50%) scaleX(.8) scaleY(.8);opacity:0}60%{-webkit-transform:translateX(-50%) scaleX(1.35) scaleY(1.35);transform:translateX(-50%) scaleX(1.35) scaleY(1.35);opacity:1;-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}100%{-webkit-transform:translateX(-50%) scaleX(1) scaleY(1);transform:translateX(-50%) scaleX(1) scaleY(1);opacity:1;-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}}@keyframes bounce{0%{-webkit-transform:translateX(-50%) scaleX(.8) scaleY(.8);transform:translateX(-50%) scaleX(.8) scaleY(.8);opacity:0}60%{-webkit-transform:translateX(-50%) scaleX(1.35) scaleY(1.35);transform:translateX(-50%) scaleX(1.35) scaleY(1.35);opacity:1;-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}100%{-webkit-transform:translateX(-50%) scaleX(1) scaleY(1);transform:translateX(-50%) scaleX(1) scaleY(1);opacity:1;-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}}.od-ShareNotification .od-ShareHint{margin:16px 0 0 0;padding:16px;border:none;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.isFluent .od-ShareNotification .od-ShareHint{border-top:0;margin:0}.od-ShareNotification .od-ShareHint--clickable{width:100%}.od-ShareNotification-copyCta{font-size:12px;font-weight:400}.od-ShareNotification-copyButton{height:32px;min-width:-webkit-fit-content;min-width:-moz-fit-content;min-width:fit-content;width:auto}[dir=ltr] .teams .od-ShareNotification-copyButton{margin-left:5px}[dir=rtl] .teams .od-ShareNotification-copyButton{margin-right:5px}.od-ShareNotification-urlTextField{width:100%}.od-ShareNotification-accessRequestIcon{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";margin-top:24px}.od-ShareNotification-accessRequestHeader{font-size:17px;font-weight:300;margin-bottom:8px}.od-ShareNotification-accessRequestBody{font-size:12px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";margin:0 8px 24px 8px;text-align:left}"}])});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/PermissionsList",["require","exports","tslib","../Header/Header","../../interfaces/SharingInterfaces","./ShareLink/ShareLink","./SharePrincipal/SharePrincipal","./SharePrincipal/SharePrincipal2","../Share/Share","../../utilities/ClientIdHelper","react","../Share.resx","office-ui-fabric-react/lib/Spinner","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Tooltip","office-ui-fabric-react/lib/FocusZone","../../utilities/ShareCommunicationManager","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/MessageBar","prop-types","@ms/odsp-utilities/lib/icons/ItemType","@ms/utilities-strings/lib/index","office-ui-fabric-react/lib/Callout","./PermissionsList.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._isManageAccessModeLoaded=!1;r._showPermissionsList=function(){r.setState({showLinkDetails:!1})};r._onRemoveLink=function(){r.setState({linkRemovedText:c.default.linkRemovedText})};r._onLinkSelected=function(e){r.setState({currentSharingLink:e,showLinkDetails:!0})};r._onShareClick=function(e){r._targetElement=e.target;r._mode=i.Mode.share;r.setState({showShare:!0})};r._onGrantAccessClick=function(e){r._targetElement=e.target;r._mode=i.Mode.addPeople;r.setState({showGrantAccess:!0})};r._onDismiss=function(){r._mode===i.Mode.share?r.setState({showShare:!1}):r.setState({showGrantAccess:!1})};r._shareClickTime=n.shareClickTime;r._sharingStore=n.sharingStore;r._mode=r.props.mode;r.state={viewState:r.props.viewState,showLinkDetails:!1,currentSharingLink:void 0,linkRemovedText:"",showShare:!1,showGrantAccess:!1};r._isShareCommandsExperimentOn=f.isODSP(r.props.clientId)&&r.props.shareCommandsExperiment;r._isLinkSettingsEditPanelEnabled=r._sharingStore.showManageAccess()&&(r.props.mode===i.Mode.manageAccess||r.props.mode===i.Mode.share);return r}t.prototype.componentDidUpdate=function(){this.props.hideElementsInManageAccess(this.state.showLinkDetails)};t.prototype.getChildContext=function(){return{onDismiss:this._onDismiss}};t.prototype.render=function(){var e,t=this.props.sharingInformation,n=this.props.sharingInformation.sharingLinks.reduce(function(e,t){return e+(t.isActive?1:0)},-1)>0;e=t.hasPermissionsInformation?t.isShared?l.createElement("div",{className:"od-PermissionsList-content"},l.createElement("div",{className:"od-PermissionsList-links"},this._renderLinks()),l.createElement("div",{className:"od-PermissionsList-entities"},this._renderPrincipals(n))):l.createElement("div",null,c.default.notShared):l.createElement("div",{className:"od-Share-spinnerHolder"},l.createElement(h.Spinner,{className:"od-Share-spinner",label:c.default.componentLoading,type:h.SpinnerType.large}));if(!this._isManageAccessModeLoaded&&this.props.mode===i.Mode.manageAccess){m.pageFinishedLoading(this._shareClickTime,this.props.clientId,this.props.mode,this.props.scenarioId);this._isManageAccessModeLoaded=!0}var r=t.hasInheritedLinks,s=!f.isODSP(this.props.clientId)&&!this.state.showLinkDetails;return l.createElement("div",{className:"od-PermissionsList"},s&&this._renderHeader(),r&&this._renderInheritance(n),l.createElement("div",{className:"od-Share-screenReaderOnly","aria-live":"assertive",role:"alert","aria-label":this.state.linkRemovedText},this.state.linkRemovedText),this.state.showLinkDetails?this._renderLinkDetails():e)};t.prototype._renderHeader=function(){return l.createElement("div",{className:"od-PermissionsList-header"},this.props.mode!==i.Mode.manageAccess&&l.createElement(y.IconButton,{className:"od-Share-backButton",onClick:this.props.backButtonClicked,iconProps:{iconName:"Back"},ariaLabel:c.default.backButtonLabel},l.createElement("label",{className:"od-Share-screenReaderOnly"},c.default.backButtonLabel)),l.createElement(r.Header,{clientId:this.props.clientId,item:this.props.sharingInformation.item,viewState:4,"data-is-focusable":!0,mode:this.props.mode}))};t.prototype._renderInheritance=function(e){var t,n;this.props.sharingInformation.item.itemType===E.default.Folder?n=c.default.inheritedLinksFolder:this.props.sharingInformation.item&&(n=c.default.inheritedLinksFile);t=e?S.format(c.default.activeAndInheritedLinks,n):S.format(c.default.onlyInheritedLinks,n);return l.createElement("div",{className:"od-PermissionsList-inheritance"},l.createElement(b.MessageBar,null,t))};t.prototype._renderLinkDetails=function(){return l.createElement(s.ShareLink,{key:this.state.currentSharingLink.shareId,mode:this.props.mode,companyName:this.props.companyName,link:this.state.currentSharingLink,clientId:this.props.clientId,sharingInformation:this.props.sharingInformation,groupsMemberCount:this.props.groupsMemberCount,linkRecipients:this.props.linkRecipients,enableLinkSettings:this._isLinkSettingsEditPanelEnabled,showMoreOptions:!1,onShowLinkDetailsClicked:this._onLinkSelected,linkDetailsView:!0,showPermissionsList:this._showPermissionsList,onRemoveLink:this._onRemoveLink})};t.prototype._renderLinks=function(){var e=this,t=this.props.sharingInformation.sharingLinks,n=!1;return l.createElement("div",{className:"od-PermissionsList-linksListHolder","aria-label":c.default.linksListHeaderTooltip},this._isLinkSettingsEditPanelEnabled&&l.createElement("div",{className:"od-ShareLinkDetails--sectionHeader"},l.createElement(p.Icon,{iconName:"Link",className:"ms-Icon ms-Icon--Link"}),c.default.linksListHeader,l.createElement(d.TooltipHost,{id:"od-ShareLinkDetails-tooltip-links",content:c.default.linksListHeaderTooltip,directionalHint:d.DirectionalHint.topCenter,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},l.createElement(p.Icon,{iconName:"Info",className:"ms-Icon ms-Icon--Info",ariaLabel:c.default.linksListHeaderTooltip,"aria-describedby":"od-ShareLinkDetails-tooltip-links","aria-haspopup":!0})),this._isShareCommandsExperimentOn&&l.createElement("div",{className:"od-ShareLinkDetails--sectionHeader-share"},l.createElement(y.IconButton,{className:"ms-Icon ms-Icon--Share",iconProps:{iconName:"Share"},title:c.default.share,"aria-label":c.default.share,onClick:this._onShareClick},l.createElement("span",null,c.default.share)),this.state.showShare&&this._renderShare())),l.createElement("ul",{className:"od-PermissionsList-links"},t.map(function(t,r){if(t.audience!==i.SharingAudience.specificPeople&&t.isActive){n=!0;return l.createElement("li",{key:t.shareId,role:"presentation"},l.createElement(s.ShareLink,{key:t.shareId,mode:e.props.mode,companyName:e.props.companyName,link:t,clientId:e.props.clientId,sharingInformation:e.props.sharingInformation,groupsMemberCount:e.props.groupsMemberCount,linkRecipients:e.props.linkRecipients,enableLinkSettings:e._isLinkSettingsEditPanelEnabled,showMoreOptions:e._isLinkSettingsEditPanelEnabled,onShowLinkDetailsClicked:e._onLinkSelected,linkDetailsView:!1,showPermissionsList:e._showPermissionsList}))}}),this._isLinkSettingsEditPanelEnabled&&l.createElement("div",{"aria-live":"polite","aria-atomic":"true",className:"od-Share-screenReaderOnly"},n?"":c.default.noLinksGivingAccess),!n&&this._renderNoSharingLinks()))};t.prototype._renderNoSharingLinks=function(){if(this._isLinkSettingsEditPanelEnabled)return l.createElement("div",{className:"od-PermissionsList-emptyLinks"},c.default.noLinksGivingAccess)};t.prototype._renderPrincipals=function(e){var t=this,n=this.props.sharingInformation,r=n.sharingPrincipals.slice();return this._isLinkSettingsEditPanelEnabled?l.createElement("div",{className:"od-PermissionsList-entitiesListHolder"},this._isLinkSettingsEditPanelEnabled&&l.createElement("div",{className:"od-ShareLinkDetails--sectionHeader"},l.createElement(p.Icon,{iconName:"PlayerSettings",className:"ms-Icon ms-Icon--PlayerSettings"}),c.default.principalsListHeader,l.createElement(d.TooltipHost,{id:"od-ShareLinkDetails-tooltip-principals",content:c.default.principalsListHeaderTooltip,directionalHint:d.DirectionalHint.topCenter,calloutProps:{gapSpace:0},tooltipProps:{maxWidth:"300px"}},l.createElement(p.Icon,{iconName:"Info",className:"ms-Icon ms-Icon--Info",ariaLabel:c.default.principalsListHeaderTooltip,"aria-describedby":"od-ShareLinkDetails-tooltip-principals","aria-haspopup":!0})),this._isShareCommandsExperimentOn&&l.createElement("div",{className:"od-ShareLinkDetails--sectionHeader-grantAccess"},l.createElement(y.IconButton,{className:"ms-Icon ms-Icon--Add",iconProps:{iconName:"Add"},onClick:this._onGrantAccessClick}),this.state.showGrantAccess&&this._renderShare())),l.createElement("ul",{className:"od-PermissionsList-entities","aria-label":c.default.permissionsListPrincipalsAriaLabel},l.createElement(v.FocusZone,{direction:v.FocusZoneDirection.vertical,isInnerZoneKeystroke:function(e){return e.which===g.getRTLSafeKeyCode(g.KeyCodes.right)}},r.map(function(e,r){return l.createElement("li",{key:e.id},l.createElement(u.SharePrincipal2,{key:e.id,principal:e,userRole:n.userRole,clientId:t.props.clientId,item:t.props.sharingInformation.item}))})))):l.createElement("ul",{className:"od-PermissionsList-entities",role:"list","aria-label":c.default.permissionsListPrincipalsAriaLabel},r.map(function(r,i){return l.createElement("li",{key:r.id,tabIndex:0,"aria-atomic":!0,"aria-live":"assertive",className:"od-PermissionsList-principalGroup"},l.createElement(o.SharePrincipal,{principal:r,takeFocus:!e&&0===i,userRole:n.userRole,clientId:t.props.clientId,item:t.props.sharingInformation.item}))}))};t.prototype._renderShare=function(){return l.createElement(x.Callout,{target:this._targetElement,preventDismissOnScroll:!0,role:"alert","aria-live":"assertive",directionalHint:d.DirectionalHint.bottomCenter,onDismiss:this._onDismiss},l.createElement(a.Share,{mode:this._mode,hideShareDialogOverflowButton:!0,clientId:this.props.clientId}))};t.contextTypes={shareClickTime:w.number,sharingStore:w.object.isRequired};t.childContextTypes={onDismiss:w.func};return t}(l.Component);t.PermissionsList=T});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLink/ShareLink",["require","exports","tslib","react","prop-types","../../Share.resx","../../../interfaces/SharingInterfaces","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/TextField","office-ui-fabric-react/lib/Icon","./LinkMember/LinkMember","../../../utilities/ShareHelper","../ShareLinkParticipants/ShareLinkParticipants","office-ui-fabric-react/lib/Facepile","../ShareLinkDetails/ShareLinkDetails","office-ui-fabric-react/lib/Persona","../ShareLink/ConfirmationDialog/ConfirmationDialog","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/dateTime/DateTime","office-ui-fabric-react/lib/Tooltip","office-ui-fabric-react/lib/FocusZone","./ShareLink.scss","../../ModifyPermissions/PermissionsSettings/PermissionsSettings.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._onChevronClick=function(){i.setState({linkMemberExpanded:!i.state.linkMemberExpanded})};i._onCancel=function(){i.setState(function(){return n.__assign({},i.state,{showConfirmationDialog:!1,participants:c.getLinkParticipants(i._link),expirationErrorCode:c.ExpirationErrorCode.none,selectedPermissions:i._getLinkSettings(),hasSettingsChange:!1,hasPeopleChange:!1})});if(!i.state.hasSettingsChange&&!i.state.hasPeopleChange){var e=i.props.showPermissionsList;e&&e()}};i._onConfirmationDeleteLink=function(){if(i.state.confirmationCode===m.ConfirmationCode.link){i._onShareLinkDelete();i.setState({showConfirmationDialog:!1,confirmationCode:m.ConfirmationCode.none,hasSettingsChange:!1,linkDetailsView:!1})}var e=i.props.showPermissionsList;e&&e()};i._showLinkDetails=function(){var e=i.props.onShowLinkDetailsClicked;e&&e(i._link)};i._onShareLinkDelete=function(){var e=i._link;i.props.onRemoveLink&&i.props.onRemoveLink();i._store.unshareLink(e.sharingLinkKind,e.shareId)};i._onLinkClicked=function(e){try{var t=e.target;t.focus();t.setSelectionRange(0,t.value.length)}catch(e){}};i._copySharingLinkToClipboard=function(){var e=i.props.clientId,t=i._link.url,n=i._textField;c.copySharingLinkToClipboard(e,n,t).then(function(e){i.setState({copyLinkToClipboardSuccess:e});i._copyButton.focus();e&&setTimeout(function(){i.setState({copyLinkToClipboardSuccess:!1})},2e3)})};i._updateLinkSettings=function(e){var t=[],r=[],u=i.state.participants;if(e){var a=i._link.invitees.filter(function(t){return t.email===e.email});if(a.length>0){t.push(n.__assign({},a[0],{type:a[0].type}));i.setState({participantRemovedText:g.format(s.default.removedPersonText,a[0].primaryText)});i._chevronButton&&i._chevronButton.focus()}}else{for(var f=function(e){0===(!0===e.isExternal?u.filter(function(t){return t.email===e.email}):u.filter(function(t){return t.userId===e.loginName})).length&&t.push(e)},l=0,h=i._link.invitees;l<h.length;l++){f(h[l])}for(var p=function(e){if(!0===e.isExternal&&i.state.selectedPermissions.audience===o.SharingAudience.organization)return"continue";0===(!0===e.isExternal?i._link.invitees.filter(function(t){return t.email===e.email}):i._link.invitees.filter(function(t){return t.loginName===e.userId})).length&&!0===e.isResolved&&r.push(e)},d=0,v=u;d<v.length;d++){p(v[d])}}if(t.length>0||r.length>0||i.state.hasSettingsChange){i._store.shareLink({settings:i.state.selectedPermissions,recipients:r,copyLinkCommand:!1,allRecipientsHaveAccess:!1,shareId:i._link.shareId,inviteesToRemove:t});i._store.addListener(function(){i.setState(function(){var e=i._store.getSharingInformation().sharingLinks.filter(function(e){return e.shareId===i._link.shareId});if(e&&e.length>0){i._link=e[0];return{link:i._link,participants:6===i._link.sharingLinkKind?c.getLinkParticipants(i._link):[]}}})})}};i._onPeoplePickerChange=function(e,t){i.setState(n.__assign({},i.state,{selectedPermissions:i.state.selectedPermissions,participants:0===e.length?i.state.participants.concat(t):i.state.participants,hasPeopleChange:0===e.length}))};i._onRoleChange=function(e){var t=i.state.selectedPermissions,r=c.getLinkKind(t.audience,2===e);i.setState(n.__assign({},i.state,{selectedPermissions:n.__assign({},t,{sharingRole:e,isEdit:2===e,sharingLinkKind:r}),hasSettingsChange:e!==i._getSharingRole()||i.state.hasSettingsChange}))};i._onExpirationChange=function(e){e||i._link.expiration||(e=c.getDefaultExpirationDateValue(i.props.sharingInformation.anonymousLinkExpirationRestrictionDays));i.setState(function(){return n.__assign({},i.state,{selectedPermissions:n.__assign({},i.state.selectedPermissions,{expiration:e,shareId:i._link.shareId}),hasSettingsChange:e!==i.state.selectedPermissions.expiration||i.state.hasSettingsChange})})};i._onPasswordChange=function(e){i.setState(function(){return n.__assign({},i.state,{selectedPermissions:n.__assign({},i.state.selectedPermissions,{password:e,updatePassword:e.length>0,shareId:i._link.shareId}),hasSettingsChange:!0})})};i._getLinkSettings=function(){return{allowEditing:!0,audience:i._link.audience,expiration:i._link.expiration,isEdit:i._link.isEdit,isReview:i._link.isReview,sharingLinkKind:i._link.sharingLinkKind,specificPeople:c.getLinkParticipants(i._link),updatePassword:i._link.updatePassword,password:i._link.password,sharingRole:i._getSharingRoleFromLink(),preventDownload:i._link.blockDownload,hasPassword:i._link.hasPassword}};i._store=r.sharingStore;i._link=i.props.link;i.state={linkRemovedText:"",copyLinkToClipboardSuccess:!1,link:i._link,allowPasswordChange:!1,linkMemberExpanded:!1,hasSettingsChange:!1,hasPeopleChange:!1,participants:c.getLinkParticipants(i._link),showConfirmationDialog:!1,confirmationCode:m.ConfirmationCode.none,selectedPermissions:i._getLinkSettings(),expirationErrorCode:c.ExpirationErrorCode.none,linkDetailsView:i.props.linkDetailsView,participantRemovedText:""};return i}t.prototype.render=function(){var e=this,t=this.props.link,n=t.url,i=c.getLinkIconName(this.props.link),o=c.getLinkLabel(this.props.link,this.props.companyName,this.props.clientId),l=t.principals&&t.principals.length>0||t.invitees&&t.invitees.length>0;return this.props.enableLinkSettings&&this.state.linkDetailsView?this._renderLinkDetails():this.props.enableLinkSettings?r.createElement("div",null,this._renderShareLink(),this.props.showMoreOptions&&l&&r.createElement("div",{"aria-label":s.default.linkMembersListLabel,className:"od-ShareLink--inviteesHolder","data-is-focusable":!0,"aria-expanded":this.state.linkMemberExpanded},r.createElement("div",{className:"od-ShareLink--inviteesHolder-header",onClick:this._onChevronClick},!this.state.linkMemberExpanded&&6===this._link.sharingLinkKind&&this._renderLinkMembersForEditPanel(),!!this.state.linkMemberExpanded&&r.createElement("div",{className:"od-ShareLink--inviteesHolder-headerExpanded"},s.default.inviteesHolderLabel),6===this._link.sharingLinkKind&&this._renderChevron()),this.state.linkMemberExpanded&&this._renderParticipantsList(),r.createElement("div",{className:"od-Share-screenReaderOnly","aria-live":"assertive",role:"alert","aria-label":this.state.participantRemovedText},this.state.participantRemovedText)),this.state.showConfirmationDialog&&this._renderConfirmationDialogDeleteLink()):r.createElement("div",null,r.createElement("div",{className:"od-ShareLink flightOff"},r.createElement("div",{className:"od-ShareLink-main"},r.createElement("div",{className:"od-ShareLink-icon"},r.createElement(f.Icon,{iconName:i})),r.createElement("div",{className:"od-ShareLink-details","aria-live":"assertive","aria-relevant":"all"},r.createElement("div",{className:"od-Share-screenReaderOnly","aria-live":"assertive",role:"alert","aria-label":this.state.linkRemovedText},this.state.linkRemovedText),r.createElement(a.TextField,{"data-is-focusable":!0,autoFocus:!0,onClick:this._onLinkClicked,className:"od-ShareLink-url",defaultValue:n,readOnly:!0,ariaLabel:o,componentRef:function(t){return e._textField=t}})),r.createElement(u.IconButton,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",onClick:this._onShareLinkDelete,iconProps:{iconName:"Cancel"},title:s.default.removeLinkText,ariaLabel:s.default.removeLinkText})),r.createElement("div",{className:"od-ShareLink-description flightOff"},o)),l&&this._renderLinkMembers())};t.prototype._renderLinkDetails=function(){return r.createElement(d.ShareLinkDetails,{companyName:this.props.companyName,link:this._link,participants:this.state.participants,clientId:this.props.clientId,sharingInformation:this.props.sharingInformation,mode:this.props.mode,groupsMemberCount:this.props.groupsMemberCount,linkRecipients:this.props.linkRecipients,updateLinkSettings:this._updateLinkSettings,getLinkSettings:this._getLinkSettings,selectedPermissions:this.state.selectedPermissions,onRoleChange:this._onRoleChange,onExpirationChange:this._onExpirationChange,onPasswordChange:this._onPasswordChange,onPeoplePickerChange:this._onPeoplePickerChange,hasSettingsChange:this.state.hasSettingsChange,onCancel:this._onCancel,showPermissionsList:this.props.showPermissionsList,enableLinkSettings:this.props.enableLinkSettings,onRemoveLink:this.props.onRemoveLink})};t.prototype._renderParticipantsList=function(){return r.createElement(h.ShareLinkParticipants,{link:this._link,showDetailsPanel:!1,participants:this.state.participants,updateLinkSettings:this._updateLinkSettings})};t.prototype._renderLinkMembersForEditPanel=function(){var e=this.state.participants.map(function(e){return{personaName:e.name,imageUrl:e.image}});return r.createElement(p.Facepile,{personas:e,personaSize:v.PersonaSize.size24,maxDisplayablePersonas:4,overflowButtonType:p.OverflowButtonType.descriptive,overflowButtonProps:{ariaLabel:s.default.overflowButtonFacepileAriaLabel}})};t.prototype._renderChevron=function(){var e=this;return r.createElement(u.IconButton,{title:s.default.inviteesHolderChevronAriaLabel,ariaLabel:s.default.inviteesHolderChevronAriaLabel,"aria-expanded":this.state.linkMemberExpanded,className:"od-ShareLink--inviteesHolder-headerChevron",iconProps:!0===this.state.linkMemberExpanded?{iconName:"ChevronUp"}:{iconName:"ChevronDown"},componentRef:function(t){return e._chevronButton=t}})};t.prototype._renderConfirmationDialogDeleteLink=function(){var e=this,t=this.state,n=t.confirmationCode,i=t.participants,s=t.participant;return r.createElement(m.ConfirmationDialog,{confirmationCode:n,participants:i,participant:s,onApply:this._onConfirmationDeleteLink,onCancel:this.state.confirmationCode===m.ConfirmationCode.back?this._onCancel:function(){e.setState({showConfirmationDialog:!1,confirmationCode:m.ConfirmationCode.none})}})};t.prototype._renderShareLink=function(){var e=this,t=this._link,n=t.url,i=this.state.copyLinkToClipboardSuccess,o=c.getLinkIconName(this.props.link),l=c.getLinkLabel(t,this.props.companyName,this.props.clientId);return r.createElement("div",{className:"od-ShareLink"},r.createElement("div",{className:"od-ShareLink-main"},r.createElement("div",{className:"od-ShareLink-icon2 icon-"+o},r.createElement(f.Icon,{iconName:o,"aria-hidden":!0})),r.createElement("div",{className:"od-ShareLink-details"},r.createElement(a.TextField,{"data-is-focusable":!0,className:"od-ShareLink-url",defaultValue:n,readOnly:!0,ariaLabel:this._getAriaLabel(),componentRef:function(t){return e._textField=t}})),r.createElement(u.DefaultButton,{onClick:this._copySharingLinkToClipboard,"data-is-focusable":!0,ariaLabel:i?s.default.notificationCopiedLabel:s.default.copyLinkLabel,componentRef:function(t){return e._copyButton=t}},i?s.default.copiedButtonLabel:s.default.copyButtonLabel),this.props.showMoreOptions?r.createElement(u.IconButton,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",onClick:this._showLinkDetails,iconProps:{iconName:"More"},title:s.default.moreOptionsLabel,ariaLabel:s.default.moreOptionsLabel}):r.createElement(u.IconButton,{"data-is-focusable":!0,title:s.default.removeLinkText,className:"od-ShareLink-actionButton",onClick:function(){return e.setState({showConfirmationDialog:!0,confirmationCode:m.ConfirmationCode.link})},iconProps:{iconName:"Cancel"},ariaLabel:s.default.removeLinkText})),r.createElement("div",{className:"od-ShareLink-description",onClick:this._showLinkDetails},r.createElement("div",{className:"od-ShareLink-description-label"},r.createElement("span",{className:"od-ShareHintDetail-statusText"},l),this._renderStatusIcons())))};t.prototype._renderStatusIcons=function(){var e=this._link.expiration,t=this._link.hasPassword,n=this._link.blockDownload,i=this._link.isCreateOnlyLink,o=[];e&&(e<new Date(Date.now())?o.push({icon:"EventDateMissed12",tooltip:""+g.format(s.default.expiredIn2,y.getShortDisplayDate(e))}):e.getTime()!==new Date(0).getTime()&&o.push({icon:"Calendar",tooltip:""+g.format(s.default.expiresIn2,y.getShortDisplayDate(e))}));t&&o.push({icon:"Lock",tooltip:s.default.sharePasswordReminderText});n&&!i&&o.push({icon:"Blocked2",tooltip:s.default.preventDownloadHint});var u=o.map(function(e,t){return r.createElement("i",{className:"EventDateMissed12"!==e.icon?"od-ShareHintDetail-item":"od-ShareHintDetail-item od-ShareHintDetail-item-expired"},r.createElement(b.TooltipHost,{content:e.tooltip,id:e.icon},r.createElement(f.Icon,{iconName:e.icon,"aria-describedby":e.icon})))});return r.createElement("div",{className:"od-ShareHintDetail-iconsList"},u)};t.prototype._getAriaLabel=function(){var e=this._link.expiration,t=this._link.hasPassword,n=this._link.blockDownload,r=c.getLinkLabel(this._link,this.props.companyName,this.props.clientId);e&&(e<new Date(Date.now())?r+=" "+g.format(s.default.expiredIn2,y.getShortDisplayDate(e))+".":e.getTime()!==new Date(0).getTime()&&(r+=" "+g.format(s.default.expiresIn2,y.getShortDisplayDate(e))+"."));t&&(r+=" "+s.default.sharePasswordReminderText+".");n&&(r+=" "+s.default.preventDownloadHint+".");return r};t.prototype._renderLinkMembers=function(){var e=this.props.link.principals.map(function(e){return{primaryText:e.primaryText,imageUrl:e.imageUrl,email:e.email}}).concat(this.props.link.invitees.map(function(e){return{primaryText:e.primaryText,imageUrl:e.imageUrl,email:e.email}}));return r.createElement(w.FocusZone,null,r.createElement("ul",{"aria-label":s.default.linkMembersListLabel,className:"od-ShareLink--inviteesHolder flightOff","data-is-focusable":!0},e.map(function(e){return r.createElement("li",{className:"od-ShareLink-linkMember",key:e.primaryText,"data-is-focusable":!0,tabIndex:0},r.createElement(l.LinkMember,{primaryText:e.primaryText,imageUrl:e.imageUrl}))})))};t.prototype._getSharingRole=function(){return this.state.selectedPermissions.isEdit?2:this.state.selectedPermissions.isReview?6:1};t.prototype._getSharingRoleFromLink=function(){return this._link.isEdit?2:this._link.isReview?6:1};t.contextTypes={sharingStore:i.object.isRequired};return t}(r.Component);t.ShareLink=E});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLink/LinkMember/LinkMember",["require","exports","tslib","office-ui-fabric-react/lib/Callout","office-ui-fabric-react/lib/Persona","react","./LinkMember.scss"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._onShowCallout=function(){i.setState(n.__assign({},i.state,{isCalloutVisible:!0}))};i._onDismissCallout=function(){i.setState(n.__assign({},i.state,{isCalloutVisible:!1}))};i.state={isCalloutVisible:!1};i._uniqueId="j"+Math.random().toString().replace(".","");return i}t.prototype.render=function(){var e=this.props,t=this.state;return s.createElement("div",{className:"od-LinkMember"},s.createElement(i.Persona,{className:"od-LinkMember-Persona",primaryText:e.primaryText,initialsColor:i.PersonaInitialsColor.blue,size:i.PersonaSize.extraExtraSmall,onMouseOver:this._onShowCallout,onMouseLeave:this._onDismissCallout,id:this._uniqueId,imageUrl:e.imageUrl}),t.isCalloutVisible&&s.createElement(r.Callout,{directionalHint:r.DirectionalHint.topCenter,onDismiss:this._onDismissCallout,target:"#"+this._uniqueId+" ",setInitialFocus:!0},s.createElement("div",{className:"od-LinkMember-tooltip"},s.createElement("span",null,e.primaryText))))};return t}(s.Component);t.LinkMember=o});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLink/LinkMember/LinkMember.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-LinkMember-Persona{width:32px}.od-LinkMember-tooltip{padding:8px}"}])});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLinkParticipants/ShareLinkParticipants",["require","exports","tslib","react","office-ui-fabric-react/lib/Persona","office-ui-fabric-react/lib/Button","../ShareLink/ConfirmationDialog/ConfirmationDialog","../../Share.resx","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._onCancel=function(){i.setState(function(){return n.__assign({},i.state,{showDetailsPanel:!1,showConfirmationDialog:!1,participants:i.state.participants,hasPeopleChange:!1})})};i._onConfirmationDeleteParticipant=function(){if(i.state.confirmationCode===o.ConfirmationCode.participant){i._onLinkParticipantDelete();i.setState({showConfirmationDialog:!1,confirmationCode:o.ConfirmationCode.none})}};i.state={participants:i.props.participants,showConfirmationDialog:!1,confirmationCode:o.ConfirmationCode.none,hasPeopleChange:!1};return i}t.prototype.render=function(){var e=this;return r.createElement("ul",{className:"od-ShareLink-participants",key:this.props.showDetailsPanel?"Panel-ul-"+this.props.link.shareId:this.props.link.shareId},this.props.participants.map(function(t){return r.createElement("li",{className:"od-ShareLink-personaItem",key:e.props.showDetailsPanel?"Panel-li-"+t.email:t.email},r.createElement(i.Persona,{imageUrl:t.image,primaryText:t.name,secondaryText:t.isExternal?u.default.externalUser:t.job,size:i.PersonaSize.size32,showSecondaryText:!(!t.job&&!t.isExternal)}),6===e.props.link.sharingLinkKind&&r.createElement(s.IconButton,{"data-is-focusable":!0,ariaLabel:a.format(u.default.removePersonLabel,t.name),className:"od-ShareLink-actionButton",iconProps:{iconName:"Cancel"},onClick:function(){return e.setState({showConfirmationDialog:!0,confirmationCode:o.ConfirmationCode.participant,participant:t})}}))}),this.state.showConfirmationDialog&&this._renderConfirmationDialog())};t.prototype._renderConfirmationDialog=function(){var e=this,t=this.state,n=t.confirmationCode,i=t.participants,s=t.participant;return r.createElement(o.ConfirmationDialog,{confirmationCode:n,participants:i,participant:s,onApply:this._onConfirmationDeleteParticipant,onCancel:this.state.confirmationCode===o.ConfirmationCode.back?this._onCancel:function(){e.setState({showConfirmationDialog:!1,confirmationCode:o.ConfirmationCode.none})}})};t.prototype._onLinkParticipantDelete=function(){var e=this.state.participant,t=[];if(this.props.showDetailsPanel){t=!0!==e.isExternal&&e.principalName?this.props.participants.filter(function(t){return t.principalName!==e.principalName}):this.props.participants.filter(function(t){return t.email!==e.email});this.setState(n.__assign({},this.state,{participants:t,hasPeopleChange:!0}));this.props.onRemoveParticipant(e,t)}else this.props.updateLinkSettings(e)};return t}(r.Component);t.ShareLinkParticipants=f});
define("office-ui-fabric-react/lib/Facepile",["require","exports","tslib","./components/Facepile/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("office-ui-fabric-react/lib/components/Facepile/index",["require","exports","tslib","./Facepile.types","./Facepile.base","./Facepile"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t)});
define("office-ui-fabric-react/lib/components/Facepile/Facepile.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.none=0]="none";e[e.descriptive=1]="descriptive";e[e.more=2]="more";e[e.downArrow=3]="downArrow"}(t.OverflowButtonType||(t.OverflowButtonType={}))});
define("office-ui-fabric-react/lib/components/Facepile/Facepile.base",["require","exports","tslib","react","../../Utilities","./Facepile.types","./FacepileButton","../../Icon","../../Persona","../../PersonaCoin"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=i.classNamesFunction(),c=function(e){n.__extends(t,e);function t(t){var s=e.call(this,t)||this;s._classNames=l(s.props.styles,{theme:s.props.theme,className:s.props.className});s._getPersonaControl=function(e){var t=s.props,i=t.getPersonaProps,o=t.personaSize;return r.createElement(a.Persona,n.__assign({imageInitials:e.imageInitials,imageUrl:e.imageUrl,initialsColor:e.initialsColor,allowPhoneInitials:e.allowPhoneInitials,text:e.personaName,size:o},i?i(e):null,{styles:{details:{flex:"1 0 auto"}}}))};s._getPersonaCoinControl=function(e){var t=s.props,i=t.getPersonaProps,o=t.personaSize;return r.createElement(f.PersonaCoin,n.__assign({imageInitials:e.imageInitials,imageUrl:e.imageUrl,initialsColor:e.initialsColor,allowPhoneInitials:e.allowPhoneInitials,text:e.personaName,size:o},i?i(e):null))};s._ariaDescriptionId=i.getId();return s}t.prototype.render=function(){var e=this.props.overflowButtonProps,t=this.props,n=t.chevronButtonProps,i=t.maxDisplayablePersonas,s=t.personas,o=t.overflowPersonas,u=t.showAddButton,a=this._classNames,f="number"==typeof i?Math.min(s.length,i):s.length;n&&!e&&(e=n);var l=o&&o.length>0,c=l?s:s.slice(0,f),h=(l?o:s.slice(f))||[];return r.createElement("div",{className:a.root},this.onRenderAriaDescription(),r.createElement("div",{className:a.itemContainer},u?this._getAddNewElement():null,r.createElement("ul",{className:a.members,role:"listbox"},this._onRenderVisiblePersonas(c,0===h.length&&1===s.length)),e?this._getOverflowElement(h):null))};t.prototype.onRenderAriaDescription=function(){var e=this.props.ariaDescription,t=this._classNames;return e&&r.createElement("span",{className:t.screenReaderOnly,id:this._ariaDescriptionId},e)};t.prototype._onRenderVisiblePersonas=function(e,t){var n=this,i=this.props,s=i.onRenderPersona,o=void 0===s?this._getPersonaControl:s,u=i.onRenderPersonaCoin,a=void 0===u?this._getPersonaCoinControl:u;return e.map(function(e,i){var s=t?o(e,n._getPersonaControl):a(e,n._getPersonaCoinControl);return r.createElement("li",{role:"option",key:(t?"persona":"personaCoin")+"-"+i,className:n._classNames.member},e.onClick?n._getElementWithOnClickEvent(s,e,i):n._getElementWithoutOnClickEvent(s,e,i))})};t.prototype._getElementWithOnClickEvent=function(e,t,s){var u=t.keytipProps;return r.createElement(o.FacepileButton,n.__assign({},i.getNativeProps(t,i.buttonProperties),this._getElementProps(t,s),{keytipProps:u,onClick:this._onPersonaClick.bind(this,t)}),e)};t.prototype._getElementWithoutOnClickEvent=function(e,t,s){return r.createElement("div",n.__assign({},i.getNativeProps(t,i.buttonProperties),this._getElementProps(t,s)),e)};t.prototype._getElementProps=function(e,t){var n=this._classNames;return{key:(e.imageUrl?"i":"")+t,"data-is-focusable":!0,role:"option",className:n.itemButton,title:e.personaName,onMouseMove:this._onPersonaMouseMove.bind(this,e),onMouseOut:this._onPersonaMouseOut.bind(this,e)}};t.prototype._getOverflowElement=function(e){switch(this.props.overflowButtonType){case s.OverflowButtonType.descriptive:return this._getDescriptiveOverflowElement(e);case s.OverflowButtonType.downArrow:return this._getIconElement("ChevronDown");case s.OverflowButtonType.more:return this._getIconElement("More");default:return null}};t.prototype._getDescriptiveOverflowElement=function(e){var t=this.props.personaSize;if(!e||e.length<1)return null;var i=e.map(function(e){return e.personaName}).join(", "),s=n.__assign({title:i},this.props.overflowButtonProps),u=Math.max(e.length,0),a=this._classNames;return r.createElement(o.FacepileButton,n.__assign({},s,{ariaDescription:s.title,className:a.descriptiveOverflowButton}),r.createElement(f.PersonaCoin,{size:t,onRenderInitials:this._renderInitialsNotPictured(u),initialsColor:f.PersonaInitialsColor.transparent}))};t.prototype._getIconElement=function(e){var t=this.props,i=t.overflowButtonProps,s=t.personaSize,u=this._classNames;return r.createElement(o.FacepileButton,n.__assign({},i,{className:u.overflowButton}),r.createElement(f.PersonaCoin,{size:s,onRenderInitials:this._renderInitials(e,!0),initialsColor:f.PersonaInitialsColor.transparent}))};t.prototype._getAddNewElement=function(){var e=this.props,t=e.addButtonProps,i=e.personaSize,s=this._classNames;return r.createElement(o.FacepileButton,n.__assign({},t,{className:s.addButton}),r.createElement(f.PersonaCoin,{size:i,onRenderInitials:this._renderInitials("AddFriend")}))};t.prototype._onPersonaClick=function(e,t){e.onClick(t,e);t.preventDefault();t.stopPropagation()};t.prototype._onPersonaMouseMove=function(e,t){e.onMouseMove&&e.onMouseMove(t,e)};t.prototype._onPersonaMouseOut=function(e,t){e.onMouseOut&&e.onMouseOut(t,e)};t.prototype._renderInitials=function(e,t){var n=this._classNames;return function(){return r.createElement(u.Icon,{iconName:e,className:t?n.overflowInitialsIcon:""})}};t.prototype._renderInitialsNotPictured=function(e){var t=this._classNames;return function(){return r.createElement("span",{className:t.overflowInitialsIcon},"+"+e)}};t.defaultProps={maxDisplayablePersonas:5,personas:[],overflowPersonas:[],personaSize:f.PersonaSize.size32};return t}(i.BaseComponent);t.FacepileBase=c});
define("office-ui-fabric-react/lib/components/Facepile/FacepileButton",["require","exports","tslib","react","../../Button","../../Utilities","./FacepileButton.styles"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._skipComponentRefResolution=!0;return t}t.prototype.render=function(){var e=this.props,t=e.className,u=e.styles,a=n.__rest(e,["className","styles"]),f=o.getStyles(this.props.theme,t,u);return r.createElement(i.BaseButton,n.__assign({},a,{variantClassName:"ms-Button--facepile",styles:f,onRenderDescription:s.nullRender}))};return t=n.__decorate([s.customizable("FacepileButton",["theme","styles"],!0)],t)}(s.BaseComponent);t.FacepileButton=u});
define("office-ui-fabric-react/lib/components/Facepile/FacepileButton.styles",["require","exports","tslib","../../Styling","../../Utilities","../Button/BaseButton.styles"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=i.memoizeFunction(function(e,t,i){var o=s.getStyles(e),u=r.concatStyleSets(o,i);return n.__assign({},u,{root:[o.root,t,e.fonts.medium,i&&i.root]})})});
define("office-ui-fabric-react/lib/PersonaCoin",["require","exports","tslib","./components/Persona/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("office-ui-fabric-react/lib/components/Facepile/Facepile",["require","exports","../../Utilities","./Facepile.base","./Facepile.styles"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Facepile=n.styled(r.FacepileBase,i.styles,void 0,{scope:"Facepile"})});
define("office-ui-fabric-react/lib/components/Facepile/Facepile.styles",["require","exports","../../Styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={root:"ms-Facepile",addButton:"ms-Facepile-addButton ms-Facepile-itemButton",descriptiveOverflowButton:"ms-Facepile-descriptiveOverflowButton ms-Facepile-itemButton",itemButton:"ms-Facepile-itemButton ms-Facepile-person",itemContainer:"ms-Facepile-itemContainer",members:"ms-Facepile-members",member:"ms-Facepile-member",overflowButton:"ms-Facepile-overflowButton ms-Facepile-itemButton"};t.styles=function(e){var t=e.className,i=e.theme,s=e.spacingAroundItemButton,o=void 0===s?2:s,u=i.palette,a=i.fonts,f=n.getGlobalClassNames(r,i),l={textAlign:"center",padding:0,borderRadius:"50%",verticalAlign:"top",display:"inline",backgroundColor:"transparent",cursor:"pointer",border:"none",selectors:{"&::-moz-focus-inner":{padding:0,border:0}}};return{root:[f.root,i.fonts.medium,{width:"auto"},t],addButton:[f.addButton,n.getFocusStyle(i,{inset:-1}),l,{fontSize:a.medium.fontSize,color:u.white,backgroundColor:u.themePrimary,marginRight:2*o+"px",selectors:{"&:hover":{backgroundColor:u.themeDark},"&:focus":{backgroundColor:u.themeDark},"&:active":{backgroundColor:u.themeDarker},"&:disabled":{backgroundColor:u.neutralTertiaryAlt}}}],descriptiveOverflowButton:[f.descriptiveOverflowButton,n.getFocusStyle(i,{inset:-1}),l,{fontSize:a.small.fontSize,color:u.neutralSecondary,backgroundColor:u.neutralLight,marginLeft:2*o+"px"}],itemButton:[f.itemButton,l],itemContainer:[f.itemContainer,{display:"flex"}],members:[f.members,{display:"flex",overflow:"hidden",listStyleType:"none",padding:0,margin:"-"+o+"px"}],member:[f.member,{display:"inline-flex",flex:"0 0 auto",margin:o+"px"}],overflowButton:[f.overflowButton,n.getFocusStyle(i,{inset:-1}),l,{fontSize:a.medium.fontSize,color:u.neutralSecondary,backgroundColor:u.neutralLight,marginLeft:2*o+"px"}],overflowInitialsIcon:[{color:u.neutralPrimary}],screenReaderOnly:n.hiddenContentStyle}}});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLinkDetails/ShareLinkDetails",["require","exports","tslib","react","prop-types","../../Share.resx","@ms/odsp-utilities/lib/string/StringHelper","../../../interfaces/SharingInterfaces","../ShareLinkParticipants/ShareLinkParticipants","../../PeoplePicker/PeoplePicker","../../../utilities/PeoplePickerHelper","office-ui-fabric-react/lib/Dropdown","office-ui-fabric-react/lib/Icon","../ShareLink/ConfirmationDialog/ConfirmationDialog","../../ModifyPermissions/ExpirationDatePicker/ExpirationDatePicker","../ShareLink/ChangePermission/ChangePermission","../../../utilities/ShareHelper","office-ui-fabric-react/lib/Button","../../ModifyPermissions/PreventDownload/PreventDownload","../../ModifyPermissions/PasswordField/PasswordField","../ShareLink/ShareLink","office-ui-fabric-react/lib/utilities/decorators/withResponsiveMode","../../../utilities/ReviewPermissionExperimentHelper","./ShareLinkDetails.scss","../../RoleSelector/RoleSelector.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._onPeoplePickerChange=function(e){var t=l.renderPickerError({selectedItems:i.state.participants,sharingLinkKind:i._link.sharingLinkKind,canAddExternalPrincipal:i.props.sharingInformation.canAddExternalPrincipal,sharingInformation:i.props.sharingInformation,viewPolicyTipCallback:i._store.getPolicyTipInformation,permissionsMap:i._store.getPermissionsMap()}),n=e[0],r=[];r=!0===n.isExternal?i.state.participants.filter(function(e){return e.email===n.email}):i.state.participants.filter(function(e){return e.userId===n.userId});i.setState({participants:0===r.length?i.state.participants.concat(e):i.state.participants,hasPeopleChange:0===r.length,peoplePickerError:t});i.props.onPeoplePickerChange(r,e)};i._onRemoveParticipant=function(e,t){i.setState({participants:t,participantRemovedText:o.format(s.default.removedPersonText,e.name)});i.props.updateLinkSettings(e)};i._onRoleChange=function(e){i.setState({hasSettingsChange:!0});i.props.onRoleChange(e)};i._onPasswordChange=function(e){i.setState(function(){return n.__assign({},i.state,{hasSettingsChange:e.length>0})});i.props.onPasswordChange(e)};i._onConfirmationSave=function(){i.props.updateLinkSettings(null);i.setState(n.__assign({},i.state,{showConfirmationDialog:!1,confirmationCode:p.ConfirmationCode.none,hasSettingsChange:!1,hasPeopleChange:!1}))};i._onCancel=function(){i.setState(n.__assign({},i.state,{showConfirmationDialog:!1,confirmationCode:p.ConfirmationCode.none}));i.props.onCancel()};i._onSave=function(){if(i.state.hasSettingsChange)i.setState(n.__assign({},i.state,{confirmationCode:p.ConfirmationCode.linkSettings,showConfirmationDialog:!0}));else if(i.state.hasPeopleChange){i.setState(n.__assign({},i.state,{hasPeopleChange:!1}));i.props.updateLinkSettings(null)}};i._onBack=function(){i.state.hasPeopleChange||i.state.hasSettingsChange?i.setState(n.__assign({},i.state,{showConfirmationDialog:!0,confirmationCode:p.ConfirmationCode.back})):i.props.onCancel()};i._onSelectDate=function(e){var t=i.props.sharingInformation.anonymousLinkExpirationRestrictionDays;i.setState(n.__assign({},i.state,{expirationErrorCode:m.getExpirationErrorCode(e,t)}),function(){i._updateExpirationErrorCode(m.getExpirationErrorCode(e,t))});i._onExpirationChange(e)};i._store=r.sharingStore;i._link=i.props.link;i.state={expirationErrorCode:m.ExpirationErrorCode.none,hasSettingsChange:i.props.hasSettingsChange||!1,hasPeopleChange:!1,showConfirmationDialog:!1,confirmationCode:p.ConfirmationCode.none,participants:i.props.participants,linkRemovedText:"",participantRemovedText:"",selectedPermissions:i.props.selectedPermissions,peoplePickerError:l.renderPickerError({selectedItems:n.__assign({},i.props.participants),sharingLinkKind:1,canAddExternalPrincipal:i.props.sharingInformation.canAddExternalPrincipal,sharingInformation:i.props.sharingInformation,viewPolicyTipCallback:i._store.getPolicyTipInformation})};return i}t.prototype.render=function(){return r.createElement("div",{className:"od-ShareLinkDetails--div"},this._renderDetailsPanelHeader(),this._renderDetailsPanelContent(),this._renderDetailsPanelActions())};t.prototype._renderDetailsPanelContent=function(){return r.createElement("div",{className:"od-ShareLinkDetails--content"},this._renderShareLink(),r.createElement("div",{className:"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":s.default.modifyPermissionsHeader},s.default.modifyPermissionsHeader),r.createElement("ul",{className:"od-ShareLinkDetails--changeSettings","aria-labelledby":s.default.modifyPermissionsHeader},this.props.link.isCreateOnlyLink?this._renderRequestFileEntry():this._renderChangePermission(),this._renderExpirationDatePicker(),this._renderPasswordField(),this._renderPreventDownloadToggle()),this.props.selectedPermissions.audience!==u.SharingAudience.specificPeopleFlex&&this.state.participants.length>0&&r.createElement("div",{className:"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":s.default.notFlexibleLinkPeoplePickerHeader},s.default.notFlexibleLinkPeoplePickerHeader),this.props.selectedPermissions.audience===u.SharingAudience.specificPeopleFlex&&r.createElement("div",{className:"od-ShareLinkDetails--sectionHeader","data-is-focusable":!0,"aria-label":s.default.flexibleLinkPeoplePickerHeader},s.default.flexibleLinkPeoplePickerHeader),this._renderPeoplePicker(),this._renderParticipantsList(),r.createElement("div",{className:"od-Share-screenReaderOnly","aria-live":"assertive",role:"alert","aria-label":this.state.participantRemovedText},this.state.participantRemovedText),this.state.showConfirmationDialog&&this._renderConfirmationDialog())};t.prototype._renderShareLink=function(){return r.createElement(w.ShareLink,{link:this._link,companyName:this.props.companyName,clientId:this.props.clientId,mode:this.props.mode,sharingInformation:this.props.sharingInformation,groupsMemberCount:this.props.groupsMemberCount,linkRecipients:this.props.linkRecipients,enableLinkSettings:this.props.enableLinkSettings,showMoreOptions:!1,showPermissionsList:this.props.showPermissionsList,onRemoveLink:this.props.onRemoveLink})};t.prototype._renderDetailsPanelHeader=function(){return r.createElement("div",{className:"od-ShareLinkDetails--header"},r.createElement(g.IconButton,{"data-is-focusable":!0,className:"od-ShareLink-actionButton",iconProps:{iconName:"Back"},onClick:this._onBack,ariaLabel:s.default.backButtonLabel}),r.createElement("span",null,s.default.manageExistingAccessLabel))};t.prototype._renderDetailsPanelActions=function(){var e=!(this.state.hasPeopleChange||this.state.hasSettingsChange)||this.state.expirationErrorCode!==m.ExpirationErrorCode.none;return r.createElement("div",{className:"od-ShareLinkDetails--actions"},r.createElement(g.DefaultButton,{primary:!0,onClick:this._onSave,disabled:e},s.default.saveButtonText),r.createElement(g.DefaultButton,{onClick:this.props.showPermissionsList,disabled:e},s.default.discardButtonText))};t.prototype._renderParticipantsList=function(){return this.state.participants.length>0?r.createElement(a.ShareLinkParticipants,{link:this._link,showDetailsPanel:!0,participants:this.state.participants,updateLinkSettings:this.props.updateLinkSettings,onRemoveParticipant:this._onRemoveParticipant}):this._link.audience===u.SharingAudience.specificPeopleFlex?r.createElement("div",{className:"od-ShareLinkDetails--noParticipants"},s.default.noLinkParticipantsPSL):void 0};t.prototype._renderPeoplePicker=function(){var e=this.props,t=this.state,n=l.getOversharingExternalsWarning(t.participants),i=l.getOversharingGroupsWarning(t.participants,this.props.groupsMemberCount);if(this.props.selectedPermissions.audience===u.SharingAudience.specificPeopleFlex)return r.createElement(f.default,{defaultSelectedItems:[],onChange:this._onPeoplePickerChange,oversharingExternalsWarning:n,oversharingGroupsWarning:i,pickerSettings:e.sharingInformation.peoplePickerSettings,error:t.peoplePickerError,sharingInformation:e.sharingInformation,sharingLinkKind:e.link.sharingLinkKind,clientId:this.props.clientId,inputTextPlaceholder:s.default.peoplePickerPlaceholderSpecific,onResolvedSuggestions:null})};t.prototype._renderChangePermission=function(){var e=this.props,t=e.selectedPermissions.audience,n=t==u.SharingAudience.organization||t==u.SharingAudience.anyone;return r.createElement("li",{className:"od-ShareLinkDetails--setting"},r.createElement("div",{className:"od-ShareLinkDetails--changePermissions"},r.createElement(v.ChangePermission,{selectedPermissions:e.getLinkSettings(),onRoleChange:this._onRoleChange,item:e.sharingInformation.item,canChangePermission:n,showReview:S.default.checkExperimentisOn()})))};t.prototype._renderRequestFileEntry=function(){var e=[{key:s.default.canUploadText,text:s.default.canUploadText,data:s.default.canUploadText,ariaLabel:s.default.canUploadText}];return r.createElement("li",{className:"od-ShareLinkDetails--setting"},r.createElement("div",{className:"od-ShareLinkDetails--changePermissions"},r.createElement("div",{className:"od-RoleSelector-wrapper"},r.createElement(h.Icon,{className:"od-RoleSelector-settingIcon",iconName:"Upload",title:s.default.canUploadText}),r.createElement(c.Dropdown,{className:"od-RoleSelector-rolesDropdown",disabled:!0,label:"",defaultSelectedKey:s.default.canUploadText,calloutProps:{className:"od-RoleSelector-rolesDropdownOptionsCallout"},responsiveMode:E.ResponsiveMode.large,ariaLabel:s.default.canUploadText,options:e}),this.props.children)))};t.prototype._renderExpirationDatePicker=function(){var e=this.state.selectedPermissions;if(e.audience===u.SharingAudience.anyone)return r.createElement("li",{className:"od-ShareLinkDetails--setting"},r.createElement("div",{className:"od-ShareLinkDetails--datePicker"},r.createElement(d.ExpirationDatePicker,{clientId:this.props.clientId,onSelectDate:this._onSelectDate,value:e.expiration,expiryRestriction:this.props.sharingInformation.anonymousLinkExpirationRestrictionDays})),r.createElement("span",{className:"od-ShareLinkDetails--expirationError",role:"alert","aria-live":"assertive"},this._renderExpirationDatePickerErrorMessage()))};t.prototype._renderExpirationDatePickerErrorMessage=function(){var e=this.state.expirationErrorCode;return m.getExpirationDatePickerErrorMessage(e,this.props.sharingInformation.anonymousLinkExpirationRestrictionDays)};t.prototype._renderPasswordField=function(){if(this.state.selectedPermissions.hasPassword){var e="",t=this._link.passwordLastModifiedBy;t&&(e=t.primaryText?t.primaryText:t.email?t.email:"");return r.createElement("li",{className:"od-ShareLinkDetails--setting"},r.createElement("div",{className:"od-ShareLink-detailsPanel-passwordFieldWrapper"},r.createElement("div",{className:"od-ShareLink-detailsPanel-passwordField"},r.createElement(b.PasswordField,{onPasswordChange:this._onPasswordChange,detailsPane:!0,lastModifiedBy:e}))))}};t.prototype._renderPreventDownloadToggle=function(){var e=this.state.selectedPermissions.preventDownload;if(e)return r.createElement("li",{className:"od-ShareLinkDetails--setting"},r.createElement("div",{className:"od-ShareLinkDetails--preventDownloadToggle"},r.createElement(y.PreventDownload,{isToggled:e,disablePreventDownload:!0,detailsPane:!0,clientId:this.props.clientId,mode:this.props.mode})))};t.prototype._renderConfirmationDialog=function(){var e=this,t=this.state,n=t.confirmationCode,i=t.participants,s=t.participant;return r.createElement(p.ConfirmationDialog,{confirmationCode:n,participants:i,participant:s,onApply:this._onConfirmationSave,onCancel:this.state.confirmationCode===p.ConfirmationCode.back?this._onCancel:function(){e.setState({showConfirmationDialog:!1,confirmationCode:p.ConfirmationCode.none})},onDiscard:this.props.showPermissionsList})};t.prototype._onExpirationChange=function(e){var t=this;this.setState(function(){return n.__assign({},t.state,{selectedPermissions:n.__assign({},t.state.selectedPermissions,{expiration:e}),hasSettingsChange:e!==t.state.selectedPermissions.expiration||t.state.hasSettingsChange})});this.props.onExpirationChange(e)};t.prototype._updateExpirationErrorCode=function(e){e!==this.state.expirationErrorCode&&this.setState(n.__assign({},this.state,{expirationErrorCode:e}))};t.contextTypes={sharingStore:i.object.isRequired};return t}(r.Component);t.ShareLinkDetails=x});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/ShareLinkDetails/ShareLinkDetails.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareLinkDetails--div{top:0;left:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";width:100%;height:100%;padding:0 20px;-webkit-box-sizing:border-box;box-sizing:border-box;position:absolute;overflow-y:auto}.od-ShareLinkDetails--div .od-ShareLinkDetails--header{height:40px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-negative:0;flex-shrink:0;font-size:14px;font-weight:400;margin:10px -20px 0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:relative}[dir=ltr] .od-ShareLinkDetails--div .od-ShareLinkDetails--header{padding-left:20px}[dir=rtl] .od-ShareLinkDetails--div .od-ShareLinkDetails--header{padding-right:20px}.od-ShareLinkDetails--div .od-ShareLinkDetails--changeSettings{padding:22px 0 12px;margin-bottom:50px}.od-ShareLinkDetails--div .od-ShareLinkDetails--footer{position:absolute;width:100%;right:0;bottom:0;left:0}.od-ShareLinkDetails--settingIcon{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:17px}[dir=ltr] .od-ShareLinkDetails--settingIcon{padding-left:8px}[dir=rtl] .od-ShareLinkDetails--settingIcon{padding-right:8px}[dir=ltr] .od-ShareLinkDetails--settingIcon{padding-right:12px}[dir=rtl] .od-ShareLinkDetails--settingIcon{padding-left:12px}.od-ShareLinkDetails--setting{margin-bottom:12px;display:block;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-title{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}[dir=ltr] .od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-title{padding-left:0}[dir=rtl] .od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-title{padding-right:0}.od-ShareLinkDetails--setting .ms-Dropdown.is-disabled .ms-Dropdown-caretDownWrapper{display:none}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--changePermissions .od-RoleSelector-settingIcon{padding-left:8px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--changePermissions .od-RoleSelector-settingIcon{padding-right:8px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker{width:100%}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-Content{display:-webkit-box;display:-ms-flexbox;display:flex}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-Content{margin-left:0}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker-Content{margin-right:0}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .ms-DatePicker{margin-left:0}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .ms-DatePicker{margin-right:0}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{font-size:17px}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{padding-left:8px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{padding-right:8px}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{padding-right:12px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{padding-left:12px}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{margin-right:0}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ExpirationDatePicker .od-ExpirationDatePicker-label{margin-left:0}.od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ShareLink-actionButton .ms-Button-icon{font-size:12px}.ms-Fabric .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ShareLink-actionButton .ms-Button-icon::-moz-focus-inner{border:0}.ms-Fabric .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ShareLink-actionButton .ms-Button-icon{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ShareLink-actionButton .ms-Button-icon:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-ShareLinkDetails--setting .od-ShareLinkDetails--datePicker .od-ShareLink-actionButton .ms-Button-icon:focus:after{border-color:ActiveBorder}}.od-ShareLinkDetails--setting .od-ShareLinkDetails--expirationError{font-size:12px;color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:";display:block}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--expirationError{margin-left:37px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--expirationError{margin-right:37px}.od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle{width:100%;margin:0}.od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PreventDownloadToggle .ms-Toggle-label{margin:0;cursor:default}.od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:17px}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-left:8px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-right:8px}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-right:12px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLinkDetails--preventDownloadToggle .od-PermissionsSettings-setting--PreventDownload-Icon{padding-left:12px}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordFieldWrapper{width:100%}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField{width:100%;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-shareLinkDetails--passwordFieldMainContent{display:-webkit-box;display:-ms-flexbox;display:flex}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-ShareLink-passwordFieldContent{margin:0}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-ShareLinkDetails--passwordTextField{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";cursor:pointer}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-ShareLinkDetails--passwordTextField:hover{border-bottom-color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .ms-TextField{width:100%;margin:0;padding:0;border-bottom:none}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .ms-TextField-field{width:100%;padding:0;border-bottom:none}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:17px}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-left:8px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-right:8px}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-right:12px}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{padding-left:12px}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{margin-right:0}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-label{margin-left:0}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .ms-Toggle-label{margin:0}.od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-delete{background-color:transparent;background:0 0;border:none;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";cursor:pointer;font-size:12px;line-height:0}[dir=ltr] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-delete{margin-left:auto}[dir=rtl] .od-ShareLinkDetails--setting .od-ShareLink-detailsPanel-passwordField .od-PasswordField-delete{margin-right:auto}.od-ShareLinkDetails--passwordCreatedByLabel{font-size:12px;font-style:italic;margin-top:-5px;padding:0}[dir=ltr] .od-ShareLinkDetails--passwordCreatedByLabel{margin-left:37px}[dir=rtl] .od-ShareLinkDetails--passwordCreatedByLabel{margin-right:37px}.od-ShareLinkDetails--sectionHeader{position:relative;padding:12px 20px;margin:10px -20px 0;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:";font-size:14px}.od-ShareLink--detailsPanel{top:50px}.od-ShareLink--detailsPanel .od-ShareLinkDetails--header{height:40px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-ms-flex-negative:0;flex-shrink:0;font-size:14px;font-weight:400}[dir=ltr] .od-ShareLink--detailsPanel .od-ShareLinkDetails--header{padding-left:20px}[dir=rtl] .od-ShareLink--detailsPanel .od-ShareLinkDetails--header{padding-right:20px}.od-ShareLink--detailsPanel .ms-Panel-content{padding:0}.od-ShareLink--detailsPanel .ms-Panel-content .od-ShareLinkDetails--content{max-height:100%;overflow-y:auto;overflow-x:hidden;padding:0 20px 0}.od-ShareLink--detailsPanel .ms-Panel-content .od-Share-PeoplePicker-wrapper{padding-top:20px}.od-ShareLinkDetails--actions{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-ms-flex-negative:0;flex-shrink:0;margin-top:auto;height:56px;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:";margin:10px -20px 0}[dir=ltr] .od-ShareLinkDetails--actions{padding-right:35px}[dir=rtl] .od-ShareLinkDetails--actions{padding-left:35px}.ms-Fabric .od-ShareLinkDetails--actions .ms-Button--default::-moz-focus-inner{border:0}.ms-Fabric .od-ShareLinkDetails--actions .ms-Button--default{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-ShareLinkDetails--actions .ms-Button--default:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-ShareLinkDetails--actions .ms-Button--default:focus:after{border-color:ActiveBorder}}[dir=ltr] .od-ShareLinkDetails--actions .ms-Button:not(:first-of-type){margin-left:10px}[dir=rtl] .od-ShareLinkDetails--actions .ms-Button:not(:first-of-type){margin-right:10px}.od-ShareLinkDetails--noParticipants{font-size:12px;padding-top:20px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";min-height:50px}"}])});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/SharePrincipal/SharePrincipal",["require","exports","tslib","office-ui-fabric-react/lib/ContextualMenu","office-ui-fabric-react/lib/Callout","office-ui-fabric-react/lib/Persona","react","prop-types","office-ui-fabric-react/lib/Icon","../../../utilities/ClientIdHelper","../../Share.resx","../../../utilities/ShareHelper","../../../utilities/ReviewPermissionExperimentHelper","./SharePrincipal.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r.state={showContextualMenu:!1,isUpdatingRole:!1,roleText:r._computeInitialRoleText(t.principal)};r._store=n.sharingStore;r._onChangeRoleClick=r._onChangeRoleClick.bind(r);r._onPermissionsClick=r._onPermissionsClick.bind(r);return r}t.prototype.componentDidMount=function(){this._focusElement&&this.props.takeFocus&&!f.isMobile(this.props.clientId)&&this._focusElement.focus()};t.prototype.componentDidUpdate=function(){var e=this._computeInitialRoleText(this.props.principal);e!==this.state.previousRoleText&&this.setState({isUpdatingRole:!1,roleText:e,previousRoleText:this.state.roleText})};t.prototype.render=function(){var e=this,t=this.props.principal;return o.createElement("div",{className:"od-SharePrincipal",role:"presentation",ref:function(t){e._focusElement=t}},o.createElement(s.Persona,{className:"od-SharePrincipal-persona",hidePersonaDetails:!0,initialsColor:s.PersonaInitialsColor.blue,primaryText:t.primaryText,size:s.PersonaSize.regular,imageUrl:t.imageUrl}),o.createElement("div",{className:"od-SharePrincipal-details",role:"presentation"},o.createElement("div",{className:"od-SharePrincipal-details-primaryText"},t.primaryText),this._renderChangePermissionsButton(t)))};t.prototype._computeInitialRoleText=function(e){var t=l.default,n=this.props.principal.role;if("number"!=typeof n)return e.sharingLinkKind?t.accessViaSharingLink:"";switch(n){case 2:return t.canEditLabel;case 6:return l.default.canReviewRole;case 1:return t.canViewLabel;case 3:return t.ownerLabel;default:return""}};t.prototype._computeRoleText=function(){return this.state.isUpdatingRole?l.default.updatingPermissions:this.state.roleText};t.prototype._renderChangePermissionsButton=function(e){var t=e.role;return this.state.isUpdatingRole||3!==this.props.userRole||2!==t&&1!==t&&6!==t?o.createElement("div",{className:"od-SharePrincipal-permissions-role"},this._computeRoleText()):o.createElement("button",{className:"od-SharePrincipal-permissions",onClick:this._onPermissionsClick,"data-is-focusable":!0,"aria-describedby":"changePermissionsDescription"+e.id},o.createElement("div",{className:"od-SharePrincipal-permissions-role"},this._computeRoleText()),this._renderChevron(e.role),this._renderContextualMenu(e.role),o.createElement("div",{role:"tooltip","aria-hidden":"true",className:"od-Share-screenReaderOnly",id:"changePermissionsDescription"+e.id},"Set permissions for "+e.primaryText))};t.prototype._renderChevron=function(e){if(2===e||1===e||6===e)return o.createElement("div",{className:"od-SharePrincipal-permissions-icon"},o.createElement(a.Icon,{iconName:"ChevronDown"}))};t.prototype._renderContextualMenu=function(e){var t,n,s,u,a=this,f=this.props,p=l.default,d=h.default.checkExperimentisOn();switch(e){case 1:t=2;n=l.default.allowEdit;s=6;u=l.default.ReviewOnly;break;case 6:t=2;n=l.default.allowEdit;s=1;u=l.default.changeToViewOnly;break;case 2:t=1;n=l.default.changeToViewOnly;s=6;u=l.default.ReviewOnly}return this.state.showContextualMenu&&d&&c.isNonOfficeFileCommentsAvailable(f.item)?o.createElement(r.ContextualMenu,{items:[{key:"editable1",name:n,onClick:this._onChangeRoleClick.bind(this,t)},{key:"editable2",name:u,onClick:this._onChangeRoleClick.bind(this,s)},{key:"stopSharing",name:""+p.stopSharing,onClick:this._onStopSharingClick.bind(this)}],onDismiss:function(){a.setState({showContextualMenu:!1})},directionalHint:i.DirectionalHint.bottomLeftEdge,isBeakVisible:!0,target:this.state.target}):this.state.showContextualMenu?o.createElement(r.ContextualMenu,{items:[{key:"editable1",name:n,onClick:this._onChangeRoleClick.bind(this,t)},{key:"stopSharing",name:""+p.stopSharing,onClick:this._onStopSharingClick.bind(this)}],onDismiss:function(){a.setState({showContextualMenu:!1})},directionalHint:i.DirectionalHint.bottomLeftEdge,isBeakVisible:!0,target:this.state.target}):void 0};t.prototype._onChangeRoleClick=function(e){this.setState({isUpdatingRole:!0,previousRoleText:this.state.roleText});this._store.updatePermissions(this.props.principal,e)};t.prototype._onStopSharingClick=function(e){this.setState({isUpdatingRole:!0});this._store.updatePermissions(this.props.principal,0)};t.prototype._onPermissionsClick=function(e){var t=this.props.principal.role;(2===t||1===t||6===t)&&this.setState({showContextualMenu:!0,target:e.nativeEvent.target})};t.contextTypes={sharingStore:u.object.isRequired};return t}(o.Component);t.SharePrincipal=p});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/SharePrincipal/SharePrincipal.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SharePrincipal{padding:8px 0;display:-webkit-box;display:-ms-flexbox;display:flex;outline:0}.od-SharePrincipal-persona{display:inline-block;width:52px;height:52px}[dir=ltr] .od-SharePrincipal-persona{margin-right:8px}[dir=rtl] .od-SharePrincipal-persona{margin-left:8px}.od-SharePrincipal-persona .ms-Persona{height:50px}.od-SharePrincipal-persona .ms-Persona-imageArea{width:50px;height:50px;max-width:50px}.od-SharePrincipal-persona .ms-Persona-initials{line-height:50px;height:50px}.od-SharePrincipal-details{display:inline-block;vertical-align:top;width:200px}.od-SharePrincipal-details-primaryText{font-size:17px;font-weight:300;font-weight:400;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.od-SharePrincipal-permissions{cursor:pointer;background:0 0;border:none;padding:0}.ms-Fabric .od-SharePrincipal-permissions::-moz-focus-inner{border:0}.ms-Fabric .od-SharePrincipal-permissions{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-SharePrincipal-permissions:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-SharePrincipal-permissions:focus:after{border-color:ActiveBorder}}.od-SharePrincipal-details-secondaryText,.od-SharePrincipal-permissions-role{font-size:12px;font-weight:400;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SharePrincipal-permissions-role{display:inline-block}.od-SharePrincipal-permissions-icon{display:inline-block;font-size:12px;margin-top:2px;color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}[dir=ltr] .od-SharePrincipal-permissions-icon{margin-left:4px}[dir=rtl] .od-SharePrincipal-permissions-icon{margin-right:4px}.od-SharePrincipal-deleteIcon{position:absolute;top:12px;cursor:pointer;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .od-SharePrincipal-deleteIcon{right:8px}[dir=rtl] .od-SharePrincipal-deleteIcon{left:8px}"}])});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/SharePrincipal/SharePrincipal2",["require","exports","tslib","office-ui-fabric-react/lib/ContextualMenu","office-ui-fabric-react/lib/Callout","office-ui-fabric-react/lib/Persona","react","react","prop-types","office-ui-fabric-react/lib/Icon","../../Share.resx","../../../utilities/ShareHelper","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Tooltip","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/Utilities","../ShareLink/ConfirmationDialog/ConfirmationDialog","office-ui-fabric-react/lib/FocusZone","../../../utilities/ShareHelper","../../../utilities/ReviewPermissionExperimentHelper","./SharePrincipal2.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._menuElement=u.createRef();r._showMenu=function(){var e=r.state.showMenu;r.setState({showMenu:!e})};r._hideMenu=function(){r.setState({showMenu:!1})};r._stopSharingConfirmation=function(){r.setState({showConfirmationDialog:!0})};r._onCancel=function(){r.setState({showConfirmationDialog:!1})};r.state={showMenu:!1,showConfirmationDialog:!1};r._store=n.sharingStore;r._onChangeRoleClick=r._onChangeRoleClick.bind(r);return r}t.prototype.render=function(){var e=this.props.principal,t=3===e.role,n=this._computeRoleText(e);return o.createElement("div",{className:"od-ShareLink-personaItem od-SharePrincipal2","data-is-focusable":!0,"aria-label":e.primaryText+" "+n,tabIndex:-1},o.createElement(g.FocusZone,{direction:g.FocusZoneDirection.horizontal},o.createElement(s.Persona,{className:"od-SharePrincipal-persona2",size:s.PersonaSize.size32,primaryText:e.primaryText,secondaryText:e.isExternal?l.default.externalUser:e.secondaryText,showSecondaryText:!(!e.isExternal&&!e.secondaryText),imageUrl:e.imageUrl}),o.createElement("div",{className:"od-SharePrincipal-permissions"},t?o.createElement("span",{className:"od-SharePrincipal-ownerLabel","data-is-focusable":!0},l.default.ownerLabel):this._renderChangePermissions(e))),this.state.showConfirmationDialog&&this._renderConfirmationDialog())};t.prototype._renderChangePermissions=function(e){var t=e.role;return 3!==this.props.userRole||2!==t&&1!==t&&6!==t?o.createElement("div",{className:"od-SharePrincipal-permissionsRole"},this._renderRoleIcon(e)):o.createElement("div",{className:"od-SharePrincipal-changePermissions"},this._renderRoleIcon(e),this._renderChangePermissionDropdown())};t.prototype._renderRoleIcon=function(e){var t=c.getRoleIconNameAndTitle(e.role),n=this._computeRoleText(e);return o.createElement(p.TooltipHost,{id:e.id.toString(),content:n,calloutProps:{gapSpace:0}},o.createElement(f.Icon,{className:"od-SharePrincipal-roleIcon",iconName:t.name,"aria-describedby":"od-SharePrincipal-tooltip"}))};t.prototype._renderChangePermissionDropdown=function(){var e=v.getRTL();return o.createElement("div",{ref:this._menuElement},o.createElement(h.IconButton,{className:"od-SharePrincipal-changePermissionsChevron",onClick:this._showMenu,iconProps:{iconName:"ChevronDown"},ariaLabel:d.format(l.default.permissionsLabelFor,this.props.principal.primaryText)}),this.state.showMenu&&o.createElement(r.ContextualMenu,{target:this._menuElement.current,items:this._getContextualMenuItems(),directionalHint:e?i.DirectionalHint.bottomLeftEdge:i.DirectionalHint.bottomRightEdge,onDismiss:this._hideMenu,className:"ms-SharePrincipal_contextMenu"}))};t.prototype._onChangeRoleClick=function(e){e!==this.props.principal.role&&this._store.updatePermissions(this.props.principal,e)};t.prototype._renderConfirmationDialog=function(){var e=this.props.principal,t={id:e.id,name:e.primaryText,image:e.imageUrl,isResolved:!0,principalName:e.loginName,userId:e.loginName,email:e.email,job:e.secondaryText,isExternal:e.isExternal,loginName:e.loginName,principalType:e.type};return o.createElement(m.ConfirmationDialog,{confirmationCode:m.ConfirmationCode.participant,participant:t,onApply:this._onStopSharingClick.bind(this),onCancel:this._onCancel})};t.prototype._onStopSharingClick=function(e){this._store.updatePermissions(this.props.principal,0)};t.prototype._getContextualMenuItems=function(){var e,t,n,r,i,s=this.props,o=s.principal.role,u=b.default.checkExperimentisOn();switch(o){case 1:i=l.default.canViewLabel;e=2;t=l.default.canEditLabel;n=6;r=l.default.canReviewRole;break;case 6:i=l.default.canReviewRole;e=2;t=l.default.canEditLabel;n=1;r=l.default.canViewLabel;break;case 2:i=l.default.canEditLabel;e=1;t=l.default.canViewLabel;n=6;r=l.default.canReviewRole}return u&&y.isNonOfficeFileCommentsAvailable(s.item)?[{key:"editable1",name:i,onClick:this._onChangeRoleClick.bind(this,o),checked:!0,iconProps:{iconName:"CheckMark"}},{key:"editable2",name:t,onClick:this._onChangeRoleClick.bind(this,e)},{key:"editable3",name:r,onClick:this._onChangeRoleClick.bind(this,n)},{key:"stopSharing",name:""+l.default.stopSharing,onClick:this._stopSharingConfirmation}]:[{key:"editable1",name:i,onClick:this._onChangeRoleClick.bind(this,o),checked:!0,iconProps:{iconName:"CheckMark"}},{key:"editable2",name:t,onClick:this._onChangeRoleClick.bind(this,e)},{key:"stopSharing",name:""+l.default.stopSharing,onClick:this._stopSharingConfirmation}]};t.prototype._computeRoleText=function(e){var t=l.default,n=e.role;if("number"!=typeof n)return e.sharingLinkKind?t.accessViaSharingLink:"";switch(n){case 2:return t.canEditLabel;case 6:return l.default.canReviewRole;case 1:return t.canViewLabel;case 3:return t.ownerLabel;default:return""}};t.contextTypes={sharingStore:a.object.isRequired};return t}(o.Component);t.SharePrincipal2=w});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/SharePrincipal/SharePrincipal2.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SharePrincipal2{padding:18px 20px;margin:0 -20px;border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-ShareLink-personaItem.od-SharePrincipal2 .ms-FocusZone{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-ShareLink-personaItem.od-SharePrincipal2 .ms-Persona-secondaryText{color:#605e5c}[dir=ltr] .od-SharePrincipal-permissions .od-SharePrincipal-ownerLabel{padding-right:8px}[dir=rtl] .od-SharePrincipal-permissions .od-SharePrincipal-ownerLabel{padding-left:8px}.od-SharePrincipal-permissions .od-SharePrincipal-changePermissions{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}[dir=ltr] .od-SharePrincipal-permissions .od-SharePrincipal-permissionsRole{padding-right:40px}[dir=rtl] .od-SharePrincipal-permissions .od-SharePrincipal-permissionsRole{padding-left:40px}.od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}[dir=ltr] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-left:4px}[dir=rtl] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-right:4px}[dir=ltr] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-right:4px}[dir=rtl] .od-SharePrincipal-permissions .od-SharePrincipal-changePermissionsChevron{margin-left:4px}.ms-SharePrincipal_contextMenu .ms-ContextualMenu-icon{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}"}])});
define("@ms/odsp-shared-sharing/lib/components/PermissionsList/PermissionsList.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-PermissionsList-content{padding:0 20px;margin-top:5px}.od-PermissionsList-emptyLinks{padding-top:20px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:12px;min-height:36px}.od-PermissionsList-header{position:relative}.od-PermissionsList-inheritance{margin:16px}[dir=ltr] .od-PermissionsList-inheritance .ms-MessageBar-icon{margin-left:8px}[dir=rtl] .od-PermissionsList-inheritance .ms-MessageBar-icon{margin-right:8px}[dir=ltr] .od-PermissionsList-inheritance .ms-MessageBar-text{margin-right:8px}[dir=rtl] .od-PermissionsList-inheritance .ms-MessageBar-text{margin-left:8px}.od-PermissionsList-linksListHolder .od-ShareLinkDetails--sectionHeader{margin-top:0}.od-PermissionsList-backButton{position:absolute}.od-ShareLinkDetails--sectionHeader .ms-Icon{padding:0 5px}.od-ShareLinkDetails--sectionHeader .ms-Icon--Add,.od-ShareLinkDetails--sectionHeader .ms-Icon--Info,.od-ShareLinkDetails--sectionHeader .ms-Icon--Share{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:12px}.od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-grantAccess,.od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share{margin:-5px 0}[dir=ltr] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-grantAccess,[dir=ltr] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share{float:right}[dir=rtl] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-grantAccess,[dir=rtl] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share{float:left}[dir=ltr] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share{padding-right:15px}[dir=rtl] .od-ShareLinkDetails--sectionHeader .od-ShareLinkDetails--sectionHeader-share{padding-left:15px}.od-PermissionsList-entities{padding-bottom:5px}.od-PermissionsList-entities div:last-of-type{border:none}.od-PermissionsList-links>div:last-of-type ul.od-ShareLink-participants:last-of-type::after{height:0}.ms-Fabric .od-PermissionsList-principalGroup::-moz-focus-inner{border:0}.ms-Fabric .od-PermissionsList-principalGroup{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-PermissionsList-principalGroup:focus:after{content:'';position:absolute;top:-2px;right:-2px;bottom:-2px;left:-2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-PermissionsList-principalGroup:focus:after{border-color:ActiveBorder}}"}])});
define("@ms/odsp-shared-sharing/lib/components/ShareMain/ShareMain",["require","exports","tslib","../Header/Header","../../interfaces/SharingInterfaces","../SendLink/SendLink","./ShareTargets/ShareTargets","../ShareHint/ShareHint","react","react","prop-types","../Share.resx","../../utilities/AttachAsCopyHelper","../../utilities/ClientIdHelper","../ActivityIndicator/ActivityIndicator","../../utilities/PeoplePickerHelper","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Button","../../utilities/ShareCommunicationManager","../../utilities/ShareHelper","./ShareMain.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._headerControl=f.createRef();r._onSelectedPeopleChange=function(e){var t=r.props,n=v.renderPickerError({selectedItems:e,sharingLinkKind:t.currentSettings.sharingLinkKind,canAddExternalPrincipal:t.sharingInformation.canAddExternalPrincipal,sharingInformation:t.sharingInformation,viewPolicyTipCallback:t.onViewPolicyTipClicked,permissionsMap:t.permissionsMap});if(n){for(var i=t.currentSettings.sharingLinkKind,s=3===i||2===i,o=!1,u=0,a=e;u<a.length;u++){if(a[u].isExternal&&s){o=!0;break}}o&&r.context.sharingStore.getEngagementHelper().externalSharingCslError(t.engagementExtraData)}r.setState({peoplePickerErrorMessage:n},function(){t.onSelectedPeopleChange(e)})};r._onShareTargetClicked=function(e){!r._isPeoplePickerValid(e)&&(r.props.currentSettings.audience===i.SharingAudience.specificPeopleFlex||r.props.currentSettings.audience===i.SharingAudience.specificPeople||r.props.linkRecipients.length>0)||r.setState({showActivityIndicator:!0,shareType:e},function(){r.props.onShareTargetClicked(e)})};r._onSendLinkClicked=function(e,t){r._isPeoplePickerValid(i.ShareType.share)&&r.setState({showActivityIndicator:!0,shareType:i.ShareType.share},function(){r.props.onSendLinkClicked(e,t)})};r._onAttachAsCopyClicked=function(){var e=r.props.clientId;r.context.sharingStore.getEngagementHelper().sendACopyClicked(r.props.engagementExtraData);if(p.isOfficeProduct(e)){var t=!r.state.isAttachAsCopyContextualMenuVisible;r.setState({isAttachAsCopyContextualMenuVisible:t},function(){})}else if(e===i.ClientId.ngsc||p.isMobile(e))try{window.external.SendCopy()}catch(e){}};r._shareClickTime=n.shareClickTime;r.state={isAttachAsCopyContextualMenuVisible:!1,shareType:i.ShareType.share,showActivityIndicator:!1,peoplePickerErrorMessage:null};return r}t.prototype.componentDidMount=function(){y.pageFinishedLoading(this._shareClickTime,this.props.clientId,i.Mode.share,this.props.scenarioId);this._updatePeoplePickerError(this.props);p.isMobile(this.props.clientId)&&this._headerControl.current&&this._headerControl.current.focusCloseButton()};t.prototype.UNSAFE_componentWillReceiveProps=function(e){this._updatePeoplePickerError(e)};t.prototype.render=function(){var e=this.state.showActivityIndicator?" blocker":"",t=this.props,i=this.state.showActivityIndicator?this._getActivityMessage():"",s=this.props.hideShareDialogOverflowButton||!1,o=this._renderFooter(),f=o?{className:"od-ShareMain-section-body"}:null;return a.createElement("div",{className:"od-ShareMain"+e},a.createElement(r.Header,{ctaLabel:c.default.sendButtonLabel,clientId:t.clientId,currentSettings:t.currentSettings,errorMessage:this.state.peoplePickerErrorMessage,item:t.item,linkRecipients:t.linkRecipients,permissionsMap:t.permissionsMap,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,onSendLinkClick:this._onSendLinkClicked,messageText:this.props.messageText,subjectText:this.props.subjectText,viewState:0,sharingInformation:t.sharingInformation,hideShareDialogOverflowButton:s,maximumMessageLength:500,maximumSubjectLength:100,ref:this._headerControl,closeButtonOnBlur:this.props.closeButtonOnBlur,closeButtonOnFocus:this.props.closeButtonOnFocus}),a.createElement("div",n.__assign({},f),a.createElement("div",{className:"od-ShareMain-section full-bleed"},a.createElement(u.ShareHint,{clientId:t.clientId,companyName:t.companyName,currentSettings:t.currentSettings,onShareHintClick:t.onShareHintClicked,sharingInformation:t.sharingInformation,linkRecipients:null,customLabeledAudienceConfig:t.customLabeledAudienceConfig})),this._renderSendLink(),this._renderTargets()),o,this._renderActivityIndicator(),a.createElement("span",{role:"alert",className:"od-Share-screenReaderOnly"},i))};t.prototype._renderTargets=function(){return a.createElement("div",{className:"od-ShareMain-targets"},a.createElement(o.ShareTargets,{clientId:this.props.clientId,currentSettings:this.props.currentSettings,onShareTargetClicked:this._onShareTargetClicked,onShareTargetsRendered:this.props.onShareTargetsRendered,outlookAvailability:this.props.outlookAvailability,sharingInformation:this.props.sharingInformation}))};t.prototype._renderFooter=function(){var e=this.props,t=e.clientId;if(p.isOfficeProduct(t)){var n=h.default.getAttachAsCopyOptions(t,e.item,this.context.sharingStore,this.props.engagementExtraData);if(1===n.length&&"pdf"!==n[0].key)return a.createElement("div",null,a.createElement("button",{className:"od-ShareMain-footer",onClick:n[0].onClick},a.createElement("div",{"aria-hidden":!0,role:"presentation",className:"od-ShareMain-attachIcon"},a.createElement(m.Icon,{iconName:"Copy"})),a.createElement("span",null,c.default.attachACopyInstead)));if(n.length>0)return a.createElement("div",null,a.createElement(g.DefaultButton,{className:"od-ShareMain-footer",text:c.default.attachACopyInstead,iconProps:{iconName:"Copy"},menuProps:{shouldFocusOnMount:!0,items:n}}))}else if((t===i.ClientId.ngsc||p.isMobile(t))&&this._isSendCopyEnabled())return a.createElement("div",null,a.createElement("button",{className:"od-ShareMain-footer",onClick:this._onAttachAsCopyClicked},a.createElement("div",{className:"od-ShareMain-attachIcon"},a.createElement(m.Icon,{iconName:"Copy"})),a.createElement("span",null,c.default.attachACopyInstead)))};t.prototype._renderSendLink=function(){if(!this.props.sharingInformation.blockPeoplePickerAndSharing||b.isLoadingData(this.props.sharingInformation)){var e=this.props;return a.createElement("div",{className:"od-ShareMain-section"},a.createElement(s.SendLink,{ctaLabel:c.default.sendButtonLabel,showTextArea:!0,sharingInformation:e.sharingInformation,onSendLinkClicked:this._onSendLinkClicked,currentSettings:e.currentSettings,onSelectedPeopleChange:this._onSelectedPeopleChange,groupsMemberCount:e.groupsMemberCount,onViewPolicyTipClicked:e.onViewPolicyTipClicked,linkRecipients:e.linkRecipients,permissionsMap:e.permissionsMap,messageText:e.messageText,subjectText:e.subjectText,onSendLinkMessageChange:e.onSendLinkMessageChange,onSendLinkSubjectChange:e.onSendLinkSubjectChange,createPeopleSharingLinks:e.createPeopleSharingLinks,errorMessage:this.state.peoplePickerErrorMessage,clientId:e.clientId,showSendButton:!0,maximumMessageLength:500,maximumSubjectLength:100,isLoadingDefaultRecipients:e.isLoadingDefaultRecipients,onManageExistingAccessClick:this.props.onShowPermissionsListClicked,engagementExtraData:this.props.engagementExtraData,onShareHintClicked:this.props.onShareHintClicked,onEditChange:this.props.onEditChange}))}};t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return a.createElement(d.ActivityIndicator,{message:this._getActivityMessage()})};t.prototype._getActivityMessage=function(){var e=c.default;switch(this.state.shareType){case i.ShareType.share:return e.activityMessageSendingMail;case i.ShareType.copy:case i.ShareType.outlook:case i.ShareType.nonOutlook:case i.ShareType.teams:case i.ShareType.moreApps:default:return e.activityMessageCreatingLink}};t.prototype._isSendCopyEnabled=function(){try{return window.external.IsSendCopyEnabled()}catch(e){return!1}};t.prototype._isPeoplePickerValid=function(e){if(!this.state.peoplePickerErrorMessage){if(e!==i.ShareType.share&&!this.props.createPeopleSharingLinks&&this.props.currentSettings.audience===i.SharingAudience.specificPeople){for(var t=!1,n=!1,r=0,s=this.props.linkRecipients;r<s.length;r++){var o=s[r];t||(t=o.isExternal&&!o.providerName);n||(n=!o.isExternal||o.isExternal&&!!o.providerName)}if(t&&n){this.setState({peoplePickerErrorMessage:a.createElement("span",null,c.default.mixedRecipientErrorMessage)});return!1}}var u=document.querySelector(".od-Share-PeoplePicker .ms-BasePicker-input"),f=this.props.currentSettings.audience===i.SharingAudience.specificPeopleFlex||this.props.currentSettings.audience===i.SharingAudience.specificPeople||e===i.ShareType.share;if(u.value){this.setState({peoplePickerErrorMessage:a.createElement("span",null,c.default.unresolvedTextError)});return!1}if(0===this.props.linkRecipients.length&&f){this.setState({peoplePickerErrorMessage:a.createElement("span",null,c.default.recipientsRequiredError)});return!1}return!0}};t.prototype._updatePeoplePickerError=function(e){if(e.linkRecipients){var t=v.renderPickerError({selectedItems:e.linkRecipients,sharingLinkKind:e.currentSettings.sharingLinkKind,canAddExternalPrincipal:e.sharingInformation.canAddExternalPrincipal,sharingInformation:e.sharingInformation,viewPolicyTipCallback:e.onViewPolicyTipClicked,permissionsMap:e.permissionsMap});this.setState({peoplePickerErrorMessage:t,showActivityIndicator:!t&&this.state.showActivityIndicator})}};t.prototype.shouldShowActivityIndicator=function(e){this.setState({showActivityIndicator:e})};t.contextTypes={shareClickTime:l.number,sharingStore:l.object.isRequired};return t}(a.Component);t.ShareMain=w});
define("@ms/odsp-shared-sharing/lib/components/SendLink/SendLink",["require","exports","tslib","office-ui-fabric-react/lib/TextField","../../utilities/PeoplePickerHelper","react","prop-types","../PeoplePicker/PeoplePicker","../SendButton/SendButton","../SendButton/SendButtonType","../Share.resx","../../utilities/ShareHelper","office-ui-fabric-react/lib/Spinner","@ms/odsp-utilities/lib/logging/ABExperiment","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-utilities/lib/features/FeatureOverrides","../../utilities/ClientIdHelper","../RoleSelectorCompact/RoleSelectorCompact","./SendLink.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y={ODB:1175},b={ODB:-1175},w={ODB:1637},E={ODB:1193},S=function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._validateMessage=function(e){i.props.onSendLinkMessageChange(e);var t=c.getEncodedMessageLength(e);i.setState(n.__assign({},i.state,{messageLength:t}));return""};i._validateSubject=function(e){i.props.onSendLinkSubjectChange(e);var t=c.getEncodedMessageLength(e);i.setState(n.__assign({},i.state,{subjectLength:t}));return e.length<=i.props.maximumSubjectLength?"":e.length+"/"+i.props.maximumSubjectLength};i._onResolvedSuggestions=function(e){i.context.sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestions(i.props.engagementExtraData,e);return e};i._platformDetection=r.platformDetection;i.state={messageLength:0,subjectLength:0};i._onManageExistingAccessClick=i._onManageExistingAccessClick.bind(i);i._isOnExperiment=!1;i._isSubjectExperimentOn=!1;i._isRoleSelectorCompactExperimentOn=!1;if(v.default.isFeatureEnabled(y)&&!i._platformDetection.isIOS&&(!m.isOfficeProduct(i.props.clientId)||!i._platformDetection.isMac)&&!d.Killswitch.isActivated("08cded93-1718-48b0-9b7e-bfdcf6384ef3","7/17/2018","AddMessageBorder")){var s=new p.ABExperiment({name:"AddMessageBorder",startDate:"07/17/2018",version:p.ABExpHash.v2});i._isOnExperiment=s.IsExperimentOn()}if(v.default.isFeatureEnabled(E)){var o=new p.ABExperiment({name:"AddSubjectLine",startDate:"08/14/2018",version:p.ABExpHash.v2});i._isSubjectExperimentOn=o.IsExperimentOn()}if(v.default.isFeatureEnabled(w)){var u=new p.ABExperiment({name:"RoleSelectorCompact",startDate:"07/29/2019",version:p.ABExpHash.v2});i._isRoleSelectorCompactExperimentOn=u.IsExperimentOn()}return i}t.prototype.UNSAFE_componentWillReceiveProps=function(e){i.renderPickerError({selectedItems:e.linkRecipients,sharingLinkKind:e.currentSettings.sharingLinkKind,canAddExternalPrincipal:e.sharingInformation.canAddExternalPrincipal,sharingInformation:e.sharingInformation,viewPolicyTipCallback:e.onViewPolicyTipClicked,permissionsMap:e.permissionsMap});this.setState(n.__assign({},this.state))};t.prototype.render=function(){var e=this._isOnExperiment||v.default.isFeatureEnabled(b),t=this.props,n=t.currentSettings,r=t.linkRecipients,o=i.getOversharingExternalsWarning(r),c=i.getOversharingGroupsWarning(r,t.groupsMemberCount),p=this._platformDetection.isIOS||m.isIos(this.props.clientId)?"od-SendLink-emailButtons-rounded":this._platformDetection.isAndroid||m.isAndroid(this.props.clientId)?"od-SendLink-emailButtons-allCaps":"od-SendLink-emailButtons-left",d=e?"od-SendLink-message-border":"od-SendLink-message-no-border",y=this.props.showSendButton?s.createElement("div",{className:p},s.createElement(a.default,{ctaLabel:this.props.ctaLabel,currentSettings:this.props.currentSettings,errorMessage:this.props.errorMessage,linkRecipients:this.props.linkRecipients,maximumMessageLength:this.props.maximumMessageLength,maximumSubjectLength:this.props.maximumSubjectLength,messageText:this.props.messageText,subjectText:this.props.subjectText,onSendLinkClicked:this.props.onSendLinkClicked,permissionsMap:this.props.permissionsMap,sendButtonType:f.default.button,sharingInformation:this.props.sharingInformation})):"",w=t.isLoadingDefaultRecipients?s.createElement("div",null,s.createElement(h.Spinner,{className:"od-SendLink-spinner",label:l.default.loadingRecipients,size:h.SpinnerSize.small})):s.createElement(u.default,{defaultSelectedItems:r,error:t.errorMessage,onChange:t.onSelectedPeopleChange,onResolvedSuggestions:this._onResolvedSuggestions,oversharingExternalsWarning:o,oversharingGroupsWarning:c,pickerSettings:t.sharingInformation.peoplePickerSettings,sharingLinkKind:n.sharingLinkKind,sharingInformation:t.sharingInformation,permissionsMap:t.permissionsMap,clientId:t.clientId}),E=this._isRoleSelectorCompactExperimentOn?s.createElement("div",null,s.createElement(g.RoleSelectorCompact,{currentSettings:this.props.currentSettings,clientId:this.props.clientId,appmap:this.props.sharingInformation.item.appmap,ariaLabel:l.default.addPeopleRoleSelectorAriaLabel,onShareHintClicked:this.props.onShareHintClicked,onEditChange:this.props.onEditChange})):"";return s.createElement("div",{className:"od-SendLink"},s.createElement("div",{className:"od-SendLink-email"},s.createElement("div",{className:"od-SendLink-permissions"},s.createElement("div",{className:"od-SendLink-peoplePicker"},w),E),s.createElement("div",{className:"od-SendLink-message "+d},this._renderTextArea(),this._renderCharacterCounter(),y)))};t.prototype._onManageExistingAccessClick=function(){this.context.sharingStore.getEngagementHelper().whoElseHasAccessClicked(this.props.engagementExtraData);this.props.onManageExistingAccessClick()};t.prototype._renderTextArea=function(){if(this.props.showTextArea)return s.createElement("div",null,this._isSubjectExperimentOn&&s.createElement(r.TextField,{underlined:!0,placeholder:l.default.subjectPlaceholder,onGetErrorMessage:this._validateSubject,defaultValue:this.props.subjectText}),s.createElement(r.TextField,{placeholder:l.default.messagePlaceholder,ariaLabel:l.default.messageAriaLabel,multiline:!0,resizable:!1,onGetErrorMessage:this._validateMessage,defaultValue:this.props.messageText}))};t.prototype._renderCharacterCounter=function(){var e=this.state.messageLength,t="od-SendLink-characterCounter "+(e>this.props.maximumMessageLength?"od-SendLink-characterCounter--error":"");if(e>this.props.maximumMessageLength/2)return s.createElement("div",{className:"od-SendLink-characterCounterWrapper"},s.createElement("span",{className:t},e,"/",this.props.maximumMessageLength))};t.contextTypes={platformDetection:o.object.isRequired,sharingStore:o.object.isRequired};return t}(s.Component);t.SendLink=S});
define("@ms/odsp-shared-sharing/lib/components/SendButton/SendButton",["require","exports","tslib","react","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Link","../../interfaces/SharingInterfaces","./SendButtonType","../../utilities/ShareHelper","prop-types","./SendButton.scss"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._onSendLinkClicked=function(){r.props.onSendLinkClicked(r.props.messageText,r.props.subjectText)};r._platformDetection=n.platformDetection;return r}t.prototype.render=function(){var e=!1;if(this.props.currentSettings.audience===o.SharingAudience.existing)for(var t=0,n=this.props.linkRecipients;t<n.length;t++){var f=n[t];if(void 0===this.props.permissionsMap[f.email]&&void 0===this.props.permissionsMap[f.userId]){e=!0;break}}if(this.props.ctaLabel){var l=!!this.props.errorMessage||a.isLoadingData(this.props.sharingInformation)||e||a.getEncodedMessageLength(this.props.messageText)>this.props.maximumMessageLength||a.getEncodedMessageLength(this.props.subjectText)>this.props.maximumSubjectLength;if(this.props.sendButtonType===u.default.button)return r.createElement(i.PrimaryButton,{disabled:l,onClick:this._onSendLinkClicked},this.props.ctaLabel);if(this.props.sendButtonType===u.default.link)return r.createElement("div",{className:"od-SendButton-linkButton"},r.createElement(s.Link,{disabled:l,onClick:this._onSendLinkClicked},this._platformDetection.isAndroid?this.props.ctaLabel.toUpperCase():this.props.ctaLabel))}};t.contextTypes={platformDetection:f.object.isRequired};return t}(r.Component);t.default=l});
define("@ms/odsp-shared-sharing/lib/components/SendButton/SendButtonType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.button=0]="button";e[e.link=1]="link"}(n||(n={}));t.default=n});
define("@ms/odsp-shared-sharing/lib/components/SendButton/SendButton.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SendButton-linkButton{font-size:17px;font:-apple-system-headline}"}])});
define("@ms/odsp-shared-sharing/lib/components/RoleSelectorCompact/RoleSelectorCompact",["require","exports","tslib","react","../../interfaces/SharingInterfaces","office-ui-fabric-react/lib/ContextualMenu","office-ui-fabric-react/lib/Callout","office-ui-fabric-react/lib/Button","@ms/odsp-utilities/lib/string/StringHelper","../Share.resx","@ms/odsp-utilities/lib/features/Features","./RoleSelectorCompact.scss"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c={ODB:772},h=function(e){n.__extends(t,e);function t(t,n){var r,i=e.call(this,t)||this;i._onItemClicked=function(e,t){var n;switch(t.key){case"edit":n=2;break;case"comment":n=6;break;case"view-only":n=1;break;default:n=0}i.setState({selectedItemKey:n});i.props.onEditChange(n);return!0};r=i.props.currentSettings.isEdit?2:1;i.state={selectedItemKey:r};return i}t.prototype.render=function(){var e=this,t=l.default.isFeatureEnabled(c),n=this.props.clientId===i.ClientId.word||this.props.appmap&&"ms-word"===this.props.appmap,h=t&&n?[{key:"edit",text:f.default.canEditRole,ariaLabel:a.format(f.default.roleSelectorOptionAriaLabel,f.default.canEditRole,f.default.canEditRoleSubText),canCheck:!0,isChecked:2===this.state.selectedItemKey,iconProps:{iconName:"Edit",style:{fontSize:12}}},{key:"comment",text:f.default.canCommentRole,ariaLabel:a.format(f.default.roleSelectorOptionAriaLabel,f.default.canReviewRole,f.default.canReviewRoleSubText),canCheck:!0,isChecked:6===this.state.selectedItemKey,iconProps:{iconName:"Feedback",style:{fontSize:12}}},{key:"view-only",text:f.default.canViewOnlyRole,ariaLabel:a.format(f.default.roleSelectorOptionAriaLabel,f.default.canViewRole,f.default.canViewRoleSubText),canCheck:!0,isChecked:1===this.state.selectedItemKey,iconProps:{iconName:"Uneditable",style:{fontSize:12}}},{key:"divider_1",itemType:s.ContextualMenuItemType.Divider},{key:"moresettings",text:f.default.moreSettingsLabel,ariaLabel:a.format(f.default.roleSelectorOptionAriaLabel,f.default.moreOptionsLabel,f.default.moreOptionsLabel),onClick:function(){e.props.onShareHintClicked()},className:"od-RoleSelectorCompact-settingsItem"}]:[{key:"edit",text:f.default.canEditRole,ariaLabel:a.format(f.default.roleSelectorOptionAriaLabel,f.default.canEditRole,f.default.canEditRoleSubText),canCheck:!0,isChecked:2===this.state.selectedItemKey,iconProps:{iconName:"Edit",style:{fontSize:12}}},{key:"view-only",text:f.default.canViewOnlyRole,ariaLabel:a.format(f.default.roleSelectorOptionAriaLabel,f.default.canViewRole,f.default.canViewRoleSubText),canCheck:!0,isChecked:1===this.state.selectedItemKey,iconProps:{iconName:"Uneditable",style:{fontSize:12}}},{key:"divider_1",itemType:s.ContextualMenuItemType.Divider},{key:"moresettings",text:f.default.moreSettingsLabel,ariaLabel:a.format(f.default.roleSelectorOptionAriaLabel,f.default.moreOptionsLabel,f.default.moreOptionsLabel),onClick:function(){e.props.onShareHintClicked()},className:"od-RoleSelectorCompact-settingsItem"}];return r.createElement(u.IconButton,{menuIconProps:{iconName:"ChevronDownSmall",style:{fontSize:"16"}},iconProps:{iconName:this.getRoleIconName(this.state.selectedItemKey).name},className:"od-RoleSelectorCompact-permissionButton",styles:{root:{minWidth:36,minHeight:32,border:"1px solid",padding:0,marginLeft:3,borderRadius:2},menuIcon:{fontSize:6,marginLeft:0},icon:{fontSize:12,marginRight:2}},menuProps:{directionalHint:o.DirectionalHint.bottomRightEdge,shouldFocusOnMount:!0,items:h,isBeakVisible:!1,onItemClick:this._onItemClicked},disabled:!!this.props.disabled,ariaLabel:this.props.ariaLabel})};t.prototype.getRoleIconName=function(e){var t;switch(e){case 2:t="Edit";break;case 1:t="Uneditable";break;case 6:t="Feedback"}return{name:t}};return t}(r.Component);t.RoleSelectorCompact=h});
define("@ms/odsp-shared-sharing/lib/components/RoleSelectorCompact/RoleSelectorCompact.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-RoleSelectorCompact-permissionButton{border-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-RoleSelectorCompact-permissionButton.is-expanded{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-RoleSelectorCompact-settingsItem .ms-Icon-placeHolder{display:none}"}])});
define("@ms/odsp-shared-sharing/lib/components/SendLink/SendLink.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-SendLink--exclustionNotification .ms-BasePicker-text{border-bottom:1px solid "},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.od-SendLink-message{margin-top:16px}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field{font-size:12px;font-weight:400;font:-apple-system-footnote}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::-webkit-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::-moz-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SendLink-message .ms-TextField.ms-TextField--multiline .ms-TextField-field::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .od-SendLink-message-border .ms-TextField.ms-TextField--multiline .ms-TextField-field{padding-left:5px}[dir=rtl] .od-SendLink-message-border .ms-TextField.ms-TextField--multiline .ms-TextField-field{padding-right:5px}.od-SendLink-message-border .ms-TextField.ms-TextField--multiline .ms-TextField-fieldGroup{margin-bottom:16px}.od-SendLink-message-no-border .ms-TextField.ms-TextField--multiline div{border-color:transparent}.od-SendLink-spinner .ms-Spinner-circle{display:inline-block}[dir=ltr] .od-SendLink-spinner .ms-Spinner-circle{margin-right:8px}[dir=rtl] .od-SendLink-spinner .ms-Spinner-circle{margin-left:8px}.od-SendLink-spinner .ms-Spinner-label{display:inline}.od-SendLink-ITPolicy{position:absolute;top:-24px}[dir=ltr] .od-SendLink-ITPolicy{right:0}[dir=rtl] .od-SendLink-ITPolicy{left:0}.od-SendLink-emailButtons{font:-apple-system-headline}[dir=ltr] .od-SendLink-emailButtons{float:right}[dir=rtl] .od-SendLink-emailButtons{float:left}.od-SendLink-emailButtons-allCaps{font:-apple-system-headline;font-style:uppercase;border-radius:2px}[dir=ltr] .od-SendLink-emailButtons-allCaps{float:right}[dir=rtl] .od-SendLink-emailButtons-allCaps{float:left}.od-SendLink-emailButtons-left{font:-apple-system-headline}[dir=ltr] .isFluent .od-SendLink-emailButtons-left{text-align:right}[dir=rtl] .isFluent .od-SendLink-emailButtons-left{text-align:left}.od-SendLink-emailButtons-rounded{font:-apple-system-headline}[dir=ltr] .od-SendLink-emailButtons-rounded{float:right}[dir=rtl] .od-SendLink-emailButtons-rounded{float:left}.od-SendLink-emailButtons-rounded .ms-Button{font:-apple-system-headline;border-radius:8px;height:54px}.od-SendLink-sendWrapper{display:block;width:100%;height:24px;padding-bottom:5px}.od-SendLink-email{position:relative}.od-SendLink-email .ms-TextField-field{height:65px;padding-bottom:30px;font-size:12px}[dir=ltr] .od-SendLink-email .ms-TextField-field{padding-left:0}[dir=rtl] .od-SendLink-email .ms-TextField-field{padding-right:0}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font-size:12px;font-weight:400;font:-apple-system-footnote}.isFluent .od-SendLink-email .ms-BasePicker .ms-BasePicker-input{font-size:14px;height:32px}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::-webkit-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::-moz-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::-ms-input-placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SendLink-email .ms-BasePicker .ms-BasePicker-input::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.isFluent .od-SendLink-sendContainer{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end}.od-SendLink-characterCounter{font-size:12px;font-weight:400}[dir=ltr] .od-SendLink-characterCounter{float:right}[dir=rtl] .od-SendLink-characterCounter{float:left}.od-SendLink-characterCounter--error{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.od-SendLink-characterCounterWrapper{display:block;height:16px;padding-bottom:5px}.od-SendLink-permissions{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.od-SendLink-peoplePicker{-webkit-box-flex:2;-ms-flex-positive:2;flex-grow:2}"}])});
define("@ms/odsp-shared-sharing/lib/components/ShareMain/ShareTargets/ShareTargets",["require","exports","tslib","../../../interfaces/SharingInterfaces","react","../../../utilities/ClientIdHelper","office-ui-fabric-react/lib/Icon","../../../utilities/ShareHelper","office-ui-fabric-react/lib/Tooltip","../../../components/Share.resx","./ShareTargets.scss"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.sharingInformation.requiresAccessApproval&&this.props.currentSettings.audience!==r.SharingAudience.existing;this._shareTargetsData=this._getShareTargetsData();if(!u.isLoadingData(this.props.sharingInformation)){for(var t=[],n=0,s=this._shareTargetsData;n<s.length;n++){var o=s[n];t.push(o.shareType)}this.props.onShareTargetsRendered(t)}return e?i.createElement("div",{className:"od-ShareTargets"},i.createElement(a.TooltipHost,{content:f.default.accessRequestTooltip,calloutProps:{calloutWidth:300,directionalHint:a.DirectionalHint.topCenter}},i.createElement("ul",{className:"od-ShareTargets-items","aria-label":f.default.otherWaysToShareLabel},this._renderTargets()))):i.createElement("div",{className:"od-ShareTargets"},i.createElement("ul",{className:"od-ShareTargets-items","aria-label":f.default.otherWaysToShareLabel},this._renderTargets()))};t.prototype._renderTargets=function(){for(var e=[],t=this.props.sharingInformation.requiresAccessApproval&&this.props.currentSettings.audience!==r.SharingAudience.existing,n=0,s=this._shareTargetsData;n<s.length;n++){var a=s[n],f=void 0,l=a.icon,c=l.split(":",2)[1],h=t||u.isLoadingData(this.props.sharingInformation),p="od-ShareTargets-icon "+(h?"od-ShareTargets-disabled":""),d="od-ShareTargets-itemText ms-font-xs "+(h?"od-ShareTargets-disabled":"");f=l.indexOf("font:")>-1?i.createElement(o.Icon,{iconName:c,className:p}):i.createElement("img",{src:c,className:p});e.push(i.createElement("li",{key:a.shareType,className:"od-ShareTargets-item"},i.createElement("button",{className:"od-ShareTargets-target",disabled:h,onClick:a.action},i.createElement("div",{className:"od-ShareTargets-itemImage"},f),i.createElement("div",{className:d},a.label))))}return e};t.prototype._getShareTargetsData=function(){var e=[{label:f.default.copyLinkLabel,icon:"font:Link",bgColor:"ms-bgColor-themePrimary",shareType:r.ShareType.copy,action:this._onClick.bind(this,r.ShareType.copy)}],t=this._determineMailShareTarget(this.props.clientId);t===r.OutlookAvailability.available?e.push({label:f.default.outlookLabel,icon:"font:OutlookLogo",bgColor:"ms-bgColor-themePrimary",shareType:r.ShareType.outlook,action:this._onClick.bind(this,r.ShareType.outlook)}):t===r.OutlookAvailability.other&&e.push({label:f.default.nonOutlookLabel,icon:"font:Mail",bgColor:"ms-bgColor-themePrimary",shareType:r.ShareType.nonOutlook,action:this._onClick.bind(this,r.ShareType.nonOutlook)});this._isTeamsShareTargetEnabled()&&e.push({label:f.default.teamsLabel,icon:"font:TeamsLogo",bgColor:"ms-bgColor-themePrimary",shareType:r.ShareType.teams,action:this._onClick.bind(this,r.ShareType.teams)});this._isMoreAppsShareTargetEnabled()&&e.push({label:f.default.moreAppsLabel,icon:"font:More",bgColor:"ms-bgColor-themePrimary",shareType:r.ShareType.moreApps,action:this._onClick.bind(this,r.ShareType.moreApps)});return e};t.prototype._onClick=function(e,t){this.props.onShareTargetClicked(e)};t.prototype._determineMailShareTarget=function(e){if(s.showOWAShareTarget(this.props.clientId)&&this.props.outlookAvailability===r.OutlookAvailability.available)return r.OutlookAvailability.available;try{return window.external.CheckSendViaOutlookAvailability()}catch(e){return r.OutlookAvailability.none}};t.prototype._isTeamsShareTargetEnabled=function(){try{return window.external.IsTeamsEnabled()}catch(e){return!1}};t.prototype._isMoreAppsShareTargetEnabled=function(){try{return window.external.IsMoreAppsEnabled()}catch(e){return!1}};return t}(i.Component);t.ShareTargets=l});
define("@ms/odsp-shared-sharing/lib/components/ShareMain/ShareTargets/ShareTargets.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareTargets{padding-top:20px}.od-ShareTargets-items{list-style:none;display:inline-block}[dir=ltr] .od-ShareTargets-items{margin-right:-10px}[dir=rtl] .od-ShareTargets-items{margin-left:-10px}.od-ShareTargets-item{vertical-align:top;display:inline-block;text-align:center}[dir=ltr] .od-ShareTargets-item{margin-right:10px}[dir=rtl] .od-ShareTargets-item{margin-left:10px}.od-ShareTargets-item--bottomMargin{margin-bottom:16px}.od-ShareTargets-itemImage{-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";border-radius:50%;color:"},{theme:"neutralPrimaryAlt",defaultValue:"#3c3c3c"},{rawString:";cursor:pointer;display:inline-block;height:48px;margin-bottom:8px;width:48px}.isFluent .od-ShareTargets-itemImage{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-ShareTargets-icon{font-size:25px;padding-top:11px}.isFluent .od-ShareTargets-icon{font-size:26px}.od-ShareTargets-itemImage--border{border:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-ShareTargets-itemText{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font:-apple-system-short-caption2}.isFluent .od-ShareTargets-itemText{font-size:10px}.od-ShareTargets-target{background:0 0;border:none}.ms-Fabric .od-ShareTargets-target::-moz-focus-inner{border:0}.ms-Fabric .od-ShareTargets-target{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-ShareTargets-target:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-ShareTargets-target:focus:after{border-color:ActiveBorder}}.od-ShareTargets-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-Share .od-ShareTargets-target{outline:1px solid "},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}}"}])});
define("@ms/odsp-shared-sharing/lib/utilities/AttachAsCopyHelper",["require","exports","../components/Share.resx","../utilities/ClientIdHelper"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e.getAttachAsCopyOptions=function(e,t,i,s){var o=[],u=function(e,t,i,s){var o=!1,u=i.name.split("."),a="";u.length>1&&(a=u[1].toLowerCase());try{var f=window.external;o=f.IsSendCopyEnabled()}catch(e){}if(!o)return;var l=function(){!function(e,t){e.getEngagementHelper().sendACopyOfficeClicked(t);try{window.external.SendCopy()}catch(e){}}(e,s)};return r.isWord(t)||function(e){return["doc","docx","dot","docm","odt","rtf","txt"].indexOf(e)>-1}(a)?{key:"word",name:n.default.wordDocument,iconProps:{iconName:"WordDocument",className:"Share-wordIcon"},onClick:l}:r.isPowerPoint(t)||function(e){return["ppt","pptx","pptm","ppsx","pps","ppsm","odp"].indexOf(e)>-1}(a)?{key:"powerpoint",name:n.default.powerPointPresentation,iconProps:{iconName:"PowerPointDocument",className:"Share-powerpointIcon"},onClick:l}:r.isExcel(t)||function(e){return["xlsx","xlsm","xlsb","xls","ods","csv","xlt","xltm","xltx"].indexOf(e)>-1}(a)?{key:"excel",name:n.default.excelWorkbook,iconProps:{iconName:"ExcelDocument",className:"Share-excelIcon"},onClick:l}:r.isVisio(t)||function(e){return["vsd","vsdx"].indexOf(e)>-1}(a)?{key:"visio",name:n.default.visioDrawing,iconProps:{iconName:"VisioLogo"},onClick:l}:{key:"document",name:n.default.document,iconProps:{iconName:"Document"},onClick:l}}(i,e,t,s);u&&o.push(u);var a=function(e,t){var r=!1;try{var i=window.external;r=i.IsSendPdfEnabled()}catch(e){}if(!r)return;return{key:"pdf",name:n.default.pdf,iconProps:{iconName:"PDF",className:"Share-pdfIcon"},onClick:function(){!function(e,t){e.getEngagementHelper().sendACopyPdfClicked(t);try{window.external.SendPdf()}catch(e){}}(e,t)}}}(i,s);a&&o.push(a);return o}}(i||(i={}));t.default=i});
define("@ms/odsp-shared-sharing/lib/components/ShareMain/ShareMain.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-ShareMain.blocker{position:relative}.od-ShareMain.blocker:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:.8}.od-ShareMain-section{padding:20px 16px 0 16px}.isFluent .od-ShareMain-section{padding:16px 16px 0}.od-ShareMain-section.full-bleed{padding:0}.od-ShareMain-targets{clear:both;padding:0 20px 20px 20px}.od-ShareMain-section-body{margin-bottom:44px}.od-ShareMain-footer{font-size:12px;font-weight:400;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;padding:0 16px;width:100%;height:44px;color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:";cursor:pointer;border:none;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";font:-apple-system-subheadline;bottom:0}.ms-Fabric .od-ShareMain-footer::-moz-focus-inner{border:0}.ms-Fabric .od-ShareMain-footer{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-ShareMain-footer:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-ShareMain-footer:focus:after{border-color:ActiveBorder}}.ms-Fabric .od-ShareMain-footer{position:fixed}.od-ShareMain-attachIcon{margin-top:2px;font-size:16px}[dir=ltr] .od-ShareMain-attachIcon{margin-right:4px}[dir=rtl] .od-ShareMain-attachIcon{margin-left:4px}.od-ShareMain-attachmentOptions .is-open{border:none;width:auto}.od-ShareMain-attachmentOptions button{width:auto}"}])});
define("@ms/odsp-shared-sharing/lib/components/SharePolicyDetails/SharePolicyDetails",["require","exports","tslib","@ms/odsp-utilities/lib/dateTime/DateTime","../Header/Header","@ms/odsp-shared-react/lib/PolicyTip","react","prop-types","../Share.resx","./SharePolicyDetails.scss"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._onOverrideClicked=function(){var e=i.props.policyTipInformation.info.overrideOption;1===e?i._store.updatePolicy(0):2===e&&i.setState(n.__assign({},i.state,{showJustificationInput:!0}))};i._onOverrideSubmitClicked=function(e){i._store.updatePolicy(0,e)};i._onReportClicked=function(){i._store.updatePolicy(1)};i._store=r.sharingStore;i._resize=r.resize;i.state={showJustificationInput:!1};return i}t.prototype.componentDidUpdate=function(){this._resize()};t.prototype.render=function(){var e=this.props,t=this.state,n=e.policyTipInformation.info;return o.createElement("div",{className:"od-SharePolicyDetails"},o.createElement(i.Header,{clientId:e.clientId,item:e.sharingInformation.item,viewState:6}),o.createElement("div",{className:"od-Share-PolicyTip"},o.createElement(s.PolicyTip,{confirmationText:this._getConfirmationText(),onDismissed:function(){},onOverrideClicked:this._onOverrideClicked,onOverrideSubmitClicked:this._onOverrideSubmitClicked,overrideRequiresJustification:n?2===n.overrideOption:void 0,showJustificationInput:t.showJustificationInput,onReportClicked:this._onReportClicked,strings:this._getStrings()})))};t.prototype._getStrings=function(){var e=this.props.policyTipInformation.info,t=e&&(1===e.overrideOption||2===e.overrideOption);return{headerText:a.default.ptHeader,issues:e?e.issueDescriptions:void 0,lastScannedText:e&&e.lastScanned?a.default.ptLastScanned+": "+r.getRelativeDateTimeStringPast(e.lastScanned):void 0,learnMoreActionLabel:e?a.default.ptLearnMoreActionLabel:void 0,learnMoreLabel:e?a.default.ptLearnMoreLabel:void 0,learnMoreUrl:e?e.policyInfoUrl:void 0,noPolicyTipInfoError:e?void 0:a.default.ptNoPolicyTipInfo,overrideActionLabel:t?a.default.ptOverrideActionLabel:void 0,overrideLabel:a.default.ptOverrideLabel,policyTipDescription:e?e.explanationText:void 0,reportActionLabel:a.default.ptReportActionLabel,reportLabel:a.default.ptReportLabel,reportInProgressLabel:a.default.ptReportInProgress,submitButtonLabel:a.default.ptSubmitLabel,titleText:void 0}};t.prototype._getConfirmationText=function(){var e=this.props.policyTipInformation.actionResult;return null===e?"":1===e?a.default.ptReportConfirmation:2===e||3===e?a.default.ptOverrideConfirmation:""};t.contextTypes={sharingStore:u.object.isRequired,resize:u.func.isRequired};return t}(o.Component);t.SharePolicyDetails=f});
define("@ms/odsp-shared-react/lib/PolicyTip",["require","exports","tslib","./components/PolicyTip/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/odsp-shared-react/lib/components/PolicyTip/index",["require","exports","tslib","./PolicyTip"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/odsp-shared-react/lib/components/PolicyTip/PolicyTip",["require","exports","tslib","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Spinner","office-ui-fabric-react/lib/TextField","react","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/Icon","./PolicyTip.scss"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r._onReportClicked=function(){r.setState(n.__assign({},r.state,{isLoading:!0,reportButtonClicked:!0}),function(){r.props.onReportClicked()})};r._onOverrideClicked=function(){r.setState(n.__assign({},r.state,{overrideButtonClicked:!0}),function(){r.props.onOverrideClicked()})};r._onOverrideSubmitClicked=function(){r.setState(n.__assign({},r.state,{isLoading:!0,overrideSubmitClicked:!0}),function(){r.props.onOverrideSubmitClicked(r.state.justificationText)})};r._onJustificationChanged=function(e,t){r.props.overrideRequiresJustification&&r.setState(n.__assign({},r.state,{justificationText:t||"",overrideSubmitDisabled:!t}))};r.state={isLoading:!1,justificationText:"",reportButtonClicked:!1,overrideButtonClicked:!1,overrideSubmitClicked:!1,overrideSubmitDisabled:t.overrideRequiresJustification};return r}t.prototype.UNSAFE_componentWillReceiveProps=function(e,t){this.state.isLoading&&e.confirmationText&&this.setState(n.__assign({},this.state,{isLoading:!1}))};t.prototype.componentWillUnmount=function(){this.props.onDismissed()};t.prototype.render=function(){var e=this.props.strings,t=e.noPolicyTipInfoError?u.createElement("div",{className:"od-PolicyTip-container"},u.createElement("span",{className:"od-PolicyTip-error"},e.noPolicyTipInfoError)):u.createElement("div",{className:"od-PolicyTip-container"},u.createElement("span",{className:"od-PolicyTip-description"},e.policyTipDescription),u.createElement("div",{className:"od-PolicyTip-header"},u.createElement(f.Icon,{iconName:"Blocked2",className:"od-PolicyTip-blockedIcon"}),u.createElement("span",{className:"od-PolicyTip-headerText"},e.headerText)),this._renderIssues(),u.createElement("span",{className:"od-PolicyTip-minorText"},e.lastScannedText),this._renderLearnMore(),u.createElement("div",{className:"od-PolicyTip-actions"},this._renderActions()),this._renderJustificationInput(),this._renderStatus());return u.createElement("div",null,u.createElement("h2",{className:"od-PolicyTip-title"},e.titleText),t)};t.prototype._renderIssues=function(){for(var e=[],t=0,n=0,r=this.props.strings.issues;n<r.length;n++){var i=r[n];e.push(u.createElement("span",{className:"od-PolicyTip-issue",key:t++},i))}return e};t.prototype._renderLearnMore=function(){var e=this.props.strings;if(e.learnMoreUrl){var t=u.createElement("a",{href:e.learnMoreUrl,target:"_blank"},e.learnMoreActionLabel),n=a.formatToArray(e.learnMoreLabel,t);return u.createElement("div",{className:"od-PolicyTip-learnMoreContainer od-PolicyTip-minorText"},n)}};t.prototype._getAction=function(e,t,n,r){if(n)return u.createElement("div",{className:"od-PolicyTip-action"},u.createElement("span",null,""+a.format(e,t)));var i=u.createElement("a",{className:"od-PolicyTip-actionLabel",onClick:r,role:"button",href:"javascript:;"},t),s=a.formatToArray(e,i);return u.createElement("div",{className:"od-PolicyTip-action"},s)};t.prototype._renderActions=function(){var e=this.props,t=this.state,n=e.strings,r=[],i=this._getAction(n.reportLabel,n.reportActionLabel,t.reportButtonClicked,this._onReportClicked);r.push(i);if(n.overrideActionLabel){var s=this._getAction(n.overrideLabel,n.overrideActionLabel,t.overrideButtonClicked,this._onOverrideClicked);r.push(s)}return r};t.prototype._renderStatus=function(){var e=this.props;return this.state.isLoading?u.createElement("div",{className:"od-PolicyTip-status"},u.createElement(s.Spinner,null),u.createElement("span",{className:"od-PolicyTip-statusText"},e.strings.reportInProgressLabel)):e.confirmationText?u.createElement("div",{className:"od-PolicyTip-status"},u.createElement(f.Icon,{iconName:"CheckMark"}),u.createElement("span",{className:"od-PolicyTip-statusText"},e.confirmationText)):void 0};t.prototype._renderJustificationInput=function(){var e=this.props,t=this.state;if(e.showJustificationInput)return u.createElement("div",{className:"od-PolicyTip-justificationInputContainer"},u.createElement(o.TextField,{autoAdjustHeight:!0,multiline:!0,value:t.justificationText,onChange:this._onJustificationChanged,underlined:!0,resizable:!1}),!t.overrideSubmitClicked&&u.createElement(i.PrimaryButton,{className:"od-PolicyTip-submitButton",disabled:t.overrideSubmitDisabled,onClick:this._onOverrideSubmitClicked},e.strings.submitButtonLabel))};return t}(r.BaseComponent);t.PolicyTip=l});
define("@ms/odsp-shared-react/lib/components/PolicyTip/PolicyTip.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".od-PolicyTip-container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.od-PolicyTip-title{font-size:21px;font-weight:100;margin:0px 0px 8px 0px}.od-PolicyTip-description{font-size:14px;font-weight:400;margin-top:20px}.od-PolicyTip-header{display:-webkit-box;display:-ms-flexbox;display:flex;margin:20px 0px}.od-PolicyTip-blockedIcon{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:";font-size:21px;padding-top:2px}.od-PolicyTip-headerText{font-size:17px;font-weight:300;font-weight:600}[dir='ltr'] .od-PolicyTip-headerText{margin-left:12px}[dir='rtl'] .od-PolicyTip-headerText{margin-right:12px}.od-PolicyTip-issue{font-size:14px;font-weight:400;margin-bottom:12px}[dir='ltr'] .od-PolicyTip-issue{margin-left:33px}[dir='rtl'] .od-PolicyTip-issue{margin-right:33px}.od-PolicyTip-minorText{font-size:12px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-PolicyTip-learnMoreContainer{display:-webkit-box;display:-ms-flexbox;display:flex}[dir='ltr'] .od-PolicyTip-learnMoreContainer a{padding-right:4px}[dir='rtl'] .od-PolicyTip-learnMoreContainer a{padding-left:4px}.od-PolicyTip-actions{margin-top:60px}.od-PolicyTip-action{font-size:12px;font-weight:400;margin-bottom:8px}.od-PolicyTip-actionLabel{font-weight:600;cursor:pointer}[dir='ltr'] .od-PolicyTip-label{margin-left:4px}[dir='rtl'] .od-PolicyTip-label{margin-right:4px}.od-PolicyTip-status{display:-webkit-box;display:-ms-flexbox;display:flex;margin-top:34px;margin-bottom:8px}.od-PolicyTip-status{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-PolicyTip-statusText{font-size:12px;font-weight:400}[dir='ltr'] .od-PolicyTip-statusText{margin-left:4px}[dir='rtl'] .od-PolicyTip-statusText{margin-right:4px}.od-PolicyTip-submitButton{margin-top:8px}.od-PolicyTip-error{margin-top:36px;font-size:17px;font-weight:300}\n"}])});
define("@ms/odsp-shared-sharing/lib/components/SharePolicyDetails/SharePolicyDetails.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share-PolicyTip{padding:0 16px 10px 16px}.od-Share-PolicyTip .od-PolicyTip-title{display:none}"}])});
define("@ms/odsp-shared-sharing/lib/components/AtMention/AtMention",["require","exports","tslib","../../interfaces/SharingInterfaces","../ActivityIndicator/ActivityIndicator","../Header/Header","office-ui-fabric-react/lib/MessageBar","office-ui-fabric-react/lib/Persona","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Spinner","../Share.resx","../../utilities/ClientIdHelper","react","prop-types","../../utilities/ShareCommunicationManager","./AtMention.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t)||this;i._onShareClicked=function(){i.setState({isSharing:!0},function(){i._store.getEngagementHelper().shareCompleted({clientId:i.props.clientId,scenarioId:i.props.scenarioId,mode:r.Mode.atMention});i._store.grantAccess(i.props.recipients)})};i._onOkayClicked=function(){i._notifyGrantAccessCompleted(!1);i._dismiss()};i._dismiss=n.onDismiss;i._resize=n.resize;i._store=n.sharingStore;i._platformDetection=n.platformDetection;i._shareClickTime=n.shareClickTime;var s=0===t.recipients.length;s||i._notifyReady();i.state={canShare:i._canShare(t.recipients),isLoading:s,isSharing:!1};return i}t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=0===e.recipients.length;this.state.isLoading&&!t&&this._notifyReady();this.setState({canShare:this._canShare(e.recipients),isLoading:t})};t.prototype.componentDidUpdate=function(){setTimeout(this._resize,10)};t.prototype.componentDidMount=function(){var e=this;this._notifyReadyForRecipients();this._store.addListener(function(){var t=e._store.getGrantAccessResult();if(null!==t){e._notifyGrantAccessCompleted(t);e._dismiss()}})};t.prototype.render=function(){var e,t=this.state,n=t.canShare,i=t.isLoading,o=t.isSharing;e=i?this._renderLoadingSpinner():n?this._renderHappyPath():this._renderSadPath();return h.createElement("div",{className:"od-AtMention "+(o?"od-AtMention--isSharing":"")},!i&&h.createElement(s.Header,{mode:r.Mode.atMention,viewState:5,clientId:this.props.clientId}),e,this._renderSharingActivityIndicator(),h.createElement("span",{role:"alert",className:"od-Share-screenReaderOnly"},this._getScreenReaderAlertMessage()))};t.prototype._renderLoadingSpinner=function(){return h.createElement("div",{className:"od-AtMention-spinnerHolder"},h.createElement(f.Spinner,{className:"od-AtMention-spinner",label:l.default.componentLoading,type:f.SpinnerType.large}))};t.prototype._renderSharingActivityIndicator=function(){if(this.state.isSharing)return h.createElement(i.ActivityIndicator,{message:l.default.grantAccessActivityIndicatorString})};t.prototype._renderHappyPath=function(){var e=this._platformDetection.isIOS?"od-AtMention-button-rounded":"od-AtMention-button",t=c.isOneNote(this.props.clientId)?l.default.atMentionHappyMessageOneNote:l.default.atMentionHappyMessage;return h.createElement("div",{className:"od-AtMention-container"},this._renderRecipients(!1),h.createElement("div",{className:"od-AtMention-message"},t),h.createElement(a.PrimaryButton,{autoFocus:!0,className:e,onClick:this._onShareClicked},l.default.shareAndNotifyButtonLabel))};t.prototype._renderSadPath=function(){var e=this._platformDetection.isIOS?"od-AtMention-button-rounded":"od-AtMention-button";return h.createElement("div",{className:"od-AtMention-container"},h.createElement(o.MessageBar,{messageBarType:o.MessageBarType.warning},this._getSadMessage()),this._renderRecipients(!0),h.createElement(a.PrimaryButton,{autoFocus:!0,className:e,onClick:this._onOkayClicked},l.default.okayButtonLabel))};t.prototype._renderRecipients=function(e){var t=this,n=this.props.recipients.map(function(e){var n=t._isRecipientInvalid(e);return h.createElement("li",null,h.createElement(u.Persona,{className:"od-AtMention-recipient "+(n?"od-AtMention-recipient--error":""),imageUrl:e.image,primaryText:e.name,size:u.PersonaSize.extraSmall}))});return h.createElement("ul",{className:"od-AtMention-recipients "+(e?"od-AtMention-recipients--error":""),"aria-label":l.default.grantAccessRecipientsListLabel},n)};t.prototype._getScreenReaderAlertMessage=function(){return this.state.isSharing?l.default.grantAccessActivityIndicatorString:l.default.grantAccessPageLabel};t.prototype._canShare=function(e){var t=this,n=this.props.sharingInformation;return!!n.canManagePermissions&&(!!n.canAddInternalPrincipal&&e.every(function(e){return!t._isRecipientInvalid(e)}))};t.prototype._isRecipientInvalid=function(e){return!e.isResolved||e.isExternal&&!e.providerName};t.prototype._notifyReady=function(){d.pageFinishedLoading(this._shareClickTime,this.props.clientId,r.Mode.atMention,this.props.scenarioId)};t.prototype._notifyReadyForRecipients=function(){d.readyForRecipients()};t.prototype._notifyGrantAccessCompleted=function(e){d.grantAccessCompleted(e)};t.prototype._getSadMessage=function(){var e=this.props.sharingInformation,t=c.isOneNote(this.props.clientId)?l.default.atMentionSadMessageOwnerOneNote:l.default.atMentionSadMessageOwner;return e.canManagePermissions&&e.canAddInternalPrincipal?l.default.atMentionSadMessageRecipient:t};t.contextTypes={onDismiss:p.func.isRequired,resize:p.func.isRequired,sharingStore:p.object.isRequired,platformDetection:p.object.isRequired,shareClickTime:p.number};return t}(h.Component);t.AtMention=v});
define("@ms/odsp-shared-sharing/lib/components/AtMention/AtMention.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-AtMention{max-height:550px;min-height:150px;overflow-y:auto;position:relative;min-width:320px}.od-AtMention ul{list-style-type:none;list-style:none;margin:0;padding:0}.od-AtMention li{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;margin-bottom:8px}[dir=ltr] .od-AtMention li{margin-right:4px}[dir=rtl] .od-AtMention li{margin-left:4px}.od-AtMention.od-AtMention--isSharing{position:relative}.od-AtMention.od-AtMention--isSharing:after{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";bottom:0;content:'';left:0;opacity:.8;position:absolute;right:0;top:0}.od-AtMention .od-AtMention-container{display:inline-block;margin:16px 16px 0 16px}.od-AtMention .od-AtMention-recipients{margin-bottom:16px;max-height:200px;overflow-y:auto}.od-AtMention .od-AtMention-recipients li>.od-AtMention-recipient{font:-apple-system-headline}.od-AtMention .od-AtMention-recipients--error{margin-top:16px}.od-AtMention .od-AtMention-recipients--error li>.od-AtMention-recipient--error{border-color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:";border-style:solid;border-width:thin}.od-AtMention .od-AtMention-recipients--error li>.od-AtMention-recipient--error .ms-Persona-primaryText{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:";font:-apple-system-body}.od-AtMention .od-AtMention-recipient{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";border-radius:16px;font:-apple-system-body}.od-AtMention .od-AtMention-message{margin-bottom:16px;font:-apple-system-body}.od-AtMention .od-AtMention-button{margin-bottom:16px;font:-apple-system-headline}.od-AtMention .od-AtMention-button-rounded{margin-bottom:16px;font:-apple-system-headline;height:44px;border-radius:8px}.od-AtMention .od-AtMention-spinnerHolder{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;height:150px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}"}])});
define("@ms/odsp-shared-sharing/lib/components/Notify/Notify",["require","exports","tslib","react","prop-types","../../interfaces/SharingInterfaces","../ShareNotification/ShareNotification","../Header/Header","../ActivityIndicator/ActivityIndicator","office-ui-fabric-react/lib/Button","../Share.resx","../PeoplePicker/PeoplePicker","../../utilities/PeoplePickerHelper","@ms/odsp-datasources/lib/dataSources/roleAssignments/PrincipalType","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Label","office-ui-fabric-react/lib/Link","./NotifyGroupRecipient","./NotifyPersonRecipient","../SendButton/SendButton","../../utilities/ShareHelper","../SendButton/SendButtonType","../../utilities/ShareCommunicationManager","office-ui-fabric-react/lib/Checkbox","office-ui-fabric-react/lib/MessageBar","./Notify.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C=100,k=function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._onExpandClick=function(){i.setState(function(e){return n.__assign({},e,{isExpanded:!e.isExpanded})},function(){i._sharingStore.getEngagementHelper().log("Notify.ExpandLinkClicked",i.props.engagementExtraData)})};i._onStoreUpdate=function(){var e=i._sharingStore.getPermissionsMap(),t=h.renderPickerError({selectedItems:i.state.peoplePickerRecipients,sharingLinkKind:1,canAddExternalPrincipal:i.props.sharingInformation.canAddExternalPrincipal,sharingInformation:i.props.sharingInformation,viewPolicyTipCallback:i._sharingStore.getPolicyTipInformation,permissionsMap:e});t&&i._sharingStore.getEngagementHelper().log("Notify.AddedUserWhoDoesNotHaveAccess",i.props.engagementExtraData);e=n.__assign({},i.state.permissionsMap,e);i.setState(function(r){return n.__assign({},r,{peoplePickerError:t,permissionsMap:e})})};i._onPeoplePickerSelected=function(e){i._sharingStore.checkPermissions(e);e.filter(function(e){return e.principalType!==p.default.user}).forEach(function(e){i._sharingStore.fetchMemberCount(e)});i._sharingStore.getEngagementHelper().log("Notify.AddedUserFromPeoplePicker",i.props.engagementExtraData);var t=i._sharingStore.getPermissionsMap(),r=h.renderPickerError({selectedItems:i.state.peoplePickerRecipients,sharingLinkKind:1,canAddExternalPrincipal:i.props.sharingInformation.canAddExternalPrincipal,sharingInformation:i.props.sharingInformation,viewPolicyTipCallback:i._sharingStore.getPolicyTipInformation,permissionsMap:t});t=n.__assign({},i.state.permissionsMap,t);i.setState(function(i){return n.__assign({},i,{peoplePickerRecipients:e,peoplePickerError:r,permissionsMap:t})},function(){i._sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestionSelected(i.props.engagementExtraData,e)})};i._onResolvedSuggestions=function(e){i._sharingStore.getEngagementHelper().peoplePickerLinkedinSuggestions(i.props.engagementExtraData,e);return e};i._updateGroupCount=function(){for(var e=i._sharingStore.getMembersCounts(),t=i.state.groups.slice(0),r=0;r<t.length;r++){var s=i.state.groups[r];if(e[s.email]!==s.memberCount){s.memberCount=e[s.email];s.checked=!1;s.disabled=s.memberCount>=C;t[r]=s}}i.setState(function(e){return n.__assign({},e,{groups:t})})};i._updateCheckboxForGroup=function(e){var t=i.state.groups;t.map(function(t){return t.email===e.email?e:t});i.setState({groups:t})};i._updateCheckboxForPerson=function(e){var t=i.state.people;t.map(function(t){return t.email===e.email?e:t});i.setState({people:t})};i._sendNotification=function(){var e=i._allRecipients();i.setState({showActivityIndicator:!0},function(){x.sendLinkClicked();i._sharingStore.shareLink({settings:i.props.currentSettings,recipients:e,allRecipientsHaveAccess:!0});i._sharingStore.getEngagementHelper().shareCompleted(n.__assign({},i.props.engagementExtraData,{recipientsCount:e.length}));x.shareCompleted(s.ShareType.share);i._showSuccessMessage()})};i._onGroupsExpandClick=function(){var e=i.state.groupsIsExpanded;i.setState(function(t){return n.__assign({},t,{groupsIsExpanded:!e})},function(){i._sharingStore.getEngagementHelper().log("Notify.GroupsExpandClicked",i.props.engagementExtraData)})};i._selectAllPeopleCheckbox=function(e,t){var n=i.state.people;n.map(function(e){e.checked=t;return e});i.setState({people:n})};i._sharingStore=r.sharingStore;i._shareClickTime=r.shareClickTime;i._resize=r.resize;i.state={isExpanded:!1,groupsIsExpanded:!1,count:0,peoplePickerRecipients:[],groups:[],people:[],peoplePickerError:null,showActivityIndicator:!1,permissionsMap:{},viewState:9};return i}t.prototype.UNSAFE_componentWillMount=function(){var e=this,t=this.props;this._sharingStore.addListener(this._onStoreUpdate);var r=t.sharingInformation.sharingPrincipals,i=t.sharingInformation.sharingLinks.reduce(function(e,t){return e.concat(t.principals)},[]).concat(r).map(function(e){return{userId:e.loginName,name:e.primaryText,job:e.secondaryText,email:""!==e.email?e.email:e.loginName,principalType:e.type,image:e.imageUrl,rawPersonData:{Key:e.loginName,EntityData:{SPGroupID:e.id}}}}),s=i.filter(function(e){return e.principalType!==p.default.user}).map(function(e){return n.__assign({},e,{checked:!1,expanded:!1,disabled:!0,groupId:e.rawPersonData.groupId,memberCount:null})});s.forEach(function(t){e._sharingStore.fetchMemberCount(t)});var o=i.filter(function(e){return e.principalType===p.default.user}),u={};o.concat(s).forEach(function(e){u[e.email]=3});this.state.peoplePickerRecipients.filter(function(e){return e.principalType!==p.default.user}).forEach(function(t){e._sharingStore.fetchMemberCount(t)});this.setState({isExpanded:!0,groupsIsExpanded:!0,count:0,peoplePickerRecipients:[],groups:s,people:o,peoplePickerError:null,permissionsMap:u,viewState:9})};t.prototype.componentDidMount=function(){x.pageFinishedLoading(this._shareClickTime,this.props.clientId,s.Mode.notify,this.props.scenarioId);this.setState({groupsIsExpanded:!1,isExpanded:!1})};t.prototype.componentDidUpdate=function(e,t){this._resize()};t.prototype._renderPeoplePicker=function(){var e=this.state,t=this.props;return r.createElement("div",{className:v.css("od-Notify-PeoplePicker")},r.createElement(c.default,{defaultSelectedItems:e.peoplePickerRecipients,onChange:this._onPeoplePickerSelected,onResolvedSuggestions:this._onResolvedSuggestions,pickerSettings:t.sharingInformation.peoplePickerSettings,sharingLinkKind:t.currentSettings.sharingLinkKind,error:e.peoplePickerError,sharingInformation:t.sharingInformation,permissionsMap:e.permissionsMap,clientId:t.clientId}))};t.prototype._computeTotalGroupsMembersCount=function(){var e=this.state,t=this._sharingStore.getMembersCounts();return e.groups.filter(function(e){return e.checked&&t[e.email]}).map(function(e){return t[e.email]}).reduce(function(e,t){return e+t},0)};t.prototype._computeTotalMemberCount=function(){var e=this._sharingStore.getMembersCounts(),t={};this._allRecipients().forEach(function(e){t[e.email]||(t[e.email]=e)});return Object.keys(t).map(function(n){return t[n].principalType===p.default.user?1:e[n]||0}).reduce(function(e,t){return e+t},0)};t.prototype._allRecipients=function(){var e=this.state;return e.peoplePickerRecipients.concat(e.people.filter(function(e){return e.checked})).concat(e.groups.filter(function(e){return e.checked}))};t.prototype._showSuccessMessage=function(){this.setState(function(e){return n.__assign({},e,{viewState:3,showActivityIndicator:!1})})};t.prototype._renderGroup=function(e){return r.createElement(y.NotifyGroupRecipient,{clientId:this.props.clientId,group:e,updateCountCallback:this._updateGroupCount,updateCheckboxForGroup:this._updateCheckboxForGroup,engagementExtraData:this.props.engagementExtraData})};t.prototype._renderGroups=function(e){var t=this,n=this.state,i=n.groupsIsExpanded?" expanded ":"",s=n.groups.length>5?" scroll ":"";if(0!==e.length)return r.createElement("div",{className:v.css("od-Notify-groups-container")},r.createElement("div",{className:v.css("od-Notify-groups-expand")},r.createElement(m.Label,{className:v.css("od-Notify-groupLabel")},l.default.notifyGroupsLabel),r.createElement(f.IconButton,{className:"od-Notify-group-expand-icon",iconProps:{iconName:i?"ChevronUp":"ChevronDown"},onClick:this._onGroupsExpandClick})),this._displayTotalGroupsMembersCount(),r.createElement("div",{className:v.css("od-Notify-groups-recipient-container"+i+s)},i&&e.map(function(e){return r.createElement("div",{key:e.email,className:v.css("od-Notify-groups-listItem")},t._renderGroup(e))})))};t.prototype._renderPerson=function(e){return r.createElement(b.NotifyPersonRecipient,{clientId:this.props.clientId,person:e,updateCheckboxForPerson:this._updateCheckboxForPerson,engagementExtraData:this.props.engagementExtraData})};t.prototype._renderPeople=function(e){var t=this,n=this.state,i=n.people.length>5?" scroll ":"";return r.createElement("div",{className:v.css("od-Notify-people-container")},r.createElement(m.Label,{className:v.css("od-Notify-peopleLabel")},l.default.notifyPeopleLabel),n.people.length>0&&r.createElement(T.Checkbox,{label:l.default.notifySelectAllPeople,onChange:this._selectAllPeopleCheckbox,defaultChecked:!1,className:v.css("od-Notify-people-selectAll-checkbox")}),r.createElement("div",{className:v.css("od-Notify-people-recipient-container"+i)},e.map(function(e){return t._renderPerson(e)})))};t.prototype._renderActivityIndicator=function(){if(this.state.showActivityIndicator)return r.createElement(a.ActivityIndicator,{message:l.default.activityMessageSendingMail})};t.prototype._renderNotification=function(){var e=this.props,t=e.sharingInformation,n=e.currentSettings,i={companyName:this._sharingStore.getCompanyName(),currentSettings:n,sharingInformation:t,clientId:e.clientId,onShareHintClick:null,linkRecipients:this._allRecipients(),customLabeledAudienceConfig:e.customLabeledAudienceConfig};return r.createElement(o.ShareNotification,{shareType:s.ShareType.share,itemName:t.item.name,linkUrl:null,clientId:this.props.clientId,sharingHintProps:i,shouldCopyLinkToClipboard:!0,customLabeledAudienceConfig:this.props.customLabeledAudienceConfig})};t.prototype._displayTotalMemberCountString=function(){var e=this._computeTotalMemberCount();return this.state.groups.filter(function(e){return e.checked}).length>0?d.format(l.default.notifyMembersTotalPlus,e):1===e?d.format(l.default.notifyMemberTotal):0===e?"":d.format(l.default.notifyMembersTotal,e)};t.prototype._tooManyRecipientsErrorString=function(){return l.default.peoplePickerLimitMessage};t.prototype._displayTotalMembersCountOrError=function(){return r.createElement(m.Label,{className:v.css("od-Notify-totalMembersCount")},this._computeTotalMemberCount()>=C?this._tooManyRecipientsErrorString():this._displayTotalMemberCountString())};t.prototype._displayTotalGroupMemberCountString=function(){var e=this._computeTotalGroupsMembersCount();return 0===e?"":d.format(l.default.notifyGroupsMembersTotalPlus,e)};t.prototype._displayTotalGroupsMembersCount=function(){return r.createElement(m.Label,{className:v.css("od-Notify-totalGroupsMembersCount")},this._displayTotalGroupMemberCountString())};t.prototype._renderWarning=function(){var e=this._computeTotalMemberCount(),t=d.format(l.default.notifyLargeRecipientWarning,e);return e>20&&e<C&&r.createElement("div",{className:"od-Notify-recipientWarning-container"},r.createElement(N.MessageBar,{className:v.css("od-Notify-recipientWarning"),messageBarType:N.MessageBarType.severeWarning,isMultiline:!0},t))};t.prototype._sendButtonError=function(){return r.createElement(m.Label,null,l.default.notifySendButtonError)};t.prototype._renderNotifyMain=function(){var e=this.state,t=this.props,n=e.showActivityIndicator?" blocker":"",i=E.truncateItemNameForShareNotification(this.props.sharingInformation.item.name,10);return r.createElement("div",{className:"od-Notify"+n},r.createElement("div",{className:"od-Notify-headerAndMessage"},r.createElement(u.Header,{clientId:t.clientId,viewState:9}),r.createElement(m.Label,{className:v.css("od-Notify-message")},d.format(l.default.notifyMessage,i))),this._renderWarning(),!e.isExpanded&&r.createElement("div",null,r.createElement("div",{className:v.css("od-Notify-horizontalLine")}),r.createElement(g.Link,{onClick:this._onExpandClick,className:v.css("od-Notify-show-link")},l.default.sendNotifyLinkExpandLink)),e.isExpanded&&r.createElement("div",null,this._renderGroups(e.groups),this._renderPeople(e.people),this._renderPeoplePicker(),r.createElement("div",{className:v.css("od-Notify-sendNotification-button")},r.createElement(w.default,{ctaLabel:l.default.sendNotifyLinkButton,currentSettings:t.currentSettings,errorMessage:this._allRecipients().length<1||this._computeTotalMemberCount()>=C?this._sendButtonError():e.peoplePickerError,linkRecipients:this._allRecipients(),maximumMessageLength:1,maximumSubjectLength:1,messageText:"",subjectText:"",onSendLinkClicked:this._sendNotification,permissionsMap:e.permissionsMap,sendButtonType:S.default.button,sharingInformation:t.sharingInformation})),this._displayTotalMembersCountOrError()))};t.prototype._renderViews=function(){switch(this.state.viewState){case 3:return this._renderNotification();default:return this._renderNotifyMain()}};t.prototype.render=function(){var e=this.state.showActivityIndicator?" blocker":"";return r.createElement("div",{className:"od-Notify"+e},this._renderViews(),this._renderActivityIndicator())};t.contextTypes={resize:i.func.isRequired,strings:i.object.isRequired,sharingStore:i.object.isRequired,shareClickTime:i.number};return t}(r.Component);t.Notify=k});
define("@ms/odsp-shared-sharing/lib/components/Notify/NotifyGroupRecipient",["require","exports","tslib","office-ui-fabric-react/lib/Checkbox","office-ui-fabric-react/lib/Tooltip","office-ui-fabric-react/lib/Utilities","react","prop-types","../Share.resx","./Notify.scss"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._onCheckboxChange=function(e,t){var n=r.props.group;n.checked=t;r.setState({group:n},function(){r._sharingStore.getEngagementHelper().log("Notify.GroupCheckboxClicked",r.props.engagementExtraData);r.props.updateCountCallback();r.props.updateCheckboxForGroup(n)})};r._sharingStore=n.sharingStore;r.state={group:t.group};return r}t.prototype.UNSAFE_componentWillMount=function(){this._sharingStore.fetchMemberCount(this.props.group)};t.prototype.componentDidMount=function(){this._sharingStore.addListener(this.props.updateCountCallback)};t.prototype._renderGroup=function(){var e=this.state.group,t=e.disabled;return o.createElement(r.Checkbox,{id:e.email,boxSide:"start",label:t?e.name+" ("+a.default.notifyGroupReachedAllowedLimit+")":e.name,checked:e.checked,defaultChecked:!1,onChange:this._onCheckboxChange,className:s.css("od-Notify-group-checkbox"),disabled:e.disabled})};t.prototype.render=function(){var e=this.state.group,t=e.disabled;return o.createElement(i.TooltipHost,{className:s.css("od-Notify-group-recipient"),id:e.email,content:t?e.name+" ("+a.default.notifyGroupReachedAllowedLimit+")":e.name,directionalHint:i.DirectionalHint.bottomCenter},this._renderGroup())};t.contextTypes={sharingStore:u.object.isRequired,strings:u.object.isRequired};return t}(o.Component);t.NotifyGroupRecipient=f});
define("@ms/odsp-shared-sharing/lib/components/Notify/Notify.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Notify{padding:0 4px}.od-Notify.blocker{position:relative}.od-Notify.blocker:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:.8}.od-Notify .ms-Checkbox-label{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-Notify-message{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;font-size:15px;padding:6px 0 4px 0;margin:0 3px 0 0}[dir=rtl] .od-Notify-message{margin:0 0 0 3px}.od-Notify-horizontalLine{border-bottom:1px solid "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";padding-top:10px}.od-Notify-show-link{display:block;font-size:14px;margin:8px 0 0 auto}[dir=rtl] .od-Notify-show-link{margin:8px auto 0 0}.od-Notify-sendNotification-button{margin:24px auto 6px 0}[dir=ltr] .od-Notify-sendNotification-button{text-align:right}[dir=rtl] .od-Notify-sendNotification-button{text-align:left}[dir=rtl] .od-Notify-sendNotification-button{margin:24px 0 6px auto}.od-Notify-group-recipient{display:-webkit-box;display:-ms-flexbox;display:flex}.od-Notify-group-checkbox .ms-Checkbox-checkbox{height:14px;width:14px}.od-Notify-PickerPersona-checkbox .ms-Checkbox-checkbox{height:14px;width:14px}.od-Notify-PickerPersona-checkbox{margin:0 0 0 auto}[dir=rtl] .od-Notify-PickerPersona-checkbox{margin:0 auto 0 0}.od-Notify-people-selectAll-checkbox .ms-Checkbox-checkbox{height:14px;width:14px;margin:0 10px 0 0;font-size:13px}[dir=rtl] .od-Notify-people-selectAll-checkbox .ms-Checkbox-checkbox{margin:0 0 0 10px}.od-Notify-recipientWarning-container{height:38px}.od-Notify-recipientWarning{position:absolute;background-color:rgba(255,185,0,.3)}[dir=ltr] .od-Notify-recipientWarning{left:0}[dir=rtl] .od-Notify-recipientWarning{right:0}.od-Notify-recipientWarning .ms-MessageBar-content{height:43px;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.ms-PickerItem-content{max-width:250px}.od-Notify-PickerPersona-container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.od-Notify-PickerPersona{border-radius:16px;position:relative;display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;vertical-align:top;white-space:nowrap;cursor:default}.od-Notify-PickerPersona .ms-Persona-secondaryText{font-size:11px}.od-Notify-PickerPersona.is-listbelow{width:100%}.od-Notify-groupLabel{font-weight:600;font-size:13px}.od-Notify-totalGroupsMembersCount{font-size:11px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";padding:0 0 12px}.od-Notify-totalMembersCount{font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";padding:6px 0;margin:0 0 0 auto}[dir=ltr] .od-Notify-totalMembersCount{text-align:right}[dir=rtl] .od-Notify-totalMembersCount{text-align:left}[dir=rtl] .od-Notify-totalMembersCount{margin:0 auto 0 0}.od-Notify-groups-expand{height:26px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;margin:14px 0 0}.od-Notify-group-expand-icon .ms-Button-icon{font-size:12px}.od-Notify-groups-listItem{margin:5px 1px}.od-Notify-groups-recipient-container{max-height:145px;overflow-x:hidden}.od-Notify-groups-recipient-container.expanded{margin-bottom:15px}.od-Notify-groups-recipient-container.expanded.scroll{overflow-y:scroll}.od-Notify-group-checkbox .ms-Checkbox-text{max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.od-Notify-peopleLabel{padding:5px 0 14px;font-weight:600;font-size:13px}.od-Notify-people-recipient-container{max-height:190px;overflow-x:hidden;padding:8px 0 10px;margin-top:6px}.od-Notify-people-recipient-container.scroll{overflow-y:scroll}.od-Notify-PeoplePicker .ms-Persona-primaryText{max-width:150px;overflow-y:hidden;overflow-x:hidden;white-space:nowrap;text-overflow:ellipsis}.od-Notify-PickerPersona-container{margin:8px 0}.od-Notify-groupMembersCount{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:11px}[dir=ltr] .od-Notify-groupMembersCount{margin-left:28px}[dir=rtl] .od-Notify-groupMembersCount{margin-right:28px}.od-Notify-groupMembersCount .ms-Spinner-circle{margin:0}"}])});
define("@ms/odsp-shared-sharing/lib/components/Notify/NotifyPersonRecipient",["require","exports","tslib","office-ui-fabric-react/lib/Checkbox","office-ui-fabric-react/lib/Persona","office-ui-fabric-react/lib/Utilities","react","prop-types","./Notify.scss"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._onCheckboxChange=function(e,t){var n=r.props.person;n.checked=t;r.setState({person:n});r.context.sharingStore.getEngagementHelper().log("Notify.PersonCheckboxClicked",r.props.engagementExtraData);r.props.updateCheckboxForPerson(n)};r.state={person:t.person};return r}t.prototype.render=function(){var e=this.state.person;return o.createElement("div",{className:s.css("od-Notify-PickerPersona-container")},o.createElement(i.Persona,{imageUrl:e.image,text:e.name,secondaryText:e.job,showSecondaryText:!!e.job,size:i.PersonaSize.extraSmall,className:s.css("od-Notify-PickerPersona")}),o.createElement(r.Checkbox,{id:e.email,boxSide:"end",checked:e.checked,defaultChecked:!1,onChange:this._onCheckboxChange,className:s.css("od-Notify-PickerPersona-checkbox")}))};t.contextTypes={sharingStore:u.object.isRequired,strings:u.object.isRequired};return t}(o.Component);t.NotifyPersonRecipient=a});
define("@ms/odsp-shared-sharing/lib/components/AddPeople/AddPeople",["require","exports","tslib","../../interfaces/SharingInterfaces","react","./EditView/EditView","../Share.resx","../../components/ActivityIndicator/ActivityIndicator","office-ui-fabric-react/lib/Icon","../Header/Header","../../utilities/ShareCommunicationManager","prop-types","./AddPeople.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h;!function(e){e[e.edit=0]="edit";e[e.successGrantingPermissions=1]="successGrantingPermissions";e[e.successRequestingPermissions=2]="successRequestingPermissions";e[e.failure=3]="failure"}(h=t.AddPeopleView||(t.AddPeopleView={}));var p=function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t)||this;i._onLoading=function(e){i.setState(function(t,r){if(t.view===h.edit){var i=void 0;i=e.requestedAccess?o.default.activityRequestingAccess:e.notifiedRecipients?o.default.activityAddingAndNotifying:o.default.activityAdding;return n.__assign({},t,{loading:!0,message:i})}return t})};i._onSuccess=function(e){var t,n;if(e.requestedAccess){t=o.default.accessRequested;n=h.successRequestingPermissions}else{t=e.notifiedRecipients?o.default.addedAndNotified:o.default.added;n=h.successGrantingPermissions}i.setState({view:n,message:t,loading:!1})};i._onFailure=function(e){i.setState({view:h.failure,message:o.default.addFailed,loading:!1})};i._shareClickTime=r.shareClickTime;i.state={message:"",view:h.edit,loading:!1};return i}t.prototype.componentDidMount=function(){l.pageFinishedLoading(this._shareClickTime,this.props.clientId,r.Mode.addPeople,"")};t.prototype.render=function(){var e=this.state.loading?" blocker":"";return i.createElement("div",{className:"od-AddPeople"+e},this.renderView(),this.state.loading?i.createElement(u.ActivityIndicator,{message:this.state.message}):null)};t.prototype.renderView=function(){switch(this.state.view){case h.edit:return i.createElement(s.EditView,{sharingInformation:this.props.sharingInformation,clientId:this.props.clientId,onLoading:this._onLoading,onSuccess:this._onSuccess,onFailure:this._onFailure,currentSettings:this.props.currentSettings,onViewPolicyTipClicked:this.props.onViewPolicyTipClicked});case h.successGrantingPermissions:return this._renderSuccessGranting();case h.successRequestingPermissions:return this._renderSuccessRequesting();case h.failure:return this._renderFailure()}};t.prototype._renderSuccessGranting=function(){return i.createElement("div",{className:"od-AddPeople-Success"},i.createElement(f.Header,{clientId:this.props.clientId,viewState:9}),i.createElement(a.Icon,{className:"od-ShareNotification-icon",iconName:"CheckMark"}),i.createElement("p",{className:"od-AddPeople-SuccessMessage",role:"presentation"},this.state.message),i.createElement("input",{autoFocus:!0,className:"od-Share-screenReaderOnly",role:"alert","aria-live":"assertive","aria-label":this.state.message,value:this.state.message}))};t.prototype._renderSuccessRequesting=function(){return i.createElement("div",{className:"od-AddPeople-Success"},i.createElement(f.Header,{clientId:this.props.clientId,viewState:9}),i.createElement(a.Icon,{className:"od-ShareNotification-icon",iconName:"PeopleAlert"}),i.createElement("p",{className:"od-AddPeople-SuccessMessage",role:"presentation"},this.state.message),i.createElement("input",{autoFocus:!0,className:"od-Share-screenReaderOnly",role:"alert","aria-live":"assertive","aria-label":this.state.message,value:this.state.message}))};t.prototype._renderFailure=function(){return i.createElement("div",{className:"od-AddPeople-Failure"},i.createElement(f.Header,{clientId:this.props.clientId,viewState:9}),i.createElement("p",null,this.state.message))};t.contextTypes={shareClickTime:c.number};return t}(i.Component);t.AddPeople=p});
define("@ms/odsp-shared-sharing/lib/components/AddPeople/EditView/EditView",["require","exports","tslib","../../Header/Header","office-ui-fabric-react/lib/Button","react","react","../../Share.resx","../../PeoplePicker/PeoplePicker","../../RoleSelector/RoleSelector","../../../utilities/PeoplePickerHelper","office-ui-fabric-react/lib/TextField","office-ui-fabric-react/lib/Checkbox","prop-types","../../../utilities/ReviewPermissionExperimentHelper","./EditView.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(e){n.__extends(t,e);function t(t,r){var i,a=e.call(this,t)||this;a._peoplePickerWrapper=o.createRef();a._onPeoplePickerChange=function(e){a.setState(function(t,r){var i=l.renderPickerError({selectedItems:e,sharingLinkKind:1,canAddExternalPrincipal:r.sharingInformation.canAddExternalPrincipal,sharingInformation:r.sharingInformation,viewPolicyTipCallback:function(){return null}}),s=a.state.notifyRecipients||e.filter(function(e){return e.isExternal}).length>0;return n.__assign({},t,{people:e,notifyRecipients:s,errorMessage:i})})};a._onMessageChange=function(e,t){a.setState({messageText:t})};a._onRoleSelectorChange=function(e){a.setState({roleSelection:e})};a._onAllowEditChange=function(e,t){a.setState({notifyRecipients:t})};a._onAddButtonClick=function(){var e=a._peoplePickerWrapper.current.querySelector(".od-Share-PeoplePicker .ms-BasePicker-input");if(e&&e.value)a.setState(n.__assign({},a.state,{errorMessage:s.createElement("span",null,u.default.unresolvedTextError)}));else{var t=a.state.messageText||null;a._store.addPeople(a.state.people,a.state.roleSelection,a.userRequiresAccessApproval(),a.state.notifyRecipients,t);a.props.onLoading&&a.props.onLoading({notifiedRecipients:a.state.notifyRecipients,requestedAccess:a.userRequiresAccessApproval()})}};a._store=r.sharingStore;a._store.addListener(function(){var e=a._store.getAddPeopleResult();null!==e&&(e&&a.props.onSuccess?a.props.onSuccess({notifiedRecipients:a.state.notifyRecipients,requestedAccess:a.userRequiresAccessApproval()}):a.props.onFailure&&a.props.onFailure({notifiedRecipients:a.state.notifyRecipients,requestedAccess:a.userRequiresAccessApproval()}))});i=3===a.props.sharingInformation.userRole?2:a.props.sharingInformation.userRole;var f=l.renderPickerError({selectedItems:a.props.currentSettings.specificPeople,sharingLinkKind:1,canAddExternalPrincipal:a.props.sharingInformation.canAddExternalPrincipal,sharingInformation:a.props.sharingInformation,viewPolicyTipCallback:t.onViewPolicyTipClicked});a.state={people:[],messageText:"",roleSelection:i,notifyRecipients:!0,errorMessage:f};return a}t.prototype.render=function(){return s.createElement("div",{className:"od-AddPeople-Edit"},s.createElement("div",{className:"od-AddPeople-Edit-Header"},this._renderHeader()),s.createElement("div",{className:"od-AddPeople-Edit-Section"},this._renderPeoplePicker(),this._renderRoleSelector(),this._renderMessageArea(),this._renderNotificationSelector(),this._renderAddButton()))};t.prototype.isAddButtonEnabled=function(){return this.state.people.length>0&&null===this.state.errorMessage};t.prototype.userRequiresAccessApproval=function(){return this.props.sharingInformation.requiresAccessApproval};t.prototype.isUnverifiedExternal=function(e){return e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"===e.rawPersonData.EntityData.PrincipalType};t.prototype.numberSelectedUnverifiedExternals=function(){var e=this;return this.state.people.filter(function(t){return e.isUnverifiedExternal(t)}).length};t.prototype._renderPeoplePicker=function(){var e=this.state.people,t=l.getOversharingExternalsWarning(e),n=l.getOversharingGroupsWarning(e,0);return s.createElement("div",{className:"od-Share-PeoplePicker",ref:this._peoplePickerWrapper},s.createElement(a.default,{defaultSelectedItems:this.state.people,error:this.state.errorMessage,onChange:this._onPeoplePickerChange,oversharingExternalsWarning:t,oversharingGroupsWarning:n,pickerSettings:this.props.sharingInformation.peoplePickerSettings,sharingLinkKind:1,sharingInformation:this.props.sharingInformation,clientId:this.props.clientId,allowSPGroups:!0,disableGraph:!0,onResolvedSuggestions:null}))};t.prototype._renderHeader=function(){return s.createElement(r.Header,{clientId:this.props.clientId,item:this.props.sharingInformation.item,viewState:this.userRequiresAccessApproval()?11:10})};t.prototype._renderMessageArea=function(){if(this.state.notifyRecipients)return s.createElement(c.TextField,{className:"od-AddPeople-Message",disabled:!this.state.notifyRecipients,placeholder:u.default.messagePlaceholder,value:this.state.messageText,ariaLabel:u.default.messageAriaLabel,multiline:!0,resizable:!1,onChange:this._onMessageChange})};t.prototype._renderRoleSelector=function(){return s.createElement("div",{className:"od-AddPeople-RoleSelector"},s.createElement(f.RoleSelector,{onRoleChange:this._onRoleSelectorChange,role:this.state.roleSelection,ariaLabel:u.default.addPeopleRoleSelectorAriaLabel,item:this.props.sharingInformation.item,showReview:d.default.checkExperimentisOn()}))};t.prototype._renderNotificationSelector=function(){var e=this.numberSelectedUnverifiedExternals()>0;return s.createElement(h.Checkbox,{className:"od-AddPeople-NotificationSelector",disabled:e,label:u.default.notifyPeople,onChange:this._onAllowEditChange,checked:this.state.notifyRecipients})};t.prototype._renderAddButton=function(){var e=this.userRequiresAccessApproval()?u.default.requestAccessButtonLabel:u.default.addButtonLabel;return s.createElement(i.PrimaryButton,{disabled:!this.isAddButtonEnabled(),onClick:this._onAddButtonClick,className:"od-AddPeople-AddButton"},e)};t.contextTypes={sharingStore:p.object.isRequired};return t}(s.Component);t.EditView=v});
define("@ms/odsp-shared-sharing/lib/components/AddPeople/EditView/EditView.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-AddPeople-Edit-Header{width:100%;padding-bottom:12px}.od-AddPeople-Edit-Section{padding:0 16px 0 16px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap}.od-AddPeople-PeoplePicker{padding-bottom:12px}.od-AddPeople-Message{padding-bottom:12px}.od-AddPeople-Message div{border-color:transparent}.od-AddPeople-Message textarea{padding:0}.od-AddPeople-RoleSelector{padding-bottom:12px}.od-AddPeople-NotificationSelector{-ms-flex-item-align:start;align-self:flex-start;padding-bottom:12px}.od-AddPeople-AddButton{-ms-flex-item-align:start;align-self:flex-start}"}])});
define("@ms/odsp-shared-sharing/lib/components/AddPeople/AddPeople.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-AddPeople{padding-bottom:24px}.od-AddPeople.blocker{position:relative}.od-AddPeople.blocker:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:.8}.od-AddPeople-Success{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.od-AddPeople-Success .od-ShareNotification-icon{margin-top:24px}.od-AddPeople-Failure{padding:24px 16px 0 16px}"}])});
define("@ms/odsp-shared-sharing/lib/components/Error/Error",["require","exports","tslib","office-ui-fabric-react/lib/Icon","react","react","../Share.resx","office-ui-fabric-react/lib/Button","@ms/odsp-utilities/lib/clipboard/CopyHelper","prop-types","./Error.scss"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._errorMessage=s.createRef();r._onToggleDetailsClicked=function(){r.setState({areDetailsVisible:!r.state.areDetailsVisible})};r._onCopyToClipboardClicked=function(){a.copyToClipboard(r.props.sharingInformation.debugErrorMessage||"")};r._resize=n.resize;r.state={areDetailsVisible:!1};return r}t.prototype.componentDidUpdate=function(e,t){this._errorMessage.current&&this._errorMessage.current.focus();this._resize()};t.prototype.render=function(){var e=o.default,t=this.state.areDetailsVisible&&this.props.sharingInformation.debugErrorMessage?i.createElement("div",{className:"od-Share-error-technical"},i.createElement("h4",null," ",e.errorTechnicalDetails," "),i.createElement("div",null,this.props.sharingInformation.debugErrorMessage),i.createElement(u.Button,{className:"od-Share-error-copy",onClick:this._onCopyToClipboardClicked},e.errorCopyTechnicalDetails),i.createElement("span",{className:"od-Share-error-clear"})):null,n=this.props.showReportProblem?i.createElement("div",{className:"od-Share-error-report"},e.errorReportProblem):null,s=this.props.sharingInformation.debugErrorMessage?i.createElement("div",{className:"od-Share-error-details",onClick:this._onToggleDetailsClicked},this.state.areDetailsVisible?e.errorHideDetails:e.errorShowDetails,i.createElement(r.Icon,{iconName:this.state.areDetailsVisible?"ChevronUp":"ChevronDown",className:"od-Share-error-chevron"})):null;return i.createElement("div",{className:"od-Share-error",role:"alert",tabIndex:0,ref:this._errorMessage},i.createElement("h2",null," ",e.errorTitle," "),i.createElement("div",{className:"od-Share-error-message"},i.createElement("p",null," ",this.props.sharingInformation.errorMessage," "),this.props.sharingInformation.fixItUrl&&i.createElement("a",{href:this.props.sharingInformation.fixItUrl,target:"_blank"},o.default.fixIt),t),i.createElement("div",null,s,n))};t.contextTypes={resize:f.func.isRequired};return t}(i.Component);t.Error=l});
define("@ms/odsp-utilities/lib/clipboard/CopyHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.copyToClipboard=function(e){var t=document.createElement("input");t.setAttribute("type","text");t.setAttribute("value",e);document.body.appendChild(t);var n=!1;try{t.focus();t.select();n=document.execCommand("copy")}catch(e){}if(!n&&window.navigator&&window.navigator.clipboard)try{window.navigator.clipboard.writeText(t.value);n=!0}catch(e){}document.body.removeChild(t);return n}});
define("@ms/odsp-shared-sharing/lib/components/Error/Error.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share-error{padding:16px;font-size:14px;font-weight:400;word-break:break-word;margin-bottom:30px}.ms-Fabric .od-Share-error::-moz-focus-inner{border:0}.ms-Fabric .od-Share-error{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-Share-error:focus:after{content:'';position:absolute;top:0;right:0;bottom:0;left:0;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-Share-error:focus:after{border-color:ActiveBorder}}[dir=ltr] .od-Share-error-details{float:left}[dir=rtl] .od-Share-error-details{float:right}.od-Share-error-copy{margin-top:10px}[dir=ltr] .od-Share-error-copy{float:right}[dir=rtl] .od-Share-error-copy{float:left}.od-Share-error-clear{clear:both;display:block}.od-Share-error-message{min-height:50px}[dir=ltr] .od-Share-error-report{float:right}[dir=rtl] .od-Share-error-report{float:left}[dir=ltr] .od-Share-error-report{margin-right:5px}[dir=rtl] .od-Share-error-report{margin-left:5px}.od-Share-error-chevron{font-size:10px}[dir=ltr] .od-Share-error-chevron{margin-left:5px}[dir=rtl] .od-Share-error-chevron{margin-right:5px}.od-Share-error-technical{border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";padding:0 10px 10px 10px;margin-bottom:10px}[dir=rtl] .od-Share-error-technical{padding:0 10px 10px 10px}"}])});
define("@ms/odsp-shared-sharing/lib/components/Share/Share.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".Share-pdfIcon{color:#e60b0b}.Share-wordIcon{color:#2b579a}.Share-excelIcon{color:#217346}.Share-powerpointIcon{color:#d24726}@media screen and (-ms-high-contrast:active){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#1aebff}}@media screen and (-ms-high-contrast:black-on-white){.Share-excelIcon,.Share-pdfIcon,.Share-powerpointIcon,.Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:active){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#37006e}}@media screen and (-ms-high-contrast:black-on-white){.ms-ContextualMenu-item:hover .Share-excelIcon,.ms-ContextualMenu-item:hover .Share-pdfIcon,.ms-ContextualMenu-item:hover .Share-powerpointIcon,.ms-ContextualMenu-item:hover .Share-wordIcon{color:#1aebff}}.od-Share{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";min-width:320px;min-height:150px;overflow-y:auto;overflow-x:hidden}.isFluent .od-Share{min-width:340px}.od-Share.od-Share--hasActivity{position:relative}.od-Share.od-Share--hasActivity:after{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:.8}[dir=ltr] .od-Share .ms-Button+.ms-Button{margin-left:6px}[dir=rtl] .od-Share .ms-Button+.ms-Button{margin-right:6px}[dir=ltr] .isFluent .od-Share .ms-Button+.ms-Button{margin-left:13px}[dir=rtl] .isFluent .od-Share .ms-Button+.ms-Button{margin-right:13px}.od-Share a{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";text-decoration:none}.od-Share a:focus,.od-Share a:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-Share a:focus{outline:1px solid transparent}.ms-Fabric .isFluent .od-Share .ms-Button--default::-moz-focus-inner{border:0}.ms-Fabric .isFluent .od-Share .ms-Button--default{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .isFluent .od-Share .ms-Button--default:focus:after{content:'';position:absolute;top:2px;right:2px;bottom:2px;left:2px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}@media screen and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .isFluent .od-Share .ms-Button--default:focus:after{border-color:ActiveBorder}}@media screen and (-ms-high-contrast:active){.ms-Fabric .od-Share .ms-Button::-moz-focus-inner{border:0}.ms-Fabric .od-Share .ms-Button{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .od-Share .ms-Button:focus:after{content:'';position:absolute;top:-4px;right:-4px;bottom:-4px;left:-4px;pointer-events:none;border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}}@media screen and (-ms-high-contrast:active) and (-ms-high-contrast:active){.ms-Fabric.is-focusVisible .od-Share .ms-Button:focus:after{border-color:ActiveBorder}}.od-Share ul{list-style-type:none;list-style:none;margin:0;padding:0}.od-Share .ms-Icon--ExcelLogo:before{color:#217346}.od-Share .ms-Icon--OneNoteLogo:before{color:#5c2d91}.od-Share .ms-Icon--PowerPointLogo:before{color:#d24726}.od-Share .ms-Icon--WordLogo:before{color:#2b579a}.od-Share .ms-Icon--PDF:before{color:#d24726}.od-Share.icon-Chat{color:#6264a7;background:#f6f6fa;border:1px solid #6264a7}.od-Share.icon-Mail{color:"},{theme:"teal",defaultValue:"#008272"},{rawString:";background:#f0f5f7;border:1px solid "},{theme:"teal",defaultValue:"#008272"},{rawString:"}.od-Share .icon-Globe{color:#0b6a0b;background:#f1f6f1;border:1px solid #0b6a0b}.isFluent .od-Share .icon-Globe{color:#0b6a0b;border-color:#0b6a0b;background-color:#f1f6f1}.od-Share .icon-Work{color:#004e8c;background:#f0f5f8;border:1px solid #004e8c}.isFluent .od-Share .icon-Work{color:#004e8c;border-color:#004e8c;background-color:#f0f5f8}.od-Share .icon-PeopleAdd{color:#393939;background:#f2f2f2;border:1px solid #393939}.isFluent .od-Share .icon-PeopleAdd{color:#201f1e;border-color:#201f1e;background-color:RGBA(#201f1e,.06)}.od-Share .icon-SecurityGroup{color:#8e562e;background:#f4efeb;border:1px solid #8e562e}.isFluent .od-Share .icon-SecurityGroup{color:#a4262c;border-color:#a4262c;background-color:RGBA(#a4262c,.06)}.od-Share .ms-Tooltip{pointer-events:none}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){.od-Share{width:320px}}button.od-Share-backButton{background:0 0;border:none;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";cursor:pointer;font-size:16px;padding:0;position:absolute;top:8px}[dir=ltr] button.od-Share-backButton{left:10px}[dir=rtl] button.od-Share-backButton{right:10px}html[dir=rtl] button.od-Share-backButton{-webkit-transform:scale(-1,1);transform:scale(-1,1)}button.od-Share-backButton:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-Share-spinnerHolder{-webkit-box-align:center;-ms-flex-align:center;align-items:center;display:-webkit-box;display:-ms-flexbox;display:flex;height:150px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.od-Share-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.teams .ms-Checkbox-checkbox{border-radius:4px}.teams .ms-Button.ms-Button--default,.teams .ms-Button.ms-Button--primary{border-radius:3px;min-width:96px}.teams .ms-Button--default{-webkit-box-shadow:0 2px 2px 0 rgba(37,36,36,.15);box-shadow:0 2px 2px 0 rgba(37,36,36,.15);border:1px solid rgba(37,36,36,.15)}.teams .ms-Button--primary{-webkit-box-shadow:0 2px 2px 0 rgba(98,100,167,.4);box-shadow:0 2px 2px 0 rgba(98,100,167,.4)}.teams .ms-Button--primary.is-disabled{-webkit-box-shadow:none;box-shadow:none;border:none}"}])});
define("odsp-next/controls/sharing/share/react/Share",["require","exports","tslib","prop-types","@ms/odsp-shared-sharing/lib/components/Share/index","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-shared-sharing/lib/interfaces/SharingInterfaces","react","@ms/odsp-utilities/lib/icons/ItemType","@ms/odsp-utilities/lib/browser/PlatformDetection","@ms/odsp-utilities/lib/browser/ResponsiveUI","office-ui-fabric-react/lib/FocusTrapZone","../../../../controls/sharing/shareByEmail/Sharing.resx","@ms/odsp-shared-sharing/lib/utilities/ClientIdHelper","@ms/odsp-utilities/lib/string/StringHelper","es6-promise/auto"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._resize=function(){var e=n.refs.share;if(e){n._onResize&&n._onResize();var t=n._maxHeight,r=e.clientHeight>t?t:e.clientHeight,i=e.clientWidth;if(r>0&&i>0)try{window.external.Resize(i,r)}catch(e){var s={name:"share_resize",width:i,height:r};window.parent.postMessage(JSON.stringify(s),"*")}}};n._dismiss=function(){try{window.external.Dismiss()}catch(e){window.parent.postMessage(JSON.stringify({name:"share_dismiss"}),"*")}};var r=window._sharingContextInfo;n._copyLinkShortcut=t.copyLinkShortcut;n._onDismiss=t.onDismiss;n._dismissed=!1;n._shareDismissEnabled=!s.Killswitch.isActivated("7541C104-321A-49F2-8350-DC1343D6F61B","5/16/2019","Fix share command refresh bug");n._onResize=t.onResize;n._peoplePickerProvider=t.peoplePickerProvider;n._mode=t.mode||(n._copyLinkShortcut?o.Mode.copy:o.Mode.share);n._messageText=t.messageText;n._sharingStore=t.sharingStore;n._premiumLearnMore=t.premiumLearnMore;n._goPremium=t.goPremium;n._platformDetection=new f.default;n._breakpoint=l.default.DEFAULT_BREAKPOINTS[l.default.determineWindowSize(window.innerWidth)];if(!t.noMaxHeightRestriction){var i=n.props.maxHeight;n._maxHeight=i<650?i:650}var u=0,c=" ",p=" ",v=" ",m=0;if(t.item&&t.item.properties){var g=t.item.properties,y=g.ItemChildCount?parseInt(g.ItemChildCount,10):0,b=g.FolderChildCount?parseInt(g.FolderChildCount,10):0;u=t.item.type===a.default.OneNote?0:y+b;c=t.item.name;p=t.item.extension;v=t.item.appMap;m=t.item.type}else if(r){c=r.itemName||" ";u=r.itemCount||0;p=r.itemExtension;v=r.itemAppmap;m=r.itemType}t.items&&t.items.length>1&&(c=d.format(h.strings.SharingBundleTempName,t.items.length));n._sharingItemInformation={name:c,childCount:u,hasDlpPolicy:void 0,extension:p,appmap:v,itemType:m};return n}t.prototype.getChildContext=function(){return{peoplePickerProvider:this._peoplePickerProvider,resize:this._resize,onDismiss:this._onDismiss||this._dismiss,sharingStore:this._sharingStore,platformDetection:this._platformDetection,breakpoint:this._breakpoint,premiumLearnMore:this._premiumLearnMore,goPremium:this._goPremium,shareClickTime:window._sharingStartTime||Date.now()}};t.prototype.render=function(){return this._sharingStore?u.createElement("div",{className:"od-share-v3",ref:"share",role:"dialog","aria-label":h.strings.ShareText},this._renderShareComponent()):null};t.prototype.componentWillUnmount=function(){this._shareDismissEnabled&&this._shareDismiss()};t.prototype._shareDismiss=function(){if(!this._dismissed&&this._onDismiss){this._dismissed=!0;this._onDismiss()}};t.prototype._renderShareComponent=function(){var e=this.props,t=u.createElement(i.Share,{copyLinkShortcut:this._copyLinkShortcut,shareId:e.shareId,theme:e.theme,clientId:e.clientId||e.sharingProvider.getClientId(),scenarioId:e.scenarioId||"",omitCustomLabeledAudience:e.omitCustomLabeledAudience,customLabeledAudienceConfig:e.customLabeledAudienceConfig,showExistingAccessOption:!!e.sharingProvider&&e.sharingProvider.supportsExistingAccessOption(e.item),onManageAccessClicked:e.onManageAccessClicked,hideShareDialogOverflowButton:e.hideShareDialogOverflowButton,maxHeight:this._maxHeight,mode:this._mode,messageText:this._messageText,useVroomCreateDefaultLink:this._mode===o.Mode.copy&&p.isTeams(e.clientId),sharingItemInformation:this._sharingItemInformation,hideElementsInManageAccess:this.props.hideElementsInManageAccess,shareCommandsExperiment:this.props.shareCommandsExperiment,preferCustomLabeledAudience:this.props.preferCustomLabeledAudience,invokeManageAccess:this.props.invokeManageAccess});return e.useFocusTrap?u.createElement(c.FocusTrapZone,{isClickableOutsideFocusTrap:!0},t):t};t.childContextTypes={peoplePickerProvider:r.object.isRequired,resize:r.func.isRequired,onDismiss:r.func,sharingStore:r.object.isRequired,platformDetection:r.object.isRequired,breakpoint:r.object.isRequired,premiumLearnMore:r.func,goPremium:r.func,shareClickTime:r.number};return t}(u.Component);t.default=v});
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define("es6-promise/auto",[],e):t.ES6Promise=e()}(this,function(){"use strict";function t(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}function e(t){return"function"==typeof t}function n(t){B=t}function r(t){G=t}function o(){return function(){return process.nextTick(a)}}function i(){return"undefined"!=typeof z?function(){z(a)}:c()}function s(){var t=0,e=new J(a),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function u(){var t=new MessageChannel;return t.port1.onmessage=a,function(){return t.port2.postMessage(0)}}function c(){var t=setTimeout;return function(){return t(a,1)}}function a(){for(var t=0;t<W;t+=2){var e=V[t],n=V[t+1];e(n),V[t]=void 0,V[t+1]=void 0}W=0}function f(){try{var t=Function("return this")().require("vertx");return z=t.runOnLoop||t.runOnContext,i()}catch(e){return c()}}function l(t,e){var n=this,r=new this.constructor(p);void 0===r[Z]&&O(r);var o=n._state;if(o){var i=arguments[o-1];G(function(){return P(o,r,i,n._result)})}else E(n,r,t,e);return r}function h(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(p);return g(n,t),n}function p(){}function v(){return new TypeError("You cannot resolve a promise with itself")}function d(){return new TypeError("A promises callback cannot return that same promise.")}function _(t){try{return t.then}catch(e){return nt.error=e,nt}}function y(t,e,n,r){try{t.call(e,n,r)}catch(o){return o}}function m(t,e,n){G(function(t){var r=!1,o=y(n,e,function(n){r||(r=!0,e!==n?g(t,n):S(t,n))},function(e){r||(r=!0,j(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,j(t,o))},t)}function b(t,e){e._state===tt?S(t,e._result):e._state===et?j(t,e._result):E(e,void 0,function(e){return g(t,e)},function(e){return j(t,e)})}function w(t,n,r){n.constructor===t.constructor&&r===l&&n.constructor.resolve===h?b(t,n):r===nt?(j(t,nt.error),nt.error=null):void 0===r?S(t,n):e(r)?m(t,n,r):S(t,n)}function g(e,n){e===n?j(e,v()):t(n)?w(e,n,_(n)):S(e,n)}function A(t){t._onerror&&t._onerror(t._result),T(t)}function S(t,e){t._state===$&&(t._result=e,t._state=tt,0!==t._subscribers.length&&G(T,t))}function j(t,e){t._state===$&&(t._state=et,t._result=e,G(A,t))}function E(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+tt]=n,o[i+et]=r,0===i&&t._state&&G(T,t)}function T(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?P(n,r,o,i):o(i);t._subscribers.length=0}}function M(t,e){try{return t(e)}catch(n){return nt.error=n,nt}}function P(t,n,r,o){var i=e(r),s=void 0,u=void 0,c=void 0,a=void 0;if(i){if(s=M(r,o),s===nt?(a=!0,u=s.error,s.error=null):c=!0,n===s)return void j(n,d())}else s=o,c=!0;n._state!==$||(i&&c?g(n,s):a?j(n,u):t===tt?S(n,s):t===et&&j(n,s))}function x(t,e){try{e(function(e){g(t,e)},function(e){j(t,e)})}catch(n){j(t,n)}}function C(){return rt++}function O(t){t[Z]=rt++,t._state=void 0,t._result=void 0,t._subscribers=[]}function k(){return new Error("Array Methods must be provided an Array")}function F(t){return new ot(this,t).promise}function Y(t){var e=this;return new e(U(t)?function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function q(t){var e=this,n=new e(p);return j(n,t),n}function D(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function K(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function L(){var t=void 0;if("undefined"!=typeof global)t=global;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;if(n){var r=null;try{r=Object.prototype.toString.call(n.resolve())}catch(e){}if("[object Promise]"===r&&!n.cast)return}t.Promise=it}var N=void 0;N=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var U=N,W=0,z=void 0,B=void 0,G=function(t,e){V[W]=t,V[W+1]=e,W+=2,2===W&&(B?B(a):X())},H="undefined"!=typeof window?window:void 0,I=H||{},J=I.MutationObserver||I.WebKitMutationObserver,Q="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),R="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,V=new Array(1e3),X=void 0;X=Q?o():J?s():R?u():void 0===H&&"function"==typeof require?f():c();var Z=Math.random().toString(36).substring(2),$=void 0,tt=1,et=2,nt={error:null},rt=0,ot=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(p),this.promise[Z]||O(this.promise),U(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?S(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&S(this.promise,this._result))):j(this.promise,k())}return t.prototype._enumerate=function(t){for(var e=0;this._state===$&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===h){var o=_(t);if(o===l&&t._state!==$)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===it){var i=new n(p);w(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},t.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===$&&(this._remaining--,t===et?j(r,n):this._result[e]=n),0===this._remaining&&S(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;E(t,void 0,function(t){return n._settledAt(tt,e,t)},function(t){return n._settledAt(et,e,t)})},t}(),it=function(){function t(e){this[Z]=C(),this._result=this._state=void 0,this._subscribers=[],p!==e&&("function"!=typeof e&&D(),this instanceof t?x(this,e):K())}return t.prototype["catch"]=function(t){return this.then(null,t)},t.prototype["finally"]=function(t){var e=this,n=e.constructor;return e.then(function(e){return n.resolve(t()).then(function(){return e})},function(e){return n.resolve(t()).then(function(){throw e})})},t}();return it.prototype.then=l,it.all=F,it.race=Y,it.resolve=h,it.reject=q,it._setScheduler=n,it._setAsap=r,it._asap=G,it.polyfill=L,it.Promise=it,it.polyfill(),it});
define("odsp-next/bindings/focus/AutoFocusBinding",["require","exports","tslib","knockout","@ms/odsp-shared/lib/bindings/base/BaseBinding"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.applyBindingsToNode,o=r.virtualElements,u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=n,i=r.observables,u=r.bindingContext,a=r.element,f=function(){var e=document.createElement("a");e.href="javascript:;";e.className="ms-accessible";e.setAttribute("role","presentation");return e}();o.prepend(a,f);i.backgroundCompute(function(){f.focus()});s(f,{},u);return n}t.supportsVirtualElements=!0;return t}(i.default);t.default=u});
define("odsp-next/providers/sharing/react/SharingStore",["require","exports","tslib","../../../providers/peoplePicker/PeoplePickerProvider","../../../providers/sharing/SharingProvider","../../../providers/suiteNav/SuiteNavProvider","../../../providers/policyTip/PolicyTipProvider","@ms/odsp-shared-sharing/lib/store/odb/SharingStore"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t,n){return e.call(this,t,n)||this}t.dependencies={sharingProvider:i.resourceKey,suiteNavProvider:s.resourceKey,peoplePickerProvider:r.resourceKey,policyTipProvider:o.resourceKey};return t}(u.default);t.default=a});
define("@ms/odsp-shared-sharing/lib/store/odb/SharingStore",["require","exports","tslib","../../interfaces/SharingInterfaces","../../interfaces/enums/OutlookAvailability","@ms/odsp-datasources/lib/dataSources/roleAssignments/PrincipalType","@ms/odsp-utilities/lib/guid/Guid","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/events/EventGroup","../../components/Share.resx","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-utilities/lib/logging/events/Qos.event","../../utilities/ShareHelper","@ms/odsp-datasources/lib/interfaces/sharing/enums/ClientId","@ms/odsp-utilities/lib/uri/SimpleUri","../../utilities/ClientIdHelper","@ms/odsp-utilities/lib/browser/PlatformDetection","../../utilities/EngagementHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=function(){function e(e,t){var n=this;this._listeners=null;var r=e.item,s=e.sharingInformation,o=e.defaultRecipients,u=e.accessChecked,a=void 0===u||u,c=e.mode;this._item=r;this._mode=c;this._sharingContextInformation=e.sharingContextInformation;this._clientId=this._sharingContextInformation&&d.getClientId(this._sharingContextInformation.clientId);this._sharingProvider=t.sharingProvider;this._suiteNavProvider=t.suiteNavProvider||void 0;this._graphPeoplePickerHelper=t.graphPeoplePickerHelper;this._substratePeoplePickerHelper=t.substratePeoplePickerHelper;this._peoplePickerProvider=t.peoplePickerProvider;this._policyTipProvider=t.policyTipProvider||void 0;this._permissions=this._sharingContextInformation&&this._sharingContextInformation.rawInvite&&this._sharingContextInformation.rawInvite.value;this._sharingService=e.sharingService;this._firstShareLinkRequest=!0;this._listeners=[];this._groupsMemberCountCache=[];this._sharingInformationInvalidated=!1;this._groupMembersCountHash={};this._platformDetection=new g.default;this._engagementHelper=new y.EngagementHelper(e.telemetryManager);this._store={sharingInformation:s,sharingLinkCreated:null,companyName:this._sharingContextInformation&&this._sharingContextInformation.organizationName||l.default.companyNameFallback,groupsMemberCount:0,policyTipInfo:{info:null,actionResult:null},permissionsMap:{},invitedUsers:[],defaultLink:null,defaultRecipients:null,outlookAvailability:i.default.none,grantAccessResult:null,addPeopleResult:null,accessRequestCreated:!1,isValidatingDefaultRecipients:!1};if(o&&0!==o.length)this._resolveDefaultRecipients(o,a,c);else{this._eventGroup=new f.default(this);this._eventGroup.on(window,"message",function(e){if(e&&e.data)try{var t=JSON.parse(e.data);if("atMention_defaultRecipients"===t.name){var r=t.recipientIds;n._resolveDefaultRecipients(r,a,c)}}catch(e){}})}}e.prototype.getEngagementHelper=function(){return this._engagementHelper};e.prototype.addListener=function(e){this._listeners.push(e)};e.prototype.getSharingInformation=function(){return this._store.sharingInformation};e.prototype.isPeopleSharingLinksEnabled=function(){if(this._store.sharingInformation){var e=this._store.sharingInformation.sharingAbilities;return!!e&&(e.peopleSharingLinkAbilities.canManageEditLink.enabled||e.peopleSharingLinkAbilities.canManageReadLink.enabled)}return!1};e.prototype.showManageAccess=function(){return!this._clientId||(m.isODSP(this._clientId)||this._clientId===r.ClientId.wac||m.isTeams(this._clientId)||(m.isOfficeProduct(this._clientId)||this._clientId===r.ClientId.ngsc)&&this._platformDetection.isWindows)};e.prototype.fetchSharingInformation=function(e){var t=this;if(!this._store.sharingInformation||this._sharingInformationInvalidated||e&&!this._store.sharingInformation.hasPermissionsInformation){var n=(new Date).getTime(),r=!!this._sharingContextInformation||e;this._sharingProvider.getSharingInformation(this._item,r,!0).then(function(e){t._getSharingInformationStats={name:"GetSharingInformation",resultType:h.ResultTypeEnum.Success,duration:(new Date).getTime()-n};if(!t._store.sharingInformation||!t._store.sharingInformation.error){t._store.sharingInformation=e;t._fetchAdditionalAuthenticationTokens();t.fetchPolicyTipInformation();t._configureLinkIfShareId();t._emitChange()}},function(e){var r=5,i=e&&e.code,s=e&&e.status,o=l.default.getSharingInformationError,u=JSON.stringify(e||{});i?i.indexOf("-2147024809")>-1&&u&&u.indexOf("Item does not exist")>-1&&(r=3):s&&parseInt(s,10)>=500&&(r=2);t._getSharingInformationStats={name:"GetSharingInformation",resultType:h.ResultTypeEnum.Failure,duration:(new Date).getTime()-n,error:r};t._invokeShareStatsEvent();t._store.sharingInformation={error:r,errorCategory:1,errorMessage:o,debugErrorMessage:u,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,isGraphAvailable:!1,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,customizedExternalSharingServiceUrl:void 0};t._emitChange()})}else{this._getSharingInformationStats={name:"GetSharingInformationProvided",resultType:h.ResultTypeEnum.Success,duration:0};this._configureLinkIfShareId();this._emitChange()}};e.prototype.fetchMemberCount=function(e){var t=this;this._groupMembersCountHash[e.email]||this._peoplePickerProvider.getPickerEntityInformation(e).then(function(n){var r=n.totalMemberCount;t._groupMembersCountHash[e.email]=r;t._emitChange()}).catch(function(n){t._groupMembersCountHash[e.email]=null;t._emitChange()})};e.prototype.getMembersCounts=function(){return this._groupMembersCountHash};e.prototype.shareLink=function(e){var t=this,i=this._firstShareLinkRequest;this._firstShareLinkRequest=!1;var s=e.settings,o=e.recipients,u=e.emailMessage,f=e.emailSubject,p=e.copyLinkCommand,d=e.allRecipientsHaveAccess,v=e.shareId,g=e.inviteesToRemove;if(e.copyLinkCommand&&m.isTeams(this._clientId)&&this._mode===r.Mode.copy&&!this._sharingContextInformation.shareId&&this._sharingService&&(this._sharingContextInformation.itemUrl||this._sharingContextInformation.webAbsoluteUrl&&this._sharingContextInformation.serverRelativeItemUrl||this._sharingContextInformation.webAbsoluteUrl&&this._sharingContextInformation.uniqueId)&&i)this._getDefaultLink();else{var y=0,b=0,w=!1,E=(o=o||[]).map(function(e){1===e.entityType?b++:y++;e.rawPersonData&&e.rawPersonData.EntityData&&"UNVALIDATED_EMAIL_ADDRESS"===e.rawPersonData.EntityData.PrincipalType&&(w=!0);return{userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData}});E=this._dedupeRecipients(E);if(!c.Killswitch.isActivated("88cc94ae-ba5f-4552-aea0-f5a00a24ff6b","01/02/2019","Ensure share link is called for manage access")&&v&&v.length>0)this._shareLink(s,E,u,f,p,i,v,g);else{if((c.Killswitch.isActivated("099614d2-0712-466a-be0f-c1f1ec2ee793","08/13/2019","fix sharing to new external users incident")?this.isPeopleSharingLinksEnabled()&&s.audience!==r.SharingAudience.existing:this.isPeopleSharingLinksEnabled()&&(this._doesPSLSupportNewExternalUsers()||!w)&&s.audience!==r.SharingAudience.existing)&&!this._store.sharingInformation.requiresAccessApproval)this._shareLink(s,E,u,f,p,i,v,g);else if(1!==s.sharingLinkKind&&6!==s.sharingLinkKind)this._shareLink(s,E,u,f,p,i,v,g);else{var S=void 0;S=s.sharingRole?this._getRoleString(s.sharingRole):this._getRoleValue(s.isEdit);var x={items:[this._item],roleValue:S,sendEmail:void 0!==u,message:u,subject:f,requireSignIn:!0,propagateSharing:!0},T=this._store.sharingInformation.directLink;if(0===o.length||s.audience==r.SharingAudience.existing&&(this._mode===r.Mode.copy||this._mode==r.Mode.linkSettings)){this._invokeShareStatsEvent({name:"NoExtraCallReturnCanonical",duration:0,resultType:h.ResultTypeEnum.Success});this._handleSharedLink(T,p)}else{for(var N=!0,C=0,k=o;C<k.length;C++){var L=k[C];3!==this._store.permissionsMap[L.email]&&3!==this._store.permissionsMap[L.userId]&&(N=!1)}if(N||d){var A=(new Date).getTime();this._sharingProvider.emailWithoutPermissioning(E,this._item,u,f).done(function(e){var r=e.statusCode;if(0===r){t._invokeShareStatsEvent({name:"ForwardObjectLink",duration:(new Date).getTime()-A,resultType:h.ResultTypeEnum.Success});t._handleSharedLink(T,p)}else{var i=l.default,s=5,o=i.getSharingInformationError;if(-8===r){s=6;o=i.sharingOperationNotSupportedError}else if(-13===r){s=7;o=a.format(i.invalidEmailErrorMessage,e.invalidEmails.join(", "))}else if(-7===r){s=5;o=e.errorMessage}t._invokeShareStatsEvent({name:"ForwardObjectLink",duration:(new Date).getTime()-A,resultType:h.ResultTypeEnum.Failure,error:s});t._store.sharingInformation=n.__assign({},t._store.sharingInformation,{error:s,errorCategory:3,errorMessage:o});t._emitChange()}})}else{var O=(new Date).getTime();this._sharingProvider.share(E,x,!0).done(function(e){var i=e.statusCode;if(0===i){var o=T;0===y&&1===b&&e.invitationLink?o=n.__assign({},T,{url:e.invitationLink}):0===y&&b>1&&e.invitationLink&&(o=n.__assign({},T,{url:t._removeEmailQueryParamFromInvitationLink(e.invitationLink)}));s.audience===r.SharingAudience.customLabeledSpecificPeople&&(o=n.__assign({},o,{audience:r.SharingAudience.customLabeledSpecificPeople}));t._invokeShareStatsEvent({name:"ShareObject",resultType:h.ResultTypeEnum.Success,duration:(new Date).getTime()-O});t._handleSharedLink(o,p)}else if(1===i){t._store.accessRequestCreated=!0;t._invokeShareStatsEvent({name:"ShareObject",resultType:h.ResultTypeEnum.Success,duration:(new Date).getTime()-O});t._handleSharedLink(T,p)}else{var u=l.default,f=5,c=u.getSharingInformationError;if(-8===i){f=6;c=u.sharingOperationNotSupportedError}else if(-13===i){f=7;c=a.format(u.invalidEmailErrorMessage,e.invalidEmails.join(", "))}else if(-7===i){f=5;c=e.errorMessage}t._store.sharingInformation=n.__assign({},t._store.sharingInformation,{error:f,errorCategory:3,errorMessage:c});t._invokeShareStatsEvent({name:"ShareObject",resultType:h.ResultTypeEnum.Failure,duration:(new Date).getTime()-O,error:f});t._emitChange()}})}}}p&&this._store.defaultLink&&this._store.defaultLink.audience!==s.audience&&this._cleanupDefaultLink()}}};e.prototype.unshareLink=function(e,t){var n=this,r={item:this._item,kind:e,shareId:t};this._sharingProvider.unshareLink(r).done(function(e){if(!0===e){n._removeLinkByShareId(t);n._updateIsShared();n._emitChange()}})};e.prototype.getSharingLinkCreated=function(){return this._store.sharingLinkCreated};e.prototype.updatePermissions=function(e,t){var n=this;this._sharingProvider.updatePermissions2(e,this._item,t).done(function(t){var i=n._store.sharingInformation.sharingPrincipals;if(t.role===r.UpdatePermissionsRole.NONE){n._store.sharingInformation.sharingPrincipals=i.filter(function(t){return t.id!==e.id});n._updateIsShared();n._emitChange()}else for(var s=0,o=i;s<o.length;s++){var u=o[s];if(u.id===e.id){switch(t.role){case r.UpdatePermissionsRole.VIEW:u.role=1;break;case r.UpdatePermissionsRole.EDIT:u.role=2;break;case 6:u.role=6}n._emitChange()}}})};e.prototype.addPeople=function(e,t,n,r,i){var s=this,o=this._getRoleString(t),u={items:[this._item],roleValue:o,sendEmail:r,message:i,requireSignIn:!0,propagateSharing:!0};this._sharingProvider.share(e,u,!0).then(function(e){s._store.addPeopleResult=0===e.statusCode;s._emitChange()},function(){s._store.addPeopleResult=!1;s._emitChange()})};e.prototype.fetchSuiteNavInformation=function(){var e=this;if(this._suiteNavProvider)this._suiteNavProvider.loadData().then(function(t){var n=t.CompanyDisplayName||e._store.companyName,r=t?JSON.parse(t.ClientData):{HasEXOLicense:!1};e._store.companyName=n;e._store.outlookAvailability=r.HasEXOLicense?i.default.available:i.default.none;e._emitChange()});else{this._store.outlookAvailability=i.default.none;this._emitChange()}};e.prototype.getCompanyName=function(){return this._store.companyName};e.prototype.getOutlookAvailability=function(){return this._store.outlookAvailability};e.prototype.navigateToOwa=function(e,t){window.open(this._getOwaUrl(e,t),"_blank")};e.prototype.getNavId=function(){return this._sharingContextInformation&&this._sharingContextInformation.navId};e.prototype.fetchGroupsMemberCount=function(e){for(var t=this,n=0,r=function(e){var r={userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData,principalType:e.principalType};if(e.principalType===s.default.securityGroup){var o=i._groupsMemberCountCache[e.userId];void 0!==o?n+=o:i._peoplePickerProvider.getPickerEntityInformation(r).then(function(r){var i=r.totalMemberCount;t._groupsMemberCountCache[e.userId]=i;n+=i;t._store.groupsMemberCount=n;t._emitChange()}).catch(function(n){t._groupsMemberCountCache[e.userId]=null;t._emitChange()})}},i=this,o=0,u=e;o<u.length;o++){r(u[o])}this._store.groupsMemberCount=n;this._emitChange()};e.prototype.getGroupsMemberCount=function(){return this._store.groupsMemberCount};e.prototype.fetchPolicyTipInformation=function(){var e=this;if(this._policyTipProvider){if(this._store.policyTipInfo.info){this._emitChange();return}var t=this._store.sharingInformation;if(!t)return;if(!this._item)return;var n=!this._isPolicyTipFlagSet(this._item.policyTip,4),r=t.sharingAbilities;if(r){if(7!==(r&&r.directSharingAbilities.canAddExternalPrincipal.disabledReason)&&n)return}else if(n)return;this._policyTipProvider.getPolicyTip(this._item).then(function(t){if(t){e._store.policyTipInfo.info=t;e._emitChange()}})}};e.prototype.getPolicyTipInformation=function(){return this._store.policyTipInfo};e.prototype.updatePolicy=function(e,t){var n=this;if(this._policyTipProvider){var r={item:this._item,action:e};t&&(r.justification=t);this._policyTipProvider.updatePolicy(r).then(function(e){n._store.policyTipInfo.actionResult=e;n._sharingInformationInvalidated=!0;n.fetchSharingInformation(!0);n._emitChange()})}};e.prototype.checkPermissions=function(e,t){var n=this;if(0!==e.length){var r=[];this._recipients=[];for(var i=0,s=e;i<s.length;i++){var o=s[i];r.push({alias:c.Killswitch.isActivated("00bdc590-2d96-4d10-bb1c-66fb6cb59dfd")?o.email:o.userId||o.email});this._recipients.push(o.email)}t=t||this._store.invitedUsers;this._invitedUsers=[];for(var u=0,a=t;u<a.length;u++){var f=a[u];r.push({alias:f.email});this._invitedUsers.push(f.email)}var l=r.map(function(e){return e.alias});this._sharingProvider.checkPermissions(r,this._item).then(function(e){n._store.permissionsMap={};for(var t=0,r=e;t<r.length;t++){var i=r[t];n._invitedUsers.indexOf(i.inputEntity)>-1?n._store.permissionsMap[i.inputEntity]=i.hasAccess?3:2:n._recipients.indexOf(i.inputEntity)>-1?n._store.permissionsMap[i.inputEntity]=i.hasAccess?3:1:l.indexOf(i.inputEntity)>-1&&(n._store.permissionsMap[i.inputEntity]=i.hasAccess?3:1)}n._emitChange()})}else{this._store.permissionsMap={};this._emitChange()}};e.prototype.getPermissionsMap=function(){return this._store.permissionsMap};e.prototype.getDefaultRecipients=function(){return this._store.defaultRecipients};e.prototype.consumeDefaultRecipients=function(){this._store.defaultRecipients={isConsumed:!0,recipients:this._store.defaultRecipients.recipients}};e.prototype.grantAccess=function(e){var t=this,r=(e=e||[]).map(function(e){return{userId:e.userId,name:e.name,email:e.email,rawPersonData:e.rawPersonData}});r=this._dedupeRecipients(r);var i={items:[this._item],roleValue:this._getRoleValue(!0),sendEmail:!1,requireSignIn:!0,propagateSharing:!0};this._sharingProvider.share(r,i,!0).done(function(e){t._store=n.__assign({},t._store,{grantAccessResult:0===e.statusCode});t._emitChange()})};e.prototype.getGrantAccessResult=function(){return this._store.grantAccessResult};e.prototype.getAddPeopleResult=function(){return this._store.addPeopleResult};e.prototype.dispose=function(){if(this._eventGroup){this._eventGroup.dispose();this._eventGroup=void 0}};e.prototype.hasAccessRequestBeenCreated=function(){return this._store.accessRequestCreated};e.prototype.isValidatingDefaultRecipients=function(){return this._store.isValidatingDefaultRecipients};e.prototype._doesPSLSupportNewExternalUsers=function(){if(this._store.sharingInformation){var e=this._store.sharingInformation.sharingAbilities;return!!e&&e.peopleSharingLinkAbilities.canAddNewExternalPrincipals.enabled}return!1};e.prototype.resetPeoplePickerError=function(){this._store.sharingInformation.peoplePickerError=void 0;this._emitChange()};e.prototype._cleanupDefaultLink=function(){var e=this._store.defaultLink;if(e){this.unshareLink(e.sharingLinkKind,e.shareId);this._store.defaultLink=void 0}};e.prototype._emitChange=function(){for(var e=0,t=this._listeners;e<t.length;e++){(0,t[e])()}};e.prototype._fetchAdditionalAuthenticationTokens=function(){var e=this;if(this._store.sharingInformation){var t=this._graphPeoplePickerHelper&&this._graphPeoplePickerHelper.canUseGraph();t?this._graphPeoplePickerHelper.getGraphToken().then(function(n){t=!!n;e._store.sharingInformation.isGraphAvailable=t}):this._store.sharingInformation.isGraphAvailable=!1;var n=this._substratePeoplePickerHelper&&this._substratePeoplePickerHelper.canUseSubstrate();n?this._substratePeoplePickerHelper.getSubstrateToken().then(function(t){e._substratePeoplePickerHelper.init(t);n=!!t;e._store.sharingInformation.isTsAvailable=n}):this._store.sharingInformation.isTsAvailable=!1}};e.prototype._handleSharedLink=function(e,t){e.createdViaCopyLinkCommand=t||!1;this._store.sharingLinkCreated=e;this._updateIsShared();this._emitChange()};e.prototype._getRoleValue=function(e){return e?"role:1073741827":"role:1073741826"};e.prototype._getRoleString=function(e){return 6===e?"roletype:Reviewer":2===e?"role:1073741827":"role:1073741826"};e.prototype._configureLinkIfShareId=function(){var e=this,t=this._sharingContextInformation&&this._sharingContextInformation.shareId;if(t&&this._mode===r.Mode.copy){if("00000000-0000-0000-0000-000000000000"===t)this._store.sharingLinkCreated=this._store.sharingInformation.directLink;else{var n=this._store.sharingInformation.sharingLinks.filter(function(t){return t.isActive&&t.shareId===e._sharingContextInformation.shareId})[0];this._store.sharingLinkCreated=n||this._store.sharingInformation.directLink}this._store.sharingLinkCreated.createdViaCopyLinkCommand=!0}};e.prototype._removeLinkByShareId=function(e){this._store.sharingInformation.sharingLinks=this._store.sharingInformation.sharingLinks.map(function(t){if(e===t.shareId){t.expiration=null;t.isActive=!1;t.shareId=o.default.Empty;t.url=null;t.principals=[]}return t})};e.prototype._updateIsShared=function(){var e=this._store.sharingInformation;if(e){for(var t=e.sharingLinks,n=e.sharingPrincipals,r=!1,i=0,s=t;i<s.length;i++){var o=s[i];o.isActive&&1!==o.sharingLinkKind&&(r=!0)}r||(r=n.length>0);this._store.sharingInformation.isShared=r}};e.prototype._getOwaUrl=function(e,t){var n=location.origin.indexOf(".cn")===location.origin.length-3,r=location.origin.indexOf(".de")===location.origin.length-3,i="https://outlook.office.com/owa/";n?i="https://partner.outlook.cn/owa/":r&&(i="https://outlook.de/owa/");return i+"?body="+encodeURIComponent(t)+"&to="+e.join(";")+"&path=/mail/action/compose"};e.prototype._resolveDefaultRecipients=function(e,t,i){var s=this,o=e||[],a=[];this._store.isValidatingDefaultRecipients=e.length>0;if(!t){o=[];for(var f=[],l=0,c=e;l<c.length;l++){var h=c[l];f.push({alias:h})}a.push(this._sharingProvider.checkPermissions(f,this._item).then(function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];r.hasAccess||o.push(r.inputEntity)}}))}u.default.all(a).then(function(){if(0!==o.length){for(var e=[],t=[],a={principalSource:15,principalType:13,allowEmailAddresses:!0,filterExternalUsers:!1,maximumEntitySuggestions:1,allowSharePointGroups:!1,forceResolve:!0},f=0,l=o;f<l.length;f++){var c=l[f];e.push(s._peoplePickerProvider.resolve(c,a).then(function(e){t.push(e)}))}u.default.all(e).then(function(){s._store.defaultRecipients={isConsumed:!1,recipients:t};s._store.isValidatingDefaultRecipients=!1;s._emitChange()},function(){s._store.defaultRecipients={isConsumed:!1,recipients:[]};s._store.isValidatingDefaultRecipients=!1;s._emitChange()})}else if(i===r.Mode.atMention){s._store=n.__assign({},s._store,{grantAccessResult:!0});s._emitChange()}})};e.prototype._removeEmailQueryParamFromInvitationLink=function(e){var t=e.split("?");if(t.length>1){for(var n=[],r=0,i=t[1].split("&");r<i.length;r++){var s=i[r];-1===s.indexOf("email=")&&n.push(s)}var o=n.join("&");return t[0]+"?"+o}return e};e.prototype._shareLink=function(e,t,i,s,o,u,a,f){var p=this,d={emailData:i,emailSubject:s,items:[this._item],recipients:t,settings:{sharingLinkKind:e.sharingLinkKind,expiration:e.expiration,updatePassword:e.updatePassword,password:e.password,shareId:a,inviteesToRemove:f}},v=(new Date).getTime(),m=new h.default({name:"SharingShareLink."+r.Mode[this._mode]+"."+(r.ClientId[this._clientId]||"unknown")});if(e.updatePassword||e.hasPassword&&e.shareId&&e.shareId.length>0){if(e.audience===r.SharingAudience.anyone){d.settings.sharingLinkKind=6;d.settings.allowAnonymousAccess=!0;e.sharingRole?d.settings.role=e.sharingRole:d.settings.role=e.isEdit?2:1}e.shareId&&e.shareId.length>0&&(d.settings.shareId=e.shareId)}if(e.audience===r.SharingAudience.anyone){d.settings.allowAnonymousAccess=!0;d.settings.restrictShareMembership=!1;e.isReview&&(d.settings.role=6)}else if(e.audience===r.SharingAudience.organization){d.settings.allowAnonymousAccess=!1;d.settings.restrictShareMembership=!1;e.isReview&&(d.settings.role=6)}if(e.preventDownload){d.settings.role=7;e.sharingRole=7;d.settings.sharingLinkKind=6}if(e.audience===r.SharingAudience.specificPeopleFlex||e.audience===r.SharingAudience.customLabeledSpecificPeople){d.settings.restrictShareMembership=!0;e.sharingRole?d.settings.role=e.sharingRole:d.settings.role=e.isEdit?2:1}this._sharingProvider.shareLink(d).done(function(t){if(t.error){p._store.sharingInformation=n.__assign({},p._store.sharingInformation,{error:t.error,errorCategory:2,debugErrorMessage:t.debugErrorMessage,errorMessage:l.default.getSharingInformationError});m.end({resultType:h.ResultTypeEnum.Failure});p._invokeShareStatsEvent({name:"ShareLink",resultType:h.ResultTypeEnum.Failure,duration:(new Date).getTime()-v,error:t.error});p._emitChange()}else{m.end({resultType:h.ResultTypeEnum.Success});p._invokeShareStatsEvent({name:"ShareLink",resultType:h.ResultTypeEnum.Success,duration:(new Date).getTime()-v});var i=t.link;e.audience===r.SharingAudience.customLabeledSpecificPeople&&(i.audience=r.SharingAudience.customLabeledSpecificPeople);i.sharingLinkKind===p._store.sharingInformation.defaultSharingLink.sharingLinkKind&&u&&o&&(c.Killswitch.isActivated("4FE917A1-5DBE-4BEB-8145-41D71F6F3673","9/20/2018","Use Share Id to test for existing link.")?p._store.sharingInformation.sharingLinks.forEach(function(e){e.audience!==i.audience||!c.Killswitch.isActivated("EC2649A7-64A3-4EDB-BB8F-71AC090528CB","9/20/2018","Scope comparison against existing share links")&&e.isEdit!==i.isEdit||e.isActive||(p._store.defaultLink=i)}):0===p._store.sharingInformation.sharingLinks.filter(function(e){return e.shareId===i.shareId}).length&&(p._store.defaultLink=i));if(a){p._sharingInformationInvalidated=!0;p.fetchSharingInformation(!0);p._emitChange()}else p._handleSharedLink(i,o)}})};e.prototype._invokeShareStatsEvent=function(e){var t=new h.default,n=this._getSharingInformationStats&&this._getSharingInformationStats.resultType;e&&(n=e.resultType);var i={mode:r.Mode[this._mode],clientId:r.ClientId[this._clientId]||"unknown",getData:JSON.stringify(this._getSharingInformationStats),setData:JSON.stringify(e)};t.end({name:"SharingStats",resultType:n,extraData:i})};e.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t};e.prototype._getDefaultLink=function(){var e=this,t=new h.default({name:"SharingGetDefaultLink"}),n=this._sharingContextInformation.itemUrl;if(!n&&this._sharingContextInformation.serverRelativeItemUrl){n=""+new v.default(this._sharingContextInformation.webAbsoluteUrl).authority+this._sharingContextInformation.serverRelativeItemUrl}var r=[];this._sharingContextInformation.defaultRecipients&&this._sharingContextInformation.defaultRecipients.length>0&&(r=this._sharingContextInformation.defaultRecipients.map(function(e){return{email:e}}));(this._permissions?u.default.resolve(this._permissions):this._sharingContextInformation.uniqueId?this._sharingService.getDefaultLinkByUniqueId(this._sharingContextInformation.uniqueId||"",r,!0):this._sharingService.getDefaultLink(n,r,!0)).then(function(n){var r=n[0],i=r.link,s=r.roles&&r.roles.indexOf("write")>=0;t.end({resultType:h.ResultTypeEnum.Success});e._handleSharedLink({allowsAnonymousAccess:"anonymous"===i.scope,audience:p.getSharingAudienceFromVroomScope(i.scope),expiration:r.expirationDateTime,isActive:!0,isEdit:s,principals:[],shareId:r.id,sharingLinkKind:p.getSharingLinkKindFromVroomScope(i.scope,s),url:i.webUrl,createdViaCopyLinkCommand:!0,invitees:[],updatePassword:!1,password:""},!0)},function(n){t.end({resultType:h.ResultTypeEnum.Failure,extraData:{error:n}});var r="";try{r=JSON.stringify(n)}catch(e){}e._store.sharingInformation={error:n,errorCategory:8,errorMessage:l.default.getSharingInformationError,debugErrorMessage:r,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,isGraphAvailable:!1,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,customizedExternalSharingServiceUrl:void 0};e._emitChange()})};e.prototype._dedupeRecipients=function(e){var t=[];if(c.Killswitch.isActivated("57ddc052-f331-4283-9af2-51d8ed07235d","08/15/2019","Deduping ShareLink Recipients"))t=e;else{var n={};e.forEach(function(e){n[e.userId]=e});Object.keys(n).forEach(function(e){t.push(n[e])})}return t};e.prototype.isPasswordModificationAllowed=function(){return!0};e.prototype.isExpirationDateModificationAllowed=function(){return!0};e.prototype.isPremiumExperienceAllowed=function(){return!0};e.prototype.isReportProblemSupported=function(){return!1};e.prototype.shouldInterruptCopyLink=function(e){return new u.default(function(e,t){e(!1)})};e.prototype.isPreventDownloadAllowed=function(){return!0};e.prototype.isBundleShare=function(){return!1};e.prototype.getSupportedAudienceOptions=function(){return[r.SharingAudience.anyone,r.SharingAudience.customLabeledSpecificPeople,r.SharingAudience.existing,r.SharingAudience.organization,r.SharingAudience.specificPeople,r.SharingAudience.specificPeopleFlex]};e.prototype.isSpecificPeopleExpirationAllowed=function(){return!1};e.prototype.showAudienceLearnMore=function(){return!0};return e}();t.default=b});
define("@ms/odsp-shared-sharing/lib/utilities/EngagementHelper",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Engagement.event","../interfaces/SharingInterfaces","./PeoplePickerHelper"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this._manager=e}e.prototype.opened=function(e){this.log("Opened",e)};e.prototype.linkSettingsOpened=function(e){this.log("LinkSettings.Opened",e)};e.prototype.linkSettingsApplyClicked=function(e){this.log("LinkSettings.ApplyClicked",e)};e.prototype.linkSettingsCancelClicked=function(e){this.log("LinkSettings.CancelClicked",e)};e.prototype.linkSettingsLearnMoreClicked=function(e){this.log("LinkSettings.LearnMoreClicked",e)};e.prototype.manageAccessOpened=function(e){this.log("ManageAccess.Opened",e)};e.prototype.shareCompleted=function(e){this.log("Completed",e)};e.prototype.sendACopyClicked=function(e){this.log("SendACopy.Clicked",e)};e.prototype.sendACopyOfficeClicked=function(e){this.log("SendACopy.OfficeClicked",e)};e.prototype.sendACopyPdfClicked=function(e){this.log("SendACopy.PdfClicked",e)};e.prototype.whoElseHasAccessClicked=function(e){this.log("WhoElseHasAccess.Clicked",e)};e.prototype.shareTargets=function(e){this.log("ShareTargets",e)};e.prototype.trackClickThru=function(e){this.log("ClickThruTracker",e)};e.prototype.externalSharingCslError=function(e){this.log("externalSharingCslError",e)};e.prototype.copyLinkInterruptOpened=function(e){this.log("copyLinkInterruptOpened",e)};e.prototype.copyLinkInterruptEditLinkChosen=function(e){this.log("copyLinkInterruptEditLinkChosen",e)};e.prototype.copyLinkInterruptExistingLinkChosen=function(e){this.log("copyLinkInterruptExistingLinkChosen",e)};e.prototype.copyLinkInterruptCancelled=function(e){this.log("copyLinkInterruptCancelled",e)};e.prototype.peoplePickerLinkedinSuggestionSelected=function(e,t){this.log("PeoplePicker.SuggestionSelected",n.__assign({},e,{linkedinSuggestionsSelectedCount:s.getLinkedInPeopleCount(t)}))};e.prototype.peoplePickerLinkedinSuggestions=function(e,t){this.log("PeoplePicker.Suggestions",n.__assign({},e,{linkedinSuggestionsCount:s.getLinkedInPeopleCount(t)}))};e.prototype.log=function(e,t){var s=n.__assign({},t,{clientId:i.ClientId[t.clientId],scenarioId:t.scenarioId,mode:i.Mode[t.mode],shareType:i.ShareType[t.shareType],audience:i.SharingAudience[t.audience],shareTargets:this._getFriendlyShareTargets(t.shareTargets)}),o={name:"ShareV3."+e,webTemplateId:t.webTemplateId?t.webTemplateId.toString():void 0,docId:t.itemUniqueId,extraData:s};(this._manager?r.Engagement.withManager(this._manager):r.Engagement).logData(o)};e.prototype._getFriendlyShareTargets=function(e){var t=[];if(e)for(var n=0,r=e;n<r.length;n++){var s=r[n];t.push(i.ShareType[s])}return t};return e}();t.EngagementHelper=o});
define("odsp-next/controls/notifyExperiment/NotifyExperiment.html",[],function(){return'\x3c!--ko if: showNotifyExperiment--\x3e\x3c!--ko autoFocus--\x3e\x3c!--ko focusTrap--\x3e<div class=od-Notify-callout data-bind="react: { componentType: shareComponent, props: shareComponentProps }"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});
define("odsp-next/controls/notifyExperiment/NotifyExperiment.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-Notify-callout{min-height:68px;width:260px}.od-Notify-callout:focus{outline:0}.od-Notify-callout .od-Share{min-width:inherit;min-height:inherit;width:inherit;height:inherit}.od-Notify-callout .od-Share .od-Share-spinnerHolder{min-width:inherit;min-height:inherit;width:inherit;height:inherit}"}])});
define("odsp-next/controls/operation/monitor/OperationMonitor.html",[],function(){return'<div class=OperationMonitor data-bind=preRender>\x3c!--ko ifnot: showNotifyExperiment()--\x3e\x3c!--ko if: groups().length--\x3e<div class=OperationMonitor-groups data-bind="foreach: groups"><div class=OperationMonitor-group><div class=OperationMonitor-item data-bind="class: css()">\x3c!--ko if: iconActions().length--\x3e<div class=OperationMonitor-itemIconActions data-bind="foreach: iconActions"><button class=OperationMonitor-itemIconAction data-bind="click: execute, attr: { title: title, \'aria-label\': title }, class: key"><i data-bind="css: iconCss"></i></button></div>\x3c!--/ko--\x3e<div class=OperationMonitor-itemName data-bind="bindableHtml: title"></div>\x3c!--ko if: showProgress--\x3e<div class=OperationMonitor-itemProgress data-bind="component: { name: $component.progressBarTagName, params: { progress: progress, description: description } }"></div>\x3c!--/ko--\x3e\x3c!--ko if: showDescription--\x3e<div class=OperationMonitor-itemDescription data-bind="text: description"></div>\x3c!--/ko--\x3e\x3c!--ko if: buttonActions().length--\x3e<div class=OperationMonitor-itemButtonActions data-bind="foreach: buttonActions"><button class="od-Button OperationMonitor-itemButtonAction" data-bind="click: execute"><span class=od-Button-label data-bind="text: title"></span></button></div>\x3c!--/ko--\x3e<div class=od-Share-Link data-bind="control: shareAfterUpload, visible: showShareButton()"></div></div>\x3c!--ko if: operations().length--\x3e<hr aria-hidden=true><div class=OperationMonitor-items data-bind="foreach: operations"><div class=OperationMonitor-item data-bind="class: css(), css: { \'OperationMonitor-item--icon\': !!iconName }">\x3c!--ko if: iconActions().length--\x3e<div class=OperationMonitor-itemIconActions data-bind="foreach: iconActions"><button class=OperationMonitor-itemIconAction data-bind="click: execute, attr: { title: title, \'aria-label\': title }, class: key"><i data-bind="css: iconCss"></i></button></div>\x3c!--/ko--\x3e<div class=OperationMonitor-itemType data-bind="component: { name: $component.fileTypeIconTagName, params: { desiredSize: $component.isFluentFlight ? 32 : 48, iconName: iconName } }"></div><div class=OperationMonitor-itemName data-bind="text: title"></div>\x3c!--ko if: showProgress--\x3e<div class=OperationMonitor-itemProgress data-bind="component: { name: $component.progressBarTagName, params: { progress: progress, description: description } }"></div>\x3c!--/ko--\x3e<div class=OperationMonitor-itemDescription data-bind="text: description"></div>\x3c!--ko if: buttonActions().length--\x3e<div class=OperationMonitor-itemButtonActions data-bind="foreach: buttonActions"><button class="od-Button OperationMonitor-itemButtonAction" data-bind="click: execute"><span class=od-Button-label data-bind="text: title"></span></button></div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if: showViewAll--\x3e<button class=od-OperationMonitor-viewAll data-bind="click: onClickViewAll, text: viewAllText"></button>\x3c!--/ko--\x3e<span class=ms-accessible data-bind="text: showActionDetailsAccessibleHintText"></span>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: groups().length--\x3e<p role=alert class=od-OperationMonitor-empty data-bind="text: noOperationsText"></p>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot: hideNotifyExperimentInProgressPane--\x3e<div class=od-notify-experiment data-bind="control: notifyExperimentSpecification, visible: showNotifyExperiment()"></div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/operation/monitor/OperationMonitor.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".OperationMonitor hr{border:none;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";margin:8px 0 16px 0}html[dir=rtl] .OperationMonitor hr{margin:8px 0 16px 0}.isFluent .od-Panel-content .OperationMonitor-group>.OperationMonitor-item{margin-bottom:42px}.OperationMonitor-group:not(:last-child){padding-bottom:32px}.OperationMonitor-items .OperationMonitor-item:not(:last-child){margin-bottom:16px}.OperationMonitor-item{padding:0 40px 0 0}html[dir=rtl] .OperationMonitor-item{padding:0 0 0 40px}.isFluent .OperationMonitor-item{padding:0 28px 0 0}html[dir=rtl] .isFluent .OperationMonitor-item{padding:0 0 0 28px}.OperationMonitor-item--icon .OperationMonitor-itemType{display:block}[dir=ltr] .OperationMonitor-item--icon{padding-left:56px}[dir=rtl] .OperationMonitor-item--icon{padding-right:56px}[dir=ltr] .isFluent .OperationMonitor-item--icon{padding-left:40px}[dir=rtl] .isFluent .OperationMonitor-item--icon{padding-right:40px}.OperationMonitor-itemName{font-size:14px;font-weight:400;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;padding-top:4px;line-height:20px}.OperationMonitor-itemProgress{padding:8px 0}.OperationMonitor-itemDescription{font-size:14px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:11px;line-height:18px}.isFluent .OperationMonitor-itemDescription{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.OperationMonitor-item--failed .OperationMonitor-itemDescription{color:#a80000;font-size:11px;word-wrap:break-word}.OperationMonitor-itemType{display:none;width:48px;height:48px;text-align:center;box-sizing:border-box;overflow:hidden;line-height:48px;margin-top:8px}html[dir=ltr] .OperationMonitor-itemType{float:left}html[dir=rtl] .OperationMonitor-itemType{float:right}[dir=ltr] .OperationMonitor-itemType{margin-left:-56px}[dir=rtl] .OperationMonitor-itemType{margin-right:-56px}.isFluent .OperationMonitor-itemType{width:32px;height:32px;line-height:32px}[dir=ltr] .isFluent .OperationMonitor-itemType{margin-left:-40px}[dir=rtl] .isFluent .OperationMonitor-itemType{margin-right:-40px}.OperationMonitor-item:after{display:table;width:100%;content:'';clear:both}.OperationMonitor-itemIconActions{width:32px}html[dir=ltr] .OperationMonitor-itemIconActions{float:right}html[dir=rtl] .OperationMonitor-itemIconActions{float:left}[dir=ltr] .OperationMonitor-itemIconActions{margin-right:-40px}[dir=rtl] .OperationMonitor-itemIconActions{margin-left:-40px}.OperationMonitor-itemIconAction{width:32px;height:32px;text-align:center;padding-top:12px;text-align:center;box-sizing:border-box;overflow:hidden;background:0 0;border:0;cursor:pointer}.OperationMonitor-itemIconAction .ms-Icon{-ms-transform:translate(0,-50%);transform:translate(0,-50%);display:block;font-size:14px}.isFluent .OperationMonitor-itemIconAction .ms-Icon{font-size:12px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.OperationMonitor-itemIconAction.cancel{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.OperationMonitor-itemButtonActions{width:218px}html[dir=ltr] .OperationMonitor-itemButtonActions{clear:right}html[dir=rtl] .OperationMonitor-itemButtonActions{clear:left}[dir=ltr] .OperationMonitor-itemButtonActions{margin-right:-40px}[dir=rtl] .OperationMonitor-itemButtonActions{margin-left:-40px}.OperationMonitor-itemButtonAction.od-Button{margin-top:6px}.OperationMonitor-itemButtonAction.od-Button .od-Button{padding:4px 16px 6px 16px}html[dir=rtl] .OperationMonitor-itemButtonAction.od-Button .od-Button{padding:4px 16px 6px 16px}.OperationMonitor-itemButtonAction.od-Button .od-Button-label{font-size:12px}[dir=ltr] .OperationMonitor-itemButtonAction.od-Button+.od-Button{margin-left:0}[dir=rtl] .OperationMonitor-itemButtonAction.od-Button+.od-Button{margin-right:0}[dir=ltr] .OperationMonitor-itemButtonAction.od-Button:not(:last-child){margin-right:6px}[dir=rtl] .OperationMonitor-itemButtonAction.od-Button:not(:last-child){margin-left:6px}.od-OperationMonitor-viewAll{padding:0;border:none;margin-top:16px;cursor:pointer;background:0 0;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-OperationMonitor-empty{font-size:14px;font-weight:400}.AnchorOverlay .OperationMonitor{max-width:400px;padding:10px}.ms-Callout .OperationMonitor{max-width:400px;padding:10px}.isFluent .ms-Callout .OperationMonitor{padding:8px}.isFluent.ms-Callout .OperationMonitor-itemName{padding-top:0}.isFluent.ms-Callout .OperationMonitor-itemIconActions{height:12px}.isFluent.ms-Callout .OperationMonitor-itemIconAction{padding:10px 0 0 0;height:15px;width:12px}.isFluent.ms-Callout .OperationMonitor-itemIconAction .ms-Icon{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}"}])});
define("odsp-next/actions/showOperations/ShowOperationsExecutor.html",[],function(){return"\x3c!--ko component: {\r\n name: panelOverlayTagName,\r\n params: {\r\n onClose: $component.onClosePanel.bind($component),\r\n title: panelTitle\r\n }\r\n}--\x3e\x3c!--ko control: operationMonitorSpecification--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e"});
define("odsp-next/actions/showPermissions/ShowPermissionsExecutor",["require","exports","./ShowPermissionsExecutorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ShowPermissionsExecutor.html","./ShowPermissionsExecutor.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-show-permissions-panel-executor",template:e("./ShowPermissionsExecutor.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/actions/showPermissions/ShowPermissionsExecutorViewModel",["require","exports","tslib","../../providers/engagement/Engagement","../../resources/ControlResourceKeys","../base/ControlExecutorViewModel","../../controls/dialogHost/DialogHost","../../controls/fileNameWithIcon/FileNameWithIcon","../../resources/ProviderResourceKeys","../../providers/dialog/DialogProvider","../../bindings/html/BindableHtmlBinding","../../bindings/keyboard/KeyboardBinding","../../bindings/selection/SelectionBinding","../../controls/personaTile/PersonaTile","../../controls/overlays/panel/PanelOverlay","../../controls/infoPane/InfoPane.resx","../../controls/infoPane/sections/sharing/SharingSectionHelper","../../controls/sharing/sharingLink/SharingLink","../../providers/item/ItemProvider","../../providers/peoplePicker/PeoplePickerProvider","../../utilities/peoplePicker/GraphPeoplePickerHelper","../../providers/sharing/SharingProvider","../../providers/suiteNav/SuiteNavProvider","../../providers/policyTip/PolicyTipProvider","./ShowPermissionsExecutorCommandSet","../../utilities/features/Features","../../controls/commandBar/CommandBar.key","../../bindings/component/ControlBinding","../../bindings/react/ReactBinding","../../controls/malwareDetected/malwareDetectedMessage/MalwareDetectedMessage","../../controls/sharing/share/react/Share","@ms/odsp-shared-sharing/lib/Share","../../providers/sharing/react/SharingStore","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-utilities/lib/logging/ABExperiment"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var H=v.strings,B=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.malwareDetectedMessageComponent=A.malwareDetectedMessage;n._hideElementsInManageAccess=function(e){if(!D.Killswitch.isActivated("228291dd-a7a0-40c5-b303-c79dc377d953","02/21/2019","Fix stop sharing button accessibility")){var t=n.canUnshare&&!e;n.canShowStopSharing(t);n.canShowAdvanced(!e)}};n.addBindingHandlers({bindableHtml:l.default,keyboard:c.default,control:k.default,selection:h.default,react:L.default});n.panelOverlayTagName=d.default.tagName;n.dialogHostTagName=o.default.tagName;n.personaTileTagName=p.default.tagName;n.sharingLinkTagName=g.default.tagName;n.permissionsPanelName=H.sharingPermissionsPanelName;n.FileNameWithIconTagname=u.default.tagName;n.addPeopleText=H.addPeople;n.advancedText=H.advanced;n.stopSharingText=H.stopSharing;n.personaListScreenReaderText=H.personaListScreenReaderText;var r=t.item,i=t.engagementSource;n.item=n.resources.consume(y.resourceKey).getItemSync({parentKey:r.key}).item;n.isLoading=n.createObservable(!1);n.hasFocus=!1;n.resources.bind(f.resourceKey);n.engagementSource=i;n.commandBarSpecification=k.toSpecification(C.resourceKey,{commandSet:new(n.managed(T.default))({engagementSource:n.engagementSource,item:n.item})});n._sharingSectionHelper=new(n.managed(m.default))({item:n.item});n.updateComplete=n._sharingSectionHelper.updateComplete;n.readPermissionsUpdated=n._sharingSectionHelper.readPermissionsUpdated;n._initializeUpdateText();n.links=n._sharingSectionHelper.links;n.personaTileCollection=n._sharingSectionHelper.personaTileCollection;n.personaTileByUser=n._sharingSectionHelper.personaTileByUser;n.scopes=n._sharingSectionHelper.scopes;n.createComputed(n._permissionsChanged);n.canShowStopSharing=n.createObservable(!0);n.canUnshare=n.createPureComputed(function(){return!n._sharingSectionHelper.privateDescription()&&n._sharingSectionHelper.canUnshare()&&n.canShowStopSharing()});n.hasSettings=n._sharingSectionHelper.hasSettings;n.isLoading=n._sharingSectionHelper.isLoading;n.advancedUrl=n._sharingSectionHelper.advancedUrl;n.canShowAdvanced=n.createObservable(!0);n.isShareLinkVisible=n._sharingSectionHelper.isShareLinkVisible;n.hasFocus=n._sharingSectionHelper.hasFocus||!1;n.canManagePermissions=n._sharingSectionHelper.canManagePermissions;n.shareCommandsExperimentOn=!1;if(N.isFeatureEnabled(N.ShareCommandsExperiment)){var s=new P.ABExperiment({name:"MoveShareCommands",startDate:"08/20/2019",version:P.ABExpHash.v2});n.shareCommandsExperimentOn=s.isOn()}n.showShareCommands=N.isFeatureEnabled(N.EnableFolderShareAccessHint)&&!n.shareCommandsExperimentOn;n.isManageAccessInReactEnabled=N.isFeatureEnabled(N.EnableManageAccessInReact);n.isItemMalwareDetected=n.createPureComputed(n._computeIsItemMalwareDetected);n._storageOptionsProvider=n.resources.consume(a.storageOptions.optional);n.isPremium=n.createPureComputed(n._computeIsPremium);n.personaListTabIndex=n.createPureComputed(function(){for(var e=!1,t=0,r=n.keyNav.focusableTiles();t<r.length;t++){var i=r[t];e=e||i.focused()}return e});n.virtualParentElement=t.event?n._getVirtualParent(t.event.target):void 0;n.shareComponent=O.default;n.shareComponentProps=n.createPureComputed(n._computeShareComponentProps);return n}t.prototype.stopSharing=function(){this._sharingSectionHelper.stopSharing(this.onClosePanel.bind(this))};t.prototype.onClosePanel=function(){this.action.complete()};t.prototype.onPermissionsPanelShareClick=function(){this._sharingSectionHelper.onShareClick()};t.prototype.onLinkRemoved=function(){this._sharingSectionHelper.onLinkRemoved()};t.prototype.onAdvancedClick=function(){this.resources.consume(r.resourceKey).logData({name:"AdvancedSettings.Sharing.InfoPaneSection.Click",isIntentional:!0});return!0};t.prototype.onScopeClick=function(e){this._sharingSectionHelper.onScopeClick(e.scope.item)};t.prototype.getTileForPerson=function(e){return this.personaTileByUser()[e.userId]};t.prototype._permissionsChanged=function(){this.keyNav=this._sharingSectionHelper.keyNav;this.fileItem=this._sharingSectionHelper.fileItem};t.prototype._initializeUpdateText=function(){this.updateComplete("");this.readPermissionsUpdated(!1)};t.prototype._computeIsPremium=function(){if(this._storageOptionsProvider.isReady())return this._storageOptionsProvider.hasOffice.peek()};t.prototype._getVirtualParent=function(e){for(;e;){if("true"===e.getAttribute("data-overlay-parent"))return e;e=e.parentElement}};t.prototype._computeIsItemMalwareDetected=function(){var e=this.item();return e&&e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected};t.prototype._computeShareComponentProps=function(){var e=this.resources.consume(b.resourceKey),t=this.resources.consume(w.resourceKey),n=this.resources.consume(E.resourceKey),r=this.resources.consume(S.resourceKey),s=this.resources.consume(x.resourceKey),o=this.resources.consume(i.actionMap);if(this.item()){var u=this.item(),a=new _.default({item:u,accessChecked:!1,sharingInformation:null,defaultRecipients:[],mode:M.Mode.manageAccess,sharingContextInformation:null},{sharingProvider:n,suiteNavProvider:r,peoplePickerProvider:e,policyTipProvider:s,graphPeoplePickerHelper:t});return{actionMap:o,copyLinkShortcut:!1,item:u,peoplePickerProvider:e,graphPeoplePickerHelper:t,resources:this.resources,sharingInformation:null,sharingProvider:n,policyTipProvider:s,maxHeight:void 0,defaultRecipients:[],mode:M.Mode.manageAccess,noMaxHeightRestriction:!0,hideElementsInManageAccess:this._hideElementsInManageAccess,shareCommandsExperiment:this.shareCommandsExperimentOn,sharingStore:a}}};return t}(s.default);t.default=B});
define("odsp-next/controls/personaTile/PersonaTile",["require","exports","./PersonaTileViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./PersonaTile.html","./PersonaTile.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-persona-tile",template:e("./PersonaTile.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/personaTile/PersonaTileViewModel",["require","exports","tslib","../persona/Persona.resx","../persona/Persona","../../bindings/scrollIntoView/ScrollIntoViewBinding","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.personaTagName=i.default.tagName;n.addBindingHandlers({scrollIntoView:s.default});var r=t.tile;n.tile=r;n.tile.personaParams.disableTab=!0;n.tile.personaParams.canManagePermissions=t.canManagePermissions;n.disableTab=t.disableTab;n._person=n.tile.personaParams.person.peek();n.ariaLabel=n.createComputed(n._computeAriaLabel);return n}t.prototype._computeAriaLabel=function(){var e=this._person.sharingInfo.role,t="",n=this.tile.personaParams.canManagePermissions?r.strings.EnterKeyInstruction:"";if(0===e)t=r.strings.Owner;else if(2===e){t=r.strings.Edit;t+=n}else if(1===e){t=r.strings.View;t+=n}return this._person.name+" "+t};return t}(o.default);t.default=u});
define("odsp-next/controls/personaTile/PersonaTile.html",[],function(){return"<div class=od-PersonaTile role=treeitem data-bind=\"attr: { tabindex: (tile.index === 0) && !(disableTab === true) ? 0 : -1, 'aria-label': ariaLabel }, hasFocus: tile.focused, scrollIntoView: { isSelected: tile.focused }\"><div class=od-PersonaTile-Persona data-bind=\"attr: { 'aria-hidden': true }, component: { name: personaTagName, params: tile.personaParams }\"></div></div>"});
define("odsp-next/controls/personaTile/PersonaTile.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-PersonaTile:focus{border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}"}])});
define("odsp-next/controls/infoPane/sections/sharing/SharingSectionHelper",["require","exports","tslib","../../../../providers/engagement/Engagement","../../../../resources/ControlResourceKeys","../../../../utilities/features/Features","../../InfoPane.resx","../../../../providers/sharing/SharingProvider","knockout","@ms/odsp-utilities/lib/async/Promise","../../../../providers/dialog/DialogProvider","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/encoding/UriEncoding","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-datasources/lib/utilities/path/Path","../../../../models/item/ItemType","../../../confirmation/Confirmation","../../../../utilities/icons/Icon","../../../../controls/itemLink/ItemLink","../../../../dataSources/url/QueryType","./SharingSectionKeyboardNav"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=o.strings,S=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.sharingApiErrorMessage=n.createObservable("");n._people=n.createObservable(Array());n.keyNav=new w.default;n.personaTileCollection=n._getPersonaTileCollection();n.personaTileByUser=n._getPersonaTileByUser();n.keyNav.focusableTiles=n.personaTileCollection;n.isNewSharingFlowEnabled=s.isFeatureEnabled(s.SharingDialogRedux);n.isLoading=a.observable(!1);n.scopes=a.observableArray();n.links=a.observableArray();n._scopesLinks=n.observables.createArray();n.hasFocus=t.hasFocus;n.personaSize=4;n.hasSettings=a.observable(!1);n.advancedUrl=a.observable("");n.canUnshare=a.observable(!1);n.showEmailLink=a.observable(!1);n.readPermissionsUpdated=n.createObservable(!1);n.updateComplete=n.createObservable("");n.canManagePermissions=n.createObservable(!1);n.hasInheritedLink=n.createObservable(!1);var o=n.resources.consume(i.actionMap);n.privateDescription=n.createPureComputed(n._computeShareStatus);n._engagement=n.resources.consume(r.resourceKey);n._currentItemShareAction=n.isNewSharingFlowEnabled?new(n.managed(o.ShareByLinkAction)):new(n.managed(o.ShareAction));n._sharingProvider=n.resources.consume(u.resourceKey);n._item=t.item;n.isShareLinkVisible=n.createComputed(n._computeIsShareLinkVisible);n.fileItem=n._item();n.createComputed(function(){var e=n._item();n._onItemChanged(e)});n.totalNumberOfLinks=n.createPureComputed(n._computeTotalNumberOfLinks);n.statusText=n.createComputed(n._computeStatusText);n.fileName=n.createObservable("");n.mailto=n.createComputed(function(){if(!n.hasSettings())return"";for(var e,t="mailto:",r=[],i=0,s=n.scopes();i<s.length;i++)for(var o=0,u=s[i].people;o<u.length;o++){var a=u[o];a.email&&r.push(a.email)}n.showEmailLink(r.length>0&&r.length<30);t+=h.default.encodeURIComponent(r.join(";"));t+="?subject="+h.default.encodeURIComponent(n._settings.itemName);e=d.canonicalizeDecodedUrl(n._settings.itemUrl);t+="&body="+h.default.encodeURIComponent(n._normalizeUrl(e));n.fileName(n._settings.itemName);n.canManagePermissions(n._settings.canManagePermissions);n.hasInheritedLink(n._settings.hasInheritedLink);n.sharingApiErrorMessage(n._settings.sharingApiErrorMessage);return t});return n}t.prototype.dispose=function(){e.prototype.dispose.call(this);if(this._getPermissionsPromise){this._sharingData.cancelGetPermissionsPromise();this._getPermissionsPromise=null}if(this._getLinksPromise){this._sharingData.cancelGetLinksPromise();this._getLinksPromise=null}};t.prototype.onLinkRemoved=function(){this._engagement.logData({name:"RemoveLinkFromPanel.Sharing.InfoPaneSection.Click",isIntentional:!0});this._onItemChanged(this._item.peek())};t.prototype.onScopeClick=function(e){this._executeShare(e);return!1};t.prototype.notifyPermissionsUpdated=function(){this.updateComplete(E.sharingPermissionsUpdated);this.readPermissionsUpdated(!0)};t.prototype.cleanPermissionsUpdated=function(){this.updateComplete("");this.readPermissionsUpdated(!1)};t.prototype.onShareClick=function(){this._executeShare(this._item.peek());return!1};t.prototype.stopSharing=function(e){this._engagement.logData({name:"StopSharing.Sharing.InfoPaneSection.Click",isIntentional:!0});this._stopSharingConfirm(e)};t.prototype.convertPersonToPersonaTile=function(e,t,n){return{personaParams:{inputEvent:this.observables.create(),openContextMenu:this.observables.create(!1),item:n,person:e,personaSize:this.personaSize,showPresence:!0,sharingRoleMenuRootElementClass:"OneDriveApp"},key:t,focused:this.observables.create(!1)}};t.prototype._computeIsShareLinkVisible=function(){return this._currentItemShareAction.isAvailable()};t.prototype._stopSharing=function(){return this._sharingProvider.unshare(this._item.peek())};t.prototype._stopSharingConfirm=function(e){var t=this,n=this.resources.consume(l.resourceKey),r=this._engagement,i=a.observable(!0);n.requestDialog({title:E.stopSharingConfirmationTitle,size:"Medium",component:{name:m.default.tagName,params:{message:E.stopSharingConfirmationMessage}},actions:[{name:E.stopSharingConfirmationButton,execute:function(){r.logData({name:"Unshare.Sharing.InfoPaneSection.Click",isIntentional:!0});i(!1);return t._stopSharing().then(function(n){s.isFeatureEnabled(s.SharedByMe)&&t._item.peek().queryType===b.default.SharedByMe&&e();return 2},function(e){return 3})},isDefault:!0,isAvailable:i,icon:new g.default("Save"),automationId:"UnshareConfirm"},{name:E.stopSharingCancelButton,execute:function(){r.logData({name:"CancelStopSharing.Sharing.InfoPaneSection.Click",isIntentional:!0});return f.default.wrap(3)},isDefault:!1,icon:new g.default("Cancel"),automationId:"UnshareCancel"}],executeDefaultAction:!1})};t.prototype._executeShare=function(e,t){void 0===t&&(t=this.resources);var n=this.resources.consume(i.actionMap);(this.isNewSharingFlowEnabled?this.addDisposable(new(t.injected(n.ShareByLinkAction))):this.addDisposable(new(t.injected(n.ShareAction))({item:a.observable(e),startState:3}))).execute(null)};t.prototype._computeStatusText=function(){var e=this._item.peek(),t=this.isLoading(),n="",r=this.scopes();this._hasError&&(n=this._errorText);t?n=E.sharingLoadingStatus:0!==this.totalNumberOfLinks()||this._hasNonOwnerScopes(r)||(n=e.type===v.default.Folder?E.sharingUnsharedFolderStatus:E.sharingUnsharedFileStatus);return n};t.prototype._hasNonOwnerScopes=function(e){var t=!0,n=!1;e&&0!==e.length||(t=!1);if(t)for(var r=0;r<e.length&&!n;r++)for(var i=e[r].people,s=0;s<i.length&&!n;s++){0!==i[s].sharingInfo.role&&(n=!0)}return t&&n};t.prototype._computeShareStatus=function(){var e=this.scopes(),t="";if(0===this.totalNumberOfLinks()&&!this._hasNonOwnerScopes(e)&&0===this._item().sharingRole)if(e&&0!==e.length){if(1===e.length&&this._areAllOwners(e[0].people)){var n=e[0].people[0];t=1===e[0].people.length&&2===n.entityType?c.format(E.sharingUnsharedOwnedByGroup,n.name):E.sharingUnsharedNotShared}}else t=E.sharingUnsharedNotShared;return t};t.prototype._areAllOwners=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if(r.sharingInfo&&0!==r.sharingInfo.role)return!1}return!0};t.prototype._computeTotalNumberOfLinks=function(){var e=this.links(),t=this._scopesLinks();return e.length+t.length};t.prototype._onItemChanged=function(e){var t=this;this.cleanPermissionsUpdated();if(this._getPermissionsPromise){this.isLoading(!1);this._sharingData.cancelGetPermissionsPromise();this._getPermissionsPromise=null}if(this._getLinksPromise){this._sharingData.cancelGetLinksPromise();this._getLinksPromise=null}if(e&&e.key!==this._itemKey){this._itemKey=e.key;this.scopes([]);this.links([]);this.isLoading(!0)}if(e){this._sharingData=this._sharingProvider.getSharingData(e);this._sharingData.getSettings().then(function(e){t._settings=e;t.advancedUrl(e.advancedUrl);t.hasSettings(!0)},function(e){});this._hasError=!1;this._getPermissionsPromise=this._sharingData.getPermissions();this._sharingData.doSharingScopesContainLinks()||(this._getLinksPromise=this._sharingData.getLinks());this.trackPromise(this._getPermissionsPromise.then(function(n){t.isLoading(!1);t.scopes(t._processScopes(e,n))},function(e){e&&403===e.status?t._errorText=E.accessDenied:e&&e.code&&e.code.indexOf("-2130575139")>-1?t._errorText=E.noscriptErrorStatus:t._errorText=E.serverError;t._hasError=!0;t.isLoading(!1)}));this._getLinksPromise&&this._getLinksPromise.then(function(e){e&&t.links(e.filter(function(e){return e.isActive&&8!==e.type}))},function(e){});this.fileItem=e}};t.prototype._processScopes=function(e,t){var r=this,i=[];t.length>0&&this.canUnshare(t[0].canUnshare);this._scopesLinks([]);for(var s=0;s<t.length;s++){var o=t[s];if(o&&o.people.length){var u=n.__assign({},o,{headerHtml:"",sharingPeople:[]});if(o.item&&o.item.key!==this._item.peek().key){var a;a="<span data-bind=\"component: { name: '"+y.default.tagName+"', params: { item: scope.item } }\"></span>";u.headerHtml=c.format(E.sharingScopeHeaderFormat,a)}o.people.forEach(function(e){e.sharingInfo.link&&r._scopesLinks.push(e.sharingInfo.link);u.sharingPeople.push({personInfo:e,sharingItem:o.item})});i.push(u)}}for(var f=new Array,l=0;l<i.length;l++)f=f.concat(i[l].sharingPeople);this._people().length&&this.notifyPermissionsUpdated();this._people(f);return i};t.prototype._getPersonaTileCollection=function(){var e=this,t=this.createPureComputed(function(){for(var t={},n=0,r=e._people();n<r.length;n++){var i=r[n],s=i.personInfo;3!==s.sharingInfo.type&&(t[s.userId]=i)}return t}),n=this.observables.createArray();this.createBackgroundComputed(function(){n.splice.apply(n,[0,n.peek().length].concat(e._people().map(function(e){return e.personInfo.userId})))});return n.filter(function(e){return e in t()}).map({mappingWithDisposeCallback:function(n){var r=e.createObservable(),i=e.createComputed(function(){r(t()[n].personInfo||r.peek())});return{mappedValue:e.convertPersonToPersonaTile(r,n,t()[n].sharingItem),dispose:function(){i.dispose()}}}})};t.prototype._getPersonaTileByUser=function(){var e=this;return this.createComputed(function(){for(var t={},n=0,r=e.personaTileCollection();n<r.length;n++){var i=r[n];t[i.key]=i}return t})};t.prototype._normalizeUrl=function(e){var t=document.createElement("A");t.href=e;return t.href};return t}(p.default);t.default=S});
define("odsp-next/controls/infoPane/sections/sharing/SharingSectionKeyboardNav",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t.keyboardOptions=[{target:null,mappings:{Enter:t.onKeyEnter}},{target:window,mappings:{}}];t.focusedTile=t.observables.create();t.focusableTiles=t.observables.createArray();return t}t.prototype.onKeyEnter=function(e,t){var n=e.keyNav.focusedTile();if(n){n.personaParams.inputEvent(t);n.personaParams.openContextMenu(!0)}t.stopPropagation();return!0};return t}(r.default);t.default=i});
define("odsp-next/controls/sharing/sharingLink/SharingLink",["require","exports","./SharingLinkViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SharingLink.html","./SharingLink.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-sharingLink",template:e("./SharingLink.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/sharing/sharingLink/SharingLinkViewModel",["require","exports","tslib","knockout","../../../providers/engagement/Engagement","../../../providers/sharing/SharingProvider","../../../providers/suiteNav/SuiteNavProvider","@ms/odsp-utilities/lib/async/Promise","../../../providers/dialog/DialogProvider","../sharingByLink/SharingByLinkStringHelper","../../../utilities/sharing/SharingHelper","../../../bindings/focus/SelectOnFocusBinding","../../../bindings/tooltip/TooltipBinding","../sharedWith/SharedWith.resx","../../infoPane/InfoPane.resx","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/base/ViewModel","../../persona/Persona","@ms/odsp-shared-sharing/lib/Share","../../overlays/panel/PanelOverlay","../editLink/EditLink.resx","../editLink/EditLink","../../../bindings/react/ReactBinding","office-ui-fabric-react/lib/Icon","../../../models/item/ItemHelper","../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.passwordProtectedLinkIndicatorLabel=w.strings.passwordProtectedLinkIndicatorAriaLabel;n._engagement=n.resources.consume(i.resourceKey);n.link=t.link;var u=!t.isShareLinkVisible||t.isShareLinkVisible,a=6===n.link.kind?n._dedupeLinkMembers(n.link.linkInvitees.concat(n.link.linkMembers)):n.link.linkMembers;n.totalLinkMembers=n.createObservable(a);n._extraMembersCount=n.createPureComputed(n._getExtraMembers);n.extraMembersText=n.createPureComputed(n._getExtraMemberText);n.briefLinkMembers=n.createPureComputed(n._getBriefLinkMembers);n.extraLinkMembers=n.createPureComputed(n._getExtraLinkMembers);n.extraMembersName=n.createPureComputed(n._getExtraMembersName);n.showTotal=n.createObservable(!1);n.personaTagName=g.default.tagName;n.personaSize=7;n.isLinkVisible=10!==n.link.type&&u;n._onLinkRemoved=t.onLinkRemoved;n.isEditable=t.isEditable||!1;n.arePasswordLinksEnabled=N.isFeatureEnabled(N.EnablePasswordProtectedLinks);n.isPasswordProtectedLink=n.link&&n.link.hasPassword;n.panelOverlayTagName=b.default.tagName;n.editLinkTagName=E.default.tagName;n.editLinkPanelTitle=w.strings.editLinkPanelTitle;n.editLinkParams={onClose:n.onClosePanel.bind(n),onLinkRemoved:n._onLinkRemoved,sharingLink:n.link};n.showEditLinkPanel=n.createObservable(!1);n._sharingProvider=n.resources.consume(s.resourceKey);n.disableLinkText=w.strings.removeLinkButtonText;n.shareableLinkText=p.strings.ShareableLink;n.isInheritedText=n.link.isInherited?p.strings.InheritedText:"";n.sharingHintText=r.observable("");var l=n.resources.consume(o.resourceKey.optional);l&&l.loadData().then(function(e){n.sharingHintText(f.getLinkHintText(n.link,e.CompanyDisplayName))});n.canManageLinks=r.observable(!1);n._sharingProvider.getSharingData(n.link.item).getSettings().then(function(e){N.isFeatureEnabled(N.EnableLinkLevelManageAccess)?n.canManageLinks(n.link.linkMembers&&!n.link.isInherited&&!T.hasAutoAlbumTag(n.link.item)):n.canManageLinks(e.canManageLinks&&!n.link.isInherited&&!T.hasAutoAlbumTag(n.link.item))});n.addBindingHandlers({tooltip:h.default,selectOnFocus:c.default,react:S.default});n.iconComponent=x.Icon;n.iconComponentProps=n._getLinkIconProps(n.link);return n}t.prototype.logCopy=function(){this._engagement.logData({name:this.link.tag+"Link.SharingLink.Copy",isIntentional:!0});return!0};t.prototype.removeSharingLink=function(){var e=this,t=this.resources.consume(a.resourceKey);l.disableLinkConfirm(function(){e._engagement.logData({name:"Disable "+e.link.tag+" Link.SharingLink.Click",isIntentional:!0});var t={link:e.link,type:e.link.type,role:e.link.role,create:!1};return e._sharingProvider.manageSharingLinks([e.link.item],t).then(function(t){e._onLinkRemoved&&e._onLinkRemoved();return u.default.wrap(!0)},function(e){return!1})},function(t){e.isReady=t},t,"SharingLink")};t.prototype.onSharingHintClick=function(){if(this.isEditable){this._engagement.logData({name:this.link.tag+"Link.SharingLink.EditPermissions",isIntentional:!0});this.showEditLinkPanel(!0)}};t.prototype.onClosePanel=function(){this.showEditLinkPanel(!1)};t.prototype.showTotalLinkMembers=function(){this.showTotal(!0)};t.prototype.hideTotalLinkMembers=function(){this.showTotal(!1)};t.prototype._getExtraMembers=function(){var e=(this.link.linkMembers?this.link.linkMembers.length:0)-6;return e>0?e+1:0};t.prototype._getExtraMemberText=function(){var e="",t=this._extraMembersCount();if(t){t>99&&(e=d.strings.sharingExtraNumberOverflow);e=v.format(d.strings.sharingExtraNumberText,t)}return e};t.prototype._getBriefLinkMembers=function(){var e=this.totalLinkMembers(),t=e?e.slice(0,5):[];return this._extraMembersCount()?t:e};t.prototype._getExtraLinkMembers=function(){var e=this.totalLinkMembers();return e?e.slice(5):[]};t.prototype._getExtraMembersName=function(){return this.totalLinkMembers().slice(5).map(function(e){return e.name}).join(p.strings.NameSeparator)};t.prototype._dedupeLinkMembers=function(e){for(var t=[],n=[],r=0,i=e;r<i.length;r++){var s=i[r],o=s.email;if(!t[o]){t[o]=!0;n.push(s)}}return n};t.prototype._getLinkIconProps=function(e){var t=e.kind;this.isAnonymousLink=e.audience===y.SharingAudience.anyone||5===t||4===t;this.isCSL=e.audience===y.SharingAudience.organization||3===t||2===t;this.isPSL=e.audience===y.SharingAudience.specificPeople||e.audience===y.SharingAudience.specificPeopleFlex;this.isGeneric=!this.isAnonymousLink&&!this.isCSL&&!this.isPSL;var n="Link";this.isAnonymousLink?n="Globe":this.isCSL?n="Work":this.isPSL&&(n="PeopleAdd");return{iconName:n}};return t}(m.default);t.default=C});
define("odsp-next/controls/sharing/sharingByLink/SharingByLinkStringHelper",["require","exports","./SharingByLink.resx","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared-sharing/lib/Share"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getLinkHintText=function(e,t,u,a){if(null===e)return"";if(6===e.kind){if(e.blockDownload){if(e.audience===i.SharingAudience.anyone)return e.expiration?r.format(e.hasPassword?n.strings.AnonymousViewOnlyWithExpiryAndPassword:n.strings.AnonymousViewOnlyWithExpiry,new Date(e.expiration).toLocaleDateString()):e.hasPassword?n.strings.AnonymousViewOnlyWithPassword:n.strings.AnonymousViewOnlyText;if(e.audience===i.SharingAudience.organization)return r.format(n.strings.OrganizationViewOnly,t);if(e.audience===i.SharingAudience.specificPeopleFlex)return n.strings.SpecificPeopleViewOnly}if(e.audience!==i.SharingAudience.anyone)return 2===e.role?n.strings.pslEditLabel:6===e.role?n.strings.pslReviewLabel:1===e.role?n.strings.pslViewLabel:n.strings.peopleSharingLinkLabel;if(e.expiration&&e.hasPassword){if(2===e.role||6===e.type)return o(6,new Date(e.expiration));if(1===e.role||5===e.type)return o(5,new Date(e.expiration))}else if(!e.expiration&&e.hasPassword){if(2===e.role||6===e.type)return n.strings.AnonymousPasswordEditText;if(1===e.role||5===e.type)return n.strings.AnonymousPasswordViewText}else if(e.expiration&&!e.hasPassword){if(2===e.role||6===e.type)return s(6,new Date(e.expiration));if(1===e.role||5===e.type)return s(5,new Date(e.expiration))}else{if(2===e.role||6===e.type)return n.strings.AnonymousEditText;if(1===e.role||5===e.type)return n.strings.AnonymousViewText}}if(8===e.type&&u&&u.length>0&&a&&1===a){for(var f=u[0].sharingInfo.role,l=1;l<u.length;l++){if(f!==u[l].sharingInfo.role){f=5;break}}return 1===u.length?2===f?r.format(n.strings.InvitedUsersOneEditLinkText,u[0].name):1===f?r.format(n.strings.InvitedUsersOneViewLinkText,u[0].name):r.format(n.strings.InvitedUsersOneAccessLinkText,u[0].name):2===u.length?2===f?r.format(n.strings.InvitedUsersTwoEditLinkText,u[0].name,u[1].name):1===f?r.format(n.strings.InvitedUsersTwoViewLinkText,u[0].name,u[1].name):r.format(n.strings.InvitedUsersTwoAccessLinkText,u[0].name,u[1].name):3===u.length?2===f?r.format(n.strings.InvitedUsersThreeEditLinkText,u[0].name,u[1].name):1===f?r.format(n.strings.InvitedUsersThreeViewLinkText,u[0].name,u[1].name):r.format(n.strings.InvitedUsersThreeAccessLinkText,u[0].name,u[1].name):2===f?r.format(n.strings.InvitedUsersThreePlusEditLinkText,u[0].name,u[1].name,u.length-2):1===f?r.format(n.strings.InvitedUsersThreePlusViewLinkText,u[0].name,u[1].name,u.length-2):r.format(n.strings.InvitedUsersThreePlusAccessLinkText,u[0].name,u[1].name,u.length-2)}var c=e.expiration?new Date(e.expiration).toLocaleDateString():null;if(4===e.entityType)return n.strings.AnonymousViewText;switch(e.type){case 9:return 2===e.role?t?r.format(n.strings.OrganizationEditText,t):n.strings.NoNameOrganizationEditText:t?r.format(n.strings.OrganizationViewText,t):n.strings.NoNameOrganizationViewText;case 8:return 2===a?2===e.role?n.strings.ToLineEditText:n.strings.ToLineViewText:n.strings.DirectLinkText;case 6:return e.supportsExpiration&&c?s(6,new Date(e.expiration)):n.strings.AnonymousEditText;case 5:return e.supportsExpiration&&c?s(5,new Date(e.expiration)):n.strings.AnonymousViewText;case 3:return n.strings.AnonymousEmbedText;case 4:return r.format(n.strings.appText,e.name);case 7:return n.strings.AnonymousSurveyText;case 10:return n.strings.OneNoteSharingText;default:return""}};t.getWhoCanAccessLinkOptions=function(e,t,i){var s=[];if(1===i||2===i){e.anonymousLinksEnabled&&e.canManageLinks&&s.push({text:n.strings.AnonymousOptionText,type:6});e.organizationLinksEnabled&&e.canManageLinks&&(t?s.push({text:r.format(n.strings.NamedOrganizationOptionText,t),type:9}):s.push({text:n.strings.UnnamedOrganizationOptionText,type:9}))}1===i?s.push({text:n.strings.SpecificPeopleOptionText,type:8}):s.push({text:n.strings.ToLineOptionText,type:8});return s};t.getSharingInfoText=function(e){return 0===e.length?null:1===e.length?r.format(n.strings.PermissionsInfoOneAccessLinkText,e[0].name):2===e.length?r.format(n.strings.PermissionsInfoTwoAccessLinkText,e[0].name,e[1].name):3===e.length?r.format(n.strings.PermissionsInfoThreeAccessLinkText,e[0].name,e[1].name):r.format(n.strings.PermissionsInfoThreePlusAccessLinkText,e[0].name,e[1].name,e.length-2)};function s(e,t){var i=new Date(t).toLocaleDateString(),s=t.getTime()<Date.now();return 6===e?r.format(s?n.strings.AnonymousEditExpiredText:n.strings.AnonymousEditExpiryText,i):5===e?r.format(s?n.strings.AnonymousViewExpiredText:n.strings.AnonymousViewExpiryText,i):""}function o(e,t){var i=new Date(t).toLocaleDateString(),s=t.getTime()<Date.now();return 6===e?r.format(s?n.strings.AnonymousPasswordEditExpiredText:n.strings.AnonymousPasswordEditExpiryText,i):5===e?r.format(s?n.strings.AnonymousPasswordViewExpiredText:n.strings.AnonymousPasswordViewExpiryText,i):""}});
define("odsp-next/controls/sharing/editLink/EditLink",["require","exports","./EditLinkViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./EditLink.html","./EditLink.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-editLink",template:e("./EditLink.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/sharing/editLink/EditLinkViewModel",["require","exports","tslib","../../../providers/engagement/Engagement","../../../providers/item/ItemProvider","./EditLink.resx","../../../controls/sharing/sharingByLink/SharingByLink.resx","../../../utilities/sharing/SharingHelper","../../../providers/sharing/SharingProvider","@ms/odsp-utilities/lib/async/Promise","../../../providers/dialog/DialogProvider","../../../bindings/focus/SelectOnFocusBinding","../../../dataSources/sharing/odc/SharingLinkExpirationHelper","@ms/odsp-shared/lib/base/ViewModel","../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.setPasswordAriaLabel=s.strings.setPasswordAriaLabel;var u=t.onClose,f=t.onLinkRemoved,l=t.sharingLink;n._onClose=u;n._onLinkRemoved=f;n._sharingLink=l;n.addBindingHandlers({selectOnFocus:c.default});n._itemProvider=n.resources.consume(i.resourceKey);n._sharingProvider=n.resources.consume(a.resourceKey);n._engagement=n.resources.consume(r.resourceKey);n._sharingLinkExpirationHelper=new(n.managed(h.default));n.cancelButtonText=s.strings.cancelButtonText;n.createBackgroundComputed(n._computeValidInput);n.invalidPasswordText=o.strings.invalidPasswordError;n.linkExpirationInDays=n.createObservable(n._getDefaultLinkExpirationInDays(n._sharingLink.expiration));n.linkExpiresChecked=n.createObservable(!!n._sharingLink.expiration);n.linkExpiresInputLabel=n.createPureComputed(n._computeLinkExpiresInputLabel);n.linkExpiresText=s.strings.setExpirationLabel;n.passwordChanged=n.createObservable(!1);n.passwordValue=n.createObservable("");n.updateButtonText=s.strings.updateButtonText;n.setPasswordPermissionsWarning=o.strings.SetPasswordPermissionsWarning;n.removeLinkButtonText=s.strings.removeLinkButtonText;n.arePasswordLinksEnabled=d.isFeatureEnabled(d.EnablePasswordProtectedLinks);n.isSetPasswordChecked=n.createObservable(!!n._sharingLink.hasPassword);n.setPasswordLabel=s.strings.setPasswordLabel;n.arePasswordLinksEnabled&&n._onSetPasswordChecked();n.isPasswordInvalid=n.createComputed(n._computeIsPasswordInvalid);n.isUpdateButtonDisabled=n.createComputed(n._computeIsUpdateButtonDisabled);return n}t.prototype.onUpdateClick=function(){var e=this;this._logEngagementEvent("Update");var t=this._sharingLink,n=[t.item],r=this.linkExpiresChecked.peek()?this._sharingLinkExpirationHelper.calculateLinkExpiration(parseInt(this.linkExpirationInDays.peek(),10)):null,i={type:t.type,role:t.role,create:!0,expiration:r,name:t.name,id:t.id};if(this.arePasswordLinksEnabled){var s=this.isSetPasswordChecked.peek(),o=s&&this.passwordChanged.peek(),u=!s&&t.hasPassword;o&&(i.password=this.passwordValue.peek());u&&(i.password="")}this._sharingProvider.manageSharingLinks(n,i).then(function(t){e._itemProvider.invalidateItem(n[0].key,{triggerFetch:!0});e._onClose()})};t.prototype.changePasswordInput=function(){this.passwordChanged(!0);this.passwordValue("")};t.prototype.onCancelClick=function(){this._logEngagementEvent("Cancel");this._onClose()};t.prototype.onRemoveLinkClicked=function(){var e=this,t=this._sharingLink,n=this.resources.consume(l.resourceKey);this._logEngagementEvent("RemoveLink");u.disableLinkConfirm(function(){e._engagement.logData({name:"Disable "+t.tag+" Link.SharingLink.Click",isIntentional:!0});var r={link:t,type:t.type,role:t.role,create:!1};return e._sharingProvider.manageSharingLinks([t.item],r).then(function(t){e._onLinkRemoved&&e._onLinkRemoved();return f.default.wrap(!0)},function(e){var t=e&&e.message||s.strings.unableToRemoveLinkGenericMessage;u.displayMessage(t,s.strings.unableToRemoveLinkTitle,n);return!1})},function(e){},n,"EditLink")};t.prototype._onSetPasswordChecked=function(){if(this._sharingLink&&this._sharingLink.hasPassword){this.passwordValue("        ")}};t.prototype._computeValidInput=function(){var e=this.linkExpirationInDays(),t=parseInt(e,10),n=t.toString();if(t<=0&&t>h.MAX_EXPIRATION){n="";this.linkExpiresChecked(!1)}this.linkExpirationInDays(n)};t.prototype._computeIsPasswordInvalid=function(){var e=this.passwordValue();return this.isSetPasswordChecked()&&this.passwordChanged()&&e.length>0&&0===e.trim().length};t.prototype._computeIsUpdateButtonDisabled=function(){var e=this.linkExpiresChecked(),t=this.isSetPasswordChecked(),n=this.isPasswordInvalid();if(!e&&!t)return!1;var r=this.linkExpirationInDays();return this._sharingLinkExpirationHelper.computeExpirationValidity(r)!==h.LinkExpirationValidity.Valid||n};t.prototype._computeLinkExpiresInputLabel=function(){var e=this.linkExpirationInDays();return this._sharingLinkExpirationHelper.computeLinkExpiresInputLabel(e)};t.prototype._getDefaultLinkExpirationInDays=function(e){var t=parseInt(h.DEFAULT_EXPIRATION,10);e&&(t=this._sharingLinkExpirationHelper.getDaysFromToday(new Date(e)));return t.toString()};t.prototype._logEngagementEvent=function(e){this._engagement.logData({name:"EditLinkPanel."+e+".Click",isIntentional:!0,extraData:{linkExpiration:this.linkExpirationInDays.peek(),hasPassword:0!==this.passwordValue.peek().length}})};return t}(p.default);t.default=v});
define("odsp-next/dataSources/sharing/odc/SharingLinkExpirationHelper",["require","exports","tslib","@ms/odsp-utilities/lib/dateTime/DateTime","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/string/StringHelper","../../../controls/sharing/sharingByLink/SharingByLink.resx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DEFAULT_EXPIRATION="30";t.MAX_EXPIRATION=1825;var u;!function(e){e[e.Invalid=0]="Invalid";e[e.Empty=1]="Empty";e[e.Valid=2]="Valid"}(u=t.LinkExpirationValidity||(t.LinkExpirationValidity={}));var a=function(e){n.__extends(i,e);function i(t){return e.call(this,t)||this}i.prototype.computeExpirationValidity=function(e){if(""===e)return u.Empty;var n=e.match(/^-?[0-9]+/);if(n&&n[0]!==e||!n)return u.Invalid;var r=parseInt(e,10);return r<=0||r>t.MAX_EXPIRATION?u.Invalid:u.Valid};i.prototype.computeLinkExpiresInputLabel=function(e){if(this.computeExpirationValidity(e)===u.Valid){var t=parseInt(e,10),n=new Date;n.setDate(n.getDate()+t);return s.format(o.strings.daysWithDate,r.getShortDisplayDate(n))}return o.strings.days};i.prototype.getDaysFromToday=function(e){var t=new Date;return Math.round((e.getTime()-t.getTime())/864e5)};i.prototype.calculateLinkExpiration=function(e){if(e>0&&e<=t.MAX_EXPIRATION){var n=new Date;n.setDate(n.getDate()+e);return n.toISOString()}return null};return i}(i.default);t.default=a});
define("odsp-next/controls/sharing/editLink/EditLink.html",[],function(){return'<div class=od-EditLink><div class="od-CheckBox od-EditLink-linkExpiresCheckbox"><input type=checkbox id=od-EditLink-linkExpires data-bind="checked: linkExpiresChecked" class=od-CheckBox-input> <label for=od-EditLink-linkExpires class=od-CheckBox-field data-bind="css: {\'is-checked\': linkExpiresChecked}"><span data-bind="text: linkExpiresText, automation: \'linkExpiresText\'" class=od-Label></span></label>\x3c!--ko if: linkExpiresChecked()--\x3e<div class=od-EditLink-linkExpiresInputDiv><input id=od-EditLink-linkExpiresInput class=od-EditLink-linkExpiresInput type=number data-bind="value: linkExpirationInDays, selectOnFocus: { isPermanent: false, isReentrant: true }"> <label for=od-EditLink-linkExpiresInput><span class=od-EditLink-linkExpiresInputLabel data-bind="text: linkExpiresInputLabel"></span></label></div>\x3c!--/ko--\x3e</div>\x3c!--ko if: arePasswordLinksEnabled--\x3e<div class="od-CheckBox od-EditLink-setPasswordCheckbox"><input type=checkbox id=od-EditLink-setPassword data-bind="checked: isSetPasswordChecked" class=od-CheckBox-input> <label for=od-EditLink-setPassword class=od-CheckBox-field data-bind="css: {\'is-checked\': isSetPasswordChecked}"><span data-bind="text: setPasswordLabel, automation: \'setPasswordLabel\'" class=od-Label></span></label>\x3c!--ko if: isSetPasswordChecked()--\x3e<div class=od-EditLink-setPasswordInputContainer><input id=od-EditLink-setPasswordInput class=od-EditLink-setPasswordInput type=password data-bind="attr: { \'aria-label\': setPasswordAriaLabel, \'aria-invalid\': isPasswordInvalid() }, value: passwordValue, valueUpdate: \'input\', click: changePasswordInput, selectOnFocus: { isPermanent: false, isReentrant: true }, css: { \'od-EditLink-invalidPasswordOutline\': isPasswordInvalid() }"></div>\x3c!--ko if: isPasswordInvalid()--\x3e<div class=od-EditLink-invalidPasswordError role=alert data-bind="text: invalidPasswordText"></div>\x3c!--/ko--\x3e<div class=od-EditLink-passwordProtectedLinkInformationArea><i class="ms-Icon ms-Icon--Info od-EditLink-passwordProtectedLinkInformationIcon" data-bind="icon: true"></i><div class=od-EditLink-passwordProtectedLinkInformationTextArea data-bind="text: setPasswordPermissionsWarning"></div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e<div class=od-EditLink-removeLinkHolder><i class="ms-Icon ms-Icon--Delete" data-bind="icon: true"></i> <button class=od-EditLink-removeLinkText data-bind="click: onRemoveLinkClicked, text: removeLinkButtonText"></button></div><div class=od-EditLink-buttons><button class="od-Button od-Button--primary" role=button data-bind="click: onUpdateClick, disable: isUpdateButtonDisabled"><span class=od-Button-label data-bind="text: updateButtonText"></span></button> <button class=od-Button role=button data-bind="click: onCancelClick"><span class=od-Button-label data-bind="text: cancelButtonText"></span></button></div></div>'});
define("odsp-next/controls/sharing/editLink/EditLink.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-EditLink{margin-top:20px}.od-EditLink-linkExpiresInputDiv{display:inline-block;margin:12px 0 14px}.od-EditLink-linkExpiresInput{width:40px}.od-EditLink-linkExpiresCheckbox{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.od-EditLink-setPasswordInputContainer{margin-top:12px}.od-EditLink-setPasswordInput{height:28px}.od-EditLink-invalidPasswordOutline{outline:1px solid "},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.od-EditLink-invalidPasswordError{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:";font-size:12px;margin-top:8px}.od-EditLink-setPasswordCheckbox{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.od-EditLink-removeLinkHolder{-ms-flex-align:center;align-items:center;color:#a80000;display:-ms-flexbox;display:flex;margin:34px 0}.od-EditLink-removeLinkText{font-size:14px;font-weight:400;background:0 0;border:none;color:#a80000;cursor:pointer}[dir=ltr] .od-EditLink-removeLinkText{margin-left:4px}[dir=rtl] .od-EditLink-removeLinkText{margin-right:4px}.od-EditLink-passwordProtectedLinkInformationArea{margin-top:8px;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";display:-ms-flexbox;display:flex}.od-EditLink-passwordProtectedLinkInformationTextArea{padding:10px;font-size:14px}.od-EditLink-passwordProtectedLinkInformationIcon{font-size:17px;padding-top:14px}html[dir=ltr] .od-EditLink-passwordProtectedLinkInformationIcon{padding-left:10px}html[dir=rtl] .od-EditLink-passwordProtectedLinkInformationIcon{padding-right:10px}"}])});
define("odsp-next/controls/sharing/sharingLink/SharingLink.html",[],function(){return'<div class=od-SharingLink role=group data-bind="attr: { \'aria-label\': sharingHintText }"><div class="od-SharingLink-cell od-SharingLink-iconCell"><div class=od-SharingLink-iconBackground data-bind="css: { \'od-SharingLink-anonymous-bg\': isAnonymousLink, \'od-SharingLink-csl-bg\': isCSL, \'od-SharingLink-psl-bg\': isPSL, \'od-SharingLink-generic-bg\': isGeneric }"></div><div class=od-SharingLink-icon role=presentation data-bind="react: { componentType: iconComponent, props: iconComponentProps }, css: { \'od-SharingLink-anonymous\': isAnonymousLink, \'od-SharingLink-csl\': isCSL, \'od-SharingLink-psl\': isPSL, \'od-SharingLink-generic\': isGeneric }"></div></div><div class=od-SharingLink-cell><div class="od-Sharinglink-table od-Sharinglink-url"><div class=od-Sharinglink-row><div class=od-SharingLink-cell>\x3c!--ko if: isLinkVisible--\x3e<input class="od-SharingLink-input od-TextField-field" type=text readonly data-bind="value: link.url, selectOnFocus: { isPermanent: true }, attr: { \'title\': shareableLinkText, \'aria-label\': shareableLinkText }, event: { copy: $component.logCopy.bind($component) }">\x3c!--/ko--\x3e\x3c!--ko ifnot: isLinkVisible--\x3e<span class=od-SharingLink-linkSwitcher data-bind="text: sharingHintText"></span>\x3c!--/ko--\x3e</div>\x3c!--ko if: canManageLinks--\x3e<div class=od-SharingLink-cell><button class=od-SharingLink-removeLinkButton data-bind="css: { \'od-SharingLink-removeLinkButton-leftMargin\': isLinkVisible }, click: removeSharingLink, attr: { \'title\': disableLinkText, \'aria-label\': disableLinkText }"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button></div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if: isLinkVisible--\x3e<div class=od-SharingLink-linkSwitcher>\x3c!--ko if: isEditable--\x3e<div class=od-SharingLink-sharingHintContainer><button class=od-SharingLink-sharingHint data-bind="click: onSharingHintClick">\x3c!--ko text: sharingHintText--\x3e\x3c!--/ko--\x3e<i class="ms-Icon ms-Icon--ChevronDown od-SharingLink-chevron" data-bind="icon: true"></i></button>\x3c!--ko if: arePasswordLinksEnabled--\x3e\x3c!--ko if: isPasswordProtectedLink--\x3e<i class="ms-Icon ms-Icon--Lock od-SharingLink-lock" role=img data-bind="icon: true, attr: {\'aria-label\': passwordProtectedLinkIndicatorLabel }"></i>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if: !isEditable--\x3e<div class=od-SharingLink-sharingHint data-bind="text: sharingHintText"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if: link.linkMembers--\x3e<div class=od-SharingLink-linkUser><div class=od-Sharing-briefLinkMembers>\x3c!--ko foreach: briefLinkMembers--\x3e<div class=od-SharingLink-linkMember data-bind="component: { name: $parent.personaTagName, params: { person: $data, personaSize: $parent.personaSize } }"></div>\x3c!--/ko--\x3e\x3c!--ko if: extraMembersText()--\x3e\x3c!--ko if: !showTotal()--\x3e<div class="ms-Icon ms-Icon--ChevronDown" role=button data-bind="icon: true, click: showTotalLinkMembers, tooltip: { content: extraMembersName }"></div>\x3c!--/ko--\x3e\x3c!--ko if: showTotal()--\x3e<div class="ms-Icon ms-Icon--ChevronUp" role=button data-bind="icon: true, click: hideTotalLinkMembers"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if: showTotal()--\x3e<div class=od-Sharing-extraLinkMembers>\x3c!--ko foreach: extraLinkMembers--\x3e<div class=od-SharingLink-linkMember data-bind="component: { name: $parent.personaTagName, params: { person: $data, personaSize: $parent.personaSize } }"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if: showEditLinkPanel--\x3e\x3c!--ko component: {\r\n name: panelOverlayTagName,\r\n params: {\r\n onClose: $component.onClosePanel.bind($component),\r\n title: editLinkPanelTitle\r\n }\r\n }--\x3e\x3c!--ko component: {\r\n name: editLinkTagName,\r\n params: editLinkParams\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});
define("odsp-next/controls/sharing/sharingLink/SharingLink.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-SharingLink{margin-bottom:10px;display:-ms-flexbox;display:flex}.od-SharingLink-cell{display:table-cell;max-width:200px}.od-SharingLink-iconCell{vertical-align:top;width:48px;position:relative}[dir=ltr] .od-SharingLink-iconCell{padding-right:10px}[dir=rtl] .od-SharingLink-iconCell{padding-left:10px}.od-SharingLink-icon{display:inline-block;color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";font-size:28px;min-width:48px;height:48px;text-align:center;line-height:48px;position:absolute;background-color:transparent;border-width:1px;border-style:solid;border-radius:50%}.od-SharingLink-iconBackground{display:inline-block;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";border-radius:50%;min-width:48px;height:48px;border-style:solid;border-width:1px;position:absolute}[dir=ltr] .od-SharingLink-iconBackground{margin-right:10px}[dir=rtl] .od-SharingLink-iconBackground{margin-left:10px}.od-SharingLink-url .od-SharingLink-cell{width:100%}.od-SharingLink-table{display:table;width:100%}.od-SharingLink-row{display:table-row}.od-SharingLink-input{width:100%;text-overflow:ellipsis;margin-bottom:3px;margin-top:5px}.od-SharingLink-removeLinkButton{margin:0;padding:5px;border:0;background:0 0;cursor:pointer;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .od-SharingLink-removeLinkButton-leftMargin{margin-left:4px}[dir=rtl] .od-SharingLink-removeLinkButton-leftMargin{margin-right:4px}.od-SharingLink-linkSwitcher{display:inline;cursor:pointer}.od-SharingLink-linkMember{display:inline-block;padding:2px 4px}.od-SharingLink-linkMember .ms-Icon{font-size:12px;width:24px;text-align:center;line-height:24px}.od-SharingLink-linkUser{width:200px}.od-SharingLink-linkUser .ms-Icon.ms-Icon--ChevronDown,.od-SharingLink-linkUser .ms-Icon.ms-Icon--ChevronUp{width:24px;height:24px;border-radius:50%;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";display:inline-block;margin:0 4px;line-height:24px}.od-SharingLink-linkUser .ms-Icon--ChevronDown:before,.od-SharingLink-linkUser .ms-Icon--ChevronUp:before,.od-SharingLink-linkUser .ms-Icon.ms-Icon--ChevronUp:before,.od-SharingLink-linkUser .ms-Icon.ms-Icon--chevronDown:before{line-height:24px;display:table-cell;width:24px;text-align:center}.od-SharingLink-chevron{font-size:11px}[dir=ltr] .od-SharingLink-chevron{margin-left:4px}[dir=rtl] .od-SharingLink-chevron{margin-right:4px}.od-SharingLink-sharingHint{display:inline;border:none;background:0 0;padding:0;cursor:pointer;font-size:12px;font-weight:400}html[dir=ltr] .od-SharingLink-sharingHint{text-align:left}html[dir=rtl] .od-SharingLink-sharingHint{text-align:right}.od-SharingLink-anonymous{color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.od-SharingLink-csl{color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}.od-SharingLink-psl{color:"},{theme:"orangeLighter",defaultValue:"#ff8c00"},{rawString:"}.od-SharingLink-generic{border-color:transparent}.od-SharingLink-anonymous-bg{background-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:";border-color:"},{theme:"green",defaultValue:"#107c10"},{rawString:";opacity:.1}.od-SharingLink-csl-bg{background-color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:";border-color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:";opacity:.1}.od-SharingLink-psl-bg{background-color:"},{theme:"orangeLighter",defaultValue:"#ff8c00"},{rawString:";border-color:"},{theme:"orangeLighter",defaultValue:"#ff8c00"},{rawString:";opacity:.1}.od-SharingLink-generic-bg{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";border-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir=ltr] .od-SharingLink-lock{margin-left:12px}html[dir=rtl] .od-SharingLink-lock{margin-right:12px}.od-SharingLink-sharingHintContainer{display:-ms-flexbox;display:flex}"}])});
define("odsp-next/actions/showPermissions/ShowPermissionsExecutorCommandSet",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","../../utilities/features/Features","../../utilities/icons/Icon","../../controls/commands/Commands.resx","../../controls/sharing/share/commands/ShareCommandBuilder","../../controls/sharing/share/odc/CommandBuilder","@ms/odsp-shared-sharing/lib/interfaces/SharingInterfaces","../../controls/sharing/share/odc/Share.key"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.commands=r.observableArray();n.engagementSource=t.engagementSource;var i,h=s.isFeatureEnabled(s.UseNewShareDialog);h&&((i=new(n.managed(f.default))({renderLabel:2,mode:l.Mode.share,itemsKey:c.manageAccessShareResourceKey,text:u.strings.Share,tooltip:u.strings.ShareCommandTooltipV3,icon:r.observable(new o.default("Share")),keys:["S"],engagementName:"newShareCommand",isHidden:r.observable(!1)}).command).payload.calloutLayerProps={styles:{root:{zIndex:600}}});n.commands=h?n.observables.createArray([i]):n.observables.createArray([new(n.managed(a.default))({renderLabel:2,mode:2,item:t.item}).command]);s.isFeatureEnabled(s.AddPeopleReact)&&n.commands.push(new(n.managed(a.default))({renderLabel:2,mode:4,item:t.item}).command);return n}return t}(i.default);t.default=h});
define("odsp-next/controls/malwareDetected/malwareDetectedMessage/MalwareDetectedMessage",["require","exports","react","office-ui-fabric-react/lib/MessageBar","@ms/odsp-utilities/lib/string/StringHelper","../MalwareDetectedMessage.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.malwareDetectedMessage=function(){var e=n.createElement("a",{key:"learn_more_link",href:"https://go.microsoft.com/fwlink/?linkid=862871",target:"_blank"},s.strings.malwareDetectedMessageLearnMore),t=i.formatToArray(s.strings.malwareDetectedMessage,e);return n.createElement(r.MessageBar,{messageBarType:r.MessageBarType.severeWarning,isMultiline:!0},t)}});
define("odsp-next/actions/showPermissions/ShowPermissionsExecutor.html",[],function(){return'\x3c!--ko component: {\r\n name: panelOverlayTagName,\r\n params: {\r\n ariaLabel: permissionsPanelName,\r\n onClose: $component.onClosePanel.bind($component),\r\n virtualParentElement: virtualParentElement\r\n }\r\n }--\x3e\x3c!--ko if: showShareCommands--\x3e<div class="od-ShowPermissions-commandBar od--hasSelection" data-bind="control: commandBarSpecification"></div>\x3c!--/ko--\x3e<div class=od-PermissionsPanel-container data-bind="css: { \'od-PermissionsPanel-container-withCommandbar\': showShareCommands }">\x3c!--ko if: isManageAccessInReactEnabled--\x3e<div class=od-PermissionsPanel-titleBar--react><div class="od-PermissionsPanel-fileName manageAccessInReactEnabled-fileName">\x3c!--ko component: { name: FileNameWithIconTagname, params: { oneDriveItem: fileItem} }--\x3e\x3c!--/ko--\x3e</div><div class="od-PermissionsPanel-head manageAccessInReactEnabled-head" data-bind="text: permissionsPanelName"></div><div class=od-PermissionsPanel-stopSharing data-bind="visible: canUnshare"><a role=button href=javascript:; data-bind="click: stopSharing, text: stopSharingText"></a><br></div></div>\x3c!--ko if: isItemMalwareDetected--\x3e<div class=od-PermissionsPanel-malwareDetectedMessageBar--react data-bind="react: { componentType: malwareDetectedMessageComponent }"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot: isManageAccessInReactEnabled--\x3e<div class=od-PermissionsPanel-titleBar><div class=od-PermissionsPanel-head data-bind="text: permissionsPanelName"></div><div class=od-PermissionsPanel-fileName>\x3c!--ko component: { name: FileNameWithIconTagname, params: { oneDriveItem: fileItem} }--\x3e\x3c!--/ko--\x3e</div><button class=od-PermissionsPanel-stopSharing data-bind="visible: canUnshare, click: stopSharing, text: stopSharingText"></button></div>\x3c!--/ko--\x3e\x3c!--ko if: isManageAccessInReactEnabled--\x3e<div class=od-PermissionsPanel-content-React><div class=od-PermissionsPanel-table><div class=od-PermissionsPanel-row><div class=od-PermissionsPanel-cell data-bind="react: { componentType: shareComponent, props: shareComponentProps }"></div></div>\x3c!--ko if: canManagePermissions()--\x3e<div class=od-PermissionsPanel-linksBox-row><div class=od-PermissionsPanel-linksBox-cell data-bind="if: hasSettings()"><a target=_blank data-bind="attr: {href: advancedUrl}, text: advancedText, visible: canShowAdvanced, click: onAdvancedClick"></a></div></div>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: isManageAccessInReactEnabled--\x3e<div class=od-PermissionsPanel-content><div class=od-PermissionsPanel data-bind="keyboard: keyNav.keyboardOptions, selection: { data: keyNav.focusableTiles, mode: \'single\', direction: \'vertical\', focused: keyNav.focusedTile }">\x3c!--ko if: !isLoading() && isShareLinkVisible && !showShareCommands--\x3e<div class=od-PermissionsPanel-addPeople><a role=button href=# data-bind="click: onPermissionsPanelShareClick, hasFocus: hasFocus"><div class=od-PermissionsPanel-addPeople-icon><i class="ms-Icon ms-Icon--PeopleAdd" data-bind="icon: true"></i></div><span class=od-PermissionsPanel-addPeople-text data-bind="text: addPeopleText"></span></a></div>\x3c!--/ko--\x3e\x3c!--ko if: isItemMalwareDetected--\x3e<div class=od-PermissionsPanel-malwareDetectedMessageBar data-bind="react: { componentType: malwareDetectedMessageComponent }"></div>\x3c!--/ko--\x3e<span role=alert class=ms-accessible data-bind="text: updateComplete, visible: readPermissionsUpdated()"></span>\x3c!--ko if: !isLoading()--\x3e<div class=od-PermissionsPanel-links data-bind="foreach: { data: links, as: \'link\' }"><div class=od-PermissionsPanel-link data-bind="component: { name: $component.sharingLinkTagName, params: { link: link, isShareLinkVisible: $component.isShareLinkVisible, onLinkRemoved: function() { $component.onLinkRemoved(); } } }"></div></div><div class=od-PermissionPanel-shareScope data-bind="foreach: { data: scopes, as: \'scope\' }"><div class=od-PermissionPanel-shareScopeHeader data-bind="bindableHtml: headerHtml"></div><div class=od-PermissionPanel-shareEntities data-bind="foreach: { data: people, as: \'person\' }">\x3c!--ko if: person.sharingInfo.link--\x3e<div class=od-PermissionsPanel-link data-bind="component: { name: $component.sharingLinkTagName, params: { link: person.sharingInfo.link, isShareLinkVisible: $component.isShareLinkVisible, onLinkRemoved: function() { $component.onLinkRemoved(); }, isEditable: $component.isPremium() } }"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: person.sharingInfo.link--\x3e\x3c!--ko with: $component.getTileForPerson(person)--\x3e<div class=od-PermissionsPanel-entity data-bind="component: { name: $component.personaTileTagName, params: { canManagePermissions: $component.canManagePermissions(), tile: $data } }"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div></div>\x3c!--ko if: canManagePermissions()--\x3e<div class=od-PermissionsPanel-linksBox data-bind="if: hasSettings()"><a target=_blank data-bind="attr: {href: advancedUrl}, text: advancedText, visible: advancedUrl(), click: onAdvancedClick"></a></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e</div>\x3c!--ko component: { name: dialogHostTagName }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});
define("odsp-next/actions/showPermissions/ShowPermissionsExecutor.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-PermissionsPanel-malwareDetectedMessageBar{padding:0 40px 20px 0}html[dir=rtl] .od-PermissionsPanel-malwareDetectedMessageBar{padding:0 0 20px 40px}.od-PermissionsPanel-malwareDetectedMessageBar--react{padding-bottom:20px}.od-PermissionsPanel-titleBar--react{padding-top:10px;padding-bottom:32px}[dir=ltr] .od-PermissionsPanel-titleBar--react{padding-left:20px}[dir=rtl] .od-PermissionsPanel-titleBar--react{padding-right:20px}.manageAccessInReactEnabled-fileName{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.manageAccessInReactEnabled-head{font-weight:300;padding-top:15px;padding-bottom:6px}.od-PermissionsPanel-content-React{height:calc(100% - 145px);overflow-y:auto;overflow-x:hidden}.od-PermissionsPanel-content-React .od-Share{width:340px}.od-PermissionsPanel-table{display:table;height:100%}.od-PermissionsPanel-linksBox-row,.od-PermissionsPanel-row{display:table-row}.od-PermissionsPanel-cell{display:table-cell;vertical-align:top}.od-PermissionsPanel-linksBox-cell{display:table-cell;vertical-align:bottom;padding-bottom:24px;font-size:12px}html[dir=ltr] .od-PermissionsPanel-linksBox-cell{text-align:right}html[dir=rtl] .od-PermissionsPanel-linksBox-cell{text-align:left}[dir=ltr] .od-PermissionsPanel-linksBox-cell{padding-right:17px}[dir=rtl] .od-PermissionsPanel-linksBox-cell{padding-left:17px}"}])});
define("odsp-next/actions/showSuggestedFiles/ShowSuggestedFilesExecutor",["require","exports","./ShowSuggestedFilesExecutorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ShowSuggestedFilesExecutor.html"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-show-suggestedFiles-executor",template:e("./ShowSuggestedFilesExecutor.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/actions/showSuggestedFiles/ShowSuggestedFilesExecutorViewModel",["require","exports","tslib","../base/ControlExecutorViewModel","../../controls/overlays/panel/PanelOverlay","../../bindings/react/ReactBinding","../../controls/vaultSuggestCard/react/VaultSuggestedFileTypeList","../../controls/vaultSuggestCard/VaultSuggestCard.resx"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({react:s.default});n.panelOverlayTagName=i.default.tagName;n.suggestedFilesPanelName=u.strings.SuggestedFilesPanelName;n.suggestedFilesPanelDescription=u.strings.SuggestedFilesPanelDescription;n.suggestedFileTypeListComponent=o.default;n.suggestedFileTypeListProps=n.createPureComputed(n._updatesuggestedFileTypeListProps);return n}t.prototype.onClosePanel=function(){this.action.complete()};t.prototype._updatesuggestedFileTypeListProps=function(){return{resources:this.resources,onPanelDismissed:this.onClosePanel.bind(this)}};return t}(r.default);t.default=a});
define("odsp-next/controls/vaultSuggestCard/react/VaultSuggestedFileTypeList",["require","exports","tslib","react","office-ui-fabric-react/lib/List","office-ui-fabric-react/lib/Button","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","office-ui-fabric-react/lib/common/DirectionalHint","../../../resources/ControlResourceKeys","../VaultSuggestCard.resx","../VaultSuggestedFileTypeList.css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onRenderCell=function(e,t){return r.createElement("div",{className:"od-SuggestedFiles-TypeCell","data-is-focusable":!0},r.createElement("div",{className:"od-SuggestedFiles-TypeName"},e),r.createElement(s.DefaultButton,{iconProps:{iconName:"More"},onRenderMenuIcon:function(){},className:"od-SuggestedFiles-MoreCommands",menuProps:n._getMenuProps(e,t)}))};n._uploadAction=function(e){n.props.onPanelDismissed();n._uploadFileAction.execute(e)};n._onMenuOpened=function(e){if(e&&e.ariaLabel){var t=n._getTypeName(e.ariaLabel);t&&o.Engagement.logData({name:"Vault.SuggestedFile."+t+".Clicked"})}console.log("... clicked, "+(e&&e.title))};n._moveExistingAction=function(e){n.props.onPanelDismissed();(new(n.resources.injected(n.actionMap.AddToFolderAction))).execute(e)};n.resources=t.resources;n.actionMap=n.resources.consume(f.actionMap);n._fileTypeList=n._getFileTypes();n._uploadFileAction=new(n.resources.injected(n.actionMap.UploadAction))({uploadProcessorType:u.UploadProcessorType.Html5file});return n}t.prototype.render=function(){return r.createElement("div",{className:"od-SuggestedFiles-TypeList"},r.createElement(i.List,{items:this._fileTypeList,onRenderCell:this._onRenderCell}))};t.prototype._getFileTypes=function(){return[l.strings.Passport,l.strings.DriversLicense,l.strings.TaxRecords,l.strings.BirthCertificate,l.strings.AutomotiveInsurance,l.strings.CreditReport,l.strings.FinancialPlan,l.strings.FinancialBudget,l.strings.IncomeRecords,l.strings.HomeInsurance,l.strings.ApartmentInsurance,l.strings.CyberInsurance,l.strings.VehicleInformation,l.strings.TravelDocument,l.strings.IdentificationDocument,l.strings.WorkIdentification,l.strings.SchoolIdentification,l.strings.ProfessionalLicense,l.strings.PropertyRecord,l.strings.PropertyDeed,l.strings.EducationalTranscript,l.strings.EducationalDegree,l.strings.ImmigrationDocuments,l.strings.PowerOfAttorney,l.strings.BusinessFormationDocument,l.strings.Other]};t.prototype._getMenuProps=function(e,t){return{ariaLabel:e,shouldFocusOnMount:!0,directionalHint:a.DirectionalHint.bottomRightEdge,directionalHintFixed:!0,onMenuOpened:this._onMenuOpened,items:[this._getUploadCommand(),this._getMoveCommand()]}};t.prototype._getUploadCommand=function(){return{key:"upload",name:l.strings.UploadFile,onClick:this._uploadAction}};t.prototype._getTypeName=function(e){for(var t=0,n=Object.keys(l.strings);t<n.length;t++){var r=n[t];if(l.strings[r]===e)return r}return""};t.prototype._getMoveCommand=function(){return{key:"move",name:l.strings.MoveExistingLink,onClick:this._moveExistingAction}};return t}(r.Component);t.default=c});
define("odsp-next/controls/vaultSuggestCard/VaultSuggestedFileTypeList.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-SuggestedFiles-TypeCell{display:-ms-flexbox;display:flex;min-height:32px}.od-SuggestedFiles-TypeCell:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-SuggestedFiles-TypeName{font-size:14px;width:100%;padding:6px 0}.od-SuggestedFiles-MoreCommands{min-width:32px;max-width:32px;background-color:transparent;padding:0}.od-SuggestedFiles-TypeList{padding:8px 0}.od-SuggestedFiles-TypeImage{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";margin:8px}"}])});
define("odsp-next/actions/showSuggestedFiles/ShowSuggestedFilesExecutor.html",[],function(){return'\x3c!--ko component: {\r\n name: panelOverlayTagName,\r\n params: {\r\n ariaLabel: suggestedFilesPanelName,\r\n width: 320,\r\n onClose: $component.onClosePanel.bind($component)\r\n }\r\n }--\x3e<div class=od-SuggestedFiles-container><div class=od-SuggestedFiles-titleBar><div class=od-SuggestedFiles-head data-bind="text: suggestedFilesPanelName"></div></div><div class=od-SuggestedFiles-description data-bind="text: suggestedFilesPanelDescription"></div><div class=od-SuggestedFiles-activities data-bind="react: { componentType: suggestedFileTypeListComponent, props: suggestedFileTypeListProps }"></div></div>\x3c!--/ko--\x3e'});
define("odsp-next/actions/showVersionHistoryAction/ShowReactVersionHistoryExecutor",["require","exports","./ShowReactVersionHistoryExecutorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ShowReactVersionHistoryExecutor.html","./VersionHistory.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-show-version-history-executor",template:e("./ShowReactVersionHistoryExecutor.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/actions/showVersionHistoryAction/ShowReactVersionHistoryExecutorViewModel",["require","exports","tslib","../base/ControlExecutorViewModel","../../bindings/react/ReactBinding","../../bindings/html/BindableHtmlBinding","../../controls/versionHistory/VersionHistory.resx","../../controls/overlays/panel/PanelOverlay","../../providers/versionHistory/VersionHistoryProvider","../../controls/versionHistory/react/ReactVersionHistoryList"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({bindableHtml:s.default,react:i.default});n.panelTagName=u.default.tagName;n.panelSize="Medium";n.panelTitle=o.strings.panelName;var r=t.item,l=n.createObservable([]);n.addBindingHandlers({react:i.default});n.resources.consume(a.resourceKey).getVersionHistoryInfo(r()).then(function(e){l(e)});n.listComponent=f.default;n.listComponentProps={items:l,fileItem:r(),resources:n.resources};n.virtualParentElement=t.event?n._getVirtualParent(t.event.target):void 0;return n}t.prototype.onClosePanel=function(){this.action.complete()};t.prototype._getVirtualParent=function(e){for(;e;){if("true"===e.getAttribute("data-overlay-parent"))return e;e=e.parentElement}};return t}(r.default);t.default=l});
define("odsp-next/providers/versionHistory/VersionHistoryProvider",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../resources/DataSourceResourceKeys"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this._dataSource=t.dataSource}e.prototype.getVersionHistoryInfo=function(e){return this._dataSource.getVersionHistoryInfo(e)};e.prototype.restoreVersionByLabel=function(e,t){return this._dataSource.restoreVersionByLabel(e,t)};e.prototype.deleteVersionByLabel=function(e,t){return this._dataSource.deleteVersionByLabel(e,t)};e.prototype.canRestoreVersions=function(e){return this._dataSource.canRestoreVersions(e)};e.prototype.canDeleteVersions=function(e){return this._dataSource.canDeleteVersions(e)};e.prototype.showVersionLabel=function(){return this._dataSource.showVersionLabel()};return e}();t.default=i;t.resourceKey=n.createResolvedResourceKey(e("module").id,i,{dataSource:r.versionHistory})});
define("odsp-next/controls/versionHistory/react/ReactVersionHistoryList",["require","exports","tslib","react","office-ui-fabric-react/lib/DetailsList","@ms/odsp-shared/lib/base/BaseModel","office-ui-fabric-react/lib/utilities/selection/index","@ms/odsp-utilities/lib/scope/Scope","office-ui-fabric-react/lib/common/DirectionalHint","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/ContextualMenu","@ms/odsp-utilities/lib/string/DriveSpaceHelper","@ms/odsp-utilities/lib/dateTime/DateTime","../../../resources/ControlResourceKeys","../../../providers/versionHistory/VersionHistoryProvider","../../../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../models/item/OneDriveItem","../VersionHistory.resx","../../commands/Commands.resx","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/graft/Graft","../../list/react/detailsList/fields/UserRenderer","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../fluentStyling/FluentStyling.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var N=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.resources=t.resources;n.fileItem=t.fileItem;n.state={items:[],onItemContextMenu:null,menuProps:null};n._versionHistoryProvider=n.resources.consume(d.resourceKey);n.columns=n._getColumns();n.selectionMode=t.selectionMode;n.scope=new u.default;n.observables=n.scope.attach(new(n.resources.consume(s.observablesFactoryTypeResourceKey))({owner:n}));n._actionMap=n.resources.consume(p.actionMap);n._platform=n.resources.consume(x.platformDetection);n._isFluentEnabled=n.resources.consume(T.resourceKey);return n}t.prototype.UNSAFE_componentWillMount=function(){this.observables.compute(this._computeItems).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}})};t.prototype.render=function(){var e=this.state,t=e.items,s=e.onItemContextMenu,u=e.menuProps;return r.createElement("div",null,r.createElement(i.DetailsList,{items:t,columns:this.columns,selectionMode:o.SelectionMode.none,onItemContextMenu:s,getRowAriaLabel:this._getAriaLabel,className:"od-versionHistoryList",ariaLabel:"List of versions, use up and down arrow keys to navigate, use the SPACE key to select within the list."}),u&&r.createElement(l.ContextualMenu,n.__assign({},u)))};t.prototype._getAriaLabel=function(e){return y.strings.columnNameNumber+" "+e.versionLabel+", "+y.strings.columnNameModifiedDate+" "+e.created.toString()+", "+y.strings.columnNameModifiedBy+" "+e.createdBy.Title+", "+y.strings.columnNameSize+" "+c.default.getDisplayString(e.size,{ignoreZero:!0})};t.prototype._reLoadPage=function(){var e=this;this._versionHistoryProvider.getVersionHistoryInfo(this.fileItem).then(function(t){e.setState({items:t})})};t.prototype._computeItems=function(){var e=this,t=this.props.items();this.setState({items:t,onItemContextMenu:function(t,r,i){e.setState({menuProps:n.__assign({target:"#more-"+t.id},e._getMenuProps(t))})}})};t.prototype._modifiedDateOnRender=function(e,t,n){var i;i=this._isFluentEnabled?h.getFriendlyDateTimeStringPast(new Date(e.created)):r.createElement("a",{className:"od-modifiedDateColumn-modifiedDate","aria-label":w.format(y.strings.cellAriaLabel,y.strings.columnNameModifiedDate,h.getFriendlyDateTimeStringPast(new Date(e.created))),href:this._getOpenFileLink(e)},h.getFriendlyDateTimeStringPast(new Date(e.created)));return r.createElement("div",{className:"od-modifiedDateColumn"},i)};t.prototype._versionNumberOnRender=function(e,t,n){var i;i=this._isFluentEnabled?r.createElement("a",{className:"od-versionNumberColumn-versionNumber","aria-label":w.format(y.strings.cellAriaLabel,y.strings.columnNameNumber,e.versionLabel),href:this._getOpenFileLink(e)},e.versionLabel):e.versionLabel;return r.createElement("div",{"data-is-focusable":"true",className:"od-versionNumberColumn","aria-label":w.format(y.strings.cellAriaLabel,y.strings.columnNameNumber,e.versionLabel)},i)};t.prototype._onDotDotDotRender=function(e,t,i){var s=this,o=r.createElement(f.IconButton,{id:"more-"+e.id,className:"od-FieldRenderer-dot od-modifiedDateColumn-moreButton",role:"button",ariaLabel:y.strings.buttonNameDotdotdot,iconProps:{iconName:this._isFluentEnabled?"MoreVertical":"More"},onClick:function(){return s.setState({menuProps:n.__assign({target:"#more-"+e.id},s._getMenuProps(e))})}});return this._isFluentEnabled?r.createElement("div",{className:"od-FieldRenderer-dotDotDotContainer"},o):o};t.prototype._getColumns=function(){var e=this,t=[{key:"version.dotdotdot",name:"",columnActionsMode:i.ColumnActionsMode.disabled,ariaLabel:w.format(y.strings.columnHeaderAriaLabel,y.strings.columnNameDotdotdot),fieldName:null,minWidth:36,maxWidth:36,onRender:function(t,n,r){return e._onDotDotDotRender(t,n,r)}},{key:"version.modifiedBy",name:y.strings.columnNameModifiedBy,columnActionsMode:i.ColumnActionsMode.disabled,ariaLabel:w.format(y.strings.columnHeaderAriaLabel,y.strings.columnNameModifiedBy),fieldName:null,minWidth:80,maxWidth:160,onRender:function(t,n,r){return S.userRendererByUser([{title:t.createdBy.Title,email:t.createdBy.Email,picture:void 0,sip:t.createdBy.Email}],e.resources,{text:"version.modifiedBy",isDisabled:!1,ariaLabel:w.format(y.strings.cellAriaLabel,y.strings.columnNameModifiedBy,t.createdBy.Title)},"od-modifiedByColumn")}},{key:"version.size",name:y.strings.columnNameSize,columnActionsMode:i.ColumnActionsMode.disabled,ariaLabel:w.format(y.strings.columnHeaderAriaLabel,y.strings.columnNameSize),fieldName:null,minWidth:80,maxWidth:80,onRender:function(e,t,n){return r.createElement("div",{"data-is-focusable":"true",className:"od-fileSizeColumn","aria-label":w.format(y.strings.cellAriaLabel,y.strings.columnNameSize,c.default.getDisplayString(e.size,{ignoreZero:!0}))},e.size?c.default.getDisplayString(e.size,{ignoreZero:!0}):"")}}],n={key:"version.modifiedDate",columnActionsMode:i.ColumnActionsMode.disabled,name:y.strings.columnNameModifiedDate,ariaLabel:w.format(y.strings.columnHeaderAriaLabel,y.strings.columnNameModifiedDate),fieldName:null,minWidth:80,maxWidth:160,onRender:function(t,n,r){return e._modifiedDateOnRender(t,n,r)}};this._isFluentEnabled?t.splice(1,0,n):t.unshift(n);this._versionHistoryProvider.showVersionLabel()&&t.unshift({key:"version.number",name:y.strings.columnNameNumber,columnActionsMode:i.ColumnActionsMode.disabled,fieldName:null,minWidth:this._isFluentEnabled?80:40,maxWidth:this._isFluentEnabled?80:40,ariaLabel:w.format(y.strings.columnHeaderAriaLabel,y.strings.columnNameNumber),onRender:function(t,n,r){return e._versionNumberOnRender(t,n,r)}});return t};t.prototype._getOpenFileLink=function(e){var t=this.fileItem,n=new g.default(t.key);E.default(n,t);e.isCurrentVersion||E.default(n,{properties:{path:e.url}});var r=this.resources.consume(v.url),i=this.resources.consume(m.navigation),s=this._platform.isMac;return t.appMap&&!s?r.getOpenInOfficeClientUrl(n,i.viewParams):e.url};t.prototype._getMenuProps=function(e){var t=this;return{directionalHint:a.DirectionalHint.bottomAutoEdge,isBeakVisible:!1,items:this._getMenuItems(e),gapSpace:0,onDismiss:function(){return t.setState({menuProps:null})}}};t.prototype._getMenuItems=function(e){var t=this,n={key:"version.restore",name:y.strings.versionActionNameRestore,onClick:function(){t._versionHistoryProvider.restoreVersionByLabel(t.fileItem,e.versionLabel).then(function(e){e&&t._reLoadPage()})}},r={key:"version.open",name:y.strings.versionActionNameOpen,onClick:function(n,r){return new(t.resources.injected(t._actionMap.NavigationAction))({url:t._getOpenFileLink(e)}).execute(n)}},i={key:"version.download",name:b.strings.Download,onClick:function(n,r){return new(t.resources.injected(t._actionMap.NavigationAction))({url:t._getOpenFileLink(e)}).execute(n)}},s={key:"version.delete",name:y.strings.versionActionNameDelete,onClick:function(){t._versionHistoryProvider.deleteVersionByLabel(t.fileItem,e.versionLabel).then(function(e){e&&t._reLoadPage()})}},o=[];this._canRestoreVersion(e)&&o.push(n);this._platform.isMac?o.push(i):o.push(r);this._canDeleteVersion(e)&&o.push(s);return o};t.prototype._canDeleteVersion=function(e){return!e.isCurrentVersion&&this._versionHistoryProvider.canDeleteVersions(this.fileItem)};t.prototype._canRestoreVersion=function(e){return!e.isCurrentVersion&&this._versionHistoryProvider.canRestoreVersions(this.fileItem)};return t}(r.Component);t.ReactVersionHistoryList=N;t.default=N});
define("odsp-next/controls/list/react/detailsList/fields/UserRenderer",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","react","office-ui-fabric-react/lib/Utilities","knockout","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-datasources/lib/Permissions","../../../../../providers/bundleLoader/PageLoadMonitor","./../../../../../resources/ProviderResourceKeys","../../../../../resources/DataSourceResourceKeys","../../../../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/async/Async","../../../../peopleCard/PeopleCardCommons","../../../../../utilities/features/Features","../../../../../utilities/delayLoading/DelayLoadingHelper","./BaseText","@ms/odsp-list-utilities/lib/Renderers/BaseText","../../../../../controls/personaCard/EasyLpc","../../../../../dataSources/item/vroom/TopCollaboratorExperimentHelper","@ms/odsp-shared-react/lib/components/ReactDeferredComponent/index"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=new d.default,T=void 0,N=m.isFeatureEnabled(m.PeopleCardsReactComponent),C=m.isFeatureEnabled(m.PeopleCardsOnLoki),k=null;t.userRenderer=function(e){var t=e.item,n=e.column,r=e.resources,i=e.isDisabled,o=t.properties[n.key],u=Array.isArray(o)?o:o?[o]:[],a=t.properties.isDisabled||i,f=y.getCellText(t,n);return f||u.length?O(u,r,{text:f,withTopCollaborator:"sharedByUser"===n.key,isDisabled:a,ariaLabel:u.length?y.getAriaLabel(n,u[0].title):""},s.css("od-FieldRender","od-FieldRender-nofill",{"od-FieldRender-person":C||N,"od-FieldRenderer--disabled":a})):null};function L(e,t){var n=t.consume(c.profile.optional);if(n){var r=e.map(function(e){return e.sip});n.personRendered(r)}return{lastMouseMove:null,showCardTimeoutId:-1,prepareCardTimeoutId:-1}}t.generatePeopleCardState=L;function A(t){if(!T){var n=t.consume(c.bundleLoader);T=n.waitForPageRenderingComplete().then(function(){return new r.default(function(t,n){x.setTimeout(function(){t(a.loadModule({path:"../../../../personaCard/PersonaCardLauncher",getModule:function(){return new r.default(function(t,n){e(["../../../../personaCard/PersonaCardLauncher"],t,n)})}}))},1e3)})})}}t.loadPeopleCardComponent=A;function O(e,t,n,r){var s=e||[],o=n.text,u=n.ariaLabel,a=n.noTextRender,l=n.title,c=n.isDisabled,p=n.withTopCollaborator;if(t.consume(h.identity).getIdentity().type===f.IdentityType.anonymous)return i.createElement("div",null,s.map(function(e,t){return i.createElement("div",{key:t},i.createElement(b.BaseText,{text:e.title||o,isDisabled:c,ariaLabel:u,noTextRender:a,title:l}))}));N&&A(t);var d=L(s,t);return s.length?i.createElement("div",null,s.map(function(e,n){var s=M({resources:t,user:e,ariaLabel:u,isDisabled:c,withTopCollaborator:p,noTextRender:a,cellClassName:r,state:d});return i.createElement("div",{key:n},s)})):i.createElement(b.BaseText,{text:o,isDisabled:c,ariaLabel:u,noTextRender:a,title:l})}t.userRendererByUser=O;function M(t){var r=t.user,s=t.resources,o=t.ariaLabel,u=t.isDisabled,a=t.noTextRender,f=t.withTopCollaborator,h=r.email||r.sip;if(!h)return i.createElement(b.BaseText,{text:r.title,isDisabled:u,ariaLabel:o,noTextRender:a,title:r.title});if(t.resources.isExposed(p.pageContext)){var d=s.consume(p.pageContext),m=i.createElement(w.EasyLpc,{resourceScope:s,personaType:"User",identifier:h,loggingData:{name:"UserRenderer.LPC.Click"},placeHolder:i.createElement("span",{className:t.cellClassName},r.title)},i.createElement("span",{className:t.cellClassName,"data-is-focusable":!0,role:"button","aria-label":t.ariaLabel},r.title));return f&&E.topCollaboratorExperiment(d)?i.createElement("div",{className:"od-userWithTopCollaborator"},function(t,r){var s={load:function(){return new Promise(function(t,n){e(["@ms/odsp-shared-react/lib/components/TopCollaborator/TopCollaborator"],t,n)}).then(function(e){return e.TopCollaborator})},parse:void 0},o={userName:t.title,isPlaceholder:!t.isTopCollaborator},u=r.consume(l.resourceKey),a=g.waitForPageLoadWithTimeout(u),f={modulePath:"@ms/odsp-shared-react/lib/components/TopCollaborator/TopCollaborator",moduleLoader:s,customWaiter:a,props:o};return i.createElement(S.ReactDeferredComponent,n.__assign({},f))}(r,s),m):m}return i.createElement("span",{ref:function(e){N&&e&&r&&h?function(e,t,n){T&&T.then(function(r){k=e;r.personaRendered(e,t,n.consume(p.pageContext))})}(e,h,t.resources):k&&function(e,t,n){T&&T.then(function(r){r.personaRemoved(e,t,n.consume(p.pageContext))})}(e,h,t.resources)},className:t.cellClassName,"data-is-focusable":!0,role:"button","aria-label":t.ariaLabel,onMouseOut:function(e){return D(t.state)},onMouseMove:function(e){!function(e,t,n,r){void 0===r&&(r=null);if(N)return;if(e&&(e.sip||e.email)){if(-1===n.prepareCardTimeoutId){var i=t.consume(c.profile.optional);n.prepareCardTimeoutId=x.setTimeout(function(){return i.getPeopleCardData(e.email||e.sip)},v.PEOPLE_CARD_DATA_PRELOAD_DELAY)}n.lastMouseMove=r;n.lastMouseMove.persist();-1===n.showCardTimeoutId&&(n.showCardTimeoutId=x.setTimeout(function(){return _(e,t,r,!0)},v.PEOPLE_CARD_HOVER_DELAY))}}(r,t.resources,t.state,e)},onClick:function(e){_(r,t.resources,t.state,e)}},r.title)}t.getUserComponent=M;function _(t,n,i,s,u){void 0===s&&(s=null);void 0===u&&(u=!1);if(!N){(s=s||i.lastMouseMove).stopPropagation();s.preventDefault();s=o.utils.extend({},s);D(i);t&&(t.sip||t.email)&&a.loadModule({path:"../../../../personaCard/PersonaCardLauncher",getModule:function(){return new r.default(function(t,n){e(["../../../../personaCard/PersonaCardLauncher"],t,n)})}}).then(function(e){var r={name:t.title,email:t.email,image:t.picture,sip:t.sip||t.email,userId:t.sip};new(n.injected(e))(r).show(s,u)})}}function D(e){x.clearTimeout(e.showCardTimeoutId);x.clearTimeout(e.prepareCardTimeoutId);e.showCardTimeoutId=-1;e.prepareCardTimeoutId=-1;e.lastMouseMove=null}t.resourceKey=new u.ResourceKey({name:e("module").id,factory:new u.ConstantResourceFactory(t.userRenderer)})});
define("odsp-next/utilities/delayLoading/DelayLoadingHelper",["require","exports","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/events/EventGroup","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/async/Async"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=new o.default;t.loadModuleOnEvent=function(e,t){if(e){var s=e.eventSource,o=e.eventName,u=e.eventGroup,a=void 0===u?new r.default(this):u;return new i.default(function(e){a.on(s,o,function(){a.off(s,o);n.loadModule({path:t.path,getModule:t.getModule}).then(e)})})}return n.loadModule({path:t.path,getModule:t.getModule})};t.getReactDeferredComponentModuleLoader=function(){return{load:function(e,t){return n.loadModule({path:e,getModule:t}).then(function(t){var n;return(n={})[e]=t,n})},parse:void 0}};t.waitForPageLoadWithTimeout=function(e,t,n){void 0===t&&(t=1);void 0===n&&(n=1e3);var r=new s.default;(1===t?e.waitForPageRenderingComplete():e.waitForPLT()).then(function(){u.setTimeout(function(){return r.complete()},n)});return r.getPromise()}});
define("odsp-next/controls/list/react/detailsList/fields/BaseText",["require","exports","react","@ms/odsp-utilities/lib/string/StringHelper","../ReactDetailsList.resx","@ms/odsp-list-utilities/lib/Renderers/BaseText"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BaseText=function(e){var t=e.text,r=e.item,i=e.column,a=e.children,f=e.noTextRender,l=e.title,c=o(i,t),h=r&&r.properties.isDisabled||e.isDisabled;void 0===t&&(t=u(r,i));return n.createElement(s.BaseText,{text:t,isDisabled:h,ariaLabel:c,noTextRender:f,title:l},a)};function o(e,t){(!t||e.internalName&&"attachments"===e.internalName.toLowerCase()&&"0"===t)&&(t=i.strings.emptyValueAriaLabel);return r.format(i.strings.cellAriaLabel,e.name,t)}t.getAriaLabel=o;function u(e,t){var n="";if(e&&void 0===(n=e[t.key])&&e.properties){void 0===(n=e.properties[t.key])&&(n=e.recycleBinProperties[t.key]);n&&Array.isArray(n)&&(n=n.join(", "))}return n}t.getCellText=u;t.isCellChanged=function(e,t,n){return!(!e||!t)&&u(e,n)!==u(t,n)}});
define("@ms/odsp-list-utilities/lib/Renderers/BaseText",["require","exports","react","office-ui-fabric-react/lib/Utilities"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BaseText=function(e){var t=e.text,i=e.isDisabled,s=e.noTextRender,o=e.ariaLabel,u=e.children;t=t||" ";o=o||t;return n.createElement("div",{"aria-label":s?o:void 0,className:r.css(e.className,{"od-FieldRenderer--disabled":i})},s?null:n.createElement("span",null,t),u)}});
define("odsp-next/controls/personaCard/EasyLpc",["require","exports","tslib","react","../../resources/SPOResourceKeys","../../utilities/delayLoading/DelayLoadingHelper","@ms/odsp-shared-react/lib/components/LivePersonaCardAdapter/DeferredSpLivePersonaCard","./LpcCallbacks","../../providers/bundleLoader/PageLoadMonitor"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._pageContext=t.resourceScope.consume(i.pageContext);return n}t.prototype.render=function(){var e=this.props,t=e.personaType,n=e.identifier,i=e.locationId,f=e.placeHolder,l=e.resourceScope,c=e.loggingData,h=s.getReactDeferredComponentModuleLoader(),p=l.consume(a.resourceKey),d=s.waitForPageLoadWithTimeout(p);return r.createElement(o.DeferredSpLivePersonaCard,{moduleLoader:h,personaType:t,identifier:n,locationId:i,pageContext:this._pageContext,placeHolder:f,addGroupMembersCallback:u.makeAddMembersCallback(l),customWaiter:d,loggingData:c},this.props.children)};return t}(r.Component);t.EasyLpc=f});
define("@ms/odsp-shared-react/lib/components/LivePersonaCardAdapter/DeferredSpLivePersonaCard",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","../ReactDeferredComponent/index","@ms/odsp-utilities/lib/features/FeatureOverrides","./DeferredSpLivePersonaCard.scss"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={ODB:1596},a=function(t){n.__extends(i,t);function i(n,r){var i=t.call(this,n,r)||this;i._onActivate=function(){i.state.hovered||i.setState({hovered:!0})};var s={load:function(){return new Promise(function(t,n){e(["./SpLivePersonaCard"],t,n)}).then(function(e){return e.SpLivePersonaCard})}};i._deferredComponentProps={modulePath:"./SpLivePersonaCard",moduleLoader:s,props:i.props,customWaiter:i.props.customWaiter,placeHolder:i.props.placeHolder};i.state={hovered:!o.default.isFeatureEnabled(u)};return i}i.prototype.render=function(){var e=this.state.hovered;return r.createElement("div",{onMouseOver:this._onActivate,onClick:this._onActivate,onFocus:this._onActivate,onMouseDown:this._onActivate,onKeyDown:this._onActivate,className:"sp-deferredLivePersonaCard-root",tabIndex:-1},e?r.createElement(s.ReactDeferredComponent,n.__assign({},this._deferredComponentProps),this.props.children):this.props.children)};return i}(i.BaseComponent);t.DeferredSpLivePersonaCard=a;t.wrapWithDeferredSpLivePersonaCard=function(e,t){return r.createElement(a,n.__assign({},e),t)}});
define("@ms/odsp-shared-react/lib/components/ReactDeferredComponent/index",["require","exports","tslib","./ReactDeferredComponent"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/odsp-shared-react/lib/components/ReactDeferredComponent/ReactDeferredComponent",["require","exports","tslib","react","@uifabric/utilities/lib/hoist"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._deferLoadComponent=function(){!n.state.ComponentModule&&n.props.moduleLoader&&n.props.modulePath&&n.props.moduleLoader.load(n.props.modulePath,n.props.getModule).then(function(e){n.props.moduleLoader.parse&&(e=n.props.moduleLoader.parse(e));if(!e){var t="ReactDeferredComponent: component not found when loading "+n.props.modulePath+" - check your load and parse functions";console.error(t)}n._mounted?n.setState({ComponentModule:e}):n.state={ComponentModule:e}})};n._mounted=!1;n.state={ComponentModule:void 0};n._setupDeferLoadCallback(t);return n}t.prototype.render=function(){var e=this,t=this.state.ComponentModule;return t?r.createElement(t,n.__assign({ref:function(t){t&&i.hoistMethods(e,t)}},this.props.props),this.props.children):this.props.placeHolder||null};t.prototype.componentDidMount=function(){this._mounted||(this._mounted=!0)};t.prototype.UNSAFE_componentWillReceiveProps=function(e){this._setupDeferLoadCallback(e)};t.prototype._setupDeferLoadCallback=function(e){var t=e.customWaiter;t?t.then(this._deferLoadComponent):this._deferLoadComponent()};return t}(r.Component);t.ReactDeferredComponent=s});
define("@ms/odsp-shared-react/lib/components/LivePersonaCardAdapter/DeferredSpLivePersonaCard.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".sp-deferredLivePersonaCard-root{display:inline-block}\n"}])});
define("odsp-next/controls/personaCard/LpcCallbacks",["require","exports","../../resources/ControlResourceKeys"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.makeAddMembersCallback=function(e){return function(t){var r,i,s,o=e.consume(n.actionMap);r=o.LaunchGroupMembershipPanelAction,i=new(e.injected(r))({}),s=function(){i.dispose()},i.execute(null).done(s,s)}}});
define("odsp-next/dataSources/item/vroom/TopCollaboratorExperimentHelper",["require","exports","@ms/sp-experiments/lib/flightsonrails/SPExperiment"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.topCollaboratorExperiment=function(e){switch(n.getVariantAndLogExposure(90012,e)){case 1:return!0;default:return!1}}});
define("@ms/sp-experiments/lib/flightsonrails/SPExperiment",["require","exports","@ms/odsp-utilities/lib/navigation/AddressParser","./Experiment.event"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=9e4,s="expOverrides",o=function(){function e(t,r){this._isAATest=!1;this._isOverride=!1;this._variantToDisplay=0;this._experimentId=t;var o,u=n.deserializeQuery((window.location.search||"").substr(1));try{o=JSON.parse(u[s]||"")}catch(e){o=[]}for(var a=0,f=o;a<f.length;a++){var l=f[a];if(l&&2===l.length&&l[0]===t){this._setProperties(l[1],l[1],!1,!0);return}}if(void 0===r.experimentData||void 0===r.experimentDataLookup||this._experimentId<i){this._variantToDisplay=0;this._variantToLog=void 0}else{var c=t-i,h=e._decodeAt(r.experimentData,c);if(0===h)this._setProperties(0,void 0,!1,!1);else if(h>=1&&h<=4)this._setProperties(h-1,h-1,!1,!1);else if(5===h){var p=e._lookup(r.experimentDataLookup,c);this._setProperties(p,p,!1,!1)}else if(h>=6&&h<=9)this._setProperties(0,h-6,!0,!1);else if(10===h)this._setProperties(0,e._lookup(r.experimentDataLookup,c),!0,!1);else if(h>=11&&h<=14)this._setProperties(h-11,h-11,!1,!0);else{p=e._lookup(r.experimentDataLookup,c);this._setProperties(p,p,!1,!0)}}}Object.defineProperty(e.prototype,"variantToDisplay",{get:function(){return this._variantToDisplay},enumerable:!0,configurable:!0});e._decodeAt=function(t,n){if(n>Math.floor(3*t.length/2)-1)return 0;var r=Math.floor(n/3*2);switch(n%3){case 0:return e._ctoi(t[r])>>2;case 1:return(3&e._ctoi(t[r]))<<2|e._ctoi(t[r+1])>>4;case 2:return 15&e._ctoi(t[r])}return 0};e._ctoi=function(e){var t=e.charCodeAt(0);return t>=65&&t<=90?t-65:t>=97&&t<=122?t-71:t>=48&&t<=57?t+4:43===t?62:63};e._lookup=function(e,t){var n=t.toString(36);n=Array(4-n.length).join("0")+n;for(var r=0;r<e.length;r++)for(var i=0;i<e[r].length-2;i+=3)if(e[r].substring(i,i+3)===n)return r+4;return 0};e.prototype.logExposure=function(){if(void 0!==this._variantToLog){var e={experimentId:this._experimentId,variant:this._variantToLog,isAATest:this._isAATest,isOverride:this._isOverride};r.Experiment.logData(e);this._variantToLog=void 0}};e.prototype._setProperties=function(e,t,n,r){this._variantToDisplay=e;this._variantToLog=t;this._isAATest=n;this._isOverride=r};return e}();t.getVariantAndLogExposure=function(e,t){var n=new o(e,t);n.logExposure();return n.variantToDisplay};t.getExperiment=function(e,t){return new o(e,t)}});
define("@ms/sp-experiments/lib/flightsonrails/Experiment.event",["require","exports","@ms/telemetry-manager/lib/SingleEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Experiment=n.createSingleEvent({eventName:"ExperimentFlight,",shortEventName:"ExperimentFlight"},{experimentId:{isPrefixingDisabled:!0,type:2},variant:{isPrefixingDisabled:!0,type:2},isAATest:{isPrefixingDisabled:!0,type:3},isOverride:{isPrefixingDisabled:!0,type:3}})});
define("odsp-next/actions/showVersionHistoryAction/ShowReactVersionHistoryExecutor.html",[],function(){return'\x3c!--ko component: {\r\n name: panelTagName,\r\n params: {\r\n ariaLabel: panelTitle,\r\n size: panelSize,\r\n onClose: $component.onClosePanel.bind($component),\r\n virtualParentElement: virtualParentElement\r\n }\r\n}--\x3e<div class=od-versionHistory-panelTitle data-bind="text: panelTitle"></div><div class=od-versionHistory-container role=application><div data-bind="react: { componentType: listComponent, props: listComponentProps }"></div></div>\x3c!--/ko--\x3e'});
define("odsp-next/actions/showVersionHistoryAction/VersionHistory.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-versionHistory-panelTitle{top:50px;position:absolute;padding-bottom:20px;font-size:20px}.isFluent .od-versionHistory-panelTitle{top:36px;font-weight:600}.isFluent .od-versionHistoryList .ms-DetailsRow:hover .od-versionNumberColumn-versionNumber{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.isFluent .od-versionNumberColumn-versionNumber{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.isFluent .od-versionNumberColumn-versionNumber:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-versionHistory-container{position:absolute;top:100px;overflow:auto}.isFluent .od-versionHistory-container{top:92px;left:0;padding:0 16px;box-sizing:border-box;width:100%}.od-versionHistory-container .od-fileSizeColumn,.od-versionHistory-container .od-modifiedByColumn,.od-versionHistory-container .od-versionNumberColumn{line-height:32px}.isFluent .od-versionHistory-container .od-fileSizeColumn,.isFluent .od-versionHistory-container .od-modifiedByColumn,.isFluent .od-versionHistory-container .od-versionNumberColumn{line-height:normal}.od-versionHistory-container .od-modifiedDateColumn{height:32px;line-height:32px}.isFluent .od-versionHistory-container .od-modifiedDateColumn{height:auto;line-height:normal}.od-versionHistory-container .od-FieldRenderer-dot.od-modifiedDateColumn-moreButton.ms-Button.ms-Button--icon{margin:0}"}])});
define("odsp-next/actions/switchPhotoFolderLayoutType/odc/SwitchPhotoFolderLayoutTypeExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../../resources/ControlResourceKeys","../../NavigationAction","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._viewParams=n.resources.consume(s.viewParams);return n}t.prototype.execute=function(e){var t=u.extend({},this._viewParams.peek());t.ft?delete t.ft:t.ft=8..toString();return new(this.managed(o.default))({url:"#"+i.serializeQuery(t),ignoreHistory:!0}).execute(null)};return t}(r.default);t.default=a});
define("odsp-next/actions/addToAlbum/odc/AddToAlbumExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../controls/commands/Commands.resx","../../../controls/addToAlbum/AddToAlbum","@ms/odsp-utilities/lib/logging/events/Qos.event","../../base/ItemRedeemer"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.actionName,i=t.itemSelectionHelper,s=t.panelProvider;n.name=r;n._itemSelectionHelper=i;n._panelProvider=s;n._itemReedemer=new(n.managed(u.default));return n}t.prototype.execute=function(e){var t=this;return this._itemSelectionHelper.resolveSelection().then(function(e){return t._itemReedemer.redeemItems(e,t).then(function(){var n=t._panelProvider.requestPanel({title:i.strings.AddToAlbum,component:{name:s.default.tagName,params:{selection:e,onComplete:function(){n.state(1)}}}});return n.wait().then(function(){return{resultType:o.ResultTypeEnum.Success}},function(){return{resultType:o.ResultTypeEnum.Failure}})})})};return t}(r.default);t.default=a});
define("odsp-next/controls/addToAlbum/AddToAlbum",["require","exports","./AddToAlbumViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./AddToAlbum.html","./AddToAlbum.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-add-to-album",template:e("./AddToAlbum.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/addToAlbum/AddToAlbumViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../providers/album/AlbumProvider","../../providers/item/ItemProvider","../../actions/createAlbum/CreateAlbumHelper","../../resources/DataSourceResourceKeys","./AddToAlbum.resx","../commands/Commands.resx","../progressSpinnerFlat/ProgressSpinnerFlat","../image/frame/ImageFrame","../../bindings/keyboard/KeyboardBinding","../../models/item/OneDriveItem","../../models/itemSet/ItemSet","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../../actions/createAlbum/CreateAlbumOperator","../../controls/fluentStyling/FluentStyling.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.thumbnailSize={width:50,height:50};n._albumProvider=n.resources.consume(i.resourceKey);n._urlDataSource=n.resources.consume(u.url);n._itemProvider=n.resources.consume(s.resourceKey);n._onComplete=t.onComplete;n.addBindingHandlers({keyboard:h.default});n.newAlbumName=n.createObservable("");n.newAlbumPlaceholder=a.strings.newAlbumPlaceholder;n.emptyAlbumListTitle=a.strings.emptyAlbumListTitle;n.emptyAlbumListBody=a.strings.emptyAlbumListBody;n.albumListTitle=a.strings.albumListTitle;n.createNewAlbumText=f.strings.CreateCommit;n.closeText=f.strings.Close;n.savingText=f.strings.Saving;n.progressSpinnerFlatTagName=l.default.tagName;n.imageFrameTagName=c.default.tagName;n.isLoading=n.createObservable(!0);n.isMakingRequest=n.createObservable(!1);n.isSubmitDisabled=n.createComputed(n._computeSubmitDisabled);n.selection=t&&t.selection;n.createNewAlbumInputIsVisible=n.createObservable(!1);n.nameCollisionErrorString=n.createObservable("");n.hasError=n.createComputed(n._computeHasError);n.emptyAlbumListImgSrc=window.require.toUrl("odsp-media/images/album/empty-albums-list.svg");n.shouldShowEmptyAlbumList=n.createObservable(!1);n.isFluentEnabled=n.resources.consume(g.resourceKey);if(!n.selection)throw new Error("No items passed to Add to Album control");var r=new p.default,o=new d.default;o.item=n.createObservable(r);n.itemSet=n.createObservable(o);n.itemSet.equalityComparer=v.objectStrictEquality;n.children=n.observables.createArray([]);n.children.equalityComparer=v.arrayStrictEquality;n.init();n.createComputed(function(){n.newAlbumName();n.nameCollisionErrorString("")});return n}t.prototype.init=function(){var e=this,t={parentKey:this._albumProvider.getAlbumsParentKey({}),ownerId:this._urlDataSource.getOwnerId(),pageSize:100,startIndex:0,isAscending:!1};this.itemSet(this._itemProvider.getItemSync(t));this._itemProvider.getItem(t).then(function(t){e.isLoading(!1);e._updateChildrenSet()},function(e){})};t.prototype.onClickAlbumRow=function(e,t){this.isMakingRequest(!0);var n={album:e,items:this.selection};this._albumProvider.addToAlbum(n);this._onComplete()};t.prototype.createNewAlbum=function(e,t){var n=this,r=this.unwrapObservable(this.newAlbumName).trim(),i=this.selection,s=o.validateAlbumCreation(i,r);if(s){this.nameCollisionErrorString(s);return!1}this.isMakingRequest(!0);this.resources.consumeAsync(m.typeResourceKey).then(function(e){var t=new e({name:r,keys:i.filter(function(e){return!!e}).map(function(e){return e.key})});return n.trackPromise(t.start())}).done(function(){n._onComplete()},function(e){n.isMakingRequest(!1);n.nameCollisionErrorString(e&&e.error&&e.error.message||"")});return!1};t.prototype.onCloseButtonClick=function(e,t){this._onComplete()};t.prototype.setFocusToInput=function(e,t){this.createNewAlbumInputIsVisible(!0)};t.prototype._computeHasError=function(){return this.nameCollisionErrorString&&!!this.nameCollisionErrorString()};t.prototype._computeSubmitDisabled=function(){return this.newAlbumName().trim().length<1||this.isMakingRequest()};t.prototype._updateChildrenSet=function(){for(var e=this.itemSet().content().items,t=0,n=e;t<n.length;t++){var r=n[t],i=this.unwrapObservable(r);i&&i.folder&&i.folder.covers&&0===i.folder.covers.length&&i.folder.covers.push({url:"odsp-media/images/album/empty-album.svg",width:this.thumbnailSize.width,height:this.thumbnailSize.height})}this.shouldShowEmptyAlbumList(e.length<=0);this.children(e)};return t}(r.default);t.default=y});
define("odsp-next/actions/createAlbum/CreateAlbumHelper",["require","exports","../../controls/albumBuilder/AlbumBuilder.resx","../../dataSources/item/ItemDataSource.resx"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.validateAlbumCreation=function(e,t){if(!t)return n.strings.errorNameNotSpecified;var i=new RegExp('[/"*:<>?/|/]+|[^\0-]+|[.]+$');t=t.trim();if(i.test(t))return r.strings.InvalidChar;for(var s=0,o=0,u=e;o<u.length;o++){var a=u[o];(a.photo||a.video)&&s++}return s<e.length?n.strings.errorInvalidItems:""}});
define("odsp-next/actions/createAlbum/CreateAlbumOperator",["require","exports","tslib","../../providers/operator/BaseOperator","../../models/operation/OperationType","../../providers/album/AlbumProvider.key","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,{},n)||this;r._albumProvider=n.albumProvider;r._context=t;r._payloads={createAlbum:{name:r.createObservable(""),items:r.createObservable(),album:r.createObservable()}};return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t);n.type=i.default.createAlbum;n.name=t.input;n.payloads=this._payloads;t.output&&t.output.isAlbum&&this._payloads.createAlbum.album(t.output);return n};t.prototype.onStart=function(e){return this._albumProvider.createAlbum(this._context,e)};t.dependencies=n.__assign({},r.default.dependencies,{albumProvider:s.resourceKey});return t}(r.default);t.default=u;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,u)});
define("odsp-next/controls/addToAlbum/AddToAlbum.html",[],function(){return'<div class=od-AddToAlbum>\x3c!--ko ifnot: isLoading--\x3e<div class="od-AddToAlbum-createArea od-TextField"><form class="od-AddToAlbum-form od-AddToAlbum-form--buttonVisible" data-bind="submit: createNewAlbum, css: { \'od-AddToAlbum-form--errorVisible\': hasError }"><input type=text class=od-TextField-field autocomplete=off data-bind="textInput: newAlbumName, attr: { placeholder: newAlbumPlaceholder }, hasFocus: createNewAlbumInputIsVisible, css: { \'od-AddToAlbum-createAreaInput--error\': hasError }"><p class=od-AddToAlbum-error data-bind="visible: hasError, text: nameCollisionErrorString"></p><p class=od-AddToAlbum-savingText data-bind="visible: isMakingRequest, text: savingText"></p><button type=submit class="od-Button od-Button--primary od-AddToAlbum-createNewAlbumButton od-AddToAlbum-createNewAlbumButton--visible" data-bind="click: createNewAlbum, disable: isSubmitDisabled"><span class=od-Button-label data-bind="text: createNewAlbumText"></span></button><div class=ms-clearfix></div></form></div>\x3c!--ko if: children().length && isFluentEnabled--\x3e<div class="od-AddToAlbum-albumRowTitle ms-fontWeight-semibold" data-bind="text: albumListTitle"></div>\x3c!--/ko--\x3e\x3c!--ko foreach: children--\x3e<div class=od-AddToAlbum-albumRow data-bind="click: $parent.onClickAlbumRow.bind($parent)"><a href=# data-bind="attr: { title: name }"><span class=thumbnail><div class=od-AddToAlbum-albumThumbnail data-bind="component: { name: $component.imageFrameTagName, params: { image: folder.covers[0], desiredSize: $parent.thumbnailSize } }"></div></span><div class=od-AddToAlbum-albumName data-bind="text: name, css: { \'ms-font-l\': !$parent.isFluentEnabled, \'ms-font-m\': $parent.isFluentEnabled }"></div></a></div>\x3c!--/ko--\x3e\x3c!--ko if: shouldShowEmptyAlbumList--\x3e<div class=od-AddToAlbum-emptyList><img class=od-AddToAlbum-emptyListImage data-bind="attr: { src: emptyAlbumListImgSrc }"><p class="od-AddToAlbum-emptyListTitle ms-font-xl ms-fontWeight-semilight" data-bind="text: emptyAlbumListTitle"></p><p class="od-AddToAlbum-emptyListBody ms-font-m" data-bind="text: emptyAlbumListBody"></p></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: isLoading--\x3e<div class=od-AddToAlbum-progressSpinner data-bind="component: { name: progressSpinnerFlatTagName }"></div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/addToAlbum/AddToAlbum.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".isFluent .od-AddToAlbum-albumThumbnail{height:32px;width:32px;top:12px;left:0;right:0;bottom:0;border-radius:2px;overflow:hidden}[dir=ltr] .isFluent .od-AddToAlbum-albumThumbnail{margin-left:12px}[dir=rtl] .isFluent .od-AddToAlbum-albumThumbnail{margin-right:12px}.od-AddToAlbum-albumThumbnail{position:absolute;height:50px;width:50px}.isFluent .od-AddToAlbum-albumThumbnail{height:32px;width:32px;border-radius:2px;overflow:hidden}.od-AddToAlbum-albumRow{line-height:50px;height:50px;margin-bottom:6px}.od-AddToAlbum-albumRow:hover{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.isFluent .od-AddToAlbum-albumRow:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.isFluent .od-AddToAlbum-albumRow:active{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.isFluent .od-AddToAlbum-albumRow{line-height:32px;height:32px;margin:0 -12px;padding:12px 0;border-radius:2px;position:relative}.isFluent .od-AddToAlbum-albumRow:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.isFluent .od-AddToAlbum-albumRow:active{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.isFluent.sm .od-AddToAlbum-albumRow{margin:0 -8px}.od-AddToAlbum-albumRow a{text-decoration:none}.isFluent .od-AddToAlbum-albumRow a{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-AddToAlbum-albumName{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}[dir=ltr] .od-AddToAlbum-albumName{padding-left:58px}[dir=rtl] .od-AddToAlbum-albumName{padding-right:58px}.isFluent .od-AddToAlbum-albumName{font-size:14px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}[dir=ltr] .isFluent .od-AddToAlbum-albumName{padding-left:56px}[dir=rtl] .isFluent .od-AddToAlbum-albumName{padding-right:56px}.od-AddToAlbum-createArea.od-TextField{position:relative}.od-AddToAlbum-form{margin-bottom:24px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";height:100%;overflow:auto}.isFluent .od-AddToAlbum-form{margin-bottom:16px}.od-AddToAlbum-albumRowTitle{font-size:14px;margin-bottom:8px;padding-bottom:11px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-AddToAlbum-emptyListBody,.od-AddToAlbum-error,.od-AddToAlbum-savingText{margin-top:8px;margin-bottom:0}.od-AddToAlbum-error{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.od-AddToAlbum-savingText{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-AddToAlbum-createAreaInput--error{border-color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"!important}.od-AddToAlbum-form--buttonVisible,.od-AddToAlbum-form--errorVisible{transition:height 267ms cubic-bezier(.1,.9,.2,1)}.od-Button.od-AddToAlbum-createNewAlbumButton,.od-Button.od-AddToAlbum-createNewAlbumButton--visible{transition:margin-top 267ms cubic-bezier(.1,.9,.2,1)}.od-Button.od-AddToAlbum-createNewAlbumButton--visible:not(:disabled),.od-Button.od-AddToAlbum-createNewAlbumButton:not(:disabled){color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-Button.od-AddToAlbum-createNewAlbumButton{margin-top:-32px;z-index:-1}html[dir=ltr] .od-Button.od-AddToAlbum-createNewAlbumButton{float:right}html[dir=rtl] .od-Button.od-AddToAlbum-createNewAlbumButton{float:left}.isFluent .od-Button.od-AddToAlbum-createNewAlbumButton{z-index:auto}.od-Button.od-AddToAlbum-createNewAlbumButton--visible{margin-top:24px}.isFluent .od-Button.od-AddToAlbum-createNewAlbumButton--visible{position:static}.od-AddToAlbum-albumListTitle{font-size:14px;font-weight:600;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";margin-bottom:8px;padding-bottom:12px}.od-AddToAlbum-emptyListImage{margin-top:30px}.od-AddToAlbum-emptyListTitle{margin-top:40px}.od-AddToAlbum-emptyList{text-align:center}"}])});
define("odsp-next/actions/applyOfficeLens/odc/ApplyOfficeLensExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/ItemRedeemer","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../providers/operator/ApplyOfficeLensOperator"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name=t.actionName;n._selectionHelper=t.selectionHelper;n._item=t.item;n._itemReedemer=new(n.managed(i.default));return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveFirst().then(function(t){return e._itemReedemer.redeemItem(t,e).then(function(){var n=new(e.managed(o.default))({item:t,parentKey:e._item.key});e.trackPromise(n.start());return n.wait().then(function(){return{resultType:s.ResultTypeEnum.Success}})})})};return t}(r.default);t.default=u});
define("odsp-next/providers/operator/ApplyOfficeLensOperator",["require","exports","tslib","./BaseOperator","../../resources/ProviderResourceKeys","../../models/operation/OperationType"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){var n=e.call(this,{})||this;n._context=t;n._processFiltersProvider=n.resources.consume(i.processFilters);return n}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input;n.name=r.name;n.iconName=r.iconName;n.type=s.default.applyOfficeLens;n.payloads={applyOfficeLens:{item:r}};return n};t.prototype.onStart=function(e){return this._processFiltersProvider.applyOfficeLens(this._context,e)};return t}(r.default);t.default=o});
define("odsp-next/actions/removeOfficeLens/odc/RemoveOfficeLensExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/ItemRedeemer","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../providers/operator/RemoveOfficeLensOperator"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name=t.actionName;n._selectionHelper=t.selectionHelper;n._item=t.item;n._itemReedemer=new(n.managed(i.default));return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveFirst().then(function(t){return e._itemReedemer.redeemItem(t,e).then(function(){var n=new(e.managed(o.default))({item:t,parentKey:e._item.key});e.trackPromise(n.start());return n.wait()})}).then(function(){return{resultType:s.ResultTypeEnum.Success}})};return t}(r.default);t.default=u});
define("odsp-next/providers/operator/RemoveOfficeLensOperator",["require","exports","tslib","./BaseOperator","../../resources/ProviderResourceKeys","../../models/operation/OperationType"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){var n=e.call(this,{})||this;n._context=t;n._processFiltersProvider=n.resources.consume(i.processFilters);return n}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input;n.name=r.name;n.iconName=r.iconName;n.type=s.default.removeOfficeLens;n.payloads={removeOfficeLens:{item:r}};return n};t.prototype.onStart=function(e){return this._processFiltersProvider.removeOfficeLens(this._context,e)};return t}(r.default);t.default=o});
define("odsp-next/actions/addToBundle/odc/AddToBundleExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../controls/bundleBuilder/BundleBuilder","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../providers/operator/UpdateBundleOperator","../../../providers/panel/PanelProvider","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._selectionHelper=t.selectionHelper;n._panelProvider=n.resources.consume(u.resourceKey);return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveSelection().then(function(t){var n=e.observables.createArray(),r=t[0];return e._addToBundleViaPanel(r,n).then(function(){return e._addToBundle(r,n.peek())})})};t.prototype._addToBundleViaPanel=function(e,t){var n=this.observables.create(!1),s={resources:this.resources,bundleName:e.displayName,complete:function(e){t.splice.apply(t,[0,t.peek().length].concat(e.map(function(e){return e.id})));n(!0);return r.default.wrap()},cancel:function(){n(!0);return r.default.wrap()}},o=this._panelProvider.requestPanel({noTitle:!0,hasCommandBar:!0,size:"Large",showCloseButton:!1,component:{name:i.default.tagName,params:s}}),u=this.createComputed(function(){n()&&o.state(1)});return o.wait().then(function(){u.dispose()},function(e){u.dispose();return r.default.wrapError(e)})};t.prototype._addToBundle=function(e,t){var n=this;return t&&0===t.length?r.default.wrap({resultType:s.ResultTypeEnum.Success}):this.resources.consumeAsync(o.typeResourceKey).then(function(r){var i=new r({items:t,bundleAction:0,item:e});n.trackPromise(i.start());return i.wait()}).then(function(){return{resultType:s.ResultTypeEnum.Success}})};return t}(a.default);t.default=f});
define("odsp-next/controls/bundleBuilder/BundleBuilder",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./BundleBuilderViewModel","./BundleBuilder.html","./BundleBuilder.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.registerComponent({tagName:"od-bundle-builder",template:e("./BundleBuilder.html"),viewModel:r.default,synchronous:!0});t.default=i});
define("odsp-next/controls/bundleBuilder/BundleBuilderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../filePickerHost/FilePickerHost","@ms/odsp-utilities/lib/async/Promise","./BundleBuilder.resx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.filePickerHostTagName=i.default.tagName;var r=t.complete,u=t.cancel,a=t.bundleName,f=t.typeFilter,l=t.viewType,c=void 0===l?1:l,h=t.itemKey,p=t.showCommandBar,d=void 0===p||p,v=t.useMoveString,m=void 0!==v&&v,g=t.allowRootItem,y=void 0===g||g;n.title=a?m?n.format(o.strings.moveItemsTitleFormat,a):n.format(o.strings.addItemsTitleFormat,a):m?o.strings.moveItemsTitle:o.strings.addItemsTitle;n.filePickerHostParams={itemKey:h,behavior:{showActions:!1,selectionMode:1,viewType:c,typeFilter:f,completeText:m?o.strings.moveItemsTitle:o.strings.addItemsTitle,showCommandBar:d,allowRootItem:y},agent:{initialize:function(){return s.default.wrap()},getApplication:function(){return s.default.wrap()},complete:r,cancel:u,switchAccount:function(){return s.default.wrap()}}};return n}return t}(r.default);t.default=u});
define("odsp-next/controls/filePickerHost/FilePickerHost",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FilePickerHostViewModel","./templates/FilePickerHostTemplates","../../bindings/component/ControlBinding","./FilePickerHost.html","./FilePickerHost.css","./templates/FilePickerHostInline.html"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="od-file-picker-host",u=e("./FilePickerHost.html"),a=n.registerComponent({tagName:o,template:u,viewModel:r.default,synchronous:!0});t.resourceKey=s.createResolvedControlDefinitionResourceKey({automationName:o,name:e("module").id,template:u,viewModelType:r.default});n.registerTemplate(i.INLINE,e("./templates/FilePickerHostInline.html"));t.default=a});
define("odsp-next/controls/filePickerHost/FilePickerHostViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/ViewModel","../../resources/DataSourceResourceKeys","./templates/FilePickerHostTemplates","@ms/odsp-shared/lib/utilities/navigation/InPlaceNavigation","../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/modules/Modules","../progressSpinnerFlat/ProgressSpinnerFlat","../../bindings/host/HostBinding","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../models/item/ItemType","../../dataSources/url/PageType","../../resources/PagesResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(t){n.__extends(i,t);function i(n,i){void 0===n&&(n={});void 0===i&&(i={});var m=t.call(this,n,i)||this;m.addBindingHandlers({host:c.default});m._urlDataSource=m.resources.consume(s.url);var g=n.itemKey,y=n.agent,b=n.behavior,w=i.loadModule,E=void 0===w?f.loadModule:w,S=m._urlDataSource.getDefaultClickUrl({key:g||m._urlDataSource.getRootItemKey(),type:p.default.Folder},{page:d.default.FilePicker,viewParams:{}}),x=new(m.managed(u.default));x.navigateTo({url:S});m.resources.expose(h.navigation,x);m.resources.expose(a.viewParams,x.viewParamsObservable);m.resources.expose(v.base.leftNav.isLeftNavVisible,m.createObservable(!1));m.resources.expose(v.base.leftNav.hideLeftNav,m.createObservable(!1));m.resources.expose(v.base.suiteNav.isSuiteNavHidden,m.createObservable(!0));m.resources.expose(v.base.commandBar.isDarkTheme,m.createObservable(!1));m.resources.expose(v.base.commandBar.isSearchHidden,m.createObservable(!1));m._pickerParams={behavior:b,agent:y,shouldHostOverlays:!1};m.pickerComponent=m.createObservable({name:l.default.tagName,params:{}});var T=m._urlDataSource.getPageModulePath(x.viewParamsObservable.peek());m.trackPromise(E({path:T,getModule:function(){return new r.default(function(t,n){if("undefined"==typeof __webpack_public_path__)window.require([T],t,n);else{t(e.context("odsp-next/pages",!0,/\.ts$/)("./"+e("path").relative("odsp-next/pages",T)+".ts"))}})}}).then(function(e){m.pickerComponent({name:e.tagName,params:m._pickerParams})}));m.pickerTemplate=o.INLINE;return m}return i}(i.default);t.default=m});
define("odsp-next/controls/filePickerHost/templates/FilePickerHostTemplates",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INLINE="od-file-picker-host-inline"});
define("odsp-next/controls/filePickerHost/FilePickerHost.html",[],function(){return"\x3c!--ko template: pickerTemplate--\x3e\x3c!--/ko--\x3e"});
define("odsp-next/controls/filePickerHost/FilePickerHost.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-FilePickerHost{position:absolute;top:0;left:0;bottom:0;right:0}.od-FilePickerHost--frame .od-FilePickerHost-content{position:absolute;left:0;right:0;bottom:0;height:90px}.od-FilePickerHost--frame .od-FilePickerHost-frame{position:absolute;top:0;left:0;bottom:90px;right:0}.od-FilePickerHost--frame .od-FilePickerHost-frame iframe{position:absolute;top:0;left:0;width:100%;height:100%;border:none}"}])});
define("odsp-next/controls/filePickerHost/templates/FilePickerHostInline.html",[],function(){return'<div class="od-FilePickerHost od-FilePickerHost--inline" data-bind="component: pickerComponent">\x3c!--ko host: {\r\n data: $host\r\n }--\x3e\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/bundleBuilder/BundleBuilder.html",[],function(){return'<div class=od-BundleBuilder data-bind="component: { name: filePickerHostTagName, params: filePickerHostParams }"><div class="od-BundleBuilder-content od-ItemContent"><div class="od-AlbumBuilder-header od-ItemContent-header"><div class="od-BundleBuilder-title od-ItemContent-title" data-bind="text: title"></div></div></div></div>'});
define("odsp-next/controls/bundleBuilder/BundleBuilder.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-BundleBuilder{position:absolute;top:0;left:0;bottom:0;right:0}"}])});
define("odsp-next/actions/feedback/odc/FeedbackExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../bindings/component/ControlBinding","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../controls/feedback/Feedback","@ms/odsp-utilities/lib/async/Promise","../../../resources/ProviderResourceKeys","../../../models/feedback/FeedbackDialogState","../../../providers/dialog/DialogProvider","../../../providers/sendFeedback/SendFeedbackProvider","../../NavigationAction","../../../resources/ODCResourceKeys","../../../dataSources/url/AutoActionType","../../../controls/feedback/Feedback.resx","../../../controls/sendFeedback/SendFeedback.resx","../../../utilities/features/Features","../../../controls/sendFeedback/SendFeedback"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._userInfoProvider=n.resources.consume(a.userInfo);n._urlDataSource=n.resources.consume(p.urlDataSource);n._sendFeedbackProvider=n.resources.consume(c.resourceKey);return n}t.prototype.execute=function(e){var t=this;if(!this._userInfoProvider.isAuthenticated()){var n=this._urlDataSource.getSignInUrlWithAction(d.default.feedback);return new(this.managed(h.default))({url:n,forceNavigation:!0}).execute(e)}var r=this.observables,a=this.resources.consume(l.resourceKey),c=r.create(f.default.initialLoad),p=r.create(""),b=r.create(""),w=r.create(!1),E=g.isFeatureEnabled(g.EnableNewTicketingService);E&&(b=this.createPureComputed(function(){return t._getHeaderText(c)}));var S,x,T={onComplete:function(){N.state(3)},comment:p,state:c,title:b,retryTrigger:w};E?x=i.toSpecification(y.resourceKey,T):S={name:o.default.tagName,params:T};var N=a.requestDialog({title:b,component:S,control:x,actions:[{name:v.strings.retryTitle,execute:function(){w(!0);return u.default.wrap(1)},isVisible:r.pureCompute(function(){return c()===f.default.error}),icon:null,isDefault:!0},{name:m.strings.sendFeedbackBtnText,execute:function(){return t._submitFeedback(p.peek(),c).then(function(){return u.default.wrap(1)})},isVisible:r.pureCompute(function(){return E&&c()===f.default.initialLoad}),isAvailable:r.pureCompute(function(){return!!p()}),icon:null,isDefault:!0}],size:"Small"});return N.wait().then(function(){return{resultType:s.ResultTypeEnum.Success}})};t.prototype._getHeaderText=function(e){var t=e();return t===f.default.error?m.strings.errorHeader:t===f.default.done?m.strings.successHeader:t===f.default.initialLoad?m.strings.emailSupportTitle:t===f.default.feedbackSent?m.strings.sendingHeader:""};t.prototype._submitFeedback=function(e,t){t(f.default.feedbackSent);return this._sendFeedbackProvider.sendFeedback(e).then(function(){t(f.default.done)},function(e){t(f.default.error)})};return t}(r.default);t.default=b});
define("odsp-next/controls/feedback/Feedback",["require","exports","./FeedbackViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./Feedback.html","./Feedback.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-feedback",template:e("./Feedback.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/feedback/FeedbackViewModel",["require","exports","tslib","knockout","./Feedback.resx","@ms/odsp-shared/lib/base/ViewModel","../progressSpinnerFlat/ProgressSpinnerFlat","../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-shared/lib/utilities/logging/events/Action.event","../../resources/DataSourceResourceKeys","../../dataSources/url/PageType","../../dataSources/url/QueryType","@ms/odsp-utilities/lib/logging/events/Qos.event","../../models/feedback/FeedbackDialogState"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v={init:"Init",submit:"Submit",close:"Close",cancel:"Cancel",confirm:"Confirm",timeout:"Timeout"},m="FrameLoad",g=i.strings,y=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.states=d.default;n._qos={};n._paratureEvents={};n._urlDataSource=n.resources.consume(l.url);n._reportParatureStage(v.init);n.state=t.state;n._retryTrigger=t.retryTrigger;n._headerText=t.title;n.progressSpinnerTagName=o.default.tagName;n.bodyText=r.observable("");n.iframeUrl=r.observable("");n._loadTimer=0;n._feedbackProvider=n.resources.consume(u.feedback);n._onComplete=t.onComplete;n.createComputed(n._onRetryTrigger);n._init();return n}t.prototype.dispose=function(){e.prototype.dispose.call(this)};t.prototype.onCloseClicked=function(){this._reportParatureStage(this.state()===d.default.done?v.close:v.cancel);this._onComplete()};t.prototype._init=function(){this.state(d.default.initialLoad);this._headerText(g.loadingTitle);this.bodyText("");this.iframeUrl("");this._initListeners();this._initIframe()};t.prototype._onRetryTrigger=function(){if(this._retryTrigger()){this._init();this._retryTrigger(!1)}};t.prototype._initIframe=function(){var e=this;this._feedbackProvider.getFeedbackUrl().then(function(t){e.iframeUrl(t);e._loadTimer=e.async.setTimeout(e._onIframeTimeout,1e4)},function(t){e._headerText(g.errorHeader);e.bodyText(g.errorBody);e.state(d.default.error)})};t.prototype._onIframeTimeout=function(){if(this.state()===d.default.initialLoad){this._reportParatureLoadQos(m,!0);this._reportParatureStage(v.timeout);this.state(d.default.error);this._headerText(g.errorHeader);this.bodyText(g.errorBody)}};t.prototype._initListeners=function(){this.events.on(window,"message",this._onReceiveMessage)};t.prototype._onReceiveMessage=function(e){var t=this._feedbackProvider.getFeedbackEndpoints(),n=!1;if(e){for(var r=0,i=t;r<i.length;r++){var s=i[r];if(n=e.origin.startsWith(s))break}if(n){var o={};try{o=JSON.parse(e.data)}catch(e){}o.action?this._handleReceivedAction(o.action):o.location?this.state()===d.default.initialLoad&&this._onParatureLoaded():void 0!==o.height||o.name}}};t.prototype._handleReceivedAction=function(e){switch(e){case"submit":this._reportParatureStage(v.submit);break;case"cancel":this.onCloseClicked();break;case"confirmation":this._onConfirmed()}};t.prototype._onParatureLoaded=function(){this.async.clearTimeout(this._loadTimer);if(this.state()!==d.default.error){this._reportParatureLoadQos(m,!1);this.state(d.default.showingIframe);this._headerText(g.emailSupportTitle)}};t.prototype._onConfirmed=function(){this._reportParatureStage(v.confirm);this.state(d.default.done);this._headerText(g.successTitle)};t.prototype._reportParatureLoadQos=function(e,t){var n=this._qos[e];n||(n=this._qos[e]=new a.Qos({name:"Parature.Flow."+e}));n.end({resultType:t?p.ResultTypeEnum.Failure:p.ResultTypeEnum.Success})};t.prototype._reportParatureStage=function(e){var t=this._paratureEvents[e];t||(t=this._paratureEvents[e]=new f.Action({name:"Parature.Flow."+e,pageType:c.default[this._urlDataSource.getPageType()],queryType:h.default[this._urlDataSource.getQueryType()]}));t.end({resultType:p.ResultTypeEnum.Success})};return t}(s.default);t.default=y});
define("odsp-next/models/feedback/FeedbackDialogState",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.initialLoad=0]="initialLoad";e[e.showingIframe=1]="showingIframe";e[e.feedbackSent=2]="feedbackSent";e[e.done=3]="done";e[e.error=4]="error"}(n||(n={}));t.default=n});
define("odsp-next/controls/feedback/Feedback.html",[],function(){return'<div class="od-feedback od-feedback-smaller"><div class=od-feedback-inner data-bind="css: {\'od-feedback--hasError\': state() === states.error }">\x3c!--ko if: state() === states.initialLoad--\x3e<div data-bind="component: progressSpinnerTagName"></div>\x3c!--/ko--\x3e\x3c!--ko if: iframeUrl().length--\x3e<iframe data-bind="attr: { src: iframeUrl }, visible: state() === states.showingIframe || state() === states.done"></iframe>\x3c!--/ko--\x3e\x3c!--ko if: state() === states.error--\x3e<p data-bind="text: bodyText"></p>\x3c!--/ko--\x3e</div></div>'});
define("odsp-next/controls/feedback/Feedback.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-feedback iframe{width:100%;height:400px;border:none}.od-feedback.od-feedback-smaller iframe{height:100%}.od-feedback-inner{height:400px}.od-feedback-smaller .od-feedback-inner{height:195px}.od-feedback-smaller .od-feedback-inner.od-feedback--hasError{height:auto}"}])});
define("odsp-next/providers/sendFeedback/SendFeedbackProvider",["require","exports","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this._sendFeedbackDataSource=t.sendFeedbackDataSource}e.prototype.sendFeedback=function(e){return this._sendFeedbackDataSource.sendFeedback(e)};return e}();t.default=i;t.resourceKey=r.createResolvedResourceKey(e("module").id,i,{sendFeedbackDataSource:n.sendFeedback})});
define("odsp-next/controls/sendFeedback/SendFeedback",["require","exports","./SendFeedbackViewModel","../../bindings/component/ControlBinding","./SendFeedback.html","./SendFeedback.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({name:e("module").id,automationName:"od-sendfeedback",template:e("./SendFeedback.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/sendFeedback/SendFeedbackViewModel",["require","exports","tslib","./SendFeedback.resx","@ms/odsp-shared/lib/base/ViewModel","../progressSpinnerFlat/ProgressSpinnerFlat","@ms/odsp-utilities/lib/string/StringHelper","../../models/feedback/FeedbackDialogState","../../providers/sendFeedback/SendFeedbackProvider"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t,n)||this;i.states=u.default;i.state=t.state;i._retryTrigger=t.retryTrigger;i.feedbackResx=r.strings;i.email=$Config.email;i.lang=$Config.mktLocale;i.progressSpinnerTagName=s.default.tagName;i.hintText=i.feedbackResx.hintText;i.sendFeedbackBtnText=i.feedbackResx.sendFeedbackBtnText;i.bodyText=i.createPureComputed(i._computeBodyText);i.comment=t.comment;i._onComplete=t.onComplete;i.createComputed(i._onRetryTrigger);i.privacyStatementText=i.feedbackResx.privacyLink;i.privacyStatementUrl="https://privacy.microsoft.com/"+i.lang+"/privacystatement/";i._successMessage=o.format(i.feedbackResx.successBody,i.email);i._init();return i}t.prototype.dispose=function(){e.prototype.dispose.call(this)};t.prototype.onCloseClicked=function(){this._onComplete()};t.prototype._computeBodyText=function(){var e=this.state();return e===u.default.error?this.feedbackResx.errorBody:e===u.default.done?this._successMessage:""};t.prototype._onRetryTrigger=function(){if(this._retryTrigger()){this._init();this._retryTrigger(!1)}};t.prototype._init=function(){this.state(u.default.initialLoad)};t.dependencies=n.__assign({},i.default.dependencies,{sendFeedbackProvider:a.resourceKey});return t}(i.default);t.default=f});
define("odsp-next/controls/sendFeedback/SendFeedback.html",[],function(){return'<div class="od-sendFeedback od-sendFeedback-smaller"><div class=od-sendFeedback-inner>\x3c!--ko if: state() === states.feedbackSent--\x3e\x3c!--ko component: { name: progressSpinnerTagName }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e<div class=od-sendFeedback-area data-bind="visible: state() === states.initialLoad || state() === states.feedbackSent"><textarea class=od-sendFeedback-textarea hasfocus=true data-bind="attr: {\'aria-label\': hintText, placeholder: hintText }, textInput: comment"></textarea> <a class=od-sendFeedback-Privacy-Link target=_blank rel=“noopener” data-bind="attr: {href: privacyStatementUrl}, text: privacyStatementText"></a></div><div aria-live=assertive class=od-sendFeedback-response>\x3c!--ko if: state() === states.done--\x3e<p data-bind="text: bodyText"></p>\x3c!--/ko--\x3e\x3c!--ko if: state() === states.error--\x3e<p data-bind="text: bodyText"></p>\x3c!--/ko--\x3e</div></div></div>'});
define("odsp-next/controls/sendFeedback/SendFeedback.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-sendFeedback-inner{height:400px}.od-sendFeedback-smaller .od-sendFeedback-inner{height:195px}.od-sendFeedback-smaller .od-sendFeedback-inner.od-feedback--hasError{height:auto}html[dir=ltr] .od-Button-sendFeedback{float:right}html[dir=rtl] .od-Button-sendFeedback{float:left}.od-sendFeedback-textarea{width:100%;height:110px;resize:none;padding:4px}"}])});
define("odsp-next/actions/createAlbumFromFolder/odc/CreateAlbumFromFolderExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../CreateAlbumFromFolderOperator","@ms/odsp-utilities/lib/logging/events/Qos.event","../../base/ItemRedeemer"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name=t.actionName;n._itemSelectionHelper=t.itemSelectionHelper;n._itemReedemer=new(n.managed(o.default));return n}t.prototype.execute=function(e){var t=this;return this._itemSelectionHelper.resolveFirst().then(function(e){return t._itemReedemer.redeemItems([e],t).then(function(){return t.resources.consumeAsync(i.typeResourceKey).then(function(n){var r=new n({folder:e});return t.trackPromise(r.start())}).then(function(){return{resultType:s.ResultTypeEnum.Success}},function(){return{resultType:s.ResultTypeEnum.Failure}})})})};return t}(r.default);t.default=u});
define("odsp-next/actions/createAlbumFromFolder/CreateAlbumFromFolderOperator",["require","exports","tslib","../../providers/operator/BaseOperator","../../models/operation/OperationType","../../providers/album/AlbumProvider.key","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,{},n)||this;r._albumProvider=n.albumProvider;r._context=t;r._payloads={createAlbumFromFolder:{folder:r.createObservable(t.folder),album:r.createObservable()}};return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t);n.type=i.default.createAlbumFromFolder;n.name=t.input;n.iconName=this._context.folder.iconName;n.payloads=this._payloads;t.output&&t.output.isAlbum&&this._payloads.createAlbumFromFolder.album(t.output);return n};t.prototype.onStart=function(e){return this._albumProvider.createAlbumFromFolder(this._context,e)};t.dependencies=n.__assign({},r.default.dependencies,{albumProvider:s.resourceKey});return t}(r.default);t.default=u;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,u)});
define("odsp-next/actions/orderPrints/odc/OrderPrintsExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../providers/panel/PanelProvider","../../../controls/orderPrints/OrderPrints","../../base/ItemRedeemer"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.actionName,i=t.itemSelectionHelper;n.name=r;n._itemSelectionHelper=i;n._itemReedemer=new(n.managed(u.default));n._panelProvider=n.resources.consume(s.resourceKey);return n}t.prototype.execute=function(e){var t=this;return this._itemSelectionHelper.resolveSelection().then(function(e){return t._itemReedemer.redeemItems(e,t).then(function(){var n=t.observables.create(""),r=t._panelProvider.requestPanel({title:n,component:{name:o.default.tagName,params:{selection:e,onComplete:function(){r.state(1)},title:n}}});return r.wait().then(function(){return{resultType:i.ResultTypeEnum.Success}},function(){return{resultType:i.ResultTypeEnum.Failure}})})})};return t}(r.default);t.default=a});
define("odsp-next/controls/orderPrints/OrderPrints",["require","exports","./OrderPrintsViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./OrderPrints.html","./OrderPrints.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-order-prints",template:e("./OrderPrints.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/orderPrints/OrderPrintsViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./OrderPrints.resx","../commands/Commands.resx","../../providers/album/AlbumProvider.key","./OrderPrintsState","../progressSpinnerFlat/ProgressSpinnerFlat"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onComplete=t.onComplete;n.selection=t.selection;n.orderPrintsStates=u.default;n.currentState=n.createObservable(u.default.splash);n.orderPrintsResx=i;n.splashImageSrc=n.createObservable(FilesConfig.imgBaseUrl+"/partners/walgreens2.png");n.orderPrintsIframeUrl=n.createObservable("");n.progressSpinnerFlatTagName=a.default.tagName;n.events.on(window,"message",n._onReceiveMessage);n._title=n.createComputed(n._computeTitle);t.title&&n.createComputed(function(){return t.title(n._title())});return n}t.prototype.onPrintButtonClicked=function(e,t){var n=this;this.currentState(u.default.loading);this.resources.consumeAsync(o.resourceKey).then(function(e){return e.getWalgreensLandingPageUrl(n.selection)}).then(function(e){n.orderPrintsIframeUrl(e.landingUrl);n.currentState(u.default.core)},function(e){n.currentState(u.default.error)})};t.prototype.onCloseButtonClicked=function(e,t){this._onComplete()};t.prototype._computeTitle=function(){var e="";switch(this.currentState()){case u.default.splash:case u.default.loading:e=s.strings.OrderPrints;break;case u.default.core:e=this.orderPrintsResx.strings.PrintToWalgreens;break;case u.default.done:e=this.orderPrintsResx.strings.WalgreensSubmittedTitle}return e};t.prototype._onReceiveMessage=function(e){if(e&&e.origin.indexOf(t.WALGREENS_ORIGIN)>-1){var n=e.data;n===t.EVENT_CANCEL||n===t.EVENT_BACK?this._onComplete():n===t.EVENT_DONE?this._onSubmitted():this.currentState(u.default.error)}};t.prototype._onSubmitted=function(){this.currentState(u.default.done)};t.WALGREENS_ORIGIN=window.$Config&&$Config.isINT?"https://m5-qa.walgreens.com":"https://m5.walgreens.com";t.EVENT_CANCEL="action=cancel";t.EVENT_BACK="action=back";t.EVENT_DONE="action=done";return t}(r.default);t.default=f});
define("odsp-next/controls/orderPrints/OrderPrintsState",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.splash=0]="splash";e[e.loading=1]="loading";e[e.core=2]="core";e[e.done=3]="done";e[e.error=4]="error"}(n||(n={}));t.default=n});
define("odsp-next/controls/orderPrints/OrderPrints.html",[],function(){return'<div class=od-OrderPrints><div class=od-OrderPrints-splash data-bind="visible: currentState() === orderPrintsStates.splash"><p data-bind="text: orderPrintsResx.strings.WalgreensSplashText" class=od-OrderPrints-splashText></p><div class=od-OrderPrints-centered><img data-bind="attr: {src: splashImageSrc()}"></div></div><div class=od-OrderPrints-progressSpinner data-bind="component: {name: progressSpinnerFlatTagName}, visible: currentState() === orderPrintsStates.loading"></div><div class=od-OrderPrints-iframe data-bind="visible: currentState() === orderPrintsStates.core"><iframe data-bind="attr: {src: orderPrintsIframeUrl()}"></iframe></div><div class=od-OrderPrints-complete data-bind="visible: currentState() === orderPrintsStates.done"><p data-bind="text: orderPrintsResx.strings.WalgreensSubmitted"></p></div><div class=od-OrderPrints-error data-bind="visible: currentState() === orderPrintsStates.error"><p data-bind="text: orderPrintsResx.strings.WalgreensError"></p></div><div class="od-OrderPrints-actions od-OrderPrints-centered"><button type=button role=button class="od-Button od-Button--primary" data-bind="text: orderPrintsResx.strings.PrintToWalgreens, click: onPrintButtonClicked, visible: currentState() === orderPrintsStates.splash"></button></div></div>'});
define("odsp-next/controls/orderPrints/OrderPrints.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-OrderPrints-splash img{padding-bottom:24px;max-width:210px}.od-OrderPrints-splashText{margin-bottom:24px}.od-OrderPrints-centered{text-align:center}.od-OrderPrints iframe{border:none;width:100%;height:450px}.od-OrderPrints-actions button{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}"}])});
define("odsp-next/actions/showKeyboardMap/ShowKeyboardMapExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../providers/dialog/DialogProvider","../../controls/keyboardMap/KeyboardMap","../../controls/commands/Commands.resx","@ms/odsp-utilities/lib/logging/events/Qos.event","../../utilities/icons/Icon"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=u.strings,c=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});return e.call(this,t)||this}t.prototype.execute=function(){return this.resources.consume(s.resourceKey).requestDialog({title:l.keyboardShortcutsTitle,size:"Large",component:{name:o.default.tagName,params:{}},actions:[{name:l.ok,icon:new f.default("Cancel"),isDefault:!0,execute:function(){return r.default.wrap(2)}}]}).wait().then(function(){return{resultType:a.ResultTypeEnum.Success}})};return t}(i.default);t.default=c});
define("odsp-next/controls/keyboardMap/KeyboardMap",["require","exports","./KeyboardMapViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./KeyboardMap.html","./KeyboardMap.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-keyboard-map",template:e("./KeyboardMap.html"),viewModel:n.default});t.default=i});
define("odsp-next/controls/keyboardMap/KeyboardMapViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./KeyboardMap.resx","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../utilities/features/Features"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.strings=i.strings;var r=n.resources.consume(s.platformDetection);n.isMac=r.isMac;n.isPC=!r.isMac;n.isVaultEnabled=o.isFeatureEnabled(o.ProjectVKeyboardShortcut);return n}return t}(r.default);t.default=u});
define("odsp-next/controls/keyboardMap/KeyboardMap.html",[],function(){return"<div class=od-KeyboardMap-group><ul class=od-KeyboardMap-table><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.arrowsDesc + '; ' + strings.arrowsAria + '; ' }\"><span class=od-KeyboardMap-key>&uarr; &darr; &larr; &rarr;</span> <span class=od-KeyboardMap-val data-bind=\"text: strings.arrowsDesc\"></span></li>\x3c!--ko if: isMac--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.selectAllDesc + '; ' + strings.selectAllMacAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.selectAllMacKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.selectAllDesc\"></span></li>\x3c!--/ko--\x3e\x3c!--ko if: isPC--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.selectAllDesc + '; ' + strings.selectAllPCAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.selectAllPCKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.selectAllDesc\"></span></li>\x3c!--/ko--\x3e\x3c!--ko if: isMac--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.deselectAllDesc + '; ' + strings.deselectAllMacAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.deselectAllMacKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.deselectAllDesc\"></span></li>\x3c!--/ko--\x3e\x3c!--ko if: isPC--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.deselectAllDesc + '; ' + strings.deselectAllPCAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.deselectAllPCKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.deselectAllDesc\"></span></li>\x3c!--/ko--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.escDesc + '; ' + strings.escAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.escKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.escDesc\"></span></li><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.spaceDesc + '; ' + strings.spaceKey + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.spaceKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.spaceDesc\"></span></li><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.enterDesc + '; ' + strings.enterKey + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.enterKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.enterDesc\"></span></li><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.altUpDesc + '; ' + strings.altUpAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.altUpKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.altUpDesc\"></span></li>\x3c!--ko if: isVaultEnabled--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.lockVaultDesc + '; ' + strings.lockVaultAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.lockVaultKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.lockVaultDesc\"></span></li>\x3c!--/ko--\x3e</ul></div><div class=od-KeyboardMap-group><ul class=od-KeyboardMap-table><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.renameDesc + '; ' + strings.renameKey + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.renameKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.renameDesc\"></span></li>\x3c!--ko if: isMac--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.deleteDesc + '; ' + strings.deleteMacAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.deleteMacKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.deleteDesc\"></span></li>\x3c!--/ko--\x3e\x3c!--ko if: isPC--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.deleteDesc + '; ' + strings.deletePCKey + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.deletePCKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.deleteDesc\"></span></li>\x3c!--/ko--\x3e<li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.toggleInfoDesc + '; ' + strings.toggleInfoKey + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.toggleInfoKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.toggleInfoDesc\"></span></li><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.showKeymapDesc + '; ' + strings.showKeymapAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.showKeymapKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.showKeymapDesc\"></span></li><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.showSearchDesc + '; ' + strings.showSearchAria + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.showSearchKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.showSearchDesc\"></span></li><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.showShareDesc + '; ' + strings.showShareKey + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.showShareKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.showShareDesc\"></span></li><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.openContextualMenuDesc + '; ' + strings.openContextualMenuKey + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.openContextualMenuKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.openContextualMenuDesc\"></span></li><li class=od-KeyboardMap-row data-bind=\"attr: { 'aria-label': strings.showActionDetailsDesc + '; ' + strings.showActionDetailsKey + '; ' }\"><span class=od-KeyboardMap-key data-bind=\"text: strings.showActionDetailsKey\"></span> <span class=od-KeyboardMap-val data-bind=\"text: strings.showActionDetailsDesc\"></span></li></ul></div>"});
define("odsp-next/controls/keyboardMap/KeyboardMap.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-KeyboardMap-group{display:inline-block;width:50%;min-width:200px;font-size:12px;vertical-align:top}.od-KeyboardMap-table{display:table;list-style:none;margin:0;padding:0}.od-KeyboardMap-row{display:table-row}.od-KeyboardMap-row span{display:table-cell}.od-KeyboardMap-key{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";min-width:55px}.od-KeyboardMap-val{padding:4px 8px}"}])});
define("odsp-next/actions/redeemCode/odc/RedeemCodeExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../resources/ProviderResourceKeys","../../../controls/redeemCodeDialog/RedeemCodeDialog","../../../controls/commands/Commands.resx","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../providers/dialog/DialogProvider","../../../utilities/icons/Icon","@ms/odsp-utilities/lib/guid/Guid","../../../controls/redeemCodeDialog/RedeemCodeDialog.resx"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=c.strings,p=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.maxNameLength=255;n._token=t.redeemCode;n._storageInfoProvider=n.resources.consume(i.storageInfo);n._dialogProvider=n.resources.consume(a.resourceKey);n._redeemSuccess=t.redeemSuccess;n.supportInlineSharing=!0;return n}t.prototype.execute=function(){var e=this,t=this.observables.create(""),n=this.observables.create(!1),r=this.observables.create(!0),i=this.observables.create(!0),a=l.default.generate();return this._dialogProvider.requestDialog({title:"",component:{name:s.default.tagName,params:{token:this._token,automationId:"redeemDialog",status:t,hasError:n,isEnabled:r,hasFocus:i}},actions:[{name:h.Redeem,execute:function(){t(o.strings.Saving);r(!1);n(!1);return e._storageInfoProvider.redeemCode({token:e._token(),trackingGuid:a}).then(function(){e._redeemSuccess(!0);return 2},function(e){n(!0);r(!0);i(!0);t(e);return 1})},isAvailable:this.observables.pureCompute(function(){return!!e._token()&&r()}),isDefault:!0,icon:new f.default("CirclePlus"),automationId:"redeemDialogCommit"}]}).wait().then(function(){return{resultType:u.ResultTypeEnum.Success}})};return t}(r.default);t.default=p});
define("odsp-next/controls/redeemCodeDialog/RedeemCodeDialog",["require","exports","./RedeemCodeDialogViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./RedeemCodeDialog.html","./RedeemCodeDialog.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-redeemcode-dialog",template:e("./RedeemCodeDialog.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/redeemCodeDialog/RedeemCodeDialogViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./RedeemCodeDialog.resx","knockout"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.strings,u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.tokenLabel=o.TokenLabel;n.token=t.token;n.status=t.status||s.observable("");n.hasError=t.hasError||s.observable(!1);n.isEnabled=t.isEnabled||s.observable(!0);n.hasFocus=t.hasFocus||s.observable(!0);return n}return t}(r.default);t.default=u});
define("odsp-next/controls/redeemCodeDialog/RedeemCodeDialog.html",[],function(){return'<div class=od-RedeemCode><div class=od-TextField><label class="od-RedeemCode-nameLabel od-Label" data-bind="text: tokenLabel"></label> <input class="od-RedeemCode-nameInput od-TextField-field" type=text data-bind="value: token, textInput: token, hasFocus: hasFocus, automation: automationId, css: { \'od-RedeemCode-input--error\': hasError }, enable: isEnabled"></div><div class=od-RedeemCode-status data-bind="text: status, css: { \'od-RedeemCode-status--error\': hasError }"></div></div>'});
define("odsp-next/controls/redeemCodeDialog/RedeemCodeDialog.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-RedeemCode-nameLabel{font-size:14px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-RedeemCode-status{margin-top:12px;font-size:12px;font-weight:400;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-RedeemCode-status--error{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.od-RedeemCode-input--error{border-color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"!important}"}])});
define("odsp-next/actions/editTags/odc/EditTagsExecutor",["require","exports","tslib","../../../resources/ProviderResourceKeys","../../../controls/tagEditor/TagEditor","../../../providers/panel/PanelProvider","@ms/odsp-utilities/lib/logging/events/Qos.event","../../base/ItemRedeemer","../../../controls/tagEditor/TagEditor.resx","@ms/odsp-shared/lib/base/BaseModel","../../../resources/ControlResourceKeys","../../../models/itemsScope/ItemsScopeFeature.key"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name=t.actionName;n._currentItem=t.currentItem;n._selectionHelper=t.selectionHelper;n._itemReedemer=new(n.managed(u.default));n._panelProvider=n.resources.consume(s.resourceKey);n._tagProvider=n.resources.consume(r.tag);n._viewParams=n.resources.consume(l.viewParams);return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveSelection().then(function(t){var n=[],s=[],u=e.resources.consume(r.photo).getAllPhotosSettings().peek(),f=!1,l=e._viewParams.peek();e.resources.consume(c.isItemsScopeEnabledInAllPhotosPivotResourceKey)&&void 0===l.tagFilter&&(f=!0);return e._itemReedemer.redeemItems(t,e).then(function(){var r={selection:t,tagsToAdd:n,tagsToDelete:s};return e._panelProvider.requestPanel({title:a.strings.title,scrollMode:"always",component:{name:i.default.tagName,params:r}}).wait().then(function(){return n.length>0||s.length>0?e._tagProvider.updateTags({items:t,tagsToAdd:n,tagsToDelete:s,parentKey:e._currentItem.key,rootItemId:u.rootId,skipInvalidate:f}).then(function(){return{resultType:o.ResultTypeEnum.Success}},function(){return{resultType:o.ResultTypeEnum.Failure}}):{resultType:o.ResultTypeEnum.Success}},function(){return{resultType:o.ResultTypeEnum.Failure}})})})};return t}(f.default);t.default=h});
define("odsp-next/controls/tagEditor/TagEditor",["require","exports","./TagEditorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./TagEditor.html","./TagEditor.css","../tagInput/TagInput","../list/TagsList"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-tag-editor",template:e("./TagEditor.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/tagEditor/TagEditorViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","./TagEditor.resx","../../models/tag/TagSourceOptions","../../resources/ProviderResourceKeys","../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/string/StringHelper","../../models/itemSet/ItemSet","../../models/item/OneDriveItem","@ms/odsp-utilities/lib/object/ObjectUtil","../../models/selection/ItemSetSelectionModel","@ms/odsp-datasources/lib/interfaces/list/ColumnFieldType","../../bindings/keyboard/KeyboardBinding","../loadingSpinner/LoadingSpinner","../../controls/fluentStyling/FluentStyling.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.loadingSpinnerTagName=m.default.tagName;n.addBindingHandlers({keyboard:v.default});n.TagEditorResx=s;n._tagProvider=n.resources.consume(u.tag);n._photoProvider=n.resources.consume(u.photo);n.isFluentEnabled=n.resources.consume(g.resourceKey);n.emptyTagsImageUrl=window.require.toUrl("odsp-media/images/emptyfolder/empty_tags.svg");n.isExistingTagsEmpty=r.observable(!1);n.isTextBoxSelected=r.observable(!0);n.tagInput=r.observable("");n.isLoadingExistingTags=r.observable(!1);n._resolvedTags=r.observableArray(n._getCommonTags(t.selection));n.listRange=r.observable({start:0,end:0});n.listRange.equalityComparer=h.deepCompare;n.tagInputParams={inputText:n.tagInput,resolvedTags:n._resolvedTags,tagsToAdd:t.tagsToAdd,tagsToDelete:t.tagsToDelete,isTextBoxSelected:n.isTextBoxSelected};var i=new c.default,o=new l.default;o.item=r.observable(i);n.existingTagsSet=n.resources.expose(a.currentItemSet,r.observable(o));n.itemSelectionModel=n.resources.expose(a.itemsSelection,new(n.managed(p.default)));n.createComputed(n._computeAllExistingTagsForQuery).extend({rateLimit:250});n.createComputed(n._computeEnsureThumbnails);return n}t.prototype.getThumbnailUrl=function(e){var t="";e.folder&&e.folder.covers&&e.folder.covers.length>0&&(t=f.format(e.folder.covers[0].url,50,50));return t};t.prototype.onBackspace=function(e){var t=this.itemSelectionModel.getFocusIndex()>=0;if(t){this.itemSelectionModel.clear(!0);this.isTextBoxSelected(!0)}return!t};t.prototype.onUp=function(e){if(0===this.itemSelectionModel.getFocusIndex()){this.itemSelectionModel.clear(!0);this.isTextBoxSelected(!0)}return!1};t.prototype._getTagFieldColumn=function(){return{key:"",name:name,minWidth:240,width:240,isVisible:!0,isVisibleMobile:!0,isCollapsable:!1,groupable:!1,sortable:!1,isSorted:!1,isIcon:!1,isHtml:!1,isAscending:!0,fieldType:d.ColumnFieldType.Tag,filterable:!1,isFocused:r.observable(!1)}};t.prototype._computeAllExistingTagsForQuery=function(){var e=this;this.isLoadingExistingTags(!0);var t=this._resolvedTags().map(function(e){return"#"+(e.localizedTag||e.tag)});this.itemSelectionModel.clear(!0);var n=this.tagInput(),r=this._tagProvider.getAllTagsForQuery(n,t);this._existingTagsPromise=r;r.then(function(i){if(r!==e._existingTagsPromise)return null;e._existingTagsPromise=null;n||0!==t.length||e.isExistingTagsEmpty(0===i.content.peek().items.length);i.schema([e._getTagFieldColumn()]);e.existingTagsSet(i);e.isLoadingExistingTags(!1)})};t.prototype._computeEnsureThumbnails=function(){var e=this._photoProvider.getAllPhotosSettings(),t={rootItemId:e.peek().rootId,ascending:e.peek().isAscending,startIndex:0,parentKey:void 0};this._tagProvider.ensureHasThumbnails(this.existingTagsSet.peek(),this.listRange(),t)};t.prototype._getCommonTags=function(e){for(var t=e.length,n={},r={},i=[],s=0,u=e;s<u.length;s++)for(var a=u[s],f=0,l=a.tags&&a.tags.filter(function(e){return e.source!==o.default[o.default.LocationAndEventsAPI]&&e.source!==o.default[o.default.SystemDefined]&&!!e.tag});f<l.length;f++){var c=l[f],h=c.localizedTag||c.tag,p=(n[h]||0)+1;n[h]=p;r[h]=c}for(var d in n)n[d]>=t&&i.push(r[d]);return i};return t}(i.default);t.default=y});
define("odsp-next/models/tag/TagSourceOptions",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.LocationAndEventsAPI=0]="LocationAndEventsAPI";e[e.ObjectDetectors=1]="ObjectDetectors";e[e.LocationBasedPlace=2]="LocationBasedPlace";e[e.UserDefined=3]="UserDefined";e[e.SystemDefined=4]="SystemDefined"}(n||(n={}));t.default=n});
define("odsp-next/controls/tagEditor/TagEditor.html",[],function(){return'<div class=od-TagEditor data-bind="keyboard: { Backspace: onBackspace, Up: onUp, allowInputEvents: true }"><div data-bind="component: { name: \'od-tag-input\', params: tagInputParams }"></div>\x3c!--ko if: isExistingTagsEmpty--\x3e<div class=od-TagEditor-emptyExistingTags><img class=od-TagEditor-emptyExistingTags-image data-bind="attr:{src: emptyTagsImageUrl, height: 112 }"><div class="ms-font-xl ms-fontWeight-semilight od-TagEditor-emptyExistingTags-title" data-bind="text: TagEditorResx.strings.addFirstTagTitle"></div><div class="ms-font-m ms-fontWeight-semilight" data-bind="text: TagEditorResx.strings.addFirstTagDescription"></div></div>\x3c!--/ko--\x3e\x3c!--ko if: !isExistingTagsEmpty()--\x3e<div class=od-TagEditor-title data-bind="text: TagEditorResx.strings.addExistingTagTitle, css: { \'ms-font-l\': !isFluentEnabled, \'ms-fontWeight-semilight\': !isFluentEnabled, \'ms-fontWeight-semibold\': isFluentEnabled }"></div><span class=od-TagEditor-existingTags data-bind="component: { name: \'od-tags-list\', params: { itemSet: existingTagsSet, requiredRange: listRange, selectionModel: itemSelectionModel, isSelectionOnKeyInputEnabled: false } }"></span>\x3c!--ko if: isLoadingExistingTags--\x3e<span class=ms-font-m data-bind="component: { name: \'ms-loadingSpinner\', params: { loadingText: TagEditorResx.strings.loading } }"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/tagEditor/TagEditor.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-TagEditor{overflow:hidden}.isFluent .od-TagEditor{overflow:visible}.od-TagEditor-label.ms-Label{display:none}.od-TagEditor-input{width:100%}.od-TagEditor-existingTags .DetailsRow{height:52px;line-height:52px}.isFluent .od-TagEditor-existingTags .DetailsRow{height:32px;line-height:56px;padding:12px 0;margin:0 -12px;border-radius:2px}.isFluent.sm .od-TagEditor-existingTags .DetailsRow{margin:0 -8px}.od-TagEditor-existingTags .DetailsRow:hover .DetailsRow-check{display:none}.isFluent .od-TagEditor-existingTags .DetailsRow .DetailsRow-cell{padding:0 12px}.isFluent .od-TagEditor-existingTags .DetailsRow-check{visibility:hidden}.od-TagEditor-title{margin-top:20px;margin-bottom:10px}.isFluent .od-TagEditor-title{font-size:14px;margin-top:12px;margin-bottom:8px;padding-bottom:11px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-TagEditor-emptyExistingTags{margin-top:30px;text-align:center}.od-TagEditor-emptyExistingTags .od-TagEditor-emptyExistingTags-image{margin-bottom:20px}.od-TagEditor-emptyExistingTags .od-TagEditor-emptyExistingTags-title{margin-bottom:10px}"}])});
define("odsp-next/controls/tagInput/TagInput",["require","exports","./TagInputViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./TagInput.html","./TagInput.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-tag-input",template:e("./TagInput.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/tagInput/TagInputViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","knockout","./TagInput.resx","../../bindings/keyboard/KeyboardBinding","../../bindings/scrollIntoView/ScrollIntoViewBinding","../../models/tag/TagSourceOptions","../../models/tag/TagTypeOptions","../../resources/ControlResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=256,h=function(e){n.__extends(t,e);function t(t){var n=e.call(this)||this;n.error=i.observable("");n.addBindingHandlers({keyboard:o.default,scrollIntoView:u.default});n.inputChange=function(e,t){n._inputChangeOuter(t)};n.scrollDown=i.observable(!1);n.inputText=t.inputText;n._tagsToAdd=t.tagsToAdd;n._tagsToDelete=t.tagsToDelete;n._initialCommonTags=t.resolvedTags&&t.resolvedTags().slice(0)||[];n.resolvedTags=t.resolvedTags;n.maxTagLength=c;n.isDeleteMode=i.observable(!1);n._inputBoxWasEmpty=!0;n.showPlaceholder=i.observable(!0);n.inputPlaceholder=n.createComputed(function(){return""===n.inputText()&&0===n.resolvedTags().length?s.strings.InputPlaceholderText:""});n.inputSize=n.createComputed(function(){return n.inputText().length+1});n._selectionModel=n.resources.consume(l.itemsSelection);n._selectionModel.selection.subscribe(function(e){e.length>0&&n._resolveTag(e[0].peek().name)});n.isSelected=t.isTextBoxSelected;return n}t.prototype.removeItem=function(e){for(var t=0;t<this._initialCommonTags.length;t++)e===this._initialCommonTags[t]&&this._tagsToDelete.push(e);var n=this._tagsToAdd.indexOf(e);-1!==n&&this._tagsToAdd.splice(n,1);this.resolvedTags.remove(e);this.isSelected(!0)};t.prototype.focus=function(){this.isSelected(!0);this.showPlaceholder()&&this.showPlaceholder(!1)};t.prototype.inputFocus=function(){this.showPlaceholder()&&this.showPlaceholder(!1)};t.prototype.inputBlur=function(){this.showPlaceholder()||0!==this.resolvedTags().length||0!==this.inputText().length||this.showPlaceholder(!0)};t.prototype.inputPaste=function(e,t){var n=this;this.async.setTimeout(function(){n._resolveTag(n.inputText());n.inputText("")},500);return!0};t.prototype.getTagDisplayText=function(e){return"#"+(e.localizedTag||e.tag)};t.prototype.onDown=function(e,t){this.isDeleteMode(!1);this._selectionModel.setIndexFocus(0);return!1};t.prototype._inputChangeOuter=function(e){var t=this;this._timer||this.async.clearTimeout(this._timer);this._timer=this.async.setTimeout(function(){t._inputChange(e);t._timer=null},130)};t.prototype._add=function(e){this.inputText("");this._tagsToAdd.push(e);this.resolvedTags.push(e);this._scrollIntoView()};t.prototype._inputChange=function(e){var t=e.keyCode,n=this.inputText().length;this._scrollIntoView();if(0===n){8===t&&this._inputBoxWasEmpty&&(this.isDeleteMode.peek()?this.removeItem(this.resolvedTags.pop()):this.isDeleteMode(!0));this._inputBoxWasEmpty=!0}else{this.isDeleteMode(!1);13===t||51===t&&e.shiftKey&&this.inputText().length>1?this._resolveTag(this.inputText()):this._inputBoxWasEmpty=!1}};t.prototype._scrollIntoView=function(){var e=this;this.async.setTimeout(function(){e.scrollDown(!0);e.scrollDown(!1)},1e3)};t.prototype._resolveTag=function(e){for(var t,n=e.split(/[,;#]/),r=0;r<n.length;r++){var i=n[r].trim();if(""!==i){t=this._getUserDefinedTag(i);this._add(t)}}this._inputBoxWasEmpty=!0;this.isSelected(!0);this.isDeleteMode(!1)};t.prototype._getUserDefinedTag=function(e){return{source:a.default[a.default.UserDefined],tag:e,type:f.default[f.default.keyword]}};return t}(r.default);t.default=h});
define("odsp-next/models/tag/TagTypeOptions",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.keyword=0]="keyword";e[e.Scene=1]="Scene";e[e.Location=2]="Location"}(n||(n={}));t.default=n});
define("odsp-next/controls/tagInput/TagInput.html",[],function(){return'<div class=TagInput data-bind="click: function() {focus()}, css: { \'TagInput--isDeleteMode\': isDeleteMode }, attr: {title: inputPlaceholder}"><div class=TagInput-container>\x3c!--ko foreach: resolvedTags--\x3e<div class="TagInput-resolvedTag TagInput-entry"><a class="TagInput-resolvedTagLink ms-font-m" data-bind="attr: { title: $component.getTagDisplayText($data) }"><div class=TagInput-resolvedTagName data-bind="text: $component.getTagDisplayText($data)"></div></a> <a href=# class="TagInput-removeTag ms-font-m" data-bind="click: $component.removeItem.bind($component)"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></a></div>\x3c!--/ko--\x3e<input class="TagInput-textBox TagInput-entry" type=text autocomplete=off autocapitalize=off autocorrect=off autofocus data-bind="value: inputText, valueUpdate: \'keyup\', attr:{ size: inputSize, title: inputPlaceholder, maxlength: maxTagLength}, automation: \'addTagInput\', event:{ keyup: inputChange, focus: inputFocus, blur: inputBlur, paste: inputPaste }, hasFocus: isSelected, keyboard: { mappings: { Down: onDown }, context: $data, allowInputEvents: true }"> <span class="TagInput-ghostText TagInput-entry" aria-hidden=true data-bind="text: inputPlaceholder, visible: showPlaceholder"></span></div><div class=TagInput-belowContainer data-bind="scrollIntoView: { isSelected: scrollDown }"></div></div><div aria-live=assertive class=TagInput-error data-bind="text: error"></div>'});
define("odsp-next/controls/tagInput/TagInput.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".TagInput{border:0;border-bottom:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";background-color:#fff;width:100%;box-sizing:border-box;overflow-y:auto;overflow-x:hidden;max-height:150px;position:relative}.isFluent .TagInput{border-bottom:0}.TagInput.TagInput--isDeleteMode .TagInput-container .TagInput-entry:nth-last-child(3){background-color:"},{theme:"themeSecondary",defaultValue:"#2f69c0"},{rawString:"}.TagInput.TagInput--isDeleteMode .TagInput-container .TagInput-entry:nth-last-child(3) .TagInput-removeTag,.TagInput.TagInput--isDeleteMode .TagInput-container .TagInput-entry:nth-last-child(3) .TagInput-resolvedTagName{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.TagInput.TagInput--isDeleteMode .TagInput-container .TagInput-entry:nth-last-child(3) .TagInput-removeTag:hover,.TagInput.TagInput--isDeleteMode .TagInput-container .TagInput-entry:nth-last-child(3) .TagInput-resolvedTagName:hover{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.TagInput-container{display:inline-block}.isFluent .TagInput-container{display:block}.TagInput-ghostText{position:absolute;top:5px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";white-space:nowrap}[dir=ltr] .TagInput-ghostText{left:5px}[dir=rtl] .TagInput-ghostText{right:5px}.TagInput-textBox{border:0;vertical-align:inherit;background-color:transparent;margin:5px;vertical-align:top;outline:0}html[dir=ltr] .TagInput-textBox{float:left}html[dir=rtl] .TagInput-textBox{float:right}.TagInput-textBox::-ms-clear{display:none}.TagInput-textBox:focus{outline-color:transparent}.TagInput-removeItem{width:20px;font-weight:700;text-decoration:none;display:inline-block;font-size:10px;vertical-align:top}.TagInput-removeItem:hover{background-color:"},{theme:"themeLight",defaultValue:"#a8d1ef"},{rawString:"}.TagInput-removeItem .ms-Icon--Cancel{padding:8px 5px 5px}.TagInput-error{color:#a80000}.TagInput-resolvedTag{font-size:12px;line-height:32px;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:";border:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";display:inline-block;height:32px;margin:0 8px 8px 0;white-space:nowrap}html[dir=ltr] .TagInput-resolvedTag{float:left}html[dir=rtl] .TagInput-resolvedTag{float:right}html[dir=rtl] .TagInput-resolvedTag{margin:0 0 8px 8px}.isFluent .TagInput-resolvedTag{line-height:28px;height:28px;border:0;border-radius:2px}.TagInput-resolvedTagLink{display:inline-block;overflow:hidden;cursor:pointer}.TagInput-resolvedTagName{display:inline-block;padding:0 8px;max-width:180px}.isFluent .TagInput-resolvedTagName{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.TagInput-removeTag:hover,.TagInput-resolvedTagLink:hover,.od-Focus--enabled .TagInput-removeTag:focus,.od-Focus--enabled .TagInput-resolvedTagLink:focus{color:"},{theme:"black",defaultValue:"#000000"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.TagInput-removeTag{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";width:32px;text-decoration:none;display:inline-block;vertical-align:top;text-align:center}.isFluent .TagInput-removeTag{width:28px;font-size:12px}.isFluent .TagInput-removeTag:focus{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}"}])});
define("odsp-next/actions/shareByLink/odc/ShareByLinkExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../resources/ControlResourceKeys","../../../providers/dialog/DialogProvider","../../../controls/sharing/sharingWizard/SharingWizard","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../controls/loadingSpinner/LoadingSpinner","../../../models/item/ItemType","../../../controls/sharing/sharingWizard/SharingWizard.resx","../../../controls/sharing/shareByEmail/Sharing.resx","../../../providers/engagement/Engagement","../../../utilities/icons/Icon","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/list/ShortcutUtilities","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/string/StringHelper","../../../controls/textContainer/TextContainer","../../base/ItemRedeemer","../../../providers/item/ItemProvider"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.canToggleEditInline=!0;n.hideInviteOptions=!0;n.requireSignInByDefault=!1;n.name=t.actionName;n._initialState=t&&t.startState?[1,t.startState]:[1];n._selectionHelper=t.selectionHelper;n._itemReedemer=new(n.managed(b.default));if(t&&t.item&&t.item())n._itemPromise=r.default.wrap([t.item()]);else if(t&&t.itemKey){var i=n.resources.consume(w.resourceKey);n._itemPromise=i.getSpecifiedItems({itemKeys:[t.itemKey],recurseInFolders:!0}).then(function(e){return e.children})}n.urlDataSource=n.resources.consume(d.url);var s=t.sharingMethod,o=void 0===s?null:s;n.sharingMethod=o;return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveSelection().then(function(t){return e._itemReedemer.redeemItems(t,e).then(function(){var n=e.resources.consume(s.resourceKey);if(t.some(function(e){return!!e.vault}))return e._showVaultWarning(n);if(t.length>=100){var d=g.format(c.strings.MultiShareTitleText,t.length),m=g.format(c.strings.MultiShareOverLimit,100);return n.requestDialog({title:d,component:{name:y.default.tagName,params:{text:m}}}).wait().then(function(){return r.default.wrap({resultType:u.ResultTypeEnum.Success})})}for(var b=[],w=0;w<e._selectionHelper.selection().length;w++){var E=e._selectionHelper.selection()[w];b.push(E())}var S=e.observables.create([].concat(e._initialState)),x=e.observables.create(""),T=e.observables.create(!0),N=e._itemPromise,C=!1;if(!N){N=r.default.wrap(b);C=!0}if(!C)var k=n.requestDialog({title:c.strings.ShareText,size:"Medium",component:{name:a.default.tagName,params:{}}});return N.then(function(t){k&&k.dismiss();if(!t[0])return r.default.wrapError({resultType:u.ResultTypeEnum.Failure,resultCode:"ItemNotFound"});var s=e.resources.consume(h.resourceKey);v.default.isShortcutItem(t[0])&&s.logData({name:"ShortcutLink.ShareByLinkInitiate"});var a=n.requestDialog({title:x,size:"Medium",shouldPreserveFocus:T,component:{name:o.default.tagName,params:{items:t,dialogTitle:x,stateArray:S,canToggleEditInline:e.canToggleEditInline,hideInviteOptions:e.hideInviteOptions,requireSignInByDefault:e.requireSignInByDefault,onExecuteAction:function(){return a.state(2)},shouldPreserveFocus:T,resources:e.resources,sharingMethod:e.sharingMethod}},titleAction:{name:l.strings.BackButtonText,execute:function(){var e=S();switch(e.pop()){case 2:s.logData({name:"GoBackSharedWith.SharingWizard.Click",isIntentional:!0});break;case 3:s.logData({name:"GoBackAddPeople.SharingWizard.Click",isIntentional:!0})}S(e);return r.default.wrap(1)},icon:new p.default("Back"),isVisible:e.observables.pureCompute(function(){return S().length>1})}}),c=e.subscribe(e.resources.consume(i.currentItemSet),function(){a.dismiss()});return a.wait().then(function(){c.dispose();S([]);var e={},t={count:b.length};if(1===b.length){e.fileType=f.default[b[0].type];e.extension=b[0].extension||""}return{resultType:u.ResultTypeEnum.Success,extraData:e,extraMetrics:t}},function(e){c.dispose();S([]);return r.default.wrapError(e)})})})})};t.prototype._showVaultWarning=function(e){var t=c.strings.VaultShareTitle,n=c.strings.VaultShareText,i=e.requestDialog({title:t,component:{name:y.default.tagName,params:{text:n}},actions:[{name:c.strings.Close,execute:function(){return r.default.resolve(2)},isAvailable:this.observables.create(!0),icon:new p.default("CheckMark"),isDefault:!0}]});this.resources.consume(h.resourceKey).logData({name:"Vault.Share.Clicked"});return i.wait().then(function(){return r.default.wrap({resultType:u.ResultTypeEnum.Success})})};return t}(m.default);t.default=E});
define("odsp-next/controls/sharing/sharingWizard/SharingWizard",["require","exports","./SharingWizardViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../sharingByLink/SharingByLink","./SharingWizard.html","./SharingWizard.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-shareWizard",template:e("./SharingWizard.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/sharing/sharingWizard/SharingWizardViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../loadingSpinner/LoadingSpinner","./SharingWizardTemplates","../../../providers/sharing/SharingProvider","../../../models/item/ItemType","../sharingWizard/SharingWizard.resx","@ms/odsp-utilities/lib/string/StringHelper","../../../bindings/css/VisibilityBinding","../sharingHints/SharingHints"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.loadingSpinnerTagName=s.default.tagName;n.sharingHintsTagName=h.default.tagName;n._params=t;n.addBindingHandlers({visibility:c.default});n._sharingProvider=n.resources.consume(u.resourceKey);n._stateStack=t.stateArray;n._currentState=n.createComputed(function(){return this._stateStack()[this._stateStack().length-1]});n.currentLink=r.observable(null);n._items=t.items;n._sharingMethod=t.sharingMethod;n._companyDisplayName=t.companyDisplayName;n._expiration=n.createObservable(null);n.componentDefinition=n.createComputed(function(){return n._getComponentDefinition()});n.isLoading=r.observable(!0);if(n._items.length>1){n._shareDialogTitle=l.format(f.strings.MultiShareTitleText,n._items.length);n._params.dialogTitle(n._shareDialogTitle);n.isLoading(!1)}else n._getSharingSettings();n.sharingHintsParams={guestLinkExists:r.observable(!1),sharedWithMany:r.observable(!1),sharingHintsOption:1,sharedWith:r.observableArray([]),items:n._items};return n}t.prototype._getSharingSettings=function(){var e=this,t=this._items[0],n=t.type===a.default.Folder?f.strings.MissingFolderTitle:f.strings.MissingFileTitle,r=this._sharingProvider.getSharingData(t);this.isReady=r.getSettings().then(function(t){e._sharingSettings=t;e._shareDialogTitle=e._sharingSettings.itemId?l.format(f.strings.TitleText,t.itemName):n;e._params.dialogTitle(e._shareDialogTitle);e.isLoading(!1)},function(n){e._shareDialogTitle=l.format(f.strings.TitleText,t.name);e._params.dialogTitle(e._shareDialogTitle);e.isLoading(!1)})};t.prototype._getComponentDefinition=function(){var e=o.getTemplateName(this._currentState()),t={items:this._items,dialogStateArray:this._stateStack,includeLinks:!0,currentLink:this.currentLink,height:"500px",canToggleEditInline:this._params.canToggleEditInline,onExecuteAction:this._params.onExecuteAction,shouldPreserveFocus:this._params.shouldPreserveFocus,sharingMethod:this._sharingMethod,selectedPeople:r.observableArray([]),hasUnresolvedText:r.observable(!1),companyDisplayName:this._companyDisplayName,expiration:this._expiration};4===this._currentState()?this._params.dialogTitle(f.strings.SwitchLink):this._params.dialogTitle(this._shareDialogTitle);3===this._currentState()&&(t={selectedPeople:r.observableArray([]),roleValue:r.observable(""),emailMessage:r.observable(""),errorMessage:r.observable(""),sendEmail:r.observable(!0),requireSignIn:r.observable(this._params.requireSignInByDefault),propagateSharing:r.observable(!1),hasUnresolvedText:r.observable(!1),emailMessageExceedsLimit:r.observable(!1),dialogTitle:r.observable(""),hideOptions:this._params.hideInviteOptions,showSendEmailOption:!0,onExecuteAction:this._params.onExecuteAction,items:this._items,currentLink:this.currentLink,sharingMethod:this._sharingMethod,companyDisplayName:this._companyDisplayName,expiration:this._expiration});return{name:e,params:t}};return t}(i.default);t.default=p});
define("odsp-next/controls/sharing/sharingWizard/SharingWizardTemplates",["require","exports","../sharingByLink/SharingByLink","../sharedWith/SharedWith","../shareByEmail/ShareByEmail","../sharingLinksSwitcher/SharingLinksSwitcher"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getTemplateName=function(e){switch(e){case 1:return n.default.tagName;case 2:return r.default.tagName;case 3:return i.default.tagName;case 6:case 4:return s.default.tagName;default:return n.default.tagName}};t.getBottomAction=function(e){switch(e){case 1:case 3:return 2;case 2:return 3;default:return 1}}});
define("odsp-next/controls/sharing/sharingByLink/SharingByLink",["require","exports","./SharingByLinkViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SharingByLink.html","./SharingByLink.css","../../panelHost/PanelHost"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-sharebylink",template:e("./SharingByLink.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/sharing/sharingByLink/SharingByLinkViewModel",["require","exports","tslib","office-ui-fabric-react/lib/Styling","../../../providers/engagement/Engagement","../../../models/teachingBubble/TeachingBubbleCampaigns","../../../utilities/dom/Dom","../../gleamCallout/GleamCallout","../../../providers/item/ItemProvider","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../../providers/featureCards/FeatureCardsProvider","../../../providers/featureCards/FeatureCards.resx","./SharingByLink.resx","../../../utilities/logging/odc/UsageNames","@ms/odsp-utilities/lib/logging/events/UsageType","./SharingByLinkStringHelper","../../../utilities/attribution/AttributionHelper","../../../utilities/browser/ClipboardData","../../../resources/ControlResourceKeys","../../featureCards/FeatureCards","../../../providers/sharing/SharingProvider","../../../models/item/ItemType","../../../bindings/keyboard/KeyboardBinding","../../loadingSpinner/LoadingSpinner","@ms/odsp-utilities/lib/async/Promise","../../../resources/ProviderResourceKeys","../../../bindings/react/ReactBinding","../../../bindings/focus/SelectOnFocusBinding","../../../dataSources/sharing/odc/SharingLinkExpirationHelper","../../../models/sharing/SharingNetworks","../../../bindings/teachingBubble/TeachingBubbleBinding","@ms/odsp-shared/lib/base/ViewModel","../../../utilities/features/Features","../../../resources/ODCResourceKeys","../../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var H=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.loadingSpinnerTagName=x.default.tagName;n.passwordProtectedLinkIndicatorLabel=h.strings.passwordProtectedLinkIndicatorAriaLabel;n.addBindingHandlers({keyboard:S.default,react:C.default,selectOnFocus:k.default,teachingBubble:O.default});var r=t.canToggleEditInline,o=t.currentLink,p=t.dialogStateArray,d=t.expiration,T=t.items,M=t.onExecuteAction,H=t.shouldPreserveFocus;n._canToggleEditInline=r;n._dialogStateArray=p;n._items=T;n._onExecuteAction=M;n._shouldPreserveFocus=H;n._expiration=d;n._isOneDriveWinApp=P.isOneDriveWinApp();n._actionMap=n.resources.consume(y.actionMap);n._attributionHelper=n.resources.consume(m.resourceKey);n._instrumentationProvider=n.resources.consume(N.instrumentation);n._itemProvider=n.resources.consume(a.resourceKey);n._platform=n.resources.consume(f.platformDetection);n._sharingProvider=n.resources.consume(w.resourceKey);n._sharingLinkExpirationHelper=new(n.managed(L.default));n._storageOptionsProvider=n.resources.consume(N.storageOptions);n._userInfoProvider=n.resources.consume(N.userInfo);n._featureCardsProvider=n.resources.consume(l.resourceKey);n._engagement=n.resources.consume(i.resourceKey);n._odcUrlDataSource=n.resources.consume(D.urlDataSource);n.allowEditChecked=n.createObservable(!1);n.allowEditText=h.strings.AllowEdit;n.copyText=h.strings.CopyLinkText;n.currentSharingLink=o;n.error=n.createObservable("");n.displayFeatureCards=n.createObservable(!1);n.featureCardIndex=0;n.setPasswordChecked=n.createObservable(!1);n.featureCardsTagName=b.default.tagName;n.generatingLinkForSocialNetworkText=h.strings.generatingLinkForSocialNetworkText;n.getLinkText=h.strings.GetLink;n.gleamImageUrl=window.require.toUrl("odsp-media/images/premium/premium-gleam-single.svg");n.hasError=n.createObservable(!1);n.hasLoadingError=n.createObservable(!1);n.invalidPasswordText=h.strings.invalidPasswordError;n.inviteText=h.strings.AddPeopleEmail;n.isAllowEditVisible=n.createObservable(!0);n.isCopyLoadingVisible=n.createObservable(!1);n.isCreatingLink=n.createObservable(!1);n.isLinkDisabled=n.createObservable(!1);n.isManagePermissionsVisible=n.createObservable(n._canToggleEditInline);n.isMoreSectionVisible=n.createObservable(!1);n.isSingleLinkLabelVisible=n.createObservable(!1);n.linkExpiresText=h.strings.SetExpirationLabel;n.linkTitle=h.strings.ChangeLinkTitle;n.linkExpiresChecked=n.createObservable(!1);n.linkExpirationInDays=n.createObservable(L.DEFAULT_EXPIRATION).extend({notify:"always"});n.loading=n.createObservable(!0);n.manageAccessLink=h.strings.ManageAccessLink;n.managePermissionsText=h.strings.managePermissions;n.missingItemError=n._items[0].type===E.default.Folder?h.strings.MissingFolderError:h.strings.MissingFileError;n.moreOptionsText=h.strings.MoreOptions;n.moreSectionIcon=n.createPureComputed(n._computeMoreIcon);n.networksList=[A.default.Facebook,A.default.Twitter,A.default.LinkedIn,A.default.Weibo];n.networksList.forEach(function(e){e.isCreatingLink=n.createObservable(!1)});n.note=n.createObservable("");n.peopleSharingWith=n.observables.createArray();n.setPasswordPermissionsWarning=h.strings.SetPasswordPermissionsWarning;n.sharingLinkUrl=n.createObservable("");n.supportsCopy=(g.default.CanUseClipboardData()||document.queryCommandSupported&&document.queryCommandSupported("copy"))&&!n._platform.isIOS;n.setPasswordLabel=h.strings.SetPasswordLabel;n.passwordDisplayValue=n.createObservable("");n.passwordHasBeenUpdated=n.createObservable(!1);n.isPasswordInvalid=n.createComputed(n._computeIsPasswordInvalid);n._areNetworksSupported=n.createObservable(!1);n._expiringLinkGleamCalloutStrings={calloutTitle:c.strings.expiringLinksFeatureHeadline,calloutBody:c.strings.expiringLinksFeatureBody,premiumButtonText:h.strings.premiumButtonText,learnMoreButtonText:h.strings.learnMoreButtonText};n._passwordProtectedLinkGleamCalloutStrings={calloutTitle:c.strings.passwordProtectedLinksFeatureName,calloutBody:c.strings.passwordProtectedBody,premiumButtonText:h.strings.premiumButtonText,learnMoreButtonText:h.strings.learnMoreButtonText};n._isMultiSelect=n._items.length>1;n._defaultGleamCalloutIconUrl=window.require.toUrl("@ms/odsp-media/images/premium/diamond-blue-background-24.svg");n._sharingLinksCollection=n.observables.createArray();n._showExpiringLinkTeachingBubble=n.createObservable(!1);n._expiringLinkUpgradeNavigationAction=n._createExpiringLinkUpgradeNavigationAction();n._passwordProtectedLinkUpgradeNavigationAction=n._createPasswordProtectedLinkUpgradeNavigationAction();n._showAction=new(n.managed(n._actionMap.ShowPermissionsAction));n.createComputed(n._onCurrentSharingLinkUpdated);n.createComputed(n._onAllowEditToggled);n.featureCardData=n._getFeatureCardsData();n.arrowIcon=n.createPureComputed(n._computeArrowIcon);n.isNetworksSectionVisible=n.createPureComputed(n._computeIsNetworksSectionVisible);n.isPremiumEligible=n.createPureComputed(n._computeIsPremiumEligible);n.isPremium=n.createComputed(n._computeIsPremium);n.arePasswordProtectedLinksEnabled=_.isFeatureEnabled(_.EnablePasswordProtectedLinks);n.createBackgroundComputed(n._onSetPasswordChecked);n.isPasswordProtectedLinksBannerVisible=n.createPureComputed(n._computeIsPasswordProtectedLinksBannerVisible);n.createBackgroundComputed(n._computeValidInput);n.linkExpiresInputLabel=n.createPureComputed(n._computeLinkExpiresInputLabel);n.createBackgroundComputed(n._linkExpirationChanged);n.createBackgroundComputed(n._onLinkExpiresChecked);n._isExpiringLinkCalloutOpen=n.createObservable(!1);n._isPasswordProtectedLinkCalloutOpen=n.createObservable(!1);n._userInfoProvider.getExpiringSharingLinksSeen().then(function(e){if(!e){n.isAllowEditVisible(!0);n.isPremiumEligible.peek()?n.async.setTimeout(function(){n._isExpiringLinkCalloutOpen(!0)},0):n.async.setTimeout(function(){n._showExpiringLinkTeachingBubble(!0)},0);n._userInfoProvider.setExpiringSharingLinksSeen()}});n.expiringLinkTeachingBubbleOptions={campaign:n.createObservable(s.EXPIRING_SHARING_LINKS),isVisible:n._showExpiringLinkTeachingBubble};n.gleamCalloutComponent=u.GleamCallout;n.expiringLinkGleamCalloutComponentProps=n.createPureComputed(n._computeExpiringLinkGleamCalloutProps);n.passwordProtectedLinkGleamCalloutComponentProps=n.createPureComputed(n._computePasswordProtectedLinkGleamCalloutProps);n.sharingHintText=n.createComputed(function(){var e=n.currentSharingLink();if(e)return v.getLinkHintText(e,null,n.peopleSharingWith())});n._checkForSpecialFolder();n._getSharingInfo();return n}t.prototype.getNetworkAltText=function(e){return e.altText};t.prototype.logCopy=function(e,t,n){var r=this;this._engagement.logData({name:this.currentSharingLink().tag+"Link.SharingByLinkDialog.Copy",isIntentional:!0,extraData:{linkExpiration:this.linkExpiresChecked.peek()?this.linkExpirationInDays.peek():"0",hasPassword:0!==this.passwordDisplayValue.peek().length}});if(n){this.isCopyLoadingVisible(!0);this.async.setTimeout(function(){r.isCopyLoadingVisible(!1)},1e3)}return!0};t.prototype.onClickCopyLink=function(e,t){var n=!1,r=o.findAncestor(t.target,"od-SharingByLink-row").getElementsByTagName("input")[0];try{r.select();n=document.execCommand("copy")}catch(e){}!n&&g.default.CanUseClipboardData()&&(n=!!g.default.CopyToClipboard(this.currentSharingLink().url));this.logCopy(e,t,n);return!0};t.prototype.onClickCreateLink=function(){this.canManageLinks&&this._createLink()};t.prototype.onMoreOptionsClicked=function(){this.isMoreSectionVisible(!this.isMoreSectionVisible.peek());return!1};t.prototype.onNetworkClicked=function(e,t){var n=this;if(this.currentSharingLink().url)A.default.open(e,this.currentSharingLink().url);else{e.isCreatingLink(!0);this._createLink(!0).then(function(){e.isCreatingLink(!1);A.default.open(e,n.currentSharingLink().url)})}this._engagement.logData({name:p.UsageName[this._getNetworkUsageName(e.name)],isIntentional:!0,location:p.LocationName[p.LocationName.SharingDialog],usageType:d.UsageType[d.UsageType.Click],currentPage:this._instrumentationProvider.currentPageName(),previousPage:this._instrumentationProvider.previousPageName()});return!1};t.prototype.onSetPasswordClicked=function(){if(this.isPremiumEligible.peek()){this._currentPremiumFeatureGleamShowing=1;this._isPasswordProtectedLinkCalloutOpen(!0)}return!0};t.prototype.showInvite=function(){if(!this.isCreatingLink.peek()){if(this._dialogStateArray){this._engagement.logData({name:"AddPeople.SharingByLinkDialog.Click",isIntentional:!0});if(this.linkExpiresChecked.peek()){var e=this.linkExpirationInDays.peek(),t=this._sharingLinkExpirationHelper.computeExpirationValidity(e);t===L.LinkExpirationValidity.Valid?this._expiration(this._sharingLinkExpirationHelper.calculateLinkExpiration(parseInt(e,10))):t===L.LinkExpirationValidity.Empty?this._expiration(null):t===L.LinkExpirationValidity.Invalid&&this._expiration(null)}else this._expiration(null);var n=this._dialogStateArray();n.push(3);this._dialogStateArray(n)}return!1}};t.prototype.showPermissions=function(e,t){this._shouldPreserveFocus(!1);new(this.managed(this._actionMap.ShowPropertiesAction))({useToggleBehavior:!1}).execute(t);this._engagement.logData({name:"ManagePermissions.SharingByLinkDialog.Click",isIntentional:!0});this._onExecuteAction();new(this.managed(this._actionMap.ShowPermissionsAction))({item:this.createObservable(this._items[0])}).execute(t);return!1};t.prototype.switchLinks=function(){this.canManageLinks&&this.isAllowEditVisible(!this.isAllowEditVisible.peek())};t.prototype.onLinkExpiresClicked=function(){if(this.isPremiumEligible.peek()){this._currentPremiumFeatureGleamShowing=0;this._isExpiringLinkCalloutOpen(!0)}return!0};t.prototype.closeFeatureCards=function(){this.displayFeatureCards(!1);0===this._currentPremiumFeatureGleamShowing?this._isExpiringLinkCalloutOpen(!0):1===this._currentPremiumFeatureGleamShowing&&this._isPasswordProtectedLinkCalloutOpen(!0)};t.prototype.onPasswordDefined=function(){this.onPasswordChanged()||this.onClickCreateLink()};t.prototype.onPasswordChanged=function(){var e=this.currentSharingLink.peek(),t=e&&e.url.length>0;if(t){this.passwordHasBeenUpdated(!0);this._onLinkExpiresOrPasswordSettingChanged()}return t};t.prototype.clearPasswordDisplayValue=function(){this.passwordDisplayValue("")};t.prototype.launchPermissionsPanel=function(e){this._engagement.logData({name:"ODCExpiringSharingLinks.PasswordBannerManageAccessClicked",isIntentional:!0});this._executeShowPermissionsPanel(e)};t.prototype._executeShowPermissionsPanel=function(e){this._showAction.execute(e).done()};t.prototype._onSetPasswordChecked=function(){var e=this.setPasswordChecked(),t=this.currentSharingLink.peek(),n=t&&t.hasPassword,r=n&&!e;n&&e?this.passwordDisplayValue("        "):this.passwordDisplayValue("");r&&this.onPasswordChanged()};t.prototype._computePasswordProtectedLinkGleamCalloutProps=function(){var e=this;return{forceOpenCallout:this._isPasswordProtectedLinkCalloutOpen(),goPremiumAction:this._goToUpgradePage.bind(this,"ODCPasswordProtectedLinks",this._passwordProtectedLinkUpgradeNavigationAction),learnMoreAction:this._showPasswordProtectedLinkFeatureCards.bind(this),onDismissed:this._onGleamCalloutStateChange.bind(this,"ODCPasswordProtectedLinks",!1,function(){e._isPasswordProtectedLinkCalloutOpen(!1)}),onOpened:this._onGleamCalloutStateChange.bind(this,"ODCPasswordProtectedLinks",!0,function(){e._isPasswordProtectedLinkCalloutOpen(!0)}),strings:this._passwordProtectedLinkGleamCalloutStrings,isMobile:this._platform.isMobile,gleamCalloutHeaderIconUrl:this._defaultGleamCalloutIconUrl}};t.prototype._computeIsPasswordInvalid=function(){return!(!this.passwordHasBeenUpdated.peek()&&"        "===this.passwordDisplayValue())&&(0!==this.passwordDisplayValue().length&&0===this.passwordDisplayValue().trim().length)};t.prototype._onGleamCalloutStateChange=function(e,t,n){var r=t?"UpsellShown":"UpsellDismissed";this._engagement.logData({name:e+"."+r});n()};t.prototype._showPasswordProtectedLinkFeatureCards=function(){this._engagement.logData({name:"ODCPasswordProtectedLinks.LearnMoreClicked",isIntentional:!0});this.featureCardIndex=this.passwordProtectedLinkFeatureCardsIndex;this.displayFeatureCards(!0)};t.prototype._getFeatureCardsData=function(){var e=this,t=this._featureCardsProvider.getFeatureCards();t&&t.forEach(function(t,n){3===t.type&&(e.expiringLinkFeatureCardsIndex=n);8===t.type&&(e.passwordProtectedLinkFeatureCardsIndex=n)});return t};t.prototype._createPasswordProtectedLinkUpgradeNavigationAction=function(){return this._isOneDriveWinApp?this._createNavigationActionInBrowser():this._createNavigationAction("PasswordProtectedLinks")};t.prototype._createNavigationAction=function(e){var t=this._attributionHelper.getPurchaseAttribution({source:e,cta:"GoPremium"}),n=this.resources.consume(y.actionMap);return new(this.managed(n.NavigationAction))({url:this._odcUrlDataSource.getUpgradeOptionsUrl(t,!0)})};t.prototype._createNavigationActionInBrowser=function(){return new(this.managed(this._actionMap.NavigationAction))({url:"https://go.microsoft.com/fwlink/?LinkId=330671&clcid=0x"})};t.prototype._computeExpiringLinkGleamCalloutProps=function(){var e=this;return{forceOpenCallout:this._isExpiringLinkCalloutOpen(),goPremiumAction:this._goToUpgradePage.bind(this,"ODCExpiringSharingLinks",this._expiringLinkUpgradeNavigationAction),learnMoreAction:this._showExpiringLinkFeatureCards.bind(this),onDismissed:this._onGleamCalloutStateChange.bind(this,"ODCExpiringSharingLinks",!1,function(){e._isExpiringLinkCalloutOpen(!1)}),onOpened:this._onGleamCalloutStateChange.bind(this,"ODCExpiringSharingLinks",!0,function(){e._isExpiringLinkCalloutOpen(!0)}),strings:this._expiringLinkGleamCalloutStrings,isMobile:this._platform.isMobile,gleamCalloutHeaderIconUrl:this._defaultGleamCalloutIconUrl}};t.prototype._goToUpgradePage=function(e,t){this._engagement.logData({name:e+".GoPremiumClicked",isIntentional:!0});t.execute(null);t.dispose();this._onExecuteAction()};t.prototype._createExpiringLinkUpgradeNavigationAction=function(){return this._isOneDriveWinApp?this._createNavigationActionInBrowser():this._createNavigationAction("ExpiringLinks")};t.prototype._showExpiringLinkFeatureCards=function(){this._engagement.logData({name:"ODCExpiringSharingLinks.LearnMoreClicked",isIntentional:!0});this.featureCardIndex=this.expiringLinkFeatureCardsIndex;this.displayFeatureCards(!0)};t.prototype._computeValidInput=function(){var e=this.linkExpirationInDays(),t=parseInt(e,10);this.linkExpirationInDays(t>0&&t<=L.MAX_EXPIRATION?t.toString():"")};t.prototype._checkForSpecialFolder=function(){this._items[0].isSpecialFolder&&this.note(h.strings.specialFolderNote)};t.prototype._computeLinkExpirationInDays=function(e){var t=this.currentSharingLink.peek(),n=parseInt(L.DEFAULT_EXPIRATION,10);t&&t.expiration&&(n=this._sharingLinkExpirationHelper.getDaysFromToday(new Date(t.expiration)));var r=n.toString();this._lastExpiration=e?r:null;this.linkExpirationInDays(r)};t.prototype._computeArrowIcon=function(){return this.unwrapObservable(this.sharingHintText)?this._computeChevron(this.isAllowEditVisible()):""};t.prototype._computeMoreIcon=function(){return this._computeChevron(!this.isMoreSectionVisible())};t.prototype._computeChevron=function(e){var t="Chevron"+(e?"Down":"Up");return r.getIconClassName(t)+" ms-Icon--"+t};t.prototype._computeIsNetworksSectionVisible=function(){return!!this._areNetworksSupported()&&!this._platform.isMobile};t.prototype._computeIsPremiumEligible=function(){return!!_.isFeatureEnabled(_.EnablePremiumCheckWebPasswordLinks)&&(!this._storageOptionsProvider.isReady()||this._storageOptionsProvider.isEligibleForPremium.peek())};t.prototype._computeIsPremium=function(){return!_.isFeatureEnabled(_.EnablePremiumCheckWebPasswordLinks)||!!this._storageOptionsProvider.isReady()&&this._storageOptionsProvider.hasOffice.peek()};t.prototype._computeIsPasswordProtectedLinksBannerVisible=function(){return this.arePasswordProtectedLinksEnabled&&this.currentSharingLink().url&&this.setPasswordChecked()};t.prototype._computeLinkExpiresInputLabel=function(){var e=this.linkExpirationInDays();return this._sharingLinkExpirationHelper.computeLinkExpiresInputLabel(e)};t.prototype._onLinkExpiresChecked=function(){this.linkExpiresChecked()?this._computeLinkExpirationInDays(!1):this.linkExpirationInDays("")};t.prototype._linkExpirationChanged=function(){var e=this.currentSharingLink.peek(),t=this.linkExpirationInDays();if(e)if(e.type===this._lastLinkType){if(e.url){if(this._sharingLinkExpirationHelper.computeExpirationValidity(t)!==L.LinkExpirationValidity.Invalid&&this._lastExpiration!==t){this._onLinkExpiresOrPasswordSettingChanged();this._lastExpiration=t}}}else this._lastLinkType=e.type};t.prototype._onLinkExpiresOrPasswordSettingChanged=function(){var e=this,t=this.currentSharingLink.peek(),n=this.linkExpirationInDays.peek(),r=this.passwordHasBeenUpdated.peek(),i=this.passwordDisplayValue.peek();this._engagement.logData({name:"SharingByLinkDialog.UpdateLink",extraData:{linkExpiration:this.linkExpiresChecked.peek()?n:"0",hasPassword:0!==i.length}});this.isCreatingLink(!0);this.isLinkDisabled(!0);var s={type:t.type,role:t.role,create:!0};if(this.isPremium.peek()){(t.expiration||this._lastExpiration!==n)&&(s.expiration=this._sharingLinkExpirationHelper.calculateLinkExpiration(parseInt(n,10)));this.isPasswordInvalid.peek()?s.password="":r&&"        "!==i&&(s.password=i)}this._sharingProvider.manageSharingLinks(this._items,s).then(function(n){for(var r=n.filter(function(n){return e._items[0].id===n.item.id&&n.type===t.type})[0]||n[0],i=!1,s=e._sharingLinksCollection.peek(),o=0,u=s;o<u.length;o++){var a=u[o];if(a.id===r.id&&a.isActive){r.expiration&&(a.expiration=r.expiration);r.hasPassword&&(a.hasPassword=r.hasPassword);i=!0}}i||s.push(r);e._sharingLinksCollection(s);e.currentSharingLink(r);r.hasPassword&&e.passwordDisplayValue("        ");e._itemProvider.invalidateItem(e._items[0].key,{triggerFetch:!0})});this.passwordHasBeenUpdated(!1)};t.prototype._createLink=function(e){var t=this,n=this.allowEditChecked.peek()?6:5,r=this.allowEditChecked.peek()?2:1,i=this.linkExpiresChecked.peek()?this.linkExpirationInDays.peek():"0";if(!e){this.isCreatingLink(!0);this.isLinkDisabled(!0)}var s={type:n,role:r,create:!0,expiration:this._sharingLinkExpirationHelper.calculateLinkExpiration(parseInt(i,10))};if(this.arePasswordProtectedLinksEnabled){this.isPasswordInvalid.peek()&&(s.password="");0!==this.passwordDisplayValue.peek().length&&(s.password=this.passwordDisplayValue.peek())}this._engagement.logData({name:"SharingByLinkDialog.CreateLink",extraData:{linkExpiration:i,hasPassword:0!==this.passwordDisplayValue.peek().length}});return this._sharingProvider.manageSharingLinks(this._items,s).then(function(e){var r=e.filter(function(e){return t._items[0].id===e.item.id&&e.type===n})[0]||e[0],i=t._sharingLinksCollection.peek();i.push(r);t._sharingLinksCollection(i);t.currentSharingLink(r);t._enableLink();r.hasPassword&&t.passwordDisplayValue("        ");t._itemProvider.invalidateItem(t._items[0].key,{triggerFetch:!0});return T.default.wrap(!0)})};t.prototype._enableLink=function(){var e=this;this.async.setTimeout(function(){e.isLinkDisabled(!1)},500)};t.prototype._isLinkExpired=function(e){if(e.expiration){return new Date(e.expiration).getTime()<=Date.now()}return!1};t.prototype._setCurrentSharingLink=function(e){var t=this;if(this._isLinkExpired(e)){var n=e.type,r=e.role,i={link:e,type:n,role:r,create:!1};this._sharingProvider.manageSharingLinks(this._items,i).then(function(e){t._sharingLinksCollection(e)});this.currentSharingLink({url:"",type:n,role:r});return!1}this.currentSharingLink(e);return!0};t.prototype._setDefaultSharingLink=function(){1===this._items.length&&!!(this._items[0].isAlbum||this._items[0].photo||this._items[0].video)?this.currentSharingLink({url:"",type:5,role:1}):this.currentSharingLink({url:"",type:6,role:2})};t.prototype._getBestSharingLink=function(e){var t=this;this.isReady=e.getBestSharingLink().then(function(e){e?t._setCurrentSharingLink(e):t._setDefaultSharingLink()},function(e){t.error(h.strings.ServerError)})};t.prototype._onAllowEditToggled=function(){var e=this,t=this.allowEditChecked(),n=this.currentSharingLink.peek();if(!(!n||t&&6===n.type||!t&&5===n.type)){this.isLinkDisabled(!0);this._sharingLinksCollection().some(function(n){return t&&6===n.type?e._setCurrentSharingLink(n):t||5!==n.type?void 0:e._setCurrentSharingLink(n)})||(t?this.currentSharingLink({url:"",type:6,role:2}):this.currentSharingLink({url:"",type:5,role:1}));this._computeLinkExpirationInDays(!0)}};t.prototype._getNetworkUsageName=function(e){var t=p.UsageName.SharedViaFacebook;e===A.default.Facebook.name?t=p.UsageName.SharedViaFacebook:e===A.default.Twitter.name?t=p.UsageName.SharedViaTwitter:e===A.default.LinkedIn.name?t=p.UsageName.SharedViaLinkedIn:e===A.default.Weibo.name&&(t=p.UsageName.SharedViaSinaWeibo);return t};t.prototype._getSharingInfo=function(){var e=this,t=this._sharingProvider.getSharingData(this._items[0]);this._getSharingSettings(t).then(function(){if(e._isMultiSelect){e._setDefaultSharingLink();e.isManagePermissionsVisible(!1);e.loading(!1)}else{e._getSharingLinks(t);e._getBestSharingLink(t)}})};t.prototype._getSharingLinks=function(e){var t=this;e.getLinks().then(function(e){null!=e&&t._sharingLinksCollection(e.filter(function(e){return e.item.id===t._items[0].id}))},function(e){t.error(h.strings.ServerError);t.loading(!1)})};t.prototype._getSharingSettings=function(e){var t=this;return this.isReady=e.getSettings().then(function(e){t._sharingSettings=e;e.itemId||t.hasError(!0);t._areNetworksSupported(t._sharingSettings.networkLinksEnabled);t.canManageLinks=t._sharingSettings.canManageLinks;t.peopleSharingWith(t._sharingSettings.sharedWith)},function(e){e&&403===e.status?t.error(h.strings.AccessDenied):t.error(h.strings.ServerError);t.hasLoadingError(!0);t.loading(!1)})};t.prototype._onCurrentSharingLinkUpdated=function(){var e=this.currentSharingLink();if(e){this.sharingLinkUrl(e.url);this.allowEditChecked(6===e.type);this.linkExpiresChecked(!!e.expiration);this.setPasswordChecked(!!e.hasPassword);this.hasLoadingError(!1);this.loading(!1);this.isCreatingLink(!1);this._enableLink()}};return t}(M.default);t.default=H});
define("odsp-next/controls/gleamCallout/GleamCallout",["require","exports","tslib","office-ui-fabric-react/lib/Callout","office-ui-fabric-react/lib/FocusZone","react","office-ui-fabric-react/lib/Styling","../banner/Banner.resx","./GleamCallout.css"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._showCallout=function(){n.setState({isCalloutVisible:!0})};n._onCalloutDismiss=function(){n.setState({isCalloutVisible:!1})};n._onGleamRef=function(e){n._gleam=e};n.state={isCalloutVisible:t.forceOpenCallout};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({isCalloutVisible:e.forceOpenCallout})};t.prototype.componentDidUpdate=function(e,t){this.state.isCalloutVisible&&!t.isCalloutVisible?this.props.onOpened():!this.state.isCalloutVisible&&t.isCalloutVisible&&this.props.onDismissed()};t.prototype.render=function(){var e=this.props,t=this.state,n=this.props,a=n.strings,f=n.gleamCalloutHeaderIconUrl;return s.createElement("span",{className:"od-GleamCallout",onClick:this._showCallout},s.createElement("img",{className:"od-GleamCallout-gleam",ref:this._onGleamRef,src:window.require.toUrl("odsp-media/images/premium/premium-gleam-single.svg")}),t.isCalloutVisible&&s.createElement(r.Callout,{className:"od-GleamCallout-callout",directionalHint:r.DirectionalHint.rightCenter,directionalHintForRTL:r.DirectionalHint.bottomCenter,gapSpace:2,onDismiss:this._onCalloutDismiss,target:this._gleam,setInitialFocus:!0},s.createElement(i.FocusZone,{className:"od-GleamCallout-calloutContent",isCircularNavigation:!0},s.createElement("button",{className:"od-GleamCallout-closeButton",onClick:this._onCalloutDismiss,"aria-label":u.strings.CloseLabel,title:u.strings.CloseLabel},s.createElement("i",{className:o.getIconClassName("Cancel")})),s.createElement("img",{className:"od-GleamCallout-headerImage",src:f}),s.createElement("h3",{className:"od-GleamCallout-title"},a.calloutTitle),s.createElement("p",{className:"od-GleamCallout-body"},a.calloutBody),s.createElement("div",null,s.createElement("button",{className:"od-Button od-GleamCallout-button od-GleamCallout-premiumButton",onClick:e.goPremiumAction},a.premiumButtonText),!this.props.isMobile&&s.createElement("button",{className:"od-Button od-Button--primary od-GleamCallout-button od-GleamCallout-learnButton",onClick:e.learnMoreAction},a.learnMoreButtonText)))))};return t}(s.Component);t.GleamCallout=a});
define("odsp-next/controls/gleamCallout/GleamCallout.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-GleamCallout-gleam{height:8px;margin-top:15px;width:8px}[dir=ltr] .od-GleamCallout-gleam{margin-left:6px}[dir=rtl] .od-GleamCallout-gleam{margin-right:6px}.od-GleamCallout-callout{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";width:274px}.od-GleamCallout-callout .ms-Callout-beak{background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-GleamCallout-callout .ms-Callout-main{background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";padding-bottom:20px;padding-top:0}[dir=ltr] .od-GleamCallout-callout .ms-Callout-main{padding-left:20px}[dir=rtl] .od-GleamCallout-callout .ms-Callout-main{padding-right:20px}[dir=ltr] .od-GleamCallout-callout .ms-Callout-main{padding-right:12px}[dir=rtl] .od-GleamCallout-callout .ms-Callout-main{padding-left:12px}.od-GleamCallout-headerImage{height:36px}.od-GleamCallout-title{font-size:17px;font-weight:300;font-weight:600;margin-top:14px;margin-bottom:14px;cursor:pointer}.od-GleamCallout-button.od-Button{border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding:5px 8px;width:106px}.od-GleamCallout-premiumButton.od-Button{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}[dir=ltr] .od-GleamCallout-premiumButton.od-Button{margin-right:20px}[dir=rtl] .od-GleamCallout-premiumButton.od-Button{margin-left:20px}.od-GleamCallout-premiumButton.od-Button:active,.od-GleamCallout-premiumButton.od-Button:hover{background-color:"},{theme:"themeLighter",defaultValue:"#deecf9"},{rawString:";border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-Button.od-Button--primary.od-GleamCallout-button.od-GleamCallout-learnButton{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-GleamCallout-callout .od-Button.od-Button--primary{border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-GleamCallout-callout .od-Button.od-Button--primary:active,.od-GleamCallout-callout .od-Button.od-Button--primary:hover{background-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";border-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-GleamCallout-body{margin-bottom:20px}.od-GleamCallout-closeButton{background:0 0;border:none;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";display:block;height:20px;padding:12px 0 0 0}[dir=ltr] .od-GleamCallout-closeButton{margin-left:auto}[dir=rtl] .od-GleamCallout-closeButton{margin-right:auto}"}])});
define("odsp-next/controls/sharing/sharingByLink/SharingByLink.html",[],function(){return'<div class=od-SharingByLink>\x3c!--ko if: loading()--\x3e<div class=od-SharingByLink-loadingSpinner data-bind="component: {name: loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko if: !hasError()--\x3e\x3c!--ko ifnot: loading()--\x3e<div aria-live=assertive class=od-SharingByLink-error data-bind="if: error"><span data-bind="text: error"></span></div>\x3c!--ko if: note()--\x3e<div aria-live=assertive class=od-SharingByLink-note><span data-bind="text: note"></span></div>\x3c!--/ko--\x3e<div data-bind="ifnot: hasLoadingError">\x3c!--ko if: !isSingleLinkLabelVisible()--\x3e<a href=javascript:; class=od-SharingByLink-linkSwitcher data-bind="attr: {title: linkTitle}, click: switchLinks">\x3c!--ko if: arePasswordProtectedLinksEnabled && setPasswordChecked()--\x3e<i class="ms-Icon ms-Icon--Lock od-SharingByLink-lock" role=img data-bind="icon: true, attr: {\'aria-label\': passwordProtectedLinkIndicatorLabel }"></i>\x3c!--/ko--\x3e<span data-bind="text: sharingHintText, automation: \'sharingHintText\'"></span> <i data-bind="class: arrowIcon" class="ms-Icon od-SharingByLink-linkSwitcher-icon"></i></a>\x3c!--/ko--\x3e\x3c!--ko if: isSingleLinkLabelVisible()--\x3e<span class=od-SharingByLink-linkSwitcher data-bind="text: sharingHintText"></span>\x3c!--/ko--\x3e\x3c!--ko if: isAllowEditVisible()--\x3e<div class="od-CheckBox od-SharingByLink-CheckBoxContainer"><input type=checkbox id=od-SharingByLink-allowEdit data-bind="checked: allowEditChecked" class=od-CheckBox-input> <label for=od-SharingByLink-allowEdit class="od-CheckBox-field od-SharingByLink-CheckBox" data-bind="css: {\'is-checked\': allowEditChecked}"><span data-bind="text: allowEditText, automation: \'allowEditText\'" class=od-Label></span></label></div><div class="od-CheckBox od-SharingByLink-CheckBoxContainer"><input type=checkbox id=od-SharingByLink-linkExpires class="od-CheckBox-input od-SharingByLink-CheckBox" data-bind="checked: linkExpiresChecked, disable: isPremiumEligible"> <label for=od-SharingByLink-linkExpires class="od-CheckBox-field od-SharingByLink-CheckBox" data-bind="css: { \'is-checked\': linkExpiresChecked }, teachingBubble: expiringLinkTeachingBubbleOptions, click: onLinkExpiresClicked"><span data-bind="text: linkExpiresText, automation: \'linkExpiresText\'" class=od-Label></span></label>\x3c!--ko if: isPremiumEligible--\x3e<span data-bind="click: onLinkExpiresClicked, react: { componentType: gleamCalloutComponent, props: expiringLinkGleamCalloutComponentProps }"></span>\x3c!--/ko--\x3e\x3c!--ko if: linkExpiresChecked()--\x3e<div class=od-SharingByLink-linkExpiresInputDiv><input id=od-SharingByLink-linkExpiresInput class=od-SharingByLink-linkExpiresInput type=number data-bind="value: linkExpirationInDays, selectOnFocus: { isPermanent: false, isReentrant: true }"> <label for=od-SharingByLink-linkExpiresInput><span class=od-SharingByLink-linkExpiresInputLabel data-bind="text: linkExpiresInputLabel"></span></label></div>\x3c!--/ko--\x3e</div>\x3c!--ko if: arePasswordProtectedLinksEnabled--\x3e<div class="od-CheckBox od-SharingByLink-setPassword-container od-SharingByLink-CheckBoxContainer"><input type=checkbox id=od-SharingByLink-setPassword class=od-CheckBox-input data-bind="checked: setPasswordChecked, disable: isPremiumEligible"> <label for=od-SharingByLink-setPassword class="od-CheckBox-field od-SharingByLink-CheckBox" data-bind="css: { \'is-checked\': setPasswordChecked }, click: onSetPasswordClicked"><span data-bind="text: setPasswordLabel" class=od-Label></span></label>\x3c!--ko if: isPremiumEligible--\x3e<span data-bind="click: onSetPasswordClicked, react: { componentType: gleamCalloutComponent, props: passwordProtectedLinkGleamCalloutComponentProps }"></span>\x3c!--/ko--\x3e\x3c!--ko if: setPasswordChecked()--\x3e<div class=od-SharingByLink-setPasswordInputContainer><input id=od-SharingByLink-setPasswordInput autocomplete=new-password class=od-SharingByLink-setPasswordInput type=password data-bind="value: passwordDisplayValue, valueUpdate: \'input\', attr: { \'aria-invalid\': isPasswordInvalid() }, event: { blur: onPasswordChanged, click: clearPasswordDisplayValue }, keyboard: { mappings: { \'Enter\': $component.onPasswordDefined.bind($component) } }, css: { \'od-SharingByLink-invalidPasswordOutline\': isPasswordInvalid() }"> <label for=od-SharingByLink-setPasswordInput></label>\x3c!--ko if: isPasswordInvalid()--\x3e<div class=od-SharingByLink-invalidPasswordError role=alert data-bind="text: invalidPasswordText"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e<div class=od-SharingByLink-linkSection><div class=od-SharingByLink-table><div class=od-SharingByLink-row><div class="od-SharingByLink-cell od-SharingByLink-iconCell">\x3c!--ko if: currentSharingLink().url--\x3e<div class=od-SharingByLink-icon><i class="ms-Icon ms-Icon--Link" data-bind="icon: true, attr: { \'aria-label\': getLinkText }"></i></div>\x3c!--/ko--\x3e\x3c!--ko if: !currentSharingLink().url--\x3e<a href=# class=od-SharingByLink-linkText id=od-SharingByLink-linkText data-bind="click: onClickCreateLink, automation: \'getLink\'"><div class=od-SharingByLink-icon><i class="ms-Icon ms-Icon--Link" data-bind="icon: true, attr: { \'aria-label\': getLinkText }"></i></div>\x3c!--ko if: !isCreatingLink()--\x3e<span class=od-SharingbyLink-text data-bind="text: getLinkText"></span>\x3c!--/ko--\x3e\x3c!--ko if: isCreatingLink()--\x3e<div class=od-SharingByLink-creatingLink-loadingSpinner data-bind="component: {name: loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e</a>\x3c!--/ko--\x3e</div>\x3c!--ko if: currentSharingLink().url--\x3e<div class=od-SharingByLink-cell><div class="od-SharingByLink-table od-SharingByLink-url"><div class=od-SharingByLink-row><div class=od-SharingByLink-cell><input class="od-SharingByLink-input od-TextField-field" type=text readonly data-bind="value: sharingLinkUrl, automation: \'sharingLinkUrl\', hasFocus: true, event: { copy: logCopy }, css: { \'is-disabled\': isLinkDisabled }, attr: { \'aria-label\': sharingHintText, \'disabled\': isLinkDisabled }"></div><div class=od-SharingByLink-cell><button class="ms-Dialog-action od-Button od-Button--primary od-SharingByLink-copyButton" data-bind="visible: supportsCopy, click: onClickCopyLink"><i class="od-SharingByLink-copySuccess ms-Icon ms-Icon--CheckMark" data-bind="icon: true, visible: isCopyLoadingVisible"></i> <span class="od-Button-label od-SharingByLink-copyButton-label" data-bind="text: copyText, visible: !isCopyLoadingVisible()"></span></button></div></div></div></div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if: !arePasswordProtectedLinksEnabled || !setPasswordChecked()--\x3e<div class=od-SharingByLink-mailRow><a href=# class=od-SharingByLink-mailText id=od-SharingByLink-mailText data-bind="click: showInvite"><div class=od-SharingByLink-icon><i class="ms-Icon ms-Icon--Mail" data-bind="icon: true"></i></div><span class=od-SharingByLink-text data-bind="text: inviteText"></span></a></div>\x3c!--/ko--\x3e</div><div class=od-SharingByLink-moreSection>\x3c!--ko if: isNetworksSectionVisible()--\x3e<a href=# class=od-SharingByLink-moreLink data-bind="click: onMoreOptionsClicked"><span data-bind="text: moreOptionsText"></span> <span><i data-bind="class: moreSectionIcon" class=ms-Icon></i></span></a>\x3c!--/ko--\x3e\x3c!--ko if: isMoreSectionVisible()--\x3e<div><div class=od-sharingByLinks-networksList data-bind="foreach: { data: networksList, as: \'network\' }"><div class=od-SharingByLink-networksRow><a href=# class=od-SharingByLink-networkText data-bind="click: $parent.onNetworkClicked.bind($parent)"><div class=od-SharingByLink-icon><img data-bind="attr: { src: network.iconUrl, alt: $parent.getNetworkAltText(network) }"></div><div class=od-SharingByLink-social-holder><span class="od-SharingByLink-social-text od-SharingByLink-social-name" data-bind="text: network.text"></span>\x3c!--ko if: $data.isCreatingLink()--\x3e<span class="od-SharingByLink-social-text od-SharingByLink-social-creating" data-bind="text: $parent.generatingLinkForSocialNetworkText"></span>\x3c!--/ko--\x3e</div></a></div></div>\x3c!--ko if: isManagePermissionsVisible() && !isPasswordProtectedLinksBannerVisible()--\x3e<a href=# data-bind="click: showPermissions, text: managePermissionsText"></a>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>\x3c!--ko if: isPasswordProtectedLinksBannerVisible()--\x3e<div class=od-sharingByLinks-passwordProtectedLinkInformationArea><i class="ms-Icon ms-Icon--Info od-SharingByLink-passwordProtectedLinkInformationIcon" data-bind="icon: true"></i><div class=od-SharingByLink-passwordProtectedLinkInformationTextArea><span class=od-SharingByLink-passwordProtectedLinkInformation data-bind="text: setPasswordPermissionsWarning"></span> <a href=# class=od-SharingByLink-ManageAccessLink data-bind="text: manageAccessLink, click: launchPermissionsPanel"></a></div></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: hasError()--\x3e<div class=od-SharingByLink-error data-bind="text: missingItemError" aria-live=assertive></div>\x3c!--/ko--\x3e</div>\x3c!--ko if: displayFeatureCards--\x3e<div data-bind="component: { name: featureCardsTagName, params: { cards: featureCardData, currentIndex: featureCardIndex, close: $component.closeFeatureCards.bind($component), includeOverlay: true } }"></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/sharing/sharingByLink/SharingByLink.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-SharingByLink-loadingSpinner{text-align:center;padding:75px 0}.od-SharingByLink-creatingLink-loadingSpinner{display:inline-block;padding:5px 0}.od-SharingByLink-note{margin-bottom:10px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SharingByLink-iconCell{width:50px;vertical-align:top}.od-SharingByLink-icon{display:inline-block;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:20px;border-radius:50%;width:40px;height:40px}[dir=ltr] .od-SharingByLink-icon{margin-right:20px}[dir=rtl] .od-SharingByLink-icon{margin-left:20px}.od-SharingByLink-icon .ms-Icon--Link{position:relative;top:8px}[dir=ltr] .od-SharingByLink-icon .ms-Icon--Link{left:10px}[dir=rtl] .od-SharingByLink-icon .ms-Icon--Link{right:10px}.od-SharingByLink-icon .ms-Icon--Mail{position:relative;top:8px}[dir=ltr] .od-SharingByLink-icon .ms-Icon--Mail{left:10px}[dir=rtl] .od-SharingByLink-icon .ms-Icon--Mail{right:10px}.od-SharingByLink-networksRow .od-SharingByLink-icon{background:0 0}.od-SharingByLink-mailRow{white-space:nowrap;margin-top:8px}.od-SharingByLink-mailRow .od-SharingByLink-icon,.od-SharingByLink-networksRow .od-SharingByLink-icon{vertical-align:middle}.od-SharingByLink-linkSwitcher{display:inline-block;margin-bottom:4px}.od-SharingByLink-linkSwitcher .ms-Icon--ChevronDown,.od-SharingByLink-linkSwitcher .ms-Icon--ChevronUp{position:relative}.od-SharingByLink-linkSwitcher-icon{display:inlin-block;vertical-align:middle;line-height:18px}a.od-SharingByLink-linkSwitcher{cursor:pointer}.od-SharingByLink-url .od-SharingByLink-cell{width:100%}.od-SharingByLink-input{width:100%;text-overflow:ellipsis;margin-bottom:3px;margin-top:5px}.od-SharingByLink-input.is-disabled{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}button.od-SharingByLink-copyButton{padding:0 10px;margin-top:4px}[dir=ltr] button.od-SharingByLink-copyButton{margin-left:15px}[dir=rtl] button.od-SharingByLink-copyButton{margin-right:15px}.od-SharingByLink-copyButton>.od-SharingByLink-copyButton-label{position:relative;top:-1px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"!important}.sm .od-SharingByLink-copyButton>.od-SharingByLink-copyButton-label{top:-4px}.od-SharingByLink-copySuccess{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-SharingByLink-linkText,.od-SharingByLink-mailText,.od-SharingByLink-networkText{font-size:17px;font-weight:300}.od-SharingbyLink-text{vertical-align:middle}.od-SharingByLink-table{display:table;width:100%}.od-SharingByLink-row{display:table-row}.od-SharingByLink-cell{display:table-cell}.od-SharingByLink-networksRow{margin-top:8px}.od-SharingByLink-linkSection{margin-top:14px}.od-SharingByLink-moreLink{display:inline-block}.od-SharingByLink-moreLink .ms-Icon--ChevronDown,.od-SharingByLink-moreLink .ms-Icon--ChevronUp{position:relative;top:2px}.od-SharingByLink-moreSection,.od-SharingByLinks-networksList{margin-top:12px}.od-sharingByLinks-networksList{margin-bottom:8px}.od-SharingByLink-social-holder{display:inline-block;vertical-align:middle}.od-SharingByLink-social-text{display:block}.od-SharingByLink-social-creating{font-size:12px;font-weight:400}.od-SharingByLink-linkExpiresInputDiv{display:inline-block;margin-top:6px}[dir=ltr] .od-SharingByLink-linkExpiresInputDiv{margin-left:8px}[dir=rtl] .od-SharingByLink-linkExpiresInputDiv{margin-right:8px}.od-SharingByLink-linkExpiresInput{font-size:14px;font-weight:400;width:40px;height:24px;text-indent:2px}.od-SharingByLink-setPasswordInputContainer{display:inline-block;margin-top:6px}[dir=ltr] .od-SharingByLink-setPasswordInputContainer{margin-left:8px}[dir=rtl] .od-SharingByLink-setPasswordInputContainer{margin-right:8px}.od-SharingByLink-setPasswordInput{display:block;height:24px;text-indent:8px;width:198px}.od-SharingByLink-invalidPasswordError{display:block;color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:";font-size:12px;padding-top:3px}.od-SharingByLink-invalidPasswordOutline{outline:1px solid "},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.od-SharingByLink-CheckBoxContainer{margin:2px 0}.od-CheckBox-field.od-SharingByLink-CheckBox:before{border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.od-CheckBox-field.od-SharingByLink-CheckBox:after{padding-top:1px}.od-sharingByLinks-passwordProtectedLinkInformationArea{margin-top:8px;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";display:-ms-flexbox;display:flex}.od-SharingByLink-passwordProtectedLinkInformationTextArea{padding:10px}.od-SharingByLink-passwordProtectedLinkInformationIcon{font-size:17px;padding-top:14px}html[dir=ltr] .od-SharingByLink-passwordProtectedLinkInformationIcon{padding-left:10px}html[dir=rtl] .od-SharingByLink-passwordProtectedLinkInformationIcon{padding-right:10px}html[dir=ltr] .od-SharingByLink-lock{margin-right:4px}html[dir=rtl] .od-SharingByLink-lock{margin-left:4px}html[dir=ltr] .od-SharingByLink-manageAccessLink{padding-left:2px}html[dir=rtl] .od-SharingByLink-manageAccessLink{padding-right:2px}"}])});
define("odsp-next/controls/sharing/sharedWith/SharedWith",["require","exports","./SharedWithViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SharedWith.css","./SharedWith.html","../../persona/Persona"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-sharedWith",template:e("./SharedWith.html"),viewModel:n.default});t.default=i});
define("odsp-next/controls/sharing/sharedWith/SharedWithViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/async/Promise","../../../resources/ControlResourceKeys","../../../resources/DataSourceResourceKeys","../../../providers/dialog/DialogProvider","../../../providers/engagement/Engagement","../../loadingSpinner/LoadingSpinner","../../../providers/sharing/SharingProvider","../../../providers/suiteNav/SuiteNavProvider","./SharedWith.resx","@ms/odsp-utilities/lib/encoding/UriEncoding","../../confirmation/Confirmation","../sharingByLink/SharingByLinkStringHelper","../../../bindings/focus/SelectOnFocusBinding","@ms/odsp-utilities/lib/string/StringHelper","../../../utilities/sharing/SharingHelper","../../../utilities/icons/Icon","../../iframeLoader/IframeLoader","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../bindings/keyboard/KeyboardBinding","../../personaTile/PersonaTile","../../personaTile/PersonaTileHelper","../../../bindings/selection/SelectionBinding","./SharedWithKeyboardNav"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var L=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.loadingSpinnerTagName=l.default.tagName;n.personaTileTagName=T.default.tagName;n._sharingProvider=n.resources.consume(c.resourceKey);n._engagement=n.resources.consume(f.resourceKey);n._navigation=n.resources.consume(S.navigation);n._personaTileHelper=new N.default;n.keyNav=new k.default;n.personaTileCollection=n.observables.createArray([]);n.addBindingHandlers({keyboard:x.default,selection:C.default,selectOnFocus:g.default});n.removePerson=function(e){n.people.remove(e)};n._item=t.item;n._items=t.items;t.personaSize?n.cardSize=t.personaSize:n.cardSize=r.observable(4);n.height=t.height?t.height:"none";n.showEmailLink=r.observable(!1);n.hasSettings=r.observable(!1);n.hasData=r.observable(!1);n.showRequests=r.observable(!1);n.loading=r.observable(!0);n.isMultiSelect=r.observable(!1);n.error=r.observable("");n.advancedUrl=r.observable("");n.disableLinkText=p.strings.DisableLinkText;n.emailText=p.strings.EmailEveryone;n.advancedText=p.strings.Advanced;n.requestsPending=p.strings.RequestPending;n.stopSharingText=p.strings.StopSharing;n.viewRequests=p.strings.ViewRequests;n.multiSelectErrorText=p.strings.MultiSelectError;n.userListTrimmedText=p.strings.SharedWithManyText;n.showUserListTrimmedText=n.createObservable(!1);n._selectionModel=n.resources.consume(o.itemsSelection);n._urlDataSource=n.resources.consume(u.url);n.people=r.observableArray([]);n.links=r.observableArray([]);n.canManageLinks=r.observable(!1);n.canManagePermissions=r.observable(!1);n.showAdvanced=n.createComputed(function(){return!!n.advancedUrl()});n.canUnshare=r.observable(!1);n.requestsLink=r.observable("");n.mailto=n.createComputed(function(){if(!n.hasSettings())return"";for(var e=n.people(),t="mailto:",r=new Array,i=0;i<e.length;i++)e[i].email&&r.push(e[i].email);n.showEmailLink(r.length>0&&r.length<29);t+=d.default.encodeURIComponent(r.join(";"));t+="?subject="+d.default.encodeURIComponent(n._settings.itemName);return t+="&body="+encodeURI(encodeURI(n._settings.itemUrl))});n.hasError=n.createComputed(function(){return!!n.error()});if(n._selectionModel&&n._selectionModel.selection&&n._selectionModel.selection().length>1||n._items&&n._items.length>1){n.isMultiSelect(!0);n.loading(!1)}else{t.includeLinks&&n._getLinks();n._getSharedWith()}return n}t.prototype.logCopy=function(e,t){this._engagement.logData({name:e.tag+"Link.SharedWith.Copy",isIntentional:!0});return!0};t.prototype.calculateScope=function(e){var t="";e.item&&this._getCurrentItem()!==e.item&&(t=y.format(p.strings.SharingFrom,e.item.name));return t};t.prototype.scopeClick=function(e){this._navigation.navigateTo(this._urlDataSource.getItemUrl(e.item.key));return!0};t.prototype.calculateHint=function(e){return m.getLinkHintText(e,this._companyDisplayName)};t.prototype.clickEmail=function(){this._engagement.logData({name:"EmailEveryone.SharingDialog.Click",isIntentional:!0});this._navigation.navigateTo(this.mailto.peek())};t.prototype.clickAdvanced=function(){this._engagement.logData({name:"AdvancedSettings.SharingDialog.Click",isIntentional:!0});if(this._settings.advancedUrlOpenInPlace){this._showAdvancedDialog();return!1}return!0};t.prototype.clickAccessRequests=function(){this._engagement.logData({name:"PendingAccessRequests.SharingDialog.Click",isIntentional:!0});return!0};t.prototype.stopSharing=function(){this._engagement.logData({name:"StopSharing.SharingDialog.Click",isIntentional:!0});this._stopSharingConfirm()};t.prototype.removeSharingLink=function(e){var t=this,n=this.resources.consume(a.resourceKey);b.disableLinkConfirm(function(){t._engagement.logData({name:"Disable"+e.tag+"Link.SharedWith.Click",isIntentional:!0});var n={type:e.type,role:e.role,create:!1};return t._sharingProvider.manageSharingLinks([t._getCurrentItem()],n).then(function(e){t._updateSharingLinks(e);return s.default.wrap(!0)},function(e){return!1})},function(e){t.isReady=e},n,"SharedWith")};t.prototype._stopSharing=function(){var e=this._sharingProvider.unshare(this._getCurrentItem());this.loading(!0);return e};t.prototype._getLinks=function(){var e=this,t=this.resources.consume(h.resourceKey.optional);t&&t.loadData().then(function(t){e._companyDisplayName=t.CompanyDisplayName;e.links.peek().length>0&&e._updateSharingLinks(e.links())});this._sharingProvider.getSharingData(this._getCurrentItem()).getLinks().then(function(t){t&&e._updateSharingLinks(t)},function(t){e.error(p.strings.LinksError)})};t.prototype._updateSharingLinks=function(e){this.links(e.filter(function(e){return e.isActive&&8!==e.type}))};t.prototype._getSharedWith=function(){var e=this,t=this._sharingProvider.getSharingData(this._getCurrentItem());this.isReady=t.getPermissions(!0).then(function(t){var n=t[0];if(n){if(n.hasPendingAccessRequests){e.showRequests(!0);e._engagement.logData({name:"PendingAccessRequests.SharingDialog.Render"})}e.requestsLink(n.pendingAccessRequestsLink);e.canUnshare(n.canUnshare);e._parseSharedWith(n?n.people:null)}else e.loading(!1)},function(t){t&&403===t.status?e.error(p.strings.AccessDenied):e.error(p.strings.ServerError);e.loading(!1)});t.getSettings().done(function(t){e._settings=t;e.canManageLinks(t.canManageLinks);e.canManagePermissions(t.canManagePermissions);e.advancedUrl(t.advancedUrlOpenInPlace?"javascript:;":t.advancedUrl);e.hasSettings(!0)},function(e){})};t.prototype._parseSharedWith=function(e){if(e){this.people(e);this._convertPeopleToPersonaTiles();this.showUserListTrimmedText(this.people().length>=30)}this.loading(!1)};t.prototype._convertPeopleToPersonaTiles=function(){for(var e=this.people.peek(),t=new Array,n=0;n<e.length;n++){var r=e[n],i={inputEvent:this.observables.create(),openContextMenu:this.observables.create(!1),person:this.observables.create(r),personaSize:this.cardSize,removePerson:this.removePerson,showPresence:!0},s=this._personaTileHelper.convertPersonaToPersonaTile(i,r.userId);t.push(s)}this.personaTileCollection(t);this.keyNav.focusableTiles(t)};t.prototype._getCurrentItem=function(){return this._item?this._item:r.utils.unwrapObservable(this._selectionModel.selection()[0])};t.prototype._stopSharingConfirm=function(){var e=this,t=this.resources.consume(a.resourceKey),n=this._engagement,i=r.observable(!0);t.requestDialog({title:p.strings.StopSharingConfirmationTitle,size:"Medium",component:{name:v.default.tagName,params:{message:p.strings.StopSharingConfirmationMessage}},actions:[{name:p.strings.StopSharingConfirmationButton,execute:function(){n.logData({name:"Unshare.SharedWithDialog.Click",isIntentional:!0});i(!1);return e._stopSharing().then(function(e){return 2},function(e){return 3})},isDefault:!0,isAvailable:i,icon:new w.default("Save"),automationId:"UnshareConfirm"},{name:p.strings.StopSharingCancelButton,execute:function(){n.logData({name:"CancelStopSharing.SharedWithDialog.Click",isIntentional:!0});return s.default.wrap(3)},isDefault:!1,icon:new w.default("Cancel"),automationId:"UnshareCancel"}],executeDefaultAction:!1})};t.prototype._showAdvancedDialog=function(){var e=this,t=this.resources.consume(a.resourceKey),n=t.currentDialog();n&&n.dismiss();n=t.requestDialog({title:y.format(p.strings.AdvancedDialogTitle,this._getCurrentItem().name),size:"Large",component:{name:E.default.tagName,params:{url:this._settings.advancedUrl,onload:function(e){var t=e.target;if(t){t.commitPopup=function(){n.dismiss()};t.style.height=Math.max(300,.25*window.innerHeight)+"px"}}}},actions:[{name:p.strings.ShowAdvancedDialogCloseButton,execute:function(){e._engagement.logData({name:"AdvancedSharingClose.SharedWithDialog.Click",isIntentional:!0});return s.default.wrap(3)},isDefault:!0,isAvailable:r.observable(!0),icon:new w.default("Cancel"),automationId:"AdvancedSharingClose"}],executeDefaultAction:!1})};return t}(i.default);t.default=L});
define("odsp-next/controls/iframeLoader/IframeLoader",["require","exports","./IframeLoaderViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./IframeLoader.html","./IframeLoader.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-iframe-loader",template:e("./IframeLoader.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/iframeLoader/IframeLoaderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","knockout","../progressSpinnerFlat/ProgressSpinnerFlat","./IframeLoader.resx","../../bindings/element/ElementBinding","../../utilities/iframe/IframeHelper"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){var n=e.call(this)||this;n.loadingLabel=o.strings.IframeLoadingLabel;n._isIframeAvailable=!0;var r=t.url,f=t.title||"";n.url="string"==typeof r?i.observable(r):r;n.title="string"==typeof f?i.observable(f):f;n.isExcludeFromScreenReader=t.isExcludeFromScreenReader||!1;n.isLoading=t.isLoading?t.isLoading:i.observable(!0);n.loadingLabelHasMargins=t.loadingLabelHasMargins;n.progressSpinnerFlatTagName=s.default.tagName;n.showLoadingLabel=t.showLoadingLabel;n.iframeElement=t.iframeElement||i.observable(null);n.tabindex=n.isExcludeFromScreenReader?"-1":null;n.role=n.isExcludeFromScreenReader?"presentation":null;n.isVisible=n.createComputed(n._computeIsVisible);n.isTitleVisible=n.createComputed(n._computeIsTitleVisible);n.addBindingHandlers({element:u.default});n.iframeOnLoad=function(e,r){n._isIframeAvailable&&t.onload&&t.onload(r);n.isLoading(!1)};n.addDisposable({dispose:function(){a.disposeIframe(n.iframeElement(),function(){n._isIframeAvailable=!1})}});return n}t.prototype._computeIsVisible=function(){return!!this.url()};t.prototype._computeIsTitleVisible=function(){return!!this.title()};return t}(r.default);t.default=f});
define("odsp-next/utilities/iframe/IframeHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.disposeIframe=function(e,t){if(e){e.src="";t&&t()}};t.isCrossOrigin=function(){try{return!window.top.location.hostname}catch(e){return!0}}});
define("odsp-next/controls/iframeLoader/IframeLoader.html",[],function(){return"<div class=ms-IframeLoader data-bind=\"css:{ 'ms-IframeLoader--visible': isVisible }\"><div class=ms-IframeLoader-title data-bind=\"css:{ 'ms-IframeLoader-title--visible': isTitleVisible }, text: title()\"></div><iframe class=ms-IframeLoader-iframeElmt data-bind=\"attr: { src: url(), role: role, tabindex: tabindex }, event: { load: iframeOnLoad }, css: { 'ms-IframeLoader-iframeElmt--visible': !isLoading() }, element: iframeElement\"></iframe>\x3c!--ko if: showLoadingLabel--\x3e<span class=ms-IframeLoader-loadingLabel data-bind=\"text: loadingLabel, css: { 'ms-IframeLoader-loadingLabel--visible': isLoading, 'ms-IFrameLoader-LoadingWithMargin': loadingLabelHasMargins }\"></span>\x3c!--/ko--\x3e<div class=ms-IframeLoader-progressContainer data-bind=\"css: { 'ms-IframeLoader-progressContainer--visible': isLoading }\"><div class=ms-IframeLoader-progress data-bind=\"component: { name: progressSpinnerFlatTagName }\"></div></div></div>"});
define("odsp-next/controls/iframeLoader/IframeLoader.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-IframeLoader{display:none;width:100%;height:100%}.ms-IframeLoader-loadingLabel{padding-bottom:15px;margin:0 0 20px 0;font-weight:300;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";display:none}.ms-IframeLoader-loadingLabel.od-Dialog-subText--s{font-size:12px}.ms-IframeLoader-loadingLabel.od-Dialog-subText--m{font-size:14px}.ms-IframeLoader-loadingLabel.od-Dialog-subText--l{font-size:17px}.ms-IFrameLoader-LoadingWithMargin.ms-IframeLoader-loadingLabel{margin:15px 15px 15px 30px}.ms-IframeLoader-title{font-size:17px;display:none}.ms-IframeLoader-iframeElmt{width:100%;height:100%;border:none;display:none}.ms-IframeLoader-progressContainer{display:none}.ms-IframeLoader--visible,.ms-IframeLoader-iframeElmt--visible,.ms-IframeLoader-loadingLabel--visible,.ms-IframeLoader-progressContainer--visible,.ms-IframeLoader-title--visible{display:block}"}])});
define("odsp-next/controls/personaTile/PersonaTileHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(){return e.call(this)||this}t.prototype.convertPersonaToPersonaTile=function(e,t){return{personaParams:e,key:t,focused:this.observables.create(!1)}};return t}(r.default);t.default=i});
define("odsp-next/controls/sharing/sharedWith/SharedWithKeyboardNav",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t.keyboardOptions=[{target:null,mappings:{Right:t.onKeyRight}},{target:window,mappings:{}}];t.focusedTile=t.observables.create();t.focusableTiles=t.observables.createArray();return t}t.prototype.onKeyRight=function(e,t){var n=e.keyNav.focusedTile();n.personaParams.inputEvent(t);n.personaParams.openContextMenu(!0);t.stopPropagation();return!0};return t}(r.default);t.default=i});
define("odsp-next/controls/sharing/sharedWith/SharedWith.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-SharedWith-Container{width:100%}.od-SharedWith-loadingSpinner{text-align:center;padding:75px 0}.od-SharedWith-wrapper{margin:2px;width:100%;overflow-x:hidden;overflow-y:auto;min-height:175px}.od-SharedWith-accessRequests{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";padding:8px 0}.od-SharedWith-accessRequestsIcon{padding:0 8px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:12pt;vertical-align:middle}[dir=ltr] .od-SharedWith-accessRequestsLink{padding-left:5px}[dir=rtl] .od-SharedWith-accessRequestsLink{padding-right:5px}.od-SharedWith-person{margin:0 0 10px;width:100%}.od-SharedWith-person .od-Persona .od-Persona-details{max-width:75%;padding-left:0}.od-SharedWith-error{color:#a80000}.od-SharedWith-linksBox{margin:10px 0 1px}button.od-SharedWith-link{border:none;background:0 0}.od-SharedWith-link{text-decoration:none;cursor:pointer;padding:2px;text-transform:uppercase;font-size:12px;font-weight:400;color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:"}[dir=ltr] .od-SharedWith-link{margin-right:10px}[dir=rtl] .od-SharedWith-link{margin-left:10px}.od-SharedWith-link:focus,.od-SharedWith-link:hover{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-SharedWith-iconCell{width:50px;vertical-align:top}.od-SharedWith-icon{display:inline-block;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:25px;border-radius:50%;width:50px;height:50px}[dir=ltr] .od-SharedWith-icon{margin-right:10px}[dir=rtl] .od-SharedWith-icon{margin-left:10px}.od-SharedWith-icon .ms-Icon--Link{position:relative;top:8px}[dir=ltr] .od-SharedWith-icon .ms-Icon--Link{left:9px}[dir=rtl] .od-SharedWith-icon .ms-Icon--Link{right:9px}.od-SharedWith-mailRow{white-space:nowrap}.od-SharedWith-mailRow .od-SharedWith-icon{vertical-align:middle}.od-SharedWith-linkSwitcher{display:inline-block;margin-bottom:10px}a.od-SharedWith-linkScope,a.od-SharedWith-linkSwitcher{cursor:pointer}.od-SharedWith-url .od-SharedWith-cell{width:100%}.od-SharedWith-input{padding:3px;width:100%;text-overflow:ellipsis;margin-bottom:3px;margin-top:5px}button.od-SharedWith-copyButton{padding:0 10px;height:1.9em}.od-SharedWith-copyButton-label{position:relative;top:-1px}.od-SharedWith-mailText{font-size:17px;font-weight:300}.od-SharedWith-trimmedText{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .od-SharedWith-trimmedText{margin-right:5px}[dir=rtl] .od-SharedWith-trimmedText{margin-left:5px}.od-SharedWith-table{display:table;width:100%}.od-SharedWith-row{display:table-row}.od-SharedWith-cell{display:table-cell}.od-SharedWith-removeLinkButton{margin:0;padding:5px;border:0;background:0 0;cursor:pointer}[dir=ltr] .od-SharedWith-removeLinkButton{margin-left:10px}[dir=rtl] .od-SharedWith-removeLinkButton{margin-right:10px}.od-SharedWith--hidden{display:none}"}])});
define("odsp-next/controls/sharing/sharedWith/SharedWith.html",[],function(){return'<div class=od-SharedWith-Container>\x3c!--ko if:loading--\x3e<div class=od-SharedWith-loadingSpinner data-bind="component: {name: loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:loading--\x3e<div data-bind="if: showRequests"><div aria-live=polite class=od-SharedWith-accessRequests role=alert><i class="ms-Icon ms-Icon--Info od-SharedWith-accessRequestsIcon" data-bind="icon: true"></i> <span data-bind="text: requestsPending"></span> <a class=od-SharedWith-accessRequestsLink target=_blank data-bind="attr: {href: requestsLink }, text: viewRequests, click: $component.clickAccessRequests.bind($component)"></a></div></div><div aria-live=assertive class=od-SharedWith-error data-bind="if: hasError"><span data-bind="text: error"></span></div><div aria-live=polite data-bind="if: isMultiSelect"><span data-bind="text: multiSelectErrorText"></span></div><div class=od-SharedWith-wrapper aria-live=polite aria-relevant=text data-bind="style: { maxHeight: height }, keyboard: keyNav.keyboardOptions, selection: { data: keyNav.focusableTiles, mode: \'single\', direction: \'vertical\', focused: keyNav.focusedTile }"><div data-bind="foreach: links"><div class=od-SharedWith-table><div class=od-SharedWith-row><div class="od-SharedWith-cell od-SharedWith-iconCell"><div class=od-SharedWith-icon><i class="ms-Icon ms-Icon--Link" data-bind="icon: true"></i></div></div><div class=od-SharedWith-cell>\x3c!--ko if: $parent.canManageLinks--\x3e<a class=od-SharedWith-linkScope data-bind="text: $parent.calculateScope($data), click: $parent.scopeClick.bind($parent, $data)"></a>\x3c!--/ko--\x3e\x3c!--ko ifnot: $parent.canManageLinks--\x3e<span class=od-SharedWith-linkScope data-bind="text: $parent.calculateScope($data)"></span>\x3c!--/ko--\x3e<div class="od-SharedWith-table od-SharedWith-url"><div class=od-SharedWith-row><div class=od-SharedWith-cell><input class=od-SharedWith-input readonly data-bind="value: url, selectOnFocus: { isPermanent: true }, event: { copy: $component.logCopy.bind($component) }, attr: { \'aria-label\': $parent.calculateHint($data)}"></div>\x3c!--ko if: $parent.canManageLinks--\x3e<div class=od-SharedWith-cell><button class=od-SharedWith-removeLinkButton data-bind="click: $parent.removeSharingLink.bind($parent, $data), attr: { \'title\': $parent.disableLinkText, \'aria-label\': $parent.disableLinkText }"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon: true"></i></button></div>\x3c!--/ko--\x3e</div></div><span class=od-SharedWith-linkSwitcher data-bind="text: $parent.calculateHint($data)"></span></div></div></div></div><div class=od-SharedWith-PersonaTiles role=tree data-bind="foreach: { data: personaTileCollection, as: \'personaTile\' }"><div class=od-SharedWith-person data-bind="component: { name: $parent.personaTileTagName, params: { tile: personaTile } }"></div></div>\x3c!--ko if: showUserListTrimmedText()--\x3e<div class=od-SharedWith-trimmedText data-bind="text: userListTrimmedText"></div>\x3c!--/ko--\x3e</div><div class=od-SharedWith-linksBox data-bind="if: hasSettings()"><button class=od-SharedWith-link data-bind="click: stopSharing, text: stopSharingText, visible: canUnshare"></button> <button class=od-SharedWith-link data-bind="text: emailText, visible: showEmailLink(), click: $component.clickEmail.bind($component)"></button>\x3c!--ko if: canManagePermissions--\x3e<a class=od-SharedWith-link target=_blank data-bind="attr: {href: advancedUrl}, text: advancedText, visible: showAdvanced, click: clickAdvanced"></a>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/sharing/shareByEmail/ShareByEmail",["require","exports","./ShareByEmailViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ShareByEmail.html","./ShareByEmail.css","../../peoplePicker/PeoplePicker"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-share-by-email",template:e("./ShareByEmail.html"),viewModel:n.default});t.default=i});
define("odsp-next/controls/sharing/shareByEmail/ShareByEmailViewModel",["require","exports","tslib","../../../providers/engagement/Engagement","../../../resources/DataSourceResourceKeys","../../../utilities/features/Features","../../../providers/sharing/SharingProvider","../../../models/item/ItemType","knockout","../../loadingSpinner/LoadingSpinner","../../../providers/panel/PanelProvider","../../peoplePicker/PeoplePicker","./Sharing.resx","../sharingTips/SharingTips","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/base/ViewModel","../../../providers/item/ItemProvider","@ms/odsp-utilities/lib/dateTime/DateTime","../emailLink/EmailLink.resx","../../../utilities/policyTip/PolicyTipHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.loadingSpinnerTagName=f.default.tagName;n.peoplePickerTagName=c.default.tagName;n.sharingTipsTagName=p.default.tagName;n._params=t;n._items=t.items;n._itemProvider=n.resources.consume(m.resourceKey);n._engagement=n.resources.consume(r.resourceKey);n._expiration=n.wrapObservable(t.expiration);var o=n._expiration&&n._expiration.peek();n.expirationLabel=o?g.getShortDisplayDate(new Date(n._expiration.peek())):null;n.isPasswordProtectedLink=n._params.currentLink&&n._params.currentLink.peek()&&n._params.currentLink.peek().hasPassword;var d=n._items[0].key;n.item=n._itemProvider.getItemSync({parentKey:d}).item;n._referenceRevision=n.createPureComputed(function(){return n.item().revision});n._isDoneGettingSharingSettings=n.createObservable(!1);n.canUserShareExternally=n._params.canUserShareExternally||n.observables.create(!1);n.policyTipInfo=n.createObservable(null);n._policyTipDataSource=n.resources.isExposed(i.policyTip)?n.resources.consume(i.policyTip):null;n.showShareButton=!!t.onExecuteAction;n.permissionLabel=h.strings.PermissionLabel;n.passwordProtectedLabel=h.strings.PasswordProtectedLabel;n.arePasswordProtectedLinksEnabled=s.isFeatureEnabled(s.EnablePasswordProtectedLinks);n.inputPlaceholder=h.strings.EmailPlaceholder;n.sendEmailLabel=h.strings.EmailInvitation;n.requireSignInLabel=h.strings.RequireSignInLabel;n.propagateSharingLabel=h.strings.PropagateSharingLabel;n.requireSignInTooltip=h.strings.RequireSignInTooltip;n.shareButtonText=h.strings.ShareText;n.charLimitVisible=a.observable(!1);n.charLimitReached=n._params.emailMessageExceedsLimit;n.charCountText=a.observable("");n._emailCharLimit=-1;n.canSendEmail=a.observable(!1);n.canSendLink=a.observable(!1);n.supportsSharingPropagation=a.observable(!1);n.sharingRoleOptions=a.observableArray([]);n.hideOptions=!!t.hideOptions;n.showSendEmailOption=t.showSendEmailOption;n.propagateSharing=t.propagateSharing;n.currentSharingLink=t.currentLink;n.hasSharingLink=!!n.currentSharingLink&&null!==n.currentSharingLink();if(n.hasSharingLink){n.requireSignIn=n.createComputed(function(){var e=n.currentSharingLink();return 6!==e.type&&5!==e.type});n.roleSelection=n.createComputed(function(){return n.currentSharingLink().role.toString()});n.linkType=n.createComputed(function(){return n.currentSharingLink().type});n.sendEmail=a.observable(!0)}else{n.requireSignIn=t.requireSignIn;n.roleSelection=t.roleValue;n.linkType=t.linkType?n.createObservable(t.linkType):n.createObservable(8);n.sendEmail=t.sendEmail}n.emailInputText=t.emailMessage||a.observable("");n.error=t.errorMessage||a.observable("");n._canCurrentUserShareExternally=n.createObservable(!1);n.loading=a.observable(!0);n.hasLoadingError=a.observable(!1);n.sharedWithSize=a.observable(2);n.shareAvailable=n.createComputed(n._computeShareAvailable);n.createComputed(n._computeValidateMessageLength);n.peopleSharingWith=a.observableArray([]);n.resources.bind(l.resourceKey);n._sharingSettings2=n.observables.create(null);n.ppQueryParams=n.createPureComputed(n._computePeoplePickerQueryParams);n.policyTipType=n.createPureComputed(n._computePolicyTipType);n.blockViaPolicy=n.createPureComputed(n._computeBlockViaPolicy);n._policyTipDataSource&&(n.policyTipType?n._policyTipDataSource.getPolicyTip(n.item.peek()).done(function(e){e&&e.issueDescriptions&&e.issueDescriptions.length&&n.policyTipInfo(e)}):n.policyTipInfo(null));n.sharingTipsParams=n.createComputed(n._computeSharingTipsParams);n.missingItemError=n._items[0].type===u.default.Folder?h.strings.MissingFolderError:h.strings.MissingFileError;n.sharingError=n.createObservable("");n.getSharingSettings(!!n.item.peek().policyTip);n.createBackgroundComputed(n._refreshSharingSettings);return n}t.prototype.requireSignInChanged=function(){this.requireSignIn()&&this.sendEmail(!0)};t.prototype.shareClicked=function(){var e;e=this._items.length>1?this._items:[this.item.peek()];var t=this.resources.consume(o.resourceKey),n={items:e,roleValue:this.roleSelection.peek(),message:this._params.emailMessage.peek(),sendEmail:this.sendEmail.peek(),requireSignIn:this.requireSignIn.peek(),propagateSharing:this._params.propagateSharing.peek(),expiration:this._expiration.peek()};this._engagement.logData({name:"Share.SharingDialog.Click",isIntentional:!0});t.share(this._params.selectedPeople.peek(),n);this._params.onExecuteAction&&this._params.onExecuteAction()};t.prototype._computePolicyTipType=function(){var e=this.item();if(e)return e.policyTip};t.prototype._computeBlockViaPolicy=function(){if(!s.isFeatureEnabled(s.PolicyTipPanel))return!1;var e=this.policyTipType();return e?b.isPolicyTipFlagSet(e,4):void 0};t.prototype._computeSharingTipsParams=function(){if(this._isDoneGettingSharingSettings()){return{selectedPeople:this.peoplePickerParams.selectedPeople,showAdditionalSharingWarning:this.showExternalUserWarning,policyTipType:this.policyTipType(),policyTipInfo:this.policyTipInfo,item:this.item()}}};t.prototype._computeShareAvailable=function(){if(!this._isDoneGettingSharingSettings())return!1;if(this.peoplePickerParams.hasUnresolvedText&&this.peoplePickerParams.hasUnresolvedText())return!1;if(this.blockViaPolicy()&&this.peoplePickerParams&&this.peoplePickerParams.selectedPeopleContainsExternal&&this.peoplePickerParams.selectedPeopleContainsExternal())return!1;for(var e=0,t=this.peoplePickerParams.selectedPeople();e<t.length;e++){if(!t[e].isResolved)return!1}this._emailCharLimit=this._mailSettings&&this._mailSettings.defaultCharacterLimit;this._evaluateMessageLength(this.emailInputText.peek());return!this.charLimitReached()&&this.peoplePickerParams.selectedPeople().length>0};t.prototype._computeValidateMessageLength=function(){var e=this.emailInputText();this._evaluateMessageLength(e)};t.prototype._computePeoplePickerQueryParams=function(){var e=this._sharingSettings2();if(e){var t={maximumEntitySuggestions:30,blockViaPolicy:this.blockViaPolicy()};if(e.pickerProperties){var n=e.pickerProperties;t.principalSource=n.PrincipalSource;t.principalType=n.PrincipalAccountType;t.querySettings=n.QuerySettings;t.allowEmailAddresses=n.AllowEmailAddresses;t.filterExternalUsers=!1}return t}};t.prototype._evaluateMessageLength=function(e){var t=this._getEncodedMessageLength(e),n=this._emailCharLimit;if(9999999999!==n){!this.charLimitVisible.peek()&&t&&t>n-100&&this.charLimitVisible(!0);if(this.charLimitVisible.peek()){this.charCountText(d.format(h.strings.CharacterCounterFormat,t,n));t>n?this.charLimitReached(!0):this.charLimitReached.peek()&&this.charLimitReached(!1)}}else{this.charLimitVisible(!1);this.charLimitReached(!1)}};t.prototype._getEncodedMessageLength=function(e){var t=0,n=e.length,r=0,i=!1;if(!e||0===e.length)return 0;for(var s="&#160;",o="<br />",u="&quot;&quot;&quot;",a="&amp;",f="&#39;",l="&lt;",c="&gt;",h=" ";r<n;){var p=null,d=e[r];if(" "===d)p=r+1<n&&" "===e[r+1]||i?s:" ";else if("\n"===d){p=o;i=!0}else{'"'===d?p=u:"&"===d?p=a:"'"===d?p=f:"<"===d?p=l:">"===d?p=c:"\r"===d&&(p=h);i=!1}t+=null!==p?p.length:1;r++}return t};t.prototype.getSharingSettings=function(e){var t=this,n=this.resources.consume(o.resourceKey).getSharingData(this.item(),e);this.isReady=n.getSettings().then(function(e){t.sharingSettings=e;t._sharingSettings2(e);t.sharingSettings.itemId?t.sharingSettings.blockPeoplePickerAndSharing&&t.sharingError(y.strings.CannotShareText):t.sharingError(t.missingItemError);t.showExternalUserWarning=t.sharingSettings.showAdditionalExternalWarning;t._canCurrentUserShareExternally(t.sharingSettings.canCurrentUserShareExternally);t.peoplePickerParams={selectedPeople:t._params.selectedPeople,selectedPeopleContainsExternal:t._params.selectedPeopleContainsExternal,peoplePickerQueryParams:t.ppQueryParams,hasUnresolvedText:t._params.hasUnresolvedText,contactInviteLimit:e.contactInviteLimit};t.sharingRoleOptions(e.sharingRoles);t._mailSettings=e.mailSettings;t.canSendEmail(e.canSendEmail);t.canSendLink(e.canSendLink);t.supportsSharingPropagation(e.supportsSharingPropagation);t._params.propagateSharing&&t._params.propagateSharing(e.supportsSharingPropagation);t.peopleSharingWith(e.sharedWith);t._isDoneGettingSharingSettings(!0);t.hasLoadingError(!1);t.loading(!1)},function(e){var n=t.item();if(n&&n.parentLink){t._engagement.logData({name:"GetSettings.SharingDialog.Redirect"});window.location.href=n.parentLink+"?sharingDialogForListItemId="+n.id}else{e&&403===e.status?t.error(h.strings.AccessDenied):t.error(h.strings.ServerError);t._isDoneGettingSharingSettings(!0);t.hasLoadingError(!0);t.loading(!1)}})};t.prototype._refreshSharingSettings=function(){var e=this;this._referenceRevision()&&this._itemProvider.getItem({parentKey:this.item.peek().key,skipCache:!0,skipInMemoryCache:!0}).then(function(t){e.getSharingSettings(!0)})};return t}(v.default);t.default=w});
define("odsp-next/controls/sharing/sharingTips/SharingTips",["require","exports","./SharingTipsViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SharingTips.html","./SharingTips.css","../../dlplite/DlpLite"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-sharingTips",template:e("./SharingTips.html"),viewModel:n.default});t.default=i});
define("odsp-next/controls/sharing/sharingTips/SharingTipsViewModel",["require","exports","tslib","../../../providers/engagement/Engagement","../../../utilities/policyTip/PolicyTipHelper","../../../bindings/html/BindableHtmlBinding","../../../utilities/features/Features","../../../providers/panel/PanelProvider","../../../providers/peoplePicker/PeoplePickerProvider","knockout","../../policyTipPanel/PolicyTipPanel","./SharingTips.resx","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){n.__extends(t,e);function t(n){var l=e.call(this,n)||this,p=n.showPolicyTip,d=void 0===p?o.isFeatureEnabled(o.PolicyTipPanel):p;l.addBindingHandlers({bindableHtml:s.default});var v=l._engagement=l.resources.consume(r.resourceKey);l._item=n.item;l._policyTipType=n.policyTipType;l._policyTipInfo=n.policyTipInfo;l.hasPolicyTip=l.createObservable(l._item&&i.isPolicyTipFlagSet(l._item.policyTip,4));l.policyTipText=i.getPolicyTipText(l._policyTipType,"onViewPolicyTipClick");l._resolvedUsers=n.selectedPeople;l.showAdvancedMessage=n.showAdditionalSharingWarning;l.showPolicyTip=d;l.advancedWarningText=c.strings.GallatinMessage;l.multiExternalUserText=f.observable("");l.expandUsersText=f.observable(c.strings.Show);l.expandGroupsText=f.observable(c.strings.Show);l.showMultiUsers=f.observable(!1);l.isUserBlocked=f.observable(!1);l.showGroups=f.observable(!1);l.singleExternalUserText=f.observable("");l.groupsText=f.observable("");l.groupsMemberCountText=f.observable("");l._renderedExternalUsers=!1;l._renderedGroups=!1;l._peoplePickerProvider=l.resources.consume(a.resourceKey);l._pickerEntityInformations=[];if(n.pickerEntityInformations)for(var m=0,g=n.pickerEntityInformations;m<g.length;m++){var y=g[m];l._pickerEntityInformations[y.person.userId]=y}l.externalUsers=l.createComputed(function(){for(var e=!1,t=[],n=0,r=l._resolvedUsers();n<r.length;n++){var i=r[n];if(1===i.entityType){var s=i.rawPersonData.EntityData.IsBlocked;e=e||s&&"true"===s.toLowerCase();t.push(i)}}l.isUserBlocked(e);if(1===t.length){var o='<span class="od-SharingTips-resolvedUser">'+(t[0].email||t[0].name)+"</span>";l.singleExternalUserText(h.format(e?c.strings.SingleEmailBlockedByAllowDenyList:c.strings.SingleExternalUserText,o));l.showMultiUsers(!1)}else t.length>1&&l.multiExternalUserText(e?c.strings.MultipleEmailBlockedByAllowDenyList:c.strings.MultiExternalUserText);if(t.length>0&&!l._renderedExternalUsers){l._renderedExternalUsers=!0;l._engagement.logData({name:"ExternalUsers.SharingTips.Render"})}return t});l.groups=l.createComputed(function(){for(var e=[],n=0,r=0,i=l._resolvedUsers();r<i.length;r++){var s=i[r];if(2===s.entityType){var u={group:s,memberCountText:f.observable("")};if(o.isFeatureEnabled(o.OversharingMitigations)){var a=l.getGroupMemberCount(u);n+=a;u.memberCountText(t.getMemberCountText(a,!1))}e.push(u)}}e.length>1?l.groupsText(h.format(c.strings.MultiGroupText,e.length)):l.groupsText(h.format(c.strings.SingleGroupText,e.length));l.groupsMemberCountText(t.getMemberCountText(n,!0));if(e.length>0&&!l._renderedGroups){l._renderedGroups=!0;v.logData({name:"Groups.SharingTips.Render"})}return e});l.resources.bind(u.resourceKey);l._panelProvider=l.resources.consume(u.resourceKey);return l}t.getMemberCountText=function(e,t){return 1===e?t?c.strings.GroupOneMemberCountText:c.strings.SingleGroupOneMemberCountText:e>1&&e<1e3?h.format(t?c.strings.GroupMemberCountText:c.strings.SingleGroupMemberCountText,e):e>=1e3?t?c.strings.GroupMemberCountTextGreaterThan1000:c.strings.SingleGroupMemberCountTextGreaterThan1000:""};t.prototype.onViewPolicyTipClick=function(){var e={item:this._item,policyTipInfo:this._policyTipInfo()};this._panelProvider.requestPanel({component:{name:l.default.tagName,params:e}})};t.prototype.clickExpandUsers=function(){if(this.showMultiUsers()){this.expandUsersText(c.strings.Show);this.showMultiUsers(!1)}else{this._engagement.logData({name:"ExpandUsers.SharingTips.Click",isIntentional:!0});this.expandUsersText(c.strings.Hide);this.showMultiUsers(!0)}};t.prototype.clickExpandGroups=function(){if(this.showGroups()){this.expandGroupsText(c.strings.Show);this.showGroups(!1)}else{this._engagement.logData({name:"ExpandGroups.SharingTips.Click",isIntentional:!0});this.expandGroupsText(c.strings.Hide);this.showGroups(!0)}};t.prototype.getGroupMemberCount=function(e){var t=0;this._pickerEntityInformations[e.group.userId]?t=this._pickerEntityInformations[e.group.userId].totalMemberCount:this._retrievePickerEntityInformation(e);return t};t.prototype.updateGroupsMemberCountText=function(){for(var e=0,n=0,r=this._resolvedUsers();n<r.length;n++){var i=r[n];2===i.entityType&&this._pickerEntityInformations[i.userId]&&(e+=this._pickerEntityInformations[i.userId].totalMemberCount)}this.groupsMemberCountText(t.getMemberCountText(e,!0))};t.prototype._retrievePickerEntityInformation=function(e){var n=this;this._peoplePickerProvider.getPickerEntityInformation(e.group).then(function(r){n._pickerEntityInformations[e.group.userId]=r;e.memberCountText(t.getMemberCountText(r.totalMemberCount,!1));n.updateGroupsMemberCountText()},function(e){})};return t}(p.default);t.default=d});
define("odsp-next/utilities/policyTip/PolicyTipHelper",["require","exports","../../controls/policyTipPanel/PolicyTipPanel.resx","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getPolicyTipActionText=function(){return n.strings.ViewPolicyTip};t.getPolicyTipHeader=function(e){return r.format(n.strings.PolicyTipHeader,"'"+e+"'")};t.getPolicyTipText=function(e,t){var r=n.strings.PolicyTipBlock,i=this.isPolicyTipFlagSet(e,4),s=this.isPolicyTipFlagSet(e,2),o=this.isPolicyTipFlagSet(e,1);i?r=n.strings.PolicyTipNotifyAndBlock:s?r=n.strings.PolicyTipBlock:o&&(r=n.strings.PolicyTipNotify);t&&(r=r+' <a href=";" data-bind="click: '+t+'">'+n.strings.ViewPolicyTip+"</a>");return r};t.isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t}});
define("odsp-next/controls/policyTipPanel/PolicyTipPanel",["require","exports","./PolicyTipPanelViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./PolicyTipPanel.html"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-policy-tip-panel",template:e("./PolicyTipPanel.html"),viewModel:n.default});t.default=i});
define("odsp-next/controls/policyTipPanel/PolicyTipPanelViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-utilities/lib/dateTime/DateTime","../../providers/item/ItemProvider","@ms/odsp-shared-react/lib/PolicyTip","../policyTipPanel/PolicyTipPanel.resx","../../utilities/policyTip/PolicyTipHelper","../../resources/DataSourceResourceKeys","../../bindings/react/ReactBinding","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.item,i=t.policyTipInfo;n._item=r;n._policyTipInfo=i;n.addBindingHandlers({react:l.default});n._itemProvider=n.resources.consume(s.resourceKey);n._policyTipDataSource=n.resources.consume(f.policyTip);n._showJustificationInput=n.createObservable(!1);n._confirmationText=n.createObservable("").extend({notify:"always"});n.policyTipComponent=o.PolicyTip;n.policyTipComponentProps=n.createPureComputed(n._computePolicyTipComponentParams);return n}t.prototype._computePolicyTipComponentParams=function(){var e=this._confirmationText(),t=this._showJustificationInput(),n=this._getPolicyTipStrings();return{confirmationText:e,onDismissed:this._onDismissed.bind(this),onOverrideClicked:this._onOverrideClicked.bind(this),onOverrideSubmitClicked:this._onOverrideSubmitClicked.bind(this),overrideRequiresJustification:this._policyTipInfo?2===this._policyTipInfo.overrideOption:void 0,showJustificationInput:t,onReportClicked:this._onReportClicked.bind(this),strings:n}};t.prototype._getPolicyTipStrings=function(){var e=this._policyTipInfo;if(!e)return{noPolicyTipInfoError:u.strings.NoPolicyTipInfoError,titleText:a.getPolicyTipHeader(this._item.name),headerText:void 0,issues:void 0,lastScannedText:void 0,learnMoreActionLabel:void 0,learnMoreLabel:void 0,learnMoreUrl:void 0,overrideActionLabel:void 0,overrideLabel:void 0,policyTipDescription:void 0,reportActionLabel:void 0,reportInProgressLabel:void 0,reportLabel:void 0,submitButtonLabel:void 0};var t=1===e.overrideOption||2===e.overrideOption;return{headerText:u.strings.TipIssues,issues:e.issueDescriptions,lastScannedText:e.lastScanned?u.strings.TipLastScanned+": "+i.getRelativeDateTimeStringPast(e.lastScanned):void 0,learnMoreActionLabel:u.strings.LearnMoreActionLabel,learnMoreLabel:u.strings.LearnMoreLabel,learnMoreUrl:e.policyInfoUrl,noPolicyTipInfoError:void 0,overrideActionLabel:t?u.strings.OverrideActionLabel:void 0,overrideLabel:u.strings.OverrideLabel,policyTipDescription:e.explanationText,reportActionLabel:u.strings.ReportActionLabel,reportInProgressLabel:u.strings.ReportInProgress,reportLabel:u.strings.ReportLabel,submitButtonLabel:u.strings.SubmitButtonText,titleText:a.getPolicyTipHeader(this._item.name)}};t.prototype._onReportClicked=function(){var e=this;this._logEngagementEvent("ReportClicked");var t={item:this._item,action:1};this._policyTipDataSource.updatePolicy(t).done(function(t){if(1===t){e._logEngagementEvent("FalsePositiveReported");e._confirmationText(u.strings.ReportConfirmation)}else if(3===t||2===t){e._logEngagementEvent("OverrideWithoutJustification");e._confirmationText(u.strings.OverrideConfirmation)}})};t.prototype._onOverrideClicked=function(){var e=this;this._logEngagementEvent("OverrideClicked");var t=this._policyTipInfo.overrideOption;if(1===t){var n={item:this._item,action:0};this._policyTipDataSource.updatePolicy(n).done(function(t){e._logEngagementEvent("OverrideWithoutJustification");e._confirmationText(u.strings.OverrideConfirmation)})}else if(2===t){this._logEngagementEvent("JustificationInputShown");this._showJustificationInput(!0)}};t.prototype._onOverrideSubmitClicked=function(e){var t=this;this._logEngagementEvent("OverrideSubmitClicked");var n={item:this._item,action:0,justification:e};this._policyTipDataSource.updatePolicy(n).done(function(e){t._logEngagementEvent("OverrideWithJustification");t._confirmationText(u.strings.OverrideConfirmation)})};t.prototype._onDismissed=function(){this._itemProvider.invalidateItem(this._item.parentKey,{triggerFetch:!0})};t.prototype._logEngagementEvent=function(e){r.Engagement.logData({name:"PolicyTipPanel."+e})};return t}(c.default);t.default=h});
define("odsp-next/controls/policyTipPanel/PolicyTipPanel.html",[],function(){return'<div data-bind="react: { componentType: policyTipComponent, props: policyTipComponentProps }"></div>'});
define("odsp-next/controls/sharing/sharingTips/SharingTips.html",[],function(){return'<div class=od-SharingTips><div class=od-SharingTips-section data-bind="if: externalUsers().length > 0"><div data-bind="if: externalUsers().length === 1"><div class=od-SharingTips-singleExternalUser data-bind="html: singleExternalUserText, css: {\'od-SharingTips-error\': isUserBlocked}"></div></div><div data-bind="if: externalUsers().length > 1"><span class=od-SharingTips-multiUser data-bind="text: multiExternalUserText, css: {\'od-SharingTips-error\': isUserBlocked}"></span> <button class=od-SharingTips-expandLink data-bind="text: expandUsersText, click: clickExpandUsers"></button><div>\x3c!--ko if: showMultiUsers--\x3e<ul class=od-SharingTips-multiUserList data-bind="foreach: externalUsers"><li class=od-SharingTips-resolvedUser data-bind="text: email || name"></li></ul>\x3c!--/ko--\x3e</div></div><ms-dlplite></ms-dlplite>\x3c!--ko if: showAdvancedMessage--\x3e<div data-bind="text: advancedWarningText"></div>\x3c!--/ko--\x3e\x3c!--ko if: hasPolicyTip() && showPolicyTip--\x3e<div class=od-SharingTips-policyTip data-bind="bindableHtml: policyTipText"></div>\x3c!--/ko--\x3e</div><div class=od-SharingTips-section data-bind="if: groups().length > 0"><span class=od-SharingTips-multiUser data-bind="text: groupsText"></span> <span class=od-SharingTips-groupsMemberCount data-bind="text: groupsMemberCountText"></span> <button class=od-SharingTips-expandLink data-bind="text: expandGroupsText, click: clickExpandGroups"></button><div>\x3c!--ko if: showGroups--\x3e<ul class=od-SharingTips-multiUserList data-bind="foreach: groups"><li class=od-SharingTips-resolvedUser><span data-bind="text: group.name"></span> <span data-bind="text: memberCountText"></span></li></ul>\x3c!--/ko--\x3e</div></div>\x3c!--ko component: { name: \'ms-panel-host\' }--\x3e\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/sharing/sharingTips/SharingTips.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:'.od-SharingTips-section{margin-top:6px}[dir=ltr] .od-SharingTips-section{margin-left:6px}[dir=rtl] .od-SharingTips-section{margin-right:6px}.od-SharingTips-resolvedUser{display:inline-block;font-weight:700}.od-SharingTips-multiUserList{display:inline;list-style:none;padding:0}.od-SharingTips-multiUserList li{display:inline}.od-SharingTips-multiUserList li:after{content:", "}.od-SharingTips-multiUserList li:last-child:after{content:""}.od-SharingTips-expandLink{color:'},{theme:"blue",defaultValue:"#0078d4"},{rawString:";background:0 0;border:none;padding:0;cursor:pointer}.od-SharingTips-expandLink:focus,.od-SharingTips-expandLink:hover{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-SharingTips-error{color:#a80000}.od-SharingTips-policyTip{color:#a80000;margin-top:6px}"}])});
define("odsp-next/controls/dlplite/DlpLite",["require","exports","./DlpLiteViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./DlpLite.html","./DlpLite.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-dlplite",template:e("./DlpLite.html"),viewModel:n.default});t.default=i});
define("odsp-next/controls/dlplite/DlpLiteViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","knockout","./DlpLite.resx","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this)||this;n.strings=s.strings;n.isVisible=i.observable(!1);n.externalSharingLearnUrl=i.observable("javascript:");n.resources.consume(o.policyTip).getExternalSharingStatus().then(function(e){if(e){n.isVisible(e.isExternalSharingTipEnabled);n.externalSharingLearnUrl(e.externalSharingTipsLearnMoreUrl)}},function(e){});return n}return t}(r.default);t.default=u});
define("odsp-next/controls/dlplite/DlpLite.html",[],function(){return'<div class=ms-DlpLite data-bind="visible: isVisible"><span class=ms-DlpLite-middle data-bind="text: strings.bannerWarning"></span> <a class=ms-DlpLite-middle target=_blank data-bind="text:strings.learnMore, attr: {href: externalSharingLearnUrl}"></a></div>'});
define("odsp-next/controls/dlplite/DlpLite.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-DlpLite{overflow:hidden}"}])});
define("odsp-next/controls/sharing/shareByEmail/ShareByEmail.html",[],function(){return'<div class=Sharing>\x3c!--ko if:loading--\x3e<div class=Sharing-loadingSpinner data-bind="component: {name: loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko if: !sharingError()--\x3e\x3c!--ko ifnot:loading--\x3e<div class=Sharing-table data-bind="ifnot: hasLoadingError"><div class=Sharing-row><div class="Sharing-cell Sharing-peoplePicker" id=Sharing-peoplePicker data-bind="component: {name: peoplePickerTagName, params: peoplePickerParams}"></div>\x3c!--ko if: !hasSharingLink--\x3e<select class="Sharing-cell Sharing-simpleRoleSelector" data-bind="foreach: sharingRoleOptions, value: roleSelection, attr: {\'aria-label\': permissionLabel }, visible: sharingRoleOptions().length > 0"><option data-bind="text: name, value: value"></option></select>\x3c!--/ko--\x3e</div></div><div aria-live=assertive class=PeoplePicker-error data-bind="if: error"><span data-bind="text: error"></span></div><div data-bind="ifnot: hasLoadingError"><div aria-live=polite data-bind="component: { name: sharingTipsTagName, params: sharingTipsParams }"></div></div><div class=od-ShareByEmail-textInput data-bind="visible: canSendEmail()"><textarea class=Sharing-mailInput data-bind="enable: sendEmail, textInput: emailInputText, attr: { placeholder: inputPlaceholder }">\r\n        </textarea>\x3c!--ko if: expirationLabel--\x3e<div class=od-ShareByEmail-expirationLabel><i class="od-ShareByEmail-expirationIcon ms-Icon ms-Icon--Calendar" data-bind="icon: true"></i> <span class=od-ShareByEmail-expirationText data-bind="text: expirationLabel"></span></div>\x3c!--/ko--\x3e\x3c!--ko if: arePasswordProtectedLinksEnabled--\x3e\x3c!--ko if: isPasswordProtectedLink--\x3e<div class=od-ShareByEmail-passwordLabel><i class="ms-Icon ms-Icon--Lock" data-bind="icon: true"></i> <span class=od-ShareByEmail-passwordProtectedText data-bind="text: passwordProtectedLabel"></span></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if: !hasSharingLink--\x3e<div class=Sharing-link data-bind="visible: supportsSharingPropagation()"><input id=Sharing-aclPropagation type=checkbox data-bind="checked: propagateSharing"> <label for=Sharing-aclPropagation class=Sharing-aclPropagationLabel data-bind="text: propagateSharingLabel"></label></div><div class=Sharing-options data-bind="visible: canSendEmail() && sharingRoleOptions().length > 0 && !hideOptions"><div class=Sharing-link data-bind="visible: canSendLink"><input id=Sharing-requireSignIn type=checkbox data-bind="checked: requireSignIn, event: { change: requireSignInChanged }"> <label for=Sharing-requireSignIn data-bind="text: requireSignInLabel, attr: { title: requireSignInTooltip }"></label></div><div class=Sharing-link data-bind="visible: showSendEmailOption"><input id=Sharing-sendEmailCheckbox type=checkbox data-bind="checked: sendEmail, enable: requireSignIn()"> <label for=Sharing-sendEmailCheckbox data-bind="text: sendEmailLabel"></label></div></div>\x3c!--/ko--\x3e<div class=Sharing-charCounter data-bind="visible: charLimitVisible, css: { \'Sharing-charCounter--limitReached\': charLimitReached }, text: charCountText" aria-live=polite></div><div class=ms-clearfix></div>\x3c!--ko if: showShareButton--\x3e<div class=Sharing-submit><button class="Sharing-submitButton od-Button od-Button--primary" data-bind="click: shareClicked, enable: shareAvailable, automation: \'shareDialogCommit\'"><span class=od-Button-label data-bind="text: shareButtonText"></span></button></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: sharingError()--\x3e<div class=od-ShareByEmail-error data-bind="text: sharingError" aria-live=assertive></div>\x3c!--/ko--\x3e\x3c!--ko component: { name: \'ms-panel-host\' }--\x3e\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/sharing/shareByEmail/ShareByEmail.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".Sharing{overflow:hidden}.Sharing .Sharing-requireSignInLabel{border-bottom-style:dotted;border-bottom-width:1px}.Sharing-options{width:85%}html[dir=ltr] .Sharing-options{float:left}html[dir=rtl] .Sharing-options{float:right}html[dir=ltr] .Sharing-charCounter{text-align:right}html[dir=rtl] .Sharing-charCounter{text-align:left}.Sharing-charCounter--limitReached{color:#a80000}.Sharing-submitButton{position:relative;width:100%;height:30px;margin-top:5px}html[dir=ltr] .Sharing-submit{float:right}html[dir=rtl] .Sharing-submit{float:left}.Sharing-loadingSpinner{text-align:center;padding:75px 0}.Sharing-table{display:table;width:100%;border-collapse:collapse}.Sharing-row{display:table-row;width:100%}.Sharing-cell{display:table-cell}.Sharing-peoplePicker{width:100%;vertical-align:top}.Sharing-link{padding-bottom:5px}.Sharing-simpleRoleSelector{padding:2px;vertical-align:top;border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:12px;font-weight:400;height:33px}[dir=ltr] .Sharing-simpleRoleSelector{margin-left:8px}[dir=rtl] .Sharing-simpleRoleSelector{margin-right:8px}.Sharing-mailInput{resize:none;height:80px;width:100%;box-sizing:border-box;border:1px solid "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";overflow-y:auto;padding:5px;margin:10px 0 5px 0}#Sharing-aclPropagation,#Sharing-requireSignIn,#Sharing-sendEmailCheckbox{display:inline-block;vertical-align:sub}[dir=ltr] #Sharing-aclPropagation,[dir=ltr] #Sharing-requireSignIn,[dir=ltr] #Sharing-sendEmailCheckbox{margin-right:5px}[dir=rtl] #Sharing-aclPropagation,[dir=rtl] #Sharing-requireSignIn,[dir=rtl] #Sharing-sendEmailCheckbox{margin-left:5px}.od-Sharing-linkSwitcher{display:inline-block;margin-bottom:10px}.od-ShareByEmail-textInput{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.od-ShareByEmail-expirationLabel{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}[dir=ltr] .od-ShareByEmail-expirationIcon{margin-right:8px}[dir=rtl] .od-ShareByEmail-expirationIcon{margin-left:8px}.od-ShareByEmail-expirationText{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}"}])});
define("odsp-next/controls/sharing/sharingLinksSwitcher/SharingLinksSwitcher",["require","exports","./SharingLinksSwitcherViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SharingLinksSwitcher.html","./SharingLinksSwitcher.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-sharingLinksSwitcher",template:e("./SharingLinksSwitcher.html"),viewModel:n.default});t.default=i});
define("odsp-next/controls/sharing/sharingLinksSwitcher/SharingLinksSwitcherViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/async/Promise","../../../resources/ControlResourceKeys","../../../providers/engagement/Engagement","../../loadingSpinner/LoadingSpinner","../../progressSpinnerFlat/ProgressSpinnerFlat","./SharingLinksSwitcher.resx","../../../providers/sharing/SharingProvider","../../../bindings/css/VisibilityBinding","../../commands/CommandViewModel","../../../bindings/contextMenu/ContextMenuAlignment","../../../bindings/dismiss/DismissBinding","../../../utilities/selection/SelectionHelper","@ms/odsp-utilities/lib/string/StringHelper","../../../actions/SwitchSharingLinkAction","../../../bindings/html/BindableHtmlBinding","@ms/odsp-utilities/lib/locale/Locale","../../../bindings/focus/SelectOnFocusBinding","../../../providers/suiteNav/SuiteNavProvider","../../../utilities/sharing/SharingHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.loadingSpinnerTagName=a.default.tagName;n.progressSpinnerFlatTagName=f.default.tagName;n._anonymousLinksEnabled=!1;n._organizationLinksEnabled=!1;t.item&&(n._item=t.item);n._stateArray=t.dialogStateArray||r.observable([]);n.addBindingHandlers({bindableHtml:b.default,dismiss:v.default,selectOnFocus:E.default,visibility:h.default});n._selectionModel=n.resources.consume(o.itemsSelection);n._selectionHelper=n.resources.consume(m.resourceKey);n._sharingProvider=n.resources.consume(c.resourceKey);n._engagement=n.resources.consume(u.resourceKey);n.loading=r.observable(!0);n.sharingLinksSelectorStrings=l.strings;n.error=r.observable("");n.links=r.observable([]);n._unsavedLinkType=r.observable(8);n.sharingLinkMenuItems=r.observableArray();n.isSharingLinkMenuOpen=r.observable(!1);n.menuAlignment=r.observable(w.default.isRightToLeft?d.default.Left:d.default.Right);n.menuLeft=r.observable(w.default.isRightToLeft?"0":"auto");n.linkSelectorCurrentLabelText=r.observable("");n.currentSharingLink=t.currentLink||r.observable(null);n.selectedSharingLinkType=t.currentLink&&t.currentLink()?r.observable(t.currentLink().type):r.observable(8);n.editChecked=r.observable(!1);n.editVisible=r.observable(!0);n.isUpdatingLink=r.observable(!1);n.processingSharingLink=r.observable(!0);n.sharingLinkError=r.observable("");n.linkExpirationMenuItems=r.observableArray();n.isLinkExpirationMenuOpen=r.observable(!1);n.shouldShowLinkExpiration=r.observable(!1);n.shouldShowCustomExpiration=r.observable(!1);n.sharingLinkExpirationDate=r.observable("");n.sharingLinkExpirationNumDays=r.observable(0);n.sharingLinkExpirationLabel=n.createComputed(function(){return 0===n.sharingLinkExpirationNumDays()?n.sharingLinksSelectorStrings.SetSharingLinkExpiration:n.sharingLinksSelectorStrings.UpdateSharingLinkExpiration});n.shouldShowSetExpirationDropDown=r.observable(!0);n._companyDisplayName=r.observable("");var i=n.resources.consume(S.resourceKey.optional);i&&i.loadData().then(function(e){n._companyDisplayName(e.CompanyDisplayName);null!=n.currentSharingLink()&&n._setCurrentLinkLabelText(n.currentSharingLink().type)});var s=!1;n._selectionModel&&n._selectionModel.selection&&n._selectionModel.selection().length>1&&(s=!0);var p=n._sharingProvider.getSharingData(n._getCurrentItem());if(!s)if(null==n.currentSharingLink())n.isReady=p.getBestSharingLink().then(function(e){if(e){n._setSelectedType(e.type);n._setCurrentSharingLink(e);n.editChecked(6===e.type||9===e.type&&2===e.role);n.processingSharingLink(!1)}},function(e){n._handleSharingLinkError()});else{n.editChecked(6===n.currentSharingLink().type||9===n.currentSharingLink().type&&2===n.currentSharingLink().role);n.processingSharingLink(!1)}n.isSingleLinkLabelVisible=!1;p.getSettings().done(function(e){n.canManageLinks=e.canManageLinks;n._anonymousLinksEnabled=e.anonymousLinksEnabled;n._organizationLinksEnabled=e.organizationLinksEnabled;if(null!=n.currentSharingLink()){n._setSelectedType(n.currentSharingLink().type);n._setCurrentSharingLink(n.currentSharingLink())}n._adminRequiredAnonymousLinkExpirationInDays=e.requiredAnonymousLinkExpirationInDays;n._enforceRequiredAnonymousLinkExpiration=Number(e.requiredAnonymousLinkExpirationInDays)>0;n.shouldShowSetExpirationDropDown(!n._enforceRequiredAnonymousLinkExpiration);n.loading(!1)},function(e){});n._getSharingLinks().then(function(e){if(null!=e&&e.length>0){n.links(e);n.isSingleLinkLabelVisible=e.length<2;null==n.currentSharingLink()&&n._setSelectedType(e[0].type)}},function(e){n._handleSharingLinkError();n.loading(!1)});return n}t.prototype.onClickSharingLinkMenu=function(e,t){var n=this._engagement,r=this,i=new p.default({text:this._getLinkLabelText(8),subtext:this._getLinkLabelSubtext(8),isToggleable:!1,callback:function(){r.menuItemClick(8);n.logData({name:"SwitchToDirectLink.Menu.SharingLinksSwitcher.Click",isIntentional:!0})}}),s=new p.default({text:this._getLinkLabelText(9),subtext:this._getLinkLabelSubtext(9),isToggleable:!1,callback:function(){r.menuItemClick(9);n.logData({name:"SwitchToOrganizationLink.Menu.SharingLinksSwitcher.Click",isIntentional:!0})}}),o=new p.default({text:this._getLinkLabelText(5),subtext:this._getLinkLabelSubtext(5),isToggleable:!1,callback:function(){r.menuItemClick(5);n.logData({name:"SwitchToAnonymousLink.Menu.SharingLinksSwitcher.Click",isIntentional:!0})}}),u=[i];this._organizationLinksEnabled&&u.push(s);this._anonymousLinksEnabled&&u.push(o);this.sharingLinkMenuItems(u);this.isSharingLinkMenuOpen(!this.isSharingLinkMenuOpen());return u};t.prototype.menuItemClick=function(e){this._setSelectedType(e);this._unsavedLinkType(e);this._setCurrentLinkLabelText(e)};t.prototype.onDismissSharingLinksMenu=function(e,t){this.isSharingLinkMenuOpen(!1)};t.prototype.onClickLinkExpirationMenu=function(e,t){var n=this;if(this.processingSharingLink())return null;if(this._enforceRequiredAnonymousLinkExpiration){this.shouldShowCustomExpiration(!0);this.sharingLinkExpirationNumDays.peek()&&"0"!==String(this.sharingLinkExpirationNumDays.peek())||this.sharingLinkExpirationNumDays(this._adminRequiredAnonymousLinkExpirationInDays);this.sharingLinkError("");return null}var r=this,i=[],s=this._getAvailableExpirationOptions();Object.keys(s).forEach(function(e,t,o){var u=s[e],a=!isNaN(u)&&u>=0?n._calculateLinkExpiration(u):"CUSTOM",f=new p.default({text:e,isToggleable:!1,callback:function(){r.expiryDateChanged(a,u/1440)}});i.push(f)});this.linkExpirationMenuItems(i);this.isLinkExpirationMenuOpen(!this.isLinkExpirationMenuOpen());return i};t.prototype.expiryDateChanged=function(e,t){if("CUSTOM"===e)this.shouldShowCustomExpiration(!0);else if(e){this.sharingLinkExpirationNumDays(t);this.shouldShowCustomExpiration(!0)}else{this.sharingLinkExpirationDate(null);this.sharingLinkExpirationNumDays(0);this.shouldShowCustomExpiration(!1)}};t.prototype.onDismissLinkExpirationMenu=function(e,t){this.isLinkExpirationMenuOpen(!1)};t.prototype.switchLinksClick=function(){var e,t=this,n=this.selectedSharingLinkType();5===n&&this.editChecked()&&(n=6);this.links().forEach(function(r,i,s){r.type===n&&(9!==n||9===n&&2===r.role&&t.editChecked()||9===n&&1===r.role&&!t.editChecked())&&(e=r)});e||(e={type:n,role:this.editChecked()?2:1,url:""});var r=e&&e.expiration;if(this.shouldShowLinkExpiration()){var i=parseInt(String(this.sharingLinkExpirationNumDays()),10);if(String(this.sharingLinkExpirationNumDays())===String(i)){var o;if(i<0||i>730)o=this.sharingLinksSelectorStrings.LinkExpiration_InvalidValueErrorMessage;else if(this._enforceRequiredAnonymousLinkExpiration)if(i>this._adminRequiredAnonymousLinkExpirationInDays){var u=g.getLocalizedCountValue(this.sharingLinksSelectorStrings.LinkExpiration_AdminRequiredValueErrorMessage,this.sharingLinksSelectorStrings.LinkExpiration_ExpirationDaysIntervals,this._adminRequiredAnonymousLinkExpirationInDays);o=g.format(u,this._adminRequiredAnonymousLinkExpirationInDays)}else 0===i&&(i=this._adminRequiredAnonymousLinkExpirationInDays);if(o){this._handleSharingLinkError(o);return}r=i>0?this._calculateLinkExpiration(1440*i):null}}var a,f=this._selectionModel&&this._selectionModel.selection&&this._selectionModel.selection();a=!this._item||f&&f.length>1?this._selectionHelper.resolveSelection():s.default.wrap([this._item]);this.sharingLinkError("");a.then(function(n){new(t.managed(y.default))({items:n,link:e,expiration:r,isExecuting:t.isUpdatingLink,successCallback:function(n){t.shouldShowCustomExpiration(!1);if(null!=n){var i=t._engagement;"CUSTOM"===r?i.logData({name:"SwitchTo"+n.tag+"Link.Custom.LinkExpiration.SharingLinksSwitcher.Click",isIntentional:!0}):r?i.logData({name:"SwitchTo"+n.tag+"Link.LinkExpiration.SharingLinksSwitcher.Click",isIntentional:!0}):i.logData({name:"SwitchTo"+n.tag+"Link.SharingLinksSwitcher.Click",isIntentional:!0});if(!t.currentSharingLink()||n.type!==t.currentSharingLink().type||n.role!==t.currentSharingLink().role||n.expiration!==t.currentSharingLink().expiration){e.url=n.url;e.expiration=n.expiration;e.isActive=!!e.url;t._setCurrentSharingLink(e);t.processingSharingLink(!1)}var s=t._stateArray();s.pop();t._stateArray(s)}else t._handleSharingLinkError()},failureCallback:function(e){t._handleSharingLinkError(e)}}).execute(null)})};t.prototype.onClickCancelCustomExpiration=function(e,t){if(this.processingSharingLink())return!1;this.sharingLinkExpirationDate(null);this.sharingLinkExpirationNumDays(0);this.shouldShowCustomExpiration(!1);this.sharingLinkError("")};t.prototype._getAvailableExpirationOptions=function(){var e=this,t=[];t[this.sharingLinksSelectorStrings.LinkExpiration_Never]=0;[1,30,60].forEach(function(n,r,i){var s=1===n?e.sharingLinksSelectorStrings.LinkExpiration_SingleDay:g.format(e.sharingLinksSelectorStrings.LinkExpiration_MultiDay,n),o=1440*n;t[s]=o});t[this.sharingLinksSelectorStrings.LinkExpiration_Custom]=-1;return t};t.prototype._getSharingLinks=function(){var e=this;return this._sharingProvider.getSharingData(this._getCurrentItem()).getLinks().then(function(e){return e},function(t){e.error(e.sharingLinksSelectorStrings.ServerError);return null})};t.prototype._setSelectedType=function(e){6===e&&(e=5);this.selectedSharingLinkType(e);this._setCurrentLinkLabelText(e);8===e?this.editVisible(!1):this.editVisible(!0);5!==e?this.shouldShowLinkExpiration(!1):this.shouldShowLinkExpiration(!0)};t.prototype._setCurrentSharingLink=function(e){if(e){this.currentSharingLink(e);this._setCurrentLinkLabelText(e.type);this.shouldShowLinkExpiration(e.supportsExpiration);if(e.supportsExpiration){var t=e.expiration?new Date(e.expiration):null,n=e.expiration?t.toLocaleDateString():null;this.sharingLinkExpirationNumDays(x.getNumberOfDaysUntilExpiry(t));this.sharingLinkExpirationDate(n?g.format(this.sharingLinksSelectorStrings.LinkExpiration_DateDescription,n):"")}}};t.prototype._setCurrentLinkLabelText=function(e){this.linkSelectorCurrentLabelText(this._getLinkLabelText(e))};t.prototype._getLinkLabelSubtext=function(e){switch(e){case 8:return this.sharingLinksSelectorStrings.DirectLinkSubtext;case 9:return this._companyDisplayName()?g.format(this.sharingLinksSelectorStrings.OrganizationSubtext,this._companyDisplayName()):this.sharingLinksSelectorStrings.OrganizationAccountRequired;case 5:case 6:return this.sharingLinksSelectorStrings.AnonymousLinkSubtext}return""};t.prototype._getLinkLabelText=function(e){switch(e){case 8:return this.sharingLinksSelectorStrings.DirectLinkLabel;case 9:return this._companyDisplayName()?g.format(this.sharingLinksSelectorStrings.OrganizationTenantAccountRequired,this._companyDisplayName()):this.sharingLinksSelectorStrings.OrganizationAccountRequired;case 5:case 6:return this.sharingLinksSelectorStrings.NoSignInRequiredLabel}return""};t.prototype._calculateLinkExpiration=function(e){if(e>0){var t=new Date;t.setUTCMinutes(t.getUTCMinutes()+e);return t.toString()}return null};t.prototype._getCurrentItem=function(){return this._item?this._item:r.utils.unwrapObservable(this._selectionModel.selection()[0])};t.prototype._handleSharingLinkError=function(e){this.processingSharingLink(!1);this.sharingLinkError(e||this.sharingLinksSelectorStrings.ServerError)};return t}(i.default);t.default=T});
define("odsp-next/actions/SwitchSharingLinkAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../providers/sharing/SharingProvider"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="SwitchSharingLink";n._items=t.items;n._newLink=t.link;n._successCallback=t.successCallback;n._failureCallback=t.failureCallback;n._isExecuting=t.isExecuting;n._sharingProvider=n.resources.consume(o.resourceKey);n._expiration=t.expiration;return n}t.prototype.onExecute=function(e,t){var n=this,r=this._expiration&&"CUSTOM"!==this._expiration?new Date(this._expiration).toLocaleDateString():null,o=this._newLink.expiration?new Date(this._newLink.expiration).toLocaleDateString():null;if(this._expiration&&"CUSTOM"!==this._expiration&&r!==o||!this._expiration&&this._newLink.expiration){this._isExecuting&&this._isExecuting(!0);return new i.default(function(e,t){var r={},i={type:n._newLink.type,role:n._newLink.role,create:!0,expiration:n._expiration};n._sharingProvider.manageSharingLinks(n._items,i).then(function(t){n._successCallback&&n._successCallback(t[0]);r.resultType=s.ResultTypeEnum.Success;e(r)},function(t){n._failureCallback&&n._failureCallback(t&&t.message?t.message.value:"");r.resultType=s.ResultTypeEnum.Failure;e(r)})})}if(this._newLink.isActive){this._successCallback&&this._successCallback(this._newLink,this._expiration);return i.default.wrap({resultType:s.ResultTypeEnum.Success})}this._successCallback(this._newLink);return i.default.wrap({resultType:s.ResultTypeEnum.Success})};t.prototype.onIsAvailable=function(){return!0};return t}(r.default);t.default=u});
define("odsp-next/controls/sharing/sharingLinksSwitcher/SharingLinksSwitcher.html",[],function(){return'\x3c!--ko if:loading--\x3e<div class=od-SharingLinksSwitcher-loadingSpinner data-bind="component: {name: loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot:loading--\x3e<div aria-live=assertive class=od-SharingLinksSwitcher-error data-bind="if: error"><span data-bind="text: error"></span></div><div class=od-SharingLinksSwitcher-sharingLinkSelector><div class=od-SharingLinksSwitcher-linkPickerArea><span class=od-SharingLinksSwitcher-linkLabel data-bind="text: sharingLinksSelectorStrings.LinkLabelText"></span>\x3c!--ko if:isSingleLinkLabelVisible--\x3e<span class=od-SharingLinksSwitcher-linkInput-label data-bind="text: linkSelectorCurrentLabelText()"></span>\x3c!--/ko--\x3e\x3c!--ko ifnot:isSingleLinkLabelVisible--\x3e<a href=javascript:; class="od-SharingLinksSwitcher-dropdownLinkContainer ms-font-color-neutralPrimary ms-lines ms-fullWidth" aria-haspopup=true data-bind="click: onClickSharingLinkMenu, hasFocus: true, dismiss: onDismissSharingLinksMenu, attr: {\'aria-expanded\': isSharingLinkMenuOpen}"><span class=od-SharingLinksSwitcher-dropdownText data-bind="text: linkSelectorCurrentLabelText()"></span> <i class="ms-Icon ms-Icon--ChevronDown od-SharingLinksSwitcher-dropdownArrow" data-bind="icon: true, visible: shouldShowSetExpirationDropDown, title: sharingLinksSelectorStrings.OpenMenuTooltip"></i></a><ms-contextual-menu params="{ items: sharingLinkMenuItems, isOpen: isSharingLinkMenuOpen, alignment: menuAlignment, left: menuLeft}"></ms-contextual-menu>\x3c!--/ko--\x3e</div>\x3c!--ko if: editVisible--\x3e<div><input type=checkbox id=od-SharingLinkSwitcher-canEdit data-bind="checked: editChecked"> <label for=od-SharingLinkSwitcher-canEdit data-bind="text: sharingLinksSelectorStrings.CanEditLabel"></label></div>\x3c!--/ko--\x3e\x3c!--ko if:shouldShowLinkExpiration--\x3e<div class=od-SharingLinksSwitcher-linkExpirationArea><div data-bind="visible: !shouldShowCustomExpiration(), automation: \'SharingLinksSwitcher-expiration-selector\'"><span class=od-SharingLinksSwitcher-expiration-expirationText data-bind="visible: !!sharingLinkExpirationDate(), text: sharingLinkExpirationDate, automation: \'SharingLinksSwitcher-expiration-expirationSpan\'"></span> <span class=od-SharingLinksSwitcher-LinkExpirationMenuArea><a tabindex=0 class="od-SharingLinksSwitcher-updateLinkButton od-SharingLinksSwitcher-expiration-dropdownLinkContainer" aria-haspopup=true data-bind="click: onClickLinkExpirationMenu, dismiss: onDismissLinkExpirationMenu, attr: {\'aria-expanded\': isLinkExpirationMenuOpen}"><span class="od-SharingLinksSwitcher-expiration-dropdownText ms-uppercase" data-bind="text: sharingLinkExpirationLabel"></span> <i class="ms-Icon ms-Icon--ChevronDown ms-callout-icon od-SharingLinksSwitcher-expiration-dropdownArrow" data-bind="icon: true, visible: shouldShowSetExpirationDropDown, title: sharingLinksSelectorStrings.OpenMenuTooltip"></i></a><ms-contextual-menu params="{ items: linkExpirationMenuItems, isOpen: isLinkExpirationMenuOpen, alignment: menuAlignment, left: menuLeft}"></ms-contextual-menu></span></div><div class=ms-fullWidth data-bind="visible: shouldShowCustomExpiration"><div class=od-SharingLinksSwitcher-expiration-expirationText><span data-bind="text: sharingLinksSelectorStrings.LinkExpiration_CustomValueLabel_BeforeTextBox"></span> <input type=text class=od-SharingLinksSwitcher-expirationInput data-bind="selectOnFocus, value:sharingLinkExpirationNumDays, title:sharingLinksSelectorStrings.LinkExpiration_CustomValueTooltip"> <span data-bind="text: sharingLinksSelectorStrings.LinkExpiration_CustomValueLabel_AfterTextBox"></span></div><div class=od-SharingLinksSwitcher-expiration-buttons><a href=javascript:; class="od-SharingLinksSwitcher-updateLinkButton od-SharingLinksSwitcher-expiration-expirationSave" data-bind="click: onClickCancelCustomExpiration, text: sharingLinksSelectorStrings.CancelCustomExpiration, automation: \'SharingLinksSwitcher-expiration-cancelLink\'"></a></div></div></div>\x3c!--/ko--\x3e<div class=od-SharingLinksSwitcher-rightArea>\x3c!--ko if: isUpdatingLink--\x3e<div class=od-SharingLinksSwitcher-processing data-bind="component: { name: loadingSpinnerTagName, params: { loadingText: \'\' } }"></div>\x3c!--/ko--\x3e<button class="od-Dialog-action od-Button" data-bind="css: { \'od-Button--primary\': true }, click: switchLinksClick, enable: !isUpdatingLink()"><span class=od-Button-label data-bind="text: sharingLinksSelectorStrings.OkayButtonLabel"></span></button></div><div aria-live=assertive class=od-SharingLinksSwitcher-error data-bind="if: sharingLinkError"><span data-bind="text: sharingLinkError"></span></div><div class=ms-clearfix></div></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/sharing/sharingLinksSwitcher/SharingLinksSwitcher.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:"html[dir=ltr] .od-SharingLinksSwitcher-rightArea{float:right}html[dir=rtl] .od-SharingLinksSwitcher-rightArea{float:left}.od-SharingLinksSwitcher-processing{display:inline-block;padding-bottom:7px;vertical-align:bottom}[dir=ltr] .od-SharingLinksSwitcher-processing{padding-right:5px}[dir=rtl] .od-SharingLinksSwitcher-processing{padding-left:5px}.od-SharingLinksSwitcher-loadingSpinner{text-align:center;padding:75px 0}.od-SharingLinksSwitcher-linkInput-label{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";display:block;padding-top:5px}.od-SharingLinksSwitcher-linkLabel{display:block;padding-bottom:5px}.od-SharingLinksSwitcher-updateLinkButton{font-size:12px;font-weight:400;text-transform:uppercase;white-space:nowrap;display:inline-block;cursor:pointer}a.od-SharingLinksSwitcher-updateLinkButton{color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:";text-decoration:none}.od-SharingLinksSwitcher-linksSection{padding-bottom:20px}.od-SharingLinksSwitcher-error{color:#a80000}.od-SharingLinksSwitcher-linkPickerArea{margin-bottom:14px}.od-SharingLinksSwitcher-dropdownLinkContainer{color:inherit;display:inline-block;box-sizing:border-box;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";width:100%;padding:4px 10px;padding-bottom:2px}@media (max-width:639.99999px){.od-SharingLinksSwitcher-dropdownLinkContainer{width:223px}}.od-SharingLinksSwitcher-dropdownLinkContainer:hover,.od-SharingLinksSwitcher-dropdownLinkContainer:visited{color:inherit;text-decoration:none}.od-SharingLinksSwitcher-dropdownArrow,.od-SharingLinksSwitcher-expiration-dropdownArrow{display:inline-block;position:relative;top:5px}html[dir=ltr] .od-SharingLinksSwitcher-dropdownArrow,html[dir=ltr] .od-SharingLinksSwitcher-expiration-dropdownArrow{float:right}html[dir=rtl] .od-SharingLinksSwitcher-dropdownArrow,html[dir=rtl] .od-SharingLinksSwitcher-expiration-dropdownArrow{float:left}.od-SharingLinksSwitcher-linkTypeText{padding:10px}.od-SharingLinksSwitcher-expiry-div{border-collapse:separate}.od-SharingLinksSwitcher-singleLinkLabel{display:inline-block;width:433px;padding:4px 0;margin-bottom:5px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}@media (max-width:639.99999px){.od-SharingLinksSwitcher-singleLinkLabel{width:223px}}.od-SharingLinksSwitcher-dropdownText{display:inline-block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}@media (max-width:639.99999px){.od-SharingLinksSwitcher-dropdownText{width:183px}}.od-SharingLinksSwitcher-expiration-dropdownText{display:inline-block;overflow:hidden}.od-SharingLinksSwitcher-linkBoxArea{margin-bottom:5px}.od-SharingLinksSwitcher-sharingLinkSelector .od-SharingLinksSwitcher-linkInput-textbox{box-sizing:border-box;width:95%}.od-SharingLinksSwitcher-linkExpirationArea{margin-bottom:7px}.od-SharingLinksSwitcher-LinkExpirationMenuArea{display:inline-block}.od-SharingLinksSwitcher-expiration-dropdownLinkContainer{display:inline-block;vertical-align:middle}.od-SharingLinksSwitcher-expiration-expirationText{display:inline-block}[dir=ltr] .od-SharingLinksSwitcher-expiration-expirationText{padding-right:10px}[dir=rtl] .od-SharingLinksSwitcher-expiration-expirationText{padding-left:10px}.od-SharingLinksSwitcher-expirationInput{display:inline-block;width:30px;margin-top:-5px;cursor:text}.od-SharingLinksSwitcher-expiration-buttons{display:inline-block}.od-SharingLinksSwitcher-expiration-expirationSave{display:inline-block;vertical-align:text-bottom}[dir=ltr] .od-SharingLinksSwitcher-expiration-expirationSave{margin-right:10px}[dir=rtl] .od-SharingLinksSwitcher-expiration-expirationSave{margin-left:10px}.od-SharingLinksSwitcher-expiration-expirationError{margin-top:6px}.od-SharingLinksSwitcher-sharingLinkSelector a.od-ContextualMenu-item{padding:10px}#od-SharingLinkSwitcher-canEdit{display:inline-block;vertical-align:sub;margin-bottom:15px}[dir=ltr] #od-SharingLinkSwitcher-canEdit{margin-right:5px}[dir=rtl] #od-SharingLinkSwitcher-canEdit{margin-left:5px}"}])});
define("odsp-next/controls/sharing/sharingHints/SharingHints",["require","exports","./SharingHintsViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SharingHints.html","./SharingHints.css","../../persona/Persona"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-sharingHints",template:e("./SharingHints.html"),viewModel:n.default});t.default=i});
define("odsp-next/controls/sharing/sharingHints/SharingHintsViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./SharingHints.resx","@ms/odsp-utilities/lib/string/StringHelper","../../../bindings/html/BindableHtmlBinding","../../../utilities/features/Features","../shareByEmail/Sharing.resx","../../../models/item/ItemType"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._openAnchorHtml='<a href="javascript:;" data-bind="attr:{title: sharedWithLinkTitle}, click: switchTabs">';n._closeAnchorHtml="</a>";n._lastPersonTemplate='<od-persona class="od-SharingHints-persona" params="{ person: lastPerson, personaSize: 1, showPresence: true, profileLinkOn: true }" ></od-persona>';n._peopleTemplate='<span data-bind = "foreach: usersTrimmed" >    <od-persona class="od-SharingHints-persona" params="{ person: $data, personaSize: 1, showPresence: true, profileLinkOn: true, includeComma: true }" ></od-persona></span>';var r=i.strings.SharedWithText,l=i.strings.SharedWithOneText;n.sharedWithLinkTitle=n.createObservable("");n.addBindingHandlers({bindableHtml:o.default});n.guestLinkExists=t.guestLinkExists;n.sharedWithMany=t.sharedWithMany||n.observables.create(!1);n.anonymousLinksText=i.strings.GuestLinkText;n.showGuestLinkHint=8==(8&t.sharingHintsOption);n.showOnlyYouHint=4==(4&t.sharingHintsOption);n.showSharedWithHint=2==(2&t.sharingHintsOption);n.showNumberOfFilesHint=1==(1&t.sharingHintsOption);n.showNumberOfFilesOnlyHint=0===t.sharingHintsOption;if(1===t.items.length){var c=t.items[0],h=i.strings.SharedWithManyText;n.sharedWithLinkTitle(s.format(i.strings.SharedWithLinkTitle,c.name));n._isFolder=c.type===f.default.Folder;n._totalFileCount=n._isFolder&&c.folder?c.folder.totalCount:0;n.totalFileCountText=s.format(a.strings.SharingHintNumberOfFilesText,n._totalFileCount);n.showNumberOfFilesHint=n.showNumberOfFilesHint&&u.isFeatureEnabled(u.OversharingMitigations)&&n._isFolder&&n._totalFileCount>1;n.showNumberOfFilesOnlyHint=n.showNumberOfFilesOnlyHint&&u.isFeatureEnabled(u.OversharingMitigations)&&n._isFolder&&n._totalFileCount>1;n.showNumberOfFilesHint&&(h=h.toLowerCase());n.sharedWithManyHtml=s.format(h,n._openAnchorHtml,n._closeAnchorHtml)}else{n.sharedWithManyHtml="";n._isFolder=!1;n._totalFileCount=0;n.totalFileCountText="";n.showNumberOfFilesHint=!1}n.onlyYouText=i.strings.OnlyYouText;n._sharedWithCallBack=t.sharedWithCallback;n.users=t.sharedWith?n.observables.createArray(t.sharedWith().reverse()):n.observables.createArray([]);n.usersTrimmed=n.createComputed(function(){var e=n.users().length;return e<4?n.users().slice(0,e-1):n.users().slice(0,3)});n.lastPerson=n.createComputed(function(){var e=n.users().length;return e>0?n.users()[e-1]:null});n._moreLink=n.createComputed(function(){return n._openAnchorHtml+s.format(i.strings.NumberMoreText,n.users().length-3)+n._closeAnchorHtml});if(n.showNumberOfFilesHint){r=r.toLowerCase();l=l.toLowerCase()}n.users().length>4?n.sharedWithHtml=s.format(r,n._peopleTemplate,n._moreLink()):1===n.users().length?n.sharedWithHtml=s.format(l,n._lastPersonTemplate):n.sharedWithHtml=s.format(r,n._peopleTemplate,n._lastPersonTemplate);return n}t.prototype.switchTabs=function(){this._sharedWithCallBack&&this._sharedWithCallBack()};return t}(r.default);t.default=l});
define("odsp-next/controls/sharing/sharingHints/SharingHints.html",[],function(){return'<div class=od-SharingHints><div class=od-SharingHints-shared data-bind="visible: showSharedWithHint && sharedWithMany()"><span class=od-SharingHints-text data-bind="visible: showNumberOfFilesHint, text: totalFileCountText"></span> <span class=od-SharingHints-text data-bind="bindableHtml: sharedWithManyHtml"></span></div><div class=od-SharingHints-shared data-bind="visible: showNumberOfFilesOnlyHint"><span class=od-SharingHints-text data-bind="text: totalFileCountText"></span></div>\x3c!--ko if: showSharedWithHint && users().length > 0 && !sharedWithMany()--\x3e<div class=od-SharingHints-shared><span class=od-SharingHints-text data-bind="visible: showNumberOfFilesHint, text: totalFileCountText"></span> <span class=od-SharingHints-text data-bind="bindableHtml: sharedWithHtml"></span></div>\x3c!--/ko--\x3e<div class=od-SharingHints-private data-bind="visible: showOnlyYouHint && users().length === 0 && !guestLinkExists() && !sharedWithMany()"><i class="ms-Icon ms-Icon--Lock" data-bind="icon: true"></i> <span class=od-SharingHints-text data-bind="visible: showNumberOfFilesHint, text: totalFileCountText"></span> <span class=od-SharingHints-text data-bind="text: onlyYouText"></span></div><div class=od-SharingHints-externalWarning data-bind="visible: showGuestLinkHint && guestLinkExists"><i class="ms-Icon ms-Icon--Globe" data-bind="icon: true"></i> <span class=od-SharingHints-text data-bind="text: anonymousLinksText"></span></div></div>'});
define("odsp-next/controls/sharing/sharingHints/SharingHints.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-SharingHints{width:100%}.od-SharingHints .od-Persona--tiny{line-height:13px}.od-SharingHints .od-Persona--tiny .od-Persona-details{font-size:12px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .od-SharingHints .od-Persona--tiny .od-Persona-details{padding-left:0}[dir=rtl] .od-SharingHints .od-Persona--tiny .od-Persona-details{padding-right:0}.od-SharingHints-text{font-size:12px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SharingHints-persona{display:inline-block}"}])});
define("odsp-next/controls/sharing/sharingWizard/SharingWizard.html",[],function(){return'<div class=od-SharingWizard>\x3c!--ko if: isLoading--\x3e<div class=od-SharingWizard-loadingSpinner data-bind="component: {name: loadingSpinnerTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: isLoading--\x3e<div class=od-SharingWizard-sharingHints data-bind="component: {name: sharingHintsTagName, params: sharingHintsParams }"></div><div class=od-SharingWizard-component data-bind="component: componentDefinition"></div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/sharing/sharingWizard/SharingWizard.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-Dialog-content .od-SharingWizard{margin:-16px -32px -20px}.od-SharingWizard-loadingSpinner{margin-top:90px;text-align:center;margin-bottom:90px}.od-SharingWizard-component{padding:5px 32px 32px}.od-SharingWizard-sharingHints{padding:5px 27px 0}"}])});
define("odsp-next/actions/addPhotosToAlbum/AddPhotosToAlbumExecutor",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./AddPhotosToAlbumExecutorViewModel","./AddPhotosToAlbumExecutor.html"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.registerComponent({tagName:"add-photos-to-album-executor",template:e("./AddPhotosToAlbumExecutor.html"),viewModel:r.default,synchronous:!0});t.default=i});
define("odsp-next/actions/addPhotosToAlbum/AddPhotosToAlbumExecutorViewModel",["require","exports","tslib","../base/ControlExecutorViewModel","../../controls/overlays/panel/PanelOverlay","../../controls/bundleBuilder/BundleBuilder","../../models/item/IItemTypeFilter","../../dataSources/url/QueryType","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","../../providers/album/AlbumProvider.key","../../controls/albumBuilder/AlbumBuilder.resx"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.panelOverlayTagName=i.default.tagName;n.bundleBuilderTagName=s.default.tagName;var r=t.item;n._urlDataSource=n.resources.consume(a.url);n._item=r;n._signal=new l.default;n.showBundleBuilder=n.createObservable(!0);n.endWith(n.trackPromise(n._signal.getPromise().then(function(e){n.showBundleBuilder(!1);return n._addPhotosToAlbum(e)})));n.bundleBuilderParams={bundleName:n._item.name,typeFilter:{filters:[o.ItemTypeFilter.folder,o.ItemTypeFilter.media]},itemKey:n._urlDataSource.getRootItemKey(u.default.AllMyPhotos),complete:function(e){return n._complete(e)},cancel:function(){return n._cancel()}};n.panelOverlayParams={size:"XLarge",onClose:function(){return n.action.cancel()},showCloseButton:!1};return n}t.prototype._complete=function(e){for(var t=0,n=0,r=e;n<r.length;n++){var i=r[n];(i.photo||i.video)&&t++}if(t<e.length)return f.default.wrapError(new Error(h.strings.errorInvalidItems));this._signal.complete(e);return f.default.wrap()};t.prototype._cancel=function(){this._signal.cancel();return f.default.wrap()};t.prototype._addPhotosToAlbum=function(e){var t=this;return this.resources.consumeAsync(c.resourceKey).then(function(n){return n.addToAlbum({album:t._item,items:e})}).then(function(){})};return t}(r.default);t.default=p});
define("odsp-next/actions/addPhotosToAlbum/AddPhotosToAlbumExecutor.html",[],function(){return"\x3c!--ko if: showBundleBuilder--\x3e\x3c!--ko component: {\r\n name: panelOverlayTagName,\r\n params: panelOverlayParams\r\n}--\x3e\x3c!--ko component: {\r\n name: bundleBuilderTagName,\r\n params: bundleBuilderParams\r\n}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e"});
define("odsp-next/actions/createAlbum/CreateAlbumExecutor",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./CreateAlbumExecutorViewModel","./CreateAlbumExecutor.html"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.registerComponent({tagName:"create-album-executor",template:e("./CreateAlbumExecutor.html"),viewModel:r.default,synchronous:!0});t.default=i});
define("odsp-next/actions/createAlbum/CreateAlbumExecutorViewModel",["require","exports","tslib","../base/ControlExecutorViewModel","../../controls/overlays/panel/PanelOverlay","../../controls/albumBuilder/AlbumBuilder","../../dataSources/url/QueryType","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","./CreateAlbumOperator","./CreateAlbumHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.panelOverlayTagName=i.default.tagName;n.albumBuilderTagName=s.default.tagName;n._urlDataSource=n.resources.consume(u.url);n._name=n.createObservable("");n.showAlbumBuilder=n.createObservable(!0);n._signal=new f.default;n.endWith(n.trackPromise(n._signal.getPromise().then(function(e){n.showAlbumBuilder(!1);return n._createAlbum(e)})));n.albumBuilderParams={name:n._name,itemKey:n._urlDataSource.getRootItemKey(o.default.AllMyPhotos),complete:function(e){return n._complete(e)},cancel:function(){return n._cancel()}};n.panelOverlayParams={size:"XLarge",onClose:function(){return n.action.cancel()},showCloseButton:!1};return n}t.prototype._complete=function(e){var t=this._name.peek(),n=c.validateAlbumCreation(e,t);if(n)return a.default.wrapError(new Error(n));this._signal.complete(e);return a.default.wrap()};t.prototype._cancel=function(){this._signal.cancel();return a.default.wrap()};t.prototype._createAlbum=function(e){var t=this,n=this._name.peek(),r=e.map(function(e){return e.key});return this.resources.consumeAsync(l.typeResourceKey).then(function(e){var i=new e({name:n,keys:r});t.trackPromise(i.start());return i.wait()})};return t}(r.default);t.default=h});
define("odsp-next/controls/albumBuilder/AlbumBuilder",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./AlbumBuilderViewModel","./AlbumBuilder.html","../itemContent/ItemContent.css","./AlbumBuilder.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.registerComponent({tagName:"od-album-builder",template:e("./AlbumBuilder.html"),viewModel:r.default,synchronous:!0});t.default=i});
define("odsp-next/controls/albumBuilder/AlbumBuilderViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../filePickerHost/FilePickerHost","../itemNameEditor/ItemNameEditor","@ms/odsp-utilities/lib/async/Promise","../../resources/DataSourceResourceKeys","../../dataSources/url/QueryType","./AlbumBuilder.resx","../../models/item/IItemTypeFilter","knockout"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.itemNameEditorTagName=s.default.tagName;n.filePickerHostTagName=i.default.tagName;n._urlDataSource=n.resources.consume(u.url);var r=t.name,h=t.itemKey,p=void 0===h?n._urlDataSource.getRootItemKey(a.default.AllMyPhotos):h,d=t.complete,v=t.cancel;n.filePickerHostParams={itemKey:p,behavior:{showActions:!1,viewType:1,selectionMode:1,typeFilter:{filters:[l.ItemTypeFilter.media,l.ItemTypeFilter.folder]},completeText:f.strings.createCompleteActionName},agent:{initialize:function(){return o.default.wrap()},getApplication:function(){return o.default.wrap()},complete:d,cancel:v,switchAccount:function(){return o.default.wrap()}}};n.itemNameEditorParams={name:r,extension:void 0,hasFocus:c.observable(!0),namePlaceholder:f.strings.createNamePlaceholder};return n}return t}(r.default);t.default=h});
define("odsp-next/controls/albumBuilder/AlbumBuilder.html",[],function(){return'<div class=od-AlbumBuilder data-bind="component: { name: filePickerHostTagName, params: filePickerHostParams }"><div class="od-AlbumBuilder-content od-ItemContent" data-bind="css: { \'od-AlbumBuilder-content--hasError\': !!$host.status().error && !!$host.status().error.message }"><div class="od-AlbumBuilder-header od-ItemContent-header"><div class="od-AlbumBuilder-title od-ItemContent-title" data-bind="component: { name: itemNameEditorTagName, params: itemNameEditorParams }"></div>\x3c!--ko if: !!$host.status().error && !!$host.status().error.message--\x3e<div class="od-AlbumBuilder-status od-ItemContent-subTitle" data-bind="text: !!$host.status().error && $host.status().error.message"></div>\x3c!--/ko--\x3e</div></div></div>'});
define("odsp-next/controls/albumBuilder/AlbumBuilder.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-AlbumBuilder{position:absolute;top:0;left:0;right:0;bottom:0}.od-AlbumBuilder-title{max-width:340px}.od-AlbumBuilder-title .od-EditableText-textArea,.od-AlbumBuilder-title .od-TextField.od-TextField--multiline .od-TextField-field,.od-AlbumBuilder-title a.od-EditableText-readOnlyArea{font-size:21px;font-weight:100}.od-AlbumBuilder-title .od-EditableText .od-TextField-field.od-EditableText-textArea{min-height:33px}.od-AlbumBuilder-title .od-EditableText-readOnlyArea--interactive{border:none;border-bottom:1px solid transparent}.od-AlbumBuilder-title .od-EditableText-readOnlyArea--interactive:focus,.od-AlbumBuilder-title .od-EditableText-readOnlyArea--interactive:hover{border-color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-AlbumBuilder-title .od-TextField-field{border:none;border-bottom:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:";font-size:21px;font-weight:100;font-family:monospace;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .od-AlbumBuilder-title .od-TextField-field{padding-left:0}[dir=rtl] .od-AlbumBuilder-title .od-TextField-field{padding-right:0}.od-AlbumBuilder-status{margin-top:12px;color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:";font-size:12px}.od-AlbumBuilder-content--hasError .od-AlbumBuilder-header.od-ItemContent-header{height:90px}.od-AlbumBuilder-content--hasError .od-AlbumBuilder-status{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.od-AlbumBuilder-content--hasError .od-AlbumBuilder-title .od-TextField-field{border-color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}"}])});
define("odsp-next/actions/createAlbum/CreateAlbumExecutor.html",[],function(){return"\x3c!--ko if: showAlbumBuilder--\x3e\x3c!--ko component: {\r\n name: panelOverlayTagName,\r\n params: panelOverlayParams\r\n}--\x3e\x3c!--ko component: {\r\n name: albumBuilderTagName,\r\n params: albumBuilderParams\r\n}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e"});
define("odsp-next/actions/printPdf/odc/PrintPdfExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../controls/commands/Commands.resx","../../../controls/pdfViewer/PdfViewer.resx","../../../utilities/icons/Icon","../../../controls/textContainer/TextContainer","../../../providers/dialog/DialogProvider","../../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../../utilities/logging/odc/UsageNames","@ms/odsp-utilities/lib/logging/events/UsageType"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.actionName,i=t.instrumentationProvider,s=t.selectionHelper;n.name=r;n._instrumentationProvider=i;n._selectionHelper=s;n._actionMap=n.resources.consume(c.actionMap);n._dialogProvider=n.resources.consume(l.resourceKey);return n}t.prototype.execute=function(e){var t=this;return this._selectionHelper.resolveFirst().then(function(n){var r=t._dialogProvider.requestDialog({title:u.strings.PrintOptionsTitle,component:{name:f.default.tagName,params:{text:u.strings.PrintOptionsText}},actions:[{name:o.strings.Download,execute:function(){var n=new(t.managed(t._actionMap.DownloadAction))({});h.default.logData({name:p.UsageName[p.UsageName.PrintPdfDownloadOptionClicked],location:p.LocationName[p.LocationName.OneUp],usageType:d.UsageType[d.UsageType.Click],currentPage:t._instrumentationProvider.currentPageName(),previousPage:t._instrumentationProvider.previousPageName()});n.execute(e);return i.default.wrap(2)},isAvailable:t.createObservable(!0),icon:new a.default("Download"),isDefault:!0}]});h.default.logData({name:p.UsageName[p.UsageName.PrintPdfDownloadOptionShown],location:p.LocationName[p.LocationName.OneUp],usageType:d.UsageType[d.UsageType.Click],currentPage:t._instrumentationProvider.currentPageName(),previousPage:t._instrumentationProvider.previousPageName()});return r.wait().then(function(){return i.default.wrap({resultType:s.ResultTypeEnum.Success})})})};return t}(r.default);t.default=v});
define("odsp-next/actions/saveAutoAlbum/odc/SaveAutoAlbumExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","./SaveAutoAlbumOperator"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._selectionHelper=t.selectionHelper;n._isHidden=t.isHidden;return n}t.prototype.execute=function(e){var t=this,n={album:this._selectionHelper.firstItem.peek(),operationVisibility:this._isHidden?2:0};return this._selectionHelper.resolveSelection().then(function(){var e=new(t.managed(s.default))(n);return t.trackPromise(e.start())}).then(function(){return{resultType:i.ResultTypeEnum.Success}},function(e){return{resultType:i.ResultTypeEnum.Failure}})};return t}(r.default);t.default=o});
define("odsp-next/actions/saveAutoAlbum/odc/SaveAutoAlbumOperator",["require","exports","tslib","../../../providers/operator/BaseOperator","../../../models/task/Task","../../../models/operation/OperationType","../../../providers/album/AlbumProvider","../../../utilities/features/Features","../../../models/item/ItemHelper","../../../models/itemsScope/ItemsScopeFeature.key","../../../resources/ControlResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._context=t;n._albumProvider=n.resources.consume(o.resourceKey);n._viewParams=n.resources.consume(l.viewParams);return n}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input;n.type=s.default.saveAutoAlbum;n.name=r.name;n.payloads.saveAutoAlbum={album:r};n.visibility=void 0!==this._context.operationVisibility?this._context.operationVisibility:0;return n};t.prototype.onStart=function(e){var t=this._context.album,n=new i.default(t.key,t);e.update([n]);var r=!1,s=this._viewParams.peek();this.resources.consume(f.isItemsScopeEnabledInAllPhotosPivotResourceKey)&&void 0===s.tagFilter&&(r=!0);return!u.isFeatureEnabled(u.EvokeDev)||a.isAutoAlbum(t)?this._albumProvider.saveAutoAlbum(this._context,r,e):this._albumProvider.convertToAutoAlbum(t,r,e)};return t}(r.default);t.default=c});
define("odsp-next/actions/discardAutoAlbum/odc/DiscardAutoAlbumExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","./DiscardAutoAlbumOperator"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._selectionHelper=t.selectionHelper;return n}t.prototype.execute=function(e){var t=this,n={album:this._selectionHelper.firstItem.peek()};return this._selectionHelper.resolveSelection().then(function(){var e=new(t.managed(s.default))(n);t.trackPromise(e.start());return e.wait()}).then(function(){return{resultType:i.ResultTypeEnum.Success}},function(e){return{resultType:i.ResultTypeEnum.Failure}})};return t}(r.default);t.default=o});
define("odsp-next/actions/discardAutoAlbum/odc/DiscardAutoAlbumOperator",["require","exports","tslib","../../../providers/operator/BaseOperator","../../../models/task/Task","../../../models/operation/OperationType","../../../providers/fileSystem/FileSystemProvider","../../../dataSources/item/DeletionType","../../../providers/album/AlbumProvider","../../../dataSources/item/ItemTaskObserver"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._context=t;n._fileSystemProvider=n.resources.consume(o.resourceKey);n._albumProvider=n.resources.consume(a.resourceKey);return n}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input;n.type=s.default.discardAutoAlbum;n.name=r.name;n.payloads.discardAutoAlbum={album:r};n.visibility=0;return n};t.prototype.onStart=function(e){var t=this,n=this._context.album,r=new i.default(n.key,n),s=this._albumProvider.getAlbumsParentKey({}),o=new(this.managed(f.default));e.update([r]);var a={items:[this._context.album],deletionType:u.default.Recycle,overrideLock:!1,parentKey:s,emptyRecycleBin:!1};this._updateAlbumDeletionStatus(o,n,1);return this._fileSystemProvider.deleteItems(a,e).then(function(e){t._updateAlbumDeletionStatus(o,n,2);o.dispose();return e})};t.prototype._updateAlbumDeletionStatus=function(e,t,n){var r=t.state&&t.state.delete||{};r.status=n;e.update([new i.default(t.key).succeed({item:{state:{delete:r}}})]);e.flush()};return t}(r.default);t.default=l});
define("odsp-next/actions/addToFolder/odc/AddToFolderExecutor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../../controls/bundleBuilder/BundleBuilder","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../providers/panel/PanelProvider","@ms/odsp-shared/lib/base/BaseModel","../../../providers/moveCopy/MoveCopyProvider.key"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._selectionHelper=t.selectionHelper;n._panelProvider=n.resources.consume(u.resourceKey);return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveSelection().then(function(t){var n=e.observables.createArray(),r=t[0];r.vault&&r.vault.root&&i.Engagement.logData({name:"Vault.MoveFrom.Clicked"});return e._addToFolderViaPanel(r,n).then(function(){return e._addToFolder(r,n.peek())})})};t.prototype._addToFolderViaPanel=function(e,t){var n=this.observables.create(!1),i={resources:this.resources,bundleName:e.displayName,viewType:0,showCommandBar:!1,allowRootItem:!1,complete:function(e){t.splice.apply(t,[0,t.peek().length].concat(e));n(!0);return r.default.wrap()},cancel:function(){n(!0);return r.default.wrap()},useMoveString:!!e.vault},o=this._panelProvider.requestPanel({noTitle:!0,hasCommandBar:!0,size:"Large",showCloseButton:!1,component:{name:s.default.tagName,params:i}}),u=this.createComputed(function(){n()&&o.state(1)});return o.wait().then(function(){u.dispose()},function(e){u.dispose();return r.default.wrapError(e)})};t.prototype._addToFolder=function(e,t){if(t&&0===t.length)return r.default.wrap({resultType:o.ResultTypeEnum.Success});var n={items:t,parentKey:e.parent.key,targetId:e.id,targetKey:e.key,cid:null,group:e.isGroup?1:0,isMove:!0};return this.resources.consumeAsync(f.resourceKey).then(function(e){return e.moveItems(n)}).then(function(){return{resultType:o.ResultTypeEnum.Success}})};return t}(a.default);t.default=l});
define("odsp-next/actions/vault/odc/VaultExecutor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../../utilities/icons/Icon","../../../dataSources/vault/odc/VaultLogHelper","../../../providers/dialog/DialogProvider","../../../providers/featureCards/FeatureCardsProvider","../../../models/item/ItemParentHelper","../../../dataSources/vault/IVaultDataSource","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../controls/textContainer/TextContainer","../../../dataSources/url/odc/UrlDataSource","../VaultActionType","../../../dataSources/vault/odc/VaultDataSource","../../../controls/vaultFre/VaultFre","../../../controls/featureCards/FeatureCards","./VaultHelper","./VaultExecutor.resx","../../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._navigation=n.resources.consume(h.navigation);n._urlDataSource=n.resources.consume(m.resourceKey);n._vaultDataSource=n.resources.consume(y.resourceKey);n._itemParentHelper=n.resources.consume(l.resourceKey);n._vaultActionType=t.actionType;n._fixItUrl=t.fixItUrl;n._usePopup=t.usePopup;n._isPickerPage=t.isPickerPage;n._goPremiumSource=t.goPremiumSource?t.goPremiumSource:u.VAULT_GOPREMIUM_SOURCE_ICONCOMMAND;n._vaultHelper=new(n.managed(E.default))({item:t.item&&t.item.peek(),fixItUrl:t.fixItUrl,itemParentHelper:n._itemParentHelper});n._isOneDriveWinApp=x.isOneDriveWinApp();return n}t.prototype.execute=function(){var e=this,t=this._vaultActionType?this._vaultActionType.toString():"EmptyVaultAction";switch(this._vaultActionType){case g.default.Lock:return this._vaultDataSource.lockVault().then(function(){return p.default.resolve({name:t,resultType:d.ResultTypeEnum.Success})}).catch(function(){return p.default.reject({name:t,resultType:d.ResultTypeEnum.Failure})});case g.default.Unlock:return this._isOneDriveWinApp||this._isPickerPage?this._launchWinAppDialog():this._vaultDataSource.unlockVault(!1,this._usePopup?null:this._fixItUrl).then(function(){return p.default.resolve({name:t,resultType:d.ResultTypeEnum.Success})}).catch(function(){return p.default.reject({name:t,resultType:d.ResultTypeEnum.Failure})});case g.default.Manage:this._navigation.navigateTo({url:this._urlDataSource.getManageVaultUrl()});return p.default.resolve({name:t,resultType:d.ResultTypeEnum.Success});case g.default.FreDialog:return this._launchFreDialog().then(function(){return e._vaultHelper.unlockPopup().then(function(n){if(n){e._vaultDataSource.setVaultState(c.VaultFreState.FreShown);e._vaultDataSource.setShowVaultFreMessage(!0,!0);return p.default.resolve({name:t,resultType:d.ResultTypeEnum.Success})}return p.default.reject({name:t,resultType:d.ResultTypeEnum.Failure})})});case g.default.Reset:0;return p.default.reject({name:t,resultType:d.ResultTypeEnum.ExpectedFailure});case g.default.Debug:0;return p.default.resolve({name:t,resultType:d.ResultTypeEnum.Success});case g.default.ShowFiles:return this._vaultHelper.unlockPopup().then(function(e){return e?p.default.resolve({name:t,resultType:d.ResultTypeEnum.Success}):p.default.reject({name:t,resultType:d.ResultTypeEnum.Failure})}).catch(function(){return p.default.reject({name:t,resultType:d.ResultTypeEnum.Failure})});case g.default.FilesRemaining:return this._launchQuotaDialog();default:return p.default.reject({name:t,resultType:d.ResultTypeEnum.ExpectedFailure})}};t.prototype._getCurrentPerson=function(){var e=this.resources.consume(i.identity).getIdentity();return{userId:e.id,name:FilesConfig.SuiteNavConfig.UserDisplayName,email:e.email,image:FilesConfig.SuiteNavConfig.UserTileUrl,sharingInfo:{type:1,role:0}}};t.prototype._launchQuotaDialog=function(){var e=this.resources.consume(a.resourceKey),t=this.resources.consume(f.resourceKey);s.Engagement.logData({name:"Vault.FeatureCard.Shown",extraData:{location:"FileRemainingCommand"}});var n=e.requestDialog({component:{name:w.default.tagName,params:{cards:t.getFeatureCardsForVaultUpsell(),currentIndex:0,close:function(){return e.currentDialog().dismiss()},includeOverlay:!0,goPremiumSource:this._goPremiumSource,goPremiumCTA:"GoPremium"}}});n.wait().catch(function(){3===n.state.peek()&&s.Engagement.logData({name:"Vault.FeatureCard.Dismiss",extraData:{location:"FileRemainingCommand"}})});return n.wait().then(function(){return{resultType:d.ResultTypeEnum.Success}})};t.prototype._launchWinAppDialog=function(){var e=this.resources.consume(a.resourceKey),t=S.strings.winappUnavailableTitle,n=S.strings.winappUnavailableText;return e.requestDialog({title:t,component:{name:v.default.tagName,params:{text:n}},actions:[{name:S.strings.close,execute:function(){return p.default.resolve(3)},isAvailable:this.observables.create(!0),icon:new o.default("CheckMark"),isDefault:!0}]}).wait().then(function(){return{resultType:d.ResultTypeEnum.Success}})};t.prototype._launchFreDialog=function(){var e=this,t=this.resources.consume(a.resourceKey);this._isFreVerifyAvailable=this.observables.create(!1);this._freTitle=this.observables.create("");var n=t.requestDialog({title:this._freTitle,overlayColor:"rgba(255, 255, 255, .4)",customCssClasses:"od-vaultfre-outer",size:"Medium",component:{name:b.default.tagName,params:{isVerifyVisible:this._isFreVerifyAvailable,person:this._getCurrentPerson()}},actions:[{name:S.strings.freNextButton,execute:function(){return e._onDialogExecute()},isAvailable:this.createComputed(function(){return!e._isFreVerifyAvailable()}),isVisible:this.createComputed(function(){return!e._isFreVerifyAvailable()}),icon:new o.default("DoubleChevronRight"),isDefault:!0},{name:S.strings.freVerifyButton,execute:function(){s.Engagement.logData({name:"Vault.FRE.Positioning.Verify"});return p.default.wrap(2)},isAvailable:this.observables.create(!0),isVisible:this._isFreVerifyAvailable,icon:new o.default("Shield"),isDefault:!0}]});s.Engagement.logData({name:"Vault.FRE.Positioning.Shown"});n.wait().catch(function(){3===n.state.peek()&&(e._isFreVerifyAvailable()?s.Engagement.logData({name:"Vault.FRE.Positioning.Page2.Dimiss"}):s.Engagement.logData({name:"Vault.FRE.Positioning.Page1.Dimiss"}));return{resultType:d.ResultTypeEnum.ExpectedFailure}});return n.wait().then(function(){return{resultType:d.ResultTypeEnum.Success}})};t.prototype._onDialogExecute=function(){s.Engagement.logData({name:"Vault.FRE.Positioning.Next"});this._isFreVerifyAvailable(!0);this._freTitle(S.strings.freVerifyTitle);return p.default.wrap(1)};return t}(r.default);t.default=T});
define("odsp-next/dataSources/vault/odc/VaultDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../../providers/dialog/DialogProvider","../../../utilities/features/Features","@ms/odsp-utilities/lib/logging/events/Api.event","../../../utilities/icons/Icon","@ms/odsp-graph/lib/Models","../../../models/item/ItemParentHelper","../../../models/store/ItemsStore","../IVaultDataSource","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/async/Promise","./VaultLogHelper","../../../dataSources/url/QueryType","../../../resources/ProviderResourceKeys","../../identity/odc/IdentityDataSource","../../../providers/item/ItemProvider","@ms/odsp-utilities/lib/resources/Resources","../../base/vroom/VroomDataRequestor","../../../controls/textContainer/TextContainer","./VaultDataSource.resx","@ms/odsp-utilities/lib/uri/Uri"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var L="expirationtime",A="vaultMenuCalloutMessageShow",O=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._identityDataSource=n.identityDataSource;r._vroomDataRequestor=n.vroomDataRequestor;r._itemStore=n.itemStore;r._navigation=n.navigation;r._urlDataSource=n.urlDataSource;r._itemProvider=n.itemProvider;r._dialogProvider=n.dialogProvider;r._userInfoProvider=n.userInfoProvider;r._itemParentHelper=n.itemParentHelper;r._bundleLoader=n.bundleLoader;r._storageKeyPrefix=v.STORAGE_KEY_VAULT_PREFIX+r._identityDataSource.getIdentity().id;r._dataStore=t.dataStore||new i.default(r._storageKeyPrefix,s.default.local);r._isVaultOpen=r.createObservable(!!r._dataStore.getValue(L,s.default.local));r._vaultFreState=r.createObservable(v.VaultFreState.NotCreated);r._vaultSuggestCardState=r.createObservable(0);r._vaultQuota=r.createObservable(void 0);r._quotaLoaded=r.createComputed(r._computeQuotaLoaded);r._isVaultDisabled=r.createObservable(void 0);r.isOverQuota=r.createPureComputed(r._computeIsOverQuota);r._showVaultLockNotification=r.createObservable(!1);r._showVaultFreMessage=r.createObservable(r._dataStore.getValue(A,s.default.local));r.events.on(window,"storage",r._onStorageChange);r.createBackgroundComputed(r._updateVaultQuota);r.isVaultDisabled();r._isVaultOpen.peek()&&(r._getExpiration()<Date.now()?r.lockVault(void 0,!0):r._handleVaultUnlock());return r}t.prototype.vaultLockMessageSubscribe=function(e){this.scope.attach(e.register(this._showVaultLockNotification))};t.prototype.vaultStateSubscribe=function(e){this.scope.attach(e.register(this._isVaultOpen))};t.prototype.vaultFreSubscribe=function(e){this.scope.attach(e.register(this._vaultFreState))};t.prototype.vaultQuotaSubscribe=function(e){this.scope.attach(e.register(this._vaultQuota))};t.prototype.vaultMenuCalloutSubscribe=function(e){this.scope.attach(e.register(this._showVaultFreMessage))};t.prototype.vaultDisabledSubscribe=function(e){this.scope.attach(e.register(this._isVaultDisabled))};t.prototype.getVaultItem=function(){return this._vaultItem};t.prototype.isVaultOpen=function(){return this._isVaultOpen};t.prototype.freState=function(){return this._vaultFreState};t.prototype.suggestCardState=function(){return this._vaultSuggestCardState};t.prototype.getShowVaultFreMessage=function(){return this._showVaultFreMessage()};t.prototype.setShowVaultFreMessage=function(e,t){void 0===t&&(t=!1);t||this._showVaultFreMessage(e);this._setVaultIconFre(e)};t.prototype.unlockVault=function(e,t,n){var r=this;if(t){if(this._dataStore.getValue("isUnlocking",s.default.local)){this._dataStore.remove("isUnlocking",s.default.local);var i=this._urlDataSource.getRootItemKey(),o=this._urlDataSource.getItemUrl(i);this._navigation.navigateTo({url:o})}else{this._dataStore.setValue("isUnlocking",!0,s.default.local);this._navigation.navigateTo(t+"&v=unlock&ru="+encodeURIComponent(window.location.href))}return g.default.resolve()}return this.getVault(!1,!0).then(function(t){if(!t||!t.vault||t.vault.isLocked||e){return(!e&&f.isFeatureEnabled(f.ProjectVForceSAScope)?g.default.resolve({accessToken:n}):r._identityDataSource.getSessionToken(!0)).then(function(t){return r._vroomDataRequestor.send({apiName:"action.unlockVault",path:"/drive/special/vault/action.unlockVault",requestType:"POST",postData:JSON.stringify({}),accessToken:t,postProcessQos:r._postProcessUnlockQos.bind(r),useAuthorizationHeaders:!0,qosExtraData:{isExtend:!!e}}).then(function(){var t=Date.now()+12e5;r._dataStore.setValue(L,t,s.default.local);r._dataStore.remove("isUnlocking",s.default.local);if(!e){var n=r._urlDataSource.getRootItemKey();r._itemProvider.invalidateItem(n)}return g.default.resolve({})}).catch(function(e){r._handleVaultLock();return g.default.reject(e)})})}var i=Date.now()+1e3*t.vault.expirationInSeconds;r._dataStore.setValue(L,i,s.default.local);r._handleVaultUnlock(!!n)})};t.prototype.lockVault=function(e,t){var n=this;this._navToRootIfInVault();if(e){var r=this._urlDataSource.getPageType(this._navigation.viewParams);u.Engagement.logData({name:"Vault.Autolocked",extraData:{location:y.getPageName(r)}})}return(this._vaultItem?g.default.resolve(this._vaultItem):this.getVault()).then(function(r){return n._vroomDataRequestor.send({apiName:"action.lockVault",path:"/drive/special/vault/action.lockVault",requestType:"POST",postData:JSON.stringify({}),postProcessQos:n._postProcessQos.bind(n),qosExtraData:{isAutoLock:!!e}}).then(function(){n._handleVaultLock(t)}).catch(function(e){n._handleVaultLock(t);return n._isExpectedError(e)?g.default.resolve():g.default.reject(e)})})};t.prototype.dismissLockNotification=function(){this._showVaultLockNotification(!1)};t.prototype.extendLock=function(){return this.unlockVault(!0)};t.prototype.getVault=function(e,t,n,r){var i=this,s={};e&&(s.Prefer="auto-create-special-folder");n=n||"GET";return this._vroomDataRequestor.send({apiName:r?"EnableVault":e?"CreateVault":"GetVault",path:"/drive/special/vault",headers:s,requestType:n,breakCache:!0,qosExtraData:{requestType:n},postProcessQos:this._postProcessQos.bind(this)}).then(function(e){e.createdBy.user.id=e.createdBy.user.id.toUpperCase();i._vaultItem=e;return e}).catch(function(e){return t?null:g.default.reject(e)})};t.prototype.getQuota=function(){var e=this;return this._vroomDataRequestor.send({apiName:"drive",path:"/drive?select=quota/vault",requestType:"GET"}).then(function(t){e._vaultQuota(t&&t.quota&&t.quota.vault);return t.quota.vault})};t.prototype.createVaultIfNotExist=function(){var e=this;return this._userInfoProvider.getUserFact(46).then(function(t){if(!t||e._vaultFreState.peek()===v.VaultFreState.Created)return e.getVault(!0).then(function(t){e.setVaultState(v.VaultFreState.Created);e._isVaultDisabled(!1);var n=e._urlDataSource.getRootItemKey();e._itemProvider.invalidateItem(n,{triggerFetch:!0});return t});var n=JSON.parse(t.param||"{}");e._vaultFreState(n.s);e._vaultSuggestCardState(n.c)})};t.prototype.isVaultDisabled=function(){var e=this;return void 0!==this._isVaultDisabled.peek()?g.default.wrap(this._isVaultDisabled.peek()):this._userInfoProvider.getUserFact(46).then(function(t){if(t)return e.getVault(!1,!1,"HEAD").then(function(){e._isVaultDisabled(!1);return!1}).catch(function(t){var n=404===t.status;e._isVaultDisabled(n);return n});e._isVaultDisabled(!0);return!0})};t.prototype.enableVault=function(){var e=this;return this.getVault(!0,!1,"GET",!0).then(function(t){var n=e._urlDataSource.getRootItemKey();e._itemProvider.invalidateItem(n,{triggerFetch:!0});e._isVaultDisabled(!1);return t})};t.prototype.disableVault=function(e){var t=this,n={};e&&(n.If="(<"+e+">)");return this._vroomDataRequestor.send({apiName:"deleteVault",headers:n,path:"/drive/special/vault/delete",requestType:"DELETE",postData:JSON.stringify({}),postProcessQos:this._postProcessQos.bind(this)}).then(function(){t._cleanLocalLockInfo();t._isVaultDisabled(!0)}).catch(function(e){var t=e.response;if(t&&t.error&&t.error.fixItUrl){var n=new k.default(t.error.fixItUrl).getQueryParameter("confirmationToken");if(n){0;return n}}return g.default.reject(e)})};t.prototype.setVaultState=function(e,t){void 0!==e&&this._vaultFreState(e);t&&this._vaultSuggestCardState(t);var n={s:this._vaultFreState.peek(),c:this._vaultSuggestCardState.peek()};return this._userInfoProvider.setUserInfo(46,3,JSON.stringify(n))};t.prototype.reset=function(){0;return g.default.resolve(!1)};t.prototype.toggleDebug=function(){0};t.prototype._onNavigationChange=function(){var e=this._getCurrentItem();if(e){this._isVaultOpen.peek()&&(e.vault?e.vault.isLocked||this._attachIdleEvents():this._detatchIdleEvents());if(e.vault&&e.vault.root){if(!this._vaultRootLoadEventFiled){u.Engagement.logData({name:"Vault.Unlocked.Loaded"});this._vaultRootLoadEventFiled=!0}}else this._vaultRootLoadEventFiled=!1}};t.prototype._computeQuotaLoaded=function(){if(this._bundleLoader.getBundleInfo(3).isLoaded()){this._userStateProvider||(this._userStateProvider=this.resources.consume(w.quota));return!0}return!1};t.prototype._computeIsOverQuota=function(){var e=this._vaultQuota();return!!e&&e.remainingFiles<=0&&e.totalFiles>0};t.prototype._updateVaultQuota=function(){var e=this._userStateProvider&&this._userStateProvider.quotaNeedsUpdate();this._quotaLoaded()&&e&&this._isVaultOpen()&&this.getQuota()};t.prototype._isDebug=function(){0;return!1};t.prototype._getExpiration=function(){return this._isDebug()?Date.now()+12e4:this._dataStore.getValue(L,s.default.local)};t.prototype._startExpirationTimers=function(){var e=this;this._expirationWarningTimerId=this.async.setTimeout(function(){e._verifyLockExpiration()},this._getExpiration()-Date.now()-6e4);this._expirationLockTimerId=this.async.setTimeout(function(){0;e.lockVault(!0)},this._getExpiration()-Date.now())};t.prototype._stopExpirationTimers=function(){this.async.clearTimeout(this._expirationWarningTimerId);this.async.clearTimeout(this._expirationLockTimerId)};t.prototype._resetExpirationTimers=function(){0;this._stopExpirationTimers();this._startExpirationTimers()};t.prototype._attachIdleEvents=function(){if(!this._idleEventsAttached){"ontouchstart"in document.documentElement&&this.events.on(document,"touchstart",this._resetLastActivity,!0);this.events.on(document,"mousemove",this._resetLastActivity,!0);this.events.on(document,"keypress",this._resetLastActivity,!0);this._idleEventsAttached=!0;0}};t.prototype._detatchIdleEvents=function(){if(this._idleEventsAttached){"ontouchstart"in document.documentElement&&this.events.off(document,"touchstart",this._resetLastActivity,!0);this.events.off(document,"mousemove",this._resetLastActivity,!0);this.events.off(document,"keypress",this._resetLastActivity,!0);this._idleEventsAttached=!1;0}};t.prototype._resetLastActivity=function(){this._lastActivity=Date.now()};t.prototype._verifyLockExpiration=function(){var e=this;0;if(this._isDebug())this._showLockWarning();else if(Date.now()-this._lastActivity<9e5){0;this.extendLock().then(function(){e._resetExpirationTimers()})}else this.getVault().then(function(t){var n=t.vault&&t.vault.expirationInSeconds||0;if(1e3*n>12e4){0;var r=Date.now()+1e3*n;e._dataStore.setValue(L,r,s.default.local);e._resetExpirationTimers()}else e._showLockWarning()}).catch(function(t){0;return e.lockVault()})};t.prototype._showLockWarning=function(){var e=this;this._warningDialog=this._dialogProvider.requestDialog({title:C.strings.ExpirationDialogTitle,component:{name:N.default.tagName,params:{text:C.strings.ExpirationDialogBody}},actions:[{name:C.strings.ExpirationDialogExtendButton,execute:function(){u.Engagement.logData({name:"Vault.StillHere.Extend"});return e.extendLock().then(function(){e._resetExpirationTimers();return g.default.resolve(2)})},isAvailable:this.observables.create(!0),icon:new c.default("Cancel"),isDefault:!0}],isSoftDismissable:!1});u.Engagement.logData({name:"Vault.StillHere.Shown"});this._warningDialog.wait().then(function(){3===e._warningDialog.state.peek()&&u.Engagement.logData({name:"Vault.StillHere.Dismiss"})})};t.prototype._handleVaultLock=function(e){this._cleanLocalLockInfo();this._showVaultLockNotification(!e)};t.prototype._cleanLocalLockInfo=function(){var e=this;this._isVaultOpen(!1);this._dataStore.remove(L,s.default.local);this._dataStore.remove("isUnlocking",s.default.local);this._stopExpirationTimers();this._navToRootIfInVault();this.events.off(this._navigation,"change",this._onNavigationChange);this._navEventAttached=!1;this._getVaultIconFre()||this._showVaultFreMessage(!1);this._detatchIdleEvents();this._warningDialog&&this._warningDialog.dismiss();Object.keys(b.default).map(function(t){var n=e._urlDataSource.getRootItemKey(b.default[t]);e._itemProvider.invalidateItem(n)});var t=this._getCurrentItem();if(this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(t,"vault"))){var n=this._urlDataSource.getRootItemKey();this._itemStore.emptyAllOtherSets([n])}else t&&this._itemProvider.invalidateItem(t.key,{emptyAllOtherSets:!0});this._itemStore.invalidateAllVault()};t.prototype._navToRootIfInVault=function(){var e=this._getCurrentItem();if(this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"vault"))){var t=this._urlDataSource.getRootItemKey(),n=this._urlDataSource.getItemUrl(t);this._navigation.navigateTo({url:n})}};t.prototype._handleVaultUnlock=function(e){void 0===e&&(e=!1);this._isVaultOpen(!0);this._resetExpirationTimers();var t=this._urlDataSource.getRootItemKey();this._itemProvider.invalidateItem(t,{triggerFetch:!0});if(!this._navEventAttached){this.events.on(this._navigation,"change",this._onNavigationChange);this._navEventAttached=!0;this._attachIdleEvents()}this.getQuota();this._warningDialog&&this._warningDialog.dismiss();var n=this._getCurrentItem();n&&(n.vault||n.error&&n.error.data&&161===n.error.data.errorCode||n.queryType===b.default.RecycleBin&&"root"===n.id)&&this._itemProvider.invalidateItem(n.key,{triggerFetch:!0});this._showVaultLockNotification(!1);if(this._getVaultIconFre()&&!e){this._showVaultFreMessage(!0);this._setVaultIconFre(!1)}};t.prototype._onStorageChange=function(e){var t=e.key,n=e.oldValue,r=e.newValue;if(t===this._storageKeyPrefix+v.STORAGE_KEY_VAULT_CANARY&&r)try{var i=JSON.parse(r);FilesConfig.canary!==i&&(FilesConfig.canary=FilesConfig.navCanary=i)}catch(e){}t===this._storageKeyPrefix+L&&(r?(!n||r>n)&&this._handleVaultUnlock():this._isVaultOpen.peek()&&this._handleVaultLock())};t.prototype._getCurrentItem=function(){var e=this._urlDataSource.getCurrentItemKey(this._navigation.viewParams);return this.unwrapObservable(this._itemStore.getItem(e))};t.prototype._getVaultIconFre=function(){return this._dataStore.getValue(A,s.default.local)};t.prototype._setVaultIconFre=function(e){e?this._dataStore.setValue(A,e,s.default.local):this._dataStore.remove(A,s.default.local)};t.prototype._postProcessQos=function(e,t){this._isExpectedError(t)&&(e.resultType=l.ResultTypeEnum.ExpectedFailure);return e};t.prototype._postProcessUnlockQos=function(e,t){this._isExpectedUnlockError(t)&&(e.resultType=l.ResultTypeEnum.ExpectedFailure);return e};t.prototype._isExpectedError=function(e){if(400===e.status||403===e.status){var t=h.getResultCodeFromError(e);if("memberdoesnotexist"===(t=t&&t.toLowerCase())||"unlockrequired"===t||"accessdenied"===t||"confirmationrequired"===t)return!0}else if(404===e.status)return!0;return!1};t.prototype._isExpectedUnlockError=function(e){var t=h.getResultCodeFromError(e);return"vaultunlockextensiontimeexceeded"===(t=t&&t.toLowerCase())};return t}(r.default);t.default=O;t.resourceKey=x.createResolvedResourceKey(e("module").id,O,n.__assign({},r.default.dependencies,{identityDataSource:E.resourceKey,vroomDataRequestor:T.resourceKey,itemStore:d.resourceKey,urlDataSource:o.url,navigation:m.navigation,itemProvider:S.resourceKey,dialogProvider:a.resourceKey,userInfoProvider:w.userInfo,itemParentHelper:p.resourceKey,bundleLoader:w.bundleLoader}))});
define("odsp-next/controls/vaultFre/VaultFre",["require","exports","./VaultFreViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./VaultFre.html","./VaultFre.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-vault-fre",template:e("./VaultFre.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/vaultFre/VaultFreViewModel",["require","exports","tslib","../persona/Persona","./VaultFre.resx","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="lock",u="clock",a="mobiledevice",f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.isVerifyVisible=t.isVerifyVisible;n.secondaryTitle=i.strings.freSecondaryTitle;n.descriptionText=i.strings.freDescription;n.itemOneText=i.strings.freItemOne;n.itemTwoText=i.strings.freItemTwo;n.itemThreeText=i.strings.freItemThree;n.verifyText=i.strings.freVerifyText;n.lockImageUrl=n._getImagePath(o);n.clockImageUrl=n._getImagePath(u);n.fileImageUrl=n._getImagePath(a);n.personaTagName=r.default.tagName;n.personaParams={person:n.observables.create(t.person),personaSize:8};return n}t.prototype._getImagePath=function(e){return window.require.toUrl("odsp-media/images/vault/"+e+".svg")};return t}(s.default);t.default=f});
define("odsp-next/controls/vaultFre/VaultFre.html",[],function(){return'<div class=od-vaultfre><div class=intro data-bind="visible: !isVerifyVisible()"><span class=od-vaultfre-title data-bind="text: secondaryTitle"></span> <span class=od-vaultfre-description data-bind="text: descriptionText"></span><div class=od-vaultfre-points><div><img class=od-vaultfre-image role=presentation data-bind="attr: { src: lockImageUrl }"> <span data-bind="text: itemOneText"></span></div><div><img class=od-vaultfre-image role=presentation data-bind="attr: { src: clockImageUrl }"> <span data-bind="text: itemTwoText"></span></div><div><img class=od-vaultfre-image role=presentation data-bind="attr: { src: fileImageUrl }"> <span data-bind="text: itemThreeText"></span></div></div></div><div class=od-vaultfre-verify data-bind="visible: isVerifyVisible"><span class=od-vaultfre-description data-bind="text: verifyText"></span><div class=od-vaultfre-person data-bind="component: { name: personaTagName, params: personaParams }"></div></div></div>'});
define("odsp-next/controls/vaultFre/VaultFre.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-Dialog .od-Dialog-main.od-vaultfre-outer{text-align:center;max-width:540px;height:548px;border-radius:2px}.od-Dialog .od-Dialog-main.od-vaultfre-outer .od-Dialog-header{padding-top:40px;font-weight:600}.od-vaultfre-outer .od-StandardDialog{padding:24px 48px;overflow:auto;min-height:500px}.od-vaultfre-outer .od-Dialog-title{font-weight:400;font-size:32px}.od-vaultfre-outer .od-Dialog-inner{padding-top:0;height:400px}.od-vaultfre-outer .od-Dialog-actions{max-width:440px;position:absolute;bottom:20px;padding:0}.od-vaultfre-outer .od-Button{border-radius:2px}.od-vaultfre{font-size:17px;padding:0 16px}.od-vaultfre-title{font-size:32px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";display:block;padding-bottom:8px}.od-vaultfre-description{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:14px}.od-vaultfre-points{padding-top:36px}[dir=ltr] .od-vaultfre-points{padding-left:3px}[dir=rtl] .od-vaultfre-points{padding-right:3px}.od-vaultfre-points div{height:75px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;padding-top:8px}html[dir=ltr] .od-vaultfre-points div{text-align:left}html[dir=rtl] .od-vaultfre-points div{text-align:right}.od-vaultfre-points span{line-height:28px}[dir=ltr] .od-vaultfre-points span{padding-left:13px}[dir=rtl] .od-vaultfre-points span{padding-right:13px}.od-vaultfre-points i{padding:6px;border:1px solid #eaeaea;border-radius:4px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:32px}.od-vaultfre-verify{padding-top:8px;max-width:326px}[dir=ltr] .od-vaultfre-verify{padding-left:11px}[dir=rtl] .od-vaultfre-verify{padding-right:11px}.od-vaultfre-person{padding-top:57px}.od-vaultfre-person .od-Persona-imageCircle{width:120px;height:120px}.od-vaultfre-person .od-Persona-details{display:block}.od-vaultfre-person .od-Persona-details .od-Persona-primaryText{font-weight:600;font-size:20px}.od-vaultfre-person .od-Persona-imageArea{padding-bottom:13px}.od-vaultfre-person .od-Persona-emailText{padding-top:10px;font-size:14px}.od-vaultfre .od-vaultfre-person .od-Persona .od-Persona-imageArea{margin:0}"}])});
define("odsp-next/actions/downloadZipContents/odc/DownloadZipContentsAction",["require","exports","tslib","@ms/odsp-utilities/lib/navigation/AddressWriter","../DownloadZipContentsAction"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.onExecute=function(e,t){var n=this;this._engagement.logData({name:"OneUpZipPreviewer.SelectiveDownload",isIntentional:!0});var i=this._selection.peek(),s=this._downloadUrl.peek();return this.getAuthenticationParams().then(function(e){var t={url:s+"?"+r.serializeQuery(e),postdata:{relativeFilePath:i.map(function(e){return e.path}).join(",")}};return n.downloadContent(t,i)})};return t}(i.default);t.default=s});
define("odsp-next/actions/downloadZipContents/DownloadZipContentsAction",["require","exports","tslib","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/browser/PlatformDetection.key","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-datasources/lib/utilities/permissions/Identity","../NavigateViaPost","../../base/BaseAction","../../controls/downloadZipContents/DownloadZipContents","../../providers/engagement/Engagement","../../providers/hiddenDom/HiddenDomProvider","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="DownloadZipContents";var i=n.resources;n._engagement=i.consume(c.resourceKey);n._hiddenDomProvider=i.consume(h.resourceKey);n._useWindow=i.consume(s.platformDetection).isIE;n._identityDataSource=i.consume(d.identity);n._navigation=i.consume(r.navigation);n._downloadUrl=t.url;n._selection=t.selection;var o=i.consume(p.actionMap);n._downloadAction=new(n.managed(o.DownloadAction))({item:t.item});n._isOneDriveWinApp=v.isOneDriveWinApp();return n}t.prototype.onIsAvailable=function(){return this._downloadAction.isAvailable()&&!!this._downloadUrl};t.prototype.getAuthenticationParams=function(){var e,t=this._getAuthKey();return t?i.default.resolve(((e={}).authkey=t,e)):this._identityDataSource.getSessionToken().then(function(e){var t=e.accessToken,n=e.proofToken,r={};t&&(r.access_token=decodeURIComponent(t));n&&(r.prooftoken=decodeURIComponent(n));return r})};t.prototype.downloadContent=function(e,t){var n=this;if(this._useWindow)this._downloadInWindow("od-download-tab",e);else{var r=this._hiddenDomProvider.requestControl({name:l.default.tagName,params:e}),s=this.addDisposable({dispose:function(){n._hiddenDomProvider.disposeControl(r)}});this.async.setTimeout(function(){s.dispose()},2e4)}var u={resultType:o.ResultTypeEnum.Success,extraMetrics:{count:t.length}};return i.default.resolve(u)};t.prototype._getAuthKey=function(){return this._identityDataSource.getIdentity().type===u.IdentityType.anonymous&&this._navigation.viewParams.authkey};t.prototype._downloadInWindow=function(e,t){var n=window.open("",e);a.navigateViaPost({url:t.url,postdata:t.postdata,document:n.document});this.async.setTimeout(function(){n.close()},5e3)};return t}(f.default);t.default=m});
define("odsp-next/controls/downloadZipContents/DownloadZipContents",["require","exports","./DownloadZipContentsViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./DownloadZipContents.html","./DownloadZipContents.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-downloadzipcontents",template:e("./DownloadZipContents.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/downloadZipContents/DownloadZipContentsViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../bindings/iframe/IFrameBinding"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({iframe:i.default});n.iframeOptions={url:t.url,postdata:t.postdata,type:"post"};return n}return t}(r.default);t.default=s});
define("odsp-next/controls/downloadZipContents/DownloadZipContents.html",[],function(){return'<div class=od-DownloadZipContents data-bind="iframe: iframeOptions"></div>'});
define("odsp-next/controls/downloadZipContents/DownloadZipContents.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-DownloadZipContents{visibility:hidden}"}])});
define("odsp-next/actions/moveCopy/odc/MoveCopyAction",["require","exports","tslib","../../../providers/moveCopy/MoveCopyProvider.key","@ms/odsp-utilities/lib/logging/events/Qos.event","../MoveCopyAction"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.onExecute=function(e){var t=this;return this.resources.consumeAsync(r.resourceKey).then(function(e){var n;n=t.isMove?e.moveItems(t.context()):e.copyItemsAsync(t.context());t.onComplete();return n.then(function(){return{resultType:i.ResultTypeEnum.Success}})})};return t}(s.default);t.default=o});
define("odsp-next/actions/moveCopy/MoveCopyAction",["require","exports","tslib","../base/templates/SelectionAction"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="MoveCopy";n.context=t.context;n.onComplete=t.onComplete;n.isMove=t.isMove;n.isCrossSite=!!t.isCrossSite&&t.isCrossSite;return n}t.prototype.onIsAvailable=function(){return this.selectionHelper.selection().length&&this.context().isMove===this.isMove};t.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}};return t}(r.default);t.default=i});
define("odsp-next/actions/createNewFolder/odc/CreateNewFolderAction",["require","exports","tslib","../../base/ItemRedeemer","../../base/ItemCommandHelper","../CreateNewFolderAction","../../../models/item/command/FileSystemItemCommandKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._itemReedemer=new(n.managed(r.default));n._itemCommandHelper=new(n.managed(i.default));return n}t.prototype.onIsAvailable=function(){return this._itemCommandHelper.isCommandSupported(this.parentItem,o.createFolder)};t.prototype.onExecute=function(t){var n=this;return this._itemReedemer.redeemItem(this.parentItem,this).then(function(){return e.prototype.onExecute.call(n,t)})};return t}(s.default);t.default=u});
define("odsp-next/actions/createNewFolder/CreateNewFolderAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../../controls/commands/Commands.resx","../createFolder/CreateFolderOperator"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="CreateNewFolder";n.parentItem=t.parentItem;n._newName=t.newFolderName;var r=t.options||{};n._options={dataUpdated:r.dataUpdated||n.observables.create(!1),showNewFolderInput:r.showNewFolderInput||n.observables.create(!0),hasError:r.hasError||n.observables.create(!1),status:r.status||n.observables.create(""),hasFocus:r.hasFocus||n.observables.create(!0),isEnabled:r.isEnabled||n.observables.create(!0),needsRefocus:r.needsRefocus||n.observables.create(!1)};return n}t.prototype.onExecute=function(e){var t=this;this._options.status(s.strings.Saving);this._options.hasError(!1);this._options.isEnabled(!1);return this.resources.consumeAsync(o.typeResourceKey).then(function(e){var n=new e({parent:t.parentItem,folderName:t._newName.peek()});return t.trackPromise(n.start())}).then(function(){t._options.dataUpdated(!0);t._options.showNewFolderInput(!1);t._options.isEnabled(!0);t._options.status("");return{resultType:i.ResultTypeEnum.Success}},function(e){t._options.hasError(!0);t._options.status(e.message);t._options.isEnabled(!0);t._options.hasFocus(!0);return{resultType:i.ResultTypeEnum.Failure}})};return t}(r.default);t.default=u});