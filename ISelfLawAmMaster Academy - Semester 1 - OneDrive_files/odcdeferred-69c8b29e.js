define("odsp-next/bundles/OneDriveDeferred",["require","exports","../controls/FabricIconsDeferred"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})});
define("@uifabric/fluent-theme/lib/fluent/FluentStyles",["require","exports","./styles/BasePicker.styles","./styles/Breadcrumb.styles","./styles/DetailsList.styles","./styles/Callout.styles","./styles/Checkbox.styles","./styles/ChoiceGroupOption.styles","./styles/ColorPickerGridCell.styles","./styles/ColorPicker.styles","./styles/ComboBox.styles","./styles/CommandBar.styles","./styles/CommandBarButton.styles","./styles/CompoundButton.styles","./styles/ContextualMenu.styles","./styles/DatePicker.styles","./styles/DefaultButton.styles","./styles/DetailsColumn.styles","./styles/Dialog.styles","./styles/Dropdown.styles","./styles/HoverCard.styles","./styles/Facepile.styles","./styles/IconButton.styles","./styles/Label.styles","./styles/Link.styles","./styles/Modal.styles","./styles/Panel.styles","./styles/PeoplePicker.styles","./styles/Persona.styles","./styles/Pivot.styles","./styles/PrimaryButton.styles","./styles/Rating.styles","./styles/SearchBox.styles","./styles/Slider.styles","./styles/SpinButton.styles","./styles/Spinner.styles","./styles/PickerSuggestions.styles","./styles/TagPicker.styles","./styles/TeachingBubble.styles","./styles/TextField.styles","./styles/Toggle.styles"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FluentStyles={Breadcrumb:{styles:r.BreadcrumbStyles},CalloutContent:{styles:s.CalloutContentStyles},ColorPicker:{styles:f.ColorPickerStyles},ColorRectangle:{styles:f.ColorRectangleStyles},ColorSlider:{styles:f.ColorSliderStyles},CommandBar:{styles:c.CommandBarStyles},CommandBarButton:{styles:h.CommandBarButtonStyles},CompoundButton:{styles:p.CompoundButtonStyles},Check:{styles:i.CheckStyles},Checkbox:{styles:o.CheckboxStyles},ChoiceGroupOption:{styles:u.ChoiceGroupOptionStyles},ColorPickerGridCell:{styles:a.ColorPickerGridCellStyles},ComboBox:{styles:l.ComboBoxStyles},CompactPeoplePicker:{styles:n.BasePickerStyles},ContextualMenu:{styles:d.ContextualMenuStyles},DatePicker:{styles:v.DatePickerStyles},DefaultButton:{styles:m.DefaultButtonStyles},DetailsColumn:{styles:g.DetailsColumnStyles},DetailsRow:{styles:i.DetailsRowStyles},DialogContent:{styles:y.DialogContentStyles},DialogFooter:{styles:y.DialogFooterStyles},Dropdown:{styles:b.DropdownStyles},ExpandingCard:{styles:w.ExpandingCardStyles},Facepile:{styles:E.FacepileStyles},IconButton:{styles:S.IconButtonStyles},Label:{styles:x.LabelStyles},Link:{styles:T.LinkStyles},ListPeoplePickerBase:{styles:n.BasePickerStyles},Modal:{styles:N.ModalStyles},Panel:{styles:C.PanelStyles},NormalPeoplePicker:{styles:n.BasePickerStyles},PeoplePickerItem:{styles:k.PeoplePickerItemStyles},Persona:{styles:L.PersonaStyles},Pivot:{styles:A.PivotStyles},PlainCard:{styles:w.PlainCardStyles},PrimaryButton:{styles:O.PrimaryButtonStyles},Rating:{styles:M.RatingStyles},SearchBox:{styles:_.SearchBoxStyles},Slider:{styles:D.SliderStyles},SpinButton:{styles:P.SpinButtonStyles},Spinner:{styles:H.SpinnerStyles},Suggestions:{styles:B.SuggestionsStyles},SuggestionItem:{styles:B.SuggestionItemStyles},TagItem:{styles:j.TagItemStyles},TagPicker:{styles:n.BasePickerStyles},TeachingBubble:{styles:F.TeachingBubbleStyles},TeachingBubbleContent:{styles:F.TeachingBubbleStyles},TextField:{styles:I.TextFieldStyles},Toggle:{styles:q.ToggleStyles}}});
define("@uifabric/fluent-theme/lib/fluent/styles/BasePicker.styles",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BasePickerStyles=function(e){var t=e.theme;if(!t)throw new Error("Theme is undefined or null.");var n=t.effects,r=t.palette;return{text:{borderRadius:n.roundedCorner2,borderColor:r.neutralSecondaryAlt},input:{borderRadius:n.roundedCorner2}}}});
define("@uifabric/fluent-theme/lib/fluent/styles/Checkbox.styles",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CheckboxStyles=function(e){var t=e.disabled,n=e.checked,r=e.theme,i=r.semanticColors,s=r.palette;return{checkbox:[{borderRadius:r.effects.roundedCorner2,borderColor:s.neutralPrimary},!t&&n&&{borderColor:i.inputBackgroundChecked},t&&{borderColor:s.neutralTertiaryAlt},n&&t&&{background:s.neutralTertiaryAlt,borderColor:s.neutralTertiaryAlt}],checkmark:{color:i.inputForegroundChecked},root:[!t&&[!n&&{selectors:{":hover .ms-Checkbox-text":{color:s.neutralDark},":hover .ms-Checkbox-checkmark":{color:s.neutralSecondary}}},n&&{selectors:{":hover .ms-Checkbox-checkbox":{background:s.themeDark,borderColor:s.themeDark},":focus .ms-Checkbox-checkbox":{background:s.themeDark,borderColor:s.themeDark}}}]]}}});
define("@uifabric/fluent-theme/lib/fluent/styles/ChoiceGroupOption.styles",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ChoiceGroupOptionStyles=function(e){var t=e.checked,n=e.disabled,r=e.theme,i=e.hasIcon,s=e.hasImage,o=r.semanticColors,u=r.palette;return{field:[{selectors:{":before":[{borderColor:u.neutralPrimary},n&&{backgroundColor:o.bodyBackground,borderColor:u.neutralTertiaryAlt},t&&!n&&{borderColor:o.inputBackgroundChecked},(i||s)&&n&&t&&{opacity:1}],":after":[t&&n&&{borderColor:u.neutralTertiaryAlt}],":hover":[!n&&{selectors:{".ms-ChoiceFieldLabel":{color:u.neutralDark},":before":{borderColor:t?u.themeDark:u.neutralPrimary},":after":[!i&&!s&&!t&&{content:'""',transitionProperty:"background-color",left:5,top:5,width:10,height:10,backgroundColor:u.neutralSecondary},t&&{borderColor:u.themeDark}]}}]}},(i||s)&&!n&&{selectors:{":hover":{borderColor:t?u.themeDark:u.neutralPrimary}}},(i||s)&&{borderWidth:1},n&&{selectors:{".ms-ChoiceFieldLabel":{color:u.neutralTertiary}}},t&&n&&{borderColor:u.neutralLighter}],innerField:{margin:1},choiceFieldWrapper:{selectors:{"&.is-inFocus":{selectors:{":after":{borderColor:u.neutralSecondary}}}}}}}});
define("@uifabric/fluent-theme/lib/fluent/styles/ColorPickerGridCell.styles",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ColorPickerGridCellStyles=function(e){var t,n=e.theme,r=e.selected,i=e.isWhite,s=n.palette.neutralLighter,o=n.palette.neutralLight,u=n.palette.neutralTertiary;return{colorCell:[r&&{borderColor:o},!r&&{selectors:(t={},t["&:hover, &:active, &:focus"]={borderColor:s},t)},i&&!r&&{backgroundColor:u}]}}});
define("@uifabric/fluent-theme/lib/fluent/styles/ColorPicker.styles",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ColorPickerStyles=function(e){return{input:{selectors:{"&.ms-TextField":{paddingRight:4},".ms-TextField-field":{minWidth:"auto",padding:5,textOverflow:"clip"}}},table:{selectors:{"tbody td:last-of-type .ms-ColorPicker-input":{paddingRight:0}}},tableHeader:{selectors:{td:{paddingBottom:4}}}}};t.ColorRectangleStyles=function(e){var t=e.theme,n=t.palette,r=t.effects;return{root:{border:"1px solid "+n.neutralLighter,borderRadius:r.roundedCorner2,marginBottom:8},thumb:{borderColor:n.neutralTertiary,boxShadow:r.elevation8}}};t.ColorSliderStyles=function(e){var t=e.theme,n=t.palette,r=t.effects;return{root:{borderRadius:r.roundedCorner2,marginBottom:8},sliderThumb:{borderColor:n.neutralTertiary,boxShadow:r.elevation8}}}});
define("@uifabric/fluent-theme/lib/fluent/styles/ComboBox.styles",["require","exports","../FluentType"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ComboBoxStyles=function(e){var t=e.theme;if(!t)throw new Error("Theme is undefined or null.");var r=t.effects,i=t.semanticColors,s=t.palette.neutralPrimary;return{root:{borderRadius:r.roundedCorner2,borderColor:i.inputBorder,paddingLeft:8,selectors:{"&.is-open":{borderColor:i.inputBorder}}},rootHovered:{borderColor:i.inputFocusBorderAlt,selectors:{".ms-ComboBox-Input":{color:i.inputTextHovered}}},rootFocused:{borderColor:s,selectors:{".ms-ComboBox-Input":{color:i.inputTextHovered}}},errorMessage:{fontSize:n.FontSizes.size12},callout:{borderRadius:r.roundedCorner2,border:"none",selectors:{".ms-Callout-main":{borderRadius:r.roundedCorner2}}},header:{padding:"0 8px"},optionsContainer:{selectors:{".ms-ComboBox-option":{paddingLeft:8,paddingRight:8},".is-checked":{backgroundColor:"transparent",selectors:{":hover":{backgroundColor:i.buttonBackgroundHovered,color:i.inputTextHovered},".ms-Checkbox-text":{color:i.inputTextHovered}}},".ms-Checkbox":{selectors:{":hover, :hover:active":{backgroundColor:"transparent"},".ms-Checkbox-text:hover":{color:i.inputTextHovered}}}}}}}});
define("@uifabric/fluent-theme/lib/fluent/styles/CompoundButton.styles",["require","exports","tslib","office-ui-fabric-react/lib/Styling"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CompoundButtonStyles=function(e){var t=e.theme;if(!t)throw new Error("Theme is undefined or null.");var i=t.palette,s=t.effects;return{root:n.__assign({},r.getFocusStyle(t,{inset:2}),{backgroundColor:i.white,border:"1px solid "+i.neutralSecondaryAlt,borderRadius:s.roundedCorner2,padding:"16px 12px",selectors:{"&.ms-Button--compoundPrimary":{backgroundColor:i.themePrimary,borderColor:i.themePrimary}}}),rootPressed:{backgroundColor:i.neutralQuaternaryAlt,selectors:{"&.ms-Button--compoundPrimary:active":{backgroundColor:i.themeDark}}},rootChecked:{backgroundColor:i.neutralQuaternaryAlt,selectors:{"&.ms-Button--compoundPrimary":{backgroundColor:i.themeDark,borderColor:i.themeDark}}},rootDisabled:{borderColor:i.neutralLighter,selectors:{"&.ms-Button--compoundPrimary":{backgroundColor:i.neutralLighter,borderColor:i.neutralLighter}}}}}});
define("@uifabric/fluent-theme/lib/fluent/styles/DatePicker.styles",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DatePickerStyles=function(e){var t=e.theme.effects;return{callout:{border:"none",borderRadius:t.roundedCorner2,boxShadow:t.elevation8,selectors:{".ms-Callout-main":{borderRadius:t.roundedCorner2}}}}}});
define("@uifabric/fluent-theme/lib/fluent/styles/Dropdown.styles",["require","exports","tslib","office-ui-fabric-react/lib/utilities/positioning"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DropdownStyles=function(e){var t=e.disabled,i=e.hasError,s=e.isOpen,o=e.calloutRenderEdge,u=e.theme,a=e.isRenderingPlaceholder;if(!u)throw new Error("theme is undefined or null in base Dropdown getStyles function.");var f,l,c,h=u.palette,p=u.effects,d=o===r.RectangleEdge.bottom?p.roundedCorner2+" "+p.roundedCorner2+" 0 0":"0 0 "+p.roundedCorner2+" "+p.roundedCorner2,v=o===r.RectangleEdge.bottom?"0 0 "+p.roundedCorner2+" "+p.roundedCorner2:p.roundedCorner2+" "+p.roundedCorner2+" 0 0",m={minHeight:"36px",padding:"0 8px",display:"flex",alignItems:"center"},g=function(e){void 0===e&&(e=!1);return{selectors:{"&:hover:focus":{color:h.neutralDark,backgroundColor:e?h.neutralLight:h.neutralLighter},"&:focus":{backgroundColor:e?h.neutralLight:"transparent"},"&:active":{color:h.neutralDark,backgroundColor:e?h.neutralLight:h.neutralLighter}}}};return{dropdown:[t&&{selectors:(f={},f["&:hover .ms-Dropdown-titleIsPlaceHolder"]={color:h.neutralTertiary},f["&:focus .ms-Dropdown-titleIsPlaceHolder"]={color:h.neutralTertiary},f["&:active .ms-Dropdown-titleIsPlaceHolder"]={color:h.neutralTertiary},f)},!t&&{selectors:(l={},l["&:hover .ms-Dropdown-title"]={color:h.neutralDark,borderColor:s?h.themePrimary:h.neutralPrimary},l["&:focus .ms-Dropdown-title"]={color:h.neutralDark,borderColor:s?h.themePrimary:h.neutralPrimary},l["&:active .ms-Dropdown-title"]={color:h.neutralDark,borderColor:h.themePrimary},l["&:hover .ms-Dropdown-caretDown, &:focus .ms-Dropdown-caretDown, &:active .ms-Dropdown-caretDown"]={color:h.neutralPrimary},l["&:hover .ms-Dropdown-titleIsPlaceHolder, &:focus .ms-Dropdown-titleIsPlaceHolder, &:active .ms-Dropdown-titleIsPlaceHolder"]={color:h.neutralDark},l["&:hover .ms-Dropdown-title--hasError, &:focus .ms-Dropdown-title--hasError, &:active .ms-Dropdown-title--hasError"]={borderColor:h.redDark,color:a?h.neutralSecondary:h.neutralPrimary},l)}],title:[{borderRadius:s?d:p.roundedCorner2,borderColor:h.neutralSecondaryAlt,padding:"0 28px 0 8px"},i&&{borderColor:s?h.redDark:h.red},s&&!i&&{borderColor:h.themePrimary},t&&{color:h.neutralTertiary}],caretDownWrapper:{right:8},caretDown:[t&&{color:h.neutralTertiary}],errorMessage:{color:h.redDark},callout:{border:"none",borderRadius:v,boxShadow:p.elevation8,selectors:(c={},c[".ms-Callout-main"]={borderRadius:v},c)},dropdownItemHeader:{padding:"0 8px",height:"36px",lineHeight:"36px"},dropdownItem:[m,g()],dropdownItemSelected:[{backgroundColor:h.neutralLight,color:h.neutralDark},m,g(!0)],dropdownItemDisabled:n.__assign({},m,{color:h.neutralTertiary}),dropdownItemSelectedAndDisabled:n.__assign({},m,{color:h.neutralTertiary})}}});
define("@uifabric/fluent-theme/lib/fluent/styles/HoverCard.styles",["require","exports","tslib"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){var t=e.theme.effects;return{border:"none",boxShadow:t.elevation16,borderRadius:t.roundedCorner2,selectors:{".ms-Callout-main":{borderRadius:t.roundedCorner2}}}};t.ExpandingCardStyles=function(e){return{root:n.__assign({},r(e),{width:320}),expandedCard:{selectors:{":before":{width:272}}}}};t.PlainCardStyles=function(e){return{root:n.__assign({},r(e))}}});
define("@uifabric/fluent-theme/lib/fluent/styles/IconButton.styles",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.IconButtonStyles=function(e){var t=e.theme;if(!t)throw new Error("Theme is undefined or null.");var n=t.palette;return{root:{backgroundColor:"transparent",color:n.themePrimary},rootHovered:{backgroundColor:n.neutralLighter,color:n.themeDarkAlt},rootPressed:{backgroundColor:n.neutralLight,color:n.themeDark},rootChecked:{backgroundColor:n.neutralLight,color:n.themeDark},rootDisabled:{backgroundColor:"transparent",color:n.neutralTertiary}}}});
define("@uifabric/fluent-theme/lib/fluent/styles/Modal.styles",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ModalStyles=function(e){var t=e.theme;if(!t)throw new Error("Theme is undefined or null.");var n=t.effects;return{main:{boxShadow:n.elevation64,borderRadius:n.roundedCorner2}}}});
define("@uifabric/fluent-theme/lib/fluent/styles/Panel.styles",["require","exports","../FluentType","office-ui-fabric-react/lib/Styling"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PanelStyles=function(e){return{main:{boxShadow:e.theme.effects.elevation64},headerText:{fontSize:n.FontSizes.size20,fontWeight:r.FontWeights.semibold,lineHeight:"27px"},footerInner:{paddingBottom:16,paddingTop:16}}}});
define("@uifabric/fluent-theme/lib/fluent/styles/PeoplePicker.styles",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PeoplePickerItemStyles=function(e){var t=e.selected,n=e.theme.palette;return{removeButton:[{background:"transparent",selectors:{":active":{color:n.white,backgroundColor:n.themeDark}}},!t&&{color:n.neutralPrimary},t&&{color:n.white}]}}});
define("@uifabric/fluent-theme/lib/fluent/styles/Persona.styles",["require","exports","office-ui-fabric-react/lib/Persona","../FluentType","office-ui-fabric-react/lib/Styling"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PersonaStyles=function(e){var t=n.sizeBoolean(e.size);return{primaryText:[t.isSize100&&{fontSize:r.FontSizes.size20,fontWeight:i.FontWeights.regular},t.isSize72&&{fontSize:r.FontSizes.size20},t.isSize48&&{fontSize:r.FontSizes.size16}],tertiaryText:{fontSize:r.FontSizes.size14}}}});
define("@uifabric/fluent-theme/lib/fluent/styles/SearchBox.styles",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SearchBoxStyles=function(e){var t=e.theme,n=e.hasFocus,r=e.hasInput,i=e.underlined,s=e.disabled,o=t.effects,u=t.palette,a=t.semanticColors,f=u.themeDarkAlt,l=u.neutralSecondary,c=u.neutralPrimary,h=u.neutralTertiary,p=u.neutralLighter;return{root:[{borderRadius:o.roundedCorner2,borderColor:a.inputBorder,paddingTop:0,paddingBottom:0,selectors:{":hover ":{borderColor:a.inputBorderHovered},":active":{borderColor:a.inputFocusBorderAlt}}},!n&&r&&{selectors:{".ms-SearchBox-iconContainer":{width:4},".ms-SearchBox-icon":{opacity:0}}},n&&{borderColor:a.inputFocusBorderAlt},i&&{borderRadius:0}],iconContainer:{color:s?h:f},field:{paddingLeft:6},clearButton:{padding:0,selectors:{"&:hover .ms-Button":{backgroundColor:p},"&:hover .ms-Button-icon":{color:c},".ms-Button-icon":{color:l}}}}}});
define("@uifabric/fluent-theme/lib/fluent/styles/Slider.styles",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SliderStyles=function(e){var t=e.disabled,n=e.theme.palette;return{activeSection:[t&&{background:n.neutralTertiary}]}}});
define("@uifabric/fluent-theme/lib/fluent/styles/SpinButton.styles",["require","exports","tslib"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SpinButtonStyles=function(e){var t=e.theme;if(!t)throw new Error("Theme is undefined or null.");var r=t.palette,i=t.effects,s={color:r.neutralSecondary,width:23,selectors:{":hover":{backgroundColor:r.neutralLighter,color:r.neutralSecondary},":active":{backgroundColor:r.neutralLight,color:r.neutralSecondary},".ms-Button-icon":{fontSize:8}}};return{spinButtonWrapper:{borderRadius:i.roundedCorner2,borderColor:r.neutralSecondaryAlt},input:{padding:"0 8px",width:"calc(100% - 23px)",borderRadius:i.roundedCorner2+" 0 0 "+i.roundedCorner2},arrowButtonsContainer:{selectors:{".ms-DownButton":n.__assign({},s,{borderRadius:"0 0 "+i.roundedCorner2+" 0"}),".ms-UpButton":n.__assign({},s,{borderRadius:"0 "+i.roundedCorner2+" 0 0"})}}}}});
define("@uifabric/fluent-theme/lib/fluent/styles/PickerSuggestions.styles",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SuggestionItemStyles=function(e){return{closeButton:{background:"transparent"}}};t.SuggestionsStyles=function(e){return{suggestionsContainer:{borderBottom:"none"}}}});
define("@uifabric/fluent-theme/lib/fluent/styles/TagPicker.styles",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TagItemStyles=function(e){var t=e.theme.effects;return{root:{borderRadius:t.roundedCorner2},close:{background:"transparent",borderRadius:"0 "+t.roundedCorner2+" "+t.roundedCorner2+" 0"}}}});
define("@uifabric/fluent-theme/lib/fluent/styles/Toggle.styles",["require","exports","office-ui-fabric-react/lib/Styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ToggleStyles=function(e){var t=e.disabled,r=e.checked,i=e.theme.palette;return{pill:[{width:"40px",height:"20px",borderRadius:"10px",padding:"0 3px"},!t&&[r&&{selectors:{":hover":[{backgroundColor:i.themeDark}]}},!r&&{selectors:{":hover .ms-Toggle-thumb":{backgroundColor:i.neutralDark}}}]],thumb:[{width:"12px",height:"12px",borderRadius:"12px",borderColor:"transparent"},!t&&!r&&{backgroundColor:i.neutralSecondary}],text:{selectors:{"&.ms-Toggle-stateText":{fontWeight:n.FontWeights.regular}}}}}});
define("odsp-next/actions/restore/RestoreItemsOperator",["require","exports","tslib","../../providers/operator/BaseOperator","../../providers/fileSystem/FileSystemProvider","../../models/item/ItemType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={1e3:!0,1012:!0},a=1,f=2,l=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._fileSystemProvider=n.fileSystemProvider;r._context=t;r.registerActions({overwrite:r._onOverwrite,rename:r._onRename});return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),i=t.input;n.name=i.name;n.iconName=i.iconName;n.type=r.OperationType.restoreItems;n.payloads={restoreItems:{item:i}};2===t.status&&t.error&&t.error.code in u&&i.type!==s.default.Folder&&n.actions.push(this._onOverwrite,this._onRename);return n};t.prototype.onStart=function(e){var t=this._context.items.map(function(e){return new r.Task(e.key,e)});e.update(t);return this._fileSystemProvider.restoreItems({parentKey:this._context.parentKey,retainAcls:this._context.retainAcls,items:t.map(function(e){return e.input})},e)};t.prototype._onRename=function(e,t){e=e.map(function(e){return e.restart()});t.update(e);return this._fileSystemProvider.restoreItems({parentKey:this._context.parentKey,items:e.map(function(e){return e.input}),retainAcls:this._context.retainAcls,nameConflict:f},t)};t.prototype._onOverwrite=function(e,t){e=e.map(function(e){return e.restart()});t.update(e);return this._fileSystemProvider.restoreItems({parentKey:this._context.parentKey,items:e.map(function(e){return e.input}),retainAcls:this._context.retainAcls,nameConflict:a},t)};t.dependencies=n.__assign({},r.default.dependencies,{fileSystemProvider:i.resourceKey});return t}(r.default);t.default=l;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,l)});
define("odsp-next/dataSources/itemAnalytics/store/FileHoverCardStore",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../../resources/DataSourceResourceKeys","@ms/shared-react-item-hover-card/lib/index","../../../resources/SPOResourceKeys","../../base/odb/DataRequestor"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:{itemAnalyticsDataSource:r.analytics,pageContext:s.pageContext,dataRequestorType:o.typeResourceKey},create:function(e){var t=new i.FileHoverCardStore({item:void 0},e);return{instance:t,disposable:t}}}})});
define("@ms/shared-react-item-hover-card/lib/index",["require","exports","tslib","./FileHoverCard","./itemsScopeFileHoverCard/HoverZone","./IFileHoverCardStore","./FileHoverCardStore","./AnalyticsActionBar/AnalyticsActionBar","./AnalyticsStats/AnalyticsStats","./AnalyticsActivityList/AnalyticsActivityList","./AnalyticsKeyPoints/AnalyticsKeyPointsEditor","./AnalyticsKeyPoints/AnalyticsKeyPoints","./FileHoverCardHelper","./AnalyticsKeyPoints/AnalyticsKeyPointsFeedback"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t);n.__exportStar(f,t);n.__exportStar(l,t);n.__exportStar(c,t);n.__exportStar(h,t);n.__exportStar(p,t)});
define("@ms/shared-react-item-hover-card/lib/FileHoverCard",["require","exports","tslib","react","prop-types","office-ui-fabric-react/lib/HoverCard","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/utilities/decorators/withResponsiveMode","office-ui-fabric-react/lib/common/DirectionalHint","office-ui-fabric-react/lib/Styling","./IFileHoverCardStore","./AnalyticsActivity/AnalyticsActivity","./AnalyticsActivityList/AnalyticsActivityList","./AnalyticsActionBar/AnalyticsActionBar","./AnalyticsStats/AnalyticsStats","./AnalyticsLifeCycle/AnalyticsLifeCycle","./AnalyticsKeyPoints/AnalyticsKeyPoints","./FileHoverCardHelper","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-graph/lib/services/itemAnalytics/KeyPointsHelper","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-graph/lib/services/itemAnalytics/LifecycleStatusHelper","@ms/odsp-datasources/lib/providers/theming/FluentFeatures","./UserNameHelper","@ms/odsp-utilities/lib/icons/OfficeFileNameHelper","./HoverCardExperimentHelper","@ms/odsp-utilities/lib/logging/events/Qos.event","./ErrorBoundary","./RecommendedActions/RecommendedActions","./HoverCardLoggerHelper","./FileHoverCard.resx","./FileHoverCard.module.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=340,D=340,P=E.isLifeCycleEnabled()?70:40,H=346,B=2;t.CARD_DISMISS_DELAY=300;var j=function(e){n.__extends(E,e);function E(t,n){var i=e.call(this,t,n)||this;i._hoverCardRenderQos=void 0;i._setHightAndAnalyticsResult=function(e){i.setState({itemAnalyticsResult:i._store.getItemAnalytics(e)})};i._onCardOpen=function(){A.default("FileHoverCard.CompactCardOpen",i.props.item);i._cardOpenTimeStamp=Date.now();i._compactCardElement||(i._hoverCardRenderQos=new C.Qos({name:"FileHoverCard.HoverCardRenderQos"}))};i._onCardClose=function(){i._expandedCardElement?A.default("FileHoverCard.Expanded.DwellTime",i.props.item,{time:Date.now()-i._cardOpenTimeStamp}):A.default("FileHoverCard.Compact.DwellTime",i.props.item,{time:Date.now()-i._cardOpenTimeStamp});i.props.item.appMap===T.wordType&&(i.state.itemAnalyticsResult&&i._isKeyPointsAvailable(i.state.itemAnalyticsResult.data)?A.default("FileHoverCard.KeyPoints.DwellTime",i.props.item,{time:Date.now()-i._cardOpenTimeStamp}):A.default("FileHoverCard.NoKeyPoints.DwellTime",i.props.item,{time:Date.now()-i._cardOpenTimeStamp}))};i._getCardHeight=function(){var e=i._store.getItemAnalytics(i.props.item);if(e&&e.status===l.AnalyticsResultStatus.succeed&&e.data){if(i._shouldShowActivities(e))return _;if(i._isKeyPointsAvailable(e.data))return D;if(i._isLifecycleAvailable(e.data)&&e.data.lifeCycleStatus)return P*e.data.lifeCycleStatus.length;if(e.data.isTrending)return P}return 1};i._renderExpandedCard=function(){var e=i.state.itemAnalyticsResult;return!!e&&(i._isKeyPointsAvailable(e.data)||i._shouldShowActivities(e)||i._isLifecycleAvailable(e.data)||i._isRecommendedActionsAvailable(e))};i._hoverCardQosEnd=function(e){if(i._hoverCardRenderQos){e?i._hoverCardRenderQos.end({resultType:C.ResultTypeEnum.Failure,extraData:e}):i.state.itemAnalyticsResult.status===l.AnalyticsResultStatus.succeed?i._compactCardElement||i._expandedCardElement?i._hoverCardRenderQos.end({resultType:C.ResultTypeEnum.Success}):i._hoverCardRenderQos.end({resultType:C.ResultTypeEnum.Failure}):i._hoverCardRenderQos.end({resultType:C.ResultTypeEnum.Success});i._hoverCardRenderQos=void 0}};i._onRenderCompactContent=function(){var e,t=i.props,n=t.itemTitle,s=t.currentUserActivity,u=t.actionBarItems,a=t.isViewCountClickable,f=t.onRenderFileTypeIcon,l=d.getFileHoverCardStrings(),h=i.state.itemAnalyticsResult,v=S.isFluentActiveOD||S.isHoverCardFluentActive?void 0:r.createElement("div",{className:M.fileHoverCardCompactCardActivity,id:"ms-FileHoverCard-compactCard--latestActivity"},r.createElement(c.AnalyticsActivity,{activity:s,loginUserEmail:i.props.loginUserEmail,userEmail:i.props.userEmail})),m=r.createElement("div",{className:o.css(M.fileHoverCardCompactCardTitle,(e={},e[M.titleNotExpanded]=!i._expandedCardElement,e)),id:"ms-FileHoverCard-title","aria-label":w.format(O.default.hoverCardTitle,n)},n),g=S.isFluentActiveOD||S.isHoverCardFluentActive?r.createElement("div",{className:M.fileHoverCardCompactCardTitleRegion},r.createElement("div",{className:M.fileHoverCardCompactCardFileIcon},f&&f()),m):m;return r.createElement("div",{ref:i._onCompactCardRef,className:o.css(M.fileHoverCardCompactCard,{isFluent:S.isFluentActiveOD||S.isHoverCardFluentActive}),"aria-labelledby":"ms-FileHoverCard-title ms-FileHoverCard-compactCard--latestActivity"},g,v,r.createElement(p.AnalyticsActionBar,{analyticsStats:{itemAnalytics:h&&h.data,onClick:i._onView,onLikeClick:i._onLikeClick,pageUrl:i.props.pageUrl,disableViewerCount:a,status:h&&h.status,isNotSupported:!1},items:u||[],showActionBar:u&&u.length>0,isLink:a,farItems:[{key:"details",title:l.details,name:l.details,ariaLabel:l.details,onClick:i._onDetails}]}))};i._onRenderExpandedContent=function(){var e=i.state.itemAnalyticsResult,t=i.state.itemAnalyticsResult,n=t.data,s=t.skipToken,u=i._isKeyPointsAvailable(n),a=i._shouldShowActivities(e),f=i._isRecommendedActionsAvailable(e);return r.createElement("div",{className:o.css(M.fileHoverCardExpandedCard,{isFluent:S.isFluentActiveOD||S.isHoverCardFluentActive}),ref:i._onExpandedCardRef},!!(n&&n.lifeCycleStatus&&i._isLifecycleAvailable(n))&&n.lifeCycleStatus.slice(0,B).map(function(e){return i._getAnalyticsLifeCycle(e)}),(u||a||f)&&r.createElement("div",{className:M.fileHoverCardExpandedCardScrollableSection},u&&n&&n.keyPointsData&&r.createElement(m.AnalyticsKeyPoints,{item:i.props.item,keyPointsData:n.keyPointsData,onKeyPointsClick:i.props.onKeyPointsClick,onSendFeedbackClick:i.props.onSendFeedbackClick}),f&&e.actions&&r.createElement(L.RecommendedActions,{ref:i._onRecommendedActionsRef,item:i.props.item,actions:e.actions,loginUserEmail:i.props.loginUserEmail,userEmail:i.props.userEmail,pageUrl:i.props.pageUrl,onShareWith:i.props.onShareWith,onDismiss:i._onDismiss,onRenderShareWithPeople:i.props.onRenderShareWithPeople}),a&&n&&r.createElement("div",{className:M.fileHoverCardActivitiesSection},r.createElement(h.AnalyticsActivityList,{itemAnalytics:n,moreActivities:!!s,onLoadMoreActivities:function(){return i._store.fetchItemAnalytics(i.props.item,s)},loginUserEmail:i.props.loginUserEmail,userEmail:i.props.userEmail}))))};i._onDismiss=function(e,t){var n=i.props,r=n.item,s=n.itemTitle,o=n.uniqueId;i._store.dismissRecommendedAction(r,s,e,o,t)};i._shouldShowActivities=function(e){var t=e&&e.data&&e.data.activities,n=i.props,r=n.isViewCountClickable,s=n.loginUserEmail,o=n.userEmail;return Boolean(r&&t&&(t.length>1||1===t.length&&!x.isCurrentLoginUser(t[0].actor.user.email,s,o)))};i._onCompactCardRef=function(e){if(e){i._compactCardElement=e;i._store.fetchItemAnalytics(i.props.item)}};i._onExpandedCardRef=function(e){if(e){i._expandedCardElement=e;A.default("FileHoverCard.ExpandedCardOpen",i.props.item,{time:Date.now()-i._cardOpenTimeStamp})}};i._onRecommendedActionsRef=function(e){if(e){var t=i.state.itemAnalyticsResult.actions;A.default("FileHoverCard.RecommendedActions.Render",i.props.item,{activityType:t&&t.recommendedActions&&t.recommendedActions.length>0?"HighActivities":"LowActivities"})}};i._onView=function(e){y.Engagement.logData({name:"FileHoverCard.ViewCountClick"});i.props.onView(e,i.props);e.stopPropagation();e.preventDefault()};i._onLikeClick=function(){y.Engagement.logData({name:"FileHoverCard.LikeClick"})};i._onDetails=function(e){if(e){y.Engagement.logData({name:"FileHoverCard.SeeDetailsClick"});i.props.onDetails(e,i.props);e.stopPropagation();e.preventDefault()}};i._cleanCachedItem=function(){i._store.cleanCachedItem(i.props.item)};i._updateExpandedHeight=function(){var e=i._compactCardElement.clientHeight+i._expandedCardElement.clientHeight,t=i.state.itemAnalyticsResult&&(i._isKeyPointsAvailable(i.state.itemAnalyticsResult.data)||i._shouldShowActivities(i.state.itemAnalyticsResult));e<H&&t&&i.state.expandedCardHeight!==H-i._compactCardElement.clientHeight?i.setState({expandedCardHeight:H-i._compactCardElement.clientHeight}):e>H&&i.state.expandedCardHeight!==i._expandedCardElement.clientHeight?i.setState({expandedCardHeight:i._expandedCardElement.clientHeight}):e<H&&!t&&i.state.expandedCardHeight!==i._expandedCardElement.clientHeight&&i.setState({expandedCardHeight:i._expandedCardElement.clientHeight})};i._store=n.fileHoverCardStore;i._cardOpenTimeStamp=0;i.state={itemAnalyticsResult:i._store.getItemAnalytics(i.props.item),expandedCardHeight:i._getCardHeight(),compactCardHeight:S.isFluentActiveOD||S.isHoverCardFluentActive?125:176};return i}E.prototype.UNSAFE_componentWillReceiveProps=function(e){e.item!==this.props.item&&this._setHightAndAnalyticsResult(e.item)};E.prototype.componentDidUpdate=function(){this._expandedCardElement&&this._expandedCardElement.clientHeight&&this._updateExpandedHeight();this._compactCardElement&&0!==this._compactCardElement.clientHeight&&this.state.compactCardHeight!==this._compactCardElement.clientHeight&&this.setState({compactCardHeight:this._compactCardElement.clientHeight});this.state.itemAnalyticsResult&&this._hoverCardQosEnd()};E.prototype.componentDidMount=function(){var e=this,t=this.props.item,n=this._store;this._storeListener=n.addListener(function(){e._setHightAndAnalyticsResult(t)},t)};E.prototype.componentWillUnmount=function(){this._store.removeListener(this._storeListener,this.props.item);this._store.cleanCachedItem(this.props.item)};E.prototype.render=function(){var e=this.props,t=e.responsiveMode,i=e.cardDismissDelay,o=e.directionalHint,a=e.gapSpace,l=e.target,c=e.children,h=this.state,p=h.expandedCardHeight,d=h.compactCardHeight,v={expandedCardScroll:M.fileHoverCardExpandedCardHostScroll},m=S.isFluentActiveOD||S.isHoverCardFluentActive?n.__assign({root:{boxShadow:f.getTheme().effects.elevation16,borderRadius:"2px",width:"320px",selectors:{".ms-Callout-main":{borderRadius:"2px"}}},expandedCard:[{selectors:{":before":{display:"none"}}}]},v):v,g={onRenderCompactCard:this._onRenderCompactContent,onRenderExpandedCard:this._renderExpandedCard()?this._onRenderExpandedContent:void 0,compactCardHeight:d,expandedCardHeight:p,directionalHint:o,directionalHintFixed:!1,gapSpace:a,styles:m};return t&&t>u.ResponsiveMode.medium?r.createElement(k.ErrorBoundary,{qosEvent:this._hoverCardQosEnd},r.createElement(s.HoverCard,{expandingCardProps:g,expandedCardOpenDelay:500,cardDismissDelay:i,target:l,onCardVisible:this._onCardOpen,onCardHide:this._onCardClose,trapFocus:!0})):r.createElement("div",null," ",c," ")};E.prototype._isKeyPointsAvailable=function(e){var t=e&&e.keyPointsData,n=Boolean(t&&t.keyPoints&&t.keyPoints.length>0),r=Boolean(t&&t.readTime&&t.readTime.minutes);return b.isKeyPointsEnabled()&&N.isKeyPointsExperimentOn()&&(n||r)};E.prototype._isLifecycleAvailable=function(e){var t=e&&e.lifeCycleStatus;return!!(t&&t.length>0)};E.prototype._isRecommendedActionsAvailable=function(e){return g.isRecommendedActionsEnabled()&&Boolean(e&&e.actions)&&g.isRecommendedActionsSupported(this.props.item.appMap,this.props.item.extension)};E.prototype._getAnalyticsLifeCycle=function(e){return r.createElement(v.AnalyticsLifeCycle,{key:e.createdRelativeTime,lifeCycleStatus:e,loginUserEmail:this.props.loginUserEmail,userEmail:this.props.userEmail,onViewPolicyTip:this.props.onViewPolicyTip,onAddMetadataNow:this.props.onAddMetadataNow,onCheckIn:this.props.onCheckIn,onDiscardCheckOut:this.props.onDiscardCheckOut,cleanCachedItem:this._cleanCachedItem})};E.contextTypes={fileHoverCardStore:i.object.isRequired};E.defaultProps={directionalHint:a.DirectionalHint.rightTopEdge,cardDismissDelay:t.CARD_DISMISS_DELAY,gapSpace:0};return E=n.__decorate([u.withResponsiveMode],E)}(o.BaseComponent);t.FileHoverCard=j});
define("office-ui-fabric-react/lib/HoverCard",["require","exports","tslib","./components/HoverCard/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("office-ui-fabric-react/lib/components/HoverCard/index",["require","exports","tslib","./HoverCard","./HoverCard.base","./HoverCard.types","./ExpandingCard","./ExpandingCard.base","./ExpandingCard.types","./PlainCard/PlainCard","./PlainCard/PlainCard.base","../../common/DirectionalHint"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t);n.__exportStar(f,t);n.__exportStar(l,t);n.__exportStar(c,t)});
define("office-ui-fabric-react/lib/components/HoverCard/HoverCard",["require","exports","../../Utilities","./HoverCard.styles","./HoverCard.base"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.HoverCard=n.styled(i.HoverCardBase,r.getStyles,void 0,{scope:"HoverCard"})});
define("office-ui-fabric-react/lib/components/HoverCard/HoverCard.styles",["require","exports","../../Styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={host:"ms-HoverCard-host"};t.getStyles=function(e){var t=e.className,i=e.theme;return{host:[n.getGlobalClassNames(r,i).host,t]}}});
define("office-ui-fabric-react/lib/components/HoverCard/HoverCard.base",["require","exports","tslib","react","../../Utilities","./HoverCard.types","./ExpandingCard","./ExpandingCard.types","./PlainCard/PlainCard"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=i.classNamesFunction(),l=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._hoverCard=i.createRef();n.dismiss=function(e){n._async.clearTimeout(n._openTimerId);n._async.clearTimeout(n._dismissTimerId);e?n._dismissTimerId=n._async.setTimeout(function(){n._setDismissedState()},n.props.cardDismissDelay):n._setDismissedState()};n._cardOpen=function(e){if(!(n._shouldBlockHoverCard()||"keydown"===e.type&&e.which!==n.props.openHotKey)){n._async.clearTimeout(n._dismissTimerId);"mouseenter"===e.type&&(n._currentMouseTarget=e.currentTarget);n._executeCardOpen(e)}};n._executeCardOpen=function(e){n._async.clearTimeout(n._openTimerId);n._openTimerId=n._async.setTimeout(function(){n.setState(function(t){return t.isHoverCardVisible?t:{isHoverCardVisible:!0,mode:u.ExpandingCardMode.compact,openMode:"keydown"===e.type?s.OpenCardMode.hotKey:s.OpenCardMode.hover}})},n.props.cardOpenDelay)};n._cardDismiss=function(e,t){if(e){if(!(t instanceof MouseEvent))return;if("keydown"===t.type&&t.which!==i.KeyCodes.escape)return;n.props.sticky||n._currentMouseTarget!==t.currentTarget&&t.which!==i.KeyCodes.escape||n.dismiss(!0)}else{if(n.props.sticky&&!(t instanceof MouseEvent)&&t.nativeEvent instanceof MouseEvent&&"mouseleave"===t.type)return;n.dismiss(!0)}};n._setDismissedState=function(){n.setState({isHoverCardVisible:!1,mode:u.ExpandingCardMode.compact,openMode:s.OpenCardMode.hover})};n._instantOpenAsExpanded=function(e){n._async.clearTimeout(n._dismissTimerId);n.setState(function(e){return e.isHoverCardVisible?e:{isHoverCardVisible:!0,mode:u.ExpandingCardMode.expanded}})};n._setEventListeners=function(){var e=n.props,t=e.trapFocus,r=e.instantOpenOnClick,i=e.eventListenerTarget,s=i?n._getTargetElement(i):n._getTargetElement(n.props.target),o=n._nativeDismissEvent;if(s){n._events.on(s,"mouseenter",n._cardOpen);n._events.on(s,"mouseleave",o);if(t)n._events.on(s,"keydown",n._cardOpen);else{n._events.on(s,"focus",n._cardOpen);n._events.on(s,"blur",o)}if(r)n._events.on(s,"click",n._instantOpenAsExpanded);else{n._events.on(s,"mousedown",o);n._events.on(s,"keydown",o)}}};n._nativeDismissEvent=n._cardDismiss.bind(n,!0);n._childDismissEvent=n._cardDismiss.bind(n,!1);n.state={isHoverCardVisible:!1,mode:u.ExpandingCardMode.compact,openMode:s.OpenCardMode.hover};return n}t.prototype.componentDidMount=function(){this._setEventListeners()};t.prototype.componentDidUpdate=function(e,t){var n=this;if(e.target!==this.props.target){this._events.off();this._setEventListeners()}if(t.isHoverCardVisible!==this.state.isHoverCardVisible)if(this.state.isHoverCardVisible){this._async.setTimeout(function(){n.setState({mode:u.ExpandingCardMode.expanded},function(){n.props.onCardExpand&&n.props.onCardExpand()})},this.props.expandedCardOpenDelay);this.props.onCardVisible&&this.props.onCardVisible()}else{this.setState({mode:u.ExpandingCardMode.compact});this.props.onCardHide&&this.props.onCardHide()}};t.prototype.render=function(){var e=this.props,t=e.expandingCardProps,u=e.children,l=e.id,c=e.setAriaDescribedBy,h=void 0===c||c,p=e.styles,d=e.theme,v=e.className,m=e.type,g=e.plainCardProps,y=e.trapFocus,b=e.setInitialFocus,w=this.state,E=w.isHoverCardVisible,S=w.mode,x=w.openMode,T=l||i.getId("hoverCard");this._classNames=f(p,{theme:d,className:v});var N=n.__assign({},i.getNativeProps(this.props,i.divProperties),{id:T,trapFocus:!!y,firstFocus:b||x===s.OpenCardMode.hotKey,targetElement:this._getTargetElement(this.props.target),onEnter:this._cardOpen,onLeave:this._childDismissEvent}),C=n.__assign({},t,N,{mode:S}),k=n.__assign({},g,N);return r.createElement("div",{className:this._classNames.host,ref:this._hoverCard,"aria-describedby":h&&E?T:void 0,"data-is-focusable":!Boolean(this.props.target)},u,E&&(m===s.HoverCardType.expanding?r.createElement(o.ExpandingCard,n.__assign({},C)):r.createElement(a.PlainCard,n.__assign({},k))))};t.prototype._getTargetElement=function(e){switch(typeof e){case"string":return i.getDocument().querySelector(e);case"object":return e;default:return this._hoverCard.current||void 0}};t.prototype._shouldBlockHoverCard=function(){return!(!this.props.shouldBlockHoverCard||!this.props.shouldBlockHoverCard())};t.defaultProps={cardOpenDelay:500,cardDismissDelay:100,expandedCardOpenDelay:1500,instantOpenOnClick:!1,setInitialFocus:!1,openHotKey:i.KeyCodes.c,type:s.HoverCardType.expanding};return t}(i.BaseComponent);t.HoverCardBase=l});
define("office-ui-fabric-react/lib/components/HoverCard/HoverCard.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.hover=0]="hover";e[e.hotKey=1]="hotKey"}(t.OpenCardMode||(t.OpenCardMode={}));!function(e){e.plain="PlainCard";e.expanding="ExpandingCard"}(t.HoverCardType||(t.HoverCardType={}))});
define("office-ui-fabric-react/lib/components/HoverCard/ExpandingCard",["require","exports","../../Utilities","./ExpandingCard.styles","./ExpandingCard.base"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ExpandingCard=n.styled(i.ExpandingCardBase,r.getStyles,void 0,{scope:"ExpandingCard"})});
define("office-ui-fabric-react/lib/components/HoverCard/ExpandingCard.styles",["require","exports","../../Styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={root:"ms-ExpandingCard-root",compactCard:"ms-ExpandingCard-compactCard",expandedCard:"ms-ExpandingCard-expandedCard",expandedCardScroll:"ms-ExpandingCard-expandedCardScrollRegion"};t.getStyles=function(e){var t,i=e.theme,s=e.needsScroll,o=e.expandedCardFirstFrameRendered,u=e.compactCardHeight,a=e.expandedCardHeight,f=e.className,l=i.palette,c=n.getGlobalClassNames(r,i);return{root:[c.root,{width:"340px",pointerEvents:"none",boxShadow:"0 0 20px rgba(0, 0, 0, .2)",border:"none",selectors:(t={},t[n.HighContrastSelector]={border:"1px solid WindowText"},t)},f],compactCard:[c.compactCard,{pointerEvents:"auto",position:"relative",height:u}],expandedCard:[c.expandedCard,{height:"1px",overflowY:"hidden",pointerEvents:"auto",transition:"height 0.467s cubic-bezier(0.5, 0, 0, 1)",selectors:{":before":{content:'""',position:"relative",display:"block",top:"0",left:"24px",width:"292px",height:"1px",backgroundColor:l.neutralLighter}}},o&&{height:a}],expandedCardScroll:[c.expandedCardScroll,s&&{height:"100%",boxSizing:"border-box",overflowY:"auto"}]}}});
define("office-ui-fabric-react/lib/components/HoverCard/ExpandingCard.base",["require","exports","tslib","react","../../Utilities","./ExpandingCard.types","./CardCallout/CardCallout"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i.classNamesFunction(),a=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._expandedElem=r.createRef();n._onKeyDown=function(e){e.which===i.KeyCodes.escape&&n.props.onLeave&&n.props.onLeave(e)};n._onRenderCompactCard=function(){return r.createElement("div",{className:n._classNames.compactCard},n.props.onRenderCompactCard(n.props.renderData))};n._onRenderExpandedCard=function(){!n.state.firstFrameRendered&&n._async.requestAnimationFrame(function(){n.setState({firstFrameRendered:!0})});return r.createElement("div",{className:n._classNames.expandedCard,ref:n._expandedElem},r.createElement("div",{className:n._classNames.expandedCardScroll},n.props.onRenderExpandedCard&&n.props.onRenderExpandedCard(n.props.renderData)))};n._checkNeedsScroll=function(){var e=n.props.expandedCardHeight;n._async.requestAnimationFrame(function(){n._expandedElem.current&&n._expandedElem.current.scrollHeight>=e&&n.setState({needsScroll:!0})})};n.state={firstFrameRendered:!1,needsScroll:!1};return n}t.prototype.componentDidMount=function(){this._checkNeedsScroll()};t.prototype.componentWillUnmount=function(){this._async.dispose()};t.prototype.render=function(){var e=this.props,t=e.styles,i=e.compactCardHeight,a=e.expandedCardHeight,f=e.theme,l=e.mode,c=e.className,h=this.state,p=h.needsScroll,d=h.firstFrameRendered,v=i+a;this._classNames=u(t,{theme:f,compactCardHeight:i,className:c,expandedCardHeight:a,needsScroll:p,expandedCardFirstFrameRendered:l===s.ExpandingCardMode.expanded&&d});var m=r.createElement("div",{onMouseEnter:this.props.onEnter,onMouseLeave:this.props.onLeave,onKeyDown:this._onKeyDown},this._onRenderCompactCard(),this._onRenderExpandedCard());return r.createElement(o.CardCallout,n.__assign({},this.props,{content:m,finalHeight:v,className:this._classNames.root}))};t.defaultProps={compactCardHeight:156,expandedCardHeight:384,directionalHintFixed:!0};return t}(i.BaseComponent);t.ExpandingCardBase=a});
define("office-ui-fabric-react/lib/components/HoverCard/ExpandingCard.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.compact=0]="compact";e[e.expanded=1]="expanded"}(t.ExpandingCardMode||(t.ExpandingCardMode={}))});
define("office-ui-fabric-react/lib/components/HoverCard/CardCallout/CardCallout",["require","exports","tslib","react","../../../Utilities","../../../Callout","../../../common/DirectionalHint","../../../Callout"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CardCallout=function(e){var t=e.gapSpace,a=void 0===t?0:t,f=e.directionalHint,l=void 0===f?o.DirectionalHint.bottomLeftEdge:f,c=e.directionalHintFixed,h=e.targetElement,p=e.firstFocus,d=e.trapFocus,v=e.onLeave,m=e.className,g=e.finalHeight,y=e.content,b=n.__assign({},i.getNativeProps(e,i.divProperties),{className:m,target:h,isBeakVisible:!1,directionalHint:l,directionalHintFixed:c,finalHeight:g,minPagePadding:24,onDismiss:v,gapSpace:a});return r.createElement(r.Fragment,null,d?r.createElement(u.FocusTrapCallout,n.__assign({},b,{focusTrapProps:{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,disableFirstFocus:!p}}),y):r.createElement(s.Callout,n.__assign({},b),y))}});
define("office-ui-fabric-react/lib/components/HoverCard/PlainCard/PlainCard",["require","exports","../../../Utilities","./PlainCard.styles","./PlainCard.base"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PlainCard=n.styled(i.PlainCardBase,r.getStyles,void 0,{scope:"PlainCard"})});
define("office-ui-fabric-react/lib/components/HoverCard/PlainCard/PlainCard.styles",["require","exports","../../../Styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={root:"ms-PlainCard-root"};t.getStyles=function(e){var t,i=e.theme,s=e.className;return{root:[n.getGlobalClassNames(r,i).root,{pointerEvents:"auto",boxShadow:"0 0 20px rgba(0, 0, 0, .2)",border:"none",selectors:(t={},t[n.HighContrastSelector]={border:"1px solid WindowText"},t)},s]}}});
define("office-ui-fabric-react/lib/components/HoverCard/PlainCard/PlainCard.base",["require","exports","tslib","react","../../../Utilities","../CardCallout/CardCallout"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.classNamesFunction(),u=function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onKeyDown=function(e){e.which===i.KeyCodes.escape&&t.props.onLeave&&t.props.onLeave(e)};return t}t.prototype.render=function(){var e=this.props,t=e.styles,i=e.theme,u=e.className;this._classNames=o(t,{theme:i,className:u});var a=r.createElement("div",{onMouseEnter:this.props.onEnter,onMouseLeave:this.props.onLeave,onKeyDown:this._onKeyDown},this.props.onRenderPlainCard(this.props.renderData));return r.createElement(s.CardCallout,n.__assign({},this.props,{content:a,className:this._classNames.root}))};return t}(i.BaseComponent);t.PlainCardBase=u});
define("@ms/shared-react-item-hover-card/lib/IFileHoverCardStore",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.succeed=0]="succeed";e[e.unsupport=1]="unsupport";e[e.failed=2]="failed"}(t.AnalyticsResultStatus||(t.AnalyticsResultStatus={}))});
define("@ms/shared-react-item-hover-card/lib/AnalyticsActivity/AnalyticsActivity",["require","exports","react","office-ui-fabric-react/lib/components/ActivityItem/index","office-ui-fabric-react/lib/components/Persona/index","@ms/odsp-utilities/lib/string/StringHelper","../AnalyticsStats/AnalyticsStats","../FileHoverCard.resx","@ms/odsp-datasources/lib/providers/theming/FluentFeatures","../UserNameHelper","./AnalyticsActivity.module.scss"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AnalyticsActivity=function(e){var t=e.activity,c=e.loginUserEmail,h=e.userEmail,p=o.getFileHoverCardStrings(),d="";"Access"===t.activityType?d=p.accessActivity:"Modified"===t.activityType&&(d=p.modifiedActivity);var v=t&&t.actor&&t.actor.user,m=f.isCurrentLoginUser(v&&v.email,c,h)?p.loginUserYou:v&&v.displayName||v&&v.email||u.default.guest,g=n.createElement("div",{className:l.analyticsActivityUserName},m),y=n.createElement("div",{className:l.analyticsActivityUserAction},d),b=p.activityTemplate&&s.formatToArray(p.activityTemplate,g,y),w=a.isFluentActiveOD||a.isHoverCardFluentActive?{root:{alignItems:"center"},activityContent:{padding:"0 12px"},personaContainer:{width:"24px",height:"24px"}}:void 0,E=a.isFluentActiveOD||a.isHoverCardFluentActive?i.PersonaSize.size24:void 0;return n.createElement(r.ActivityItem,{activityPersonas:[{imageUrl:v.image,imageAlt:m,imageInitials:e.imageInitials,initialsColor:e.initialsColor,size:E}],activityDescription:n.createElement("div",{dir:"auto",className:l.analyticsActivity},b),timeStamp:t.activityDateTime,styles:w})}});
define("office-ui-fabric-react/lib/components/ActivityItem/index",["require","exports","tslib","./ActivityItem"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/shared-react-item-hover-card/lib/AnalyticsStats/AnalyticsStats",["require","exports","react","office-ui-fabric-react/lib/Link","office-ui-fabric-react/lib/components/ActivityItem/index","../IFileHoverCardStore","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Styling","../FileHoverCard.resx","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/Tooltip","@ms/odsp-graph/lib/services/itemAnalytics/LikeCommentHelper","./AnalyticsStats.module.scss","@ms/items-view/lib/private/components/fileHoverCard/hoverCardStats/SocialBarLikeLink"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=new Date("0001-01-01T00:00:00-08:00");t.AnalyticsStats=function(e){var t,y=e.itemAnalytics,b=e.onClick,w=e.onLikeClick,E=e.pageUrl,S=e.isLink,x=e.status,T=e.isCompact,N=e.disableViewerCount,C=void 0===N||N,k=e.ODBOptOutViewerList,L=void 0!==k&&k,A=e.itemKey,O=g();if(x===s.AnalyticsResultStatus.failed){var M=u.getTheme();t=O.apiError&&m("ErrorBadge",O.apiError,{color:M.palette.redDark})}if(t)return null;if(!y||!y.viewCount||!y.viewerCount)return n.createElement(i.ActivityItem,{className:h.analyticsStats,isCompact:!0});var _=y.viewCount,D=y.viewerCount,P=y.activities,H=y.commentCount,B=y.likeCount,j=y.incompleteData&&y.incompleteData.missingDataBeforeDateTime&&new Date(y.incompleteData.missingDataBeforeDateTime).getTime()!==d.getTime(),F=y.incompleteData&&y.incompleteData.wasThrottled,I=j?a.default.inCompleteMessage:F?a.default.throttledStateMessage:"",q=C?L?a.default.odbTeachingMessage:"":a.default.spoTeachingMessage,R=I||q,U=_>1?O.views:O.view,z=D>1?O.viewers:O.viewer,W=H&&H>1?O.comments:O.comment,X=B&&B>1?O.likes:O.like,V=H?""+f.format(W,H):"",$=B?""+f.format(X,B):"",J=c.isLikePanelEnabled()?w:void 0,K=c.isCommentLinkEnabled()?E:void 0,Q=$&&v($,J),G=V&&v(V,void 0,K);return T?S?n.createElement("div",{className:h.analyticsStatsContainer},n.createElement(r.Link,{className:h.analyticsStatsLink,onClick:b},n.createElement(i.ActivityItem,{activityPersonas:P&&0!==P.length?P.slice(0,3).map(function(e){return{imageUrl:e&&e.actor&&e.actor.user&&e.actor.user.image}}).reverse():void 0,activityDescription:n.createElement("div",{className:h.analyticsStatsLabel},_&&n.createElement("div",{className:h.analyticsStatsCount},_+" "+U)),isCompact:!0})),$&&A?n.createElement(p.SocialBarLikeLink,{likeLabel:$,itemKey:A}):Q,G):n.createElement("div",{className:h.analyticsStatsViewsNoLink},_+" "+U,n.createElement("span",{className:h.analyticsStatsViewsDividerNoDot}),D+" "+z,R&&n.createElement(l.TooltipHost,{content:R,directionalHint:l.DirectionalHint.bottomCenter},n.createElement(o.Icon,{className:h.analyticsStatsTeachingMessage,iconName:"Info","aria-describedby":R}))):n.createElement("div",{className:h.analyticsStatsViews},D+" "+z,n.createElement("span",{className:h.analyticsStatsViewsDivider}),_+" "+U,I&&n.createElement(l.TooltipHost,{content:I,directionalHint:l.DirectionalHint.bottomCenter},n.createElement(o.Icon,{className:h.analyticsStatsInfo,iconName:"Info","aria-describedby":I})))};t.AnalyticsStats.defaultProps={isLink:!1};function v(e,t,s){var o=n.createElement(i.ActivityItem,{activityDescription:n.createElement("div",{className:h.analyticsStatsLabel},n.createElement("div",{className:h.analyticsStatsCount},e)),isCompact:!0});return t||s?n.createElement(r.Link,{className:h.analyticsStatsLink,href:s+"#comments",target:"_blank",onClick:t},o):n.createElement("div",{className:h.analyticsStatsNoLink},o)}function m(e,t,r){return n.createElement(n.Fragment,null,n.createElement(o.Icon,{iconName:e,className:h.fileHoverCardErrorIcon,styles:{root:u.mergeStyles([{paddingRight:"8px",position:"relative"},r])}}),t)}t.getMessageSection=m;function g(){return{details:a.default.seeDetails,viewer:a.default.viewer,viewers:a.default.viewers,view:a.default.view,views:a.default.views,comment:a.default.pageComment,comments:a.default.pageComments,like:a.default.pageLike,likes:a.default.pageLikes,apiError:a.default.apiError,suggestion:a.default.suggestion,unsupportMessage:a.default.unsupportMessage,accessActivity:a.default.accessActivity,modifiedActivity:a.default.modifiedActivity,activityTemplate:a.default.activityTemplate,inCompleteDataMessage:a.default.inCompleteDataMessage,throttledMessage:a.default.throttledMessage,trendingItem:a.default.trendingItem,loginUserYou:a.default.you}}t.getFileHoverCardStrings=g});
define("@ms/odsp-graph/lib/services/itemAnalytics/LikeCommentHelper",["require","exports","@ms/odsp-utilities/lib/features/Features"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={ODB:1305},i={ODB:1306};t.isCommentLinkEnabled=function(){return n.default.isFeatureEnabled(r)};t.isLikePanelEnabled=function(){return n.default.isFeatureEnabled(i)}});
define("@ms/shared-react-item-hover-card/lib/AnalyticsStats/AnalyticsStats.module.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".analyticsStatsContainer_4d6a10fd{display:-webkit-box;display:-ms-flexbox;display:flex;max-width:250px}.analyticsStats_4d6a10fd,.analyticsStatsNoLink_4d6a10fd,.analyticsStatsLink_4d6a10fd{padding:8px 8px 4px 0}.isFluent .analyticsStats_4d6a10fd,.isFluent .analyticsStatsNoLink_4d6a10fd,.isFluent .analyticsStatsLink_4d6a10fd{padding:0 8px 0 0}.analyticsStats_4d6a10fd .ms-Link,.analyticsStatsNoLink_4d6a10fd .ms-Link,.analyticsStatsLink_4d6a10fd .ms-Link{font-size:12px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}html[dir='ltr'] .analyticsStats_4d6a10fd .ms-ActivityItem-activityTypeIcon,html[dir='ltr'] .analyticsStatsNoLink_4d6a10fd .ms-ActivityItem-activityTypeIcon,html[dir='ltr'] .analyticsStatsLink_4d6a10fd .ms-ActivityItem-activityTypeIcon{padding-right:5px}html[dir='rtl'] .analyticsStats_4d6a10fd .ms-ActivityItem-activityTypeIcon,html[dir='rtl'] .analyticsStatsNoLink_4d6a10fd .ms-ActivityItem-activityTypeIcon,html[dir='rtl'] .analyticsStatsLink_4d6a10fd .ms-ActivityItem-activityTypeIcon{padding-left:5px}.isFluent .analyticsStats_4d6a10fd .ms-ActivityItem-activityTypeIcon,.isFluent .analyticsStatsNoLink_4d6a10fd .ms-ActivityItem-activityTypeIcon,.isFluent .analyticsStatsLink_4d6a10fd .ms-ActivityItem-activityTypeIcon{margin-top:0}.analyticsStats_4d6a10fd .ms-ActivityItem-activityContent,.analyticsStatsNoLink_4d6a10fd .ms-ActivityItem-activityContent,.analyticsStatsLink_4d6a10fd .ms-ActivityItem-activityContent{-ms-flex-preferred-size:auto;flex-basis:auto;font-weight:600}html[dir='ltr'] .analyticsStats_4d6a10fd .ms-ActivityItem-activityContent,html[dir='ltr'] .analyticsStatsNoLink_4d6a10fd .ms-ActivityItem-activityContent,html[dir='ltr'] .analyticsStatsLink_4d6a10fd .ms-ActivityItem-activityContent{padding-left:0}html[dir='rtl'] .analyticsStats_4d6a10fd .ms-ActivityItem-activityContent,html[dir='rtl'] .analyticsStatsNoLink_4d6a10fd .ms-ActivityItem-activityContent,html[dir='rtl'] .analyticsStatsLink_4d6a10fd .ms-ActivityItem-activityContent{padding-right:0}.isFluent .analyticsStats_4d6a10fd .ms-ActivityItem-activityContent,.isFluent .analyticsStatsNoLink_4d6a10fd .ms-ActivityItem-activityContent,.isFluent .analyticsStatsLink_4d6a10fd .ms-ActivityItem-activityContent{font-weight:400}.analyticsStatsLink_4d6a10fd :hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.analyticsStatsNoLink_4d6a10fd{-ms-flex-item-align:center;align-self:center}.analyticsStatsViewsNoLink_4d6a10fd{padding:8px 0 4px;font-weight:400;font-size:12px}.isFluent .analyticsStatsViewsNoLink_4d6a10fd{padding:0}.analyticsStatsViews_4d6a10fd{padding-bottom:8px}.isFluent .analyticsStatsViews_4d6a10fd{font-size:14px;font-weight:600}.analyticsStatsViewsDivider_4d6a10fd:before{content:' \\B7  '}.analyticsStatsViewsDividerNoDot_4d6a10fd:before{content:'   ';padding:0px 4px}.analyticsStatsErrorMessage_4d6a10fd{font-size:12px;font-weight:400;line-height:28px}.fileHoverCardErrorIcon_4d6a10fd{vertical-align:bottom}.analyticsStatsTeachingMessage_4d6a10fd,.analyticsStatsInfo_4d6a10fd{vertical-align:sub;padding:0px 8px}.isFluent .analyticsStatsInfo_4d6a10fd{font-size:12px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.analyticsStatsLabel_4d6a10fd{display:-webkit-box;display:-ms-flexbox;display:flex}html[dir='ltr'] .analyticsStatsCount_4d6a10fd:not(:last-child){padding-right:8px}html[dir='rtl'] .analyticsStatsCount_4d6a10fd:not(:last-child){padding-left:8px}\n"}]);t.analyticsStatsContainer="analyticsStatsContainer_4d6a10fd";t.analyticsStats="analyticsStats_4d6a10fd";t.analyticsStatsNoLink="analyticsStatsNoLink_4d6a10fd";t.analyticsStatsLink="analyticsStatsLink_4d6a10fd";t.analyticsStatsViewsNoLink="analyticsStatsViewsNoLink_4d6a10fd";t.analyticsStatsViews="analyticsStatsViews_4d6a10fd";t.analyticsStatsViewsDivider="analyticsStatsViewsDivider_4d6a10fd";t.analyticsStatsViewsDividerNoDot="analyticsStatsViewsDividerNoDot_4d6a10fd";t.analyticsStatsErrorMessage="analyticsStatsErrorMessage_4d6a10fd";t.fileHoverCardErrorIcon="fileHoverCardErrorIcon_4d6a10fd";t.analyticsStatsTeachingMessage="analyticsStatsTeachingMessage_4d6a10fd";t.analyticsStatsInfo="analyticsStatsInfo_4d6a10fd";t.analyticsStatsLabel="analyticsStatsLabel_4d6a10fd";t.analyticsStatsCount="analyticsStatsCount_4d6a10fd"});
define("@ms/items-view/lib/private/components/fileHoverCard/hoverCardStats/SocialBarLikeLink",["require","exports","tslib","react","office-ui-fabric-react/lib/Link","office-ui-fabric-react/lib/components/ActivityItem/index","../../withAction/WithAction","../../actions/analyticsClick/ShowSocialBarAction","./SocialBar.scss"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.likeLabel,n=e.itemKey,f=r.createElement(s.ActivityItem,{activityDescription:t,isCompact:!0});return r.createElement(o.WithAction,{action:r.createElement(u.ShowSocialBarAction,{itemKey:n})},function(e){var t=e.isAvailable,n=e.execute,s=t?function(){n().catch(function(){})}:void 0;return r.createElement(i.Link,{disabled:!1,className:a.analyticsStatsLink,onClick:s},f)})};return t}(r.Component);t.SocialBarLikeLink=f});
define("@ms/items-view/lib/private/components/actions/analyticsClick/ShowSocialBarAction",["require","exports","tslib","react","../../decorators/selectors","../../fileHoverCard/hoverCardStats/SocialBarPanel","../../withAction/WithAction","../../action/Action"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.itemKey,t=o.renderComponentOnExecute(function(t){return r.createElement(s.default,n.__assign({},t,{itemKey:e}))},{scope:"global"});return r.createElement(u.Action,{onExecute:t})};return t}(r.PureComponent);t.ShowSocialBarAction=a;t.CurrentShowSocialBarAction=i.withOnlyCurrentItem()(a)});
define("@ms/items-view/lib/private/components/fileHoverCard/hoverCardStats/SocialBarPanel",["require","exports","tslib","react","office-ui-fabric-react/lib/FocusZone","office-ui-fabric-react/lib/components/ActivityItem/index","@uifabric/utilities/lib/css","../../../facets/ItemFacets","../../../facets/ItemAnalyticsFacets","office-ui-fabric-react/lib/List","office-ui-fabric-react/lib/Panel","../../withItemCache/WithItemCache","../../../controls/userHoverCardControl","../../../facets/ItemFacets","../../../facets/PersonFacets","@ms/utilities-strings/lib/index","./SocialBar.resx","./SocialBar.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,n=t.itemKey,s=t.resolve;return r.createElement(c.WithItemCache,null,function(t){var h,p,d=t.itemCache,y=d.demandItemFacet(u.analyticsItemFacet,n),w=y&&y.itemKey,E=d.demandItemFacet(a.likeCountFacet,w);return r.createElement(l.Panel,{className:g.socialBarPanel,closeButtonAriaLabel:m.default.panelCloseAriaLabel,customWidth:"320px",isOpen:!0,isBlocking:!0,isLightDismiss:!0,focusTrapZoneProps:{forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0},type:l.PanelType.custom,onDismissed:s,headerText:""+(p=Number(E),v.format(v.getLocalizedCountValue(m.default.panelLikesHeaderText,m.default.panelLikesHeaderTextInterval,p)||"",p))},(h=e.props,r.createElement(c.WithItemCache,null,function(e){var t=e.itemCache,n=t.demandItemFacet(u.likedByItemFacet,h.itemKey),s=t.demandItemFacet(u.likedByPeopleFacet,n&&n.likedByItemKey),a=s&&s.personKeys;return r.createElement("div",{className:o.css(g.socialBarPanelContent)},a&&a.length>0&&function(e){return r.createElement(i.FocusZone,{direction:i.FocusZoneDirection.vertical},r.createElement(f.List,{className:g.socialBarList,items:e&&e.map(function(e){return{key:e}}),onRenderCell:b}))}(a))})))})};return t}(r.Component);t.default=y;function b(e,t,n){return e&&r.createElement(c.WithItemCache,null,function(n){var i=n.itemCache,o=e&&e.key,u=i.demandItemFacet(h.userHoverCardControl,o),a=i.demandItemFacet(p.displayNameFacet,o),f=i.demandItemFacet(d.emailFacet,o),l=h.userHoverCardControl.evaluate(u)(i,{personKey:o}).userHoverCard,c=r.createElement(s.ActivityItem,{className:g.socialBarPanelPersona,activityPersonas:[{imageUrl:f,imageAlt:a}],activityDescription:r.createElement("div",{className:g.socialBarPanelPersonaDescription},a)});return l?r.createElement(l,{personKey:o,key:t},c):c})}});
define("@ms/items-view/lib/private/facets/PersonFacets",["require","exports","../models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.emailFacet=new n.Facet("email");t.pictureFacet=new n.Facet("picture");t.sipFacet=new n.Facet("sip")});
define("@ms/items-view/lib/private/components/fileHoverCard/hoverCardStats/SocialBar.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".commandLink_e0b7b6dd{height:32px;line-height:32px}html[dir='ltr'] .commandLink_e0b7b6dd{margin-right:15px}html[dir='rtl'] .commandLink_e0b7b6dd{margin-left:15px}.commandLink_e0b7b6dd i{color:"},{theme:"primaryText",defaultValue:"#333333"},{rawString:"}label.link_e0b7b6dd,button.link_e0b7b6dd{display:inline;line-height:32px;height:32px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}html[dir='ltr'] label.link_e0b7b6dd,html[dir='ltr'] button.link_e0b7b6dd{margin-left:-7px}html[dir='rtl'] label.link_e0b7b6dd,html[dir='rtl'] button.link_e0b7b6dd{margin-right:-7px}html[dir='ltr'] label.link_e0b7b6dd,html[dir='ltr'] button.link_e0b7b6dd{margin-right:15px}html[dir='rtl'] label.link_e0b7b6dd,html[dir='rtl'] button.link_e0b7b6dd{margin-left:15px}.pageUsageChartContainer_e0b7b6dd>.ms-AnalyticsChart{margin-top:0}.root_e0b7b6dd{font-size:14px;font-weight:400;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-ms-flex-wrap:wrap;flex-wrap:wrap;margin-top:12px}.socialBarList_e0b7b6dd{width:288px}.socialBarPanel_e0b7b6dd{top:50px}.socialBarPanelContent_e0b7b6dd{overflow-x:hidden;overflow-y:auto}.spSocialPanelPivotContent_e0b7b6dd{padding-top:15px}.socialBarPanelHeader_e0b7b6dd{-ms-flex-negative:0;flex-shrink:0;padding:0 25px}.socialBarPanelHeader_e0b7b6dd .socialBarPanelHeaderText_e0b7b6dd{font-size:21px;font-weight:300;line-height:48px;margin:0}.socialBarPanelPersona_e0b7b6dd{font-size:14px;padding:4px 0}.socialBarPanelPersonaDescription_e0b7b6dd{font-size:14px;padding:8px 0}.viewsIcon_e0b7b6dd{cursor:default;font-size:16px;height:32px;line-height:28px;text-align:center;width:32px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;vertical-align:middle}html[dir='ltr'] .viewsIcon_e0b7b6dd{margin-right:8px}html[dir='rtl'] .viewsIcon_e0b7b6dd{margin-left:8px}.analyticsStatsLink_e0b7b6dd{min-width:50px;font-size:14px;padding:0 8px 0 0}.analyticsStatsLink_e0b7b6dd .ms-Link{font-size:12px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.analyticsStatsLink_e0b7b6dd .ms-ActivityItem-activityTypeIcon{margin-top:0}html[dir='ltr'] .analyticsStatsLink_e0b7b6dd .ms-ActivityItem-activityTypeIcon{padding-right:5px}html[dir='rtl'] .analyticsStatsLink_e0b7b6dd .ms-ActivityItem-activityTypeIcon{padding-left:5px}.analyticsStatsLink_e0b7b6dd .ms-ActivityItem-activityContent{-ms-flex-preferred-size:auto;flex-basis:auto;font-weight:400}html[dir='ltr'] .analyticsStatsLink_e0b7b6dd .ms-ActivityItem-activityContent{padding-left:0}html[dir='rtl'] .analyticsStatsLink_e0b7b6dd .ms-ActivityItem-activityContent{padding-right:0}.analyticsStatsLink_e0b7b6dd :hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}\n"}]);t.commandLink="commandLink_e0b7b6dd";t.link="link_e0b7b6dd";t.pageUsageChartContainer="pageUsageChartContainer_e0b7b6dd";t.root="root_e0b7b6dd";t.socialBarList="socialBarList_e0b7b6dd";t.socialBarPanel="socialBarPanel_e0b7b6dd";t.socialBarPanelContent="socialBarPanelContent_e0b7b6dd";t.spSocialPanelPivotContent="spSocialPanelPivotContent_e0b7b6dd";t.socialBarPanelHeader="socialBarPanelHeader_e0b7b6dd";t.socialBarPanelHeaderText="socialBarPanelHeaderText_e0b7b6dd";t.socialBarPanelPersona="socialBarPanelPersona_e0b7b6dd";t.socialBarPanelPersonaDescription="socialBarPanelPersonaDescription_e0b7b6dd";t.viewsIcon="viewsIcon_e0b7b6dd";t.analyticsStatsLink="analyticsStatsLink_e0b7b6dd"});
define("@ms/shared-react-item-hover-card/lib/UserNameHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isCurrentLoginUser=function(e,t,n){var r=e&&e.toLowerCase(),i=t&&t.toLowerCase(),s=n&&n.toLowerCase();return!(r!==i&&r!==s)}});
define("@ms/shared-react-item-hover-card/lib/AnalyticsActivity/AnalyticsActivity.module.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".analyticsActivity_27396584{width:240px;height:16px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.analyticsActivity_27396584 .analyticsActivityUserAction_27396584,.analyticsActivity_27396584 .analyticsActivityUserName_27396584{display:inline-block;content:attr(data-analytics-activity-start)}.analyticsActivity_27396584 .analyticsActivityUserName_27396584{content:attr(data-analytics-activity-start);color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-weight:600}.analyticsActivity_27396584 .analyticsActivityUserAction_27396584{content:attr(data-analytics-activity-end);color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.ms-ActivityItem-timeStamp{height:16px}\n"}]);t.analyticsActivity="analyticsActivity_27396584";t.analyticsActivityUserAction="analyticsActivityUserAction_27396584";t.analyticsActivityUserName="analyticsActivityUserName_27396584"});
define("@ms/shared-react-item-hover-card/lib/AnalyticsActivityList/AnalyticsActivityList",["require","exports","tslib","react","office-ui-fabric-react/lib/List","office-ui-fabric-react/lib/Spinner","../AnalyticsActivity/AnalyticsActivity","../AnalyticsStats/AnalyticsStats","../AnalyticsStats/AnalyticsStats","./AnalyticsActivityList.module.scss","../Utilities/ItemAnalyticsCommunicationManager","@ms/odsp-datasources/lib/AcronymAndColor","@ms/odsp-utilities/lib/logging/ErrorHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.componentDidMount=function(){this.props.onLoaded&&this.props.onLoaded()};t.prototype.render=function(){return r.createElement(s.Spinner,{size:s.SpinnerSize.large})};return t}(r.Component),d=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onRenderCell=function(e,t){return e&&e.activity&&r.createElement("div",{className:f.analyticsActivityListActivity},r.createElement(o.AnalyticsActivity,{activity:e.activity,loginUserEmail:n.props.loginUserEmail,userEmail:n.props.userEmail,imageInitials:e.imageInitials,initialsColor:e.initialsColor}),n.props.moreActivities&&t===n.state.items.length-1?r.createElement(p,{onLoaded:n.props.onLoadMoreActivities}):void 0)};n.state={items:t.itemAnalytics&&t.itemAnalytics.activities.map(function(e){return{activity:e}}),itemAnalyticsData:t.itemAnalytics};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){if(e.itemAnalytics){this._updateActivities(e.itemAnalytics);this.props.pageContext&&this._updateAcronyms(e.itemAnalytics)}};t.prototype.render=function(){var e,t=this.props.showAnalyticsStats,n=void 0===t||t,s=this.state.itemAnalyticsData,o=a.getFileHoverCardStrings();s&&s.incompleteData&&s.incompleteData.wasThrottled&&(e=o.throttledMessage);if(s){l.setListAsFinishedLoading();return r.createElement("div",null,n&&r.createElement(u.AnalyticsStats,{itemAnalytics:s,inComplete:!!e}),this.state.items&&r.createElement(i.List,{items:this.state.items,onRenderCell:this._onRenderCell}))}return r.createElement(p,null)};t.prototype._updateActivities=function(e){this.setState(function(){return{itemAnalyticsData:e,items:e.activities.map(function(e){return{activity:e}})}})};t.prototype._updateAcronyms=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,i,s;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,3,,4]);if(!this.props.pageContext)return[3,2];t=e.activities.map(function(e){return e.actor.user.displayName});return[4,new c.AcronymAndColorDataSource(this.props.pageContext).getAcronyms(t,{qosName:"ItemAnalyticsListAcronyms"})];case 1:r=n.sent();i=r.reduce(function(e,t){t.text&&(e[t.text]=t);return e},{});this.setState(function(e){return{items:e.items.map(function(e){var t=i[e.activity.actor.user.displayName];return{activity:e.activity,imageInitials:t&&t.acronym,initialsColor:t&&t.color}})}});n.label=2;case 2:return[3,4];case 3:s=n.sent();h.default.logError(s);l.pageError(s);return[3,4];case 4:return[2]}})})};return t}(r.Component);t.AnalyticsActivityList=d});
define("@ms/shared-react-item-hover-card/lib/AnalyticsActivityList/AnalyticsActivityList.module.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".analyticsActivityListActivity_4302e3bd{padding:8px 0}\n"}]);t.analyticsActivityListActivity="analyticsActivityListActivity_4302e3bd"});
define("@ms/shared-react-item-hover-card/lib/Utilities/ItemAnalyticsCommunicationManager",["require","exports","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=!1,i=!1;t.setListAsFinishedLoading=function(){if(!i){i=!0;s()}};function s(){if(!r&&i){r=!0;new n.default({name:"ItemAnalytics.PageFinishedLoading",startTimeOverride:window._itemAnalyticsStartTime}).end({resultType:n.ResultTypeEnum.Success});try{window.external.PageFinishedLoading()}catch(e){window.parent.postMessage(JSON.stringify({name:"item_analytics_ready"}),"*")}}}t.pageFinishedLoading=s;t.pageError=function(e){try{window.external.PageError(e,e.message)}catch(n){var t={name:"item_analytics_error",error:e,errorMessage:e.message};window.parent.postMessage(JSON.stringify(t),"*")}}});
define("@ms/odsp-datasources/lib/AcronymAndColor",["require","exports","tslib","./dataSources/siteHeader/AcronymAndColorDataSource"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/shared-react-item-hover-card/lib/AnalyticsActionBar/AnalyticsActionBar",["require","exports","tslib","react","@uifabric/experiments/lib/CommandBar","../AnalyticsStats/AnalyticsStats","office-ui-fabric-react/lib/Shimmer","./AnalyticsActionBar.module.scss","../IFileHoverCardStore","@ms/items-view/lib/private/components/actionCommandBar/ActionCommandBar"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AnalyticsActionBar=function(e){var t=e.items,l=e.farItems,c=e.analyticsStats,h=e.isLink,p=e.showActionBar,d=void 0===p||p,v=!(!c||!c.itemAnalytics&&!c.isNotSupported&&c.status!==a.AnalyticsResultStatus.unsupport&&c.status!==a.AnalyticsResultStatus.failed),m=e.itemKey?r.createElement(f.ActionCommandBar,{className:u.analyticsActionBar,commands:t,farCommands:l}):r.createElement(i.CommandBar,{className:u.analyticsActionBar,items:t,farItems:l});return r.createElement("div",null,r.createElement("div",{className:u.analyticsActionBarStats},r.createElement(o.Shimmer,{width:"35%",isDataLoaded:v,shimmerElements:[{type:o.ShimmerElementType.line,height:8}]},r.createElement(s.AnalyticsStats,n.__assign({isLink:h,isCompact:!0},c)))),d&&m)}});
define("@uifabric/experiments/lib/CommandBar",["require","exports","tslib","office-ui-fabric-react/lib/CommandBar"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/shared-react-item-hover-card/lib/AnalyticsActionBar/AnalyticsActionBar.module.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".analyticsActionBarStats_41dd53cd{min-height:28px}.isFluent .analyticsActionBarStats_41dd53cd{height:32px;padding:8px 0;-webkit-box-sizing:border-box;box-sizing:border-box}.analyticsActionBar_41dd53cd{background-color:transparent;padding-left:0;padding-right:0}.isFluent .analyticsActionBar_41dd53cd{-webkit-box-sizing:border-box;box-sizing:border-box;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";height:35px}.isFluent .analyticsActionBar_41dd53cd .ms-CommandBar-secondaryCommand .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link:hover{background-color:transparent}[dir='ltr'] .isFluent .analyticsActionBar_41dd53cd .ms-CommandBar-secondaryCommand .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-label{margin-right:0}[dir='rtl'] .isFluent .analyticsActionBar_41dd53cd .ms-CommandBar-secondaryCommand .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-label{margin-left:0}.isFluent .analyticsActionBar_41dd53cd .ms-FocusZone.ms-CommandBar{height:34px}.analyticsActionBar_41dd53cd .ms-FocusZone.ms-CommandBar{background-color:transparent;padding:0;height:36px}.analyticsActionBar_41dd53cd .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link{background-color:transparent;min-width:0}[dir='ltr'] .analyticsActionBar_41dd53cd .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link{padding-left:0}[dir='rtl'] .analyticsActionBar_41dd53cd .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link{padding-right:0}.isFluent .analyticsActionBar_41dd53cd .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link{min-width:0;height:32px;margin-top:1px;border-radius:2px;padding:0}.isFluent .analyticsActionBar_41dd53cd .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link:hover{background-color:transparent}[dir='ltr'] .isFluent .analyticsActionBar_41dd53cd .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-left:4px}[dir='rtl'] .isFluent .analyticsActionBar_41dd53cd .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-right:4px}[dir='ltr'] .isFluent .analyticsActionBar_41dd53cd .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-right:20px}[dir='rtl'] .isFluent .analyticsActionBar_41dd53cd .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-left:20px}.analyticsActionBar_41dd53cd .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-textContainer{font-size:12px;font-weight:400}.analyticsActionBar_41dd53cd .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon,.analyticsActionBar_41dd53cd .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-textContainer{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.analyticsActionBar_41dd53cd .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link:hover{background-color:transparent}.analyticsActionBar_41dd53cd .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link:hover .ms-Button-textContainer{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}[dir='ltr'] .analyticsActionBar_41dd53cd .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-left:0}[dir='rtl'] .analyticsActionBar_41dd53cd .ms-Button.ms-Button--commandBar.ms-CommandBarItem-link .ms-Button-icon{margin-right:0}\n"}]);t.analyticsActionBarStats="analyticsActionBarStats_41dd53cd";t.analyticsActionBar="analyticsActionBar_41dd53cd"});
define("@ms/items-view/lib/private/components/actionCommandBar/ActionCommandBar",["require","exports","tslib","react","@uifabric/experiments/lib/CommandBar","../commandSet/CommandSet","../../utilities/arrays","../../utilities/components/Fragment","../keyboard/KeyboardShortcut","../commands/Commands.resx"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=[];t.ActionCommandBar=s.connectToCommandSets(function(e){return{main:e.commands,overflow:e.overflowCommands,far:e.farCommands,shortcut:e.shortcutCommands}},function(e,t){var n=t.items,r=void 0===n?l:n,i=t.overflowItems,s=void 0===i?l:i,u=t.farItems,a=void 0===u?l:u,c=t.shortcutItems,h=void 0===c?l:c;return{items:o.concat(r,e.main),overflowItems:o.concat(s,e.overflow),farItems:o.concat(a,e.far),shortcutItems:o.concat(h,e.shortcut),ariaLabel:f.default.CommandBarAriaLabel}})(function(e){var t=e.items,s=void 0===t?l:t,o=e.farItems,c=void 0===o?l:o,h=e.overflowItems,p=void 0===h?l:h,d=e.shortcutItems,v=void 0===d?l:d,m=function(e){return e.filter(function(e){return e&&(!!e.shortcutProps||!!e.keytipProps)})}(s.concat(c,p,v));return r.createElement(u.Fragment,null,r.createElement(i.CommandBar,n.__assign({overflowButtonProps:{ariaLabel:f.default.OverflowCommandTooltip,title:f.default.OverflowCommandTooltip}},e)),m&&m.length>0&&m.map(function(e){var t=e.shortcutProps||e.keytipProps;return t&&t.keySequences.length>0?r.createElement(a.KeyboardShortcut,{key:e.key,cmdKey:t.keySequences[0],keySequences:t.keySequences,description:t.content,onExecute:e.onClick}):null}))});t.ActionCommandBar.displayName="ActionCommandBar"});
define("@ms/shared-react-item-hover-card/lib/AnalyticsLifeCycle/AnalyticsLifeCycle",["require","exports","tslib","react","office-ui-fabric-react/lib/Link","@uifabric/experiments/lib/components/signals/Signals","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-graph/lib/services/itemAnalytics/IItemAnalytics","../UserNameHelper","../FileHoverCard.resx","./AnalyticsLifeCycle.module.scss"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onCheckInClick=function(e){n.props.onCheckIn(e);n.props.cleanCachedItem&&n.props.cleanCachedItem(e)};n._onDiscardCheckOutClick=function(e){n.props.onDiscardCheckOut(e);n.props.cleanCachedItem&&n.props.cleanCachedItem(e)};return n}t.prototype.render=function(){var e,t,n,c,h,p,d=this.props,v=d.lifeCycleStatus,m=d.loginUserEmail,g=d.userEmail,y=void 0;switch(v.status){case u.AnalyticsLifeCycleStatus.MalwareDetected:e=f.default.malwareDetected;t="https://go.microsoft.com/fwlink/?linkid=862871";h=f.default.learnMore;y=r.createElement(s.MalwareDetectedSignal,null);break;case u.AnalyticsLifeCycleStatus.ThisFileIsCheckedOut:var b=v.userCheckedOutThis;if(b&&b.email&&a.isCurrentLoginUser(b.email,m,g)){e=f.default.youHaveThisCheckedOut;n=this.props.onCheckIn&&this._onCheckInClick;c=this.props.onDiscardCheckOut&&this._onDiscardCheckOutClick;h=f.default.checkIn;p=f.default.discardCheckOut;y=r.createElement(s.YouCheckedOutSignal,null)}else{e=o.format(f.default.someoneElseHasThisFileCheckedOut,b&&b.displayName);y=r.createElement(s.SomeoneCheckedOutSignal,null)}break;case u.AnalyticsLifeCycleStatus.DLPBlocked:e=f.default.DLPBlocked;n=this.props.onViewPolicyTip;h=f.default.viewPolicyTip;y=r.createElement(s.BlockedSignal,null);break;case u.AnalyticsLifeCycleStatus.MissingMetaData:e=f.default.missingMetaData;n=this.props.onAddMetadataNow;h=f.default.addMetaData;y=r.createElement(s.MissingMetadataSignal,null);break;case u.AnalyticsLifeCycleStatus.DLPWarning:e=f.default.DLPWarning;n=this.props.onViewPolicyTip;h=f.default.viewPolicyTip;y=r.createElement(s.WarningSignal,null);break;case u.AnalyticsLifeCycleStatus.AwaitingApproval:e=f.default.awaitingApproval;y=r.createElement(s.AwaitingApprovalSignal,null);break;case u.AnalyticsLifeCycleStatus.Trending:e=f.default.trendingItem;y=r.createElement(s.TrendingSignal,null);break;case u.AnalyticsLifeCycleStatus.New:var w=v.creator;e=w&&w.email&&a.isCurrentLoginUser(w.email,m,g)?o.format(f.default.youCreated,v.createdRelativeTime):o.format(f.default.otherCreated,v.createdRelativeTime,w&&w.displayName);y=r.createElement("div",{className:l.fileHoverCardLifeCycleNewSignal},r.createElement(s.NewSignal,null))}return y&&r.createElement("div",{className:l.fileHoverCardLifeCycle},y,r.createElement("div",{className:l.fileHoverCardLifeCycleMessage},r.createElement("div",{className:l.fileHoverCardLifeCycleTitle},e),(n||t)&&r.createElement(i.Link,{className:l.fileHoverCardLifeCycleAction,href:t,target:t&&"_blank",onClick:n},h),c&&" or ",c&&r.createElement(i.Link,{className:l.fileHoverCardLifeCycleAction,onClick:c},p)))};return t}(r.Component);t.AnalyticsLifeCycle=c});
define("@ms/shared-react-item-hover-card/lib/AnalyticsLifeCycle/AnalyticsLifeCycle.module.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".fileHoverCardLifeCycle_8a3e7929{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";padding:12px 0;min-height:14px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}[dir='ltr'] .fileHoverCardLifeCycle_8a3e7929{margin-right:12px}[dir='rtl'] .fileHoverCardLifeCycle_8a3e7929{margin-left:12px}.fileHoverCardLifeCycleMessage_8a3e7929{font-size:12px}.fileHoverCardLifeCycleMessage_8a3e7929 .fileHoverCardLifeCycleTitle_8a3e7929{white-space:pre-line;font-weight:400}.fileHoverCardLifeCycleAction_8a3e7929{padding:4px 0;font-weight:600}.fileHoverCardLifeCycleNewSignal_8a3e7929{display:-webkit-box;display:-ms-flexbox;display:flex}[dir='ltr'] .fileHoverCardLifeCycleNewSignal_8a3e7929{padding-left:15px}[dir='rtl'] .fileHoverCardLifeCycleNewSignal_8a3e7929{padding-right:15px}\n"}]);t.fileHoverCardLifeCycle="fileHoverCardLifeCycle_8a3e7929";t.fileHoverCardLifeCycleMessage="fileHoverCardLifeCycleMessage_8a3e7929";t.fileHoverCardLifeCycleTitle="fileHoverCardLifeCycleTitle_8a3e7929";t.fileHoverCardLifeCycleAction="fileHoverCardLifeCycleAction_8a3e7929";t.fileHoverCardLifeCycleNewSignal="fileHoverCardLifeCycleNewSignal_8a3e7929"});
define("@ms/shared-react-item-hover-card/lib/AnalyticsKeyPoints/AnalyticsKeyPoints",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Link","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Tooltip","office-ui-fabric-react/lib/List","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/ContextualMenu","../FileHoverCard.resx","@ms/odsp-utilities/lib/string/StringHelper","../HoverCardLoggerHelper","../itemsScopeFileHoverCard/EngagementContext","./AnalyticsKeyPoints.module.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onClick=function(e){p.default("FileHoverCard.KeyPoints.Click",n.props.item,n.context);n.props.onKeyPointsClick(e)};n._onClickMoreIcon=function(e){n._moreIconElement=e.currentTarget;n.setState({showCallout:!0});p.default("FileHoverCard.KeyPoints.ClickMoreIcon",n.props.item,n.context)};n.state={showCallout:!1};return n}t.prototype.render=function(){var e=this,t=c.default.insideLookTooltipMessage,n=this.props.keyPointsData;return r.createElement("div",{className:v.fileHoverCardInsideLook},r.createElement("div",{className:v.fileHoverCardInsideLookTitle},r.createElement("div",null,c.default.insideLook,r.createElement(u.TooltipHost,{content:t,directionalHint:l.DirectionalHint.bottomCenter},r.createElement(o.Icon,{iconName:"Info",ariaLabel:t,role:"tooltip",tabIndex:0}))),r.createElement(f.IconButton,{iconProps:{iconName:"More"},onClick:this._onClickMoreIcon,ariaLabel:c.default.MoreOptions})),this.state.showCallout&&r.createElement(l.ContextualMenu,{gapSpace:0,isBeakVisible:!0,shouldFocusOnMount:!0,target:this._moreIconElement,onDismiss:function(){return e.setState({showCallout:!1})},directionalHint:i.getRTL()?l.DirectionalHint.bottomLeftEdge:l.DirectionalHint.bottomRightEdge,items:[{key:"sendFeedback",name:c.default.SendUsFeedback,onClick:this.props.onSendFeedbackClick},{key:"editKeyPoints",name:c.default.EditKeyPoints,onClick:this.props.onKeyPointsClick}]}),!(!n||!n.readTime||void 0===n.readTime.minutes)&&r.createElement("div",{className:v.fileHoverCardReadTime},r.createElement(o.Icon,{className:v.fileHoverCardReadTimeIcon,iconName:"Clock","aria-describedby":t}),r.createElement("div",{className:v.fileHoverCardReadTimeDescription},this._timeToReadMessage(n.readTime.minutes))),n&&n.keyPoints&&n.keyPoints.length>0&&r.createElement("div",{className:v.fileHoverCardKeyPoints},c.default.keyPointsTitle,r.createElement("div",{className:v.fileHoverCardKeyPointsContent},r.createElement(s.Link,{className:v.fileHoverCardKeyPointsAction,onClick:this._onClick},r.createElement(a.List,{renderCount:3,items:n.keyPoints,onRenderCell:this._onRenderCell})))))};t.prototype._onRenderCell=function(e){return e&&r.createElement("div",{className:v.fileHoverCardKeyPointsCell},r.createElement("div",{className:v.fileHoverCardKeyPointsBullet}),r.createElement("div",{dir:"auto",className:v.fileHoverCardKeyPointsText},e.text))};t.prototype._timeToReadMessage=function(e){if(0===e)return c.default.timeToReadInZero;if(e>60){var t=h.getLocalizedCountValue(c.default.timeToReadInHours,c.default.timeToReadInHoursIntervals,Math.floor(e/60));return t&&h.format(t,Math.floor(e/60))}return h.format(c.default.timeToReadInMinutes,e)};return t}(r.Component);t.AnalyticsKeyPoints=m;m.contextType=d.EngagementContext});
define("@ms/shared-react-item-hover-card/lib/HoverCardLoggerHelper",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Engagement.event"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e,t,i){t?r.Engagement.logData({name:e,isIntentional:!0,extraData:n.__assign({itemId:t.itemId,driveId:t.graph&&t.graph.driveId,fileExtension:t.extension,fileType:t.appMap},i)}):r.Engagement.logData(n.__assign({name:e},i))}});
define("@ms/shared-react-item-hover-card/lib/itemsScopeFileHoverCard/EngagementContext",["require","exports","react"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EngagementContext=n.createContext({})});
define("@ms/shared-react-item-hover-card/lib/AnalyticsKeyPoints/AnalyticsKeyPoints.module.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".fileHoverCardInsideLook_41a3302a{padding:12px 0 14px;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}[dir='ltr'] .fileHoverCardInsideLook_41a3302a{margin-right:12px}[dir='rtl'] .fileHoverCardInsideLook_41a3302a{margin-left:12px}.fileHoverCardInsideLook_41a3302a .fileHoverCardInsideLookTitle_41a3302a{font-size:14px;font-weight:600;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.fileHoverCardInsideLook_41a3302a .ms-TooltipHost{padding:0 8px;font-size:12px;vertical-align:middle;color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.fileHoverCardInsideLook_41a3302a .ms-Button--icon{height:14px}[dir='ltr'] .fileHoverCardInsideLook_41a3302a .ms-Button--icon{padding-right:0}[dir='rtl'] .fileHoverCardInsideLook_41a3302a .ms-Button--icon{padding-left:0}.fileHoverCardReadTime_41a3302a{padding-top:6px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.fileHoverCardReadTime_41a3302a .fileHoverCardReadTimeDescription_41a3302a{display:inline-block;padding:0 8px;vertical-align:middle;font-size:12px}.fileHoverCardReadTime_41a3302a .fileHoverCardReadTimeIcon_41a3302a{font-size:14px;vertical-align:middle}.fileHoverCardKeyPoints_41a3302a{padding-top:14px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:12px}.fileHoverCardKeyPointsContent_41a3302a{padding-top:12px}.fileHoverCardKeyPointsAction_41a3302a{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:12px;width:100%}.fileHoverCardKeyPointsCell_41a3302a{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;width:100%;padding-bottom:2px}.fileHoverCardKeyPointsText_41a3302a{overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.fileHoverCardKeyPointsBullet_41a3302a:before{content:' \\B7  '}.fileHoverCardKeyPointsBullet_41a3302a{display:inline-block}[dir='ltr'] .fileHoverCardKeyPointsBullet_41a3302a{padding-right:8px}[dir='rtl'] .fileHoverCardKeyPointsBullet_41a3302a{padding-left:8px}\n"}]);t.fileHoverCardInsideLook="fileHoverCardInsideLook_41a3302a";t.fileHoverCardInsideLookTitle="fileHoverCardInsideLookTitle_41a3302a";t.fileHoverCardReadTime="fileHoverCardReadTime_41a3302a";t.fileHoverCardReadTimeDescription="fileHoverCardReadTimeDescription_41a3302a";t.fileHoverCardReadTimeIcon="fileHoverCardReadTimeIcon_41a3302a";t.fileHoverCardKeyPoints="fileHoverCardKeyPoints_41a3302a";t.fileHoverCardKeyPointsContent="fileHoverCardKeyPointsContent_41a3302a";t.fileHoverCardKeyPointsAction="fileHoverCardKeyPointsAction_41a3302a";t.fileHoverCardKeyPointsCell="fileHoverCardKeyPointsCell_41a3302a";t.fileHoverCardKeyPointsText="fileHoverCardKeyPointsText_41a3302a";t.fileHoverCardKeyPointsBullet="fileHoverCardKeyPointsBullet_41a3302a"});
define("@ms/shared-react-item-hover-card/lib/HoverCardExperimentHelper",["require","exports","@ms/odsp-utilities/lib/features/Features","@ms/odsp-utilities/lib/logging/ABExperiment"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={ODB:1439,OneDrive:!0},s={ODB:1651,OneDrive:!0};t.isKeyPointsExperimentOn=function(){if(n.default.isFeatureEnabled(i)){return new r.ABExperiment({name:"KeyPointsExperiment",startDate:"2/6/2019"}).IsExperimentOn()}return!0};t.isActivityHighlightsExperimentOn=function(){if(n.default.isFeatureEnabled(s)){return new r.ABExperiment({name:"ActivityHighlightsExperiment",startDate:"8/16/2019"}).IsExperimentOn()}return!0}});
define("@ms/shared-react-item-hover-card/lib/ErrorBoundary",["require","exports","tslib","react"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.state={hasError:!1};return n}t.prototype.componentDidCatch=function(e,t){this.props.qosEvent({error:e,errorInfo:JSON.stringify(t)});this.setState({hasError:!0})};t.prototype.render=function(){return this.state.hasError?null:r.createElement(r.Fragment,null,this.props.children)};return t}(r.Component);t.ErrorBoundary=i});
define("@ms/shared-react-item-hover-card/lib/RecommendedActions/RecommendedActions",["require","exports","tslib","react","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Link","office-ui-fabric-react/lib/components/ActivityItem/index","office-ui-fabric-react/lib/Tooltip","@ms/odsp-utilities/lib/dateTime/DateTime","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/uri/Uri","./LowActivity","../HoverCardLoggerHelper","./RecommendedActions.module.scss","../FileHoverCard.resx","../HoverCardExperimentHelper","../FileHoverCardHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=2,b=function(e){n.__extends(t,e);function t(t){var h=e.call(this,t)||this;h._recommendedAction=function(e,t){var n=f.getFriendlyDateTimeStringPast(f.iso8601DateTimeToJsDate(e.activityTimestamp)),c="",m="",g="";switch(e.recommendationEventType){case"Mentioned":c="Accounts";g=l.formatToArray(v.default.MentionMessage,h._userNameJSX(e.actorDisplayName));m=v.default.Reply;break;case"Edited":c="Edit";g=v.default.EditMessage;m=v.default.OpenToRead;var b=e.importantActorsAndActivities[0],w=b&&b.activityTimestamp;n=w&&f.getFriendlyDateTimeStringPast(f.iso8601DateTimeToJsDate(w));var E=e.importantActorsAndActivities.map(function(e){return e.actorDisplayName});g=1===E.length?l.formatToArray(v.default.OnePersonEditMessage,h._userNameJSX(E[0])):2===E.length?l.formatToArray(v.default.TwoPersonEditMessage,h._userNameJSX(E[0]),h._userNameJSX(E[1])):l.formatToArray(v.default.EditMessage,h._userNameJSX(E[0]),h._userNameJSX(E[1]),e.recentEditorCount-y);break;case"Commented":c="Chat";g=l.formatToArray(v.default.CommentMessage,h._userNameJSX(e.actorDisplayName));m=v.default.View}return r.createElement("div",{key:t},r.createElement("div",{className:d.fileHoverCardRecommendedAction},r.createElement(u.ActivityItem,{activityIcon:r.createElement(i.Icon,{iconName:c,className:d.fileHoverCardRecommendedIcon}),activityDescription:g,timeStamp:n}),r.createElement(a.TooltipHost,{content:v.default.Dismiss,directionalHint:a.DirectionalHint.topCenter},r.createElement(s.IconButton,{className:d.fileHoverCardCancelIcon,iconProps:{iconName:"Cancel"},onClick:function(){return h._handleClickDismiss(t)}}))),r.createElement(o.Link,{className:d.fileHoverCardRecommendedLink,href:h._getNavLink(e.navigationId),target:"_blank",onClick:function(){p.default("FileHoverCard.RecommendedActions."+e.recommendationEventType,h.props.item,h.props.engagementData)}},m))};h._getNavLink=function(e){if(h.props.pageUrl&&e){var t=new c.default(h.props.pageUrl);t.setQueryParameter("nav",e);return t.toString()}return h.props.pageUrl};h._recommendedActionRef=function(e){var t=h.state.recommendedActions;e&&h.props.engagementData&&p.default("FileHoverCard.RecommendedActions.Render",h.props.item,n.__assign({},h.props.engagementData,{extraData:n.__assign({},h.props.engagementData.extraData,{activityType:t&&t.length>0?"HighActivities":"LowActivities"})}))};h.state={recommendedActions:h.props.actions.recommendedActions};return h}t.prototype.render=function(){var e=this.state.recommendedActions,t=g.isLowActivityTidbitEnabled()&&this.props.actions.shareWith&&this.props.actions.shareWith.length>=2;return(e&&e.length>0&&m.isActivityHighlightsExperimentOn()||t)&&r.createElement("div",{ref:this._recommendedActionRef,className:d.fileHoverCardRecommendedSection},r.createElement("div",{className:d.fileHoverCardRecommendedTitle},v.default.RecommendedActionTitle),e&&e.length>0?e.slice(0,3).map(this._recommendedAction):r.createElement(h.LowActivity,{item:this.props.item,shareWith:this.props.actions.shareWith,editActivities:this.props.actions.editActivities,loginUserEmail:this.props.loginUserEmail,userEmail:this.props.userEmail,onShareWith:this.props.onShareWith,onRenderShareWithPeople:this.props.onRenderShareWithPeople}))};t.prototype._userNameJSX=function(e){return r.createElement("span",{className:d.fileHoverCardUserName},e)};t.prototype._handleClickDismiss=function(e){this.props.engagementData&&p.default("FileHoverCard.RecommendedActions.Dismiss",this.props.item,n.__assign({},this.props.engagementData,{extraData:n.__assign({},this.props.engagementData.extraData,{recommendedActionId:this.state.recommendedActions[e].recommendationId})}));this.props.onDismiss(this.state.recommendedActions[e].recommendationId,e);this.state.recommendedActions.splice(e,1);this.setState({recommendedActions:this.state.recommendedActions})};return t}(r.Component);t.RecommendedActions=b});
define("@ms/shared-react-item-hover-card/lib/RecommendedActions/LowActivity",["require","exports","tslib","react","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/components/ActivityItem/index","office-ui-fabric-react/lib/Link","@ms/odsp-utilities/lib/string/StringHelper","../UserNameHelper","../FileHoverCard.resx","./RecommendedActions.module.scss","../HoverCardLoggerHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._handleClickShare=function(e){var n=t.props.shareWith&&t.props.shareWith.slice(0,2).map(function(e){return e.email});t.props.onShareWith(e,n);c.default("FileHoverCard.RecommendedActions.ShareWith",t.props.item)};return t}t.prototype.render=function(){var e=this,t=this.props,n=t.editActivities,a=t.shareWith,c=this.props.shareWith&&this.props.shareWith.slice(0,2).map(function(e){return e.email});return a&&a.length>=2&&r.createElement(r.Fragment,null,r.createElement("div",{className:l.fileHoverCardShareWith},u.formatToArray(f.default.ShareWithMessage,this._userNameJSX(a[0].displayName),this._userNameJSX(a[1].displayName))),this.props.onRenderShareWithPeople?r.createElement("div",{className:l.fileHoverCardShareWithLink},this.props.onRenderShareWithPeople(c)):r.createElement(o.Link,{className:l.fileHoverCardShareWithLink,onClick:this._handleClickShare},f.default.ShareWithThem),n&&n.map(function(t,n){return n<2&&r.createElement(s.ActivityItem,{key:n,activityIcon:r.createElement(i.Icon,{iconName:"Edit",className:l.fileHoverCardRecommendedIcon}),onRenderActivityDescription:function(){return e._onRenderActivityDescription(t)},timeStamp:t.activityDateTime})}))};t.prototype._onRenderActivityDescription=function(e){var t=e&&e.actor&&e.actor.user,n=a.isCurrentLoginUser(t&&t.email,this.props.loginUserEmail,this.props.userEmail)?f.default.you:e.actor.user.displayName;return r.createElement("div",{className:l.fileHoverCardActivity},u.formatToArray(f.default.LowActivities,this._userNameJSX(n)))};t.prototype._userNameJSX=function(e){return r.createElement("div",{key:e,className:l.fileHoverCardUserName},e)};return t}(r.Component);t.LowActivity=h});
define("@ms/shared-react-item-hover-card/lib/RecommendedActions/RecommendedActions.module.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".fileHoverCardRecommendedSection_b43d8aa5{padding:12px 0;font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}[dir='ltr'] .fileHoverCardRecommendedSection_b43d8aa5{margin-right:12px}[dir='rtl'] .fileHoverCardRecommendedSection_b43d8aa5{margin-left:12px}.fileHoverCardRecommendedTitle_b43d8aa5{font-weight:600;padding-bottom:14px;display:inline-block}.fileHoverCardShareWith_b43d8aa5{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";display:inline-block;content:attr(data-analytics-activity-end);font-size:12px}.fileHoverCardShareWithLink_b43d8aa5{padding:2px 0 16px 0;font-size:12px}.fileHoverCardChevronIcon_b43d8aa5{font-size:12px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";vertical-align:middle;padding-left:5px}[dir='ltr'] .fileHoverCardChevronIcon_b43d8aa5{padding-left:5px}[dir='rtl'] .fileHoverCardChevronIcon_b43d8aa5{padding-right:5px}.fileHoverCardRecommendedAction_b43d8aa5{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.fileHoverCardRecommendedAction_b43d8aa5:hover .fileHoverCardCancelIcon_b43d8aa5{opacity:1}.fileHoverCardRecommendedIcon_b43d8aa5{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.fileHoverCardCancelIcon_b43d8aa5{opacity:0}.fileHoverCardCancelIcon_b43d8aa5 .ms-Button-icon{font-size:8px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.fileHoverCardCancelIcon_b43d8aa5 .ms-Button-flexContainer{-webkit-box-align:baseline;-ms-flex-align:baseline;align-items:baseline}.fileHoverCardRecommendedLink_b43d8aa5{display:block;padding-bottom:14px;font-size:12px}[dir='ltr'] .fileHoverCardRecommendedLink_b43d8aa5{padding-left:24px}[dir='rtl'] .fileHoverCardRecommendedLink_b43d8aa5{padding-right:24px}.fileHoverCardActivity_b43d8aa5{height:16px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";content:attr(data-analytics-activity-end);display:inline-block}.fileHoverCardUserName_b43d8aa5{content:attr(data-analytics-activity-start);font-weight:600;display:inline-block;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}\n"}]);t.fileHoverCardRecommendedSection="fileHoverCardRecommendedSection_b43d8aa5";t.fileHoverCardRecommendedTitle="fileHoverCardRecommendedTitle_b43d8aa5";t.fileHoverCardShareWith="fileHoverCardShareWith_b43d8aa5";t.fileHoverCardShareWithLink="fileHoverCardShareWithLink_b43d8aa5";t.fileHoverCardChevronIcon="fileHoverCardChevronIcon_b43d8aa5";t.fileHoverCardRecommendedAction="fileHoverCardRecommendedAction_b43d8aa5";t.fileHoverCardCancelIcon="fileHoverCardCancelIcon_b43d8aa5";t.fileHoverCardRecommendedIcon="fileHoverCardRecommendedIcon_b43d8aa5";t.fileHoverCardRecommendedLink="fileHoverCardRecommendedLink_b43d8aa5";t.fileHoverCardActivity="fileHoverCardActivity_b43d8aa5";t.fileHoverCardUserName="fileHoverCardUserName_b43d8aa5"});
define("@ms/shared-react-item-hover-card/lib/FileHoverCard.module.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".fileHoverCardCompactCard_4bf5d3db{padding:12px 16px 0}.isFluent .fileHoverCardCompactCardTitleRegion_4bf5d3db{margin-bottom:6px;display:-webkit-box;display:-ms-flexbox;display:flex;min-height:40px}.isFluent .fileHoverCardCompactCardFileIcon_4bf5d3db{padding-top:2px}[dir='ltr'] .isFluent .fileHoverCardCompactCardFileIcon_4bf5d3db{margin-right:12px}[dir='rtl'] .isFluent .fileHoverCardCompactCardFileIcon_4bf5d3db{margin-left:12px}.fileHoverCardCompactCardTitle_4bf5d3db{font-size:17px;font-weight:300;font-weight:400;line-height:20px;padding:12px 0 8px 0;overflow:hidden;text-overflow:ellipsis;word-break:break-word;max-width:200px}.fileHoverCardCompactCardTitle_4bf5d3db.titleNotExpanded_4bf5d3db{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.isFluent .fileHoverCardCompactCardTitle_4bf5d3db{font-size:14px;font-weight:600;padding:0;white-space:normal}.fileHoverCardCompactCardActivity_4bf5d3db{padding:8px 0}.fileHoverCardExpandedCard_4bf5d3db{max-height:340px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;text-overflow:ellipsis;word-break:break-word}[dir='ltr'] .fileHoverCardExpandedCard_4bf5d3db{padding-left:16px}[dir='rtl'] .fileHoverCardExpandedCard_4bf5d3db{padding-right:16px}.fileHoverCardExpandedCardScrollableSection_4bf5d3db{overflow-y:auto;overflow-x:hidden;padding-left:16px;margin-left:-16px}.fileHoverCardExpandedCardLoadError_4bf5d3db{padding:120px 45px;font-size:14px;font-weight:400;text-align:center;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.fileHoverCardExpandedCardLoadError_4bf5d3db .fileHoverCardExpandedCardSuggestion_4bf5d3db{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.fileHoverCardExpandedCardHostScroll_4bf5d3db{overflow-y:hidden;height:calc(100% - 1px)}.fileHoverCardActivitiesSection_4bf5d3db{padding:12px 0;border-top:1px solid "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}[dir='ltr'] .fileHoverCardActivitiesSection_4bf5d3db{margin-right:12px}[dir='rtl'] .fileHoverCardActivitiesSection_4bf5d3db{margin-left:12px}\n"}]);t.fileHoverCardCompactCard="fileHoverCardCompactCard_4bf5d3db";t.fileHoverCardCompactCardTitleRegion="fileHoverCardCompactCardTitleRegion_4bf5d3db";t.fileHoverCardCompactCardFileIcon="fileHoverCardCompactCardFileIcon_4bf5d3db";t.fileHoverCardCompactCardTitle="fileHoverCardCompactCardTitle_4bf5d3db";t.titleNotExpanded="titleNotExpanded_4bf5d3db";t.fileHoverCardCompactCardActivity="fileHoverCardCompactCardActivity_4bf5d3db";t.fileHoverCardExpandedCard="fileHoverCardExpandedCard_4bf5d3db";t.fileHoverCardExpandedCardScrollableSection="fileHoverCardExpandedCardScrollableSection_4bf5d3db";t.fileHoverCardExpandedCardLoadError="fileHoverCardExpandedCardLoadError_4bf5d3db";t.fileHoverCardExpandedCardSuggestion="fileHoverCardExpandedCardSuggestion_4bf5d3db";t.fileHoverCardExpandedCardHostScroll="fileHoverCardExpandedCardHostScroll_4bf5d3db";t.fileHoverCardActivitiesSection="fileHoverCardActivitiesSection_4bf5d3db"});
define("@ms/shared-react-item-hover-card/lib/FileHoverCardStore",["require","exports","tslib","./IFileHoverCardStore","@ms/odsp-utilities/lib/async/PromiseDeduplicator","@ms/odsp-utilities/lib/async/Promise","./Utilities/ItemAnalyticsCommunicationManager","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-datasources/lib/dataSources/base/DataRequestor","@ms/odsp-datasources/lib/providers/fileHoverCard/FeedbackProvider"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=18e5,c=0,h=function(){function e(e,t){this._dictListener={};this._itemAnalyticsDataSource=t.itemAnalyticsDataSource;this._dictItemAnalytics={};this._promiseDeduplicator=new i.default;var r=e.isSharePointListId,s=void 0!==r&&r;this._isSharePointListId=s;t.pageContext&&(this._feedbackProvider=new f.FeedbackProvider({},{pageContext:t.pageContext,dataRequestorType:function(e){n.__extends(r,e);function r(n){return e.call(this,n,{pageContext:t.pageContext})||this}return r}(a.DataRequestor)}));setInterval(this._cleanCache.bind(this),l)}e.prototype.addListener=function(e,t){var n=""+ ++c;this._dictListener[t.itemId]||(this._dictListener[t.itemId]={});this._dictListener[t.itemId][n]=e;return{key:n}};e.prototype.fetchItemAnalytics=function(e,t){var i=this;this._clearErrorResponse();if(!this._dictItemAnalytics[e.itemId]||!this._dictItemAnalytics[e.itemId].data)if(u.Killswitch.isActivated("30ddf998-5836-4a46-b116-41e73697fc75","6/6/2019","Switch to single query API to get item analytics")){this._rectActionsShadowCall(e);this._promiseDeduplicator.deduplicate(e.itemId,function(){return s.default.all({allTimeItemAnalytics:i._itemAnalyticsDataSource.getItemAnalytics(e,{skipToken:t}),analyticsSections:i._itemAnalyticsDataSource.getAnalyticsSections(e)}).then(function(t){var s=t.allTimeItemAnalytics,o=t.analyticsSections,u=n.__assign({},o,s),a={status:r.AnalyticsResultStatus.succeed,data:u,skipToken:s&&s.skipToken,actions:void 0};i._dictItemAnalytics[e.itemId]=a;i._emitChange(e)},function(t){var n,s=t&&t.allTimeItemAnalytics;if(s&&"FileTypeNotSupported"===s.message)n=r.AnalyticsResultStatus.unsupport;else{if(s&&"Canceled"===s.message||"Canceled"===t)return;n=r.AnalyticsResultStatus.failed}i._dictItemAnalytics[e.itemId]={status:n,data:void 0,actions:void 0};t.error&&o.pageError(t.error);i._emitChange(e)})})}else{this._dictItemAnalytics[e.itemId]={status:r.AnalyticsResultStatus.failed,data:void 0,actions:void 0};this._getAllAnalyticsData(e);this._isSharePointListId||this._getRecommendedActions(e)}};e.prototype.getItemAnalytics=function(e){return this._dictItemAnalytics[e.itemId]};e.prototype.removeListener=function(e,t){this._dictListener[t.itemId][e.key]&&delete this._dictListener[t.itemId][e.key]};e.prototype.getDailyItemAnalytics=function(e){return this._getItemAnalyticsByInterval(e)};e.prototype.getMonthlyItemAnalytics=function(e){return this._getItemAnalyticsByInterval(e,720)};e.prototype.getAllTimeItemAnalytics=function(e){return this._itemAnalyticsDataSource.getItemAnalytics(e).then(function(e){var t=e.incompleteData&&e.incompleteData.missingDataBeforeDateTime;return n.__assign({activity:{},incompleteData:{missingDataBeforeDateTime:t&&new Date(t),wasThrottled:e.incompleteData&&e.incompleteData.wasThrottled},startDateTime:e.startDateTime&&new Date(e.startDateTime)},e)})};e.prototype.cleanCachedItem=function(e){this._dictItemAnalytics[e.itemId]&&delete this._dictItemAnalytics[e.itemId]};e.prototype.updateItemKeyPoints=function(e,t){var n=this;return this._itemAnalyticsDataSource.updateItemKeyPoints(e,t).then(function(t){var r=n._dictItemAnalytics[e.itemId];if(r&&r.data&&r.data.keyPointsData&&r.data.keyPointsData.keyPoints){var i=t.filter(function(e){return"Deleted"!==e.state});r.data.keyPointsData.keyPoints=i}n._emitChange(e)},function(){n._dictItemAnalytics[e.itemId]&&(n._dictItemAnalytics[e.itemId].status=r.AnalyticsResultStatus.failed);n._emitChange(e)})};e.prototype.dismissRecommendedAction=function(e,t,n,r,i){this._feedbackProvider.dismissRecommendedAction(e,t,n,r,i)};e.prototype._getItemAnalyticsByInterval=function(e,t){var n=new Date;n=new Date(Date.UTC(n.getFullYear(),n.getMonth(),n.getDate()));var r=new Date,i=new Date;r.setDate(r.getDate()-90);i.setHours(r.getHours()-1440);return this._itemAnalyticsDataSource.getItemAnalyticsByInterval(e,r,n,t)};e.prototype._clearErrorResponse=function(){for(var e in this._dictItemAnalytics)this._dictItemAnalytics[e].status===r.AnalyticsResultStatus.failed&&delete this._dictItemAnalytics[e]};e.prototype._emitChange=function(e){var t=this._dictListener[e.itemId];for(var n in t)t&&t[n]()};e.prototype._cleanCache=function(){for(var e in this._dictItemAnalytics)this._dictItemAnalytics[e].status!==r.AnalyticsResultStatus.unsupport&&delete this._dictItemAnalytics[e]};e.prototype._getAllAnalyticsData=function(e){var t=this;this._promiseDeduplicator.deduplicate(e.itemId,function(){return t._itemAnalyticsDataSource.getItemAnalyticsSections(e)}).then(function(n){t._dictItemAnalytics[e.itemId].status=r.AnalyticsResultStatus.succeed;t._dictItemAnalytics[e.itemId].data=n;t._emitChange(e)},function(n){var i,s=n&&n.allTimeItemAnalytics;if(s&&"FileTypeNotSupported"===s.message)i=r.AnalyticsResultStatus.unsupport;else{if(s&&"Canceled"===s.message||"Canceled"===n)return;i=r.AnalyticsResultStatus.failed}t._dictItemAnalytics[e.itemId].status=i;t._dictItemAnalytics[e.itemId].data=void 0;s&&s.error&&o.pageError(s.error);t._emitChange(e)})};e.prototype._getRecommendedActions=function(e){var t=this;return s.default.all({recommendedActions:this._itemAnalyticsDataSource.getRecommendedActions(e),shareWith:this._itemAnalyticsDataSource.getShareWith(e),editActivities:this._itemAnalyticsDataSource.getEditActivities(e)}).then(function(n){var r=n.recommendedActions,i=n.shareWith,s=n.editActivities,o=r.nonAggregatedRecommendedActions;r.aggregatedEditRecommendedAction&&r.aggregatedEditRecommendedAction.recentEditorCount&&(o=o.concat(r.aggregatedEditRecommendedAction));t._dictItemAnalytics[e.itemId].actions={recommendedActions:o,shareWith:i,editActivities:s};t._emitChange(e)},function(){t._dictItemAnalytics[e.itemId].actions=void 0;t._emitChange(e)})};e.prototype._rectActionsShadowCall=function(e){if(!u.Killswitch.isActivated("395055ac-8599-4d74-a936-34d686333d03","4/25/2019","Recommended actions shadow call")&&!this._isSharePointListId){this._itemAnalyticsDataSource.getRecommendedActions(e);this._itemAnalyticsDataSource.getShareWith(e);this._itemAnalyticsDataSource.getEditActivities(e)}};return e}();t.FileHoverCardStore=h});
define("@ms/odsp-utilities/lib/async/PromiseDeduplicator",["require","exports","./Promise"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._pendingPromises={}}e.prototype.deduplicate=function(e,t){var r=this;if(!this._pendingPromises[e]){var i=t();this._pendingPromises[e]=i;return i.then(function(t){delete r._pendingPromises[e];return t},function(t){delete r._pendingPromises[e];return n.default.reject(t)})}return this._pendingPromises[e]};return e}();t.default=r});
define("@ms/odsp-datasources/lib/providers/fileHoverCard/FeedbackProvider",["require","exports","@ms/odsp-utilities/lib/uri/Uri","../../utilities/url/ItemUrlHelper"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this._pageContext=t.pageContext;this._dataRequestor=new t.dataRequestorType({qosName:"FileHoverCardFeedback"});this._itemUrlHelper=new r.ItemUrlHelper({},{pageContext:this._pageContext})}e.prototype.dismissRecommendedAction=function(e,t,r,i,s){var o=this._itemUrlHelper.getUrlParts({path:e.path}),u=o.webRelativeItemUrl.replace("/"+t,""),a={ListId:this._pageContext.listId,ListItemUniqueId:i,Operation:"RecommendationActedOn",AffectedResourceUrl:o.fullItemUrl,ItemType:"File",json:JSON.stringify({FileName:t,Scenario:"RecommendedActions",SourceRelativeUrl:u,DismissRecommendationsCategory:"FocusedTask",PositionNumber:(s+1).toString(),TotalRecommendationsPresented:"3",RecommendationAlgorithmVersion:"1",ReferringCorrelationId:r,Canvas:"Web",Workload:"SharePoint",WebId:this._pageContext.webId,SiteId:this._pageContext.siteId,SiteUrl:this._pageContext.siteAbsoluteUrl,ClientLocalTime:(new Date).toISOString(),SourceFileName:t,SourceFileExtension:e.extension,ClientUTCOffsetInMinutes:(new Date).getTimezoneOffset().toString(),RecommendationId:r,ActionType:"Dismiss"})},f=new n.default(this._pageContext.webAbsoluteUrl+"/_api/web/ActivityLogger/FeedbackDirect");this._dataRequestor.getData({url:f.toString(),qosName:"DismissActions",method:"POST",needsRequestDigest:!0,additionalPostData:JSON.stringify(a),timeout:6e3,qosExtraData:{Caller:"HoverCard"}})};return e}();t.FeedbackProvider=i});
define("@ms/shared-react-item-hover-card/lib/AnalyticsKeyPoints/AnalyticsKeyPointsEditor",["require","exports","tslib","react","office-ui-fabric-react/lib/TextField","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/components/ActivityItem/index","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Link","office-ui-fabric-react/lib/List","office-ui-fabric-react/lib/Spinner","../IFileHoverCardStore","./AnalyticsKeyPointsFeedback","../HoverCardLoggerHelper","office-ui-fabric-react/lib/FocusZone","../FileHoverCard.resx","./AnalyticsKeyPointsEditor.module.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._getKeyPoints=function(){var e=i.props.fileHoverCardStore.getItemAnalytics(i.props.item);return e&&e.data&&e.data.keyPointsData&&e.data.keyPointsData.keyPoints||[]};i._onRenderCell=function(e,t){return e&&void 0!==t&&r.createElement("div",{className:m.fileHoverCardKeyPointsEditorCell,"data-is-focusable":!0,role:"listitem"},r.createElement(o.ActivityItem,{activityDescriptionText:e.text}),r.createElement(u.IconButton,{iconProps:{iconName:"Delete"},className:m.fileHoverCardKeyPointsEditorDeleteIcon,checked:!1,disabled:!1,onClick:function(){return i._onDeleteKeyPoint(t)},ariaLabel:v.default.Delete}))};i._onAddKeyPointClick=function(){i.setState(n.__assign({},i.state,{showInputBox:!0}));p.default("FileHoverCard.KeyPoints.Add",i.props.item)};i._isInputValid=function(){var e=i.state.inputValue.length;return e>0&&e<100};i._onInputChange=function(e,t){i.setState(n.__assign({},i.state,{inputValue:t||""}))};i._getErrorMessage=function(e){return e.length>100?v.default.KeyPointsInvalidMessage:i.state.status===c.AnalyticsResultStatus.failed?v.default.RequestFailureWarning:void 0};i._onSaveClick=function(){var e=i.state.keyPoints,t=JSON.parse(JSON.stringify(e));t.unshift({text:i.state.inputValue,isUserEdited:!0});i.setState(n.__assign({},i.state,{isSaving:!0}));i._updateKeyPoints(t);p.default("FileHoverCard.KeyPoints.Save",i.props.item)};i._onCancelClick=function(){i.setState(n.__assign({},i.state,{showInputBox:!1,status:c.AnalyticsResultStatus.succeed}));p.default("FileHoverCard.KeyPoints.Cancel",i.props.item)};i._addListener=function(){var e=i.props.fileHoverCardStore;i._storeListener=e.addListener(function(){var e=i.props.fileHoverCardStore.getItemAnalytics(i.props.item).status;i.setState(function(t){return n.__assign({},i.state,{showInputBox:(!t.isSaving||e!==c.AnalyticsResultStatus.succeed)&&t.showInputBox,isSaving:!1,keyPoints:i._getKeyPoints(),inputValue:"",status:e})})},i.props.item);e.fetchItemAnalytics(i.props.item)};i._onFeedbackClick=function(){i.setState({showFeedback:!0});i.props.onFeedbackClick();p.default("FileHoverCard.KeyPoints.SendFeedback",i.props.item)};i.state={inputValue:"",isSaving:!1,showInputBox:!1,keyPoints:i._getKeyPoints(),showFeedback:i.props.showFeedbackPanel,status:c.AnalyticsResultStatus.succeed};return i}t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.item!==this.props.item&&this.setState(n.__assign({},this.state,{keyPoints:this._getKeyPoints()}))};t.prototype.componentDidMount=function(){this._addListener()};t.prototype.componentDidUpdate=function(e){if(this.props.item.itemId!==e.item.itemId){this._removeListener();this._addListener()}};t.prototype.componentWillUnmount=function(){this._removeListener()};t.prototype.render=function(){var e=this.state,t=e.showInputBox,n=e.keyPoints,o=e.isSaving,u=n&&JSON.parse(JSON.stringify(n));return this.state.showFeedback?r.createElement(h.AnalyticsKeyPointsFeedback,{keyPoints:n,item:this.props.item}):r.createElement("div",{className:m.fileHoverCardKeyPointsEditor},r.createElement(a.Link,{className:m.fileHoverCardKeyPointsEditorAddKeyPointLink,onClick:this._onAddKeyPointClick},v.default.keyPointsAdd),t&&r.createElement("div",{className:m.fileHoverCardKeyPointsEditorInputSection},r.createElement(i.TextField,{multiline:!0,rows:4,value:this.state.inputValue,placeholder:v.default.keyPointInputPlaceholder,onGetErrorMessage:this._getErrorMessage,onChange:this._onInputChange}),o?r.createElement(l.Spinner,{className:m.fileHoverCardKeyPointsEditorSpinner,size:l.SpinnerSize.medium}):r.createElement("div",{className:m.fileHoverCardKeyPointsEditorButtons},r.createElement(s.DefaultButton,{primary:!0,disabled:!this._isInputValid(),text:v.default.buttonSave,onClick:this._onSaveClick}),r.createElement(s.DefaultButton,{className:m.fileHoverCardKeyPointsEditorButtonCancel,text:v.default.buttonCancel,onClick:this._onCancelClick}))),r.createElement(d.FocusZone,{direction:d.FocusZoneDirection.vertical,isCircularNavigation:!0,"aria-label":v.default.KeyPointsListScreenReader,role:"list"},r.createElement(f.List,{items:u,onRenderCell:this._onRenderCell})),r.createElement(a.Link,{className:m.fileHoverCardKeyPointsEditorAddKeyPointLink,onClick:this._onFeedbackClick},v.default.SendFeedback))};t.prototype._onDeleteKeyPoint=function(e){var t=this.state.keyPoints;t[e].state="Deleted";this._updateKeyPoints(t);p.default("FileHoverCard.KeyPoints.Delete",this.props.item,{keyPointId:e&&t[e].keyPointId});t.splice(e,1);this.setState(n.__assign({},this.state,{inputValue:""}))};t.prototype._updateKeyPoints=function(e){this.props.fileHoverCardStore.updateItemKeyPoints(this.props.item,e)};t.prototype._removeListener=function(){this.props.fileHoverCardStore.removeListener(this._storeListener,this.props.item)};return t}(r.Component);t.AnalyticsKeyPointsEditor=g});
define("@ms/shared-react-item-hover-card/lib/AnalyticsKeyPoints/AnalyticsKeyPointsFeedback",["require","exports","tslib","react","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Tooltip","office-ui-fabric-react/lib/Link","office-ui-fabric-react/lib/Checkbox","office-ui-fabric-react/lib/Button","@ms/odsp-utilities/lib/string/StringHelper","../HoverCardLoggerHelper","office-ui-fabric-react/lib/FocusZone","./AnalyticsKeyPointsFeedback.module.scss","../FileHoverCard.resx"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d;!function(e){e[e.YES=0]="YES";e[e.NO=1]="NO";e[e.NONE=2]="NONE"}(d=t.FeedbackAnswer||(t.FeedbackAnswer={}));var v=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onClickKeyPointsYes=function(){n.setState({keyPointsAnswer:d.YES});l.default("FileHoverCard.KeyPoints.ClickYes",n.props.item)};n._onClickKeyPointsNo=function(){n.setState({keyPointsAnswer:d.NO});l.default("FileHoverCard.KeyPoints.ClickNo",n.props.item)};n._onARTClickYES=function(){n.setState({ARTAnswer:d.YES});l.default("FileHoverCard.TimeToRead.ClickYes",n.props.item)};n._onARTClickNO=function(){n.setState({ARTAnswer:d.NO});l.default("FileHoverCard.TimeToRead.ClickNo",n.props.item)};n._onClickARTSubmit=function(){n.setState({ARTSubmitted:!0});l.default("FileHoverCard.TimeToRead.Submit",n.props.item,n._extraData);n._extraData={}};n._onClickKeyPointsSubmit=function(){n.setState({keyPointsSubmitted:!0});l.default("FileHoverCard.KeyPoints.Submit",n.props.item,n._extraData);n._extraData={}};n.state={ARTAnswer:d.NONE,keyPointsAnswer:d.NONE,ARTSubmitted:!1,keyPointsSubmitted:!1,showARTReasons:!1,showKeyPointsReasons:!1};n._extraData={};return n}t.prototype.render=function(){return r.createElement("div",null,r.createElement("div",{className:h.fileHoverCardFeedbackTitle},p.default.AverageReadingTime,r.createElement(s.TooltipHost,{hostClassName:h.fileHoverCardFeedbackTooltip,content:p.default.TooltipMessage,directionalHint:s.DirectionalHint.bottomCenter},r.createElement(i.Icon,{iconName:"Info",ariaLabel:p.default.TooltipMessage,role:"tooltip",tabIndex:0}))),this.state.ARTSubmitted?this._feedbackSubmitted:r.createElement(r.Fragment,null,r.createElement(c.FocusZone,{direction:c.FocusZoneDirection.vertical,"aria-label":p.default.AnalyticsKeyPointsFeedbackExplanation,role:"group"},this._timeToReadFeedback(this.state.ARTAnswer)),this.state.ARTAnswer!==d.NONE&&r.createElement(a.PrimaryButton,{className:h.fileHoverCardFeedbackSubmit,text:p.default.Submit,onClick:this._onClickARTSubmit})),r.createElement("div",{className:h.fileHoverCardFeedbackTitle},p.default.keyPointsTitle),this.state.keyPointsSubmitted?this._feedbackSubmitted:r.createElement(r.Fragment,null,r.createElement(c.FocusZone,{direction:c.FocusZoneDirection.vertical,"aria-label":p.default.AnalyticsKeyPointsFeedbackExplanation,role:"group"},this._keyPointsFeedback(this.state.keyPointsAnswer)),this.state.keyPointsAnswer!==d.NONE&&r.createElement(a.PrimaryButton,{className:"ms-FileHoverCard-Feedback--Submit",text:p.default.Submit,onClick:this._onClickKeyPointsSubmit})))};t.prototype._timeToReadFeedback=function(e){var t=this;switch(e){case d.YES:return r.createElement("div",{className:h.fileHoverCardFeedbackCheckbox},this._feedbackMessage(e),r.createElement(u.Checkbox,{label:p.default.LikeART,onChange:function(e,n){t._extraData.LikeTimeToRead=n}}),r.createElement(u.Checkbox,{label:p.default.ARTCorrect,onChange:function(e,n){t._extraData.CorrectTimeToRead=n}}));case d.NO:return r.createElement("div",{className:h.fileHoverCardFeedbackCheckbox},this._feedbackMessage(e),r.createElement(u.Checkbox,{label:p.default.NotLikeART,onChange:function(e,n){t._extraData.NotLikeTimeToRead=n}}),r.createElement(u.Checkbox,{label:p.default.ARTIncorrect,onChange:function(e,n){return t.setState({showARTReasons:!!n})}}),this.state.showARTReasons&&r.createElement("div",{className:h.fileHoverCardFeedbackSubCheckbox},r.createElement(u.Checkbox,{label:p.default.TooLong,onChange:function(e,n){t._extraData.TooLong=n}}),r.createElement(u.Checkbox,{label:p.default.TooShort,onChange:function(e,n){t._extraData.TooShort=n}})));case d.NONE:return r.createElement("div",{className:h.fileHoverCardFeedbackOption},p.default.Feedback,r.createElement(o.Link,{className:h.fileHoverCardFeedbackChoiceLink,onClick:this._onARTClickYES,role:"button","aria-label":p.default.AverageReadingTime+" "+p.default.Feedback+" "+p.default.Yes},p.default.Yes),r.createElement(o.Link,{className:h.fileHoverCardFeedbackChoiceLink,onClick:this._onARTClickNO,role:"button","aria-label":p.default.AverageReadingTime+" "+p.default.Feedback+" "+p.default.No},p.default.No))}};t.prototype._keyPointsFeedback=function(e){var t=this;switch(e){case d.YES:return r.createElement("div",{className:h.fileHoverCardFeedbackCheckbox},this._feedbackMessage(e),r.createElement(u.Checkbox,{label:p.default.LikeKeyPoints,onChange:function(e,n){t._extraData.LikeKeyPoints=n}}),r.createElement(u.Checkbox,{label:p.default.CorrectKeyPoints,onChange:function(e,n){return t.setState({showKeyPointsReasons:!!n})}}),this.state.showKeyPointsReasons&&this._subCheckbox(d.YES));case d.NO:return r.createElement("div",{className:h.fileHoverCardFeedbackCheckbox},this._feedbackMessage(e),r.createElement(u.Checkbox,{label:p.default.NotLikeKeyPoints,onChange:function(e,n){t._extraData.NotLikeKeyPoints=n}}),r.createElement(u.Checkbox,{label:p.default.NotAnalyzeKeyPoints,onChange:function(e,n){t._extraData.NotAnalyzeKeyPoints=n}}),r.createElement(u.Checkbox,{label:p.default.IncorrectKeyPoints,onChange:function(e,n){return t.setState({showKeyPointsReasons:!!n})}}),this.state.showKeyPointsReasons&&this._subCheckbox(d.NO));case d.NONE:return r.createElement("div",{className:h.fileHoverCardFeedbackOption},p.default.Feedback,r.createElement(o.Link,{className:h.fileHoverCardFeedbackChoiceLink,onClick:this._onClickKeyPointsYes,role:"button","aria-label":p.default.keyPointsTitle+" "+p.default.Feedback+" "+p.default.Yes},p.default.Yes),r.createElement(o.Link,{className:h.fileHoverCardFeedbackChoiceLink,onClick:this._onClickKeyPointsNo,role:"button","aria-label":p.default.keyPointsTitle+" "+p.default.Feedback+" "+p.default.No},p.default.No))}};t.prototype._subCheckbox=function(e){var t=this;return r.createElement("div",{className:h.fileHoverCardFeedbackSubCheckbox},r.createElement("div",null,e===d.YES?p.default.SelectCorrectKeyPoints:p.default.SelectIncorrectKeyPoints),this.props.keyPoints&&this.props.keyPoints.map(function(n,i){return r.createElement(u.Checkbox,{key:i,label:n.text,onChange:function(n,r){return t._logKeyPointId(r,i,e===d.YES?"CorrectKeyPointId":"InCorrectKeyPointId")}})}))};t.prototype._feedbackMessage=function(e){return r.createElement("div",{className:h.fileHoverCardFeedbackMessage},r.createElement("div",null,p.default.Thanks),r.createElement("div",null,f.format(p.default.FeedbackReason,e===d.YES?p.default.Yes:p.default.No)))};Object.defineProperty(t.prototype,"_feedbackSubmitted",{get:function(){return r.createElement("div",{className:h.fileHoverCardFeedbackMessage},r.createElement(i.Icon,{iconName:"Accept"}),p.default.FeedbackSubmitted)},enumerable:!0,configurable:!0});t.prototype._logKeyPointId=function(e,t,n){e&&l.default("FileHoverCard.KeyPoints."+n,this.props.item,{keyPointId:this.props.keyPoints[t].keyPointId})};return t}(r.Component);t.AnalyticsKeyPointsFeedback=v});
define("@ms/shared-react-item-hover-card/lib/AnalyticsKeyPoints/AnalyticsKeyPointsFeedback.module.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".fileHoverCardFeedbackTitle_c4e67aa3{font-size:14px;font-weight:600;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.fileHoverCardFeedbackTitle_c4e67aa3 .fileHoverCardFeedbackTooltip_c4e67aa3{vertical-align:middle}[dir='ltr'] .fileHoverCardFeedbackTitle_c4e67aa3 .fileHoverCardFeedbackTooltip_c4e67aa3{padding-left:8px}[dir='rtl'] .fileHoverCardFeedbackTitle_c4e67aa3 .fileHoverCardFeedbackTooltip_c4e67aa3{padding-right:8px}.fileHoverCardFeedbackOption_c4e67aa3{font-size:14px;font-weight:400;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";padding:12px 0 28px}[dir='ltr'] .fileHoverCardFeedbackOption_c4e67aa3 .fileHoverCardFeedbackChoiceLink_c4e67aa3{padding-left:20px}[dir='rtl'] .fileHoverCardFeedbackOption_c4e67aa3 .fileHoverCardFeedbackChoiceLink_c4e67aa3{padding-right:20px}.fileHoverCardFeedbackMessage_c4e67aa3{color:"},{theme:"blue",defaultValue:"#0078d4"},{rawString:";font-size:14px;font-weight:400;padding:12px 0 20px}.fileHoverCardFeedbackCheckbox_c4e67aa3 .ms-Checkbox{padding:8px 0}.fileHoverCardFeedbackSubmit_c4e67aa3{margin:16px 0 28px}.fileHoverCardFeedbackSubCheckbox_c4e67aa3{font-size:12px}[dir='ltr'] .fileHoverCardFeedbackSubCheckbox_c4e67aa3{padding-left:25px}[dir='rtl'] .fileHoverCardFeedbackSubCheckbox_c4e67aa3{padding-right:25px}.fileHoverCardFeedbackSubCheckbox_c4e67aa3 .ms-Checkbox-text{font-size:12px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.fileHoverCardFeedbackSubCheckbox_c4e67aa3 .ms-Checkbox-checkbox{width:16px;height:16px}\n"}]);t.fileHoverCardFeedbackTitle="fileHoverCardFeedbackTitle_c4e67aa3";t.fileHoverCardFeedbackTooltip="fileHoverCardFeedbackTooltip_c4e67aa3";t.fileHoverCardFeedbackOption="fileHoverCardFeedbackOption_c4e67aa3";t.fileHoverCardFeedbackChoiceLink="fileHoverCardFeedbackChoiceLink_c4e67aa3";t.fileHoverCardFeedbackMessage="fileHoverCardFeedbackMessage_c4e67aa3";t.fileHoverCardFeedbackCheckbox="fileHoverCardFeedbackCheckbox_c4e67aa3";t.fileHoverCardFeedbackSubmit="fileHoverCardFeedbackSubmit_c4e67aa3";t.fileHoverCardFeedbackSubCheckbox="fileHoverCardFeedbackSubCheckbox_c4e67aa3"});
define("@ms/shared-react-item-hover-card/lib/AnalyticsKeyPoints/AnalyticsKeyPointsEditor.module.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".fileHoverCardKeyPointsEditor_52f8c0d5{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.fileHoverCardKeyPointsEditorInputSection_52f8c0d5{margin:12px 0}.fileHoverCardKeyPointsEditorSpinner_52f8c0d5{padding-top:12px}.fileHoverCardKeyPointsEditorSpinner_52f8c0d5 .ms-Spinner-circle{margin:0}.fileHoverCardKeyPointsEditorButtons_52f8c0d5{padding-top:12px}.fileHoverCardKeyPointsEditorButtonCancel_52f8c0d5{margin:0 12px}.fileHoverCardKeyPointsEditorAddKeyPointLink_52f8c0d5{font-size:12px;font-weight:600;font-family:inherit}.fileHoverCardKeyPointsEditorCell_52f8c0d5{-webkit-box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,0.132),0 0.6px 1.8px 0 rgba(0,0,0,0.108);box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,0.132),0 0.6px 1.8px 0 rgba(0,0,0,0.108);display:-webkit-box;display:-ms-flexbox;display:flex;margin:20px 0}.fileHoverCardKeyPointsEditorCell_52f8c0d5 .ms-ActivityItem{width:100%;margin:12px}.fileHoverCardKeyPointsEditorCell_52f8c0d5 .ms-ActivityItem-activityText{font-size:14px}.fileHoverCardKeyPointsEditorCell_52f8c0d5:hover .fileHoverCardKeyPointsEditorDeleteIcon_52f8c0d5,.fileHoverCardKeyPointsEditorCell_52f8c0d5:focus .fileHoverCardKeyPointsEditorDeleteIcon_52f8c0d5{opacity:1}.fileHoverCardKeyPointsEditorDeleteIcon_52f8c0d5{opacity:0}.fileHoverCardKeyPointsEditorDeleteIcon_52f8c0d5 .ms-Button-icon{font-size:12px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}\n"}]);t.fileHoverCardKeyPointsEditor="fileHoverCardKeyPointsEditor_52f8c0d5";t.fileHoverCardKeyPointsEditorInputSection="fileHoverCardKeyPointsEditorInputSection_52f8c0d5";t.fileHoverCardKeyPointsEditorSpinner="fileHoverCardKeyPointsEditorSpinner_52f8c0d5";t.fileHoverCardKeyPointsEditorButtons="fileHoverCardKeyPointsEditorButtons_52f8c0d5";t.fileHoverCardKeyPointsEditorButtonCancel="fileHoverCardKeyPointsEditorButtonCancel_52f8c0d5";t.fileHoverCardKeyPointsEditorAddKeyPointLink="fileHoverCardKeyPointsEditorAddKeyPointLink_52f8c0d5";t.fileHoverCardKeyPointsEditorCell="fileHoverCardKeyPointsEditorCell_52f8c0d5";t.fileHoverCardKeyPointsEditorDeleteIcon="fileHoverCardKeyPointsEditorDeleteIcon_52f8c0d5"});
define("odsp-next/dataSources/base/odb/DataRequestor",["require","exports","@ms/odsp-datasources/lib/dataSources/base/DataRequestor","../../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DataRequestor=n.default;t.typeResourceKey=i.createResolvedTypeResourceKey(e("module").id,n.default,{pageContext:r.pageContext});t.default=n.default});
define("odsp-next/controls/fileHoverCard/react/FileHoverCard",["require","exports","tslib","react","prop-types","knockout","@ms/shared-react-item-hover-card/lib/index","../../list/react/detailsList/fields/FileTypeIconRenderer","../../../dataSources/itemAnalytics/store/FileHoverCardStore","../../../resources/ControlResourceKeys","../../sharing/share/commands/ShareCommandBuilder","@ms/odsp-datasources/lib/Url","../../../resources/SPOResourceKeys","../../../dataSources/url/QueryType","../../../resources/DataSourceResourceKeys","../../../controls/commands/Commands.resx","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../../providers/engagement/Engagement","../../list/react/detailsList/fields/NameFieldHeroCommandRenderer","./FileHoverCardHelper","@ms/odsp-utilities/lib/modules/ModuleHelper","../../../models/scope/Scope","./FileHoverCard.css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=function(t){n.__extends(S,t);function S(n){var i=t.call(this,n)||this;i.onFileIconRender=function(){return r.createElement("div",{className:"ms-FileHoverCard-compactCard--fileIcon"},u.renderFileTypeIcon({item:i.props.item,size:32,resources:i.resources,isDisabled:!1}))};i.getAccessToken=function(){return b.getGraphAccessToken(i.state.graphDataSource,i.props.item)};i.onKeyPoints=function(e){i._engagement.logData({name:"FileHoverCard.KeyPoints.OpenEditPanel"});i._showKeyPointsAction(e,!1)};i.onSendFeedbackClick=function(e){i._engagement.logData({name:"FileHoverCard.KeyPoints.SendFeedback"});i._showKeyPointsAction(e,!0)};i.onView=function(e){new(i.resources.injected(i.actionMap.ShowItemAnalyticsAction))({item:s.observable(i.props.item)}).execute(e)};i.onShare=function(e){i._engagement.logData({name:"FileHoverCard.CommandBar.ShareClick"});i._selectItem(e);var t=new(i.resources.injected(i.actionMap.ShowShareAction))({focusItemResourceKey:l.shareFocusItemResourceKey});i.props.onClickShare?i.props.onClickShare(e):t.execute(e)};i.onDetails=function(e,t){i._openInfoPane(e)};i.onFileCheckin=function(e){i._engagement.logData({name:"FileHoverCard.LifeCycle.FileCheckIn"});i._selectItem(e);(new(i.resources.injected(i.actionMap.CheckInAction))).execute(e)};i.onDiscardCheckOut=function(e){i._engagement.logData({name:"FileHoverCard.LifeCycle.DiscardCheckOut"});i._selectItem(e);(new(i.resources.injected(i.actionMap.UndoCheckOutAction))).execute(e)};i.onViewPolicyTip=function(t){i._engagement.logData({name:"FileHoverCard.LifeCycle.ViewPolicyTip"});i._selectItem(t);new Promise(function(t,n){e(["../../../actions/PolicyTipAction"],t,n)}).then(w.getDefaultExport).then(function(e){new(i.resources.injected(e))({item:s.observable(i.props.item)}).execute(t)})};i.onAddMetadataNow=function(e){i._engagement.logData({name:"FileHoverCard.LifeCycle.AddMetadata"});i._selectItem(e);new(i.resources.injected(i.actionMap.EditItemAction))({item:s.observable(i.props.item)}).execute(e)};i._onShareWithDefaultPeople=function(e,t){i._selectItem(e);var n=new(i.resources.injected(i.actionMap.ShowShareAction))({focusItemResourceKey:l.shareFocusItemResourceKey,defaultRecipients:t});i.props.onClickShare?i.props.onClickShare(e):n.execute(e)};i.resources=n.resources;i.state={fileHoverCardStore:i.resources.consume(a.resourceKey.optional),graphDataSource:i.resources.consume(d.graph.optional),target:i.props.target};i.actionMap=i.resources.consume(f.actionMap);i._pageContext=i.resources.consume(h.pageContext);i._platform=i.resources.consume(m.platformDetection);i._engagement=i.resources.consume(g.resourceKey);i._itemSetSelectionModel=i.resources.consume(f.itemsSelection);i._scope=new E.default;return i}S.prototype.componentDidMount=function(){var e=this,t=this.resources.consumeAsync(a.resourceKey),n=this.resources.consumeAsync(d.graph);this._scope.trackPromise(t);this._scope.trackPromise(n);t.then(function(t){e.setState({fileHoverCardStore:t})});n.then(function(t){e.setState({graphDataSource:t})});if(this.props.getUpdatedTarget){var r=this.props.getUpdatedTarget();this.setState({target:r})}};S.prototype.componentWillUnmount=function(){this._scope.dispose()};S.prototype.render=function(){var e=this.state,t=e.fileHoverCardStore,i=e.graphDataSource;if(!this.props.item)return null;var s=this.props.item,u=s.appMap,a=s.dateModified,f=s.extension,l=s.graph,h=s.itemId,d=s.isPlaceholder,m=s.lifeCycleStatus,g=s.name,w=s.openUrl,E=s.properties,S=s.queryType,x=s.id;if(d)return null;var T=E&&E.modifiedByUser,N=b.getGraphItemUrl(i,this.props.item),C=T&&T.email,k=T&&T.title,L=T&&C?{displayName:k||"",id:h||"",email:C,image:c.getUserPhotoUrl({userLoginName:C})}:void 0,A=m&&m.isMalwareDetected?void 0:[{key:"share",iconProps:{iconName:"share"},title:v.strings.Share,onClick:this.onShare}],O=this._platform.isMobile,M={itemTitle:g||"",item:{itemId:h,graph:l,extension:f,queryType:p.default[S||0],graphItemUrl:N,getAccessToken:this.getAccessToken,appMap:u,path:x},target:this.state.target,currentUserActivity:{activityDateTime:a||"",activityType:"Modified",actor:{user:L}},onDetails:this.canShowActions()?this.onDetails:void 0,onKeyPointsClick:this.onKeyPoints,onView:this.onView,onCheckIn:this.onFileCheckin,onDiscardCheckOut:this.onDiscardCheckOut,onViewPolicyTip:this.onViewPolicyTip,onAddMetadataNow:this.onAddMetadataNow,isViewCountClickable:!0,actionBarItems:this.canShowActions()?A:void 0,loginUserEmail:this._pageContext.userLoginName,userEmail:this._pageContext.userEmail,pageUrl:w,gapSpace:this.props.gapData?12+this.props.gapData.inlineCommandCount*y.COMMAND_BUTTON_WIDTH:0,onSendFeedbackClick:this.onSendFeedbackClick,onShareWith:this._onShareWithDefaultPeople,uniqueId:E&&E.uniqueId,onRenderFileTypeIcon:this.onFileIconRender,onRenderShareWithPeople:this.props.onRenderShareWithPeople};return t&&i&&!O?r.createElement(o.FileHoverCard,n.__assign({},M)):this.props.children?this.props.children:null};S.prototype.getChildContext=function(){return{fileHoverCardStore:this.state.fileHoverCardStore}};S.prototype._selectItem=function(e){new(this.resources.injected(this.actionMap.SelectAction))({item:s.observable(this.props.item),showProperties:!1}).execute(e)};S.prototype._showKeyPointsAction=function(e,t){new(this.resources.injected(this.actionMap.ShowKeyPointsAction))({item:s.observable(this.props.item),showFeedbackPanel:t}).execute(e)};S.prototype._openInfoPane=function(e){var t=s.observable(this.props.item);new(this.resources.injected(this.actionMap.SelectAction))({item:t,selectItems:[t],showProperties:!0}).execute(e)};S.prototype.canShowActions=function(){var e=this.props.item,t=s.observable(e);return!e.isPlaceholder&&this._itemSetSelectionModel.canSelectItem(t)};S.childContextTypes={fileHoverCardStore:i.object.isRequired};return S}(r.Component);t.default=S});
define("odsp-next/controls/list/react/detailsList/fields/FileTypeIconRenderer",["require","exports","react","knockout","../../../../../utilities/icons/IconHelper","@ms/odsp-utilities/lib/icons/IconSelector","../../../../../models/item/ItemType","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-utilities/lib/modules/ModuleHelper","../../../../../utilities/icons/OfficeFileNameHelper","../../../../../providers/fileHandler/FileHandlerProvider","@ms/odsp-list-utilities/lib/Renderers/FileTypeIconRenderer","../../../../../utilities/accessibility/AriaHelper","@ms/odsp-utilities/lib/resources/Resources","../../../../../utilities/complianceTag/ComplianceTagUtilities","../../../../../utilities/features/Features","../../../../fileTypeIcon/FileTypeIcon.css","../ReactDetailsList.css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m,g;!function(e){e.vaultOpen="vaultopen";e.vaultClosed="vaultclosed"}(m||(m={}));!function(e){e[e.none=0]="none";e.checkOut="checkOutOverlay.svg";e.notify="notifyOverlay.svg";e.block="blockOverlay.svg";e.record="recordOverlay.svg"}(g||(g={}));function y(t){var p=t.item,y=t.resources,b=t.size;if(!p)return null;var w=p.properties,E=4===p.state.upload.status?s.genericFile:function(e){return e.type===o.default.Folder?s.getIconNameFromItem({extension:e.extension,isDocSet:e.isDocSet,listItem:e,sharingType:e.sharingType,type:e.type}):e.iconName}(p),S=p.extension,x=y.consume(l.resourceKey.optional),T=p.vault&&p.vault.root?function(e,t,n){var r=t.vault.isLocked?m.vaultClosed:m.vaultOpen;return i.getIconUrl(e,r,n)}(y,p,b):p.iconUrl||t.preferAppIcon&&function(e,t){var n=e.appMap;if((!e.extension||".pdf"!==e.extension.toLowerCase())&&n){var r=f.getAppName(n),i=t>=48?48:16;if(r){var s=v.isFeatureEnabled(v.UseNewFluentIcons)?"appsFluent":"apps";return window.require.toUrl("odsp-media/images/"+s.toLowerCase()+"/"+r.toLowerCase()+"_"+i+"x1.svg")}}return}(p,b)||function(e,t){return e&&e.getFileTypeIconUrl(t,!0)}(x,S)||i.getIconUrl(y,E,b),N=function(e,t){return e&&e.getFileTypeName(t,!0)}(x,S)||h.getIconFieldAriaLabelForItem(p),C=function(e){var t=g.none,n=e.policyTip;if(n){var r=1==(1&n);2==(2&n)?t=g.block:r&&(t=g.notify)}else e.isViolation?t=g.block:e.properties.CheckedOutUserId?t=g.checkOut:4===e.state.upload.status?t=g.notify:d.complianceRecordIconValue(e)&&(t=g.record);return t}(p),k=p.overlayUrl;k||C===g.none||(k=e.toUrl("odsp-media/images/overlays/"+C.toLowerCase()));var L=w.isDisabled||t.isDisabled,A=h.getTooltipText(p),O=!!(1&p.policyTip);return n.createElement(c.FileTypeIconRenderer,{iconName:E,width:b,iconUrl:T,iconTitle:"",overlayUrl:k,isDisabled:L,tooltipText:A,ariaLabel:N,isClickable:O,onClick:function(t){!function(t,n,i){if(1&t.policyTip){u.Engagement.logData({name:"PolicyTip.LaunchFromListView"});new Promise(function(t,n){e(["../../../../../actions/PolicyTipAction"],t,n)}).then(a.getDefaultExport).then(function(e){new(n.injected(e))({item:r.observable(t)}).execute(i)})}}(p,y,t)}})}t.renderFileTypeIcon=y;t.fileTypeIconRenderer=function(e){var t=e.item,n=e.column,r=e.isDisabled,i=e.resources;return y({item:t,size:n.minWidth||n.width,resources:i,isDisabled:r})};t.resourceKey=new p.ResourceKey({name:e("module").id,factory:new p.ConstantResourceFactory(t.fileTypeIconRenderer)})});
define("odsp-next/controls/list/react/detailsList/ReactDetailsList.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-focus--enabled .od-DetailsList a:focus{box-shadow:none}.od-DetailsList .ms-DetailsRow.is-dropping{background:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:";outline:1px solid transparent}.od-DetailsList .ms-DetailsRow.is-dropping .ms-DetailsRow-cell .FileTypeIcon-icon{-ms-transform:scale(1.5,1.5);transform:scale(1.5,1.5)}.od-DetailsList-groupHeader{margin-top:15px;margin-bottom:15px;font-size:17px}html[dir=ltr] .od-DetailsList-groupHeader{margin-left:96px}html[dir=rtl] .od-DetailsList-groupHeader{margin-right:96px}.od-DetailsListHeader-AddNewField{font-size:9px;color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}html[dir=ltr] .od-DetailsListHeader-AddNewField{margin-right:6px}html[dir=rtl] .od-DetailsListHeader-AddNewField{margin-left:6px}html[dir=ltr] .od-DetailsListHeader-AddNewField{padding-left:0}html[dir=rtl] .od-DetailsListHeader-AddNewField{padding-right:0}.ms-DetailsRow-cell.od-DetailsRow-cell--FileIcon{line-height:0;overflow:visible}.ms-DetailsRow-cell.od-DetailsRow-cell--Title{cursor:pointer}.ms-DetailsRow-cell [data-is-focusable=true]{outline:transparent;vertical-align:top}.ms-DetailsRow-cell .od-FieldRender-nofill{position:relative;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.isFluent .ms-DetailsRow-cell .od-FieldRender-userFluent{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-FieldRenderer-text{white-space:normal;overflow:hidden;max-height:7em}.od-FieldRenderer--disabled{opacity:.4}.od-DetailsHeader-cell--FileIcon span{display:-ms-inline-flexbox;display:inline-flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}.od-userWithTopCollaborator{display:-ms-flexbox;display:flex}.od-userWithTopCollaborator .ms-topCollaPlaceHolder{min-width:13px}html[dir=ltr] .od-userWithTopCollaborator .ms-topCollaPlaceHolder{padding-right:7px}html[dir=rtl] .od-userWithTopCollaborator .ms-topCollaPlaceHolder{padding-left:7px}.ms-DetailsRow-cell .od-FieldRender-lookup{display:block;max-width:100%}.od-DetailsRow-cell--VerticallyCenter{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center}.ms-Fabric.is-focusVisible .ms-DetailsRow-cell [data-is-focusable=true]:focus:after{position:absolute;content:'';left:0;top:0;right:0;bottom:0;border:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}html[dir] .ms-DetailsHeader-cell.od-DetailsHeader-addColumn{width:40px;padding:0;text-align:center}html[dir] .ms-DetailsHeader-cell.od-DetailsHeader-addColumn .ms-Icon{line-height:36px}html[dir] .ms-DetailsHeader-cell.od-DetailsHeader-cell:hover{background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}html[dir] .ms-DetailsHeader-cell.od-DetailsHeader-cell:active{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}html[dir] .ms-DetailsHeader-cell.od-DetailsHeader-cell:focus{border:1px "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}[dir=ltr] .ms-DetailsHeader-cell .ms-DetailsHeader-filterChevron.ms-Icon{padding-left:8px}[dir=rtl] .ms-DetailsHeader-cell .ms-DetailsHeader-filterChevron.ms-Icon{padding-right:8px}.ms-DetailsHeader-cell .ms-Icon.ms-Icon--GroupedList{position:relative;top:1px}.ms-DetailsHeader-cell .od-DetailsListHeader-FileTypeIcon.ms-Icon{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.od-DetailsList-screenReaderOnly{position:absolute;text-indent:-9999px;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;border:0}.od-DetailsListHeader-FileTypeIcon{font-size:16px;padding:0}.od-DetailsHeader-cell--FileIcon .ms-Icon{width:18px;text-align:center}.od-DetailsRow-needsAttention{position:relative}.od-DetailsRow-needsAttention:after{content:'';position:absolute;top:0;bottom:0}html[dir=ltr] .od-DetailsRow-needsAttention:after{left:-3px}html[dir=rtl] .od-DetailsRow-needsAttention:after{right:-3px}html[dir=ltr] .od-DetailsRow-needsAttention:after{border-left:3px solid "},{theme:"warningHighlight",defaultValue:"#ffb900"},{rawString:"}html[dir=rtl] .od-DetailsRow-needsAttention:after{border-right:3px solid "},{theme:"warningHighlight",defaultValue:"#ffb900"},{rawString:"}.ms-DetailsRow-cell .ms-Icon--People{position:relative;top:2px}.od-DetailsList .FileTypeIcon{margin:0 -2px}.od-DetailsList .ms-DetailsRow-cell .od-FieldRender-truncate{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.od-DetailsList .ms-DetailsList--Compact .od-DetailsRow-cell--FileIcon .FileTypeIcon{margin:0;padding:2px 0 0 0}.od-DetailsList .ms-DetailsList--Compact .ms-DetailsRow-check{width:32px;height:32px}.od-DetailsList .ms-DetailsList--Compact .od-FieldRenderer-shareHeroCommand i,.od-DetailsList .ms-DetailsList--Compact BUTTON.od-FieldRenderer-dot i{top:10px}.od-DetailsRow-cell--MruName .od-FieldRenderer-NameRenderer-SignalField,.od-DetailsRow-cell--Name .od-FieldRenderer-NameRenderer-SignalField{vertical-align:top;top:-1px;min-width:0}.od-DetailsRow-cell--MruName .od-FieldRenderer-NameRenderer-SignalField>span[class*=signalFieldValue],.od-DetailsRow-cell--Name .od-FieldRenderer-NameRenderer-SignalField>span[class*=signalFieldValue]{-ms-flex:1 1 auto!important;flex:1 1 auto!important}.od-DetailsRow-cell--MruName .od-FieldRenderer-NameRenderer-SignalField>span[class*=newSignal],.od-DetailsRow-cell--Name .od-FieldRenderer-NameRenderer-SignalField>span[class*=newSignal]{position:absolute}.od-DetailsRow-cell--MruName .od-FieldRenderer-NameRenderer-SignalField>span[class*=signalFieldBefore],.od-DetailsRow-cell--Name .od-FieldRenderer-NameRenderer-SignalField>span[class*=signalFieldBefore]{position:absolute;margin:0}.od-FieldRenderer-Renderer-withCommandAndMetata{display:-ms-flexbox;display:flex;height:100%;width:100%}.od-FieldRenderer-Renderer-withCommandAndMetata button.od-FieldRender-display--link{width:100%}.od-FieldRenderer-dotDotDotContainer,.od-FieldRenderer-heroCommandContainer{display:-ms-inline-flexbox;display:inline-flex;-ms-flex-negative:0;flex-shrink:0;margin-top:-11px;margin-bottom:-11px}.od-FieldRenderer-dotDotDotContainer .od-FieldRenderer-pin,.od-FieldRenderer-heroCommandContainer .od-FieldRenderer-pin{position:relative}.od-FieldRenderer-dotDotDotContainer{position:absolute;height:100%}.ms-DetailsList--Compact .od-FieldRenderer-heroCommandContainer{margin:-8px 0 -8px auto}html[dir=rtl] .ms-DetailsList--Compact .od-FieldRenderer-heroCommandContainer{margin:-8px auto -8px 0}.od-FieldRenderer-Renderer-withMetadata{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;min-width:0;-ms-flex-positive:1;flex-grow:1;overflow:hidden}.od-VaultSection{display:inline-block}.od-FieldRenderer-Renderer-withCommands{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.od-DetailsList .ms-GroupHeader-expand{font-size:12px;margin-top:-8px}button.ms-DetailsRow-check{padding:0}@keyframes ItemScope-NewRow{0%{max-height:0;opacity:0}20%{opacity:1}100%{max-height:210px;opacity:1}}@keyframes ItemScope-NewRow-compact{0%{max-height:0;opacity:0}20%{opacity:1}100%{max-height:160px;opacity:1}}@keyframes ItemScope-FreshRow{0%{left:-10px;opacity:0}50%{opacity:1}100%{left:0;opacity:1}}@keyframes ItemScope-OldRow{0%{left:0;opacity:1}100%{left:10px;opacity:0}}@keyframes ItemScope-FreshRow-rtl{0%{left:10px;opacity:0}50%{opacity:1}100%{left:0;opacity:1}}@keyframes ItemScope-OldRow-rtl{0%{left:0;opacity:1}100%{left:-10px;opacity:0}}.ms-DetailsRow{animation-name:none;animation-duration:1.335s;animation-timing-function:ease-out;animation-iteration-count:1}.ms-DetailsRow.od-DetailsRow--fresh{animation-name:ItemScope-NewRow}.ms-DetailsList--Compact .ms-DetailsRow.od-DetailsRow--fresh{animation-name:ItemScope-NewRow-compact}.od-DetailsRow-accessible{display:block;overflow:hidden;position:absolute;top:-9000px;left:-9000px;height:1px;width:1px}.ms-DetailsList .ms-List-page .ms-List-cell{min-height:0}.ms-DetailsList--Compact .ms-List-cell .od-DetailsRow--fresh,.ms-List-cell .od-DetailsRow--fresh{min-height:0;overflow-y:hidden}.od-DetailsColumn-Refreshed{position:relative}.od-DetailsColumn-Refreshed .od-DetailsColumn-Current,.od-DetailsColumn-Refreshed .od-DetailsColumn-Previous{position:absolute;width:100%;animation-fill-mode:both;animation-duration:267ms;animation-iteration-count:1}.od-DetailsColumn-Refreshed .od-DetailsColumn-Current{animation-timing-function:cubic-out;animation-delay:267ms}html[dir=ltr] .od-DetailsColumn-Refreshed .od-DetailsColumn-Current{animation-name:ItemScope-FreshRow}html[dir=rtl] .od-DetailsColumn-Refreshed .od-DetailsColumn-Current{animation-name:ItemScope-FreshRow-rtl}.od-DetailsColumn-Refreshed .od-DetailsColumn-Previous{animation-timing-function:cubic-in}html[dir=ltr] .od-DetailsColumn-Refreshed .od-DetailsColumn-Previous{animation-name:ItemScope-OldRow}html[dir=rtl] .od-DetailsColumn-Refreshed .od-DetailsColumn-Previous{animation-name:ItemScope-OldRow-rtl}"}])});
define("@ms/odsp-datasources/lib/Url",["require","exports","tslib","./utilities/url/ApiUrlHelper","./utilities/url/ItemUrlHelper","./utilities/url/UserPhotoUrlHelper","@ms/odsp-utilities/lib/uri/SimpleUri"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);t.SimpleUri=o.SimpleUri;t.UriFormat=o.UriFormat});
define("odsp-next/controls/list/react/detailsList/fields/NameFieldHeroCommandRenderer",["require","exports","react","./DotDotDotRenderer","./ShareHeroCommandRenderer","../../../../../resources/ControlResourceKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.COMMAND_BUTTON_WIDTH=36;t.createHeroCommandsSectionFilesList=function(e){var t=e.resources.consume(s.disableCalloutInvoker.optional);return n.createElement("span",{className:"od-FieldRenderer-heroCommandContainer"},i.shareHeroCommandRenderer(e),!t&&r.dotDotDotRenderer(e))};t.createHeroCommandsSectionRecentList=function(e){var t=e.resources.consume(s.disableCalloutInvoker.optional);return n.createElement("span",{className:"od-FieldRenderer-heroCommandContainer"},i.shareHeroCommandRenderer(e),!t&&r.dotDotDotRenderer(e))};t.createHeroCommandsSectionList=function(e){var t=e.resources.consume(s.disableCalloutInvoker.optional);return n.createElement("span",{className:"od-FieldRenderer-heroCommandContainer"},!t&&r.dotDotDotRenderer(e))}});
define("odsp-next/controls/list/react/detailsList/fields/DotDotDotRenderer",["require","exports","react","../../../../../providers/engagement/Engagement","../ReactDetailsList.resx","@ms/odsp-list-utilities/lib/Renderers/DotDotDotRenderer","../../../../../resources/ProviderResourceKeys","../../../../tooltip/TooltipHost","@ms/odsp-utilities/lib/resources/Resources","../ReactDetailsList.css"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dotDotDotRenderer=function(e){var t=e.item,a=e.isDisabled,f=e.resources;return n.createElement(u.TooltipHost,{content:i.strings.showDetailsAriaLabel,resources:f},n.createElement(s.DotDotDotRenderer,{isDisabled:t.properties.isDisabled||a,ariaLabel:i.strings.showDetailsAriaLabel,onClick:function(e){var t=document.createEvent("CustomEvent");t.initCustomEvent("contextmenu",!0,!0,e);e.currentTarget.dispatchEvent(t);var n=f.consume(o.instrumentation.optional);f.consume(r.resourceKey).logData({name:"Ellipsis.Callout.Click",isIntentional:!0,currentPage:n&&n.currentPageName()||"NA",previousPage:n&&n.previousPageName()||"NA"});e.preventDefault();e.stopPropagation()}}))};t.resourceKey=new a.ResourceKey({name:e("module").id,factory:new a.ConstantResourceFactory(t.dotDotDotRenderer)})});
define("@ms/odsp-list-utilities/lib/Renderers/DotDotDotRenderer",["require","exports","react","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Icon","./DotDotDotRenderer.scss"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DotDotDotRenderer=function(e){var t=e.onClick,s=e.isDisabled,o=e.ariaLabel;return n.createElement("button",{className:r.css("od-FieldRenderer-dot",{"od-FieldRenderer--disabled":s}),onClick:t,"aria-label":o,"aria-haspopup":"true"},n.createElement(i.Icon,{iconName:"MoreVertical"}))}});
define("@ms/odsp-list-utilities/lib/Renderers/DotDotDotRenderer.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".isFluent .ms-DetailsList .ms-DetailsRow.is-selected BUTTON.od-FieldRenderer-dot:hover{background-color:"},{theme:"neutralQuaternary",defaultValue:"#d0d0d0"},{rawString:"}.ms-DetailsList BUTTON.od-FieldRenderer-dot{display:block;position:relative;left:0;top:0;width:36px;height:100%;text-align:center;outline:1px solid transparent;border:none;background-color:transparent;margin:0;padding:0;color:inherit;font-size:14px;opacity:0;border-radius:0;cursor:pointer}.ms-DetailsList BUTTON.od-FieldRenderer-dot:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.ms-DetailsList BUTTON.od-FieldRenderer-dot i{position:absolute;top:14px;margin:auto;opacity:0}html[dir=ltr] .ms-DetailsList BUTTON.od-FieldRenderer-dot i{right:10px}html[dir=rtl] .ms-DetailsList BUTTON.od-FieldRenderer-dot i{left:10px}html[dir=ltr] .isFluent .ms-DetailsList BUTTON.od-FieldRenderer-dot i{right:0}html[dir=rtl] .isFluent .ms-DetailsList BUTTON.od-FieldRenderer-dot i{left:0}html[dir=ltr] .isFluent .ms-DetailsList BUTTON.od-FieldRenderer-dot i{left:0}html[dir=rtl] .isFluent .ms-DetailsList BUTTON.od-FieldRenderer-dot i{right:0}.od-DetailsRow-cell--VerticallyCenter BUTTON.od-FieldRenderer-dot i{position:relative;top:1px}html[dir=ltr] .od-DetailsRow-cell--VerticallyCenter BUTTON.od-FieldRenderer-dot i{right:0}html[dir=rtl] .od-DetailsRow-cell--VerticallyCenter BUTTON.od-FieldRenderer-dot i{left:0}.od--isMobile .ms-DetailsList BUTTON.od-FieldRenderer-dot{opacity:1}.od--isNonMobile .is-selected .od-FieldRenderer-dot,.od--isNonMobile .ms-DetailsRow-cell:focus .od-FieldRenderer-dot,.od--isNonMobile .ms-DetailsRow:hover .od-FieldRenderer-dot,.od--isNonMobile .od-FieldRenderer-dot:focus{opacity:1}.od--isNonMobile .is-selected .od-FieldRenderer-dot i,.od--isNonMobile .ms-DetailsRow-cell:focus .od-FieldRenderer-dot i,.od--isNonMobile .ms-DetailsRow:hover .od-FieldRenderer-dot i,.od--isNonMobile .od-FieldRenderer-dot:focus i{opacity:1}.ms-DetailsRow-cell.od-DetailsRow-cell--DotDotDot{padding:0;overflow:visible}"}])});
define("odsp-next/controls/tooltip/TooltipHost",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/components/Tooltip/TooltipHost.types","./async/Tooltip","office-ui-fabric-react/lib/components/Tooltip/Tooltip.types"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onTooltipMouseEnter=function(e){if(void 0!==n.props.overflowMode){var t=n._getTargetElement();if(t&&!i.hasOverflow(t))return}n._toggleTooltip(!0)};n._onTooltipMouseLeave=function(e){n._toggleTooltip(!1)};n._onTooltipCallOutDismiss=function(){n._toggleTooltip(!1)};n.state={isTooltipVisible:!1};return n}t.prototype.render=function(){var e=this.props,t=e.calloutProps,s=e.children,u=e.content,a=e.delay,f=e.directionalHint,l=e.directionalHintForRTL,c=e.hostClassName,h=e.id,p=e.overflowMode,d=e.setAriaDescribedBy,v=void 0===d||d,m=e.tooltipProps,g=e.resources,y=this.state.isTooltipVisible,b=h||i.getId("tooltip");return r.createElement("div",n.__assign({className:i.css("ms-TooltipHost",c),style:p?{display:"inline"}:{display:"inline-block"},ref:this._resolveRef("_tooltipHost")},{onFocusCapture:this._onTooltipMouseEnter},{onBlurCapture:this._onTooltipMouseLeave},{onMouseEnter:this._onTooltipMouseEnter,onMouseLeave:this._onTooltipMouseLeave,"aria-describedby":v&&y&&u?b:void 0}),s,y&&r.createElement(o.AsyncTooltip,n.__assign({id:b,delay:a,content:u,targetElement:this._getTargetElement(),directionalHint:f,directionalHintForRTL:l,calloutProps:i.assign(t,{onDismiss:this._onTooltipCallOutDismiss}),resources:g},i.getNativeProps(this.props,i.divProperties),m)))};t.prototype._getTargetElement=function(){var e=this.props.overflowMode;if(void 0!==e)switch(e){case s.TooltipOverflowMode.Parent:return this._tooltipHost.parentElement;case s.TooltipOverflowMode.Self:return this._tooltipHost}return this._tooltipHost};t.prototype._toggleTooltip=function(e){var t=this;this.setState({isTooltipVisible:e},function(){return t.props.onTooltipToggle&&t.props.onTooltipToggle(t.state.isTooltipVisible)})};t.defaultProps={delay:u.TooltipDelay.medium};return t}(i.BaseComponent);t.TooltipHost=a});
define("odsp-next/controls/tooltip/async/Tooltip",["require","exports","tslib","react","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-shared-react/lib/components/ReactDeferredComponent/index","../../../resources/ProviderResourceKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AsyncTooltip=function(t){var a,f={load:function(t){return s.loadModuleExport({path:"office-ui-fabric-react/lib/Tooltip",getModule:function(){return new i.default(function(t,n){e(["office-ui-fabric-react/lib/Tooltip"],t,n)})},getExport:function(e){return e.Tooltip}})},parse:void 0},l=t.resources;l&&(a=l.consume(u.bundleLoader.optional));var c={modulePath:"office-ui-fabric-react/lib/Tooltip",moduleLoader:f,customWaiter:a&&a.waitForPLT(),props:n.__assign({},t)};return r.createElement(o.ReactDeferredComponent,n.__assign({},c))}});
define("odsp-next/controls/list/react/detailsList/fields/ShareHeroCommandRenderer",["require","exports","react","knockout","../../../../../dataSources/url/QueryType","../../../../../utilities/features/Features","../../../../../utilities/killSwitch/KillSwitch","../ReactDetailsList.resx","@ms/odsp-list-utilities/lib/Renderers/ShareHeroCommandRenderer","../../../../../resources/ControlResourceKeys","../../../../../controls/sharing/share/commands/ShareCommandKeys","../../../../../providers/engagement/Engagement","../../../../../resources/ProviderResourceKeys","../../../../tooltip/TooltipHost","../../../../../models/item/command/SocialItemCommandKeys","../../../../../actions/base/ItemCommandHelper","@ms/odsp-utilities/lib/resources/Resources","../../../../../controls/sharing/share/odc/Share.key","@ms/odsp-utilities/lib/killswitch/Killswitch"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=s.isFeatureEnabled(s.ShareV3),w=s.isFeatureEnabled(s.UseNewShareDialog);t.shareHeroCommandRenderer=function(e){var t,s=e.item,m=e.itemSet,E=e.resources,S=e.isDisabled,x=s.mruState;t=!x||(!!o.default.isActivated("63A6D208-5325-40C4-94EB-0CE6300FAD90","11/01/2018","Disabled 'sharing' for all non-ODB files in ODB's MRU-Recent; activate this KS to restore 'sharing' for all files")||x.canBeShared);var T=E.consume(v.resourceKey).isCommandSupported(s,d.share),N=m.context&&m.context.queryType===i.default.Files,C=s.parent&&s.parent.id||s.properties&&s.properties.listId,k=N||!(!C||!s.properties.path&&!s.key||!s.properties.ID&&!s.properties.uniqueId),L=s.lifeCycleStatus&&s.lifeCycleStatus.isMalwareDetected,A=T&&k&&t&&!(S||s.properties.isDisabled||L);return A?n.createElement(p.TooltipHost,{content:u.strings.shareCommandOnHoverAriaLabel,resources:E},n.createElement(a.ShareHeroCommandRenderer,{isDisabled:!A,ariaLabel:u.strings.shareCommandOnHoverAriaLabel,onClick:function(e){if(A){var t,n=E.consume(f.actionMap),i=new(E.injected(n.SelectAction))({item:r.observable(s),showProperties:!1});t=b?new(E.injected(n.ShowShareAction))({focusItemResourceKey:l.shareFocusItemResourceKey,overrideItem:s}):w&&!y.Killswitch.isActivated("7e18d766-4890-4cef-9c61-dd49d9eb28d7","06/04/2019","new hero share")?new(E.injected(n.ShowShareMultiItemAction))({focusItems:E.consume(g.shareResourceKey)}):new(E.injected(n.ShareByLinkAction))({sharingMethod:2});i.execute(e).then(function(){return t.execute(e)});var o=E.consume(c.resourceKey),u=E.consume(h.instrumentation.optional);o.logData({name:"ShareHeroCommand.Click",isIntentional:!0,currentPage:u&&u.currentPageName()||"NA",previousPage:u&&u.previousPageName()||"NA"})}}})):null};t.resourceKey=new m.ResourceKey({name:e("module").id,factory:new m.ConstantResourceFactory(t.shareHeroCommandRenderer)})});
define("@ms/odsp-list-utilities/lib/Renderers/ShareHeroCommandRenderer",["require","exports","react","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Icon","./ShareHeroCommandRenderer.scss"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShareHeroCommandRenderer=function(e){var t=e.onClick,s=e.isDisabled,o=e.ariaLabel;return n.createElement("button",{className:r.css("od-FieldRenderer-shareHeroCommand",{"od-FieldRenderer--disabled":s}),onClick:t,"aria-label":o,"aria-haspopup":"true"},n.createElement(i.Icon,{iconName:"Share"}))}});
define("@ms/odsp-list-utilities/lib/Renderers/ShareHeroCommandRenderer.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".isFluent .ms-DetailsList .ms-DetailsRow.is-selected .od-FieldRenderer-shareHeroCommand:hover{background-color:"},{theme:"neutralQuaternary",defaultValue:"#d0d0d0"},{rawString:"}.od-FieldRenderer-shareHeroCommand{display:block;width:36px;position:relative;height:100%;text-align:center;outline:0;border:none;background-color:transparent;margin:0;padding:0;color:inherit;font-size:14px;opacity:0;border-radius:0;cursor:pointer}.od-FieldRenderer-shareHeroCommand:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-FieldRenderer-shareHeroCommand i{position:absolute;top:14px;margin:auto;opacity:0}html[dir=ltr] .od-FieldRenderer-shareHeroCommand i{right:10px}html[dir=rtl] .od-FieldRenderer-shareHeroCommand i{left:10px}.od-DetailsRow-cell--VerticallyCenter .od-FieldRenderer-shareHeroCommand i{position:relative;top:1px}html[dir=ltr] .od-DetailsRow-cell--VerticallyCenter .od-FieldRenderer-shareHeroCommand i{right:0}html[dir=rtl] .od-DetailsRow-cell--VerticallyCenter .od-FieldRenderer-shareHeroCommand i{left:0}.od--isMobile .od-FieldRenderer-shareHeroCommand{opacity:1}.od--isNonMobile .ms-DetailsRow-cell:focus .od-FieldRenderer-shareHeroCommand,.od--isNonMobile .ms-DetailsRow:hover .od-FieldRenderer-shareHeroCommand,.od--isNonMobile .od-FieldRenderer-shareHeroCommand:focus{opacity:1}.od--isNonMobile .ms-DetailsRow-cell:focus .od-FieldRenderer-shareHeroCommand i,.od--isNonMobile .ms-DetailsRow:hover .od-FieldRenderer-shareHeroCommand i,.od--isNonMobile .od-FieldRenderer-shareHeroCommand:focus i{opacity:1}.ms-DetailsRow-cell.od-DetailsRow-cell--ShareCommand{padding:0;overflow:visible}"}])});
define("odsp-next/controls/fileHoverCard/react/FileHoverCard.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-ActivityItem-personaContainer{display:inline}.ms-CommandBar.ms-AnalyticsActionBar--bar{background-color:transparent;padding-left:0;padding-right:0}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar{background-color:transparent}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar .ms-Button-textContainer{font-size:12px;font-weight:400}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar .ms-Button-icon,.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar .ms-Button-textContainer{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar:hover{background-color:transparent}.ms-CommandBar.ms-AnalyticsActionBar--bar .ms-Button.ms-Button--commandBar:hover .ms-Button-textContainer{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}"}])});
define("odsp-next/controls/list/react/detailsList/fields/ActivityRenderer",["require","exports","react","@ms/odsp-utilities/lib/resources/Resources","@uifabric/utilities/lib/css","../../../../itemActivityField/ItemActivityField","../ReactDetailsList.css"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.baseActivityRenderer=function(e){var t=e.item,r=e.isDisabled,o=void 0!==r&&r,u=t?s.getViewableItemActivity(t):void 0;return n.createElement("div",{className:i.css("od-FieldRenderer-text",{"od-FieldRenderer--disabled":t&&t.properties&&t.properties.isDisabled||o})},u?n.createElement(s.ItemActivityField,{activity:u}):null)};t.activityRenderer=t.baseActivityRenderer;t.resourceKey=new r.ResourceKey({name:e("module").id,factory:new r.ConstantResourceFactory(t.activityRenderer)})});
define("odsp-next/controls/itemActivityField/ItemActivityField",["require","exports","react","@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivity/ItemActivities","@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivity/ItemActivity","@ms/shared-react-item-activity/lib/components/ItemActivities.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o;t.ItemActivityField=function(e){return n.createElement(i.default,{activity:e.activity,isCompact:!0,hideDate:e.hideDate})};t.getViewableItemActivity=function(e){var t=e.activity;if(t){var n,r=(n=t.type,u[n]);return r?new r({activity:t,canOpenItem:function(){return!1},containingItem:{absolutePath:"",isFolder:!!e.folder,name:e.displayName,graphItemUrl:""},currentUserEmail:"",isSingleLevel:!0,onItemClick:function(){},strings:s.default}):void 0}};var u=((o={})[0]=r.EditItemActivity,o[1]=r.MoveItemActivity,o[2]=r.CommentItemActivity,o[3]=r.CommentResponseItemActivity,o[4]=r.MentionItemActivity,o[5]=r.VersionItemActivity,o[6]=r.RestoreItemActivity,o[9]=r.RenameItemActivity,o[10]=r.DeleteItemActivity,o[11]=r.CreateItemActivity,o[12]=r.ShareItemActivity,o)});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivity/ItemActivities",["require","exports","tslib","@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/ItemActivities"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivity/ItemActivity",["require","exports","tslib","@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/ItemActivity","@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/ItemActivity"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.default});
define("odsp-next/controls/list/react/detailsList/fields/ClientSideCustomRenderer",["require","exports","tslib","react","./BaseText","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.clientSideCustomRenderer=function(e){var t=e.item,n=e.column,s=t.properties[n.key],u=i.getAriaLabel(n,s),a=n.clientSideColumnAdapter;if(a&&a.fieldCustomizerLoaded&&a.renderCell)try{var f=a.listViewAdapter;if(f){var l={values:t.properties},c=f.createRowAdapter(l);if(c)return r.createElement(o,{ariaLabel:u,title:s,columnAdapter:a,rowAdapter:c});console.log("Could not create row adapter for column: "+n.internalName)}}catch(e){console.log("Error in using clientSideCustomRenderer, error: "+e)}return r.createElement("div",{title:s,"aria-label":u},s)};var o=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this;return r.createElement("div",{ref:function(t){return e._div=t}})};t.prototype.componentDidMount=function(){var e=document.createElement("DIV");this._div.appendChild(e);this.forceUpdate()};t.prototype.componentWillUnmount=function(){this._cellAdapter&&this._cellAdapter.dispose()};t.prototype.componentDidUpdate=function(e){this._cellAdapter=this.props.columnAdapter.renderCell(this.props.rowAdapter,this._div)};return t}(r.Component);t.resourceKey=new s.ResourceKey({name:e("module").id,factory:new s.ConstantResourceFactory(t.clientSideCustomRenderer)})});
define("odsp-next/controls/list/react/detailsList/fields/FileActivityRenderer",["require","exports","react","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-list-utilities/lib/Renderers/BaseText","./BaseText","../ReactDetailsList.resx","../../../../../utilities/features/Features","./UserRenderer","@ms/odsp-utilities/lib/resources/Resources","../../../../../controls/fluentStyling/FluentStyling.key"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=u.isFeatureEnabled(u.PeopleCardsOnLoki),h=u.isFeatureEnabled(u.PeopleCardsReactComponent);t.fileActivityRenderer=function(e){var t=e.item,u=e.column,f=e.isDisabled,p=e.resources,d=t.properties.editorName,v=d&&d.length?d[0]:void 0,m=s.getCellText(t,u),g=v?s.getAriaLabel(u,v.title):"",y=p.consume(l.resourceKey);if(!v)return n.createElement(i.BaseText,{text:m,isDisabled:t.properties.isDisabled||f,ariaLabel:g});a.loadPeopleCardComponent(p);var b=a.generatePeopleCardState([v],p),w="od-FieldRender od-FieldRender-nofill ms-fontWeight-semibold od-FieldRender-userActivity";(c||h)&&(w+=" od-FieldRender-person");y&&(w+=" od-FieldRender-userFluent");var E=a.getUserComponent({resources:p,user:v,ariaLabel:g,cellClassName:w,state:b}),S=r.formatToArray(o.strings.fileActivityContent,E,t.dateModified);return n.createElement("div",{className:"od-FieldRender-activity"},S)};t.resourceKey=new f.ResourceKey({name:e("module").id,factory:new f.ConstantResourceFactory(t.fileActivityRenderer)})});
define("odsp-next/controls/list/react/detailsList/fields/NameAndPathRenderer",["require","exports","react","@ms/odsp-list-utilities/lib/Renderers/PathRenderer","@ms/odsp-utilities/lib/resources/Resources","./NameFieldAddOnHelper","./NameRenderer","../../../../../dataSources/url/odb/ItemUrlHelper","../../../../../providers/engagement/Engagement","../../../../../utilities/browser/WebViewDetector","../ReactDetailsList.css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.nameAndPathRenderer=function(e){var t=e.item,i=e.resources,l=i.consume(a.resourceKey),c=i.consume(u.resourceKey).getItemUrlParts(t.key),h={displayPathSegments:t.displayPath&&t.displayPath.segments||[t.displayName],parentLink:t.parentLink,target:"_blank",onClick:function(e){l.logData({name:"MruRecent.FileLocation.Click",isIntentional:!0})}};!f.isOneDriveWinApp()||c.isCrossDomain||c.isCrossList||(h.target="_self");var p=o.signaledNameRendererWithHovercard(e,{inlineCommandCount:0}),d=r.PathRenderer(h),v=n.createElement(n.Fragment,null,n.createElement("div",null,p),n.createElement("div",null,d));return s.nameFieldBuildAddOn({fieldRenderer:v,fieldRendererProps:e,addHeroCommands:!0})};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:new i.ConstantResourceFactory(t.nameAndPathRenderer)})});
define("@ms/odsp-list-utilities/lib/Renderers/PathRenderer",["require","exports","@ms/items-view/lib/private/components/fields/path/PathField"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PathRenderer=n.PathField;t.createDisplayPathElement=n.createDisplayPathElement;t.getDisplayPathElements=n.getDisplayPathElements;t.createDisplayPathSeparator=n.createDisplayPathSeparator});
define("odsp-next/controls/list/react/detailsList/fields/NameFieldAddOnHelper",["require","exports","tslib","react","./NameFieldMetadataRenderer","./NameFieldHeroCommandRenderer","../../../../../dataSources/url/QueryType"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u,a=((u={})[o.default.Files]=s.createHeroCommandsSectionFilesList,u[o.default.Recent]=s.createHeroCommandsSectionRecentList,u.default=s.createHeroCommandsSectionList,u);t.COMMAND_BUTTON_WIDTH=36;t.nameFieldBuildAddOn=function(e){var t=e.fieldRenderer,s=e.addHeroCommands,o=e.addMetadata,u=e.fieldRendererProps,a=e.optionalRendererClass,l=void 0===a?"":a,c=e.teachingBubble,h=u.item;if(!s&&!o)return t;var p=s&&f(h.queryType,u)||void 0,d=o&&r.createElement(i.nameFieldMetadataRenderer,n.__assign({},e.fieldRendererProps))||void 0,v=o?"od-FieldRenderer-nameFieldReponsive":"",m=d?[t,d]:[t];return r.createElement("div",{className:"od-FieldRenderer-Renderer-withCommandAndMetata "+v},r.createElement("div",{className:"od-FieldRenderer-Renderer-withMetadata "+l},c?c(h,u.resources,m):m),p,d)};function f(e,t){return(a[e]||a.default)(t)}t.getHeroCommands=f;t.getHeroCommandsLength=function(e,t){var n=f(e,t),i=n&&n.props&&n.props.children;return r.Children.count(i)}});
define("odsp-next/controls/list/react/detailsList/fields/NameFieldMetadataRenderer",["require","exports","react","office-ui-fabric-react/lib/Icon","../../../../../models/item/SharingType","@ms/odsp-utilities/lib/resources/Resources","./NameFieldMetadataRenderer.css"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.nameFieldMetadataRenderer=function(e){var t=e.item;return n.createElement("div",{className:"od-FieldRenderer-NameField-resopnsive-additionalInfo"},n.createElement("span",{className:"od-FieldRenderer-NameField-additionalInfo-modDate"},t.dateModified),n.createElement("span",{className:"od-FieldRenderer-NameField-additionalInfo-sharedStatus"},function(e){var t=!1,s=e.properties&&e.properties.PrincipalCount;if(s)t=Number(s)>0;else{var o=e&&e.sharingType;t=o===i.default.Shared||o===i.default.Public||o===i.default.PublicUnlisted}return t?n.createElement(r.Icon,{iconName:"People"}):void 0}(t)))};t.resourceKey=new s.ResourceKey({name:e("module").id,factory:new s.ConstantResourceFactory(t.nameFieldMetadataRenderer)})});
define("odsp-next/controls/list/react/detailsList/fields/NameFieldMetadataRenderer.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-FieldRenderer-NameField-resopnsive-additionalInfo{color:"},{theme:"bodySubtext",defaultValue:"#666666"},{rawString:";font-size:12px;padding:5px 0 0 0}.xxlg .od-FieldRenderer-NameField-resopnsive-additionalInfo,.xxxlg .od-FieldRenderer-NameField-resopnsive-additionalInfo,.xxxxlg .od-FieldRenderer-NameField-resopnsive-additionalInfo{display:none}.od-FieldRenderer-NameField-additionalInfo-sharedStatus{padding:0 0 0 8px}html[dir=rtl] .od-FieldRenderer-NameField-additionalInfo-sharedStatus{padding:0 8px 0 0}.xlg .od-FieldRenderer-NameField-resopnsive-additionalInfo:hover{display:none}.xlg .od-FieldRenderer-NameField-additionalInfo-modDate{display:none}.xlg .od-FieldRenderer-Renderer-withMetadata .od-FieldRenderer-NameField-resopnsive-additionalInfo{display:none}.xlg .is-selected .od-FieldRenderer-NameField-resopnsive-additionalInfo,.xlg .ms-DetailsRow:hover .od-FieldRenderer-NameField-resopnsive-additionalInfo{display:none}.od-FieldRenderer-NameField-resopnsive-additionalInfo{padding:1px 0 0 0}.lg .od-FieldRenderer-nameFieldReponsive BUTTON.od-FieldRenderer-dot i,.md .od-FieldRenderer-nameFieldReponsive BUTTON.od-FieldRenderer-dot i,.sm .od-FieldRenderer-nameFieldReponsive BUTTON.od-FieldRenderer-dot i{opacity:1;font-size:20px}.lg .od-FieldRenderer-nameFieldReponsive .od-FieldRenderer-shareHeroCommand,.md .od-FieldRenderer-nameFieldReponsive .od-FieldRenderer-shareHeroCommand,.sm .od-FieldRenderer-nameFieldReponsive .od-FieldRenderer-shareHeroCommand{display:none}.lg .od-FieldRenderer-nameFieldReponsive>.od-FieldRenderer-NameField-resopnsive-additionalInfo,.md .od-FieldRenderer-nameFieldReponsive>.od-FieldRenderer-NameField-resopnsive-additionalInfo,.sm .od-FieldRenderer-nameFieldReponsive>.od-FieldRenderer-NameField-resopnsive-additionalInfo{display:none}"}])});
define("odsp-next/controls/list/react/detailsList/fields/NameRenderer",["require","exports","tslib","react","../../../../../resources/DataSourceResourceKeys","./BaseText","@ms/odsp-list-utilities/lib/Renderers/NameRenderer","@ms/odsp-utilities/lib/async/Promise","../../../../fileHoverCard/react/FileHoverCardHelper","../../../../../utilities/features/Features","../ReactDetailsList.resx","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-shared-react/lib/components/ReactDeferredComponent/index","../../../../../models/item/LifeCycleStatus","@uifabric/experiments/lib/components/signals/Signals","@ms/odsp-utilities/lib/resources/Resources","../../../../../dataSources/url/QueryType","./NameFieldAddOnHelper","../../../../../utilities/delayLoading/DelayLoadingHelper","office-ui-fabric-react/lib/common/DirectionalHint","../../../../errorBoundary/ErrorBoundary","../../../../../providers/bundleLoader/PageLoadMonitor","@ms/odsp-utilities/lib/modules/ModuleHelper","../ReactDetailsList.css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=f.isFeatureEnabled(f.EnableUpdatedFilesListView),T=f.isFeatureEnabled(f.EnableResponsiveFilesListView);t.baseNameRenderer=function(e,t){var n=e.item,i=e.column,u=e.itemSet,a=e.onItemInvoked,f=e.resources,l=e.isDisabled,c="LinkIssueIDNoMenu"===i.internalName&&"IssueID"===i.realFieldName&&n.properties?n.properties.ID:(n?n[i.key]||n.properties[i.key]:null)||"",h=L({item:n,resources:f,itemSet:u}),p=a&&function(e){a(n,null,e)};return r.createElement(o.NameRenderer,{linkUrl:h,linkText:c,onClick:p,isDisabled:n.properties.isDisabled||l,disableTooltip:t,ariaLabel:s.getAriaLabel(i,c)})};var N=function(i){n.__extends(s,i);function s(){return null!==i&&i.apply(this,arguments)||this}s.prototype.render=function(){var i=this,s=this.props,o=s.item,f=s.resources,c=a.shouldEnableFileHoverCard(o,f),v=t.baseNameRenderer(this.props,c);if(x&&o.lifeCycleStatus){var m=p.getStatusToDisplay(o.lifeCycleStatus),b=function(e){switch(e){case 4:return r.createElement(d.ATPSignal,{ariaLabel:l.strings.lifeCycleSignalMalwareDetected});case 3:return r.createElement(d.TrendingSignal,{ariaLabel:l.strings.lifeCycleSignalTrending});case 2:return r.createElement(d.NewSignal,{ariaLabel:l.strings.lifeCycleSignalNew,title:l.strings.lifeCycleSignalNewTooltip});case 1:return r.createElement(d.ExternalSignal,{ariaLabel:l.strings.lifeCycleSignalExternal,title:l.strings.externalItemTitle});default:return null}}(m),T=2===m;v=r.createElement(d.SignalField,{className:"od-FieldRenderer-NameRenderer-SignalField",before:T&&b,after:!T&&b},v)}if(c){var N={item:o,resources:f,target:void 0,gapData:{inlineCommandCount:o.queryType&&g.getHeroCommandsLength(o.queryType,this.props)},getUpdatedTarget:function(){return i._target}},C={load:function(t){return u.default.resolve(new Promise(function(t,n){e(["../../../../fileHoverCard/react/FileHoverCard"],t,n)})).then(S.getDefaultExport)},parse:void 0},k=f.consume(E.resourceKey),L={modulePath:"../../../../fileHoverCard/react/FileHoverCard",moduleLoader:C,customWaiter:y.waitForPageLoadWithTimeout(k),props:N};v=r.createElement("div",{className:"FileHoverCardSection",ref:function(e){return i._target=e}},v,r.createElement(w.ErrorBoundary,{componentName:"odsp-next/controls/fileHoverCard/react/FileHoverCard"},r.createElement(h.ReactDeferredComponent,n.__assign({},L))))}return v};return s}(r.PureComponent);t.SignaledNameRenderer=N;t.signaledNameRendererWithHovercard=function(e,i){var s=e.item,o=e.resources,u=i.addHeroCommands,f=a.shouldEnableFileHoverCard(s,o);return u?t.nameRendererWithAddOns(e,f):r.createElement(N,n.__assign({},e))};t.nameRendererWithAddOns=function(e,t){var i=e.item,s=e.column,o=r.createElement(N,n.__assign({},e)),u=T&&i.queryType===m.default.Files,a=x&&s.hasListItemMenu;return o=g.nameFieldBuildAddOn({fieldRenderer:o,fieldRendererProps:e,addHeroCommands:a,addMetadata:u,teachingBubble:i&&i.vault&&i.vault.root&&C})};t.nameRenderer=function(e){return t.signaledNameRendererWithHovercard(e,{addHeroCommands:!0})};function C(e,t,n){return r.createElement(k,{vaultItem:e,resources:t},n)}t.onVaultTeachingBubbleRender=C;var k=function(t){n.__extends(i,t);function i(){return null!==t&&t.apply(this,arguments)||this}i.prototype.render=function(){var t=this,i=this.props,s=i.resources,o=i.vaultItem,a=i.children,f={vaultItem:o,target:this._target,resources:s,directionalHint:b.DirectionalHint.bottomLeftEdge,getUpdatedTarget:function(){return t._target}},l={load:function(t){return c.loadModuleExport({path:"odsp-next/controls/vaultTeachingBubble/react/odc/VaultTeachingBubble",getModule:function(){return new u.default(function(t,n){e(["odsp-next/controls/vaultTeachingBubble/react/odc/VaultTeachingBubble"],t,n)})},getExport:function(e){return e.default}})},parse:void 0},p=s.consume(E.resourceKey),d={modulePath:"odsp-next/controls/vaultTeachingBubble/react/odc/VaultTeachingBubble",moduleLoader:l,customWaiter:y.waitForPageLoadWithTimeout(p),props:f};return r.createElement("div",{className:"od-VaultContainer"},r.createElement("div",{className:"od-VaultSection",ref:function(e){return t._target=e}},a,r.createElement(h.ReactDeferredComponent,n.__assign({},d))))};return i}(r.PureComponent);t.VaultTeachingBubbleSection=k;function L(e){var t=e.resources,n=e.item,r=e.itemSet,s=t.consume(i.url);return s.isRecycleBin(n.queryType)?"":s.getDefaultClickUrl(n,{preferCurrentView:!0,itemSet:r})}t.getLinkUrl=L;t.resourceKey=new v.ResourceKey({name:e("module").id,factory:new v.ConstantResourceFactory(t.nameRenderer)})});
define("@ms/odsp-list-utilities/lib/Renderers/NameRenderer",["require","exports","@ms/items-view/lib/private/components/fields/name/NameField","./NameRenderer.scss"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NameRenderer=n.NameField});
define("@ms/odsp-list-utilities/lib/Renderers/NameRenderer.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".tempStyle{font-size:inherit}"}])});
define("odsp-next/controls/list/react/detailsList/fields/SharedRenderer",["require","exports","tslib","react","@ms/odsp-list-utilities/lib/Renderers/SharedWithRenderer","../../../../../models/item/SharingType","../../../../../utilities/features/Features","./FieldsRender.resx","../../../../../resources/ControlResourceKeys","../../../../../models/store/ItemsStore","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=o.isFeatureEnabled(o.EnableUpdatedFilesListView);t.sharedRenderer=function(e){var t,o=e.item,l=e.column,h=e.resources,p=h.consume(a.actionMap),d=h.consume(f.resourceKey).getItem(o.key);if(c){var v=o&&o.sharingType,m=v===s.default.Shared||v===s.default.Public||v===s.default.PublicUnlisted;t={sharingString:g=m?u.strings.SharingHintShared_Short:u.strings.SharedFieldPrivate_Short,iconName:m?"People":void 0,imageAlt:u.strings.SharedWithSomeIcon,onClick:function(e){new(h.injected(p.ShowPermissionsAction))({item:d}).execute(e.nativeEvent)}}}else{var g;t={sharingString:g=o&&o[l.key],iconName:g?"People":void 0,imageAlt:u.strings.SharedWithSomeIcon}}return r.createElement(i.SharedWithRenderer,n.__assign({},t))};t.resourceKey=new l.ResourceKey({name:e("module").id,factory:new l.ConstantResourceFactory(t.sharedRenderer)})});
define("@ms/odsp-list-utilities/lib/Renderers/SharedWithRenderer",["require","exports","tslib","react","office-ui-fabric-react/lib/Icon","./SharedWithRenderer.scss"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SharedWithRenderer=function(e){var t=e.sharingString,s=e.iconName,o=e.imageAlt,u=e.onClick,a=e.ariaLabel,f=void 0===a?"":a,l=u?"od-FieldRenderer-sharedWith ":"";return r.createElement("div",{className:"od-FieldRender ms-noWrap ms-displayInlineBlock","data-is-focusable":"true",title:t,onClick:u,role:u?"button":"","aria-label":f},function(e,t){if(e)return r.createElement("span",null,r.createElement(i.Icon,n.__assign({iconName:e},{alt:t})),r.createElement("span",null,""));return r.createElement("span",null)}(s,o),r.createElement("span",{className:l},t))}});
define("@ms/odsp-list-utilities/lib/Renderers/SharedWithRenderer.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={};n.loadStyles([{rawString:".ms-DetailsRow-cell .od-FieldRenderer-sharedWith{cursor:pointer}.ms-DetailsRow-cell .od-FieldRenderer-sharedWith:hover{text-decoration:underline}"}])});
define("odsp-next/providers/operator/CreateItemOperator",["require","exports","tslib","./UploadOperator","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","../../resources/DataSourceResourceKeys","../../models/operation/OperationType","../../models/item/ItemType","../../utilities/mime/MimeHelper","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../dataSources/item/ItemTaskObserver","../../dataSources/item/ItemTaskObserver","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){n.__extends(t,e);function t(t,n){var r=this,s=new Blob(["\ufeff"],{type:a.TEXT_MIME_TYPE});s.name=t.fileName;r=e.call(this,{files:[s],parentItem:t.parentItem,behavior:0,type:i.UploadProcessorType.Html5file,skipInvalidation:!1,wasDragAndDropped:!1},n)||this;var o=n.itemTaskObserverType,u=n.urlDataSource,f=n.navigation;r._itemTaskObserver=new o;r._urlDataSource=u;r._navigation=f;return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t);n.type=o.default.createItem;return n};t.prototype.onItemUploaded=function(e){this._itemTaskObserver.update([new l.Task(e.key).succeed({item:{key:e.key,type:l.Graft.backup(u.default.File),extension:l.Graft.backup(".txt"),textEditorMimeType:l.Graft.backup(a.TEXT_MIME_TYPE)}})]);this._itemTaskObserver.flush();e=this.peekUnwrapObservable(this._itemTaskObserver.getItem({key:e.key}));var t=this._urlDataSource.getDefaultClickUrl(e,{viewParams:this._navigation.viewParams,preserveAction:!1});this._navigation.navigateTo({url:t,ignoreHistory:!0})};t.dependencies=n.__assign({},r.default.dependencies,{urlDataSource:s.url,itemTaskObserverType:c.resourceKey,navigation:f.navigation});return t}(r.default);t.default=p;t.typeResourceKey=h.createResolvedTypeResourceKey(e("module").id,p)});
define("odsp-next/dataSources/item/odc/RecentDataSource",["require","exports","tslib","../../../controls/leftPane/LeftPane.resx","./SkyApiItemDataSource","../../../models/item/ItemType","../../url/QueryType","../ItemTaskObserver"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o.default[o.default.Recent].toLowerCase(),f=function(e){n.__extends(t,e);function t(){var t=e.call(this)||this,n=t._urlDataSource.getRootItemKey(o.default.Recent),r=t.getRootItemTitle(n),i=new(t.resources.consume(u.resourceKey));i.update([new u.Task(n).succeed({item:{key:n,type:s.default.Folder,id:t._getRootFileId(),queryType:o.default.Recent,displayType:o.default.Recent,name:r,displayName:r}})]);i.flush();return t}t.prototype.getRootItemTitle=function(e){return r.strings.Recent};t.prototype._getItemKeyExtension=function(t,n){var r;return t.id!==this._getRootFileId()?((r={}).u=a,r):e.prototype._getItemKeyExtension.call(this,t,n)};return t}(i.default);t.default=f});
define("odsp-next/dataSources/item/odc/SearchDataSource",["require","exports","tslib","../../../controls/search/Search.resx","./SkyApiItemDataSource","../../../models/item/ItemType","@ms/odsp-utilities/lib/string/StringHelper","../../../dataSources/url/QueryType","../../url/PageType","../ItemTaskObserver"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=u.default[u.default.Search].toLowerCase(),c=r.strings,h=function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._keyUniqueIndex=0;var n=t._urlDataSource.getRootItemKey(u.default.Search),r=t.getRootItemTitle(n),i=new(t.resources.consume(f.resourceKey));i.update([new f.Task(n).succeed({item:{key:n,type:s.default.Folder,id:t._getRootFileId(),queryType:u.default.Search,displayType:u.default.Search,name:r,displayName:r}})]);i.flush();return t}t.prototype.getItem=function(t){return e.prototype.getItem.call(this,t).then(function(e){e.totalChildren=e.children?e.children.length:0;return e})};t.prototype._getParentItemId=function(){return"root"};t.prototype.getRootItemTitle=function(e){var t=this._urlDataSource.getKeyParams(e);if(t.sp)return c.SearchItemsPassThruLargestTitle;var n=t.q||"",r=this._urlDataSource.getPageType()===a.default.Photos?c.SearchPhotosTitle:c.SearchItemsTitle;return n&&o.format(r,n)||""};t.prototype._getItemKeyExtension=function(t,n){var r;return t.id!==this._getRootFileId()?((r={}).u=""+l+this._keyUniqueIndex++,r):e.prototype._getItemKeyExtension.call(this,t,n)};return t}(i.default);t.default=h});
define("odsp-next/dataSources/item/odc/SharedDataSource",["require","exports","tslib","../../../controls/leftPane/LeftPane.resx","./SkyApiItemDataSource","../../../models/item/ItemType","../../url/QueryType","../ItemTaskObserver"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o.default[o.default.SharedWithMe].toLowerCase(),f=function(e){n.__extends(t,e);function t(){var t=e.call(this)||this,n=t._urlDataSource.getRootItemKey(o.default.SharedWithMe),r=t.getRootItemTitle(n),i=new(t.resources.consume(u.resourceKey));i.update([new u.Task(n).succeed({item:{key:n,type:s.default.Folder,id:t._getRootFileId(),queryType:o.default.SharedWithMe,displayType:o.default.SharedWithMe,name:r,displayName:r}})]);i.flush();return t}t.prototype.getRootItemTitle=function(e){return r.strings.Shared};t.prototype._getItemKeyExtension=function(t,r){var i,s;return t.isSharerFolder||this._isSharerRootId(t.id)?n.__assign({},e.prototype._getItemKeyExtension.call(this,t,r),((i={}).qt="sharedby",i)):((s={}).u=a,s)};t.prototype._isSharerRootId=function(e){return!e||e===this._getRootFileId()||0===e.indexOf("-")};return t}(i.default);t.default=f});
define("odsp-next/dataSources/mruRecent/odc/MruRecentDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../../resources/DataSourceResourceKeys","../../base/vroom/VroomDataRequestor","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){this._vroomDataRequestor=t.vroomDataRequestor;this._urlDataSource=t.urlDataSource}e.prototype.removeRecentItem=function(e){var t=e.items[0].mruState,n=t.mruId,r=t.app,i=t.type,s=""+this._urlDataSource.getApiBaseUrl().replace("v1.0","v2.1")+("/drive/recent/"+n),o={mruId:n,type:i,app:r,serverDocId:"null",category:"Document",url:"https://onedrive.live.com"};return this._vroomDataRequestor.send({apiName:"Recent",path:s,requestType:"DELETE",apiVersion:"v2.1",useAuthorizationHeaders:!0,postData:JSON.stringify(o)})};e.prototype.changePinStatus=function(e){return r.default.reject("Not implemented")};e.prototype.recordDocumentView=function(e,t){return r.default.reject("Not implemented")};e.prototype.getTokenForMru=function(){return r.default.reject("Not implemented")};e.dependencies=n.__assign({},i.default.dependencies,{vroomDataRequestor:o.resourceKey,urlDataSource:s.url});return e}();t.default=a;t.resourceKey=u.createResolvedResourceKey(e("module").id,a,n.__assign({},i.default.dependencies,{vroomDataRequestor:o.resourceKey,urlDataSource:s.url}))});
define("odsp-next/dataSources/search/odc/SearchDataSource",["require","exports","tslib","@ms/odsp-datasources/lib/Permissions","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/encoding/HtmlEncoding","@ms/odsp-utilities/lib/guid/Guid","@ms/odsp-utilities/lib/icons/IconSelector","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/path/Path","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/string/StringHelper","../ISearchDataSource","../SearchShared.resx","../../item/ItemDataSource.resx","../../url/odc/UrlDataSource","../../../dataSources/url/PageType","../../../dataSources/url/QueryType","../../../models/item/ItemHelper","../../../models/item/ItemType","../../../resources/DataSourceResourceKeys","../../../utilities/icons/Icon","@ms/odsp-utilities/lib/modules/Modules"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C=g.strings,k="https://www.bing.com/as/init?",L=["3gp","aac","m4a","mp3","wav","wma"],A=window.$Config&&window.$Config.mkt,O=function(t){n.__extends(p,t);function p(n,i){void 0===n&&(n={});var s=t.call(this,n,i)||this,a=i.identityDataSource.getIdentity().type,f=a===r.IdentityType.msa;s._capabilities={supportsResultsWheeling:f,minimumQueryLength:0,maxQueryRate:100,showNoResults:!1,showOnlyResults:!0,supportsSearchFiltering:!0};s._navigation=i.navigation;s._urlDataSource=i.urlDataSource;s._regenerateCvid();s._paddedCid=d.rightPad(y.default.viewerId,32);if(a===r.IdentityType.anonymous)s._requirePromise=u.default.wrap();else{var l=k+o.serializeQuery({pt:"onedrive",clientid:s._paddedCid});s._requirePromise=u.default.resolve(new Promise(function(t,n){e([l],t,n)})).then(N.getDefaultExport)}return s}p.prototype.getCapabilities=function(){return this._capabilities};p.prototype.getItems=function(e,t){var n=this;void 0===e&&(e="");var r=new c.Qos({name:"Odc.Search.QF.SearchDataSource.getItems"});return this._requirePromise.then(function(){return new u.default(function(r){var i=null;t&&t.type===S.default.Folder&&t.queryType===w.default.Files&&(i=t.id);AutoSuggest.getSuggestions(e,"D41D8CD98F00B204E9800998ECF8427E0C818072",n._cvid,!0,null,i,n._paddedCid,function(e){var t=null;e&&(t=JSON.parse(e));r(t)},A)})}).then(function(t){r.end({resultType:c.ResultTypeEnum.Success});var i=new c.Qos({name:"Odc.Search.QF.SearchDataSource.ResponseToRender"}),s=[];if(t&&t.suggestionGroups){var o=t.pingUrlBase||t.instrumentation&&t.instrumentation.pingUrlBase;t.suggestionGroups.forEach(function(e){var t=e.suggestionContainers||e.searchSuggestions;if(t){var r=[];t.forEach(function(t){if(t.suggestion){var i=t.content&&t.content[0].documents[0];(n._urlDataSource.getPageType()!==b.default.Photos||i&&"Photo"===i.type||i&&"Video"===i.type||"Tag"===t.suggestion.type||"History"===t.suggestion.type)&&r.push(n._getSuggestionFromContainer(o,t))}else{var s=t.result&&t.result[0];if(n._urlDataSource.getPageType()!==b.default.Photos||s&&"Photo"===s.type||s&&"Video"===s.type||"PersonalSearchTags"===e.name||"SearchHistory"===e.name){var u=n._getSuggestionFromContainer(o,t,e.name);u&&r.push(u)}}});s.push({results:r})}})}return{query:e,containers:s,responseToRenderEvent:i}}).then(null,function(t){if(t&&t instanceof Error&&"Canceled"===t.name){r.end({resultType:c.ResultTypeEnum.ExpectedFailure});return{query:e,containers:[]}}r.end({resultType:c.ResultTypeEnum.Failure,resultCode:t.status});return u.default.wrapError(C.DefaultTitle)})};p.prototype.upscopeSearch=function(e){var t=this._urlDataSource.getSearchQueryUrl(e,this._cvid);this._regenerateCvid();t&&this._navigation.navigateTo(t)};p.prototype.searchResultClicked=function(e){this._regenerateCvid()};p.prototype._getSuggestionFromContainer=function(e,t,n){void 0===n&&(n="");var r=t.suggestion,i=r&&r.name||t.displayText,s=i.replace(/\ue000/g,"").replace(/\ue001/g,""),o=i;o=(o=(o=a.default.encodeText(o)).replace(/\ue000/g,'<span class="od-SearchResults-result-highlight">')).replace(/\ue001/g,"</span>");var u=v.SearchFilterType.all;this._urlDataSource.isCurrentQuery(w.default.Photos)&&(u=v.SearchFilterType.photos);var f=this._urlDataSource.getSearchQueryUrl(s,void 0,u),l="",c=r&&r.urlPingSuffix||t.urlPingSuffix;e&&c&&(l=e+c);var h={title:o,titleText:s,titleAriaLabel:s,url:f,instrumentationUrl:l,type:1};return r&&"Tag"===r.type||"PersonalSearchTags"===n?this._makeTagSuggestion(s,t,h):r&&"History"===r.type||"SearchHistory"===n?this._makeHistorySuggestion(s,t,h):(r&&"Document"===r.type&&t.content&&t.content.length||"PersonalSearchDocuments"===n)&&t.result&&t.result.length?this._makeDocumentSuggestion(s,t,h):null};p.prototype._makeHistorySuggestion=function(e,t,n){n.type=4;n.glyph=new T.default("Clock");n.titleAriaLabel=d.format(m.strings.HistoryAriaLabel,e);return n};p.prototype._makeTagSuggestion=function(e,t,n){var r=t.suggestion&&t.suggestion.query.substr(1)||t.query.substr(1);n.type=3;n.glyph=new T.default("Tag");n.titleAriaLabel=d.format(m.strings.TagAriaLabel,r);n.url=this._urlDataSource.getTagUrl({localizedTag:r,source:"UserDefined",tag:r,type:"keyword"});return n};p.prototype._makeDocumentSuggestion=function(e,t,n){var r=t.content&&t.content[0]&&t.content[0].documents[0]||t.result[0],i=r.rawResourceId,s=h.getFileExtension(e,!0);n.key=this._urlDataSource.getKey({id:i});if(this._openItemExternally(s)){n.key=null;n.url=y.default.getResourceRedirectUrl(i)}if("Folder"===r.type){n.iconName="folder";n.titleAriaLabel=d.format(m.strings.ODCFolderAriaLabel,e)}else{n.iconName=l.getIconNameFromExtension(h.getFileExtension(e));n.titleAriaLabel=d.format(m.strings.ODCFileAriaLabel,e)}r.parentFolder&&r.parentFolder.name&&(n.parentFolder=r.parentFolder.name);return n};p.prototype._regenerateCvid=function(){this._cvid=f.default.generate()};p.prototype._openItemExternally=function(e){return E.isOfficeDoc(e)||this._isXboxMusicAudio(e)};p.prototype._isXboxMusicAudio=function(e){return-1!==L.indexOf(e)};p.dependencies=n.__assign({},i.default.dependencies,{identityDataSource:x.identity,navigation:s.navigation,urlDataSource:x.url});return p}(i.default);t.default=O;t.resourceKey=p.createResolvedResourceKey(e("module").id,O)});
define("odsp-next/dataSources/itemActivityFeed/helper/odc/ItemActivityFeedHelper",["require","exports","tslib","../../../item/ItemTaskObserver","../BaseItemActivityFeedHelper","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/base/BaseModel","../../../../resources/DataSourceResourceKeys","../../../../resources/ControlResourceKeys","../../../../utilities/browser/WebViewDetector","../../../../actions/OpenInDesktopAction","../../../base/vroom/ItemResultProcessor","../../../url/QueryType"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._actionMap=n.actionMap;r._itemTaskObserver=new n.itemTaskObserver;r._isOneDriveWinApp=f.isOneDriveWinApp();r._urlDataSource=n.urlDataSource;r._baseHelper=new i.default({itemTaskObserver:r._itemTaskObserver});return r}t.prototype.init=function(e){this._resources=e};t.prototype.getActivityItemUrl=function(e){var t=e&&e.driveItem;return t&&t.webUrl?t.webUrl:t&&e.isFolder?this._urlDataSource.getCurrentSiteUrl()+"#id="+t.id:t&&void 0!==e.relativePath?this._urlDataSource.getCurrentPageBaseUrl()+e.relativePath:void 0};t.prototype.getGraphItemUrl=function(e,t){if(t){var n=t.getItemUrl(e,{useDirectEndpoint:!0});return n.substring(0,n.indexOf("/drives/"))+"/drive/root"}};t.prototype.updateItem=function(e,t){this._baseHelper.updateItem(e,t)};t.prototype.getAccessToken=function(e,t){return this._baseHelper.getAccessToken(e,t)};t.prototype.isNonOfficeFileCommentsAvailable=function(e){return this._baseHelper.isNonOfficeFileCommentsAvailable(e)};t.prototype.renderUser=function(e,t){return t?t(e):null};t.prototype.getAPIEnvironment=function(){return"consumer"};t.prototype.getCurrentRootTitle=function(e){return e&&e.isRootFolder&&e.name||void 0};t.prototype.getDefaultItemTitle=function(e){};t.prototype.navigateToItem=function(e,t,r,i){var s=this;if(r){var o=t.driveItem;o.webUrl||(o=n.__assign({},o,{webUrl:r}));if(t.isFolder&&o.webUrl){i&&i("folder");this.navigateToFolder(o.webUrl)}else{var u=this._tryAndFetchOneDriveItem(o);if(u){i&&i(u.folder?"folder":u.extension||"file");r&&(u.openUrl=r);this.navigateToOneDriveItem(u)}else this._convertToOneDriveItem(e,o).then(function(e){i&&i(e.folder?"folder":e.extension||"file");s.navigateToOneDriveItem(e)})}}};t.prototype.isGuestUser=function(){};t.prototype.navigateToOneDriveItem=function(e){var t=this.createObservable(e);if(this._isOneDriveWinApp){new(this._managed(this._actionMap.OpenInDesktopAction))({openRelation:2,item:t,actionType:l.DesktopActionType.OpenItemActivityItem}).execute(void 0)}else{new(this.managed(this._actionMap.ExternalNavigateAction))({item:t}).execute(void 0)}};t.prototype.navigateToFolder=function(e){new(this.managed(this._actionMap.NavigationAction))({url:e,forceNavigation:!0,target:"_blank"}).execute(void 0)};t.prototype._convertToOneDriveItem=function(e,t){var n=this;return this.resources.consumeAsync(c.resourceKey).then(function(r){var i=r.processItem({itemFromServer:t,requestKey:e.key,observer:n._itemTaskObserver}).key;n._itemTaskObserver.flush();var s=n._itemTaskObserver.getItem({key:i});s&&(s.queryType=h.default.DetailsPane);return s})};t.prototype._tryAndFetchOneDriveItem=function(e){var t,n=e.root?"root":e.id,r=this._urlDataSource.getKey(((t={}).id=n,t)),i=this._itemTaskObserver.getItem({key:r});i&&(i.queryType=h.default.DetailsPane);return i};t.prototype._managed=function(e){this._resources&&(e=this._resources.injected(e));return this.scope.attached(e)};t.dependencies=n.__assign({},o.default.dependencies,{actionMap:a.actionMap,itemTaskObserver:r.resourceKey,urlDataSource:u.url});return t}(o.default);t.default=p;t.resourceKey=s.createResolvedResourceKey(e("module").id,p)});
define("odsp-next/dataSources/itemActivityFeed/helper/BaseItemActivityFeedHelper",["require","exports","tslib","@ms/odsp-utilities/lib/icons/OfficeFileNameHelper","../../item/ItemTaskObserver","../../../models/item/ItemType"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this._itemTaskObserver=e.itemTaskObserver;this._isCommentsEnabled=e.isCommentsEnabled}e.prototype.updateItem=function(e,t){this._itemTaskObserver.update([new i.Task(e.key).succeed({item:n.__assign({key:e.key},t)})],!1);this._itemTaskObserver.flush()};e.prototype.getAccessToken=function(e,t){if(t)return t.getAccessToken(e)};e.prototype.isNonOfficeFileCommentsAvailable=function(e){return this._isCommentsEnabled&&!this.isOfficeItem(e)&&(e.type===s.default.File||e.type===s.default.Media||e.type===s.default.Unknown||e.type===s.default.Shortcut)};e.prototype.isOfficeItem=function(e){var t=e.extension&&e.extension.replace(/^\./,"");return t&&r.OfficeIconFileTypeMap[t]&&".pdf"!==e.extension};return e}();t.default=o});
define("odsp-next/controls/list/TilesList",["require","exports","tslib","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./viewModels/TilesListViewModel","./TilesList.html"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-tiles-list",template:e("./TilesList.html"),viewModel:function(e){n.__extends(t,e);function t(t){return e.call(this,t,t.resources.resolve(i.default.dependencies))||this}return t}(i.default),synchronous:!0});t.default=s});
define("odsp-next/controls/list/viewModels/TilesListViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../bindings/react/ReactBinding","../react/tilesList/TilesList.key","../../../resources/ControlResourceKeys","../../../utilities/browser/ResponsiveUI","@ms/odsp-shared-react/lib/utilities/resources/Resources","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.addBindingHandlers({react:i.default});var s=r.resources;s.block(f.asyncLoadBarrierKey);t.selectionModel&&t.selectionModel!==s.consume(o.itemsSelection.optional)&&s.expose(o.itemsSelection,t.selectionModel);var l=n.responsiveUI,c=void 0===l?s.consume(u.resourceKey):l;r._responsiveUI=c;r._currentItemSet=t.itemSet;r._requiredRange=t.requiredRange;r._onLayoutRenderComplete=t.onLayoutRenderComplete;r._onUpdateRequiredRange=r._onUpdateRequiredRange.bind(r);r.tilesListComponentType=a.ResourcedControl;r.tilesListProps=r.observables.pureCompute(r._computeTilesListProps);return r}t.prototype._computeTilesListProps=function(){var e=this._currentItemSet(),t=e.content(),n=this._responsiveUI.compareSize(this._responsiveUI.formFactorSize(),"Large")>0?"large":"small";return{resources:this.resources,specification:a.toSpecification(s.typeResourceKey.local,{setKey:e.item&&e.item.peek().key,itemSetContent:t,tilesListSize:n,onLayoutRenderComplete:this._onLayoutRenderComplete,onUpdateRequiredRange:this._onUpdateRequiredRange})}};t.prototype._onUpdateRequiredRange=function(e){this._requiredRange&&this._requiredRange(e)};t.dependencies=n.__assign({},r.default.dependencies,{responsiveUI:u.resourceKey});return t}(r.default);t.default=l});
define("odsp-next/controls/list/react/tilesList/TilesList.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeResourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./TilesList"],t,n)}).then(function(e){return e.typeResourceKey})})})});
define("odsp-next/controls/list/TilesList.html",[],function(){return'<div class=od-TilesList data-bind="react: { componentType: tilesListComponentType, props: tilesListProps }"></div>'});
define("odsp-next/controls/tooltip/TooltipContainer",["require","exports","office-ui-fabric-react/lib/Tooltip"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=n.Tooltip});
define("odsp-next/controls/columnsHeader/SortColumnCommandHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../commands/Command","./ColumnCommonUtilities","../../resources/ControlResourceKeys","../../resources/LoggingResourceKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.column,o=t.engagementName,u=n.actionMap,a=n.rumOneHelper,f=[],l=s.getSortMenuStrings(i),c=l.ascendingString,h=l.descendingString,p=function(){a&&a.logFilterSort("Sort")},d=r.scope.attached(n.commandViewModelType);f.push(new d({text:c,isToggleable:!0,engagementName:"SortAscending"+o,reportClickingTime:p,action:new(r.child(u.SortAction))({column:i,ascending:!0})}));f.push(new d({text:h,isToggleable:!0,hasLineBreakAfter:!0,engagementName:"SortDescending"+o,reportClickingTime:p,action:new(r.child(u.SortAction))({column:i,ascending:!1})}));r.commands=f;return r}t.dependencies=n.__assign({},r.default.dependencies,{actionMap:o.actionMap,rumOneHelper:u.rumOneHelper.optional,commandViewModelType:i.typeResourceKey});return t}(r.default);t.SortColumnCommandHelper=f;t.typeResourceKey=new a.ResourceKey({name:e("module").id,factory:new a.ResolvedResourceTypeFactory(f)});t.default=f});
define("odsp-next/controls/columnsHeader/ColumnCommonUtilities",["require","exports","../../bindings/beakAdorner/BeakAdornerBinding","@ms/odsp-utilities/lib/math/Point","./ColumnsHeader.resx","@ms/odsp-list-utilities/lib/ContextualMenu/ColumnUtilities"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MENU_OFFSET=new r.default(0,n.default.size/2+12);t.getSortMenuStrings=function(e){return s.getSortMenuStrings(e,i.strings)};t.getFieldName=function(e){return e?e.internalName||e.key:null}});
define("@ms/odsp-list-utilities/lib/ContextualMenu/ColumnUtilities",["require","exports","@ms/odsp-datasources/lib/dataSources/item/spListItemProcessor/SPListItemEnums"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="Last_x0020_Modified",i="Created_x0020_Date";t.getSortMenuStrings=function(e,t){var s="",o="";switch(e.fieldType){case n.ColumnFieldType.DateTime:case n.ColumnFieldType.FileActivity:s=t.columnMenuSortAscendingDate;o=t.columnMenuSortDescendingDate;break;case n.ColumnFieldType.Number:case n.ColumnFieldType.Currency:case n.ColumnFieldType.Counter:case n.ColumnFieldType.FileSize:case n.ColumnFieldType.Ratings:case n.ColumnFieldType.AverageRating:case n.ColumnFieldType.Likes:s=t.columnMenuSortAscendingNumber;o=t.columnMenuSortDescendingNumber;break;case n.ColumnFieldType.Text:case n.ColumnFieldType.Name:case n.ColumnFieldType.Title:case n.ColumnFieldType.Note:case n.ColumnFieldType.Taxonomy:case n.ColumnFieldType.User:s=t.columnMenuSortAscendingText;o=t.columnMenuSortDescendingText;break;case n.ColumnFieldType.Boolean:case n.ColumnFieldType.ComplianceRecordFlag:s=t.columnMenuSortAscendingBoolean;o=t.columnMenuSortDescendingBoolean;break;case n.ColumnFieldType.Lookup:if(e.internalName===r||e.internalName===i){s=t.columnMenuSortAscendingDate;o=t.columnMenuSortDescendingDate}else{s=t.columnMenuSortAscending;o=t.columnMenuSortDescending}break;case n.ColumnFieldType.Attachments:s=t.columnMenuSortAscendingAttachments;o=t.columnMenuSortDescendingAttachments;break;default:s=t.columnMenuSortAscending;o=t.columnMenuSortDescending}return{ascendingString:s,descendingString:o}}});
define("@ms/odsp-datasources/lib/dataSources/item/spListItemProcessor/SPListItemEnums",["require","exports","../../../interfaces/list/ColumnFieldType"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ColumnFieldType=n.ColumnFieldType;!function(e){e[e.icon=16]="icon";e[e.iconMin=16]="iconMin";e[e.bigIcon=48]="bigIcon";e[e.bigIconMin=48]="bigIconMin";e[e.regularMin=90]="regularMin";e[e.regular=130]="regular";e[e.nameMin=220]="nameMin";e[e.nameODC=440]="nameODC";e[e.nameODB=280]="nameODB";e[e.originalLocation=300]="originalLocation";e[e.custom=900]="custom";e[e.sharedWith=150]="sharedWith";e[e.note=250]="note";e[e.dateModifiedMl=150]="dateModifiedMl";e[e.dotDotDot=32]="dotDotDot";e[e.ratingsMin=110]="ratingsMin"}(t.ColumnWidth||(t.ColumnWidth={}));!function(e){e[e.none=0]="none";e[e.icon=1]="icon";e[e.name=2]="name";e[e.title=3]="title";e[e.calloutInvoker=4]="calloutInvoker";e[e.shareHeroCommand=5]="shareHeroCommand";e[e.modified=6]="modified";e[e.url=7]="url"}(t.MappedColumnType||(t.MappedColumnType={}));!function(e){e[e.none=0]="none";e[e.notify=1]="notify";e[e.block=2]="block";e[e.notifyAndBlock=3]="notifyAndBlock";e[e.blockSharing=4]="blockSharing"}(t.PolicyTipType||(t.PolicyTipType={}));!function(e){e[e.Auto=0]="Auto";e[e.Pinned=1]="Pinned";e[e.Removed=2]="Removed"}(t.ShowInFiltersPaneStatus||(t.ShowInFiltersPaneStatus={}));!function(e){e[e.fileNotFound=-2147024894]="fileNotFound";e[e.invalidView=-2147024809]="invalidView";e[e.listNotFound=-1]="listNotFound";e[e.docAlreadyExists=-2130575257]="docAlreadyExists";e[e.queryThrottled=-2147024860]="queryThrottled";e[e.newExperieceRenderingNotSupported=-2]="newExperieceRenderingNotSupported";e[e.onePageNavigationViewMismatch=-3]="onePageNavigationViewMismatch";e[e.onePageNavigationError=-4]="onePageNavigationError"}(t.ErrorType||(t.ErrorType={}))});
define("odsp-next/actions/rotate/RotateItemsOperator",["require","exports","tslib","../../providers/operator/BaseOperator","../../providers/item/ItemProvider","../../models/operation/OperationType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._context=t;r._itemProvider=n.itemProvider;return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input;n.name=r.name;n.iconName=r.iconName;n.type=s.default.rotateItems;n.payloads={rotateItems:{item:r,parent:r.parent}};return n};t.prototype.onStart=function(e){var t=this._context.items.map(function(e){return new r.Task(e.key,e)});e.update(t);return this._itemProvider.rotateItems({items:t.map(function(e){return e.input}),rotation:this._context.rotation,parentKey:this._context.parentKey},e)};t.dependencies=n.__assign({},r.default.dependencies,{itemProvider:i.resourceKey});return t}(r.default);t.default=u;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,u)});
define("odsp-next/providers/teachingBubble/TeachingBubbleHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../controls/firstRunExperience/FirstRunExperienceStatus.key","../../controls/firstRunExperience/FirstRunExperienceStatus"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._firstRunExperienceStatus=n.firstRunExperienceStatus;r.canShowTeachingBubbles=r.observables.pureCompute(r._computeCanShowTeachingBubble).extend({rateLimit:{timeout:300,method:"notifyWhenChangesStop"}});return r}t.prototype._computeCanShowTeachingBubble=function(){return this._firstRunExperienceStatus()===o.FirstRunExperienceStatus.notVisible};t.dependencies=n.__assign({},r.default.dependencies,{firstRunExperienceStatus:s.resourceKey});return t}(r.default);t.TeachingBubbleHelper=u;t.resourceKey=i.createResolvedResourceKey(e("module").id,u);t.default=u});
define("odsp-next/controls/iFrameDialog/IFrameDialog",["require","exports","./IFrameDialogViewModel","../../bindings/component/ControlBinding","./IFrameDialog.html","./IFrameDialog.css","../iframeLoader/IframeLoader"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"ms-iframe-dialog",name:e("module").id,template:e("./IFrameDialog.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/iFrameDialog/IFrameDialogViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./IFrameDialog.resx","../../providers/dialog/DialogProvider","knockout","../progressSpinnerFlat/ProgressSpinnerFlat","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/locale/Locale","../../utilities/iframe/IframeHelper"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r.loadingLabel=i.strings.IFrameDialogLoadingLabel;r.progressSpinnerFlatTagName=u.default.tagName;r._isIframeAvailable=!0;r._navigation=n.navigation;r._dialogProvider=n.dialogProvider;r.isLoading=o.observable(!0);r.componentUrl=t.componentUrl;r.showInDialog=t.showInDialog;r.heightOffset=t.heightOffset;r.forceSharePointScrollbar=t.forceSharePointScrollbar;r.maxHeight=t.maxHeight;r.addDisposable({dispose:function(){l.disposeIframe(r._iframeElement,function(){r._isIframeAvailable=!1})}});return r}t.prototype.iframeOnLoad=function(e,t){var n=this;if(this._isIframeAvailable){this._iframeElement=t.target;var r=this._iframeElement;r&&r.contentWindow&&this.async.setTimeout(function(){n.showInDialog&&n._setupIframeElementFunctions(r);n.isLoading(!1);if(!n.maxHeight){r.style.height=document.body.clientHeight*n.heightOffset+"px";n._modifyFramedPageHeight(r)}if(n.forceSharePointScrollbar){var e=r.contentWindow.document.getElementById("s4-workspace");if(e){f.default.isRightToLeft?e.style.paddingLeft="10px":e.style.paddingRight="10px";e.style.boxSizing="border-box"}}},10)}};t.prototype._modifyFramedPageHeight=function(e){var t=e.contentWindow.document.getElementById("s4-workspace");t&&(t.style.height=e.style.height)};t.prototype._setupIframeElementFunctions=function(e){var t=this,n=function(e){t._navigation.navigateTo(e)};e.cancelPopUp=function(){t._dialogProvider.currentDialog().dismiss()};e.commitPopup=function(e){"string"==typeof e&&"{"!==e[0]?n(e):t._dialogProvider.currentDialog().complete()};e.navigateParent=n};t.dependencies=n.__assign({},r.default.dependencies,{dialogProvider:s.resourceKey,navigation:a.navigation});return t}(r.default);t.default=c});
define("odsp-next/controls/iFrameDialog/IFrameDialog.html",[],function(){return'<div class=od-IFrameDialog data-bind="css: { \'od-IFrameDialog--maxHeight\': maxHeight}"><iframe frameborder=0 data-bind="attr: {src: componentUrl}, event: {load: iframeOnLoad}, visible: !isLoading()" style=width:100%></iframe><label class=od-Dialog-subText data-bind="text: loadingLabel, visible: isLoading"></label><div class=od-IFrameDialog-ProgressContainer data-bind="visible: isLoading"><div data-bind="component: {name: progressSpinnerFlatTagName}"></div></div></div>'});
define("odsp-next/controls/iFrameDialog/IFrameDialog.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-IFrameDialog{border:none;width:100%}.od-IFrameDialog.od-IFrameDialog--maxHeight{position:absolute;height:100%}.od-IFrameDialog.od-IFrameDialog--maxHeight iframe{height:100%}.od-IFrameDialog-ProgressContainer{width:250px;padding:15px 0}"}])});
define("odsp-next/controls/detailsPaneHost/legacy/LegacyDetailsPaneHost",["require","exports","./LegacyDetailsPaneHostViewModel","../../../bindings/component/ControlBinding","./LegacyDetailsPaneHost.html"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"ms-legacy-details-pane-host",name:e("module").id,template:e("./LegacyDetailsPaneHost.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/detailsPaneHost/legacy/LegacyDetailsPaneHostViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-shared-react/lib/utilities/resources/Resources","../../detailsPane/DetailsPaneWrapper","../../../bindings/react/ReactBinding","../../../utilities/features/Features","../../infoPane/InfoPane.key","../../progressSpinnerFlat/ProgressSpinnerFlat","../../../bindings/component/ControlBinding"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.useNewDetailsPane=u.isFeatureEnabled(u.EnableNewDetailsPane);if(r.useNewDetailsPane){r.addBindingHandlers({react:o.default});r.detailsPaneComponentType=i.ResourcedControl;r.detailsPaneProps=r.observables.pureCompute(function(){return{resources:r.resources,specification:i.toSpecification(s.typeResourceKey.local,{})}})}else{r.addBindingHandlers({control:l.default});r.knockoutSpecification=l.toSpecification(a.resourceKey,{showSections:t.showSections});r.knockoutPlaceholder=l.toSpecification(f.resourceKey,{})}return r}t.dependencies=n.__assign({},r.default.dependencies);return t}(r.default);t.default=c});
define("odsp-next/controls/detailsPane/DetailsPaneWrapper",["require","exports","tslib","react","prop-types","../../resources/ProviderResourceKeys","@ms/odsp-shared-react/lib/utilities/resources/Resources","@ms/odsp-utilities/lib/resources/Resources","../../utilities/features/Features","../../utilities/killSwitch/KillSwitch","react","office-ui-fabric-react/lib/common/DirectionalHint","../commandBar/commands/ItemScopeCoachmarkContainer","@ms/odsp-utilities/lib/scope/Scope","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../models/teachingBubble/TeachingBubbleCampaigns","../../providers/coachmark/CoachmarkProvider","./KnockoutDetailsPaneHost","../../dataSources/infoPane/InfoPaneManager.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t,n)||this;i._getCoachmark=function(){if(i._allowCoachmark){var e=i._getTeachingBubbleCampaign();return i.state.showCoachmark&&i._root&&i._root.current?r.createElement(h.ItemScopeCoachmarkContainer,{target:i._root.current,teachingBubbleCampaign:e,directionalHint:c.DirectionalHint.leftCenter,onDismiss:i._onDismissTeachingBubble,onTeachingBubbleSeen:i._onTeachingBubbleSeen}):void 0}};i._onDismissTeachingBubble=function(){var e=i._coachmarkProvider;e&&e.hideCampaign();var t=i._getTeachingBubbleCampaign();i._teachingBubbleProvider&&i._teachingBubbleProvider.markBubbleAsDismissed(t);v.Engagement.logData({name:"DocSetPropertiesCoachmark.Closed"})};i._onTeachingBubbleSeen=function(){var e=i._getTeachingBubbleCampaign();i._teachingBubbleProvider&&i._teachingBubbleProvider.markBubbleAsSeen(e);v.Engagement.logData({name:"DocSetPropertiesCoachmark.Rendered"})};var s=i.context.dependencies.resources;i._root=l.createRef();i._scope=new p.default;i._coachmarkProvider=s.consume(g.resourceKey.optional);i._observables=i._scope.attach(new(s.consume(d.observablesFactoryTypeResourceKey))({owner:i}));var o=m.DOCSET_PROPERTIES_PANE.killSwitchGuid;i._allowCoachmark=a.isFeatureEnabled(m.DOCSET_PROPERTIES_PANE.flag)&&(!o||!f.default.isActivated(o));i.state={allSectionGroups:void 0,showCoachmark:!1};return i}t.prototype.componentDidMount=function(){var e=this;this._addStoreListener(this.props);this._observables.compute(function(){e._computeShowCoachmark()})};t.prototype.componentDidUpdate=function(){var e=this;this._observables.compute(function(){e._computeShowCoachmark()})};t.prototype.componentWillUnmount=function(){this._scope.dispose()};t.prototype.render=function(){var e=this.context.dependencies,t=e.detailsPane,n=e.resources,i=this.state.allSectionGroups;return i?r.createElement(r.Fragment,null,r.createElement("div",{className:"od-DetailsPaneWrapper",ref:this._root},r.createElement(t,{allSectionGroups:i,resources:n})),this._getCoachmark()):null};t.prototype._getTeachingBubbleCampaign=function(){return m.DOCSET_PROPERTIES_PANE};t.prototype._addStoreListener=function(e){var t=this;this.context.dependencies.resources.consumeAsync(b.typeResourceKey).then(function(e){var n=t._scope.attach(new e({}));t.setState({allSectionGroups:n.getSectionGroups()})})};t.prototype._computeShowCoachmark=function(){var e=this;if(this._allowCoachmark){var t=this._coachmarkProvider;if(t){var n=this._observables.unwrap(t.getCurrentTeachingBubble());if(!n)return;if(n){var r=this._observables.unwrap(n.isVisible||!1),i=n.campaign();if(!i||i.campaignGuid!==this._getTeachingBubbleCampaign().campaignGuid){this.state.showCoachmark&&this.setState({showCoachmark:!1});return}var o=this.context.dependencies.resources;this._teachingBubbleProvider||(this._teachingBubbleProvider=o.consume(s.teachingBubble.optional));this._teachingBubbleProvider&&this._teachingBubbleProvider.shouldBubbleBeAdded(i,!1).then(function(t){var n=!!(t&&r&&e._root&&e._root.current);e.state.showCoachmark!==n&&e.setState({showCoachmark:n})})}}}};t.contextTypes={dependencies:i.object.isRequired};return t}(r.Component);t.default=w;t.typeResourceKey=o.createResolvedComponentTypeResourceKey(e("module").id,w,{resources:u.resourceScopeKey.local,detailsPane:y.resourceKey})});
define("odsp-next/controls/commandBar/commands/ItemScopeCoachmarkContainer",["require","exports","tslib","react","office-ui-fabric-react/lib/TeachingBubble","office-ui-fabric-react/lib/common/DirectionalHint","office-ui-fabric-react/lib/Coachmark","../../../models/teachingBubble/TeachingBubble.resx","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../../models/flow/FlowHelpers"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onDismiss=function(){a.Engagement.logData({name:"Coachmark.Close",extraData:{campaignGuid:t._getCampaignGuid()}});var e=t.props.onDismiss;e&&e()};t._onTeachingBubbleSeen=function(){a.Engagement.logData({name:"Coachmark.Rendered",extraData:{campaignGuid:t._getCampaignGuid()}});var e=t.props.onTeachingBubbleSeen;e&&e()};t._getCampaignGuid=function(){return t.props.teachingBubbleCampaign.campaignGuid};return t}t.prototype.render=function(){var e,t=this.props,n=t.teachingBubbleCampaign,a=t.onAnimationOpenStart,l=t.directionalHint,c=void 0===l?s.DirectionalHint.bottomCenter:l;e=n.automateExperimentBodyCopy&&f.isAutomateExperimentOn()?n.automateExperimentBodyCopy:n.bodyCopy;return r.createElement(o.Coachmark,{target:this.props.target,positioningContainerProps:{directionalHint:c},onAnimationOpenStart:a,onAnimationOpenEnd:this._onTeachingBubbleSeen,preventFocusOnMount:!0},r.createElement(i.TeachingBubbleContent,{headline:n.title,calloutProps:{doNotLayer:!0},hasCloseIcon:n.isDismissable,closeButtonAriaLabel:u.strings.closeButton,onDismiss:this._onDismiss,hasCondensedHeadline:!0},e))};return t}(r.PureComponent);t.ItemScopeCoachmarkContainer=l});
define("odsp-next/providers/coachmark/CoachmarkProvider",["require","exports","tslib","../../utilities/features/Features","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../resources/ProviderResourceKeys","../../controls/firstRunExperience/FirstRunExperienceStatus.key","../../controls/firstRunExperience/FirstRunExperienceStatus"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h="CoachmarkTearDropSeen",p="CoachmarkProvider";t.disabledCampaign={campaignGuid:"00000000-0000-0000-0000-000000000000",endDate:new Date(1970,1,1),flag:r.Off,isCoachmark:!0};var d=function(e){n.__extends(r,e);function r(n,r){void 0===n&&(n={});var i=e.call(this,n,r)||this;i._dataStore=new o.default(p,u.default.session);i._currentCampaign=i.createObservable(t.disabledCampaign);i._isVisible=i.createObservable(!1);i._navigation=r.navigation;i._firstRunExperienceStatus=r.firstRunExperienceStatus;i._currentTeachingBubble=i.createObservable({campaign:i._currentCampaign,isVisible:i._isVisible});i._navigation.viewParams.resetAllBubbles&&i._dataStore.remove(h);return i}Object.defineProperty(r.prototype,"isVisible",{get:function(){return this._isVisible},enumerable:!0,configurable:!0});Object.defineProperty(r.prototype,"currentCampaign",{get:function(){return this._currentCampaign},enumerable:!0,configurable:!0});r.prototype.hideCampaign=function(){this._isVisible(!1);this._currentCampaign(t.disabledCampaign)};r.prototype.setCampaign=function(e){var n=this;if(e){if(this._firstRunExperienceStatus()!==c.FirstRunExperienceStatus.visible){var r=""+e.name+h;if(!this._dataStore.getValue(h)){this._teachingBubbleProvider||(this._teachingBubbleProvider=this.resources.consume(f.teachingBubble.optional));this._teachingBubbleProvider&&this._teachingBubbleProvider.shouldBubbleBeAdded(e,!1).then(function(t){if(t){n._currentCampaign(e);n._isVisible(!0);n._dataStore.setValue(r,!0)}})}}}else{this._currentCampaign(t.disabledCampaign);this._isVisible(!1)}};r.prototype.getCurrentTeachingBubble=function(){return this._currentTeachingBubble};r.dependencies=n.__assign({},i.default.dependencies,{navigation:a.navigation,firstRunExperienceStatus:l.resourceKey});return r}(i.default);t.default=d;t.resourceKey=s.createResolvedResourceKey(e("module").id,d)});
define("odsp-next/controls/detailsPane/KnockoutDetailsPaneHost",["require","exports","tslib","react","../base/react/WithKnockoutComputed","./DetailsPane","@ms/odsp-utilities/lib/resources/Resources","../../actions/base/ItemSelectionHelper","@ms/utilities-disposables/lib/Scope"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new o.ResourceKey({name:e("module").id,factory:{dependencies:{itemSelectionHelperType:u.typeResourceKey},create:function(e){var t=e.itemSelectionHelperType;return{instance:function(e){var o=r.useRef(),u=o.current||(o.current=new a.Scope);r.useEffect(function(){return function(){u.dispose()}},[]);var f=r.useRef(),l=f.current||(f.current=u.attach(new t({allowMultiSelect:!0,canFallback:!0}))),c=i.useObservableValue(l.selection);return r.createElement(s.default,n.__assign({},e,{items:c}))}}}}})});
define("odsp-next/controls/detailsPane/DetailsPane",["require","exports","tslib","react","react-dom","office-ui-fabric-react/lib/ScrollablePane","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","./pane/primary/PrimaryPane","./pane/secondary/SecondaryPane","office-ui-fabric-react/lib/Utilities","@ms/odsp-utilities/lib/scope/Scope","./DetailsPane.css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onPrimaryHeaderHeightChange=function(e){r.setState({primaryHeaderHeight:e})};r._onSecondaryHeaderHeightChange=function(e){r.setState({secondaryHeaderHeight:e})};r._onPaneHeightChange=function(){r._scrollablePane&&r._scrollablePane.forceLayoutUpdate()};r._onSecondaryPaneHeaderClick=function(){if(r._detailsPaneElement&&r._primaryPaneElement&&r._secondaryPaneElement){var e=r._detailsPaneElement.getBoundingClientRect().top;if(r._secondaryPaneElement.getBoundingClientRect().top-e<r._detailsPaneElement.clientHeight/2){r._primaryPaneElement.scrollIntoView(!0);r.setState({isSecondaryPaneExpanded:!1})}else{var t=r._scrollablePane.getScrollPosition();r._secondaryPaneElement.scrollIntoView(!0);r.setState({isSecondaryPaneExpanded:!0,scrollPosition:t})}}};r._scope=new l.default;r._observables=r._scope.attach(new o.default({owner:r}));r.state={availableSectionGroups:r._observables.ignore(function(){return r._computeSectionGroups(t)}),isSecondaryPaneExpanded:!1,detailsPaneHeight:void 0,primaryHeaderHeight:void 0,secondaryHeaderHeight:void 0,scrollPosition:0};return r}t.prototype.componentDidMount=function(){this._addStoreListener(this.props);if(this._detailsPaneElement){this._updateDetailsPaneHeight();this._events.on(window,"resize",this._updateDetailsPaneHeight);f.getFirstFocusable(this._detailsPaneElement,this._primaryPaneElement,!1).focus()}};t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this;e.allSectionGroups===this.props.allSectionGroups&&e.items===this.props.items||this.setState({availableSectionGroups:this._observables.ignore(function(){return t._computeSectionGroups(e)})})};t.prototype.shouldComponentUpdate=function(e,t){return e.items!==this.props.items||e.allSectionGroups!==this.props.allSectionGroups||e.resources!==this.props.resources||t.availableSectionGroups!==this.state.availableSectionGroups||t.isSecondaryPaneExpanded!==this.state.isSecondaryPaneExpanded||t.detailsPaneHeight!==this.state.detailsPaneHeight||t.primaryHeaderHeight!==this.state.primaryHeaderHeight||t.secondaryHeaderHeight!==this.state.secondaryHeaderHeight};t.prototype.UNSAFE_componentWillUpdate=function(e){e.allSectionGroups===this.props.allSectionGroups&&e.items===this.props.items||this._removeCurrentStoreListener()};t.prototype.componentDidUpdate=function(e){e.allSectionGroups===this.props.allSectionGroups&&e.items===this.props.items||this._addStoreListener(this.props);if(this._primaryPaneElement&&1===e.items.length&&1===this.props.items.length&&e.items[0].peek().key!==this.props.items[0].peek().key){this._primaryPaneElement.scrollIntoView(!0);this.setState({isSecondaryPaneExpanded:!1,scrollPosition:0})}};t.prototype.componentWillUnmount=function(){this._removeCurrentStoreListener();this._detailsPaneElement&&this._events.off(window,"resize",this._updateDetailsPaneHeight);this._scope.dispose()};t.prototype.render=function(){var e=this,t=this.props,n=t.items,o=t.resources,l=this.state,c=l.availableSectionGroups,h=l.isSecondaryPaneExpanded,p=l.detailsPaneHeight,d=l.primaryHeaderHeight,v=l.secondaryHeaderHeight,m=l.scrollPosition;if(c&&c[0]){var g=0===c[0].sections.length;return r.createElement("div",{ref:function(t){e._detailsPaneElement=t},"data-automationid":"ms-info-pane",role:"complementary",className:f.css("od-DetailsPane",{"od-DetailsPane--secondaryPaneDisabled":!c[1]||!c[1].sections.length})},r.createElement(s.ScrollablePane,{componentRef:function(t){e._scrollablePane=t},initialScrollPosition:!h&&m,className:"od-DetailsPane-scrollablePane"},r.createElement(u.default,{ref:function(t){e._primaryPaneElement=i.findDOMNode(t)},items:n,sectionGroup:c[0],onHeightChange:this._onPaneHeightChange,onHeaderHeightChange:this._onPrimaryHeaderHeightChange,isCollapsed:h||g,minHeight:p&&p-(v||0)+1,resources:o}),c[1]?r.createElement(a.default,{ref:function(t){e._secondaryPaneElement=i.findDOMNode(t)},items:n,sectionGroup:c[1],onHeaderClick:this._onSecondaryPaneHeaderClick,isHeaderClickDisabled:g,onHeightChange:this._onPaneHeightChange,onHeaderHeightChange:this._onSecondaryHeaderHeightChange,minHeight:p&&void 0!==d&&p-d,resources:o}):null))}return null};t.prototype._updateDetailsPaneHeight=function(){this.setState({detailsPaneHeight:this._detailsPaneElement.clientHeight})};t.prototype._removeCurrentStoreListener=function(){this._sectionGroupsSubscription.dispose()};t.prototype._addStoreListener=function(e){var t=this,n=this._observables.pureCompute(function(){return t._computeSectionGroups(e)});this._sectionGroupsSubscription=this._observables.subscribe(n,function(e){t.setState({availableSectionGroups:e})})};t.prototype._computeSectionGroups=function(e){return e.allSectionGroups.map(function(t){return{sections:t.sections.filter(function(t){return t.isAvailable(e.items.filter(function(e){return!!e}).map(function(e){return e.peek()}))})}})};return t}(f.BaseComponent);t.default=c});
define("odsp-next/controls/detailsPane/pane/primary/PrimaryPane",["require","exports","tslib","react","@ms/odsp-list-utilities/lib/Renderers/FileTypeIconRenderer","../../../../utilities/icons/IconHelper","../../../../providers/fileHandler/FileHandlerProvider","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/Utilities","../../parentHeightWatcher/ParentHeightWatcher","office-ui-fabric-react/lib/Sticky","../../DetailsPane.resx","../../../../models/comments/ItemActivityCommentsFeature.key","../../DetailsPaneSectionList","../../globalSettings/GlobalSettingsMenu","../../../../utilities/accessibility/AriaHelper","./PrimaryPane.css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._resources=t.resources;r.state={isCommentDisabledOnFile:!0};r._enableComments=r._resources.consume(h.resourceKey);return r}t.prototype.componentDidMount=function(){if(this._headerDiv){this._onHeaderHeightChange();this._events.on(window,"resize",this._onHeaderHeightChange)}};t.prototype.shouldComponentUpdate=function(e,t){return e.items!==this.props.items||e.sectionGroup!==this.props.sectionGroup||e.isCollapsed!==this.props.isCollapsed||e.minHeight!==this.props.minHeight||e.onHeightChange!==this.props.onHeightChange||e.onHeaderHeightChange!==this.props.onHeaderHeightChange||e.resources!==this.props.resources};t.prototype.componentWillUnmount=function(){this._headerDiv&&this._events.off(window,"resize",this._onHeaderHeightChange)};t.prototype.render=function(){var e=this,t=this.props,n=t.isCollapsed,i=t.minHeight,s=t.onHeightChange;return r.createElement("div",{className:a.css("od-DetailsPane-PrimaryPane-wrapper",{"od-DetailsPane-PrimaryPane--isCollapsed":n}),style:{minHeight:!n&&i||this._headerDiv&&this._headerDiv.clientHeight}},r.createElement("div",{className:"od-DetailsPane-PrimaryPane"},r.createElement("div",{ref:function(t){e._headerDiv=t}},r.createElement(l.Sticky,null,this._renderSectionsHeader())),r.createElement("div",{className:"od-DetailsPane-PrimaryPane-body"},r.createElement(f.default,{onHeightChange:s},this._renderSectionsBody()))))};t.prototype._renderSectionsHeader=function(){var e,t=this.props.items;e=1===t.length?t[0].peek().displayName:u.format(c.strings.multipleItemsSelected,t.length);var n=this._renderPaneIcon();return r.createElement("div",{className:"od-DetailsPane-PrimaryPane-header",tabIndex:0},r.createElement("div",{className:"od-DetailsPane-PrimaryPane-header-icon"},n),r.createElement("h1",{className:"od-DetailsPane-PrimaryPane-header-title"},e),this._enableComments&&r.createElement(d.default,{items:t,resources:this._resources}))};t.prototype._renderPaneIcon=function(){var e,t,n,u,a=this.props,f=a.items,l=a.resources;if(1===f.length){var c=f[0].peek();e=c.iconName||"genericfile";var h=c.extension,p=l.consume(o.resourceKey.optional);t=c.iconUrl||function(e,t){return e&&e.getFileTypeIconUrl(t,!0)}(p,h)||s.getIconUrl(l,e,32);n=function(e,t){return e&&e.getFileTypeName(t,!0)}(p,h);u=v.getTooltipText(c)}else{e="genericfile";t=s.getIconUrl(l,e,32)}return r.createElement(i.FileTypeIconRenderer,{iconName:e,width:32,iconUrl:t,iconTitle:n,isDisabled:!1,tooltipText:u,ariaLabel:n,isClickable:!1,onClick:this._fileIconOnClick})};t.prototype._fileIconOnClick=function(e){};t.prototype._renderSectionsBody=function(){var e=this.props,t=e.items,n=e.sectionGroup,i=e.resources;return r.createElement(p.default,{items:t,sections:n.sections,resources:i})};t.prototype._onHeaderHeightChange=function(){if(this.props.onHeaderHeightChange){var e=this._headerDiv.clientHeight;this.props.onHeaderHeightChange(e)}};return t}(a.BaseComponent);t.default=m});
define("odsp-next/controls/detailsPane/parentHeightWatcher/ParentHeightWatcher",["require","exports","tslib","react","@ms/odsp-utilities/lib/events/EventGroup","./ParentHeightWatcher.css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=new i.default(window),o=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.shouldComponentUpdate=function(e,t){return e.children!==this.props.children};t.prototype.componentDidMount=function(){var e=this;this._iframeElement&&s.on(this._iframeElement.contentWindow,"resize",function(){e.props.onHeightChange()})};t.prototype.componentWillUnmount=function(){this._iframeElement&&s.off(this._iframeElement.contentWindow,"resize")};t.prototype.render=function(){var e=this;return r.createElement("div",{className:"od-ParentHeightWatcher"},r.createElement("iframe",{ref:function(t){e._iframeElement=t},className:"od-ParentHeightWatcher-iframe"}),this.props.children)};return t}(r.Component);t.default=o});
define("odsp-next/controls/detailsPane/parentHeightWatcher/ParentHeightWatcher.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ParentHeightWatcher-iframe{position:absolute;top:0;bottom:0;left:0;right:0;height:100%;width:0;visibility:hidden}"}])});
define("odsp-next/controls/detailsPane/DetailsPaneSectionList",["require","exports","tslib","react","./section/itemActivityFeed/ItemActivityFeedSection","./section/itemActivityFeed/LegacyItemActivityFeedSection","./section/itemExtractedText/ItemExtractedTextSection","./section/itemInformation/ItemInformationSection","./section/itemPreview/ItemPreviewSection","./section/itemProperties/ItemPropertiesSection","./section/itemShortcut/ItemShortcutSection","./section/itemPolicy/ItemPolicySection","./section/itemSharing/ItemSharingSection","./section/itemStatus/ItemStatusSection","./section/malwareDetected/MalwareDetectedSection"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.sections.map(function(t){return e._renderSection(t)});return r.createElement("div",null,t)};t.prototype._renderSection=function(e){var t=this.props,n=t.items,v=t.resources,m=n[0];return 9===e.type?r.createElement(i.default,{key:e.type,item:m.peek(),resources:v}):10===e.type?r.createElement(s.default,{key:e.type,item:m,resources:v}):11===e.type?r.createElement(u.default,{key:e.type,item:m,resources:v}):14===e.type?r.createElement(a.default,{key:e.type,item:m,resources:v}):7===e.type?r.createElement(f.default,{key:e.type,item:void 0,resources:v}):13===e.type?r.createElement(l.default,{key:e.type,item:m,resources:v}):3===e.type?r.createElement(c.default,{key:e.type,item:m,resources:v}):8===e.type?r.createElement(h.default,{key:e.type,item:m,resources:v}):15===e.type?r.createElement(p.default,{key:e.type,items:n.map(function(e){return e.peek()})}):16===e.type?r.createElement(d.default,{key:e.type}):6===e.type?r.createElement(o.default,{key:e.type,item:m,resources:v}):null};return t}(r.Component);t.default=v});
define("odsp-next/controls/detailsPane/section/itemActivityFeed/ItemActivityFeedSection",["require","exports","tslib","react","../../../itemActivityFeed/OldItemActivityFeed","../../../itemActivityFeed/ItemActivityFeed","../../../../utilities/features/Features","./ItemActivityFeedSection.css"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return o.isFeatureEnabled(o.ActivityFeedRefactoring)?r.createElement("div",{className:"od-DetailsPane-ItemActivityFeedSection"},r.createElement("div",{className:"od-DetailsPane-ItemActivityFeedSection-content"},r.createElement(s.default,{item:t,resources:n}))):r.createElement("div",{className:"od-DetailsPane-ItemActivityFeedSection"},r.createElement("div",{className:"od-DetailsPane-ItemActivityFeedSection-content"},r.createElement(i.default,{item:t,resources:n})))};return t}(r.Component);t.default=u});
define("odsp-next/controls/itemActivityFeed/OldItemActivityFeed",["require","exports","tslib","react","prop-types","./ItemActivityFeed.resx","@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivityFeed","./ItemActivityFeedViewOption","../../models/itemsScope/ItemsScopeFeature.key","../../resources/DataSourceResourceKeys","../../providers/itemActivities/GroupedItemActivityFeedStore","../../providers/engagement/Engagement","../../providers/itemActivities/ItemCommentsStore","../../providers/item/ItemProvider","@ms/odsp-shared-react/lib/components/LivePersonaCardAdapter/LivePersonaCardAdapter","../../utilities/features/Features","../../models/itemActivity/ItemActivityFeedHelper","../../models/comments/ItemActivityCommentsFeature.key","../../utilities/item/ListItemTypeConverter","@ms/odsp-datasources/lib/Permissions","../../models/item/ItemParentHelper","../itemMuteNotification/ItemMuteNotification","../../models/item/ItemType","../base/react/ResolvedComponentType","./ItemActivityFeed.css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=x.getResolvedComponentType(E.resourceKey.local.bypass),N=function(e){n.__extends(t,e);function t(t,i){var s=e.call(this,t,i)||this;s._canOpenItem=function(e){return!!s._getItemUrl(e)};s._onItemClick=function(e,t){var n=s.props.item,r=s._getItemUrl(e);s._itemActivityFeedHelper.navigateToItem(n,e,r,function(e){s._engagement.logData({name:"ActivityFeed.ItemClicked",isIntentional:!0,extraData:{activityType:t||"",itemType:e||""}})})};s._onItemCommentsSettingChanged=function(e){var t=s.props.item;if(e!==(t.comments&&t.comments.settings&&t.comments.settings.isCommentDisabled)){var r=n.__assign({},t.comments&&t.comments.settings,{isCommentDisabled:e}),i=s._resources.consume(p.resourceKey);i.invalidateItem(t.key);i.invalidateItem(t.parentKey);s._itemActivityFeedHelper.updateItem(t,{comments:n.__assign({},t.comments,{settings:r})});var o=t&&t.properties&&t.properties.ID;s._isItemsScopeEnabled()&&s._resources.consumeAsync(f.itemInvalidator).then(function(e){e.refreshItemsInCurrentItemSet([o])})}};s._canDeleteActivity=function(e){var t=s.props.item;switch(e){case 2:return s._isCommentsAvailable(t)&&b.PermissionMask.hasItemPermission(t,b.PermissionMask.editListItems);default:return!1}};s._onRenderUser=function(e,t){var n=t&&t(e),i=s._itemActivityDataSource.getPageContextForRenderUser();return i?r.createElement(d.LivePersonaCardAdapter,{key:e.user.id||e.user.email,personaType:"User",email:e.user.email,pageContext:i},n):n};s._deleteCommentActivity=function(e,t,n){var r=n.commentItem,i=n.commentId;e&&r&&i&&s._itemCommentsStore.deleteCommentById(r,i,t)};s._resources=t.resources;s._itemActivityFeedStore=s._resources.consume(l.resourceKey);var o=s._resources.consume(f.identity);s._itemCommentsStore=s._resources.consume(h.resourceKey);s._currentUserEmail=o.getIdentity().loginName;s._itemActivityDataSource=s._resources.consume(f.itemActivityFeed);s._itemActivityFeedHelper=new(s._resources.injected(m.default));s._engagement=s._resources.consume(c.resourceKey);s._isItemsScopeEnabled=s._resources.consume(a.isItemsScopeEnabledResourceKey.lazy);s._isCommentsInActivityFeedEnabled=s._resources.consume(g.resourceKey.lazy);s._itemParentHelper=s._resources.consume(w.resourceKey);s.state={graphDataSource:s._resources.consume(f.graph.optional),commentsOnly:!1};return s}t.prototype.getChildContext=function(){return{itemActivityFeedStore:this._itemActivityFeedStore,itemCommentsStore:this._itemCommentsStore}};t.prototype.componentDidMount=function(){this.state.graphDataSource||this._loadGraphDataSource()};t.prototype.shouldComponentUpdate=function(e,t){var n=e.item,r=this.props.item;return n&&r&&n.key!==r.key&&0===n.revision||this._isCommentSettingsChanged(n,r)||e.resources!==this.props.resources||t.graphDataSource!==this.state.graphDataSource||t.commentsOnly!==this.state.commentsOnly};t.prototype.render=function(){var e=this,t=this.props.item,n=this.state.commentsOnly,i=t.displayName||"",a=this._itemActivityFeedHelper.getGraphItemUrl(t,this.state.graphDataSource),f=this._itemActivityFeedHelper.getAccessToken(t,this.state.graphDataSource),l=!v.isOneDrive&&t.list&&t.list.isDocumentLibrary&&t.name||void 0;if(a&&f){var c={name:i,graphItemUrl:a,accessToken:f},h=this._isCommentsAvailable(t),p=this._getCommentListItem(t,c)||void 0,d=h&&n,m=!(h&&(b.PermissionMask.hasItemPermission(t,b.PermissionMask.editListItems)||b.PermissionMask.hasItemPermission(t,b.PermissionMask.reviewListItems)))||this._isCommentDisabled(t);this._engagement.logData({name:"ActivityFeed.Renders",isIntentional:!0});return r.createElement("div",{className:"od-ItemActivityFeedWrapper"},r.createElement("div",{className:"od-ItemActivityFeed-header"},r.createElement("div",{className:"od-ItemActivityFeed-title"},s.strings.itemActivityFeedSectionTitle),this._isItemNotificationActive()&&r.createElement(T,{item:t}),r.createElement(u.ItemActivityFeedViewOption,{isCommentsOnlyView:n,item:t,onSelectMenuOption:function(t){e.setState({commentsOnly:t})}})),r.createElement(o.default,{currentUserEmail:this._currentUserEmail,containingItem:c,isSingleLevel:!t.folder,canOpenItem:this._canOpenItem,onItemClick:this._onItemClick,onRenderUser:this._onRenderUser,currentListTitle:l,commentListItem:p,isReadonly:m,commentsOnly:d,canDeleteActivity:this._canDeleteActivity,activityMenuFunctions:this._getActionMenuFunctions(),onCommentSettingsChanged:this._onItemCommentsSettingChanged}))}return r.createElement("div",null)};t.prototype._isItemNotificationActive=function(){var e=this.props.item,t=v.isFeatureEnabled(v.EnableCommentsInActivityFeed)&&v.isFeatureEnabled(v.EnablePerItemMuteNotification);return e.type!==S.default.Folder&&t};t.prototype._getCommentListItem=function(e,t){if(this._isCommentsAvailable(e)){var n=this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"),r=n&&n.peek()&&n.peek().list&&n.peek().list.id;if(r)return{item:y.convertToISPListItem(e),activityItemWrapper:t,parentListId:r}}};t.prototype._isCommentsAvailable=function(e){return m.isNonOfficeFileCommentsAvailable(e,this._isCommentsInActivityFeedEnabled())};t.prototype._isCommentDisabled=function(e){return e&&e.comments&&e.comments.settings&&e.comments.settings.isCommentDisabled};t.prototype._isCommentSettingsChanged=function(e,t){return(e.comments&&e.comments.settings&&e.comments.settings.isCommentDisabled)!==(t.comments&&t.comments.settings&&t.comments.settings.isCommentDisabled)};t.prototype._getItemUrl=function(e){return this._itemActivityDataSource.getActivityItemUrl(e)};t.prototype._loadGraphDataSource=function(){var e=this;this._resources.consumeAsync(f.graph).then(function(t){e.setState({graphDataSource:t})})};t.prototype._getActionMenuFunctions=function(){var e;return(e={})[2]={delete:this._deleteCommentActivity},e};t.childContextTypes={itemActivityFeedStore:i.object.isRequired,itemCommentsStore:i.object.isRequired};return t}(r.Component);t.default=N});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivityFeed",["require","exports","tslib","react","prop-types","./IItemCommentsStore","./ItemActivityList/ItemActivityList","../AddCommentTextField/AddCommentTextField","./ItemActivity/ItemActivities","./ItemActivityGroupByDateHelper","./ItemActivityFeed.resx","@ms/shared-react-item-activity/lib/components/ItemActivities.resx","./ItemActivityFeed.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onRenderMissingActivity=function(e,t){var n=r.state,i=n.isEndOfActivities,s=n.showComments;i||r._store.fetchItemActivities({item:r.props.containingItem,startIndex:e,currentUserEmail:r.props.currentUserEmail,qosPrefix:"ItemActivityFeed",environment:r.props.environment,isScrollEvent:t});s&&r._itemCommentsStore.fetchItemComments({itemWrapper:r.props.commentListItem,currentUserEmail:r.props.currentUserEmail})};r._onFetchCommentsError=function(e){var t=r.props.onFetchCommentsError;t&&t(e);r.setState({showAllCommentActivities:!0,itemCommentsQueried:!0})};r._store=n.itemActivityFeedStore;r._itemCommentsStore=n.itemCommentsStore;r._engagementSource=n.engagementSource||"ActivityFeed";var i=!!t.commentListItem,s=i&&r._itemCommentsStore.getItemComments({itemWrapper:t.commentListItem,currentUserEmail:t.currentUserEmail,startIndex:0,onError:r._onFetchCommentsError})||void 0;r.state={activities:r._store.getItemActivities({item:r.props.containingItem,currentUserEmail:t.currentUserEmail}),itemComments:s,isEndOfActivities:!1,itemCommentsQueried:s&&!s.isPlaceHolder,showAllCommentActivities:!i,showComments:i,feedUpdatedMessage:""};return r}t.prototype.UNSAFE_componentWillReceiveProps=function(e){if(e.containingItem.graphItemUrl!==this.props.containingItem.graphItemUrl||e.currentUserEmail!==this.props.currentUserEmail){var t=!!e.commentListItem,n=t&&this._itemCommentsStore.getItemComments({itemWrapper:e.commentListItem,currentUserEmail:e.currentUserEmail,startIndex:0,onError:this._onFetchCommentsError})||void 0;this.setState({activities:this._store.getItemActivities({item:e.containingItem,currentUserEmail:e.currentUserEmail}),showComments:t,itemComments:n,showAllCommentActivities:!t,itemCommentsQueried:n&&!n.isPlaceHolder,isEndOfActivities:!1,feedUpdatedMessage:""});this._removeCurrentListeners();this._addListeners(e)}e.containingItem!==this.props.containingItem&&this._refreshActivityFeed(e);e.commentsOnly!==this.props.commentsOnly&&this.setState({isEndOfActivities:!1})};t.prototype.componentDidMount=function(){this._addListeners(this.props)};t.prototype.componentWillUnmount=function(){this._removeCurrentListeners()};t.prototype.render=function(){var e=this.state,t=e.activities,n=e.itemComments,i=e.showComments,s=e.itemCommentsQueried,u=this.props,a=u.isReadonly,f=u.commentsOnly,c=this._getViewableItemActivitiesAndGroups(t,n),h=c.activities,p=c.dateGroups;if((t.isPlaceholder||t.nextRequestToken||n&&n.nextLink)&&(!f||!this._noCommentActivities())){var d=p.length;h.push(void 0);0===d?p.push({key:"",name:"",startIndex:0,count:1}):d>0&&(p[p.length-1].count+=1)}var v=this._renderNoActivitiesNote(),m=this._renderError(),g=h.slice(0,h.length);return r.createElement("div",{className:"od-ItemActivityFeed"},r.createElement("div",{"aria-live":"assertive",role:"status","aria-atomic":"true",className:"od-ItemActivityFeed-screenReaderOnly"},this.state.feedUpdatedMessage),this._renderAddCommentField(),r.createElement("div",{"aria-label":l.default.activityListAriaLabel},v,r.createElement(o.default,{activities:g,groups:p,onRenderMissingActivity:this._onRenderMissingActivity,enableShimmer:!0,isDataReady:!i||!!s,isReadonly:a}),m))};t.prototype._renderError=function(){var e=this.state.activities;if(e.success)return null;var t=e.activities.length>0?l.default.fetchMoreError:l.default.fetchError;return r.createElement("div",{className:"od-ItemActivityFeed-error"},t)};t.prototype._renderNoActivitiesNote=function(){var e=this.state,t=e.activities,n=e.showComments,i=this.props.commentsOnly;return!t.success||t.isPlaceholder||0!==t.activities.length||t.nextRequestToken||n&&!this._noCommentActivities()?i&&this._noCommentActivities()?r.createElement("div",{className:"od-ItemActivityFeed-noActivities"},l.default.noCommentActivities):null:r.createElement("div",{className:"od-ItemActivityFeed-noActivities"},l.default.noActivities)};t.prototype._noCommentActivities=function(){var e=this.state,t=e.itemComments;return e.showComments&&(!t||t&&t.comments&&t.comments.length<1)};t.prototype._renderAddCommentField=function(){var e=this,t=this.props,n=t.commentListItem;if(!t.isReadonly&&n){var i=n&&n.item,s=i.isRootFolder?"driveRoot":i.folder?"folder":i.extension||"file";return r.createElement(u.default,{commentItemId:n.item&&n.item.id,placeholderText:l.default.addCommentPlaceHolder,sendButtonTitle:"",onSend:function(t,r,i){e._itemCommentsStore.addComment(n,t).then(function(t){e._refreshActivityFeed(e.props);r&&r()},function(e){var t=e&&e.message&&e.message.value;i&&i(t)})},engagementSource:this._engagementSource+".AddComment",engagementExtraData:{itemType:s}})}};t.prototype._refreshActivityFeed=function(e){this._store.fetchItemActivities({item:e.containingItem,startIndex:0,currentUserEmail:e.currentUserEmail,qosPrefix:"ItemActivityFeed",environment:e.environment});var t=!!e.commentListItem;t&&this._itemCommentsStore.fetchItemComments({itemWrapper:e.commentListItem,startIndex:0,currentUserEmail:e.currentUserEmail});this.setState({itemCommentsQueried:!1,showComments:t,isEndOfActivities:!1});this._removeCurrentListeners();this._addListeners(e)};t.prototype._getViewableItemActivitiesAndGroups=function(e,t){var n,r,i=this.props.commentsOnly,s=[],o=[],u=function(){if(0===o.length)return 0;var e=o[o.length-1];return e.startIndex+e.count};if(e)for(var l=0,c=e.activities;l<c.length;l++){var h=c[l];if(h){var p=void 0;(!i||h instanceof a.CommentItemActivity)&&(p=this._getViewableItemActivity(h));if(p){s.push(p);r=p.getDate();var d=f.getActivityGroupByDate(h);if((w=f.RelativeDateGroupStrings[d]||d)!==n){o.push({key:"activityDateGroup-"+o.length,name:w,count:1,startIndex:u()});n=w}else o[o.length-1].count+=1}}}if(e.success&&!e.isPlaceholder&&!e.nextRequestToken&&t&&t.comments||i&&t&&t.comments){r=r||new Date;for(var v=0,m=t.comments;v<m.length;v++){var g=m[v],y=g&&this._getViewableItemActivity(g),b=y&&y.getDate();if(b&&b.getTime()<r.getTime()){s.push(y);var w;d=f.getActivityGroupByDate(g);if((w=f.RelativeDateGroupStrings[d]||d)!==n){o.push({key:"activityDateGroup-"+o.length,name:w,count:1,startIndex:u()});n=w}else o[o.length-1].count+=1}}}return{activities:s,dateGroups:o}};t.prototype._getViewableItemActivity=function(e){var t=this.props,r=t.currentUserEmail,i=t.containingItem,s=t.canOpenItem,o=t.onItemClick,u=t.isSingleLevel,f=t.onRenderUser,l=t.currentListTitle,h=t.currentRootTitle,p=t.defaultItemTitle,d=t.commentListItem,v=t.commentsOnly,m=t.isReadonly,g=t.canDeleteActivity,y=t.activityMenuFunctions,b=this.state,w=b.showComments,E=b.itemComments,S={currentUserEmail:r,containingItem:i,canOpenItem:s,onItemClick:o,isSingleLevel:u,activity:e,strings:c.default,onRenderUser:f,currentListTitle:l,currentRootTitle:h,defaultItemTitle:p,commentListItem:d,isReadonly:m,canDeleteActivity:g,activityMenuFunctions:y&&y[e.type]};if(!v||2===e.type)switch(e.type){case 0:return new a.EditItemActivity(S);case 1:return new a.MoveItemActivity(S);case 2:var x=void 0;if(w&&E){var T=this._getPopulatedCommentActivity(e);if(T&&T.isDeleted)return;x=n.__assign({},S,{activity:this._getPopulatedCommentActivity(e)})}return new a.CommentItemActivity(x||S);case 3:return new a.CommentResponseItemActivity(S);case 4:return new a.MentionItemActivity(S);case 5:return new a.VersionItemActivity(S);case 6:return new a.RestoreItemActivity(S);case 9:return new a.RenameItemActivity(S);case 10:return new a.DeleteItemActivity(S);case 11:return new a.CreateItemActivity(S);case 12:return new a.ShareItemActivity(S);default:return}};t.prototype._addStoreListener=function(e){var t=this;this._storeListener=this._store.addListener(function(){var n=t._store.getItemActivities({item:e.containingItem,currentUserEmail:e.currentUserEmail});t.setState({activities:n,isEndOfActivities:n.success&&!n.isPlaceholder&&!n.nextRequestToken})},{item:e.containingItem,currentUserEmail:e.currentUserEmail,environment:e.environment})};t.prototype._addCommentsStoreListener=function(e){var t=this,n=e.currentUserEmail,r=e.commentsOnly,i=e.commentListItem;this._commentsStoreListener=this._itemCommentsStore.addListener(function(n){var i=t._itemCommentsStore.getItemComments({itemWrapper:e.commentListItem,currentUserEmail:e.currentUserEmail,onError:t._onFetchCommentsError});t.setState({itemComments:i,itemCommentsQueried:!!i.comments,showAllCommentActivities:!i.isPlaceHolder&&i.missingComments,isEndOfActivities:r&&i.success&&!i.isPlaceHolder&&!i.nextLink});n&&t._announceCommentUpdate(n)},{commentItemWrapper:i,currentUserEmail:n})};t.prototype._addCommentSettingsListener=function(e){var t=this,n=e.onCommentSettingsChanged,r=e.currentUserEmail,i=e.commentListItem;this._commentSettingsListener=this._itemCommentsStore.addCommentSettingsListener(function(){var e=t._itemCommentsStore.getIsCommentsDisabled(i,r);if("boolean"==typeof e&&n){n(e);t._announceCommentUpdate(e?s.ItemCommentsChange.CommentsDisabled:s.ItemCommentsChange.CommentsEnabled)}},{commentItemWrapper:i,currentUserEmail:r})};t.prototype._addListeners=function(e){this._addStoreListener(e);if(e.commentListItem){this._addCommentsStoreListener(e);this._addCommentSettingsListener(e)}};t.prototype._removeCurrentListeners=function(){this._storeListener&&this._store.removeListener(this._storeListener);if(this._commentsStoreListener){this._itemCommentsStore.removeListener(this._commentsStoreListener);this._commentsStoreListener=void 0}if(this._commentSettingsListener){this._itemCommentsStore.removeCommentSettingsListener(this._commentSettingsListener);this._commentSettingsListener=void 0}};t.prototype._getPopulatedCommentActivity=function(e){var t=e.action&&e.action.comment;if(t&&t.commentId){var r=this._getCommentById(t.commentId);if(r){return n.__assign({},r,{time:e.time,friendlyDisplayTime:e.friendlyDisplayTime})}if(this.state.itemCommentsQueried&&!this.state.showAllCommentActivities)return n.__assign({},e,{isDeleted:!0})}return e};t.prototype._getCommentById=function(e){var t=this.state.itemComments,n=t&&t.comments;if(n)for(var r=0,i=n;r<i.length;r++){var s=i[r],o=s.action&&s.action.comment&&s.action.comment.commentDetail;if(o&&o.id===e)return s}};t.prototype._announceCommentUpdate=function(e){var t="";e===s.ItemCommentsChange.DeletedAll?t=l.default.deletedAllComments:e===s.ItemCommentsChange.DeletedSingle?t=l.default.deletedSingleComment:e===s.ItemCommentsChange.CommentsEnabled?t=l.default.commentsEnabled:e===s.ItemCommentsChange.CommentsDisabled&&(t=l.default.commentsDisabled);this.setState({feedUpdatedMessage:t})};t.contextTypes={itemActivityFeedStore:i.object.isRequired,itemCommentsStore:i.object.isRequired,engagementSource:i.string};return t}(r.Component);t.default=h});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/IItemCommentsStore",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.DeletedSingle=0]="DeletedSingle";e[e.DeletedAll=1]="DeletedAll";e[e.CommentsEnabled=2]="CommentsEnabled";e[e.CommentsDisabled=3]="CommentsDisabled"}(t.ItemCommentsChange||(t.ItemCommentsChange={}))});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivityList/ItemActivityList",["require","exports","tslib","react","@ms/odsp-utilities/lib/logging/events/Engagement.event","../ItemActivity/ItemActivity","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Spinner","office-ui-fabric-react/lib/FocusZone","office-ui-fabric-react/lib/components/GroupedList/index","office-ui-fabric-react/lib/Shimmer","../ItemActivity/MissingItemActivityWrapper","./ItemActivityList.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onRenderCell=function(e,n,i){var o=t.props,a=o.onRenderMissingActivity,f=o.enableShimmer,h=o.isDataReady;return n?!h&&f?r.createElement("div",{className:"od-ItemActivityList-activity"},r.createElement(l.Shimmer,{shimmerElements:[{type:1,height:48}]})):r.createElement(s.default,{key:n.getKey(),activity:n,isInGrid:!0}):a?r.createElement(c.default,{activityIndex:i,onGetMoreActivities:t._onRequestMissingItemActivity},r.createElement("div",{className:"od-ItemActivityList-activity od-ItemActivityList-missingActivity"},r.createElement(u.Spinner,{size:u.SpinnerSize.large}))):void 0};t._onRenderHeader=function(e){var t=e.group;return r.createElement("div",{className:"od-ItemActivityList-grouplistTitle"},t.name)};t._onRequestMissingItemActivity=function(e,n){var r=t.props.onRenderMissingActivity;n&&i.Engagement.logData({name:"ItemActivityFeed.scrolled",isIntentional:!0});r&&r(e,n)};return t}t.prototype.render=function(){var e=this.props,t=e.activities,n=e.groups;return r.createElement(a.FocusZone,{direction:a.FocusZoneDirection.vertical,isCircularNavigation:!1,isInnerZoneKeystroke:function(e){return e.which===o.getRTLSafeKeyCode(o.KeyCodes.right)}},r.createElement(f.GroupedList,{items:t,onRenderCell:this._onRenderCell,groupProps:{onRenderHeader:this._onRenderHeader},groups:n,onShouldVirtualize:function(){return!1}}))};return t}(r.Component);t.default=h});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivity/MissingItemActivityWrapper",["require","exports","tslib","@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/MissingItemActivityWrapper","@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/MissingItemActivityWrapper"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.default});
define("@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/MissingItemActivityWrapper",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","@ms/odsp-utilities/lib/async/Async"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=new s.default,u=function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onScrollEvent=function(e){var n=t.props,r=n.onGetMoreActivities,i=n.activityIndex;o.setTimeout(function(){t._isCurrentElementInView()&&r(i,!0)},100)};return t}t.prototype.componentDidMount=function(){var e=this.props,t=e.onGetMoreActivities,n=e.activityIndex;this._containingScrollablePane=this._findContainingScrollablePane();this._isCurrentElementInView()&&t(n);this._containingScrollablePane&&this._events.on(this._containingScrollablePane,"scroll",this._onScrollEvent,!0)};t.prototype.componentWillUnmount=function(){this._containingScrollablePane&&this._events.off(this._containingScrollablePane,"scroll",this._onScrollEvent,!0)};t.prototype.render=function(){var e=this;return r.createElement("div",{ref:function(t){return e._missingActivityElement=t}},r.Children.only(this.props.children))};t.prototype._findContainingScrollablePane=function(){return i.findScrollableParent(this._missingActivityElement)};t.prototype._isCurrentElementInView=function(){if(this._missingActivityElement&&this._containingScrollablePane){var e=this._missingActivityElement.getBoundingClientRect(),t=this._containingScrollablePane.getBoundingClientRect(),n=e.top,r=e.bottom,i=t.top,s=t.bottom;return n<=s&&n>=i||r>=i&&r<=s}return!1};return t}(i.BaseComponent);t.default=u});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivityList/ItemActivityList.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".od-ItemActivityList-activity-withCommentResponse{display:inline-block;margin-right:-40px;margin-bottom:0}.od-ItemActivityList-activity .ms-Shimmer-container{width:100%}.od-ItemActivityList-activity .od-ItemActivity-item-textContent{word-wrap:break-word}.od-ItemActivityList-activity .od-ItemActivity-item{max-width:90%}.od-ItemActivity-item-focusZone{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;max-width:100%}.od-ItemActivity-item-focusZone:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-ItemActivity-contextMenu{display:inline-block}.od-itemActivity-commentActivity-commentContent{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";word-wrap:break-word}.od-ItemActivityList-missingActivity{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.od-ItemActivityList-activity-commentResponse{padding:8px;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";margin-bottom:12px}.od-ItemActivityList-commentReply{padding:8px 8px 8px 24px}[dir='rtl'] .od-ItemActivityList-commentReply{padding:8px 24px 8px 8px}.od-ItemActivityList-commentReply .ms-ActivityItem-activityContent{width:182px}.od-ItemActivityList-loadMoreReplies{text-align:center;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-ItemActivityList-grouplistTitle{font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.isFluent .od-ItemActivityList-grouplistTitle{font-size:12px;font-weight:600}\n"}])});
define("@ms/odsp-shared-react/lib/components/AddCommentTextField/AddCommentTextField",["require","exports","tslib","@ms/shared-react-item-activity/lib/components/AddCommentTextField/AddCommentTextField","@ms/shared-react-item-activity/lib/components/AddCommentTextField/AddCommentTextField"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.default});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivityGroupByDateHelper",["require","exports","@ms/odsp-utilities/lib/locale/Locale","./ItemActivityFeed.resx"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s,o=864e5,u=7;!function(e){e.today="Today";e.yesterday="Yesterday";e.thisWeek="This week";e.lastWeek="Last week";e.twoWeeksAgo="Two weeks ago";e.threeWeeksAgo="Three weeks ago";e.thisMonth="This month";e.lastMonth="Last month";e.older="Older"}(s=t.RelativeDateGroups||(t.RelativeDateGroups={}));t.RelativeDateGroupStrings=((i={})[s.today]=r.default.today,i[s.yesterday]=r.default.yesterday,i[s.thisWeek]=r.default.thisWeek,i[s.lastWeek]=r.default.lastWeek,i[s.twoWeeksAgo]=r.default.twoWeeksAgo,i[s.threeWeeksAgo]=r.default.threeWeeksAgo,i[s.thisMonth]=r.default.thisMonth,i[s.lastMonth]=r.default.lastMonth,i);t.getActivityGroupByDate=function(e){var t=e.time,r=new Date;return t?function(e,t){return a(t,e)}(t,r)?s.today:function(e,t){return a(new Date(t.getTime()-o),e)}(t,r)?s.yesterday:function(e,t){var n=t.setHours(0,0,0,0)-t.getDay()*o;return e.getTime()>n}(t,r)?s.thisWeek:function(e,t){var n=t.setHours(0,0,0,0)-(t.getDay()+u)*o;return e.getTime()>n}(t,r)?s.lastWeek:function(e,t){var n=t.setHours(0,0,0,0)-2*u*o;return e.getTime()>n}(t,r)?s.twoWeeksAgo:function(e,t){var n=t.setHours(0,0,0,0)-3*u*o;return e.getTime()>n}(t,r)?s.threeWeeksAgo:function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()}(t,r)?s.thisMonth:function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1}(t,r)?s.lastMonth:function(e,t){return t.getFullYear()===e.getFullYear()}(t,r)?t.toLocaleString(n.default.language,{month:"long"}):function(e,t){return t.getFullYear()>e.getFullYear()}(t,r)?t.toLocaleString(n.default.language,{month:"long",year:"numeric"}):s.older:s.older};function a(e,t){return e.toDateString()===t.toDateString()}});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivityFeed.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".od-ItemActivityFeed-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}])});
define("odsp-next/controls/itemActivityFeed/ItemActivityFeedViewOption",["require","exports","tslib","react","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/Button","../../models/itemActivity/ItemActivityFeedHelper","office-ui-fabric-react/lib/common/DirectionalHint","./ItemActivityFeed.resx","../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props.item;return r.createElement(r.Fragment,null,this._isMenuVisible()?r.createElement(s.DefaultButton,{className:"od-ItemActivityFeed-viewOption",text:i.format(a.strings.itemActivityFeedViewOption,this._getCurrentViewOption()),menuProps:this._getViewMenuProps(e),ariaLabel:a.strings.itemActivityFeedViewOptionAriaLabel}):void 0)};t.prototype._isCommentsAvailable=function(e){var t=this.props.isCommentsInActivityFeedEnabled,n=void 0!==t&&t;return f.isFeatureEnabled(f.ActivityFeedRefactoring)?this.props.itemActivityFeedHelper.isNonOfficeFileCommentsAvailable(e)&&this._isCommentsDisabled(e):o.isNonOfficeFileCommentsAvailable(e,n)&&this._isCommentsDisabled(e)};t.prototype._isCommentsDisabled=function(e){return e.comments&&e.comments.settings&&!e.comments.settings.isCommentDisabled};t.prototype._getViewMenuProps=function(e){return{directionalHint:u.DirectionalHint.bottomAutoEdge,isBeakVisible:!1,gapSpace:0,shouldFocusOnMount:!0,items:this._getMenuItems()}};t.prototype._getMenuItems=function(){var e=this.props.onSelectMenuOption,t={key:"activityFeed.viewAll",name:a.strings.itemActivityFeedViewAll,onClick:function(t,n){e&&e(!1)}},n={key:"activityFeed.commentOnly",name:a.strings.itemActivityFeedCommentsOnly,onClick:function(t,n){e&&e(!0)}};return this.props.isCommentsOnlyView?[t]:[n]};t.prototype._isMenuVisible=function(){var e=this.props.item;return this._isCommentsAvailable(e)&&e.comments&&e.comments.settings&&!e.comments.settings.isCommentDisabled};t.prototype._getCurrentViewOption=function(){return this.props.isCommentsOnlyView?a.strings.itemActivityFeedCommentsOnly:a.strings.itemActivityFeedViewAll};return t}(r.Component);t.ItemActivityFeedViewOption=l});
define("odsp-next/models/itemActivity/ItemActivityFeedHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/icons/OfficeFileNameHelper","../../models/item/ItemType","../../dataSources/base/vroom/ItemResultProcessor","../../dataSources/item/ItemTaskObserver"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._actionMap=n.resources.consume(i.actionMap);n._itemTaskObserver=new(n.resources.consume(f.resourceKey));n._urlDataSource=n.resources.consume(s.url);return n}t.prototype.navigateToItem=function(e,t,r,i){var s=this;if(r){var o=t.driveItem;o.webUrl||(o=n.__assign({},o,{webUrl:r}));if(t.isFolder){i&&i("folder");this.navigateToFolder(o.webUrl)}else this._convertToOneDriveItem(e,o).then(function(e){i&&i(e.folder?"folder":e.extension||"file");s.navigateToOneDriveItem(e)})}};t.prototype.navigateToOneDriveItem=function(e){var t=this.createObservable(e);new(this.managed(this._actionMap.DefaultClickAction))({item:t}).execute(void 0)};t.prototype.navigateToFolder=function(e){new(this.managed(this._actionMap.NavigationAction))({url:e,forceNavigation:!0,target:"_blank"}).execute(void 0)};t.prototype.getGraphItemUrl=function(e,t){if(t)return e.id===this._urlDataSource.getDefaultRootItemId()?t.getDriveUrl(e,{useDirectEndpoint:!0}):t.getItemUrl(e,{useDirectEndpoint:!0})};t.prototype.getAccessToken=function(e,t){if(t)return t.getAccessToken(e)};t.prototype.updateItem=function(e,t){this._itemTaskObserver.update([new f.Task(e.key).succeed({item:n.__assign({key:e.key},t)})],!1);this._itemTaskObserver.flush()};t.prototype._convertToOneDriveItem=function(e,t){var n=this;return this.resources.consumeAsync(a.resourceKey).then(function(r){var i=r.processItem({itemFromServer:t,requestKey:e.key,observer:n._itemTaskObserver}).key;n._itemTaskObserver.flush();return n._itemTaskObserver.getItem({key:i})})};return t}(r.default);t.default=l;t.isNonOfficeFileCommentsAvailable=function(e,t){return t&&!function(e){var t=e.extension&&e.extension.replace(/^\./,"");e.appMap=t&&o.OfficeIconFileTypeMap[t];return e.appMap&&".pdf"!==e.extension}(e)&&(e.type===u.default.File||e.type===u.default.Media||e.type===u.default.Unknown||e.type===u.default.Shortcut)}});
define("odsp-next/providers/itemActivities/GroupedItemActivityFeedStore",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared-react/lib/components/ItemActivityFeed/GroupedItemActivityFeedStore","./ItemActivityFeedStore"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=n.createResolvedResourceKey(e("module").id,r.default,{itemActivityFeedStore:i.resourceKey})});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/GroupedItemActivityFeedStore",["require","exports","@ms/odsp-utilities/lib/icons/IconSelector","@ms/odsp-utilities/lib/icons/ItemType"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={"SharePoint App":!0,"System Account":!0},s=function(){function e(e,t){this._baseStore=t.itemActivityFeedStore;this._dictItemActivities={}}e.prototype.addListener=function(e,t){var n=this,r=this._getItemActivitiesDictionaryKey(t);this._dictItemActivities[r]=this._transformItemActivities(t,this._baseStore.getItemActivities(t));return this._baseStore.addListener(function(){n._dictItemActivities[r]=n._transformItemActivities(t,n._baseStore.getItemActivities(t));e()},t)};e.prototype.fetchItemActivities=function(e){this._baseStore.fetchItemActivities(e)};e.prototype.getItemActivities=function(e){var t=this._getItemActivitiesDictionaryKey(e);return this._dictItemActivities[t]?this._dictItemActivities[t]:this._baseStore.getItemActivities(e)};e.prototype.removeListener=function(e){this._baseStore.removeListener(e)};e.prototype._getItemActivitiesDictionaryKey=function(e){var t=e.item.graphItemUrl;e.currentUserEmail&&(t+="_"+e.currentUserEmail);return t};e.prototype._areNewActivitiesFetched=function(e,t){var n=this._getItemActivitiesDictionaryKey(e);return!this._dictItemActivities[n]||this._dictItemActivities[n].activities.length!==t.length};e.prototype._transformItemActivities=function(e,t){var n=[];if(t.activities.length>0)for(var r={},i=0;i<t.activities.length;i++){var s=t.activities[i];if(!this._shouldHideActivity(s,e.currentUserEmail)){var o=t.activities[i-1],u=this._getCacheItemKey(s),a=s.actors[0];o&&this._isMergableMoveActivity(o,s)?this._handleMergableMoveActivity(o,s,n):u&&a?this._handleGroupableActivity(r,u,s,n):n.push(s)}}!this._areNewActivitiesFetched(e,n)&&t.nextRequestToken&&this.fetchItemActivities(e);return{isPlaceholder:t.isPlaceholder,activities:n,nextRequestToken:t.nextRequestToken,success:t.success}};e.prototype._handleMergableMoveActivity=function(e,t,n){n[n.length-1]={id:e.id,type:e.type,actors:e.actors,item:e.item,parentItem:e.parentItem,time:e.time,friendlyDisplayTime:e.friendlyDisplayTime,action:{move:{from:e&&e.action&&e.action.move&&e.action.move.from,to:t&&t.action&&t.action.move&&t.action.move.to}}}};e.prototype._handleGroupableActivity=function(e,t,n,r){var i=n.actors[0],s=this._getActorKey(i),o=e[t],u=o&&this._shouldResetGroupingItem(o,n);if(!o||u){var a={};a[s]=i;e[t]={activity:n,lastActivityTime:n.time,actors:a,groupedIndex:r.length};r.push(n)}else if(!o.actors[s]){o.actors[s]=i;if(1===o.activity.actors.length){var f=o.activity,l={id:f.id,type:f.type,actors:[f.actors[0]],item:f.item,parentItem:f.parentItem,time:f.time,action:f.action,friendlyDisplayTime:f.friendlyDisplayTime};o.activity=l;r[o.groupedIndex]=l}o.activity.actors.push(i)}};e.prototype._shouldResetGroupingItem=function(e,t){return e.lastActivityTime.getTime()-18e5>t.time.getTime()};e.prototype._getCacheItemKey=function(e){if(3===e.type||0===e.type){var t=void 0;e.item.driveItem&&e.item.driveItem.id?t=e.type.toString()+"_"+e.item.driveItem.id:e.item.graphItemUrl&&(t=e.type.toString()+"_"+e.item.graphItemUrl);var n=e.action.commentResponse;t&&n&&n.commentAuthor&&(t+="_"+n.commentAuthor.email);return t}};e.prototype._shouldHideActivity=function(e,t){var i=!1,s=e.item&&e.item.name&&e.item.name.toLowerCase();if(s){var o=s.lastIndexOf(".");if(-1!==o){var u=s.substring(o+1);r.default.File;n.getItemTypeFromExtension(u)===r.default.OneNote&&(i=!0)}}return i||this._isSystemAccount(e)||5===e.type||!e.item};e.prototype._isSystemAccount=function(e){var t=e.actors.length>0&&e.actors[0];return t&&i[t.displayName]};e.prototype._isMergableMoveActivity=function(e,t){return 1===e.type&&1===t.type&&!!e.action.move.from&&!e.action.move.to&&!t.action.move.from&&!!t.action.move.to&&e.item&&t.item&&e.item.name===t.item.name};e.prototype._getActorKey=function(e){return e.email||"@@noemail@@_"+e.displayName};return e}();t.default=s});
define("odsp-next/providers/itemActivities/ItemActivityFeedStore",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivityFeedStore","../../dataSources/itemActivities/index"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=n.createResolvedResourceKey(e("module").id,r.default,{itemActivitiesService:i.itemActivitiesServiceKey})});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivityFeedStore",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-utilities/lib/async/PromiseDeduplicator"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){this._itemActivitiesService=t.itemActivitiesService;this._lastListenerId=-1;this._dictListener={};this._dictItemActivities={};this._promiseDeduplicator=new i.default}e.prototype.addListener=function(e,t){var n=this._getItemActivitiesDictionaryKey(t);this._lastListenerId++;this._dictListener[n]||(this._dictListener[n]={});this._dictListener[n][this._lastListenerId]=e;return{key:this._lastListenerId,itemKey:n}};e.prototype.fetchItemActivities=function(e){var t=this,r=this._getItemActivitiesDictionaryKey(e),i=this._dictItemActivities[r];if(!i||0===e.startIndex){var s=0;i&&0===i.startIndex&&(s=i.noOfUnsuccessfulRequests);i={activities:{isPlaceholder:!0,activities:[],success:!0},noOfUnsuccessfulRequests:s,startIndex:0}}var o=i.activities;if(o.nextRequestToken||e.item.graphItemUrl){var u=(o.nextRequestToken||e.item.graphItemUrl)+"_"+(e.startIndex||0),a={};"consumer"===e.environment&&(a.Prefer="Get-Self,Force-VaultItems-Filter");this._promiseDeduplicator.deduplicate(u,function(){var s={item:e.item,nextRequestToken:o.nextRequestToken,qosPrefix:e.qosPrefix,headers:a};return t._itemActivitiesService.getItemActivities(s).then(function(n){if(n&&n.success||i.noOfUnsuccessfulRequests+1>=2){t._dictItemActivities[r]={activities:t._mergeItemActivities(o,n,e.isScrollEvent),noOfUnsuccessfulRequests:0,startIndex:e.startIndex};t._emitChange(e)}else{t._dictItemActivities[r]={activities:o,noOfUnsuccessfulRequests:i.noOfUnsuccessfulRequests+1,startIndex:i.startIndex};t.fetchItemActivities(e)}},function(e){return n.default.reject(e)})})}};e.prototype.getItemActivities=function(e){var t=this._getItemActivitiesDictionaryKey(e);return this._dictItemActivities[t]?this._dictItemActivities[t].activities:{isPlaceholder:!0,activities:[],success:!0}};e.prototype.removeListener=function(e){if(!this._dictListener[e.itemKey]||!this._dictListener[e.itemKey][e.key])throw"Listener with key "+e.key+" for item "+e.itemKey+" not found";delete this._dictListener[e.itemKey][e.key]};e.prototype._emitChange=function(e){var t=this._getItemActivitiesDictionaryKey(e),n=this._dictListener[t];if(n)for(var r=0,i=Object.getOwnPropertyNames(n);r<i.length;r++){(0,n[i[r]])()}};e.prototype._getItemActivitiesDictionaryKey=function(e){var t=e.item.graphItemUrl;e.currentUserEmail&&(t+="_"+e.currentUserEmail);return t};e.prototype._mergeItemActivities=function(e,t,n){this._logActivitiesTelemetry(t.activities,n);var r=(e.activities||[]).concat(t.activities||[]);return{isPlaceholder:!e&&!t||e.isPlaceholder&&t.isPlaceholder,activities:r,nextRequestToken:t.nextRequestToken||!t&&e.nextRequestToken,success:e.success&&t&&t.success}};e.prototype._logActivitiesTelemetry=function(e,t){r.Engagement.logData({name:"ActivityFeed.activitiesFetched",isIntentional:!0,extraData:{isScrollEvent:!!t,noOfActivities:e.length}})};return e}();t.default=s});
define("odsp-next/providers/itemActivities/ItemCommentsStore",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemCommentsStore","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=n.createResolvedResourceKey(e("module").id,r.default,{itemCommentsDataSource:i.itemCommentDataSource.optional})});
define("@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemCommentsStore",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","./IItemCommentsStore","@ms/odsp-utilities/lib/async/PromiseDeduplicator"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this._itemCommentsDataSource=t.itemCommentsDataSource;this._lastListenerId=-1;this._lastRepliesListenerId=-1;this._dictListener={};this._dictRepliesListener={};this._dictItemComments={};this._dictItemCommentReplies={};this._dictItemCommentIsDiabled={};this._dictItemCommentSettingsListener={};this._promiseDeduplicator=new s.default}e.prototype.addListener=function(e,t){this._lastListenerId++;var n=t.commentItemWrapper,r={item:n&&n.activityItemWrapper,currentUserEmail:t.currentUserEmail},i=this._getItemActivitiesDictionaryKey(r);this._dictListener[i]||(this._dictListener[i]={});this._dictListener[i][this._lastListenerId]=e;this._dictItemCommentIsDiabled[i]=n&&n.item.comments&&n.item.comments.settings&&n.item.comments.settings.isCommentDisabled;return{key:this._lastListenerId,itemKey:i}};e.prototype.removeListener=function(e){this._dictListener[e.itemKey]&&this._dictListener[e.itemKey][e.key]?delete this._dictListener[e.itemKey][e.key]:new Error("Listener with key "+e.key+" for item "+e.itemKey+" not found")};e.prototype.fetchItemComments=function(e){var t=this,n={item:e.itemWrapper.activityItemWrapper,currentUserEmail:e.currentUserEmail},i=this._getItemActivitiesDictionaryKey(n),s=this._dictItemComments[i];(!s||0===e.startIndex)&&(s={itemComments:{nextLink:"",comments:[],success:!0},noOfUnsuccessfulRequests:0});var o=s.itemComments;if(o.nextLink||e.itemWrapper.item&&0===e.startIndex){var u=this._dictItemComments[i]&&this._dictItemComments[i].noOfUnsuccessfulRequests||0,a=(o.nextLink||e.itemWrapper.item.id)+"_"+u;this._promiseDeduplicator.deduplicate(a,function(){var a={itemWrapper:e.itemWrapper,nextLink:o.nextLink,currentUserEmail:e.currentUserEmail};return t._itemCommentsDataSource.getComments(a).then(function(r){if(r&&r.success||s.noOfUnsuccessfulRequests>3){var a=t._updatedComments(o,r);t._dictItemComments[i]={itemComments:a,noOfUnsuccessfulRequests:0};for(var f=0,l=a.comments;f<l.length;f++){var c=l[f],h=c.action&&c.action.comment&&c.action.comment.commentDetail,p=t._getItemCommentRepliesDictionaryKey(n,h.id);t._dictItemCommentReplies[p]={itemComments:h.replies,noOfUnsuccessfulRequests:0}}t._emitChange(n)}else if(u>=3)e.onError&&e.onError();else{t._dictItemComments[i]={itemComments:o,noOfUnsuccessfulRequests:u+1};t.fetchItemComments(e)}},function(t){e.onError&&e.onError();return r.default.reject(t)})})}};e.prototype.addRepliesListener=function(e,t,n){this._lastRepliesListenerId++;var r=this._getItemCommentRepliesDictionaryKey(t,n);this._dictRepliesListener[r]||(this._dictRepliesListener[r]={});this._dictRepliesListener[r][this._lastRepliesListenerId]=e;return{key:this._lastRepliesListenerId,itemKey:r}};e.prototype.removeRepliesListener=function(e){this._dictRepliesListener[e.itemKey]&&this._dictRepliesListener[e.itemKey][e.key]?delete this._dictRepliesListener[e.itemKey][e.key]:new Error("Listener with key "+e.key+" for item "+e.itemKey+" not found")};e.prototype.getItemComments=function(e){var t={item:e.itemWrapper.activityItemWrapper,currentUserEmail:e.currentUserEmail},r=this._getItemActivitiesDictionaryKey(t),i=this._dictItemComments[r];if(i)return i.noOfUnsuccessfulRequests>3?n.__assign({},i.itemComments,{missingComments:!0}):i.itemComments;this.fetchItemComments(n.__assign({},e,{startIndex:i?e.startIndex:0}));return{isPlaceHolder:!0,comments:void 0,success:!0}};e.prototype.addComment=function(e,t){return this._itemCommentsDataSource.addComment(e,t)};e.prototype.addItemCommentReply=function(e,t,n){return this._itemCommentsDataSource.addReply(e.itemWrapper,t,n)};e.prototype.getItemCommentReplies=function(e,t){var r={item:e.itemWrapper.activityItemWrapper,currentUserEmail:e.currentUserEmail},i=this._getItemCommentRepliesDictionaryKey(r,t),s=this._dictItemCommentReplies[i];if(s)return s.itemComments;this.fetchItemCommentReplies(n.__assign({},e,{startIndex:0}),t);return{isPlaceHolder:!0,comments:void 0,success:!0}};e.prototype.addCommentSettingsListener=function(e,t){var n=t.commentItemWrapper,r={item:n&&n.activityItemWrapper,currentUserEmail:t.currentUserEmail},i=this._getItemActivitiesDictionaryKey(r);this._dictItemCommentSettingsListener[i]=e;this._dictItemCommentIsDiabled[i]=n&&n.item.comments&&n.item.comments.settings&&n.item.comments.settings.isCommentDisabled;return{key:1,itemKey:i}};e.prototype.removeCommentSettingsListener=function(e){this._dictItemCommentSettingsListener[e.itemKey]&&this._dictItemCommentSettingsListener[e.itemKey][e.key]?delete this._dictItemCommentSettingsListener[e.itemKey][e.key]:new Error("Listener with key "+e.key+" for item "+e.itemKey+" not found")};e.prototype.fetchIsCommentsDisabled=function(e){return this._itemCommentsDataSource.getIsCommentsDisabled(e)};e.prototype.getIsCommentsDisabled=function(e,t){var n={item:e.activityItemWrapper,currentUserEmail:t},r=this._getItemActivitiesDictionaryKey(n);return this._dictItemCommentIsDiabled[r]};e.prototype.setCommentsDisabled=function(e,t,n){var r=this;return this._itemCommentsDataSource.setCommentsDisabled(e,t).then(function(i){var s={item:e.activityItemWrapper,currentUserEmail:n},o=r._getItemActivitiesDictionaryKey(s);r._dictItemCommentIsDiabled[o]=t;r._emitCommentsSettingChange(s);return i})};e.prototype.deleteCommentById=function(e,t,s){var o=this;return this._itemCommentsDataSource.deleteCommentById(e,t).then(function(){var u={item:e.activityItemWrapper,currentUserEmail:s},a=o._getItemActivitiesDictionaryKey(u),f=o._dictItemComments[a],l=f&&f.itemComments&&f.itemComments.comments;if(l){var c=l.filter(function(e){return(e&&e.action&&e.action.comment&&e.action.comment.commentId)!==t});o._dictItemComments[a]=n.__assign({},f,{itemComments:n.__assign({},f.itemComments,{comments:c})});o._emitChange(u,i.ItemCommentsChange.DeletedSingle)}return r.default.resolve(!0)},function(e){return r.default.reject(e)})};e.prototype.deleteAllComments=function(e,t){var n=this;return this._itemCommentsDataSource.deleteAllComments(e).then(function(){var s={item:e.activityItemWrapper,currentUserEmail:t},o=n._getItemActivitiesDictionaryKey(s);n._dictItemComments[o]=void 0;n._emitChange(s,i.ItemCommentsChange.DeletedAll);return r.default.resolve(!0)},function(e){return r.default.reject(e)})};e.prototype.fetchItemCommentReplies=function(e,t){var n=this,i={item:e.itemWrapper.activityItemWrapper,currentUserEmail:e.currentUserEmail},s=this._getItemCommentRepliesDictionaryKey(i,t),o=this._dictItemCommentReplies[s];(!o||0===e.startIndex)&&(o={itemComments:{nextLink:"",comments:[],success:!0},noOfUnsuccessfulRequests:0});var u=o.itemComments;if(u.nextLink||e.itemWrapper.item&&0===e.startIndex){var a=(u.nextLink||e.itemWrapper.item.id)+"_"+o.noOfUnsuccessfulRequests;this._promiseDeduplicator.deduplicate(a,function(){var a={itemWrapper:e.itemWrapper,nextLink:u.nextLink,currentUserEmail:e.currentUserEmail};return n._itemCommentsDataSource.getReplies(a,t).then(function(r){var a=n._dictItemCommentReplies[s]&&n._dictItemCommentReplies[s].noOfUnsuccessfulRequests||0;if(r&&r.success||a>3){n._dictItemCommentReplies[s]={itemComments:n._updatedCommentWithReplies(u,r),noOfUnsuccessfulRequests:a};n._emitChangeForReplies(i,t)}else{n._dictItemComments[s]={itemComments:u,noOfUnsuccessfulRequests:o.noOfUnsuccessfulRequests+1};n.fetchItemCommentReplies(e,t)}},function(e){return r.default.reject(e)})})}};e.prototype._emitChange=function(e,t){var n=this._getItemActivitiesDictionaryKey(e),r=this._dictListener[n];if(r)for(var i=0,s=Object.getOwnPropertyNames(r);i<s.length;i++){(0,r[s[i]])(t)}};e.prototype._emitChangeForReplies=function(e,t){var n=this._getItemCommentRepliesDictionaryKey(e,t),r=this._dictRepliesListener[n];if(r)for(var i=0,s=Object.getOwnPropertyNames(r);i<s.length;i++){(0,r[s[i]])()}};e.prototype._emitCommentsSettingChange=function(e){var t=this._getItemActivitiesDictionaryKey(e),n=this._dictItemCommentSettingsListener[t];n&&n()};e.prototype._getItemActivitiesDictionaryKey=function(e){var t=e.item&&e.item.graphItemUrl;e.currentUserEmail&&(t+="_"+e.currentUserEmail);return t};e.prototype._getItemCommentRepliesDictionaryKey=function(e,t){var n=e.item&&e.item.graphItemUrl;e.currentUserEmail&&t&&(n+="_"+e.currentUserEmail+"_"+t);return n};e.prototype._updatedComments=function(e,t){return{comments:(e&&e.comments||[]).concat(t.comments),nextLink:t.nextLink,success:!0}};e.prototype._updatedCommentWithReplies=function(e,t){var n=e&&e.comments||[];return{comments:t.comments.concat(n),nextLink:t.nextLink,success:!0}};return e}();t.default=o});
define("@ms/odsp-shared-react/lib/components/LivePersonaCardAdapter/LivePersonaCardAdapter",["require","exports","tslib","react","@msfast/lpc-bootstrapper/dist/odsp/livepersonacardbootstrapper","@ms/odsp-datasources/lib/Loki","office-ui-fabric-react/lib/Persona","office-ui-fabric-react/lib/Utilities","@ms/odsp-utilities/lib/features/FeatureOverrides","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-utilities/lib/killswitch/Killswitch","./LivePersonaCardAdapter.scss"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(n,r){var i=e.call(this,n,r)||this;i.makeAdapterConfig=function(){var e=i.props.lpcCallbacks||{};i.props.addGroupMembersCallback&&(e.addGroupMembers=i.props.addGroupMembersCallback);return{pageContext:i.props.pageContext,actionCallBacks:e,dataCallBacks:i.props.lpcCallbacks}};i.state={isReady:!1};t.ensureInitializeLPC(i.makeAdapterConfig()).then(function(){i.setState({isReady:!0})});return i}t.prototype.render=function(){var e=this,i=!!this.props.displayName&&!l.Killswitch.isActivated("315A3D77-51F5-41EF-9F50-7EFADADDA002","08/06/2019","Stop sending DisplayName and CoinColor to LPC");if(l.Killswitch.isActivated("E9230875-BB07-4378-88CD-853B40406413","04/30/2019","Stop using LivePersonaCardHoverTargetV2")||!t.LivePersonaCardHoverTargetV2||this.props.lpcHoverTargetProps){if(t.LivePersonaCardHoverTarget){s=n.__assign({upn:this.props.email,hostAppPersonaInfo:{PersonaType:this.props.personaType,LocationId:this.props.locationId},externalAppSessionCorrelationId:this.props.pageContext.CorrelationId},this.props.tabIndex&&{tabIndex:this.props.tabIndex},this.props.ariaLabel&&{ariaLabel:this.props.ariaLabel},this.props.lpcHoverTargetProps,{onCardOpen:function(){e.props.loggingData&&f.Engagement.logData(e.props.loggingData);e.props.lpcHoverTargetProps&&e.props.lpcHoverTargetProps.onCardOpen&&e.props.lpcHoverTargetProps.onCardOpen()}});return r.createElement(t.LivePersonaCardHoverTarget,n.__assign({},s),this.props.children)}return r.createElement("div",{className:"sp-livePersonaCardAdapter-root"},this.props.children)}var s=n.__assign({},this.props.tabIndex&&{tabIndex:this.props.tabIndex},{cardParameters:n.__assign({personaInfo:{identifiers:{Smtp:this.props.email,Upn:this.props.upn||("User"===this.props.personaType?this.props.email:void 0),PersonaType:this.props.personaType,LocationId:this.props.locationId},displayName:i?this.props.displayName:void 0,personaCoinColor:i?o.getPersonaInitialsColor({text:this.props.displayName}):void 0},behavior:n.__assign({},this.props.lpcCardBehavior,{onCardOpen:function(){e.props.loggingData&&f.Engagement.logData(e.props.loggingData);e.props.lpcCardBehavior&&e.props.lpcCardBehavior.onCardOpen&&e.props.lpcCardBehavior.onCardOpen()}}),externalAppSessionCorrelationId:this.props.pageContext.CorrelationId},this.props.ariaLabel&&{ariaLabel:this.props.ariaLabel})},this.props.lpcHoverTargetV2Props);return r.createElement(t.LivePersonaCardHoverTargetV2,n.__assign({},s),this.props.children)};t.ensureInitializeLPC=function(e){if(!e.pageContext.isSPO)return Promise.reject("LPC is not supported on-prem.");if(e.pageContext.isExternalGuestUser||e.pageContext.isAnonymousGuestUser)return Promise.reject("LPC is not enabled for guest users.");if(!a.default.isFeatureEnabled({ODB:809,ODC:null,Fallback:!1}))return Promise.reject("The global LPC flight is off for this configuration.");if(window.LPC&&window.LPC.getRenderer){t.LivePersonaCardHoverTarget=window.LivePersonaCardHoverTarget;t.LivePersonaCardHoverTargetV2=window.LivePersonaCardHoverTargetV2;e.callback&&e.callback();return Promise.resolve()}var n=new s.Loki(e.pageContext),r="Prod";if(e.pageContext){s.isBlackforestEnvironment(e.pageContext)&&(r="Blackforest");s.isGccModerateEnvironment(e.pageContext)&&(r="GccModerate")}var o=a.default.isFeatureEnabled({ODB:1510,ODC:null,Fallback:!1})?n.getAadAuthTokenGetter():n.getAuthTokenGetter(e.clientType),u={culture:e.pageContext.currentUICultureName,region:n.getRegion(),clientType:e.clientType||"ODSP",clientContextType:"Generic",clientCorrelationId:e.pageContext.CorrelationId,logMessage:t._logResult,getAuthToken:o,actionCallbacks:e.actionCallBacks,dataCallbacks:e.dataCallBacks,complianceEnvironment:r};return i.initializeLivePersonaCardAsync(u).then(function(){t.LivePersonaCardHoverTarget=window.LivePersonaCardHoverTarget;t.LivePersonaCardHoverTargetV2=window.LivePersonaCardHoverTargetV2;e.callback&&e.callback();e.onSuccess&&e.onSuccess()}).catch(function(t){0;e.onFailure&&e.onFailure(t)})};t.LivePersonaCardHoverTarget=void 0;t.LivePersonaCardHoverTargetV2=void 0;t._logResult=function(e,t,n){0};return t}(u.BaseComponent);t.LivePersonaCardAdapter=c});
define("@msfast/lpc-bootstrapper/dist/odsp/livepersonacardbootstrapper",[],function(){return function(e){function t(t){for(var n,i,s=t[0],o=t[1],u=0,f=[];u<s.length;u++)i=s[u],r[i]&&f.push(r[i][0]),r[i]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(a&&a(t);f.length;)f.shift()()}var n={},r={0:0};function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.e=function(e){var t=[],n=r[e];if(0!==n)if(n)t.push(n[2]);else{var s=new Promise(function(t,i){n=r[e]=[t,i]});t.push(n[2]=s);var o,u=document.getElementsByTagName("head")[0],a=document.createElement("script");a.charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.src=function(e){return i.p+""+({1:"vendors~aria-webjs-sdk"}[e]||e)+"_"+{1:"719a99c981d8afec1ebf"}[e]+".js"}(e),o=function(t){a.onerror=a.onload=null,clearTimeout(f);var n=r[e];if(0!==n){if(n){var i=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src,o=new Error("Loading chunk "+e+" failed.\n("+i+": "+s+")");o.type=i,o.request=s,n[1](o)}r[e]=void 0}};var f=setTimeout(function(){o({type:"timeout",target:a})},12e4);a.onerror=a.onload=o,u.appendChild(a)}return Promise.all(t)},i.m=e,i.c=n,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="https://lpcres.delve.office.com/lpc/versionless/",i.oe=function(e){throw console.error(e),e};var s=window.webpackJsonp_msfast_lpc_bootstrapper_dist_odsp_livepersonacardbootstrapper=window.webpackJsonp_msfast_lpc_bootstrapper_dist_odsp_livepersonacardbootstrapper||[],o=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var a=o;return i(i.s=0)}([function(e,t,n){"use strict";n.r(t);var r,i=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,u)}a((r=r.apply(e,t||[])).next())})},s=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},o=function(){function e(e){this.bootstrapperConfig=e,this.loggers=new Map}return e.getOrCreate=function(t){return r||(r=new e(t)),r},e.prototype.logEventAsync=function(e,t){return i(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this.getLoggerAsync(t)];case 1:return n.sent().logEvent(e),[4,this.getLogManagerAsync()];case 2:return n.sent().flush(this.noOp),[3,4];case 3:return n.sent(),console.log("Live Persona Card ERROR: Failed to log an event to Aria"),[3,4];case 4:return[2]}})})},e.prototype.updateContextWithLokiDataAsync=function(e,t){return i(this,void 0,void 0,function(){var n;return s(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.getLoggerAsync(t)];case 1:return(n=r.sent()).setContext("LokiUrl",e.LokiUrl),n.setContext("tenantAadObjectId",e.TenantAadObjectId),n.setContext("userAadObjectId",e.UserAadObjectId),n.setContext("userPuid",e.UserPuid),[3,3];case 2:throw r.sent(),new Error("Live Persona Card ERROR: Failed to update Aria's context");case 3:return[2]}})})},e.prototype.getLoggerAsync=function(e){return i(this,void 0,void 0,function(){var t,n,r;return s(this,function(i){switch(i.label){case 0:return(t=this.loggers.get(e))?[3,4]:[4,this.getLogManagerAsync()];case 1:return n=i.sent(),r=void 0,"Blackforest"!==this.bootstrapperConfig.complianceEnvironment?[3,3]:[4,this.getCollectorUrlGermanyAsync()];case 2:r=i.sent(),i.label=3;case 3:(t=n.initialize(e,{collectorUri:r}))||(t=n.getLogger(e)),this.loggers.set(e,t),t.setContext("culture",this.bootstrapperConfig.culture),t.setContext("region",this.bootstrapperConfig.region),t.setContext("clientType",this.bootstrapperConfig.clientType),t.setContext("clientContextType",this.bootstrapperConfig.clientContextType),t.setContext("clientCorrelationId",this.bootstrapperConfig.clientCorrelationId),t.setContext("bootstrapperVersion","1.20181212.5.0"),i.label=4;case 4:return[2,t]}})})},e.prototype.getLogManagerAsync=function(){return i(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,n.e(1).then(n.t.bind(null,30,7))];case 1:return[2,e.sent().AWTLogManager]}})})},e.prototype.getCollectorUrlGermanyAsync=function(){return i(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,n.e(1).then(n.t.bind(null,30,7))];case 1:return[2,e.sent().AWT_COLLECTOR_URL_GERMANY]}})})},e.prototype.noOp=function(){},e}(),u=function(e,t,n,r,i){this.name=e,this.message=t,this.rootCorrelationId=n,this.statusCode=r,this.numberOfRetries=i};function a(e,t){try{sessionStorage&&sessionStorage.setItem&&sessionStorage.setItem(e,t)}catch(e){}}var f="LokiAuthToken";function l(e,t){return new Promise(function(n,r){e?(a(f,e),n(e)):t(function(e,t){e?(a(f,e),n(e)):r(new u("GetAuthTokenError","Auth token is undefined",t))},function(e,t){r(new u("GetAuthTokenError",e,t))})})}var c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";function h(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.search);return null===t?"":window.decodeURIComponent(t[1].replace(/\+/g," "))}var p=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,u)}a((r=r.apply(e,t||[])).next())})},d=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},v="https://{0}.loki.delve.office.com/api/v1/configuration/{1}/{2}",m="https://loki.delve.office.de/api/v1/configuration/{0}/{1}",g="https://loki.delve-gcc.office.com/api/v1/configuration/{0}/{1}",y="https://loki.delve.office.com/api/v1/configuration/{0}/{1}",b=6e4,w="LivePersonaCardVersionOverride",E="LivePersonaCardCultureOverride",S="MidgardBranch",x=2,T=0;function N(e,t){return p(this,void 0,void 0,function(){var n,r;return d(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,8]),[4,function(e,t){return new Promise(function(n,r){var i=new XMLHttpRequest,s=function(e){var t=h(E)||e.culture;return"ppe"===e.region||"df"===e.region||"msit"===e.region?v.replace("{0}",e.region).replace("{1}",e.clientType).replace("{2}",t):"Blackforest"===e.complianceEnvironment?m.replace("{0}",e.clientType).replace("{1}",t):"GccModerate"===e.complianceEnvironment?g.replace("{0}",e.clientType).replace("{1}",t):y.replace("{0}",e.clientType).replace("{1}",t)}(t);i.open("GET",s,!0),i.setRequestHeader("authToken",e),i.setRequestHeader("Accept","application/json");var o=c.replace(/[xy]/g,function(e){var t;if(window.crypto){var n=new Uint8Array(1);window.crypto.getRandomValues(n),t=n[0]}else t=Math.floor(16*Math.random());return("x"===e?t%16:t%4+8).toString(16)});i.setRequestHeader("X-RootCorrelationId",o),i.setRequestHeader("X-CorrelationId",o),i.setRequestHeader("X-ClientCorrelationId",t.clientCorrelationId),i.setRequestHeader("X-ClientType",t.clientType);var a=h(w);a&&i.setRequestHeader(w,a);var f=h(S);f&&i.setRequestHeader(S,f),i.addEventListener("load",function(){if(200===i.status)try{var e=JSON.parse(i.response);e.RootCorrelationId=o,e.LokiVersion=i.getResponseHeader("x-serverversion")||"",n(e)}catch(e){r(new u("GetLokiConfigError","Failed to parse initialization config.",o))}else r(new u("GetLokiConfigError","Couldn't retrieve initialization config. Status code is "+i.status,o,i.status))}),i.addEventListener("error",function(){r(new u("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",o))}),i.addEventListener("timeout",function(){r(new u("GetLokiConfigError","Loki config request timed out after "+b+" ms.",o))}),i.timeout=b,i.send()})}(e,t)];case 1:return n=i.sent(),[3,8];case 2:return(r=i.sent()).statusCode&&401===r.statusCode?[4,l(void 0,t.getAuthToken)]:[3,4];case 3:e=i.sent(),i.label=4;case 4:return T<x?(T++,[4,N(e,t)]):[3,6];case 5:return n=i.sent(),[3,7];case 6:throw r.numberOfRetries=T,r;case 7:return[3,8];case 8:return[2,n]}})})}var C=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,u)}a((r=r.apply(e,t||[])).next())})},k=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},L=2,A=0;function O(e){return C(this,void 0,void 0,function(){var t;return k(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,6]),[4,function(e){return new Promise(function(t,n){var r=document.createElement("script");r.type="text/javascript",r.crossOrigin="anonymous",r.src=e,r.addEventListener("load",function(){t()}),r.addEventListener("error",function(){n(new u("LoadScriptError","Unexpected error while loading script on page."))}),document.body.appendChild(r)})}(e)];case 1:return n.sent(),[3,6];case 2:return t=n.sent(),A<L?(A++,[4,O(e)]):[3,4];case 3:return n.sent(),[3,5];case 4:throw t.numberOfRetries=A,t;case 5:return[3,6];case 6:return[2]}})})}var M="livepersonacard_full",_="livepersonacard_global",D="livepersonacardstrings",P="officefeed_feed",H="officefeedstrings";function B(e,t){return new Promise(function(n,r){setTimeout(function(){try{window.LPC||r(new u("StartLivePersonaCardError","window.LPC is undefined.")),window.LivePersonaCardStrings&&window.LivePersonaCardStrings.strings||r(new u("StartLivePersonaCardError","window.LivePersonaCardStrings is undefined."));var i=function(e,t){return{refreshAuthToken:function(e){return function(t){e.getAuthToken(function(e,n){t(e,"",n)},function(e,n){t("",e,n)})}}(t),logToExternalApplication:t.logMessage,contextType:t.clientContextType,strings:window.LivePersonaCardStrings.strings,source:t.clientType,consumerCorrelationId:t.clientCorrelationId,activeFlights:e.Flights,isDebug:!1,culture:t.culture,dataCallbacks:t.dataCallbacks,actionCallbacks:t.actionCallbacks,dataUpdateBroadcaster:t.dataUpdateBroadcaster,privateDataCallbacks:t.privateDataCallbacks,options:t.options?t.options:{isLinkedInIntegrationEnabled:!1,hideDocumentFilter:!1},lokiUrl:e.LokiUrl,lokiVersion:e.LokiVersion,tenantAadObjectId:e.TenantAadObjectId,userAadObjectId:e.UserAadObjectId,userPuid:e.UserPuid,ecsConfigIds:e.EcsConfigIds,ecsETag:e.EcsEtag,loggedInUserUpn:e.UserUpn,complianceEnvironment:t.complianceEnvironment}}(e,t);window.LPC.start(i),n()}catch(e){r(new u("StartLivePersonaCardError",e.name+" "+e.message))}},0)})}var j,F=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,u)}a((r=r.apply(e,t||[])).next())})},I=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}};function q(e,t){return F(this,void 0,void 0,function(){var n;return I(this,function(r){switch(r.label){case 0:return[4,(0,new Promise(function(e){return window.setTimeout(e,0)}))];case 1:r.sent();try{if(!window.OfficeFeed)throw new u("StartOfficeFeedError","window.OfficeFeed is undefined.");if(!window.OfficeFeedStrings||!window.OfficeFeedStrings.strings)throw new u("StartOfficeFeedError","window.OfficeFeedStrings is undefined.");return n=function(e,t){return{accountUpn:e.UserUpn,getLokiToken:function(e){return function(t){return new Promise(function(t,n){e.getAuthToken(function(e,n){t(e)},function(e,t){n("Error getting auth token: "+e+" (authRequestCorrelationId: "+t+")")})})}}(t),options:t.options,hostAppActions:t.hostAppActions,strings:window.OfficeFeedStrings.strings}}(e,t),[2,window.OfficeFeed.start(n)]}catch(e){throw new u("StartOfficeFeedError",e.name+" "+e.message)}return[2]}})})}!function(e){e.getAuthToken="GetAuthTokenDuration",e.getAuthTokenFromStart="GetAuthTokenFromStartDuration",e.getLokiConfig="GetLokiConfigDuration",e.getLokiConfigFromStart="GetLokiConfigFromStartDuration",e.getLpcBundles="GetLpcBundlesDuration",e.getLpcBundlesFromStart="GetLpcBundlesFromStartDuration",e.startLpc="StartLpcDuration",e.startLpcFromStart="StartLpcFromStartDuration",e.getOfficeFeedBundles="GetOfficeFeedBundlesFromStartDuration"}(j||(j={}));var R=function(){function e(){this.start=this.getCurrentTime(),this.timings={}}return e.prototype.measureFromStart=function(e){this.timings[e]=Math.round(this.getCurrentTime()-this.start)},e.prototype.startCustomTiming=function(e){try{window.performance.mark(e+"-start")}catch(e){}},e.prototype.endCustomTiming=function(e){try{window.performance.mark(e+"-end"),window.performance.measure(e,e+"-start",e+"-end");var t=window.performance.getEntriesByName(e)[0];this.timings[e]=Math.round(t.duration)}catch(e){}},e.prototype.getAllTimings=function(){var e=this;try{var t=window.performance.getEntriesByType("resource");t&&t.forEach(function(t){if(t&&t.name){var n=t.name.toLowerCase(),r=!1;-1!==n.indexOf("authtoken/loki")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("service.svc?action=getclientaccesstoken&ep=1&app=mail")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacard_")?(n="LpcBundleRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacardstrings")?(n="LpcStringsRequestDuration",r=!0):-1!==n.indexOf("/api/v1/configuration/")&&(n="InitConfigRequestDuration",r=!0),r&&(e.timings[n]=Math.round(t.duration))}})}catch(e){}return this.timings},e.prototype.getCurrentTime=function(){return window.performance&&"function"==typeof window.performance.now?performance.now():Date.now()},e}();function U(e){return void 0===e||"string"!=typeof e||""===e||null===e}function z(e){return void 0===e||"function"!=typeof e}var W=["msit","df","ppe"],X=["Prod","Blackforest","GccModerate"];function V(e){var t="";if(e){var n=[];U(e.culture)&&n.push("culture"),U(e.clientType)&&n.push("clientType"),U(e.clientContextType)&&n.push("clientContextType"),U(e.clientCorrelationId)&&n.push("clientCorrelationId"),z(e.logMessage)&&n.push("logMessage"),z(e.getAuthToken)&&n.push("getAuthToken"),n.length>0&&(t="Invalid required parameter(s): "+n.join(", ")+". Check the values and types you're passing. "),e.region&&-1===W.indexOf(e.region.toLowerCase().trim())&&(t+="Invalid region value. Allowed values are: empty string for production environments, and "+W.join(", ")+" for pre-production environments. "),-1===X.indexOf(e.complianceEnvironment)&&(t+="Environment is missing or wrong. Allowed values are: "+X.join(", ")+". We currently don't support other Sovereign Clouds.")}else t="Config must be defined.";if(t)throw new u("ValidateBootstrapperConfigError",t)}n.d(t,"initializeLivePersonaCardAsync",function(){return te}),n.d(t,"initializeOfficeFeedAsync",function(){return re}),n.d(t,"fetchLokiConfigAsync",function(){return ie});var $,J,K=function(){return(K=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Q=function(e,t,n,r){return new(n||(n=Promise))(function(i,s){function o(e){try{a(r.next(e))}catch(e){s(e)}}function u(e){try{a(r.throw(e))}catch(e){s(e)}}function a(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,u)}a((r=r.apply(e,t||[])).next())})},G=function(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}},Y=!1,Z=3e5,ee="e5ad760145754ffc9704e67c800087f2-dc72ff20-3e8a-401a-b9a8-ec72e4dd3e22-7257";function te(e){return Q(this,void 0,void 0,function(){var t,n,r=this;return G(this,function(i){return!Y&&$?[2,$]:(t=new R,n=o.getOrCreate(e),Y=!1,($=new Promise(function(i,s){return Q(r,void 0,void 0,function(){var r,o,u,a,f;return G(this,function(c){switch(c.label){case 0:return c.trys.push([0,9,,10]),V(e),t.startCustomTiming(j.getAuthToken),[4,l(e.authToken,e.getAuthToken)];case 1:return r=c.sent(),t.endCustomTiming(j.getAuthToken),t.measureFromStart(j.getAuthTokenFromStart),t.startCustomTiming(j.getLokiConfig),[4,N(r,e)];case 2:return o=c.sent(),t.endCustomTiming(j.getLokiConfig),t.measureFromStart(j.getLokiConfigFromStart),t.startCustomTiming(j.getLpcBundles),e.scriptsInsertedByHostPromise?[4,e.scriptsInsertedByHostPromise]:[3,4];case 3:return c.sent(),[3,6];case 4:return[4,(h=o,d=h.Resources[D],p="OwaPeopleHub"===h.Workload?h.Resources[_]:h.Resources[M],Promise.all([O(d),O(p)]))];case 5:c.sent(),c.label=6;case 6:return t.endCustomTiming(j.getLpcBundles),t.measureFromStart(j.getLpcBundlesFromStart),t.startCustomTiming(j.startLpc),[4,B(o,e)];case 7:return c.sent(),t.endCustomTiming(j.startLpc),t.measureFromStart(j.startLpcFromStart),[4,n.updateContextWithLokiDataAsync(o,ee).catch(function(){console.log("Live Persona Card ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 8:return c.sent(),(u=se(t.getAllTimings())).RootCorrelationId=o.RootCorrelationId,n.logEventAsync({name:"initializeLivePersonaCard_success",properties:u},ee),i(),[3,10];case 9:return a=c.sent(),f=se(t.getAllTimings()),n.logEventAsync({name:"initializeLivePersonaCard_failure",properties:K({},oe(a),f)},ee),s("Failed to initialize Live Persona Card: "+a.name+" "+a.message),[3,10];case 10:return[2]}var h,p,d})})})).catch(function(){setTimeout(function(){Y=!0},Z)}),[2,$])})})}var ne=!1;function re(e){return Q(this,void 0,void 0,function(){var t,n,r=this;return G(this,function(i){return!ne&&J?[2,J]:(t=new R,n=o.getOrCreate(e),ne=!1,(J=new Promise(function(i,s){return Q(r,void 0,void 0,function(){var r,o,u,a,f,c;return G(this,function(h){switch(h.label){case 0:return h.trys.push([0,6,,7]),V(e),[4,l(e.authToken,e.getAuthToken)];case 1:return r=h.sent(),t.measureFromStart(j.getAuthTokenFromStart),[4,N(r,e)];case 2:return o=h.sent(),t.measureFromStart(j.getLokiConfigFromStart),[4,(p=o,d=p.Resources[H],v=p.Resources[P],Promise.all([O(d),O(v)]))];case 3:return h.sent(),t.measureFromStart(j.getOfficeFeedBundles),[4,q(o,e)];case 4:return u=h.sent(),[4,n.updateContextWithLokiDataAsync(o,ee).catch(function(){console.log("Office Feed ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 5:return h.sent(),(a=se(t.getAllTimings())).RootCorrelationId=o.RootCorrelationId,n.logEventAsync({name:"initializeOfficeFeed_success",properties:a},ee),i(u),[3,7];case 6:return f=h.sent(),c=se(t.getAllTimings()),n.logEventAsync({name:"initializeOfficeFeed_failure",properties:K({},oe(f),c)},ee),s("Failed to initialize Office Feed: "+f.name),[3,7];case 7:return[2]}var p,d,v})})})).catch(function(){setTimeout(function(){ne=!0},Z)}),[2,J])})})}function ie(e){return Q(this,void 0,void 0,function(){return G(this,function(t){switch(t.label){case 0:return[4,l(e.authToken,e.getAuthToken)];case 1:return[2,N(t.sent(),e)]}})})}function se(e){var t={};return Object.keys(e).forEach(function(n){t["Perf_"+n]=e[n].toString()}),t}function oe(e){return{ErrorType:e.name,ErrorMessage:e.message||"",RootCorrelationId:e.rootCorrelationId||"",IsClientOnline:navigator&&void 0!==typeof navigator.onLine?navigator.onLine:""}}}])});
define("@ms/odsp-datasources/lib/Loki",["require","exports","tslib","./dataSources/loki/Loki"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/odsp-datasources/lib/dataSources/loki/Loki",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Qos.event","../../providers/oAuthToken/OAuthTokenProvider","../base/DataSource","../oAuthToken/OAuthTokenDataSource"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,{dataSourceName:"LokiDataSource"},{pageContext:t})||this;n._oAuthTokenProvider=new i.default(null,{oAuthTokenDataSource:new o.default(t)});return n}t.prototype.getRegion=function(){var e=new r.Qos({name:"LivePersonaCard.GetLokiRegion"});try{var n=this._pageContext.farmLabel;if(!n){e.end({resultType:r.ResultTypeEnum.Failure,resultCode:"LokiNoFarmLabel",error:"Farm label property not found in _spPageContextinfo object. Aborting connection!"});return""}var i=n.split("_")[0].toLowerCase();return t.FARMLABEL_TO_REGION_MAPPING[i]}catch(t){e.end({resultType:r.ResultTypeEnum.Failure,resultCode:"LokiGetRegionError",error:t});return""}};t.prototype.getAuthTokenGetter=function(e){var t=this;void 0===e&&(e="LPC-ODSP");var n=this._pageContext.CorrelationId;return function(r,i){t.getData(function(){return"/_vti_bin/DelveApi.ashx/authtoken/loki?d="+Date.now()},function(e){r(e.replace(/"/g,""),n)},"lokiGetAuthToken",void 0,"GET",{"X-Delve-ClientPlatform":e},void 0,void 0,void 0,void 0,function(e){i(e.statusText,n);return"Loki getAuthToken() failed with "+e.code})}};t.prototype.getAadAuthTokenGetter=function(){var e=this,t=this._pageContext.CorrelationId,n="https://loki.delve.office.com/";a(this._pageContext)?n="https://loki.delve.office.de/":f(this._pageContext)&&(n="https://gcc.loki.delve.office.com/");return function(r,i){e._oAuthTokenProvider.getToken(n).then(function(e){return r(e,t)}).catch(function(e){return i(e.message,t)})}};t.FARMLABEL_TO_REGION_MAPPING={edog:"ppe",msit:"msit",spdf:"df"};return t}(s.default);t.Loki=u;function a(e){return e.env&&"blackforest"===e.env.toLowerCase()||e.farmLabel&&0===e.farmLabel.toLowerCase().indexOf("deu_")}t.isBlackforestEnvironment=a;function f(e){var t=e.farmLabel&&e.farmLabel.toLowerCase()||"";return 0===t.indexOf("us_2_")||0===t.indexOf("us_86_")||0===t.indexOf("us_96_")}t.isGccModerateEnvironment=f;t.default=u});
define("@ms/odsp-shared-react/lib/components/LivePersonaCardAdapter/LivePersonaCardAdapter.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".sp-livePersonaCardAdapter-root{display:inline-block}\n"}])});
define("odsp-next/controls/itemMuteNotification/ItemMuteNotification",["require","exports","tslib","react","office-ui-fabric-react/lib/Button","@ms/odsp-utilities/lib/scope/Scope","@ms/odsp-shared-react/lib/utilities/resources/Resources","../../dataSources/item/odb/ItemMuteNotificationDataSource","./ItemMuteNotification.resx","./ItemMuteNotification.css"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.notificationStateMaterials={on:{bellButtonClassName:"InfoPane-itemDetails-notificationBellODB",bellButtonIconName:"Ringer",tooltips:a.strings.tooltipsOn,isAriaChecked:!0,ariaLabel:a.strings.ariaLabel},off:{bellButtonClassName:"InfoPane-itemDetails-notificationBellODB",bellButtonIconName:"RingerOff",tooltips:a.strings.tooltipsOff,isAriaChecked:!1,ariaLabel:a.strings.ariaLabel},loading:{bellButtonClassName:"InfoPane-itemDetails-notificationBellODB--loading",bellButtonIconName:"Ringer",tooltips:a.strings.tooltipsLoading,ariaLabel:a.strings.ariaLabelLoading},error:{bellButtonClassName:"InfoPane-itemDetails-notificationBellODB--loading",bellButtonIconName:"Ringer",tooltips:a.strings.tooltipsError,ariaLabel:a.strings.ariaLabelError}};var f=function(e){n.__extends(u,e);function u(t,n){var r=e.call(this,t,n)||this;r._toggleNotifications=function(){if(3!==r.state.notificationState&&2!==r.state.notificationState){r.setState(function(e){return{notificationState:0===e.notificationState?1:0}});var e=r.state.notificationState,t=0===e||1!==e&&void 0;r._updateNotificationState(t)}};r._loadNotificationState=function(e){r._itemMuteNotificationDataSource.getNotificationState(e).then(function(e){void 0!==e?r.setState(function(){return{notificationState:e?0:1}}):r.setState({notificationState:3})})};r._updateNotificationState=function(e){void 0!==e&&r._itemMuteNotificationDataSource.updateNotificationState(e)};r._scope=new s.default;r._itemMuteNotificationDataSource=r.props.itemMuteNotificationDataSource||r._scope.attach(r.context.dependencies.itemMuteNotificationDataSource);r.state={notificationState:2};return r}u.prototype.render=function(){var e;switch(this.state.notificationState){case 0:e=t.notificationStateMaterials.on;break;case 1:e=t.notificationStateMaterials.off;break;case 2:e=t.notificationStateMaterials.loading;break;case 3:e=t.notificationStateMaterials.error}return r.createElement(i.IconButton,{className:e.bellButtonClassName,onClick:this._toggleNotifications,iconProps:{iconName:e.bellButtonIconName},title:e.tooltips,role:"switch","aria-checked":e.isAriaChecked,"aria-label":e.ariaLabel})};u.prototype.componentDidMount=function(){this._loadNotificationState(this.props.item)};u.prototype.componentWillUnmount=function(){this._scope.dispose()};u.prototype.UNSAFE_componentWillUpdate=function(e){e.item!==this.props.item&&this._loadNotificationState(e.item)};u.contextTypes=o.RESOLVED_COMPONENT_CONTEXT_TYPES;return u}(r.PureComponent);t.ItemMuteNotification=f;t.resourceKey=o.createResolvedComponentTypeResourceKey(e("module").id,f,{itemMuteNotificationDataSource:u.resourceKey})});
define("odsp-next/dataSources/item/odb/ItemMuteNotificationDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-datasources/lib/utilities/url/ApiUrlHelperBasic","../../base/vroom/VroomDataRequestor","../../url/odb/ItemUrlHelper","../../../models/item/ItemParentHelper","../../../models/item/ItemType","../../../resources/DataSourceResourceKeys","../../base/odb/DataRequestor","@ms/odsp-utilities/lib/uri/SimpleUri","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-graph/lib/models/error/Error"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(){function e(e,t){this._vroomDataRequestor=t.vroomDataRequestor;this._graphDataSource=t.graphDataSource;this._dataRequestor=new t.dataRequestorType({qosName:"ItemMuteNotificationDataSource"});this._itemUrlHelper=t.itemUrlHelper;this._itemParentHelper=t.itemParentHelper;this._identityDataSource=t.identityDataSource}e.prototype.getNotificationState=function(e){this._item=e;var t=this._graphDataSource.getItemUrl(e,{apiVersion:"v2.1",useDirectEndpoint:!0})+"/?$expand=notificationPreferences";return this._vroomDataRequestor.send({apiName:"ItemMuteNotificationDataSource.getState",path:t,requestType:"GET",apiVersion:"v2.1",useAuthorizationHeaders:!0,postProcessQos:this._overrideFilesAnalyticsExpectedFailure}).then(function(e){return e.notificationPreferences?e.notificationPreferences.every(function(e){return"None"!==e.name}):void 0}).catch(function(e){})};e.prototype.updateNotificationState=function(e){var t=this,n=this._itemParentHelper.getFacetedAncestorOrSelf(this._item,"subsite").peek(),r=n&&n.subsite?n.subsite.serverRelativeUrl:void 0,i=new s.ApiUrlHelperBasic({webAbsoluteUrl:r}).build().segment("web").segment("ActivityLogger").segment("FeedbackDirect").toString(),o=new h.default(i);return this._identityDataSource.getSharePointToken(o.authority).then(function(n){return t._dataRequestor.getData({url:i,qosName:"ItemMuteNotificationDataSource.postState",method:"POST",additionalPostData:t._getAdditionalPostData(e),noRedirect:!0,authToken:n.accessToken}).catch(function(e){})})};e.prototype._overrideFilesAnalyticsExpectedFailure=function(e,t){var r=d.getErrorResolution(t,function(e){switch(e){case"notSupported":return{resultType:p.ResultTypeEnum.ExpectedFailure}}});return n.__assign({},e,r||{})};e.prototype._getNotificationPreferenceState=function(e){return e?"None":"Comments"};e.prototype._getItemType=function(){switch(this._item.type){case f.default.Subsite:case f.default.Shortcut:return"Web";case f.default.Folder:return"Folder";case f.default.File:case f.default.Media:case f.default.OneNote:case f.default.Unknown:case f.default.App:default:return"File"}};e.prototype._getAdditionalPostData=function(e){var t={},n=new Date,r=this._itemParentHelper.getFacetedAncestorOrSelf(this._item,"subsite").peek(),i=r?r.subsite:void 0,s=this._itemParentHelper.getFacetedAncestorOrSelf(this._item,"list").peek();t.ListId=s.list?s.list.id.replace("{","").replace("}",""):void 0;t.ListItemUniqueId=this._item.properties?this._item.properties.uniqueId:void 0;t.Operation="NotificationPreferenceChanged";t.AffectedResourceUrl=this._itemUrlHelper.getItemUrlParts(this._item.key).fullItemUrl;t.ItemType=this._getItemType();var o={Scenario:"NotificationPreference",NotificationPreference:this._getNotificationPreferenceState(e),ClientUTCOffsetInMinutes:n.getTimezoneOffset(),ClientApplication:"ODBWeb",ClientVersion:"1",Workload:"ODB",Canvas:"DetailsPane",SiteId:i?i.siteCollectionId.replace("{","").replace("}",""):void 0,WebId:i?i.id.replace("{","").replace("}",""):void 0,SiteUrl:i?i.serverRelativeUrl:"",SourceRelativeUrl:s.name,SourceFileExtension:this._item.extension?this._item.extension.replace(".",""):"",SourceFileName:this._item.name};t.json=JSON.stringify(o);return JSON.stringify(t)};e.dependencies=n.__assign({},r.default.dependencies,{vroomDataRequestor:o.resourceKey,graphDataSource:l.graph,itemParentHelper:a.resourceKey,dataRequestorType:c.typeResourceKey,itemUrlHelper:u.resourceKey,identityDataSource:l.identity});return e}();t.default=v;t.resourceKey=i.createResolvedResourceKey(e("module").id,v,n.__assign({},r.default.dependencies,{vroomDataRequestor:o.resourceKey,graphDataSource:l.graph,itemParentHelper:a.resourceKey,dataRequestorType:c.typeResourceKey,itemUrlHelper:u.resourceKey,identityDataSource:l.identity}))});
define("odsp-next/controls/itemMuteNotification/ItemMuteNotification.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".InfoPane-itemDetails-notificationBellODB{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";height:auto;margin-bottom:2px;font-size:16px;margin-top:3px}.InfoPane-itemDetails-notificationBellODB--loading{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";height:auto;margin-bottom:2px;font-size:16px;margin-top:3px}"}])});
define("odsp-next/controls/base/react/ResolvedComponentType",["require","exports","tslib","react","@ms/odsp-shared-react/lib/utilities/resources/Resources","./WithResources"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getResolvedComponentType=function(e){var t=function(t){n.__extends(s,t);function s(){return null!==t&&t.apply(this,arguments)||this}s.prototype.render=function(){var t=this.props,s=t.resources,o=n.__rest(t,["resources"]);return r.createElement(i.ResourcedControl,{specification:i.toSpecification(e,o),resources:s})};return s}(r.PureComponent);return s.withResources()(t)}});
define("odsp-next/controls/itemActivityFeed/ItemActivityFeed.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ItemActivityFeedWrapper .sp-livePersonaCardAdapter-root{font-family:inherit;font-size:inherit}.od-ItemActivityFeedWrapper{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column}.od-ItemActivityFeed-header{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;margin-bottom:12px}.od-ItemActivityFeed-title{font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";margin:0}.isFluent .od-ItemActivityFeed-title{font-size:14px;font-weight:600}.od-ItemActivityFeed-viewOption{background-color:transparent;padding:0;-ms-flex-item-align:end;align-self:flex-end;-ms-flex-positive:1;flex-grow:1}.od-ItemActivityFeed-viewOption .ms-Button-label{font-weight:400}"}])});
define("odsp-next/controls/itemActivityFeed/ItemActivityFeed",["require","exports","tslib","react","prop-types","./ItemActivityFeed.resx","@ms/odsp-shared-react/lib/components/ItemActivityFeed/ItemActivityFeed","./ItemActivityFeedViewOption","../../models/itemsScope/ItemsScopeFeature.key","../../resources/DataSourceResourceKeys","../../providers/itemActivities/GroupedItemActivityFeedStore","../../providers/engagement/Engagement","../../providers/itemActivities/ItemCommentsStore","../../providers/item/ItemProvider","../../utilities/features/Features","../../utilities/item/ListItemTypeConverter","@ms/odsp-datasources/lib/Permissions","../../models/item/ItemParentHelper","../itemMuteNotification/ItemMuteNotification","../../models/comments/ItemActivityCommentsFeature.key","../../models/item/ItemType","../base/react/ResolvedComponentType","./ItemActivityFeed.css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S=E.getResolvedComponentType(y.resourceKey.local.bypass),x=function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t,r)||this;i._canOpenItem=function(e){return!!i._getItemUrl(e)};i._onItemClick=function(e,t){var n=i.props.item,r=i._getItemUrl(e);i._itemActivityFeedHelper.navigateToItem(n,e,r,function(e){i._engagement.logData({name:"ActivityFeed.ItemClicked",isIntentional:!0,extraData:{activityType:t||"",itemType:e||""}})})};i._onItemCommentsSettingChanged=function(e){var t=i.props.item;if(e!==(t.comments&&t.comments.settings&&t.comments.settings.isCommentDisabled)){var r=n.__assign({},t.comments&&t.comments.settings,{isCommentDisabled:e}),s=i._resources.consume(p.resourceKey);s.invalidateItem(t.key);s.invalidateItem(t.parentKey);i._itemActivityFeedHelper.updateItem(t,{comments:n.__assign({},t.comments,{settings:r})});var o=t&&t.properties&&t.properties.ID;i._isItemsScopeEnabled()&&i._resources.consumeAsync(f.itemInvalidator).then(function(e){e.refreshItemsInCurrentItemSet([o])})}};i._canDeleteActivity=function(e){var t=i.props.item;switch(e){case 2:return i._isCommentsAvailable(t)&&m.PermissionMask.hasItemPermission(t,m.PermissionMask.editListItems);default:return!1}};i._onRenderUser=function(e,t){return i._itemActivityFeedHelper.renderUser(e,t)};i._deleteCommentActivity=function(e,t,n){var r=n.commentItem,s=n.commentId;e&&r&&s&&i._itemCommentsStore.deleteCommentById(r,s,t)};i._resources=t.resources;i._itemActivityFeedStore=i._resources.consume(l.resourceKey);var s=i._resources.consume(f.identity);i._itemCommentsStore=i._resources.consume(h.resourceKey);i._currentUserEmail=s.getIdentity().loginName;i._itemActivityFeedHelper=i._resources.consume(f.itemActivityFeedHelper);i._engagement=i._resources.consume(c.resourceKey);i._isItemsScopeEnabled=i._resources.consume(a.isItemsScopeEnabledResourceKey.lazy);i._isCommentsInActivityFeedEnabled=i._resources.consume(b.resourceKey.lazy);i._itemParentHelper=i._resources.consume(g.resourceKey);i.state={graphDataSource:i._resources.consume(f.graph.optional),commentsOnly:!1};i._itemActivityFeedHelper.init(i._resources);return i}t.prototype.getChildContext=function(){return{itemActivityFeedStore:this._itemActivityFeedStore,itemCommentsStore:this._itemCommentsStore,engagementSource:"ActivityFeed"}};t.prototype.componentDidMount=function(){this.state.graphDataSource||this._loadGraphDataSource()};t.prototype.shouldComponentUpdate=function(e,t){var n=e.item,r=this.props.item;return n&&r&&n.key!==r.key&&0===n.revision||this._isCommentSettingsChanged(n,r)||e.resources!==this.props.resources||t.graphDataSource!==this.state.graphDataSource||t.commentsOnly!==this.state.commentsOnly};t.prototype.render=function(){var e=this,t=this.props.item,n=this.state.commentsOnly,i=t.displayName||"",a=this._itemActivityFeedHelper.getGraphItemUrl(t,this.state.graphDataSource),f=this._itemActivityFeedHelper.getAccessToken(t,this.state.graphDataSource);if(a){var l={name:i,graphItemUrl:a,accessToken:f},c=this._isCommentsAvailable(t),h=this._getCommentListItem(t,l)||void 0,p=c&&n,d=!(c&&(m.PermissionMask.hasItemPermission(t,m.PermissionMask.editListItems)||m.PermissionMask.hasItemPermission(t,m.PermissionMask.reviewListItems)))||this._isCommentDisabled(t),v=t.isRootFolder?"driveRoot":t.folder?"folder":t.extension||"file";this._engagement.logData({name:"ActivityFeed.Renders",isIntentional:!0,extraData:{itemType:v||""}});return r.createElement("div",{className:"od-ItemActivityFeedWrapper"},r.createElement("div",{className:"od-ItemActivityFeed-header"},r.createElement("h2",{className:"od-ItemActivityFeed-title"},s.strings.itemActivityFeedSectionTitle),this._isItemNotificationActive()&&r.createElement(S,{item:t}),r.createElement(u.ItemActivityFeedViewOption,{isCommentsOnlyView:n,item:t,onSelectMenuOption:function(t){e.setState({commentsOnly:t})},itemActivityFeedHelper:this._itemActivityFeedHelper,isCommentsInActivityFeedEnabled:this._isCommentsInActivityFeedEnabled()})),r.createElement(o.default,{currentUserEmail:this._currentUserEmail,containingItem:l,isSingleLevel:!t.folder,canOpenItem:this._canOpenItem,onItemClick:this._onItemClick,onRenderUser:this._onRenderUser,currentRootTitle:this._itemActivityFeedHelper.getCurrentRootTitle(t),defaultItemTitle:this._itemActivityFeedHelper.getDefaultItemTitle(t),commentListItem:h,isReadonly:d,commentsOnly:p,canDeleteActivity:this._canDeleteActivity,activityMenuFunctions:this._getActionMenuFunctions(),onCommentSettingsChanged:this._onItemCommentsSettingChanged,environment:this._itemActivityFeedHelper.getAPIEnvironment()}))}return r.createElement("div",null)};t.prototype._isItemNotificationActive=function(){var e=this.props.item,t=d.isFeatureEnabled(d.EnableCommentsInActivityFeed)&&d.isFeatureEnabled(d.EnablePerItemMuteNotification),n=e.type!==w.default.Folder&&e.extension,r=!this._itemActivityFeedHelper.isGuestUser();return n&&t&&r};t.prototype._getCommentListItem=function(e,t){if(this._isCommentsAvailable(e)){var n=this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"),r=n&&n.peek()&&n.peek().list&&n.peek().list.id;if(r)return{item:v.convertToISPListItem(e),activityItemWrapper:t,parentListId:r}}};t.prototype._isCommentsAvailable=function(e){return this._itemActivityFeedHelper.isNonOfficeFileCommentsAvailable(e)};t.prototype._isCommentDisabled=function(e){return e&&e.comments&&e.comments.settings&&e.comments.settings.isCommentDisabled};t.prototype._isCommentSettingsChanged=function(e,t){return(e.comments&&e.comments.settings&&e.comments.settings.isCommentDisabled)!==(t.comments&&t.comments.settings&&t.comments.settings.isCommentDisabled)};t.prototype._getItemUrl=function(e){return this._itemActivityFeedHelper.getActivityItemUrl(e)};t.prototype._loadGraphDataSource=function(){var e=this;this._resources.consumeAsync(f.graph).then(function(t){e.setState({graphDataSource:t})})};t.prototype._getActionMenuFunctions=function(){var e;return(e={})[2]={delete:this._deleteCommentActivity},e};t.childContextTypes={itemActivityFeedStore:i.object.isRequired,itemCommentsStore:i.object.isRequired,engagementSource:i.object.isRequired};return t}(r.Component);t.default=x});
define("odsp-next/controls/detailsPane/section/itemActivityFeed/ItemActivityFeedSection.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-DetailsPane-ItemActivityFeedSection{margin:12px 0;padding:0 16px}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-error,.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-noActivities,.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";margin:12px 0;padding:8px}.isFluent .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-error,.isFluent .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-noActivities,.isFluent .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity{padding:8px 16px;border-radius:2px}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-grouplistTitle{margin-bottom:12px}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity-withResponse{margin-bottom:0}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity-withCommentResponse{margin:0 -40px 0 0}html[dir=rtl] .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity-withCommentResponse{margin:0 0 0 -40px}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-error,.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-noActivities{font-size:12px}.od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-activityContent{padding:0 0 0 8px}html[dir=rtl] .od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-activityContent{padding:0 8px 0 0}.isFluent .od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-activityContent{padding:0 0 0 16px}html[dir=rtl] .isFluent .od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-activityContent{padding:0 16px 0 0}.od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-timeStamp{padding-top:2px}.od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-missingActivity{margin-bottom:12px}.od-DetailsPane-ItemActivityFeedSection-content .ms-ActivityItem-activityTypeIcon{font-size:16px!important}.od-DetailsPane-SecondaryPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-error,.od-DetailsPane-SecondaryPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityFeed-noActivities,.od-DetailsPane-SecondaryPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.Files-rightPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity-withCommentResponse{width:calc(100% - 16px)}.Files-infoPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity-withCommentResponse,.OneUp-infoPane .od-DetailsPane-ItemActivityFeedSection-content .od-ItemActivityList-activity-withCommentResponse{width:calc(100% - 32px)}"}])});
define("odsp-next/controls/detailsPane/section/itemActivityFeed/LegacyItemActivityFeedSection",["require","exports","tslib","react","../../../infoPane/sections/activitiesFeed/ActivitiesFeed","../legacy/LegacySection"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return r.createElement(s.default,{sectionControlKey:i.resourceKey,item:t,resources:n})};return t}(r.Component);t.default=o});
define("odsp-next/controls/infoPane/sections/activitiesFeed/ActivitiesFeed",["require","exports","./ActivitiesFeedViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../../../bindings/component/ControlBinding","./ActivitiesFeed.html","./ActivitiesFeed.css","../../../itemActivityTile/ItemActivityTile"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"ms-activities-feed",template:e("./ActivitiesFeed.html"),viewModel:n.default,synchronous:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"ms-activities-feed",name:e("module").id,template:e("./ActivitiesFeed.html"),viewModelType:n.default});t.default=s});
define("odsp-next/controls/infoPane/sections/activitiesFeed/ActivitiesFeedViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/async/Promise","../../../../bindings/html/BindableHtmlBinding","../../../../resources/ControlResourceKeys","../../../../models/item/ItemType","@ms/odsp-utilities/lib/dateTime/DateTime","./ActivitiesFeed.resx","./ActivitiesFeedKeyboardNav","./ActivitiesFeedHelper","../../../../providers/itemActivity/ItemActivityAggregator","@ms/odsp-utilities/lib/string/StringHelper","../../../../bindings/toggle/ToggleBinding","../../../../bindings/selection/SelectionBinding","../../../../bindings/keyboard/KeyboardBinding","../../../loadingSpinner/LoadingSpinner","../../SectionHelper","@ms/odsp-utilities/lib/modules/Modules"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=f.strings,E=100,S='<a href="#">',x="</a>",T=function(t){n.__extends(f,t);function f(e,n){void 0===n&&(n={});var r=t.call(this,e,n)||this,i=r.observables,u=r.resources;r._item=e.item;r._currentItem=r.resources.consume(o.currentItem);r.addBindingHandlers({bindableHtml:s.default,keyboard:m.default,toggle:d.default,selection:v.default});var a=u.consume(o.isSharingSectionExpanded.optional),f=r.resources.consume(o.actionMap);r._showVersionHistoryAction=new(r.child(f.ShowVersionHistoryAction));r._itemActivityResults=i.create([]);r.isLoading=i.create(!0);r.loadingSpinnerFlatTagName=g.default.tagName;r._helper=new(r.managed(c.default));r.sectionHelper=new(r.managed(y.default))({shouldStartExpanded:!a||!a.peek()});r.keyNav=new l.default;var h=r.thisWeekCollection=i.createArray([]),b=r.lastWeekCollection=i.createArray([]),T=r.earlierCollection=i.createArray([]);r.resxStrings=w;r.hasChanges=i.pureCompute(r._computeHasChanges);r.showForEarlierChangesMsg=i.pureCompute(r._computeShowForEarlierChangesMsg);r.forEarlierChangesMsg=p.format(w.ForEarlierChanges,S,x);r._activityComponents=null;r.showSeeMore=i.create(!1);r.seeMoreText=w.ActivitiesFeedShowMore;r.errorMessage=r.createObservable(null);var N=i.createArray([{title:w.ActivitiesFeedThisWeekListText,tiles:h},{title:w.ActivitiesFeedLastWeekListText,tiles:b},{title:w.ActivitiesFeedEarlierListText,tiles:T}]);r.tileCollections=r.addDisposable(N.filter(function(e){return e.tiles().length>0}));r._itemActivityQueryParams={add:!0,deleteObject:!0,fetchLimit:E,group:!0,item:!0,latestFirst:!0,move:!0,rename:!0,restore:!0,roleAssignmentAdd:!0,roleDefinitionAdd:!0,update:!0,user:!0};i.backgroundCompute(r._updateActivities);i.backgroundCompute(r._computeUpdateActivityComponents);return r}f.prototype.onFileVersionClick=function(e,t){this._showVersionHistoryAction.execute(t).done();return!1};f.prototype.onSeeMore=function(){var e=this;this.showSeeMore(!1);this.isLoading(!0);this.async.setTimeout(function(){e._generateCollectionsToRender(e._activityComponents,!0);e.isLoading(!1)},0);return!1};f.prototype._updateActivities=function(){var e=this,t=this._item();this.isLoading(!0);this.thisWeekCollection([]);this.lastWeekCollection([]);this.earlierCollection([]);this.keyNav.focusableTiles([]);this._activityComponents=null;var n=t.type===u.default.Folder&&t===this._currentItem.peek();this._getItemActivityDataSource().then(function(r){return r.getItemActivities(t,e._itemActivityQueryParams,n)}).done(function(t){e._itemActivityResults(t);e.errorMessage(null);e.isLoading(!1)},function(t){e.errorMessage(e.resxStrings.Error);e.isLoading(!1)})};f.prototype._computeHasChanges=function(){return 0!==this._itemActivityResults().length};f.prototype._computeUpdateActivityComponents=function(){if(this.hasChanges()){this._activityComponents=h.default.process(this._itemActivityResults());this._generateCollectionsToRender(this._activityComponents,!1)}};f.prototype._computeShowForEarlierChangesMsg=function(){var e=this._item(),t=this._itemActivityResults();return(e.type===u.default.File||!!e.appMap)&&(!this.hasChanges()||1!==t[t.length-1].itemActivityChangeType)&&!this.showSeeMore()&&this._showVersionHistoryAction.isAvailable()};f.prototype._generateCollectionsToRender=function(e,t){var n=[],r=[],i=[],s=[];this.showSeeMore(!1);if(e)for(var o=0;o<e.length;o++){var u=e[o],f=this._helper.convertToTile(u,o),l=u.date;(a.isThisWeek(l)?n:a.isLastWeek(l)?r:i).push(f);s.push(f);var c=o+1;if(!t&&6===c&&e.length>c){this.showSeeMore(!0);break}}this.thisWeekCollection(n);this.lastWeekCollection(r);this.earlierCollection(i);this.keyNav.focusableTiles(s)};f.prototype._getItemActivityDataSource=function(){var t=this,n=i.default.resolve(new Promise(function(t,n){e(["../../../../dataSources/itemActivity/odb/ItemActivityDataSource"],t,n)})).then(b.getDefaultExport).then(function(e){return new(t.managed(e))});this._getItemActivityDataSource=function(){return n};return n};f.dependencies=n.__assign({},r.default.dependencies);return f}(r.default);t.default=T});
define("odsp-next/controls/infoPane/sections/activitiesFeed/ActivitiesFeedKeyboardNav",["require","exports","knockout"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){var e=this;this.keyboardOptions=[{target:null,mappings:{Left:this.keyLeft,Right:this.keyRight,Enter:this.onEnter,Space:this.onSpace}},{target:window,mappings:{}}];this.focusableTiles=n.observableArray([]);this.focusedItem=n.observable();this.sectionHeaderFocus=n.observable(!1);this.sectionHeaderFocus.subscribe(function(t){!t&&e.focusedItem()&&e.focusedItem().focused(!1)})}e.prototype.keyRight=function(e,t){e.keyNav.trySetExpansion(!0);t.stopPropagation();return!0};e.prototype.keyLeft=function(e,t){e.keyNav.trySetExpansion(!1);t.stopPropagation();return!0};e.prototype.onEnter=function(e,t){e.keyNav.trySetExpansion();t.stopPropagation();return!0};e.prototype.onSpace=function(e,t){return e.keyNav.onEnter(e,t)};e.prototype.trySetExpansion=function(e){var t=this.focusedItem();if(t&&1===t.type){var n=t,r=n.expanded();n.expanded(void 0===e?!r:e);if(r!==e){var i=this.focusableTiles,s=i.indexOf(n)+1;if(s>0&&n.focused()){var o=n.activities;n.expanded()?i.splice.apply(i,[s,0].concat(o)):i.splice(s,o.length)}}}};return e}();t.default=r});
define("odsp-next/controls/infoPane/sections/activitiesFeed/ActivitiesFeedHelper",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/dateTime/DateTime","../../../../controls/itemActivityTile/HeadlineGenerator","@ms/odsp-utilities/lib/locale/Locale"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._headlineGenerator=t.resources.consume(o.resourceKey);return t}t.prototype.convertToTile=function(e,t){var n,i=e.relativeTime?s.getRelativeDateTimeStringForLists(e.relativeTime):s.getRelativeDateTimeStringPastWithHourMinute(e.date);if(1===e.type){for(var o=e,a=this._getMainEditor(o.editors),f=new Array,l=0,c=o.activities;l<c.length;l++){var h=c[l],p={date:h.date.toLocaleTimeString(u.default.language,{hour:"numeric",minute:"2-digit"}),editor:h.editor,focused:r.observable(!1),headline:this._headlineGenerator.generateActivityHeadline(h),type:0,navigateToOptions:h.navigateToOptions};f.push(p)}n={activities:f,date:i,editor:a,expanded:r.observable(!1),focused:r.observable(!1),headline:this._headlineGenerator.generateHeadline(o),index:t,type:1}}else if(0===e.type){var d=e;n={date:i,editor:d.editor,focused:r.observable(!1),headline:this._headlineGenerator.generateActivityHeadline(d),index:t,type:0,navigateToOptions:d.navigateToOptions}}return n};t.prototype._getMainEditor=function(e){var t,n=this;e.some(function(e){var r=e.email===n._headlineGenerator.userLoginName;r&&(t=e);return r});!t&&e.length>0&&(t=e[0]);return t};return t}(i.default);t.default=a});
define("odsp-next/controls/itemActivityTile/HeadlineGenerator",["require","exports","../../resources/DataSourceResourceKeys","./ItemActivityTile.resx","./ItemActivityTileAdd.resx","./ItemActivityTileComment.resx","./ItemActivityTileEdit.resx","./ItemActivityTileMove.resx","./ItemActivityTileRemove.resx","./ItemActivityTileRename.resx","./ItemActivityTileRenameOrMove.resx","./ItemActivityTileRestore.resx","./ItemActivityTileShare.resx","./ItemActivityTileVersion.resx","@ms/odsp-utilities/lib/encoding/HtmlEncoding","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g='<span class="ms-fontWeight-semibold">',y='<span class="od-ItemActivityTile-ellipsisWrapper">',b="</span>",w=function(){function e(e,t){void 0===e&&(e={});this._userLoginName=t.identityDataSource.getIdentity().loginName}Object.defineProperty(e.prototype,"userLoginName",{get:function(){return this._userLoginName},enumerable:!0,configurable:!0});e.prototype.generateHeadline=function(e){var t=null;if(1===e.type){var n=e,r=this._encodeAggregate(n);t=this._generateAggregateHeadline(r)}else if(0===e.type){var i=e,s=this._encodeActivity(i);t=this.generateActivityHeadline(s)}return t};e.prototype.generateActivityHeadline=function(e){var t=this._encodeActivity(e),n=null,i=this._getEllipsisText(e,t.latestName),s=this._getEllipsisText(e,t.previousName,!0);this._isListItem="a list item"===e.latestName;switch(t.itemActivityChangeType){case 1:n=this._generateAddHeadline(t,i,s);break;case 2:n=this._generateCommentHeadline(t,i);break;case 3:n=this._generateEditHeadline(t,i);break;case 4:n=this._generateMoveHeadline(t,i);break;case 5:n=this._generateRemoveHeadline(t,i);break;case 6:n=this._generateRenameHeadline(t,i,s);break;case 7:n=this._generateRenameOrMoveHeadline(t,i);break;case 8:n=this._generateRestoreHeadline(t,i);break;case 9:n=this._generateShareHeadline(t,i);break;case 11:n=this._generateVersionHeadline(t,i);break;default:n=r.strings.DataFetchError}return n};e.prototype._encodeAggregate=function(e){for(var t=new Array,n=0;n<e.editors.length;n++){var r=this._encodePerson(e.editors[n]);t.push(r)}var i=new Array;for(n=0;n<e.activities.length;n++){var s=this._encodeActivity(e.activities[n]);i.push(s)}return{activities:i,editors:t,date:e.date,itemActivityChangeType:e.itemActivityChangeType,type:e.type}};e.prototype._encodeActivity=function(e){var t=this._encodePerson(e.editor),n=e.sharedWith,r=new Array;if(n)for(var i=0;i<e.sharedWith.length;i++){var s=this._encodePerson(e.sharedWith[i]);r.push(s)}return{id:e.id,changeToken:d.default.encodeText(e.changeToken),editor:t,latestName:d.default.encodeText(e.latestName),latestFolder:d.default.encodeText(e.latestFolder),previousName:d.default.encodeText(e.previousName),previousFolder:d.default.encodeText(e.previousFolder),sharedWith:r,date:e.date,itemActivityChangeType:e.itemActivityChangeType,type:e.type,navigateToOptions:e.navigateToOptions}};e.prototype._encodePerson=function(e){return{userId:d.default.encodeText(e.userId),email:d.default.encodeText(e.email),name:d.default.encodeText(e.name)}};e.prototype._generateAddHeadline=function(e,t,n){var r=i.strings;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._isListItem?v.format(r.AddListItemYou,g,b):v.format(r.AddItemYou,g,b,y,t,b):this._isListItem?v.format(r.AddListItem,g,e.editor.name,b):v.format(r.AddItem,g,e.editor.name,b,y,t,b):this._isListItem?r.AddListItemNoEditors:v.format(r.AddItemNoEditors,y,t,b)};e.prototype._generateCommentHeadline=function(e,t){var n=s.strings;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._isListItem?v.format(n.CommentListItemYou,g,b):v.format(n.CommentItemYou,g,b,y,t,b):this._isListItem?v.format(n.CommentListItem,g,e.editor.name,b):v.format(n.CommentItem,g,e.editor.name,b,y,t,b):this._isListItem?n.CommentListItemNoEditors:v.format(n.CommentItemNoEditors,y,t,b)};e.prototype._generateVersionHeadline=function(e,t){var n=p.strings;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._isListItem?v.format(n.VersionListItemYou,g,b):v.format(n.VersionItemYou,g,b,y,t,b):this._isListItem?v.format(n.VersionListItem,g,e.editor.name,b):v.format(n.VersionItem,g,e.editor.name,b,y,t,b):this._isListItem?n.VersionListItemNoEditors:v.format(n.VersionItemNoEditors,y,t,b)};e.prototype._generateEditHeadline=function(e,t){var n=o.strings;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._isListItem?v.format(n.ListItemEditYou,g,b):v.format(n.EditYou,g,b,y,t,b):this._isListItem?v.format(n.ListItemEdit,g,e.editor.name,b):v.format(n.Edit,g,e.editor.name,b,y,t,b):this._isListItem?n.ListItemEditNoEditors:v.format(n.EditNoEditors,y,t,b)};e.prototype._generateMoveHeadline=function(e,t){var n=u.strings,r=this._getEllipsisText(e,e.latestFolder),i=this._getEllipsisText(e,e.previousFolder,!0),s=!!e.latestFolder&&!!e.previousFolder,o=!e.latestFolder&&!!e.previousFolder,a=!!e.latestFolder&&!e.previousFolder;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?s?v.format(n.MoveFromToYou,g,b,y,t,b,y,i,b,y,r,b):o?v.format(n.MoveFromYou,g,b,y,t,b,y,i,b):a?v.format(n.MoveToYou,g,b,y,t,b,y,r,b):v.format(n.MoveYou,g,b,y,t,b):s?v.format(n.MoveFromTo,g,e.editor.name,b,y,t,b,y,i,b,y,r,b):o?v.format(n.MoveFrom,g,e.editor.name,b,y,t,b,y,i,b):a?v.format(n.MoveTo,g,e.editor.name,b,y,t,b,y,r,b):v.format(n.Move,g,e.editor.name,b,y,t,b):s?v.format(n.MoveFromToNoEditors,y,t,b,y,i,b,y,r,b):o?v.format(n.MoveFromNoEditors,y,t,b,y,i,b):a?v.format(n.MoveToNoEditors,y,t,b,y,r,b):v.format(n.MoveNoEditors,y,t,b)};e.prototype._generateRemoveHeadline=function(e,t){var n=a.strings;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._isListItem?v.format(n.ListItemRemoveYou,g,b):v.format(n.RemoveYou,g,b,y,t,b):this._isListItem?v.format(n.ListItemRemove,g,e.editor.name,b):v.format(n.Remove,g,e.editor.name,b,y,t,b):this._isListItem?n.ListItemRemoveNoEditors:v.format(n.RemoveNoEditors,y,t,b)};e.prototype._generateRenameHeadline=function(e,t,n){var r=f.strings;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?e.previousName?v.format(r.RenameFromToYou,g,b,y,n,b,y,t,b):v.format(r.RenameToYou,g,b,y,t,b):e.previousName?v.format(r.RenameFromTo,g,e.editor.name,b,y,n,b,y,t,b):v.format(r.RenameTo,g,e.editor.name,b,y,t,b):e.previousName?v.format(r.RenameFromToNoEditors,y,n,b,y,t,b):v.format(r.RenameToNoEditors,y,t,b)};e.prototype._generateRenameOrMoveHeadline=function(e,t){var n=l.strings;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?v.format(n.RenameOrMoveYou,g,b,y,t,b):v.format(n.RenameOrMove,g,e.editor.name,b,y,t,b):v.format(n.RenameOrMoveNoEditors,y,t,b)};e.prototype._generateRestoreHeadline=function(e,t){var n=c.strings;return e.editor&&e.editor.name?e.editor.email===this._userLoginName?v.format(n.RestoreYou,g,b,y,t,b):v.format(n.Restore,g,e.editor.name,b,y,t,b):v.format(n.RestoreNoEditors,y,t,b)};e.prototype._generateShareHeadline=function(e,t){return e.editor&&e.editor.name?e.editor.email===this._userLoginName?this._generateYouSharedWith(e.sharedWith,t):this._generateSharedWith(e.editor,e.sharedWith,t):this._generateNoEditorSharedWith(e.editor,e.sharedWith,t)};e.prototype._generateNoEditorSharedWith=function(e,t,n){var r=h.strings,i=null;switch(t.length){case 0:i=this._isListItem?r.ListItemShareNoEditors:v.format(r.ShareNoEditors,y,n,b);break;case 1:i=this._isListItem?v.format(r.ListItemShareWithNoEditorsOnePerson,t[0].name):v.format(r.ShareWithNoEditorsOnePerson,y,n,b,t[0].name);break;case 2:i=this._isListItem?v.format(r.ListItemShareWithNoEditorsTwoPersons,t[0].name,t[1].name):v.format(r.ShareWithNoEditorsTwoPersons,y,n,b,t[0].name,t[1].name);break;default:if(this._isListItem){var s=v.getLocalizedCountValue(r.ListItemShareWithNoEditorsMultiplePersons,r.ShareWithNoEditorsMultiplePersonsIntervals,t.length-2);i=v.format(s,t[0].name,t[1].name,String(t.length-2))}else{s=v.getLocalizedCountValue(r.ShareWithNoEditorsMultiplePersons,r.ShareWithNoEditorsMultiplePersonsIntervals,t.length-2);i=v.format(s,y,n,b,t[0].name,t[1].name,String(t.length-2))}}return i};e.prototype._generateSharedWith=function(e,t,n){var r=h.strings,i=null;if(t)switch(t.length){case 0:i=this._isListItem?v.format(r.ListItemShareWithNoPersons,g,e.name,b):v.format(r.ShareWithNoPersons,g,e.name,b,y,n,b);break;case 1:i=this._isListItem?v.format(r.ListItemShareWithOnePerson,g,e.name,b,t[0].name):v.format(r.ShareWithOnePerson,g,e.name,b,y,n,b,t[0].name);break;case 2:i=this._isListItem?v.format(r.ListItemShareWithTwoPersons,g,e.name,b,t[0].name,t[1].name):v.format(r.ShareWithTwoPersons,g,e.name,b,y,n,b,t[0].name,t[1].name);break;default:if(this._isListItem){var s=v.getLocalizedCountValue(r.ListItemShareWithMultiplePersons,r.ShareWithMultiplePersonsIntervals,t.length-2);i=v.format(s,g,e.name,b,t[0].name,t[1].name,String(t.length-2))}else{s=v.getLocalizedCountValue(r.ShareWithMultiplePersons,r.ShareWithMultiplePersonsIntervals,t.length-2);i=v.format(s,g,e.name,b,y,n,b,t[0].name,t[1].name,String(t.length-2))}}else i=v.format(r.ShareWithNoPersons,g,e.name,b,y,n,b);return i};e.prototype._generateYouSharedWith=function(e,t){var n=h.strings,r=null;if(e)switch(e.length){case 0:r=this._isListItem?v.format(n.ListItemShareWithNoPersonsYou,g,b):v.format(n.ShareWithNoPersonsYou,g,b,y,t,b);break;case 1:r=this._isListItem?v.format(n.ListItemShareWithOnePersonYou,g,b,e[0].name):v.format(n.ShareWithOnePersonYou,g,b,y,t,b,e[0].name);break;case 2:r=this._isListItem?v.format(n.ListItemShareWithTwoPersonsYou,g,b,e[0].name,e[1].name):v.format(n.ShareWithTwoPersonsYou,g,b,y,t,b,e[0].name,e[1].name);break;default:if(this._isListItem){var i=v.getLocalizedCountValue(n.ListItemShareWithMultiplePersonsYou,n.ShareWithMultiplePersonsYouIntervals,e.length-2);r=v.format(i,g,b,e[0].name,e[1].name,String(e.length-2))}else{i=v.getLocalizedCountValue(n.ShareWithMultiplePersonsYou,n.ShareWithMultiplePersonsYouIntervals,e.length-2);r=v.format(i,g,b,y,t,b,e[0].name,e[1].name,String(e.length-2))}}else r=this._isListItem?v.format(n.ListItemShareWithNoPersonsYou,g,b):v.format(n.ShareWithNoPersonsYou,g,b,y,t,b);return r};e.prototype._generateAggregateHeadline=function(e){var t=null,n=e.editors,i=o.strings;if(3===e.itemActivityChangeType&&i)if(this._didYouEdit(e.editors))t=this._generateAggregateHeadlineYou(e);else switch(n.length){case 0:t=v.format(i.AggregateNoEditors);break;case 1:t=v.format(i.AggregateOneEditor,g,n[0].name,b);break;case 2:t=v.format(i.AggregateTwoEditors,g,n[0].name,b,g,n[1].name,b);break;default:var s=v.getLocalizedCountValue(i.AggregateMultipleEditors,i.AggregateMultipleEditorsIntervals,n.length-2);t=v.format(s,g,n[0].name,n[1].name,b,String(n.length-2))}else t=r.strings.DataFetchError;return t};e.prototype._generateAggregateHeadlineYou=function(e){var t,n,i=this,s=o.strings,u=null,a=e.editors;a.some(function(e){if(e.email===i._userLoginName){t=e;return!0}});if((n=a.indexOf(t))>-1){a.splice(n,1);a.unshift(t)}if(3===e.itemActivityChangeType&&s)switch(a.length){case 1:u=v.format(s.AggregateEditYou,g,b);break;case 2:u=v.format(s.AggregateTwoEditorsYou,g,b,g,a[1].name,b);break;default:var f=v.getLocalizedCountValue(s.AggregateMultipleEditorsYou,s.AggregateMultipleEditorsYouIntervals,a.length-2);u=v.format(f,g,a[1].name,b,String(a.length-2))}else u=r.strings.DataFetchError;return u};e.prototype._getEllipsisText=function(e,t,n){return!e.navigateToOptions||n?'<span class="od-ItemActivityTile-ellipsis" title="'+t+'">'+t+"</span>":'<a class="od-ItemActivityTile-ellipsis" title="'+t+'" data-bind="event: { click: function(obj, ev) { return $data.onClick($data.tile, ev); } }">'+t+"</a>"};e.prototype._didYouEdit=function(e){var t=this;return e.some(function(e){return e.email===t._userLoginName})};e.dependencies={identityDataSource:n.identity};return e}();t.default=w;t.resourceKey=m.createResolvedResourceKey(e("module").id,w)});
define("odsp-next/providers/itemActivity/ItemActivityAggregator",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}e.process=function(e){for(var t=new Array,n=0;n<e.length;n++)this._addActivity(e[n],t);var r=t.length;if(!(0===r)){var i=t[r-1];if(1===i.type){var s=i;s.activities.length>1?this._sort(s.activities):this._downgrade(s.activities,t)}}return t};e._addActivity=function(e,t){var n=t.length,r=0===n,i=!1,s=null;if(!r&&(i=(s=t[n-1]).itemActivityChangeType!==e.itemActivityChangeType||s.date.toDateString()!==e.date.toDateString())&&1===s.type){var o=s;o.activities.length>1?this._sort(o.activities):this._downgrade(o.activities,t)}if(3!==e.itemActivityChangeType)t.push(e);else if(r||i){var u=this._create(e);t.push(u)}else this._update(s,e)};e._downgrade=function(e,t){if(1===e.length){t.pop();t.push(e[0])}};e._sort=function(e){e.sort(function(e,t){return e.date.getTime()<t.date.getTime()?1:e.date.getTime()>t.date.getTime()?-1:e.changeToken.localeCompare(t.changeToken)})};e._create=function(e){var t=new Array;e.editor.name&&t.push(e.editor);var n=new Array;n.push(e);return{activities:n,date:e.date,relativeTime:e.relativeTime,editors:t,itemActivityChangeType:e.itemActivityChangeType,type:1}};e._update=function(e,t){e.editors.some(function(e){var n=!0;for(var r in t.editor)n=n&&t.editor[r]===e[r];return n})||e.editors.push(t.editor);e.itemActivityChangeType=t.itemActivityChangeType;e.activities.push(t)};return e}();t.default=n});
define("odsp-next/bindings/toggle/ToggleBinding",["require","exports","knockout","../keyboard/KeyboardBinding"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.init=function(e,t,i,s,o){var u=t(),a={Enter:function(e){u(!u());return!1}},f=new r.default({element:e,bindingContext:o,allBindingsAccessor:i,valueAccessor:function(){return a}});n.applyBindingsToNode(e,f,o);n.applyBindingsToNode(e,{click:function(){return u(!u())}},o)};return e}();t.default=i});
define("odsp-next/controls/infoPane/SectionHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.shouldStartExpanded,i=void 0===r||r;n._shouldStartExpanded=i;n.showArrow=!1;n.isExpanded=n._getIsExpanded();return n}t.prototype._getIsExpanded=function(){var e=this,t=this.createObservable(this._shouldStartExpanded);return this.createComputed({read:function(){return!e.showArrow||t()},write:function(n){e.showArrow&&t(n)},pure:!0})};return t}(r.default);t.default=i});
define("odsp-next/controls/infoPane/sections/activitiesFeed/ActivitiesFeed.html",[],function(){return'<div class="InfoPane-section InfoPaneSection--activitiesfeed" data-bind="keyboard: keyNav.keyboardOptions, css: { \'is-expanded\': sectionHelper.isExpanded, \'no-arrow\': !sectionHelper.showArrow }, selection: { data: keyNav.focusableTiles, mode: \'single\', direction: \'vertical\', focused: keyNav.focusedItem }"><div class=InfoPane-sectionHeader id=od-ActivitiesFeed-sectionHeader data-bind="hasFocus: keyNav.sectionHeaderFocus, toggle: sectionHelper.isExpanded, attr: { \'aria-expanded\': sectionHelper.isExpanded(), tabindex: sectionHelper.showArrow ? 0 : -1, role: sectionHelper.showArrow ? \'button\' : \'\' }">\x3c!--ko if: sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon: true"></i>\x3c!--/ko--\x3e<h2 class=InfoPane-sectionHeaderText data-bind="text: resxStrings.ActivitiesHeader"></h2></div><div class=InfoPane-sectionContent role=tree data-bind="foreach: { data: tileCollections }"><div class="od-ActivitiesFeed-listTitle ms-font-s ms-fontColor-neutralSecondaryAlt ms-fontWeight-semibold" data-bind="text: title"></div><div class=od-ActivitiesFeed-list data-bind="foreach: { data: tiles }"><ms-item-activity-tile params="activity: $data"></ms-item-activity-tile></div></div><div class=InfoPane-sectionContent>\x3c!--ko if: isLoading()--\x3e<div class=od-ActivitiesFeed-loadingSpinnerFlat data-bind="component: {name: loadingSpinnerFlatTagName}"></div>\x3c!--/ko--\x3e\x3c!--ko if: !isLoading()--\x3e\x3c!--ko if: errorMessage()--\x3e<span class=ms-fontColor-error data-bind="text: errorMessage"></span>\x3c!--/ko--\x3e\x3c!--ko if: !errorMessage && !hasChanges()--\x3e<span class=ms-font-s data-bind="text: resxStrings.NoChange"></span>\x3c!--/ko--\x3e\x3c!--ko if: showForEarlierChangesMsg()--\x3e<span class="od-ActivitiesFeed-sectionForEarlierChanges ms-font-s" data-bind="bindableHtml: forEarlierChangesMsg, click: onFileVersionClick, clickBubble: false"></span>\x3c!--/ko--\x3e\x3c!--ko if: showSeeMore()--\x3e<a data-bind="click: onSeeMore, clickBubble: false, text: seeMoreText" href=#></a>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div></div>'});
define("odsp-next/controls/infoPane/sections/activitiesFeed/ActivitiesFeed.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ActivitiesFeed-sectionForEarlierChanges{margin-top:15px}"}])});
define("odsp-next/controls/itemActivityTile/ItemActivityTile",["require","exports","./ItemActivityTileViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ItemActivityTile.html","./ItemActivityTile.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-item-activity-tile",template:e("./ItemActivityTile.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/itemActivityTile/ItemActivityTileViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../bindings/html/BindableHtmlBinding","./ItemActivityTile.resx","../../bindings/scrollIntoView/ScrollIntoViewBinding","@ms/odsp-utilities/lib/string/StringHelper","../../bindings/toggle/ToggleBinding","@ms/odsp-shared/lib/utilities/knockout/Renderers","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({bindableHtml:s.default,scrollIntoView:u.default,toggle:f.default});n._navigation=n.resources.consume(h.navigation);n._platform=n.resources.consume(p.platformDetection);n.tile=t.activity;n._initObservables();n.accessibleLabel=n.createComputed(n._computeAccessibleLabel);n.expanded=r.observable(!1);n.isAggregate=!1;if(1===n.tile.type){n.isAggregate=!0;var i=n.tile;n.activities=i.activities}return n}t.prototype.onClick=function(e,t){if(e.navigateToOptions){this._navigation.navigateTo(e.navigateToOptions);var n={url:e.navigateToOptions.url,qosEventName:"RecentActivityItemLink",timeout:this._platform.isMobile?7e3:3e3};this._validateLink(n)}};t.prototype._validateLink=function(e){try{var t=new c.Qos({name:"NavigationLinkValidation"}),n=new XMLHttpRequest;n.open("GET",e.url,!0);e.timeout&&(n.timeout=e.timeout);n.onload=function(r){if(n.status>=200&&n.status<400){e.onComplete&&e.onComplete(n.status);t.end({resultType:c.ResultTypeEnum.Success,extraData:{source:e.qosEventName,httpCode:n.status}})}else{e.onError&&e.onError(n.status);t.end({resultCode:"LinkDoesNotExist",resultType:c.ResultTypeEnum.Failure,extraData:{source:e.qosEventName,httpCode:n.status}})}};n.ontimeout=function(n){e.onTimeout&&e.onTimeout();t.end({resultCode:"ValidationTimedOut",resultType:c.ResultTypeEnum.Failure,extraData:{source:e.qosEventName}})};n.send()}catch(n){e.onFailValidation&&e.onFailValidation();t.end({resultCode:"FailedToValidate",resultType:c.ResultTypeEnum.Failure,extraData:{source:e.qosEventName}})}};t.prototype._initObservables=function(){var e=this;if(1===this.tile.type){var t=this.tile;this.addDisposable(t.expanded.subscribe(function(t){e.expanded(t)}))}};t.prototype._computeAccessibleLabel=function(){var e,t=l.renderText(this,this.tile.headline),n=o.strings;0===this.tile.index?0===this.tile.type?e=n.FirstActivityAccessibleLabel:1===this.tile.type&&(e=n.FirstAggregateAccessibleLabel):e=1===this.tile.type?n.AggregateAccessibleLabel:n.ActivityAccessibleLabel;return a.format(e,t,this.tile.date)};return t}(i.default);t.default=d});
define("odsp-next/controls/itemActivityTile/ItemActivityTile.html",[],function(){return'<div class=od-ItemActivityTile-section data-bind="css: { \'is-expanded\': expanded }, scrollIntoView: { isSelected: tile.focused || expanded }"><div class="od-ItemActivityTile-sectionHeader ms-font-s" role=treeitem data-bind="attr: { \'aria-label\': accessibleLabel, \'aria-expanded\': expanded, tabindex: tile.index === 0 ? 0 : -1 }, css: { \'od-ItemActivityTile-sectionToggle\': isAggregate, \'od-ItemActivityTile-sectionFocused\': tile.focused }, hasFocus: tile.focused, toggle: expanded">\x3c!--ko if: isAggregate--\x3e<i class="od-ItemActivityTile-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon: true"></i>\x3c!--/ko--\x3e<div class=od-ItemActivityTile-entity data-bind="component: { name: \'od-persona\', params: { person: tile.editor, showName: false, personaSize: $component.personaSize, showPresence: false } }, attr: { \'aria-hidden\': true }"></div><div class=od-ItemActivityTile-details><span data-bind="bindableHtml: tile.headline" class=od-ItemActivityTile-headline></span> <span data-bind="text: tile.date" class="od-ItemActivityTile-date ms-fontColor-neutralSecondary"></span></div></div>\x3c!--ko if: isAggregate--\x3e<div data-bind="foreach: { data: activities, as: \'activity\' }" role=group><div class=od-ItemActivityTile-sectionContent data-bind="css: {\'od-ItemActivityTile-sectionFocused\': activity.focused }"><ms-item-activity-tile params="activity: activity"></ms-item-activity-tile></div></div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/itemActivityTile/ItemActivityTile.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:"[dir=ltr] .od-ItemActivityTile-section{padding-right:10px}[dir=rtl] .od-ItemActivityTile-section{padding-left:10px}html[dir=ltr] .od-ItemActivityTile-identity{float:left}html[dir=rtl] .od-ItemActivityTile-identity{float:right}[dir=ltr] .od-ItemActivityTile-identity{margin-right:5px}[dir=rtl] .od-ItemActivityTile-identity{margin-left:5px}.od-ItemActivityTile-sectionExpandButton{font-size:17px;position:absolute;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";width:32px;height:32px;line-height:32px;text-align:center;transition:transform 167ms cubic-bezier(.1,.9,.2,1)}[dir=ltr] .od-ItemActivityTile-sectionExpandButton{right:0}[dir=rtl] .od-ItemActivityTile-sectionExpandButton{left:0}.od-ItemActivityTile-section.is-expanded .od-ItemActivityTile-sectionExpandButton{-ms-transform:rotate(-180deg);transform:rotate(-180deg)}.od-ItemActivityTile-section .od-ItemActivityTile-sectionContent{display:none}.od-ItemActivityTile-section.is-expanded .od-ItemActivityTile-sectionContent{display:block}.od-ItemActivityTile-sectionHeader{padding:15px 0;min-height:40px}.od-ItemActivityTile-sectionContent{font-size:12px;min-height:40px}[dir=ltr] .od-ItemActivityTile-sectionContent{padding-left:25px}[dir=rtl] .od-ItemActivityTile-sectionContent{padding-right:25px}.od-ItemActivityTile-sectionToggle{cursor:pointer}.od-ItemActivityTile-sectionFocused{background-color:"},{theme:"themeLighterAlt",defaultValue:"#eff6fc"},{rawString:"}.od-ItemActivityTile-details{display:table}.od-ItemActivityTile-date{display:block}.odItemActivityTile-headline{display:block}.od-ItemActivityTile-entity{font-size:12px}html[dir=ltr] .od-ItemActivityTile-entity{float:left}html[dir=rtl] .od-ItemActivityTile-entity{float:right}.od-ItemActivityTile-entity .od-Persona{overflow:hidden;display:inline-block}.od-ItemActivityTile-entity .od-Persona.od-Persona--lg .od-Persona-image{width:40px;height:40px;line-height:40px}.od-ItemActivityTile-entity .od-Persona-details{display:none}.od-ItemActivityTile-ellipsisWrapper{white-space:nowrap}.od-ItemActivityTile-ellipsis{white-space:nowrap;max-width:130px;overflow:hidden;text-overflow:ellipsis;display:inline-block;vertical-align:text-bottom}.od-ItemActivityTile-ellipsis:hover{cursor:pointer}"}])});
define("odsp-next/controls/detailsPane/section/legacy/LegacySection",["require","exports","tslib","react","../../../../bindings/component/ControlBinding","../../../knockout/Knockout","@ms/odsp-utilities/lib/scope/Scope","./LegacySection.css"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._scope=new o.default;n._sectionParams={item:n.props.item};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.item!==this.props.item&&(this._sectionParams={item:e.item})};t.prototype.shouldComponentUpdate=function(e){return e.sectionControlKey!==this.props.sectionControlKey||e.resources!==this.props.resources||e.item!==this.props.item};t.prototype.componentWillUnmount=function(){this._scope.dispose()};t.prototype.render=function(){var e=this.props,t=e.sectionControlKey,n=e.resources,o=i.toSpecification(t,this._sectionParams);return r.createElement("div",{className:"od-DetailsPane-LegacySection"},r.createElement(s.default,{specification:o,resources:n}))};return t}(r.Component);t.default=u});
define("odsp-next/controls/detailsPane/section/legacy/LegacySection.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-DetailsPane-LegacySection .InfoPane-section{padding:12px 16px;margin:12px 0;width:auto;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-DetailsPane-LegacySection .InfoPane-sectionHeader{position:relative}.od-DetailsPane-LegacySection .InfoPane-sectionHeaderText{font-size:14px;font-weight:400}.isFluent .od-DetailsPane-LegacySection .InfoPane-sectionHeaderText{font-size:14px;font-weight:600;margin:0 0 8px}.od-DetailsPane-LegacySection .od-SharingSection-PermissionsPile{padding:12px 16px;margin:12px 0;width:auto}.od-DetailsPane-LegacySection .InfoPaneSection--properties{width:auto}.od-DetailsPane-LegacySection .InfoPane-sectionContent .od-ClientFormFields-field{padding:0;margin:12px 0}.od-DetailsPane-LegacySection .InfoPaneSection--activitiesfeed .InfoPane-sectionContent{margin-top:12px}.od-DetailsPane-LegacySection .InfoPaneSection--shortcutInformation{font-size:12px}.od-DetailsPane-LegacySection .InfoPaneSection--shortcutInformation .InfoPane-sectionHeader{display:none}.od-DetailsPane-LegacySection .od-PolicyTipSection.InfoPane-section{padding:0}.od-DetailsPane-LegacySection .od-PolicyTipSection.InfoPane-section .od-PolicyTipMessageBar{padding:12px 16px}.od-DetailsPane-LegacySection .od-PolicyTipSection.InfoPane-section .InfoPane-sectionContent{padding:12px 16px}"}])});
define("odsp-next/controls/detailsPane/section/itemExtractedText/ItemExtractedTextSection",["require","exports","tslib","react","../../../infoPane/sections/extractedText/ExtractedTextSection","../legacy/LegacySection"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return r.createElement(s.default,{sectionControlKey:i.resourceKey,item:t,resources:n})};return t}(r.Component);t.default=o});
define("odsp-next/controls/infoPane/sections/extractedText/ExtractedTextSection",["require","exports","./ExtractedTextSectionViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../../../bindings/component/ControlBinding","./ExtractedTextSection.html","./ExtractedTextSection.css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"ms-extracted-text-section",template:e("./ExtractedTextSection.html"),viewModel:n.default,synchronous:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"ms-extracted-text-section",name:e("module").id,template:e("./ExtractedTextSection.html"),viewModelType:n.default});t.default=s});
define("odsp-next/controls/infoPane/sections/extractedText/ExtractedTextSectionViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../../controls/infoPane/InfoPane.resx","../../../../bindings/toggle/ToggleBinding","../../../../providers/item/ItemProvider","../../../../models/item/EntityTagType","@ms/odsp-utilities/lib/logging/ErrorHelper","../../SectionHelper"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=i.strings,c=function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.addBindingHandlers({toggle:s.default});r.strings=l;var i=r.observables;r._itemProvider=r.resources.consume(o.resourceKey);r.sectionHelper=new(r.managed(f.default));r.extractedText=i.create("");r.extractedEmail=i.create("");r.extractedPhone=i.create("");r.extractedUrl=i.create("");r.currentExtractedText=i.create("");r.currentExtractedEmail=i.create("");r.currentExtractedPhone=i.create("");r.currentExtractedUrl=i.create("");r.sectionHeader=l.extractedTextHeader;r._item=t.item;i.compute(r._computeItemChanged);r.isSectionVisible=i.pureCompute(r._computeSectionVisible);return r}t.prototype._computeSectionVisible=function(){return!!(this.currentExtractedEmail()||this.currentExtractedPhone()||this.currentExtractedText()||this.currentExtractedUrl())};t.prototype._computeItemChanged=function(){var e=this,t=this._item();if(t){var n=t.ocr&&t.ocr.entityTags;if(n)for(var r=0,i=n;r<i.length;r++){var s=i[r],o=u.default[s.type];if(o===u.default.email){this.currentExtractedEmail(s.content);this.extractedEmail(s.content)}else if(o===u.default.url){this.currentExtractedUrl(s.content);this.extractedUrl(s.content)}else if(o===u.default.phone){this.currentExtractedPhone(s.content);this.extractedPhone(s.content)}}this._itemProvider.getItemOcrTextContent(t).then(function(t){e.currentExtractedText(t);e.extractedText(t)},function(e){a.default.log(e)})}};t.dependencies=n.__assign({},r.default.dependencies);return t}(r.default);t.default=c});
define("odsp-next/models/item/EntityTagType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.email=0]="email";e[e.url=1]="url";e[e.phone=2]="phone";e[e.text=3]="text";e[e.other=4]="other"}(n||(n={}));t.default=n});
define("odsp-next/controls/infoPane/sections/extractedText/ExtractedTextSection.html",[],function(){return'\x3c!--ko if: isSectionVisible--\x3e<div class="InfoPane-section InfoPaneSection--extractedText" data-bind="css: { \'is-expanded\': sectionHelper.isExpanded, \'no-arrow\': !sectionHelper.showArrow }"><div class=InfoPane-sectionHeader data-bind="toggle: sectionHelper.isExpanded, attr: { \'aria-expanded\': sectionHelper.isExpanded(), tabindex: sectionHelper.showArrow ? 0 : -1, role: sectionHelper.showArrow ? \'button\' : \'\' }">\x3c!--ko if: sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon: true"></i>\x3c!--/ko--\x3e<span class=InfoPane-sectionHeaderText data-bind="text: sectionHeader"></span></div><div class=InfoPane-sectionContent>\x3c!--ko if: currentExtractedEmail--\x3e<div class=InfoPane-extractedText-label data-bind="text: strings.extractedTextEmailTypeName"></div><p class=InfoPane-extractedText-content data-bind="text: extractedEmail"></p>\x3c!--/ko--\x3e\x3c!--ko if: currentExtractedUrl--\x3e<div class=InfoPane-extractedText-label data-bind="text: strings.extractedTextUrlTypeName"></div><p class=InfoPane-extractedText-content data-bind="text: extractedUrl"></p>\x3c!--/ko--\x3e\x3c!--ko if: currentExtractedPhone--\x3e<div class=InfoPane-extractedText-label data-bind="text: strings.extractedTextPhoneTypeName"></div><p class=InfoPane-extractedText-content data-bind="text: extractedPhone"></p>\x3c!--/ko--\x3e\x3c!--ko if: currentExtractedText--\x3e\x3c!--ko if: currentExtractedEmail() || currentExtractedUrl() || currentExtractedPhone()--\x3e<div class=InfoPane-extractedText-label data-bind="text: strings.extractedTextTextTypeName"></div>\x3c!--/ko--\x3e<p class=InfoPane-extractedText-content data-bind="text: extractedText"></p>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/infoPane/sections/extractedText/ExtractedTextSection.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".InfoPane-extractedText-content{margin-bottom:10px;display:block}.InfoPane-extractedText-label{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}"}])});
define("odsp-next/controls/detailsPane/section/itemInformation/ItemInformationSection",["require","exports","tslib","react","../../../infoPane/sections/information/react/InformationSectionWrapper"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return r.createElement(i.InformationSectionWrapper,{item:t,resources:n})};return t}(r.Component);t.default=s});
define("odsp-next/controls/infoPane/sections/information/react/InformationSectionWrapper",["require","exports","tslib","react","@ms/odsp-datasources/lib/Permissions","@ms/odsp-utilities/lib/scope/Scope","@ms/odsp-shared/lib/base/BaseModel","../../../../../actions/ChangeFolderTypeAction","../../../../../models/item/ItemParentHelper","../../../../../providers/fileHandler/FileHandlerProvider","../../../../../resources/DataSourceResourceKeys","./InformationSection"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._scope=new s.default;n._itemParentHelper=t.resources.consume(a.resourceKey);var r=t.resources.consume(o.observablesFactoryTypeResourceKey);n._observables=n._scope.attach(new r({owner:n}));n.state={item:t.item.peek(),resources:t.resources,isCustomList:n._computeIsCustomList(),isChangeFolderTypeActionAvailable:!1};n._changeFolderTypeAction=new(n._managed(u.default))({});return n}t.prototype.componentDidMount=function(){var e=this;this._itemStateObservableSubscriber=this._observables.subscribe(this.props.item,function(t){e._setItemState(t)})};t.prototype.componentWillUnmount=function(){this._scope.dispose()};t.prototype.UNSAFE_componentWillUpdate=function(e){var t=this;if(e.item!==this.props.item){this._itemStateObservableSubscriber.dispose();this._itemStateObservableSubscriber=this._observables.subscribe(e.item,function(e){t._setItemState(e)});this.setState({item:e.item.peek()})}};t.prototype.render=function(){var e=this.state.item.extension,t={item:this.state.item,isCustomList:this.state.isCustomList,isChangeFolderTypeActionAvailable:this.state.isChangeFolderTypeActionAvailable,isRecycleBin:this.state.resources.consume(l.url).isRecycleBin(this.state.item.queryType),isAnonymousUser:this.state.resources.consume(l.identity).getIdentity().type===i.IdentityType.anonymous,fileHandlerProviderFileTypeName:this.state.resources.consume(f.resourceKey.local).getFileTypeName(e)};return r.createElement(c.default,n.__assign({},t))};t.prototype._setItemState=function(e){this.setState({item:e,isCustomList:this._computeIsCustomList(),isChangeFolderTypeActionAvailable:this._changeFolderTypeAction.isAvailable()})};t.prototype._computeIsCustomList=function(){var e=this._observables.unwrap(this._itemParentHelper.getFacetedAncestorOrSelf(this.props.item(),"list"));return!!e&&!e.list.isDocumentLibrary};t.prototype._managed=function(e){this.state.resources&&(e=this.state.resources.injected(e));return this._scope.attached(e)};return t}(r.PureComponent);t.InformationSectionWrapper=h});
define("odsp-next/controls/infoPane/sections/information/react/InformationSection",["require","exports","tslib","react","@ms/odsp-utilities/lib/dateTime/DateTime","@ms/odsp-utilities/lib/string/DriveSpaceHelper","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/string/TimeFormatter","../../../../../controls/infoPane/InfoPane.resx","../../../../../dataSources/url/QueryType","../../../../../models/item/FolderCategory","../../../../../models/item/ItemType","../../../../../models/item/ItemHelper","./entries/Basic","./entries/Iterable","../InformationSection.css","../../../InfoPaneReact.css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement("div",{className:"od-InfoPane-ReactSections"},r.createElement("div",{className:"InfoPane-section is-expanded InfoPaneSection--information"},r.createElement("div",{className:"InfoPane-sectionHeader"},r.createElement("i",{className:"InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown"}),r.createElement("h2",{className:"InfoPane-sectionHeaderText"})),r.createElement("div",{className:"InfoPane-sectionContent"},r.createElement("dl",{className:"InfoPaneSection-informationBody"},this._createMap()))))};t.prototype._createMap=function(){return this.props.allEntries.map(function(e,t){return"string"==typeof e.value?r.createElement(p.default,{key:t,title:e.title,value:e.value,condition:e.condition,className:e.className}):r.createElement(d.default,{key:t,title:e.title,value:e.value,condition:e.condition,className:e.className})})};return t}(r.PureComponent);t.InformationSectionRender=v;var m=a.strings,g=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(v,{allEntries:this._computeAllEntries()})};t.prototype._computeAllEntries=function(){var e=this.props.isAnonymousUser?"":this._computePath(),t=[{title:m.informationFiletype,value:this._computeFileType()},{title:m.informationFolderType,value:this._computeFolderType(),condition:this._computeIsFolderTypeVisible(),className:"InfoPaneSection-information-folderType"},{title:m.informationVisitorViews,value:this._computeVisitorViews()},{title:m.informationDateTaken,value:this._computeDateTaken()},{title:m.informationDimensions,value:this._computeDimensions()},{title:m.informationDuration,value:this._computeDuration()},{title:m.informationBitrate,value:this._computeBitRate()},{title:m.informationCamera,value:this._computeCamera()},{title:m.informationShot,value:this._computeShot()},{title:m.informationTitle,value:this._computeTitle()},{title:m.informationAlbum,value:this._computeAlbum()},{title:m.informationAlbumArtist,value:this._computeAlbumArtist()},{title:m.informationArtist,value:this._computeArtist()},{title:m.informationTrack,value:this._computeTrack()},{title:m.informationDisc,value:this._computeDisc()},{title:m.informationComposers,value:this._computeComposers()},{title:m.informationGenre,value:this._computeGenre()},{title:m.informationYear,value:this._computeYear()},{title:m.informationCopyright,value:this._computeCopyright()},{title:m.informationLocations,value:this._computeLocations()},{title:m.informationModified,value:this._computeModified()},{title:m.informationDeleted,value:this._computeDeleted()},{title:m.informationAddedBy,value:this._computeAddedBy()},{title:m.informationDateCreated,value:this._computeCreated()},{title:m.informationDateShared,value:this._computeDateShared()},{title:m.informationPath,value:e,className:"InfoPaneSection-information-path"},{title:m.informationOriginalLocation,value:this._computeOriginalLocation()},{title:m.informationSize,value:this._computeSize()},{title:m.informationPanoramaResolution,value:this._computePanoramaResolution()},{title:m.informationPanoramaRange,value:this._computePanoramaRange()}];return this._filterEntry(t)};t.prototype._filterEntry=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];("condition"in i?i.condition:i.value&&i.value.length>0)&&t.push(i)}return t};t.prototype._computeTitle=function(){var e=this.props.item.audio;return e&&e.title};t.prototype._computeAlbum=function(){var e=this.props.item.audio;return e&&(e.album||m.informationUnknownAlbum)};t.prototype._computeAlbumArtist=function(){var e=this.props.item.audio;return e&&e.albumArtist};t.prototype._computeArtist=function(){var e=this.props.item.audio;return e&&(e.artist||m.informationUnknownArtist)};t.prototype._computeTrack=function(){var e=this.props.item.audio,t=e&&e.track,n=e&&e.trackCount;return t?n?o.format(m.informationTrackAndDiscFormat,t,n):""+t:""};t.prototype._computeDisc=function(){var e=this.props.item.audio,t=e&&e.disc,n=e&&e.discCount;if(e&&(t>1||n>1))return n>=t?o.format(m.informationTrackAndDiscFormat,t,n):t&&""+t};t.prototype._computeComposers=function(){var e=this.props.item.audio;return e&&e.composers};t.prototype._computeGenre=function(){var e=this.props.item.audio;return e&&e.genre};t.prototype._computeYear=function(){var e=this.props.item.audio;return e&&e.year&&""+e.year};t.prototype._computeCopyright=function(){var e=this.props.item.audio;return e&&e.copyright};t.prototype._computeFileType=function(){var e=this.props.item;if(!e.isBundle&&void 0===e.virtualItemType){var t=e.extension&&this.props.fileHandlerProviderFileTypeName;return h.getFriendlyItemType(e,this.props.isCustomList,t)}};t.prototype._computeIsFolderTypeVisible=function(){var e=this.props.item;return e.type===c.default.Folder&&!e.isBundle&&!e.isSpecialFolder&&(!e.vault||!e.vault.isLocked)&&void 0===e.virtualItemType&&this.props.isChangeFolderTypeActionAvailable};t.prototype._computeDateTaken=function(){var e=this.props.item,t=(e.photo||e.video)&&e;return t?t.dateTakenTime?i.getFullDisplayDate(t.dateTakenTime,!0):t.dateTaken:""};t.prototype._computeFolderType=function(){switch(this.props.item.category){case l.default.documents:return m.informationFolderTypeDocuments;case l.default.photos:return m.informationFolderTypePhotos;case l.default.favorites:return m.informationFolderTypeFavorites}return""};t.prototype._computeVisitorViews=function(){var e=this.props.item.statistics.views;return e&&""+e};t.prototype._computeDimensions=function(){var e=this.props.item,t=e.video||!e.panorama&&e.photo||{},n=t.width,r=t.height;return n&&r?o.format(m.informationDimensionsFormat,n,r):""};t.prototype._computeDuration=function(){var e=this.props.item.video,t=e&&e.duration;return t>0?u.formatTime(t):""};t.prototype._computeBitRate=function(){var e=this.props.item.video,t=e&&e.bitrate;if(t){var n=t>1e6?"Mega":"Kilo",r=t>1e6?1e6:1e3;return o.format(m["information"+n+"BitrateFormat"],Math.floor(t/r))}};t.prototype._computeCamera=function(){var e=this.props.item,t=e.photo,n=e.video;return t&&t.cameraModel||n&&n.cameraModel};t.prototype._computeShot=function(){var e=this.props.item.photo;if(e){var t=e.exposureNumerator,n=e.exposureDenominator,r=t&&""+t;n&&1!==n&&(r=o.format(m.informationShotExposureFormat,t,n));var i=e.focalRatio?""+e.focalRatio:"";i=i&&o.format(m.informationShotFStopFormat,i);var s=e.focalLength?""+e.focalLength:"";return[r,i,s=s&&o.format(m.informationShotFocalLengthFormat,s)].join(" ").trim()}};t.prototype._computeLocations=function(){var e=this.props.item.locations;if(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];i&&t.push(i)}return t}};t.prototype._computeModified=function(){var e=this.props.item,t=e.dateModified&&e.dateModified.trim().length>0;if(!this.props.isRecycleBin&&t)return e.dateModifiedTime?i.getFullDisplayDate(e.dateModifiedTime):e.dateModified};t.prototype._computeDeleted=function(){var e=this.props.item;if(this.props.isRecycleBin)return e.dateDeletedTime?i.getFullDisplayDate(e.dateDeletedTime):e.dateDeleted};t.prototype._computeAddedBy=function(){return this.props.item.creatorName};t.prototype._computeCreated=function(){var e=this.props.item;return e.dateCreatedTime?i.getFullDisplayDate(e.dateCreatedTime):e.dateCreated};t.prototype._computeDateShared=function(){var e=this.props.item;return e.dateSharedTime?i.getFullDisplayDate(e.dateSharedTime):e.dateShared};t.prototype._computePath=function(){var e=this.props.item;if(!e.audio&&e.parent&&!this.props.isRecycleBin){for(var t=[],n=e;n;n=n.parent)t.unshift(n.name);return t}};t.prototype._computeOriginalLocation=function(){var e=this.props.item;if(this.props.isRecycleBin||e.queryType===f.default.Search||e.queryType===f.default.SharedWithMe)return e.location};t.prototype._computeSize=function(){var e=this.props.item;return e.size&&s.default.getDisplayString(e.size,{ignoreZero:!0})};t.prototype._computePanoramaResolution=function(){var e=this.props.item.panorama,t=e&&e.resolution;if(t)return o.format(m.informationPanoramaResolutionFormat,t)};t.prototype._computePanoramaRange=function(){var e=this.props.item.panorama||{},t=e.horizontalFov,n=e.verticalFov;if(t&&n)return o.format(m.informationPanoramaRangeFormat,Math.round(t),Math.round(n))};return t}(r.Component);t.default=g});
define("odsp-next/controls/infoPane/sections/information/react/entries/Basic",["require","exports","tslib","react"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.title,n=e.value,i=e.className;return r.createElement(r.Fragment,null,r.createElement("dt",null,t),r.createElement("dd",{className:i},n))};return t}(r.PureComponent);t.InformationSectionBasicEntry=i;t.default=i});
define("odsp-next/controls/infoPane/sections/information/react/entries/Iterable",["require","exports","tslib","react"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.title;return r.createElement(r.Fragment,null,r.createElement("dt",null,e),r.createElement("dd",null,this._createMap()))};t.prototype._createMap=function(){var e=this;return this.props.value.map(function(t,n){return r.createElement("div",{key:n,className:e.props.className},t)})};return t}(r.PureComponent);t.InformationSectionIterableEntry=i;t.default=i});
define("odsp-next/controls/infoPane/sections/information/InformationSection.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".InfoPaneSection-informationBody{margin:0}.InfoPaneSection-informationBody dt{margin-bottom:3px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:12px}.InfoPaneSection-informationBody dd{margin:0 0 16px 0;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:14px}.InfoPaneSection-information-folderType{display:inline}.InfoPaneSection-information-changeFolderType{margin-left:10px;margin-right:10px;text-decoration:none}.InfoPaneSection-information-changeFolderType:visited{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.InfoPaneSection-information-path{display:inline;word-break:break-all}.InfoPaneSection-information-path:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";padding:0 5px;font-size:8px;font-weight:800;content:'\\E76C'}.InfoPaneSection-information-path:last-child:after{content:'';display:none}html[dir=rtl] .InfoPaneSection-information-path:after{content:'\\E76B'}.od-DetailsPane-LegacySection .InfoPaneSection-informationBody dd{margin-bottom:12px}.od-DetailsPane-LegacySection .InfoPaneSection--information .InfoPane-sectionHeader{display:none}.od-InfoPane-ReactSections .InfoPaneSection-informationBody dd{margin-bottom:12px}.od-InfoPane-ReactSections .InfoPaneSection--information .InfoPane-sectionHeader{display:none;padding:12px 16px}"}])});
define("odsp-next/controls/infoPane/InfoPaneReact.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-InfoPane-ReactSections .InfoPane-section{padding:12px 16px;margin:12px 0;width:auto;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-InfoPane-ReactSections .InfoPane-sectionHeader{position:relative}.od-InfoPane-ReactSections .InfoPane-sectionHeaderText{font-size:14px;font-weight:400}.isFluent .od-InfoPane-ReactSections .InfoPane-sectionHeaderText{font-size:14px;font-weight:600;margin:0 0 8px}.od-InfoPane-ReactSections .od-SharingSection-PermissionsPile{padding:12px 16px;margin:12px 0;width:auto}.od-InfoPane-ReactSections .InfoPaneSection--properties{width:auto}.od-InfoPane-ReactSections .InfoPane-sectionContent .od-ClientFormFields-field{padding:0;margin:12px 0}.od-InfoPane-ReactSections .InfoPaneSection--activitiesfeed .InfoPane-sectionContent{margin-top:12px}.od-InfoPane-ReactSections .InfoPaneSection--shortcutInformation{font-size:12px}.od-InfoPane-ReactSections .InfoPaneSection--shortcutInformation .InfoPane-sectionHeader{display:none}.od-InfoPane-ReactSections .od-PolicyTipSection.InfoPane-section{padding:0}.od-InfoPane-ReactSections .od-PolicyTipSection.InfoPane-section .od-PolicyTipMessageBar{padding:12px 16px}.od-InfoPane-ReactSections .od-PolicyTipSection.InfoPane-section .InfoPane-sectionContent{padding:12px 16px}"}])});
define("odsp-next/controls/detailsPane/section/itemPreview/ItemPreviewSection",["require","exports","tslib","react","../../../infoPane/sections/preview/PreviewSection","../legacy/LegacySection","./ItemPreviewSection.css"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return r.createElement("div",{className:"od-DetailsPane-ItemPreviewSection"},r.createElement(s.default,{sectionControlKey:i.resourceKey,item:t,resources:n}))};return t}(r.Component);t.default=o});
define("odsp-next/controls/infoPane/sections/preview/PreviewSection",["require","exports","./PreviewSectionViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../../../bindings/component/ControlBinding","./PreviewSection.html","./PreviewSection.css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"od-infoPane-preview",template:e("./PreviewSection.html"),viewModel:n.default,synchronous:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"od-infoPane-preview",name:e("module").id,template:e("./PreviewSection.html"),viewModelType:n.default});t.default=s});
define("odsp-next/controls/infoPane/sections/preview/PreviewSectionViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../../bindings/clientRect/ClientRectBinding","@ms/odsp-shared/lib/base/Rotation","../../../iFrameCtrl/IFrameCtrl","../../../image/frame/ImageFrame","../../../folderCoverTile/FolderCoverTile","../../../../controls/fileHoverCard/react/AnalyticsActionBar","../../../../controls/malwareDetected/malwareDetectedMessage/MalwareDetectedMessage","../../../../bindings/react/ReactBinding","../../../../utilities/features/Features","../../../../models/item/ItemType"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r._item=t.item;r.addBindingHandlers({clientRect:i.default,react:c.default});var s=r.observables;r.size=s.create();r._thumbnailError=s.create();r._imageSize=s.pureCompute(r._computeImageSize);r._thumbnail=s.pureCompute(r._computeThumbnail);r._rotation=s.pureCompute(r._computeRotation);r._hasThumbnailError=s.pureCompute(r._computeHasThumbnailError);r._isImage=s.pureCompute(r._computeIsImage);r._isFolder=s.pureCompute(r._computeIsFolder);r._iframeUrl=s.pureCompute(r._computeIFrameUrl);r._isIFrame=s.pureCompute(r._computeIsIFrame);r._isItemMalicious=s.pureCompute(r._computeItemMalicious);r.component=s.pureCompute(r._computeComponent);r.analyticsActionBarComponent=f.default;r.analyticsActionBarProps=r.createPureComputed(r._updateAnalyticsActionBarProps);r.enableAnalyticsActionBar=r.createPureComputed(r._computeAnalyticsActionBarAvailable);r.malwareDetectedMessageComponent=l.malwareDetectedMessage;r.isMalwareDetectedMessageVisible=r.createPureComputed(r._computeIsMalwareDetectedMessageVisible);return r}t.prototype._computeAnalyticsActionBarAvailable=function(){return h.isFeatureEnabled(h.ItemAnalyticsUX)&&this._item().type!==p.default.Folder};t.prototype._updateAnalyticsActionBarProps=function(){return{item:this._item(),resources:this.resources}};t.prototype._computeComponent=function(){if(!this._isItemMalicious()){if(this._isIFrame())return{name:o.default.tagName,params:{title:"",url:this._iframeUrl,isExcludeFromScreenReader:!0}};if(this._isFolder())return{name:a.default.tagName,params:{item:this._item,imageRect:this._imageSize}};if(this._isImage())return{name:u.default.tagName,params:{image:this._thumbnail,rotation:this._rotation,desiredSize:this._imageSize,alignment:["fitWidth","top"],error:this._thumbnailError}}}};t.prototype._computeIsFolder=function(){var e=this._item();return!(!e||!e.folder)};t.prototype._computeIFrameUrl=function(){var e=this._item();return e&&e.previewIFrameUrl};t.prototype._computeIsIFrame=function(){return!!this._iframeUrl()};t.prototype._computeThumbnail=function(){var e=this._item();return e&&(e.orientedThumbnail||e).thumbnail};t.prototype._computeRotation=function(){var e=this._item(),t=e&&e.orientedThumbnail;return t?t.rotation:s.default.none};t.prototype._computeIsImage=function(){return!!this._thumbnail()&&!this._hasThumbnailError()};t.prototype._computeHasThumbnailError=function(){return this._hasThumbnailError.peek()||!!this._thumbnailError()};t.prototype._computeImageSize=function(){var e=this.size();return{width:e&&e.width||319,height:180}};t.prototype._computeItemMalicious=function(){var e=this._item();return e&&e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected};t.prototype._computeIsMalwareDetectedMessageVisible=function(){return!!h.isFeatureEnabled(h.EnableATPFilesListView)&&this._computeItemMalicious()};t.dependencies=n.__assign({},r.default.dependencies);return t}(r.default);t.default=d});
define("odsp-next/controls/iFrameCtrl/IFrameCtrl",["require","exports","./IFrameCtrlViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./IFrameCtrl.html","./IFrameCtrl.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-iframe",template:e("./IFrameCtrl.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/iFrameCtrl/IFrameCtrlViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=n.observables;n.url=r.wrap(t.url);n.title=r.wrap(t.title);var i=t.isExcludeFromScreenReader;n.tabindex=i?"-1":null;n.role=i?"presentation":null;n._isEmailAttestationPage=r.create(!1);n.isVisible=r.pureCompute(n._computeIsVisible);n.isTitleVisible=r.pureCompute(n._computeIsTitleVisible);n.iframeOnLoad=function(e,r){try{r.target.contentWindow.location.href.toLowerCase().indexOf("emailattestation.aspx")>-1&&n._isEmailAttestationPage(!0)}catch(r){}t.onload&&t.onload(r)};return n}t.prototype._computeIsVisible=function(){return!!this.url()&&!this._isEmailAttestationPage()};t.prototype._computeIsTitleVisible=function(){return!!this.title()};return t}(r.default);t.default=i});
define("odsp-next/controls/iFrameCtrl/IFrameCtrl.html",[],function(){return'\x3c!--ko if: isVisible--\x3e<div class=IFrame>\x3c!--ko if: title--\x3e<div class=ms-IFrameCtrl-title data-bind="text: title"></div>\x3c!--/ko--\x3e<iframe class=ms-IFrameCtrl-iFrame data-bind="attr: {src: url, role: role, tabindex: tabindex}, event: {load: iframeOnLoad}"></iframe></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/iFrameCtrl/IFrameCtrl.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ms-IFrameCtrl-title{font-size:17px}.ms-IFrameCtrl-iFrame{width:100%;border:0;min-height:200px}"}])});
define("odsp-next/controls/fileHoverCard/react/AnalyticsActionBar",["require","exports","tslib","react","knockout","@ms/shared-react-item-hover-card/lib/index","../../../dataSources/itemAnalytics/store/FileHoverCardStore","../../../resources/ControlResourceKeys","../../../dataSources/url/QueryType","../../../resources/DataSourceResourceKeys","../../../providers/engagement/Engagement","../../sharing/share/commands/ShareCommandBuilder","./FileHoverCardHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.getAccessToken=function(){return h.getGraphAccessToken(n.state.graphDataSource,n.props.item)};n.onView=function(e){n._engagement.logData({name:"DetailsPane.AnalyticsActionBar.ViewClick"});new(n.resources.injected(n.actionMap.ShowItemAnalyticsAction))({item:i.observable(n.props.item)}).execute(e)};n.resources=t.resources;n.state={fileHoverCardStore:n.resources.consume(o.resourceKey.optional),graphDataSource:n.resources.consume(f.graph.optional)};n.actionMap=n.resources.consume(u.actionMap);n._engagement=n.resources.consume(l.resourceKey);return n}t.prototype.componentDidMount=function(){var e=this;this.resources.consumeAsync(o.resourceKey).then(function(t){e.setState({fileHoverCardStore:t})});this.resources.consumeAsync(f.graph).then(function(t){e.setState({graphDataSource:t})})};t.prototype.render=function(){var e=this.state,t=e.fileHoverCardStore,n=e.graphDataSource,i=h.getGraphItemUrl(n,this.props.item),s={itemId:this.props.item.itemId,graph:this.props.item.graph,extension:this.props.item.extension,queryType:a.default[this.props.item.queryType],graphItemUrl:i,getAccessToken:this.getAccessToken};return r.createElement("div",{className:"AnalyticsActionBarField"},t&&n&&h.shouldEnableFileHoverCard(this.props.item,this.resources)&&r.createElement(d,{item:s,fileHoverCardStore:t,onView:this.onView,actionBarItems:[],isViewCountClickable:!0}))};t.prototype.onShare=function(e){this._engagement.logData({name:"DetailsPane.AnalyticsActionBar.ShareClick"});new(this.resources.injected(this.actionMap.SelectAction))({item:i.observable(this.props.item),showProperties:!1}).execute(e);new(this.resources.injected(this.actionMap.ShowShareAction))({focusItemResourceKey:c.shareFocusItemResourceKey}).execute(e)};return t}(r.Component);t.default=p;var d=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.state={itemAnalyticsResult:n.props.fileHoverCardStore.getItemAnalytics(n.props.item)};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.item!==this.props.item&&this.setState({itemAnalyticsResult:this.props.fileHoverCardStore.getItemAnalytics(e.item)})};t.prototype.componentDidMount=function(){this._addListener()};t.prototype.componentDidUpdate=function(e){var t=this.props.fileHoverCardStore;if(this.props.item.itemId!==e.item.itemId){t.removeListener(this._storeListener,e.item);this._addListener()}};t.prototype.componentWillUnmount=function(){this.props.fileHoverCardStore.removeListener(this._storeListener,this.props.item)};t.prototype.render=function(){var e=this.state.itemAnalyticsResult,t={itemAnalytics:e&&e.data,onClick:this.props.onView,isNotSupported:!1,status:e&&e.status,isCompact:!0,disableViewerCount:this.props.isViewCountClickable,isLink:this.props.isViewCountClickable},n=t&&t.itemAnalytics;return r.createElement("div",{className:"AnalyticsActionBar--item"},n?r.createElement(s.AnalyticsActionBar,{analyticsStats:t,items:this.props.actionBarItems,isLink:this.props.isViewCountClickable,showActionBar:!1,farItems:[]}):null)};t.prototype._addListener=function(){var e=this,t=this.props.fileHoverCardStore;this._storeListener=t.addListener(function(){e.setState({itemAnalyticsResult:t.getItemAnalytics(e.props.item)})},this.props.item);t.fetchItemAnalytics(this.props.item)};return t}(r.Component);t.AnalyticsActionBarWrap=d});
define("odsp-next/controls/infoPane/sections/preview/PreviewSection.html",[],function(){return'\x3c!--ko if: component--\x3e<div class=InfoPaneSection--preview data-bind="clientRect: { size: size }, component: component"></div>\x3c!--ko if: enableAnalyticsActionBar--\x3e<div class=InfoPaneSection--viewCountLink data-bind="react: { componentType: analyticsActionBarComponent, props: analyticsActionBarProps }"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});
define("odsp-next/controls/infoPane/sections/preview/PreviewSection.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".InfoPaneSection--preview{width:auto;height:180px;position:relative;margin-bottom:8px}.InfoPaneSection--preview .od-ImageStack-tile{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.InfoPaneSection--preview .ms-IFrameCtrl-iFrame{min-height:180px;height:180px}.InfoPaneSection--viewCountLink{font-size:14px}.InfoPaneSection--viewCountLink .AnalyticsActionBarField{padding:5px 20px}.InfoPaneSection--viewCountLink .AnalyticsActionBarField .AnalyticsActionBar--item{height:40px}.InfoPaneSection--viewCountLink .AnalyticsActionBarField .AnalyticsActionBar--notSupported{height:0}"}])});
define("odsp-next/controls/detailsPane/section/itemPreview/ItemPreviewSection.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-DetailsPane-ItemPreviewSection{margin:0 0 12px 0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-DetailsPane-ItemPreviewSection .InfoPaneSection--preview{margin-bottom:0}.od-DetailsPane-ItemPreviewSection .InfoPaneSection--viewCountLink{padding:4px 16px}.od-DetailsPane-ItemPreviewSection .InfoPaneSection--viewCountLink .AnalyticsActionBarField{padding:0}.od-DetailsPane-ItemPreviewSection .InfoPaneSection--viewCountLink .AnalyticsActionBarField .AnalyticsActionBar--item{height:auto;padding:0}.od-DetailsPane-ItemPreviewSection .InfoPaneSection--viewCountLink .AnalyticsActionBarField .AnalyticsActionBar--item .ms-AnalyticsStats--stats{height:auto;padding:0}"}])});
define("odsp-next/controls/detailsPane/section/itemProperties/ItemPropertiesSection",["require","exports","tslib","react","../../../infoPane/sections/properties/PropertiesSection","../legacy/LegacySection"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return r.createElement(s.default,{sectionControlKey:i.resourceKey,item:t,resources:n})};return t}(r.Component);t.default=o});
define("odsp-next/controls/infoPane/sections/properties/PropertiesSection",["require","exports","./PropertiesSectionViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../../../bindings/component/ControlBinding","./PropertiesSection.html","./PropertiesSection.css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"ms-properties-section",template:e("./PropertiesSection.html"),viewModel:n.default,synchronous:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"ms-properties-section",name:e("module").id,template:e("./PropertiesSection.html"),viewModelType:n.default});t.default=s});
define("odsp-next/controls/infoPane/sections/properties/PropertiesSectionViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../../controls/clientForm/DuplexClientForm","../../../../providers/clientForm/ClientFormProvider","../../../../models/item/ItemParentHelper","../../../../bindings/toggle/ToggleBinding","../../../loadingSpinner/LoadingSpinner","../../InfoPane.resx","../../notification/SectionNotification","../../../../utilities/features/Features","../../../../resources/LoggingResourceKeys","../../../../actions/splist/EditItemAction","../../../../models/item/ItemType","@ms/odsp-utilities/lib/string/StringHelper","../../SectionHelper","../../../../actions/base/ItemSelectionHelper","../../../../providers/engagement/Engagement","../../../refreshClientForm/RefreshClientForm.key","@ms/sp-experiments/lib/flightsonrails/SPExperiment","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-utilities/lib/killswitch/Killswitch","../../../../resources/SPOResourceKeys","../../../../actions/odb/ActionHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var N=f.strings,C=function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r._handleRefreshClientForm=function(){r._refreshClientForm(!1);r._updateProperties(!0)};r.sectionHelper=new(r.managed(m.default));r.loadingSpinnerTagName=a.default.tagName;r.clientFormEditLink=N.clientFormEditLink;r.sectionNotificationTagName=l.default.tagName;r.sectionNotificationIconLabel=N.sectionNotificationIconAriaLabel;var i=r,f=i.observables,d=i.resources,v=n.itemParentHelper,y=void 0===v?d.consume(o.resourceKey):v,w=n.clientFormProvider,E=void 0===w?d.consume(s.resourceKey):w,S=n.itemSelectionHelperType,T=void 0===S?d.consume(g.typeResourceKey):S,C=n.rumOneHelper,k=void 0===C?d.consume(h.rumOneHelper):C,L=n.listContext,A=void 0===L?d.consume(x.listContext):L;r._listContext=A;r._itemParentHelper=y;r._itemSelectionHelper=new(r.scope.attached(T))({allowMultiSelect:!0,canFallback:!0});r._editItemAction=new(r.managed(p.default))({item:r._itemSelectionHelper.firstItem});r._isDocLib=f.pureCompute(r._computeIsDocLib);r.clientForm=f.create();r._serverError=f.create();r.canEdit=f.pureCompute(r._computeCanEdit);r.isLoading=f.pureCompute(r._computeIsLoading);r.propertiesErrorMessage=f.pureCompute(r._computePropertiesErrorMessage);r.clientFormTitle=f.pureCompute(r._computeTitle);r._useDocSetsModernView=c.isFeatureEnabled(c.DocumentSetsModernView)&&c.isFeatureEnabled(c.UseItemsScopeInTeamSites);r.addBindingHandlers({toggle:u.default});r._rumOneHeler=k;r._clientFormProvider=E;f.compute(r._updateProperties);r._refreshClientForm=r.resources.consume(b.resourceKey);r.scope.attach(r._refreshClientForm.subscribe(r._handleRefreshClientForm));r._pageContext=d.consume(x.pageContext);return r}t.prototype.onEditClick=function(e){this._editItemAction.execute(e)};Object.defineProperty(t.prototype,"_item",{get:function(){return this._itemSelectionHelper.firstItem},enumerable:!0,configurable:!0});t.prototype._computeTitle=function(){var e=this._itemSelectionHelper.selection();return e&&e.length>1?N.bulkEditClientFormTitle:N.clientFormTitle};t.prototype._computeIsLoading=function(){return!this._serverError()&&!this.clientForm()&&!this._isQuickEditDisabled()};t.prototype._computeCanEdit=function(){return!this._serverError()&&this._editItemAction&&this._editItemAction.isAvailable()&&!this._isBulkEdit()};t.prototype._computeIsDocLib=function(){var e=this._item(),t=e&&this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return!t||!t.list||!!t.list.isDocumentLibrary};t.prototype._computePropertiesErrorMessage=function(){var e=this._serverError();if(e){var t=e&&e.message&&(e.message.value||e.message);return t?v.format(N.propertiesNotificaiton_serverErrorWithDetails,t):N.propertiesNotificaiton_serverErrorNoDetails}var n=this._item();if(n&&n.type!==d.default.Folder){var r=n.hasMissingMetadata,i=this.clientForm(),s=i&&i.params.clientForm;if(s&&s.contentType){r=!1;for(var o=0,u=s.fields;o<u.length;o++){var a=u[o];if(a&&a.schema){var f=a.schema;if(f.Required&&n.properties&&!n.properties[f.Name]){r=!0;break}}}}if(r)return this._isDocLib()?N.propertiesNotificaiton_missingMetadata_file:N.propertiesNotificaiton_missingMetadata_item;if(this._isDocLib())return this._publishingReminderText(n)}return""};t.prototype._publishingReminderText=function(e){var t=T.default.getVersion(e,this._listContext);if(!t||0===t.minor)return"";if(T.default.needsPublishingReminder(e,this._listContext)){var n=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")),r=n&&n.list&&(119===n.list.templateType||850===n.list.templateType)?N.page:N.file,i=0===t.major?N.publish:N.republish,s=!!this._listContext.isModerated;if(S.Killswitch.isActivated("8273e7a4-631b-482e-8d88-1a09350cddd8","8/15/2019","Publishing banner experiment"))return"";switch(w.getVariantAndLogExposure(90010,this._pageContext)){case 1:E.Engagement.logData({name:"PropertiesBanner.PublishingReminder.Shown"});return s?v.format(N.propertiesNotification_submitApproval,r):v.format(N.propertiesNotificaiton_publishing,i,r);default:return""}}return""};t.prototype._updateProperties=function(e){var t=this,n=this._isBulkEdit(),r=this._itemSelectionHelper.selection.peek(),s=this._item.peek();if(s&&this._lastUpdateClientFormParams&&this._lastUpdateClientFormParams.isBulkEdit===n&&!e)if(n){var o=this._clientFormProvider.getContentInfoTypes(this._lastUpdateClientFormParams),u=this._getClientFormParms(this._item,n,r),a=this._clientFormProvider.getContentInfoTypes(u);if(o.length===a.length){for(var f=!1,l=0;l<o.length;l++)if(o[l].contentType!==a[l].contentType||o[l].contentTypeId!==a[l].contentTypeId){f=!0;break}if(!f)return}}else if(s.properties&&this._lastUpdateClientFormParams&&this._lastUpdateClientFormParams.item&&this._lastUpdateClientFormParams.item.peek().properties&&s.properties.ID===this._lastUpdateClientFormParams.item.peek().properties.ID&&null!==this.clientForm.peek())return;n||(this._editItemAction=new(this.managed(p.default))({item:this._item}));this._rumOneHeler&&this._rumOneHeler.logPropertiesPaneUpdate();this.clientForm(void 0);this._serverError(void 0);this.async.setImmediate(function(){var n=t._item.peek(),s=t._isBulkEdit();if(n){t._lastUpdateClientFormParams=t._getClientFormParms(t._item,s,r);t._clientFormProvider.getClientForm(t._lastUpdateClientFormParams,e).done(function(e){var n=s?"BulkEditForm.Render":"EditForm.Render";t.resources.consume(y.resourceKey).logData({name:n,isIntentional:!0});t.clientForm({name:i.getClientFormTagName(e,t.resources),params:{clientForm:e,interactiveSave:!s,isInfoPane:!0,isReadOnly:!s&&t._isQuickEditDisabled(),suppressDefaultSaveBehavior:!0}})},function(e){t._serverError(e)})}else t._lastUpdateClientFormParams=void 0})};t.prototype._isQuickEditDisabled=function(){for(var e=this._item&&this._item.peek(),t=!1;e;){if(e.list){t=!!e.list.disableGridEditing;break}e=e.parent}if(!t&&!this._useDocSetsModernView){t=!this._itemSelectionHelper.selection.peek().length}return!!t};t.prototype._isBulkEdit=function(){var e=this._itemSelectionHelper.selection();return e&&e.length>1};t.prototype._getClientFormParms=function(e,t,n){var r=e.peek().properties;return{clientFormType:1,item:e,contentType:r.ContentType,contentTypeId:r.ContentTypeId,isBulkEdit:t,selection:n}};t.dependencies=n.__assign({},r.default.dependencies,{itemParentHelper:o.resourceKey,clientFormProvider:s.resourceKey,itemSelectionHelperType:g.typeResourceKey,rumOneHelper:h.rumOneHelper,listContext:x.listContext});return t}(r.default);t.default=C});
define("odsp-next/controls/clientForm/DuplexClientForm",["require","exports","@ms/odsp-utilities/lib/async/Promise","knockout","../reactHost/ReactHost","../../providers/engagement/Engagement"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="ms-client-form-react",u=i.createComponent(o,"./ReactClientFormConnector",function(){return n.default.resolve(new Promise(function(t,n){e(["./ReactClientFormConnector"],t,n)}))});r.components.isRegistered(u.tagName)||r.components.register(u.tagName,u);t.getClientFormTagName=function(e,t){var n=t&&t.consume(s.resourceKey)||null;n&&n.logData({name:"ClientForm.Instantiate.ReactClientForm",extraData:{TagName:o}});return o}});
define("odsp-next/providers/clientForm/ClientFormProvider",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../models/store/ItemsStore","../../models/item/ItemType","../../models/task/Task","@ms/odsp-datasources/lib/utilities/list/ItemGroupHelper","@ms/odsp-shared/lib/base/BaseModel","../../dataSources/clientForm/spo/ClientFormDataSource","../../resources/SPOResourceKeys","../../models/clientForm/ClientFormHelper","@ms/odsp-utilities/lib/resources/Resources","../../utilities/killSwitch/KillSwitch"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._buffer=[];r._bufferSize=5;r._clientFormDataSource=n.clientFormDataSource;r._itemsStore=n.itemsStore;r._listContext=n.listContext;return r}t.prototype.getClientForm=function(e,t){var n=this;void 0===t&&(t=!1);t&&(this._listContext.refreshClientForm=!0);var i,o=e.item.peek(),u=this._getBufferKeyFromItem(o,e.contentType),a=e.isBulkEdit?void 0:this._getClientFormFromBuffer(u);o.type!==s.default.Folder||e.contentType||(e.contentType="Folder");if(a&&!this._listContext.refreshClientForm){if(o.hasClientFormData){a.item=e.item;return r.default.wrap(a)}this._deleteClientFormFromBuffer(u)}var f=this.getContentInfoTypes(e);return this._clientFormDataSource.getClientFormSchema(e.clientFormType,f,e.isBulkEdit).then(function(t){i={item:e.item,formType:t.formType,contentType:t.contentType,contentTypeId:t.contentTypeId,fields:[],isBulkEdit:e.isBulkEdit};n._generateFieldsFromSchema(i,t);if(2!==e.clientFormType)return n.updateFormValues(i)}).then(function(){n._addClientFormToBuffer(i);return r.default.wrap(i)})};t.prototype.getContentInfoTypes=function(e){var t=[];if(e.isBulkEdit&&e.selection&&!e.isSwitchingContentType)for(var n={},r=0,i=e.selection;r<i.length;r++){var o=i[r];if(o){var u=o.peek(),a=u.properties;if(a){var f=u.type!==s.default.Folder||a.ContentType?a.ContentType:"Folder",l=a.ContentTypeId,c=f+l;if(!n[c]){t.push({contentType:f,contentTypeId:l});n[c]=!0}}}}else t.push({contentType:e.contentType,contentTypeId:e.contentTypeId});return t};t.prototype.updateFormValues=function(e,t){return this._clientFormDataSource.updateFormValues(e,t)};t.prototype.createItem=function(e){return this._clientFormDataSource.createItem(e)};t.prototype.clearBuffer=function(){this._buffer=[]};t.prototype.updateItem=function(e){(!p.default.isActivated("E5B5EC4B-2237-4E9C-8C79-1751EEBD1D72","02/15/19","Delete the client form buffer to avoid stale client forms")||e.clientForm.isBulkEdit&&e.selection)&&(this._buffer=[]);return this._clientFormDataSource.updateItem(e)};t.prototype.getContentTypes=function(e){return this._clientFormDataSource.getContentTypes(e)};t.prototype.updateItemMetadata=function(e,t){var n=this,i=e.items,s=e.metadata,a=e.parentItem,f=e.skipInvalidation,l=e.onComplete,h=i.length,p=0,d=[],v=function(){for(var e=[],t=s.group;t;){var r=t.fieldValue,i=t.fieldSchema;e.push({data:n.createObservable(r),serverData:null,state:n.createObservable(0),hasException:n.createObservable(!1),errorMessage:n.createObservable(""),schema:i});t=c.convertGroup(u.default.getParent(t,s.itemGroups))}return e};return r.default.wrap(function(){i.forEach(function(e,r){t&&(d[r]=new o.default(e.key,e));var i={item:n.createObservable(e),fields:v(),contentType:null,formType:1};n._clientFormDataSource.updateItem({clientForm:i,newDocumentUpdate:!1,checkInComment:null}).then(function(){p++;if(t){d[r]=d[r].succeed();t.update(d)}if(p===h){l&&l(!0);a&&!f&&n._itemsStore.invalidateItem(a.key)}},function(e){if(t){var n=e&&e.length>0&&e[0]&&e[0].message&&e[0].message.value;d[r]=d[r].fail(new Error(n));t.update(d)}})});t&&t.update(d)}())};t.prototype.hasFormRenderMode=function(e){return this._clientFormDataSource.hasFormRenderMode(e)};t.prototype.getFormRenderMode=function(e,t){return this._clientFormDataSource.getFormRenderMode(e,t)};t.prototype.getPowerAppFormId=function(){return this._clientFormDataSource.getPowerAppFormId()};t.prototype.getPowerAppRenderInfo=function(){return this._clientFormDataSource.getPowerAppRenderInfo()};t.prototype.getPowerAppAdditionalData=function(){return this._clientFormDataSource.getPowerAppAdditionalData()};t.prototype.getPowerAppFormCacheInfo=function(){return this._clientFormDataSource.getPowerAppFormCacheInfo()};t.prototype.getPowerAppFormDesignUrl=function(e){return this._clientFormDataSource.getPowerAppFormDesignUrl(e)};t.prototype.fetchAllClientFormSchemas=function(){return this._clientFormDataSource.fetchAllClientFormSchemas()};t.prototype._generateFieldsFromSchema=function(e,t){for(var n=this._listContext&&this._listContext.enableAttachments,r=0,i=t.fields.length;r<i;r++){var s=t.fields[r];("Attachments"!==s.Type||n)&&e.fields.push(this._generateField(e,s))}};t.prototype._generateField=function(e,t){return{hasException:this.createObservable(!1),errorMessage:this.createObservable(""),schema:t,state:this.createObservable(0)}};t.prototype._getBufferKeyFromItem=function(e,t){return e.properties.ID+e.name+"|"+t};t.prototype._getClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++){var r=this._buffer[t].key;if(r===e){if(0===t)return this._buffer[t].form;var i=this._buffer[t].form;this._buffer.splice(t,1);this._buffer.unshift({key:r,form:i});return i}}return null};t.prototype._addClientFormToBuffer=function(e){if(!e.isBulkEdit&&!this._hasAppendOnlyField(e)){var t=e.item.peek();t&&void 0!==t.properties.ID&&this._buffer.unshift({key:this._getBufferKeyFromItem(t,e.contentType),form:e})>this._bufferSize&&this._buffer.pop()}};t.prototype._deleteClientFormFromBuffer=function(e){for(var t=0,n=this._buffer.length;t<n;t++){if(this._buffer[t].key===e){this._buffer.splice(t,1);break}}};t.prototype._hasAppendOnlyField=function(e){for(var t=0,n=e.fields;t<n.length;t++){if(n[t].schema.AppendOnly)return!0}return!1};t.dependencies=n.__assign({},a.default.dependencies,{clientFormDataSource:f.resourceKey,itemsStore:i.resourceKey,listContext:l.listContext});return t}(a.default);t.default=d;t.resourceKey=h.createResolvedResourceKey(e("module").id,d)});
define("@ms/odsp-datasources/lib/utilities/list/ItemGroupHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e.getParent=function(e,t){if(e.level&&e.parentKey&&0!==e.level){return t.filter(function(t){return t.groupingId===e.parentKey})[0]}};e.getFilterDetails=function(n,r){for(var i=n,s=[],o=[];i&&i.fieldSchema;){s.unshift(i.fieldSchema.Name);var u=t(i);o.unshift(u);i=e.getParent(i,r)}return{fields:s,values:o}};function t(e){var t="";switch(e.fieldSchema.Type){case"User":case"Lookup":t=e.name;break;case"DateTime":var n=decodeURIComponent(e.groupString).split(";#"),r=n[0];n.length>0&&(n=n.slice(1,n.length-1))[e.level]&&(r=n[e.level]);t=function(e){if(!e)return e;var t=e.substring(0,4),n=e.substring(4,6),r=e.substring(6,8);return[t,"-",n,"-",r].join("")}(r);break;default:t=e.fieldValue}return t}}(n||(n={}));t.default=n});
define("odsp-next/dataSources/clientForm/spo/ClientFormDataSource",["require","exports","tslib","knockout","@ms/odsp-utilities/lib/async/Promise","../../base/odb/DataSource","@ms/odsp-utilities/lib/uri/Uri","@ms/odsp-utilities/lib/encoding/UriEncoding","../IClientFormDataSource","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-datasources/lib/dataSources/item/spListItemRetriever/ListItemDataHelpers","../../item/odb/ListViewDataPrefetchHelper","@ms/odsp-datasources/lib/interfaces/ISpPageContext","../../../resources/DataSourceResourceKeys","../../../resources/SPOResourceKeys","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../compliance/ComplianceTagDataSource","../../url/odb/ItemUrlHelper","../../url/odb/ApiUrlHelper","../../../utilities/features/Features","../../../utilities/complianceTag/ComplianceTagUtilities","@ms/odsp-utilities/lib/logging/events/Verbose.event","@ms/odsp-utilities/lib/async/PromiseDebouncer","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/encoding/HtmlEncoding","./ClientFormDataSource.resx","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../utilities/killSwitch/KillSwitch"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RootContentTypeIds={folder:"0x0120",document:"0x0101",item:"0x01"};var A=function(e){n.__extends(s,e);function s(t,n){var r=e.call(this,n.pageContext)||this;r._clientForms=null;r._listContext=n.listContext;r._itemsDataSource=n.items;r._navigation=n.navigation;r._complianceTagDataSource=n.compliance;r._itemUrlHelper=n.itemUrlHelper;r._apiUrlHelper=n.apiUrlHelper;return r}s.prototype.createItem=function(e,t){var n=this,r=this._getUrlInfo(e.clientForm.item),i=r.listUrl,s=r.itemUrlParts,o="AddValidateUpdateItemUsingPath",u=t?t+".CreateItem":"CreateItem";return this._createOrUpdateItem(u,function(){return n._apiUrlHelper.build().webByItemUrl(s).method("GetList",i).method(o).toString()},function(t){var n=e.rootFolder||i;return JSON.stringify({listItemCreateInfo:{__metadata:{type:"SP.ListItemCreationInformationUsingPath"},FolderPath:{__metadata:{type:"SP.ResourcePath"},DecodedUrl:n}},formValues:t,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment})},e,o).then(function(){return n._updateAttachmentsField(e)})};s.prototype.updateItem=function(e,t){var n=this,r=e.clientForm.isBulkEdit&&e.selection&&e.selection.length>1?e.selection:void 0;r&&r.filter(function(e){return!!e});var i=r&&r.length>0,s=t?t+".UpdateItem":"UpdateItem";return this._createOrUpdateItem(s,function(e){var t=n._getUrlInfo(e),r=t.listUrl,s=t.itemUrlParts;return i?n._apiUrlHelper.build().webByItemUrl(s).method("GetList",r).method("BulkValidateUpdateListItems").toString():n._apiUrlHelper.build().webByItemUrl(s).method("GetList",r).method("items",e.peek().properties.ID).method("ValidateUpdateListItem").toString()},function(t){var s,o;if(i){s=[];for(var u=0,a=r;u<a.length;u++){var f=a[u];s.push(parseInt(f.peek().properties.ID,10))}if(!e.isRecursiveView){var l=(f=e.clientForm.item.peek())&&f.parent;o=l&&n._itemUrlHelper.getItemUrlParts(l.key).normalizedItemUrl}}return JSON.stringify({itemIds:s,formValues:t,bNewDocumentUpdate:e.newDocumentUpdate,checkInComment:e.checkInComment,folderPath:o})},e,i?"BulkValidateUpdateListItems":"ValidateUpdateListItem",r).then(function(t){return n._updateAttachmentsField(e).then(function(){return t})})};s.prototype.getClientFormSchema=function(e,t,r){var s=this,o=function(){var i=s._locateClientFormWithContentTypeInfos(e,t);if(r&&i&&i.fields){var o=i.fields.filter(function(e){var t=e.FieldType.toLowerCase(),n=e.Name;return"file"!==t&&"attachments"!==t&&"Title"!==n&&"LinkTitle"!==n&&"LinkTitleNoMenu"!==n});return n.__assign({},i,{fields:o})}return i};if(null===this._clientForms||this._listContext.refreshClientForm){this._listContext.refreshClientForm=void 0;return this.fetchAllClientFormSchemas().then(function(){return o()})}return i.default.wrap(o())};s.prototype.updateFormValues=function(e,t){var n=this,r=e.item.peek();if(!r||!r.properties||!r.properties.ID)return i.default.wrap();for(var s=[],a=0,f=e.fields;a<f.length;a++){var l=f[a];0===l.state.peek()&&s.push(l)}return this.getData(function(){var e=r.properties.ID,t=u.default.encodeRestUriStringToken(n._listContext.listUrl),i=b.isFeatureEnabled(b.ModernAppendOnly)?"15":"7",s=new o.default(window.location.href,{queryCaseInsensitive:!0}).getQueryParameter("VersionNo")||"0",a=b.isFeatureEnabled(b.ModernAppendOnly)?",cutoffVersion="+s:"";return n._pageContext.webAbsoluteUrl+"/_api/web/GetList(@v1)/RenderExtendedListFormData(itemId="+e+",formId='editform',mode='2',options="+i+a+")?@v1='"+t+"'"},function(e){if(null!=e){var t=JSON.parse(e);if(t.d.RenderExtendedListFormData)return t=JSON.parse(t.d.RenderExtendedListFormData)}return null},"GetItemDataForClientForm",function(){return""},"POST",this._getAdditionalHeaders()).then(function(r){n._handleServerData(e,r,t,s);for(var i=0,o=s;i<o.length;i++){o[i].state(0)}},function(e){for(var t=e.code?e.code.split(","):e.error.code.split(","),n=t.length>1?Number(t[0]):-1,r=0,o=s;r<o.length;r++){o[r].state(0)}return i.default.wrapError({errorCode:n,message:e&&e.message?e.message.value?e.message.value:e.message:""})})};s.prototype.getFieldValueSuggestions=function(e,t,n,r){var s=this;n=n||5;r=N.default.encodeText(r);var o=this._getSuggestionsViewXml(e,t,!0,n,r),u=this._getSuggestionsViewXml(e,t,!1,n,r),a=this._getAdditionalHeaders(),f=function(t){var n=JSON.parse(t);return n&&n.Row&&n.Row.length>0?n.Row.map(function(t){var n=t[e];return"string"==typeof n||n instanceof String?t[e].trim():JSON.stringify(t[e])}):[]},l=this.getData(function(){return s._getServerConnectionUrl().toString()},f,"GetLatestFieldValueModifiedByMe",function(){return c.default.getAdditionalPostData({needsSchema:!1,viewXml:o})},"POST",a),h=this.getData(function(){return s._getServerConnectionUrl().toString()},f,"GetLatestFieldValueModifiedByOther",function(){return c.default.getAdditionalPostData({needsSchema:!1,viewXml:u})},"POST",a);return i.default.all([l,h]).then(function(e){for(var t={},r=[],i=0,s=e;i<s.length;i++)for(var o=0,u=s[i];o<u.length;o++){var a=u[o];if(!t[a]){r.push(a);t[a]=!0;if(r.length===n)return r}}return r})};s.prototype.getFieldFilterData=function(e,t){var n=v.serializeQuery(this._navigation.viewParams);return this._itemsDataSource.getFilterData(e,n,t)};s.prototype.getContentTypes=function(e){var t=[];if(this._clientForms&&this._clientForms[e])for(var n in this._clientForms[e])this._clientForms[e].hasOwnProperty(n)&&t.push({displayName:n,description:n,templateUrl:null});return t};s.prototype.hasFormRenderMode=function(e){var t=this;return this._ensureClientForms(function(){return t._checkRenderModes(e)})};s.prototype.getFormRenderMode=function(e,t){var n=this;return this._ensureClientForms(function(){return n._getFormRenderMode(e,t)})};s.prototype.getPowerAppFormId=function(){return this._powerAppFormId};s.prototype.getPowerAppRenderInfo=function(){return this._powerAppFormInfo};s.prototype.getPowerAppAdditionalData=function(){return this._powerAppAdditionalData};s.prototype.getPowerAppFormCacheInfo=function(){return this._powerAppFormCacheInfo};s.prototype.getPowerAppFormDesignUrl=function(e){var t=this;return this.getData(function(){return t._pageContext.webAbsoluteUrl+"/_api/SP.Internal.FormsCustomization.GetPowerAppsFormDesignUrl?listName='"+e+"'&visualizationTarget=1"},function(e){var t=JSON.parse(e),n="";t.d&&t.d.Value&&(n=JSON.parse(t.d.Value));return n},"GetPowerAppFormDesignUrl",null,"GET")};s.prototype.fetchAllClientFormSchemas=function(e){var t=this;void 0===e&&(e=!1);this._clientFormsDebouncer||(this._clientFormsDebouncer=new S.default);this._clientFormsDebouncer.isExecuting()&&!e||(this._clientFormsPromise=this._clientFormsDebouncer.debounce(this.getData(function(){return t._getServerConnectionUrl().toString()},function(e){t._clientForms={};var n=JSON.parse(e);n.ContentTypeIdToNameMap&&(t._contentTypeIdToNameMap=n.ContentTypeIdToNameMap);var r=n.ClientForms;if(r){r.New&&t._processClientFormResponse(2,r.New);if(r.Edit){t._processClientFormResponse(1,r.Edit);t._processClientFormResponse(3,r.Edit)}}n.Navigation&&(t._listContext.leftNavigationData={quickLaunchNodes:n.Navigation.Nodes});void 0!==n.EnableAttachments&&(t._listContext.enableAttachments=n.EnableAttachments);n.FormRenderModes&&t._processFormRenderMode(n.FormRenderModes);(n.PowerAppFormId||n.AppId)&&(t._powerAppFormId=n.PowerAppFormId||n.AppId);n.AppRenderInfo&&(t._powerAppFormInfo=n.AppRenderInfo||{});n.AppAdditionalData&&(t._powerAppAdditionalData=n.AppAdditionalData);n.CachedFileUrlTemplate&&n.CacheAppFiles&&(t._powerAppFormCacheInfo=JSON.stringify({appFiles:n.CacheAppFiles,cachedFileUrlTemplate:n.CachedFileUrlTemplate}))},"GetClientForms",function(){var e=!t._listContext.leftNavigationData&&b.isFeatureEnabled(b.RenderListDataAsStreamLeftNavOpt);return c.default.getAdditionalPostData({needsSchema:!1,viewXml:'<View><ViewFields><FieldRef Name="ID"/></ViewFields></View>',needsForms:!0,needsQuickLaunch:e})},"POST",this._getAdditionalHeaders(),void 0,void 0,!0)));return this._clientFormsPromise};s.prototype.getDataSourceName=function(){return"ClientFormDataSource"};s.prototype._processClientFormResponse=function(e,t){this._clientForms[e]||(this._clientForms[e]={});var n=this._clientForms[e];for(var r in t)if(t.hasOwnProperty(r)&&!n[r]){n[r]={contentType:r,contentTypeId:this._reverseLookupContentTypeIdByName(r),formType:e,fields:[],mode:0};for(var i=n[r],s=t[r],o=0,u=s.length;o<u;o++)i.fields.push(s[o])}};s.prototype._getServerConnectionUrl=function(e){var t=this._itemUrlHelper.getItemUrlParts(e);return l.getListDataUrl({webUrl:this._pageContext.webAbsoluteUrl,listId:this._listContext.listId,urlParts:t,rootFolder:this._listContext.folderPath,requestToken:"?"})};s.prototype._getUrlInfo=function(e){var t=e&&this._itemUrlHelper.getItemUrlParts(this.peekUnwrapObservable(e).key);return{listUrl:t?t.serverRelativeListUrl:this._listContext.listUrl,itemUrlParts:t}};s.prototype._createOrUpdateItem=function(e,t,n,r,s,o){var u=this,f=r.clientForm.fields,l=[],c=[],p={},d=[],v=null,m=null,g=!1;this._failedUpdateComplianceTagIdsCount=0;for(var y=0,E=f;y<E.length;y++){var S=E[y];if(S.data&&0===S.state.peek()){var x=S.data.peek();if(w.isClientFormComplianceTagField(S)&&x!==S.serverData){v=S;if(o){var T=this._getUpdateMultipleComplianceTagsPromises(x,o,S);if(T)for(var N=0,C=T;N<C.length;N++){var k=C[N];d.push(k)}}else{var A=this._getUpdateComplianceTagPromise(x,r.clientForm.item.peek(),S);A&&d.push(A)}}else if(w.isClientFormUnlockedRecordField(S)){if(!b.isFeatureEnabled(b.IPRecordVersioningClient)){p[S.schema.Name]=!0;continue}var O=w.isUnlockRecordTurnedOn(r.clientForm.item.peek().properties[w.COMPLIANCEFLAGS_NAME]);if(O===("1"===x)||o){p[S.schema.Name]=!0;continue}m=S;var M=this._getUpdateUnlockedRecordPromise(x,r.clientForm.item.peek(),S,O);M&&d.push(M)}else if(this._isClientFormFieldUpdated(r,x,S)&&"attachments"!==S.schema.FieldType.toLowerCase()){S.state(1);l.push(S);var _=S.schema.Name;if(L.default.isActivated("494522DE-9991-4929-B2BB-77B43D84B8EE","10/25/18","Use content type ID instead of name")||"ContentType"!==_)x="ContentType"===_?x.displayName:x;else{x=this._reverseLookupContentTypeIdByName(x.displayName);_="ContentTypeId";g=!0}c.push({FieldName:_,FieldValue:x,HasException:!1,ErrorMessage:null})}else p[S.schema.Name]=!0}}var D=L.default.isActivated("F09067C2-4E14-4222-8AA7-4FB89F5D72B5","10/25/18","Do not include content type twice.");2!==r.clientForm.formType||!D&&g?1===r.clientForm.formType&&r.clientForm.item&&!r.clientForm.isBulkEdit&&r.clientForm.item.peek()&&r.clientForm.item.peek().properties&&(D||!g)&&c.push({FieldName:"ContentTypeId",FieldValue:r.clientForm.item.peek().properties.ContentTypeId,HasException:!1,ErrorMessage:null}):c.push({FieldName:"ContentType",FieldValue:r.clientForm.contentType,HasException:!1,ErrorMessage:null});if(0===l.length&&0===d.length)return i.default.wrap({status:a.UpdateResultStatus.success});d.push(this._getUpdateItemPromise(e,t,n,r,s,l,c,r.clientForm.item,o));return i.default.all(d).then(function(e){for(var t={status:a.UpdateResultStatus.success},n=0,r=e;n<r.length;n++){var i=r[n];if(i&&i.hasOwnProperty("status")){t.status=i.status;i.failedItemIds&&(t.failedItemIds=i.failedItemIds)}break}u._failedUpdateComplianceTagIdsCount>0&&t.status===a.UpdateResultStatus.success&&(t.status=a.UpdateResultStatus.partialSuccess);return t},function(e){v&&v.state(0);m&&m.state(0);for(var t=0,n=l;t<n.length;t++){var i=n[t];i.hasException(!0);i.state(0)}var s=h.getServerUrl(u._pageContext)+r.clientForm.item.peek().properties.FileRef;throw e=(e=Array.isArray(e)?e:[e]).filter(function(e){return e&&e.message&&e.message.value}).map(function(e){e.message.value=e.message.value.replace('"'+s+'" ',"");return e})})};s.prototype._getUpdateItemPromise=function(e,t,n,r,s,o,u,l,c){return u&&0!==u.length&&o&&0!==o.length?this.getData(t.bind(null,l),function(e){var t=JSON.parse(e);if(!t.d||!t.d[s]||!t.d[s].results){for(var n=0,u=o;n<u.length;n++){(A=u[n]).state(0)}return i.default.wrapError("The server response couldn't be processed")}for(var h=null,p={},d="",v=0,m=t.d[s].results;v<m.length;v++){var g=m[v];if(2===r.clientForm.formType&&"Id"===g.FieldName){var y=l.peek();y.properties||(y.properties={});y.properties.ID=g.FieldValue}if(!0===g.HasException||null!==g.ErrorMessage){var b=g.FieldName;p[b]||(p[b]=[]);void 0!==g.ItemId&&p[b].indexOf(g.ItemId)<0&&p[b].push(g.ItemId);if(!h){h={};for(var w=0,E=r.clientForm.fields;w<E.length;w++){var S=E[w];h[S.schema.Name]=S}}if(h[b]){h[b].errorMessage(g.ErrorMessage);h[b].hasException(!0);var x=h[b].schema.Title;d=d?d+", "+x:x}}}var T={status:d?a.UpdateResultStatus.fail:a.UpdateResultStatus.success};if(c&&c.length&&p.null){var N=p.null;N.length<c.length?T.status=a.UpdateResultStatus.partialSuccess:T.status=a.UpdateResultStatus.fail;T.failedItemIds=N}for(var k=0,L=o;k<L.length;k++){var A=L[k];if(d){if(!p[A.schema.Name]&&r.isInteractiveSave){A.errorMessage(f.format(C.strings.ErrorInOtherFields,d));A.hasException(!0)}}else{A.errorMessage("");A.hasException(!1)}A.state(0)}return T},e,function(){return n(u)},"POST",this._getAdditionalHeaders(),void 0,5):i.default.wrap()};s.prototype._handleServerData=function(e,t,n,i){for(var s=t.ListData,o=t.Data.Row[0],u=e.item.peek(),a=e.isBulkEdit,f=0,l=i.length;f<l;f++){var c=i[f],h=c.schema;if(!n||!n.hasOwnProperty(h.Name)){void 0===c.data&&(c.data=r.observable(null));void 0===c.serverData&&(c.serverData=null);if(s.hasOwnProperty(h.Name)){"boolean"===h.FieldType.toLowerCase()&&""===o[h.Name]&&"0"===s[h.Name]?c.serverData="":c.serverData=s[h.Name];u.hasOwnProperty(h.Name)||u.properties.hasOwnProperty(h.Name)||(u.properties[h.Name]=o[h.Name])}else if(w.isClientFormComplianceTagField(c)){c.serverData=o[w.COMPLIANCETAG_FIELD_NAME];u.hasOwnProperty(h.Name)||u.properties.hasOwnProperty(h.Name)||(u.properties[h.Name]=o[h.Name])}else u.folder&&c.schema.FieldType&&"file"===c.schema.FieldType.toLowerCase()&&c.schema.Title&&"name"===c.schema.Title.toLowerCase()&&s.Title?c.serverData=s.Title:c.serverData=null;a&&(c.serverData=null);if(c.schema.AppendOnly){c.appendOnlyData=t[c.schema.Name];c.data("")}else c.data(c.serverData);if(L.default.isActivated("1E378923-8921-4A0C-A8F3-130823AB8BEB","Fix hotfix VSO#615577")){c.hasException(!1);c.errorMessage("");c.schema=h}}}b.isFeatureEnabled(b.DocumentSetsModernView)&&b.isFeatureEnabled(b.UseItemsScopeInTeamSites)&&this._handleWelcomeFields(e,t.WelcomeFields);u.properties[w.ASSETID_FIELD_NAME]=s[w.ASSETID_FIELD_NAME];u.hasClientFormData=!0};s.prototype._handleWelcomeFields=function(e,t){var n=e.fields;if(Array.isArray(t)&&t.length>0&&n){for(var r=n.map(function(e,t){return{index:t,name:e.schema.InternalName}}),i={},s=0;s<t.length;s++){var o=t[s];o&&(i[o]=s+2)}i.FileLeafRef=0;i.DocumentSetDescription=1;r.sort(function(e,t){if(e.name===t.name)return e.index-t.index;var n=i[e.name],r=i[t.name];return void 0!==n&&void 0!==r?n-r:void 0!==n?-1:void 0!==r?1:e.index-t.index});e.fields=r.map(function(e){return n[e.index]})}};s.prototype._getAdditionalHeaders=function(){return l.getListRequestHeaders(this._listContext)};s.prototype._processFormRenderMode=function(e){if(e)for(var t in e)for(var n in e[t]){var r=2;switch(n){case"Edit":r=1;break;case"Display":r=3}var i=0;switch(e[t][n].RenderType){case 1:i=1;break;case 2:i=2;break;case 3:i=3;break;case 4:i=4;break;default:E.Verbose.logData({name:"ClientFormDataSource.InvalidFormRenderMode",message:"Server returned RenderType="+e[t][n].RenderType})}this._clientForms[r][t].mode=i}};s.prototype._checkRenderModes=function(e){for(var t in this._clientForms)for(var n in this._clientForms[t])if(this._clientForms[t][n].mode===e)return!0;return!1};s.prototype._getSuggestionsViewXml=function(e,t,n,r,i){var s=n?'<Eq><FieldRef Name="Editor" LookupId="TRUE"/><Value Type="int"><UserID/></Value></Eq>':'<Neq><FieldRef Name="Editor" LookupId="TRUE"/><Value Type="int"><UserID/></Value></Neq>';return'<View Scope="RecursiveAll">'+('<Query><OrderBy><FieldRef Name="ID" Ascending="false"></FieldRef></OrderBy><Where>'+(s=i?"<And>"+s+'<BeginsWith><FieldRef Name="'+e+'"/><Value Type="'+t+'">'+i+"</Value></BeginsWith></And>":"<And>"+s+'<IsNotNull><FieldRef Name="'+e+'"/></IsNotNull></And>')+"</Where></Query>")+('<ViewFields><FieldRef Name="Modified"/><FieldRef Name="Editor"/><FieldRef Name="'+e+'"/></ViewFields>')+'<RowLimit Paged="TRUE">'+r+"</RowLimit></View>"};s.prototype._getUpdateComplianceTagPromise=function(e,t,n){var r,s=n.schema;s.ComplianceTags&&(r=s.ComplianceTags.filter(function(t){return t&&t.tagValue===e})[0]);return r?this._complianceTagDataSource.updateComplianceTag(t,r).then(null,function(e){if(e&&n){n.errorMessage(e.message&&e.message.value?e.message.value:e);n.hasException(!0)}}):i.default.wrap()};s.prototype._getUpdateUnlockedRecordPromise=function(e,t,n,r){var i=this._itemUrlHelper.getItemUrlParts(t.key).serverRelativeListUrl;return"1"===e?this._complianceTagDataSource.unlockRecord(t,i).then(function(e){n.serverData=e?"1":"0"},function(e){if(e&&n){n.serverData=r?"1":"0";n.errorMessage(e.message&&e.message.value?e.message.value:e);n.hasException(!0)}}):this._complianceTagDataSource.lockRecord(t,i).then(function(e){n.serverData=e?"1":"0"},function(e){if(e&&n){n.serverData=r?"1":"0";n.errorMessage(e.message&&e.message.value?e.message.value:e);n.hasException(!0)}})};s.prototype._getUpdateMultipleComplianceTagsPromises=function(e,t,n){var r,i=this,s=n.schema,o=[];s.ComplianceTags&&(r=s.ComplianceTags.filter(function(t){return t&&t.tagValue===e})[0]);if(r){for(var u=[],a=0,f=0,l=t.length;f<l;f++){var c=t[f];u.push(parseInt(c().properties.ID,10));if(++a===w.MAX_ITEM_SIZE||f===t.length-1){var h=this._itemUrlHelper.getItemUrlParts(t[0]().key).serverRelativeListUrl;o.push(this._complianceTagDataSource.updateComplianceTagInBatch(u,r,h).then(function(e){i._failedUpdateComplianceTagIdsCount+=e.length},function(e){if(e&&n){n.errorMessage(e.message&&e.message.value?e.message.value:e);n.hasException(!0)}}));u=[];a=0}}return o}return null};s.prototype._updateAttachmentsField=function(e){var t=this,n=e.clientForm.item.peek(),r=null;if(n&&n.properties.ID&&"0"!==n.properties.ID){for(var s=0,o=e.clientForm.fields;s<o.length;s++){var u=o[s];if("attachments"===u.schema.FieldType.toLowerCase()){r=u;break}}var a=r&&r.AttachmentOperationsManager;if(a&&a.operationsPool.length>0){a.setListItem(n);return a.executeAllOperations(a.operationsPool,!0).then(function(e){a.operationsPool=[];t.handleAttachmentsErrors(e,r)},function(e){a.operationsPool=[];t.handleAttachmentsErrors(e,r)})}}return i.default.wrap(null)};s.prototype.handleAttachmentsErrors=function(e,t){var n=[];e.forEach(function(e){e.result||n.push(e.errorMsg)});if(t&&n&&n.length>0){var r=n.reduce(function(e,t){return e+(e?"\r\n":"")+t+"\r\n"},"");t.errorMessage(r);t.hasException(!0)}};s.prototype._getFormRenderMode=function(e,t){var n=this._contentTypeIdToNameMap[t],r=this._clientForms[e][n];return r?r.mode:this._checkRenderModes(3)?3:0};s.prototype._reverseLookupContentTypeIdByName=function(e){for(var t in this._contentTypeIdToNameMap)if(e===this._contentTypeIdToNameMap[t])return t;return null};s.prototype._ensureClientForms=function(e){if(!this._clientForms||this._listContext.refreshClientForm){this._listContext.refreshClientForm=void 0;var t=!L.default.isActivated("975DFDE1-C9F7-44A9-A628-D9DD6F9BB63D","09/05/2019","Make power app pre-loading more robust");return this.fetchAllClientFormSchemas(t).then(e)}return i.default.wrap(e())};s.prototype._isClientFormFieldUpdated=function(e,t,n){return(!e.clientForm.isBulkEdit||""!==t||null!==n.serverData)&&(n.schema.AppendOnly?!L.default.isActivated("E4E6F7C4-9ADB-4B1B-833D-350823F516DE","Fix hotfix VSO#617198")||!!t:!x.deepCompare(t,n.serverData))};s.prototype._locateClientForm=function(e,n,r){!n&&r&&this._contentTypeIdToNameMap&&(n=this._contentTypeIdToNameMap[r]);if(!n&&this._clientForms[e])for(var i in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(i)){n=i;break}if(r&&0===r.lastIndexOf(t.RootContentTypeIds.folder,0)&&this._clientForms[e]&&!this._clientForms[e][n]){var s={FileLeafRef:1,Title:1,URL:1};for(var i in this._clientForms[e])if(this._clientForms[e].hasOwnProperty(i)){var o=this._clientForms[e][i].fields.filter(function(e){return!!s[e.Name]})[0];if(o){this._clientForms[e].Folder={contentType:"Folder",contentTypeId:r,formType:e,fields:[o],mode:0};return this._clientForms[e].Folder}}}return this._clientForms[e]&&this._clientForms[e][n]?this._clientForms[e][n]:null};s.prototype._locateClientFormWithContentTypeInfos=function(e,t){if(!t||!t.length)return this._locateClientForm(e,void 0,void 0);var r=t[0],i=this._locateClientForm(e,r.contentType,r.contentTypeId);if(1===t.length||!i||!i.fields)return i;for(var s=i.fields.slice(),o=function(n){if(0===s.length)return"break";var r=t[n],i=u._locateClientForm(e,r.contentType,r.contentTypeId);s=s.filter(function(e){for(var t=0,n=i.fields;t<n.length;t++){if(n[t].Name===e.Name)return!0}return!1})},u=this,a=1;a<t.length;a++){if("break"===o(a))break}return n.__assign({},i,{fields:s})};s.dependencies={pageContext:d.pageContext,listContext:d.listContext,items:p.items,navigation:k.navigation,compliance:m.resourceKey,itemUrlHelper:g.resourceKey,apiUrlHelper:y.resourceKey};return s}(s.default);t.default=A;t.resourceKey=T.createResolvedResourceKey(e("module").id,A)});
define("odsp-next/dataSources/base/odb/DataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","./DataRequestor","../../../resources/SPOResourceKeys","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,void 0,n)||this;r._pageContext=t||r.resources.consume(s.pageContext);r.dataRequestor=new i.default({},{pageContext:r._pageContext});return r}t.prototype.updateContext=function(e){o.extend(this._pageContext,e);this.dataRequestor=new i.default({},{pageContext:this._pageContext})};t.prototype.getDataSourceName=function(){return"DataSource"};t.prototype.needsRequestDigest=function(e){return!0};t.prototype.getData=function(e,t,n,r,i,s,o,u,a,f){void 0===i&&(i="POST");var l=e();return this.dataRequestor.getData({url:l,parseResponse:t,qosName:this.getDataSourceName()+"."+n,additionalPostData:r&&r(),method:i,additionalHeaders:s,contentType:o,maxRetries:u,noRedirect:a,crossSiteCollectionCall:f,needsRequestDigest:this.needsRequestDigest(l)})};return t}(r.default);t.default=u});
define("odsp-next/dataSources/clientForm/IClientFormDataSource",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.fail=0]="fail";e[e.partialSuccess=1]="partialSuccess";e[e.success=2]="success"}(t.UpdateResultStatus||(t.UpdateResultStatus={}))});
define("@ms/odsp-datasources/lib/dataSources/item/spListItemRetriever/ListItemDataHelpers",["require","exports","./interfaces/IItemUrlHelper","@ms/odsp-utilities/lib/encoding/UriEncoding","@ms/odsp-utilities/lib/logging/events/Verbose.event","@ms/odsp-utilities/lib/killswitch/Killswitch"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getListDataUrl=function(e){var t,u,a=e.webUrl,f=e.webId,l=e.listId,c=e.view,h=e.searchTerm,p=e.rootFolder,d=e.sortField,v=e.sortDir,m=e.filterParams,g=e.groupString,y=e.requestToken,b=e.viewId,w=e.viewPath,E=e.urlParts,S=e.isOnePageNavigation,x=[r.default.escapeUrlForCallback(a)];"/"!==a.slice(-1)&&x.push("/");E&&(u=void 0===(t=E.siteRelation)?E.isCrossSite:t);if(((s.Killswitch.isActivated("BC0D39CA-6A40-44C6-BC43-EC999DC12B95","3/7/2019","Use cross-site list call for anything not known to be same-site")?u===n.SiteRelation.crossSite:u!==n.SiteRelation.sameSite)||f)&&E.fullListUrl&&!S){x.push("_api/SP.List.GetListDataAsStream?listFullUrl='");x.push(r.default.encodeRestUriStringToken(E.fullListUrl));if(y){"?"!==y[0]&&i.Verbose.logData({name:"ListItemDataHelper.InvalidRequestToken",message:y});x.push("'&"+y.substring(1));return x.join("")}x.push("'&View=")}else{var T=E&&E.serverRelativeListUrl;if(T)x.push("_api/web/GetList(@listUrl)");else if(l){x.push("_api/web/lists/GetById('");x.push(l);x.push("')")}else x.push("_api/web/DefaultDocumentLibrary");if(y){x.push("/RenderListDataAsStream");x.push(y);x.push(o(T));if("string"==typeof h){x.push("&InplaceSearchQuery=");x.push(r.default.encodeURIComponent(h))}return x.join("")}x.push("/RenderListDataAsStream?");T&&x.push(o(T,!0));x.push("View=");c&&x.push(c);if(w){x.push("&ViewPath=");x.push(r.default.encodeURIComponent(w))}}b&&x.push("&ViewId="+b);if("string"==typeof h){x.push("&InplaceSearchQuery=");x.push(r.default.encodeURIComponent(h))}if(p){x.push("&RootFolder=");x.push(r.default.encodeURIComponent(p))}if("string"==typeof g){x.push("&IsGroupRender=TRUE");x.push("&DrillDown=1");x.push("&GroupString="+g)}d&&x.push("&SortField="+d);v&&x.push("&SortDir="+v);m&&x.push(m);return x.join("")};function o(e,t){var n=[];if(e){t||n.push("&");n.push("@listUrl='");n.push(r.default.encodeRestUriStringToken(e));n.push("'");t&&n.push("&")}return n.join("")}t.getListRequestHeaders=function(e,t){var n,i,o,u;if(t){n=t.needsQuickLaunch;i=t.webId;o=t.siteId}e.listUrl?u="listUrl="+r.default.encodeURIComponent(e.listUrl):e.listId&&(u="list="+e.listId);i&&(u+=",webId="+i);o&&!s.Killswitch.isActivated("ade8eb60-e615-4e1f-b530-ccfbc7d1c145","11/30/2017","Pass site id to GetListDataAsStream")&&(u+=",siteId="+o);return{"X-SP-REQUESTRESOURCES":n?"NAVIGATIONSTRUCTURE,"+u:u}};t.getListEntityTypeName=function(e,t){var n=e;t&&0===e.indexOf(t)&&(n=e.replace(t,""));"/"===n.substring(0,1)&&(n=n.substring(1));0===n.toLowerCase().indexOf("lists/")&&(n=n.substr("lists/".length)+"List");for(var r=[],i=0;i<n.length;i++){var s=n.charAt(i),o=n.charCodeAt(i);if(!(o>47&&o<58||o>64&&o<91||o>96&&o<123)){s="_x"+("0000"+o.toString(16)).slice(-4)+"_"}r.push(s)}r.length>0&&1===r[0].length&&(r[0]=r[0].toUpperCase());return"SP.Data."+r.join("")+"Item"};t.getEntityPropertyName=function(e,t){var n="_"===e[0]?"OData_"+e:e;if(t)switch(t.toLowerCase()){case"lookup":n+="Id";break;case"user":case"usermulti":n+="StringId"}return n};t.getFieldType=function(e,t,n){void 0===n&&(n="Text");if(!t)return n;for(var r=0,i=t;r<i.length;r++){var s=i[r];if(s.Name===e)return s.FieldType}return n}});
define("@ms/odsp-datasources/lib/dataSources/item/spListItemRetriever/interfaces/IItemUrlHelper",["require","exports","../../../../Url"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SiteRelation=n.SiteRelation});
define("odsp-next/dataSources/item/odb/ListViewDataPrefetchHelper",["require","exports","../../../utilities/features/Features","@ms/odsp-datasources/lib/dataSources/item/spListItemRetriever/ListItemPostDataHelpers"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){this.startTimeMark=(new Date).getTime();this.deferredListData=!1},s=function(){function e(){}e.prefetchData=function(t){return e._prefetchData?e._prefetchData[t]:null};e.initPrefetchData=function(t){e._prefetchData||(e._prefetchData={});return e._prefetchData[t]=new i};e.setPrefetchData=function(t,n){e._prefetchData||(e._prefetchData={});e._prefetchData[t]=n};e.clearPrefetchData=function(t){e._prefetchData&&e._prefetchData[t]&&delete e._prefetchData[t]};e.getAdditionalPostData=function(e){e.isListDataRenderOptionChangeFeatureEnabled=n.isFeatureEnabled(n.ListDataRenderOptionChange);e.isSpotlightFeatureEnabled=n.isFeatureEnabled(n.Spotlight);return r.getAdditionalPostData(e)};e.createHashCode=function(t,n){return"listviewdataprefetch-"+e.hashCode(decodeURIComponent(t))+"-"+e.hashCode(n)};e.hashCode=function(e){var t=0;if(!e||0===e.length)return t;for(var n=0;n<e.length;n++){t=(t<<5)-t+e.charCodeAt(n);t&=t}return t};e.shouldLogError=!0;e.prefetchSignature=void 0;return e}();t.default=s});
define("@ms/odsp-datasources/lib/dataSources/item/spListItemRetriever/ListItemPostDataHelpers",["require","exports","./interfaces/IItemTypeFilter","./interfaces/IItemUrlHelper","@ms/odsp-utilities/lib/features/Features","./ListItemPostDataHelpersBasic","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-graph/lib/utilities/media/MediaUtils"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getAdditionalPostData=function(e,t){var n=e.viewXml,i=e.firstGroupOnly,o=e.expandGroups,u=e.allowMultipleValueFilterForTaxonomyFields,a=e.groupByOverride,f=e.requestDatesInUtc,l=e.groupReplace,c=e.additionalFiltersXml,h=e.mergeDefaultView,p=function(e){"undefined"!=typeof _spPageContextInfo&&_spPageContextInfo&&_spPageContextInfo.webTemplate&&(e.webTemplate=_spPageContextInfo.webTemplate);return s.getRenderOption(e)}(e),d=!(t&&t.urlParts&&t.urlParts.siteRelation===r.SiteRelation.crossSite),v=a||c?s.getOverrideViewXml({groupByField:a,additionalFiltersXml:n?void 0:c}):void 0;n&&c&&(n=s.getCombinedViewXml({viewXml:n,additionalFiltersXml:c}));var m={__metadata:{type:"SP.RenderListDataParameters"},RenderOptions:p>0?p:void 0,ViewXml:n||void 0,OverrideViewXml:v||void 0,AllowMultipleValueFilterForTaxonomyFields:u||void 0,AddRequiredFields:d||void 0,MergeDefaultView:h||void 0};f&&(m.DatesInUtc=!0);l&&(m.ReplaceGroup=!0);o&&(m.ExpandGroups=!0);i&&(m.FirstGroupOnly=!0);return JSON.stringify({parameters:m})};function a(e){var t=e.fieldSchema.Name,n=e.fieldSchema.Type,r=e.fieldSchema.Ascending&&"false"===e.fieldSchema.Ascending.toLowerCase()?"Lt":"Gt",i=e.groupingId;if("DateTime"===n){if("(null)"===i)return'<IsNotNull><FieldRef Name="'+t+'" /></IsNotNull>';try{var s=new Date(i);i=s.getUTCFullYear()+"-"+(s.getUTCMonth()+1)+"-"+s.getUTCDate()+"T00:00:00Z"}catch(e){}}else"Boolean"===n&&""===i&&(i="-1");return"<"+r+'><FieldRef Name="'+t+'" /><Value Type="'+n+'"><![CDATA['+i+"]]></Value></"+r+">"}t.getFilterXmlToFetchNextGroup=a;t.getViewXml=function(e){var t,n=e.sortField,r=e.itemIds,s=e.itemRefs,u=e.isAscending,h=e.pageSize,p=e.fetchNextGroup,d=e.lastGroup,v=e.recurseInFolders,m=e.typeFilter,g=void 0===m?{filters:[]}:m,y=e.fieldNames,b=void 0===y?[]:y,w=e.groupBy,E=void 0===w?[]:w,S=e.userIsAnonymous,x=void 0!==S&&S,T=e.requestMetaInfo,N=void 0!==T&&T,C=e.requestCommentFlags,k=void 0!==C&&C,L=e.fileTypeIconMap,A="",O="",M="",_="",D=!1;h||(h=1);if(p){A='<GroupBy Collapse="FALSE">'+E.map(function(e){return'<FieldRef Name="'+e+'"/>'}).join("")+"</GroupBy>";t=a(d)}else if(r&&r.length>0||s&&s.length>0){var P=[],H=[];if(r)for(var B=0,j=r;B<j.length;B++){var F=j[B];isNaN(Number(F))?P.push(F):H.push(F)}t=l([c("ID",1===H.length?"Number":"Counter",H),c("UniqueId","Guid",P),c("FileRef","Text",s&&s.map(function(e){return"<![CDATA["+e+"]]>"}))]);v&&(_='Scope="RecursiveAll"')}else{M=n?'<OrderBy><FieldRef Name="'+n+'" Ascending="'+u+'"></FieldRef></OrderBy>':"";D=!0}g.filters.length&&(t=f(g,{fileTypeIconMap:L}));t&&(O="<Where>"+t+"</Where>");return function(e){var t=e.viewParams,n=e.query,r=e.pageSize,s=void 0===r?30:r,u=e.includeFields,a=e.fieldNames,f=void 0===a?[]:a,l=e.userIsAnonymous,c=void 0!==l&&l,h=e.requestMetaInfo,p=void 0!==h&&h,d=e.requestCommentFlags,v=void 0!==d&&d;if(u){f=["_ip_UnifiedCompliancePolicyUIAction","ItemChildCount","FolderChildCount","SMTotalFileCount","SMTotalSize"].concat(f);if(p){var m=["MediaServiceFastMetadata","MediaServiceOCR"];i.default.isFeatureEnabled({ODB:1208})&&m.push("MediaServiceTranscript");f=m.concat(f)}v&&!o.Killswitch.isActivated("E5EBF103-91E1-4448-A794-7C8ECD2B095F","11/20/2018","Do not query for _CommentFlags in viewXml")&&(f=["_CommentFlags"].concat(f));c||(f=["SharedWith"].concat(f));f=["DocIcon","LinkFilename","Modified","Editor","FileSizeDisplay"].concat(f)}f=function(e){var t;if(e){t=[];var n=void 0;n={};for(var r=0,i=e;r<i.length;r++){var s=i[r];if(!n[s]){n[s]=!0;t.push(s)}}}return t}(f);var g="";f.length&&(g="<ViewFields>"+f.map(function(e){return'<FieldRef Name="'+e+'"/>'}).join("")+"</ViewFields>");return"<View "+t+"><Query>"+n+"</Query>"+g+'<RowLimit Paged="TRUE">'+s+"</RowLimit></View>"}({viewParams:_,query:M+A+O,pageSize:h,includeFields:D,fieldNames:b,userIsAnonymous:x,requestMetaInfo:N,requestCommentFlags:k})};function f(e,t){void 0===t&&(t={});for(var r=t.fileTypeIconMap,i=[],s=[],o=!1,a=!1,f=!1,h=0,p=e.filters;h<p.length;h++){var d=p[h];if("string"==typeof d){var v="."===d[0],m=v?d.slice(1):d;v&&s.push('<Value Type="Text">'+m+"</Value>")}else switch(d){case n.ItemTypeFilter.photo:o=!0;break;case n.ItemTypeFilter.video:a=!0;break;case n.ItemTypeFilter.folder:f=!0}}var g='<And><Eq><FieldRef Name="FSObjType" /><Value Type="Text">1</Value></Eq><Eq><FieldRef Name="SortBehavior" /><Value Type="Text">1</Value></Eq></And>';if(u.doExtFiltersHaveMediaTypesOnly({extFilters:e,allowedMediaTypes:[n.ItemTypeFilter.photo,n.ItemTypeFilter.video],fileTypeIconMap:r})){var y=(o&&r?c("File_x0020_Type","String",r.photo.extensions):"")+(a&&r?c("File_x0020_Type","String",r.video.extensions):"");i.push(y);i.push(g);return l(i)}f&&i.push(g);s.length&&i.push(c("File_x0020_Type","",s));return l(i)}t.getTypeFilterViewXml=f;function l(e){return e.reduce(function(e,t){return e&&t?"<Or>"+e+t+"</Or>":t||e})}function c(e,t,n){if(!n||0===n.length)return"";var r='<FieldRef Name="'+e+'" />',i=t?n.map(function(e){return'<Value Type="'+t+'">'+e+"</Value>"}):n;return 1===i.length?"<Eq>"+r+i[0]+"</Eq>":"<In>"+r+"<Values>"+i.join("")+"</Values></In>"}});
define("@ms/odsp-datasources/lib/dataSources/item/spListItemRetriever/interfaces/IItemTypeFilter",["require","exports","tslib","@ms/odsp-graph/lib/models/item/IItemTypeFilter"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/odsp-datasources/lib/dataSources/item/spListItemRetriever/ListItemPostDataHelpersBasic",["require","exports","@ms/odsp-utilities/lib/killswitch/Killswitch","../../../utilities/caml/CamlParsingBasic","../../../utilities/caml/CamlConstants"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){var e=new(0,window.XMLSerializer);s=function(){return e};return e};!function(e){e[e.none=0]="none";e[e.contextInfo=1]="contextInfo";e[e.listData=2]="listData";e[e.listSchema=4]="listSchema";e[e.menuView=8]="menuView";e[e.listContentType=16]="listContentType";e[e.fileSystemItemId=32]="fileSystemItemId";e[e.clientFormSchema=64]="clientFormSchema";e[e.quickLaunch=128]="quickLaunch";e[e.spotlight=256]="spotlight";e[e.visualization=512]="visualization";e[e.viewMetadata=1024]="viewMetadata";e[e.disableAutoHyperlink=2048]="disableAutoHyperlink";e[e.mediaInfo=4096]="mediaInfo";e[e.parentFolderInfo=8192]="parentFolderInfo";e[e.pageContextInfo=16384]="pageContextInfo";e[e.clientSideComponentManifest=32768]="clientSideComponentManifest";e[e.listAvailableContentTypes=65536]="listAvailableContentTypes";e[e.folderContentTypeOrder=131072]="folderContentTypeOrder";e[e.gridInitInfo=262144]="gridInitInfo"}(t.RenderOptions||(t.RenderOptions={}));var o=7,u=2,a="21";t.getRenderOption=function(e){var t=e.disableAutoHyperlink,r=e.fieldNames,i=void 0===r?[]:r,s=e.needsSchema,f=e.needsContentTypes,l=e.needsListAvailableContentTypes,c=e.needsContentTypeOrder,h=e.needsGridInitInfo,p=e.needsForms,d=e.needsQuickLaunch,v=e.needsSpotlight,m=e.needsViewMetadata,g=e.needsParentInfo,y=e.requestToken,b=e.isListDataRenderOptionChangeFeatureEnabled,w=e.isSpotlightFeatureEnabled,E=e.needUpdatePageContext,S=e.webTemplate,x=e.needClientSideComponentManifest,T=0;if(s||y){if(s){T|=o;b&&(T|=4096)}else T|=u;i.indexOf("name.FileSystemItemId")>-1&&(T|=32)}f&&(T|=16);l&&(T|=65536);c&&(T|=131072);h&&(T|=262144);n.Killswitch.isActivated("A85D5D14-0370-47F2-85F7-5D1365D6BEDB","4/23/2018","include spotlight regardless the webTemplate")?w&&v&&S&&S!==a&&(T|=258):w&&v&&(T|=258);p?T|=64:b&&(T|=4098);d&&(T|=128);m&&(T|=1536);g&&(T|=8192);E&&(T|=16384);x&&(T|=32768);t&&(T|=2048);return T};t.getOverrideViewXml=function(e){var t="",n=e.groupByField,r=e.disableGrouping,i=e.fetchNextGroupXml,s=e.additionalFiltersXml;r?t="<GroupBy />":n&&(t='<GroupBy Collapse="FALSE"><FieldRef Name="'+n+'"/></GroupBy>');var o="";i&&(o=i);s&&(o=o?"<And>"+o+s+"</And>":s);o&&(t+="<Where>"+o+"</Where>");return t&&"<Query>"+t+"</Query>"};t.getCombinedViewXml=function(e){var t=e.viewXml,n=e.additionalFiltersXml;if(t&&n)try{var o=r.getViewDomParts(t),u=o.where;if(!u){u=o.xmlDoc.createElement(i.CamlTags.where);o.query.appendChild(u)}u.innerHTML=u.innerHTML?"<And>"+u.innerHTML+n+"</And>":n;t=s().serializeToString(o.view)}catch(e){}return t}});
define("@ms/odsp-datasources/lib/utilities/caml/CamlParsingBasic",["require","exports","./CamlConstants","./CamlUtilities","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getViewDomParts=function(e){void 0===e&&(e="<View/>");var t,i,s,o,u,a=r.xmlToDom(e),f=a.documentElement;if(f.tagName!==n.CamlTags.view)throw new Error('View XML outer element tag name must be "View" (case-sensitive)');for(var l=0,c=f.childNodes.length;l<c;l++){(p=f.childNodes[l]).nodeType===Node.ELEMENT_NODE&&(p.tagName!==n.CamlTags.viewFields||t?p.tagName!==n.CamlTags.query||i?p.tagName!==n.CamlTags.rowLimit||s?p.tagName===n.CamlTags.newDocumentTemplates?o=p:p.tagName===n.CamlTags.aggregations&&(u=p):s=p:i=p:t=p)}if(!t){t=a.createElement(n.CamlTags.viewFields);f.appendChild(t)}if(!i){i=a.createElement(n.CamlTags.query);f.appendChild(i)}u&&f.appendChild(u);var h={xmlDoc:a,view:f,query:i,viewFields:t,rowLimit:s,newDocumentTemplates:o,aggregations:u};for(l=0,c=i.childNodes.length;l<c;l++){var p;(p=i.childNodes[l]).nodeType===Node.ELEMENT_NODE&&(p.tagName!==n.CamlTags.orderBy||h.orderBy?p.tagName!==n.CamlTags.groupBy||h.groupBy?p.tagName!==n.CamlTags.where||h.where||(h.where=p):h.groupBy=p:h.orderBy=p)}return h};t.parseViewFields=function(e){if(e){return Array.prototype.map.call(e.childNodes,function(e){return e.tagName===n.CamlTags.fieldRef?r.getAttr(e,n.CamlAttributes.name):void 0}).filter(function(e){return!!e})}};t.parseAggregations=function(e){if(e){var t={};t[n.CamlAttributes.name]=[];t[n.CamlAttributes.type]=[];for(var i=e.childNodes,s=0;s<i.length;s++){var o=i[s],u=r.getAttr(o,n.CamlAttributes.type);if(o.tagName===n.CamlTags.fieldRef&&u.length>0){t[n.CamlAttributes.name].push(r.getAttr(o,n.CamlAttributes.name));t[n.CamlAttributes.type].push(u)}}return t}};t.parseAggregationsToGetEffectiveAggregatesFieldsXml=function(e){if(e){for(var t="",s=e.childNodes,o=0;o<s.length;o++){var u=s[o],a=r.getAttr(u,n.CamlAttributes.type);if(u.tagName===n.CamlTags.fieldRef&&a.length>0){var f=r.getAttr(u,n.CamlAttributes.name);t+=i.format(n.CamlConstants.aggregationsField,f,a)}}return t.length?t:void 0}};t.containSmartFilters=function(e){var t=!1,n=e.where;if(n&&n.childElementCount){var r=n.querySelectorAll("[id]");r&&r.length&&(t=!0)}return t}});
define("@ms/odsp-datasources/lib/utilities/caml/CamlConstants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CamlTags={view:"View",viewFields:"ViewFields",rowLimit:"RowLimit",query:"Query",columnWidth:"ColumnWidth",orderBy:"OrderBy",groupBy:"GroupBy",where:"Where",and:"And",or:"Or",beginsWith:"BeginsWith",contains:"Contains",dateRangesOverlap:"DateRangesOverlap",eq:"Eq",greater:"Gt",greaterEq:"Geq",includes:"Includes",inTag:"In",isNotNull:"IsNotNull",isNull:"IsNull",less:"Lt",lessEq:"Leq",membership:"Membership",notEq:"Neq",notIncludes:"NotIncludes",fieldRef:"FieldRef",value:"Value",values:"Values",today:"Today",customFormatter:"CustomFormatter",newDocumentTemplates:"NewDocumentTemplates",aggregations:"Aggregations"};t.CamlAttributes={name:"Name",collapse:"Collapse",ascending:"Ascending",type:"Type",includeTimeValue:"IncludeTimeValue",paged:"Paged",offset:"Offset",offsetDays:"OffsetDays",lookupId:"LookupId",id:"id",width:"width",value:"Value"};t.CamlConstants={doctype:"application/xml",fieldNameQuery:'FieldRef[Name="{0}"]',datetimeRegex:/^(\d{4}-\d{2}-\d{2})T\d{2}:\d{2}:\d{2}Z$/,datetimeNoTimeRegex:/^(\d{4}-\d{2}-\d{2})T00:00:00Z$/,dateRegex:/^\d{4}-\d{2}-\d{2}/,todayRegex:/^\[today\]([+-]\d+)?$/i,aggregationsField:'<FieldRef Name="{0}" Type="{1}"/>'};t.default=t.CamlConstants});
define("@ms/odsp-datasources/lib/utilities/caml/CamlUtilities",["require","exports","./CamlConstants"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;window.DOMParser&&(r=new DOMParser);function i(e,t){var n=e.attributes[t]||e.attributes[t.toLowerCase()];if(n&&n.value&&n.name===t)return n.value}t.getAttr=i;function s(e,t){var r=e.createElement(n.CamlTags.fieldRef);r.setAttribute(n.CamlAttributes.name,t.fieldName);"boolean"==typeof t.isAscending&&r.setAttribute(n.CamlAttributes.ascending,t.isAscending?"TRUE":"FALSE");"boolean"==typeof t.lookupId&&r.setAttribute(n.CamlAttributes.lookupId,t.lookupId?"TRUE":"FALSE");return r}t.getFieldRefDom=s;function o(e,t,n){"boolean"==typeof n?e.setAttribute(t,n?"TRUE":"FALSE"):e.removeAttribute(t)}t.updateBooleanAttr=o;t.replaceField=function(e,t,r,u){if(r&&i(r,n.CamlAttributes.name)===t.fieldName)o(r,n.CamlAttributes.ascending,t.isAscending);else{var a=s(e,t);r?u.replaceChild(a,r):u.appendChild(a)}};t.combineFilters=function(e,t){void 0===t&&(t=n.CamlTags.and);if(e&&e.length){return""+new Array(e.length).join("<"+t+">")+e[0]+e.slice(1).map(function(e){return e+"</"+t+">"}).join("")}return""};t.xmlToDom=function(e){var t;try{t=r.parseFromString(e,n.CamlConstants.doctype)}catch(e){throw new Error("Invalid XML (exception thrown)")}if(!t.documentElement)throw new Error("Invalid XML (documentElement does not exist)");if(t.querySelector("parsererror"))throw new Error("Invalid XML (parsererror found)");return t};t.isTodayString=function(e){return n.CamlConstants.todayRegex.test(e)};t.getTodayOffset=function(e){var t=e&&e.match(n.CamlConstants.todayRegex);if(t){return parseInt(t[1],10)||0}return null};t.getTodayString=function(e){var t="[Today]";e&&(t+=(e>0?"+":"")+e);return t}});
define("odsp-next/dataSources/compliance/ComplianceTagDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../base/odb/DataRequestor","../../resources/SPOResourceKeys","../url/odb/ApiUrlHelper","../url/odb/ItemUrlHelper","../../utilities/complianceTag/ComplianceTagUtilities","./ComplianceTagDataSource.resx","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/logging/events/Verbose.event"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._pageContext=n.pageContext;r._apiUrlHelper=n.apiUrlHelper;r._itemUrlHelper=n.itemUrlHelper;r._dataRequestor=new s.default({qosName:"ComplianceTagDataSource"},{pageContext:r._pageContext});return r}t.prototype.getAvailableTagsForSite=function(){var e=this;return this._dataRequestor.getData({url:this._buildComplianceTagsListUrl(),qosName:"GetAvailableTagsForSite",method:"GET",noRedirect:!0}).then(function(t){return e._transformToComplianceTags(t.d.GetAvailableTagsForSite.results)},function(e){return i.default.wrapError(l.strings.GetAvailableTagsForSiteFailed)})};t.prototype.updateComplianceTagInBatch=function(e,t,n){if(!e||0===e.length){h.Verbose.logData({name:"ComplianceTagDataSource.EmptyItemIds",message:"Empty item IDs selected for list: "+n});return i.default.wrap([])}var r=JSON.stringify({itemIds:e,listUrl:n,complianceTagValue:t.tagValue,blockDelete:t.blockDelete,blockEdit:t.blockEdit});return this._dataRequestor.getData({url:this._buildApplyLabelOnBulkItemsUrl(),qosName:"ApplyLabelOnBulkItems",additionalPostData:r,method:"POST"}).then(function(e){return e&&e.d&&e.d.ApplyLabelOnBulkItems&&e.d.ApplyLabelOnBulkItems.results?e.d.ApplyLabelOnBulkItems.results:[]},function(e){return i.default.wrapError(e)})};t.prototype.updateComplianceTag=function(e,t){var n=t.blockEdit||t.blockDelete,r=t.blockEdit,s=t.isEventTag,o=JSON.stringify({complianceTag:t.tagValue,isTagPolicyHold:n,isTagPolicyRecord:r,isEventBasedTag:s,isTagSuperLock:t.superLock});return this._dataRequestor.getData({url:this._buildUpdateHashtagsUrl(e,"SetComplianceTag"),qosName:"SetComplianceTag",additionalPostData:o,method:"POST",noRedirect:!0}).then(function(){return t.tagName},function(e){return i.default.wrapError(e)})};t.prototype.unlockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this._dataRequestor.getData({url:this._buildUnlockRecordUrl(),qosName:"UnlockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){if(e&&e.d&&e.d.UnlockRecordItem&&e.d.UnlockRecordItem.results){var t=e.d.UnlockRecordItem.results;return f.isUnlockRecordTurnedOn(t)}return!1},function(e){return i.default.wrapError(e)})};t.prototype.lockRecord=function(e,t){var n=JSON.stringify({listUrl:t,itemId:e.properties.ID});return this._dataRequestor.getData({url:this._buildLockRecordUrl(),qosName:"LockRecordItem",additionalPostData:n,method:"POST"}).then(function(e){if(e&&e.d&&e.d.LockRecordItem&&e.d.LockRecordItem.results){var t=e.d.LockRecordItem.results;return f.isUnlockRecordTurnedOn(t)}return!1},function(e){return i.default.wrapError(e)})};t.prototype._buildComplianceTagsListUrl=function(){return this._apiUrlHelper.build().methodWithAliases("SP.CompliancePolicy.SPPolicyStoreProxy.GetAvailableTagsForSite",{siteUrl:this._pageContext.webAbsoluteUrl}).toString()};t.prototype._buildUpdateHashtagsUrl=function(e,t){var n=this._itemUrlHelper.getItemUrlParts(e.key);return this._apiUrlHelper.build().webByItemUrl(n).method("GetList",n.serverRelativeListUrl).method("items",e.properties.ID).method(t).toString()};t.prototype._transformToComplianceTags=function(e){var t=[],n={tagName:l.strings.NoneComplianceTagName,tagValue:"",blockDelete:!1,blockEdit:!1,tagDescription:l.strings.NoneComplianceTagDescription,tagTooltip:l.strings.NoneComplianceTagDescription,hasRetentionAction:!1,autoDelete:!1,isEventTag:!1,reviewerEmail:"",notes:"",displayName:"",superLock:!1};t.push(n);for(var r=0,i=e;r<i.length;r++){var s=i[r],o=f.getTagDescription(s),u=f.getTagTooltip(s),a={tagName:s.TagName,tagValue:s.TagName,blockDelete:s.BlockDelete,blockEdit:!!s.BlockEdit,tagDescription:o,tagTooltip:u,hasRetentionAction:s.HasRetentionAction,autoDelete:s.AutoDelete,isEventTag:s.IsEventTag,reviewerEmail:s.ReviewerEmail,notes:s.Notes,displayName:s.DisplayName,superLock:s.SuperLock};t.push(a)}return t};t.prototype._buildApplyLabelOnBulkItemsUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.ApplyLabelOnBulkItems").toString()};t.prototype._buildUnlockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.UnlockRecordItem").toString()};t.prototype._buildLockRecordUrl=function(){return this._apiUrlHelper.build().method("SP.CompliancePolicy.SPPolicyStoreProxy.LockRecordItem").toString()};t.dependencies=n.__assign({},r.default.dependencies,{pageContext:o.pageContext,apiUrlHelper:u.resourceKey,itemUrlHelper:a.resourceKey});return t}(r.default);t.default=p;t.resourceKey=c.createResolvedResourceKey(e("module").id,p)});
define("odsp-next/dataSources/url/odb/ApiUrlHelper",["require","exports","../../../resources/SPOResourceKeys","./ItemUrlHelper","@ms/odsp-datasources/lib/utilities/url/ApiUrlHelper","@ms/odsp-utilities/lib/resources/Resources","../../../utilities/killSwitch/KillSwitch"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=o.default.isActivated("335D0ECA-48E7-459E-9687-BE609CBBC94E","10/24/2018","Encode webUrl for api of $batch's additionalPostData");t.encodeWebAbsoluteUrlHelperKey=new s.ResourceKey({name:e("module").id+".encodeWebAbsoluteUrl",factory:new s.ConstantResourceFactory(!u)});t.resourceKey=s.createResolvedResourceKey(e("module").id,i.ApiUrlHelper,{itemUrlHelper:r.resourceKey,pageContext:n.pageContext,encodeWebAbsoluteUrl:t.encodeWebAbsoluteUrlHelperKey});t.default=i.ApiUrlHelper});
define("odsp-next/models/clientForm/ClientFormHelper",["require","exports","tslib"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.convertGroup=function e(t){if(t){var r=t.fieldSchema,i=t.children,s=n.__rest(t,["fieldSchema","children"]);return n.__assign({fieldSchema:r?n.__assign({},r,{Name:r.Name}):void 0,children:i?i.map(e):void 0},s)}}});
define("odsp-next/controls/infoPane/notification/SectionNotification",["require","exports","./SectionNotificationViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./SectionNotification.html","./SectionNotification.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-section-notification",template:e("./SectionNotification.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/infoPane/notification/SectionNotificationViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","office-ui-fabric-react/lib/Styling"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.text=t.notificationText;n.iconClass=i.getIconClassName(t.iconName||"Error");n.iconAriaLabel=t.sectionNotificationIconAriaLabel?t.sectionNotificationIconAriaLabel:"";return n}return t}(r.default);t.default=s});
define("odsp-next/controls/infoPane/notification/SectionNotification.html",[],function(){return'<div class=od-SectionNotification><i class="od-SectionNotification-icon ms-Icon" role=img data-bind="css: iconClass, attr: {\'aria-label\': iconAriaLabel}"></i><div class=od-SectionNotification-text><span data-bind="text: text" role=status></span></div></div>'});
define("odsp-next/controls/infoPane/notification/SectionNotification.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-SectionNotification{padding:12px 6px;background-color:"},{theme:"warningBackground",defaultValue:"rgba(255, 185, 0, .2)"},{rawString:";display:-ms-flexbox;display:flex}.od-SectionNotification-icon{padding-top:4px;font-size:14px}html[dir=ltr] .od-SectionNotification-icon{padding-right:4px}html[dir=rtl] .od-SectionNotification-icon{padding-left:4px}html[dir=ltr] .od-SectionNotification-icon{padding-left:2px}html[dir=rtl] .od-SectionNotification-icon{padding-right:2px}.od-SectionNotification-text{-ms-flex:1;flex:1}"}])});
define("odsp-next/actions/splist/EditItemAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-datasources/lib/Permissions","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","../odb/ActionHelper","../../resources/SPOResourceKeys","../../controls/clientForm/ClientFormDialog","../../resources/ControlResourceKeys","../../base/BaseAction","../../resources/DataSourceResourceKeys","../base/ItemCommandHelper","../../providers/clientForm/ClientFormProvider","../../models/item/command/MetadataItemCommandKeys","../../models/item/ItemParentHelper","../../providers/dialog/DialogProvider","../base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="EditItemAction";r._isFullPageApp=!!t.isFullPageApp;r._dialogProvider=r.resources.consume(g.resourceKey);r._itemParentHelper=r.resources.consume(m.resourceKey);r._itemCommandHelper=r.resources.consume(p.resourceKey);r._pageContext=r.resources.consume(a.pageContext);r._actionMap=r.resources.consume(l.actionMap);r._urlDataSource=r.resources.consume(h.url);r._itemSelectionHelper=new(r.child(y.typeResourceKey))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem(),t=e&&this.observables.unwrap(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return!!e&&!!t&&!!t.list&&t.list.templateType!==o.default.mySiteDocumentLibrary&&this._itemCommandHelper.isCommandSupported(e,v.editItem)&&i.PermissionMask.hasItemPermission(e,i.PermissionMask.editListItems)};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(t=n.sent())?u.default.isCheckedOutByOther(t,this._pageContext.userId)?[2,u.default.showCheckedOutByOtherDialog(this._dialogProvider)]:[2,this._editInFullPageClientForm(t,e)]:[2,r.default.resolve({resultCode:"EmptySelection",resultType:s.ResultTypeEnum.Failure})]}})})};t.prototype._editInFullPageClientForm=function(e,t){return this._actionMap?new(this.managed(this._actionMap.LaunchListFormAction))({type:1,item:e,url:this._urlDataSource.getEditFormUrl(e),isFullPageApp:this._isFullPageApp}).execute(t):this._editInClientFormDialog(e)};t.prototype._editInClientFormDialog=function(e){var t=this;return this.resources.consume(d.resourceKey).getClientForm({item:this.observables.create(e),clientFormType:1,contentType:e.properties.ContentType}).then(function(e){var n=t.resources.consume(g.resourceKey);return f.default.getDialog(e,n,t.resources).wait()}).then(function(){return{resultType:s.ResultTypeEnum.Success}})};return t}(c.default);t.default=b});
define("odsp-next/controls/clientForm/ClientFormDialog",["require","exports","knockout","@ms/odsp-utilities/lib/async/Promise","./DuplexClientForm","./ClientForm.resx","../../utilities/icons/Icon"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(){}e.getDialog=function(e,t,u){var a=null;return t.requestDialog({title:s.strings.TitleLabel,actions:[{name:s.strings.SaveLabel,icon:new o.default("Save"),execute:function(){null===a&&r.default.wrap(1);return a.processAndSaveChanges().then(function(e){return e?2:1})},isAvailable:n.observable(!0),isDefault:!1,automationId:"saveClientFormDialog"},{name:s.strings.CancelLabel,icon:new o.default("Cancel"),execute:function(){return r.default.wrap(3)},isAvailable:n.observable(!0),isDefault:!0,automationId:"cancelClientFormDialog"}],component:{name:i.getClientFormTagName(e,u),params:{clientForm:e,interactiveSave:!1,fieldsManagerAccessor:function(e){a=e}}},size:"XLarge"})};return e}();t.default=u});
define("odsp-next/controls/refreshClientForm/RefreshClientForm.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id+".RefreshClienForm",factory:{dependencies:{observablesFactoryType:r.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create(!1),disposable:t}}}})});
define("odsp-next/controls/infoPane/sections/properties/PropertiesSection.html",[],function(){return'<div class="InfoPane-section InfoPaneSection--properties" data-automationid=ms-properties-section data-bind="css: { \'is-expanded\': sectionHelper.isExpanded, \'no-arrow\': !sectionHelper.showArrow }"><div class=InfoPane-sectionHeader id=spo-Properties-sectionHeader data-bind="toggle: sectionHelper.isExpanded, attr: { \'aria-expanded\': sectionHelper.isExpanded(), tabindex: sectionHelper.showArrow ? 0 : -1, role: sectionHelper.showArrow ? \'button\' : \'\' }">\x3c!--ko if: sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon: true"></i>\x3c!--/ko--\x3e<span class=InfoPane-sectionHeaderText data-bind="text: clientFormTitle"></span>\x3c!--ko if: canEdit--\x3e<a class=spo-Properties-editLink data-bind="click: onEditClick, clickBubble: false, text: clientFormEditLink" href=#></a>\x3c!--/ko--\x3e</div><div class=InfoPane-sectionContent>\x3c!--ko if: isLoading--\x3e<div class=od-ClientFormFields-loadingSpinner data-bind="component: { name: loadingSpinnerTagName }"></div>\x3c!--/ko--\x3e\x3c!--ko if: propertiesErrorMessage--\x3e<div class=spo-Properties-sectionNotification data-bind="component: { name: sectionNotificationTagName, params: { notificationText: propertiesErrorMessage, sectionNotificationIconAriaLabel: sectionNotificationIconLabel } }"></div>\x3c!--/ko--\x3e\x3c!--ko if: clientForm--\x3e<div class=spo-Properties-clientForm data-bind="component: clientForm"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div></div>'});
define("odsp-next/controls/infoPane/sections/properties/PropertiesSection.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".InfoPaneSection--properties{width:100%;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.spo-Properties-editLink{line-height:26px;font-size:12px;color:"},{theme:"link",defaultValue:"#0078d4"},{rawString:";text-decoration:none}html[dir=ltr] .spo-Properties-editLink{float:right}html[dir=rtl] .spo-Properties-editLink{float:left}.ReactClientForm.is-bulkEdit{position:absolute;display:-ms-flexbox;display:flex;top:64px;left:0;right:0;-ms-flex-direction:column;flex-direction:column;overflow:hidden;width:auto}.ReactClientForm.is-bulkEdit .ReactClientFormFields{overflow-y:auto;padding:0 16px;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";width:auto}.InfoPane .spo-Properties-clientForm .ReactClientForm.is-bulkEdit{top:116px}.od-DetailsPane-LegacySection .spo-Properties-clientForm .od-ClientForm.is-bulkEdit{top:64px}.od-DetailsPane-LegacySection .spo-Properties-clientForm .ReactClientForm .ReactClientForm-editButtons{padding-bottom:43px}.spo-Properties-sectionNotification{width:100%;overflow:auto}"}])});
define("odsp-next/controls/detailsPane/section/itemShortcut/ItemShortcutSection",["require","exports","tslib","react","../../../infoPane/sections/shortcutInformation/ShortcutInformationSection","../legacy/LegacySection"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return r.createElement(s.default,{sectionControlKey:i.resourceKey,item:t,resources:n})};return t}(r.Component);t.default=o});
define("odsp-next/controls/infoPane/sections/shortcutInformation/ShortcutInformationSection",["require","exports","./ShortcutInformationSectionViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../../../bindings/component/ControlBinding","./ShortcutInformationSection.html","./ShortcutInformationSection.css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"ms-shortcutInformation-info-pane-section",template:e("./ShortcutInformationSection.html"),viewModel:n.default,synchronous:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"ms-shortcutInformation-info-pane-section",name:e("module").id,template:e("./ShortcutInformationSection.html"),viewModelType:n.default});t.default=s});
define("odsp-next/controls/infoPane/sections/shortcutInformation/ShortcutInformationSectionViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../../controls/infoPane/InfoPane.resx","@ms/odsp-utilities/lib/dateTime/DateTime","../../../../providers/engagement/Engagement","../../../../providers/item/ShortcutProvider","../../../../models/item/ItemHelper","../../../../resources/DataSourceResourceKeys","../../SectionHelper"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c="TargetPath.ShortcutInformation.Click",h=i.strings,p=function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r._item=t.item;r.strings=h;r.sectionHelper=new(r.managed(l.default));var i=r.observables,s=r.resources;r.targetItem=i.create(null);r._shortcutProvider=s.consume(u.resourceKey);r._urlDataSource=s.consume(f.url);i.compute(r._computeTargetItem);r._fileType=i.pureCompute(r._computeFileType);r._modified=i.pureCompute(r._computeModified);r.targetFileType=i.pureCompute(r._computeTargetFileType);r.targetModified=i.pureCompute(r._computeTargetModified);r.targetContainerPath=i.pureCompute(r._computeTargetContainerPath);r.targetContainerName=i.pureCompute(r._computeTargetContainerName);r.path=i.pureCompute(r._computePath);r.targetPathOnClick=function(){r.resources.consume(o.resourceKey).logData({name:c,isIntentional:!0});return!0};return r}t.prototype._computeTargetItem=function(){var e=this._item(),t=this._shortcutProvider,n=this.targetItem;n(null);t.getShortcutTargetData(e.id).then(function(e){return t.getFileByUrl(e.url)}).then(function(e){n(e)})};t.prototype._computeFileType=function(){var e=this._item();if(!e.isBundle&&void 0===e.virtualItemType)return a.getFriendlyItemType(e)};t.prototype._computeModified=function(){var e=this._item();if(!this._urlDataSource.isRecycleBin(e.queryType))return e.dateModifiedTime?s.getFullDisplayDate(e.dateModifiedTime):e.dateModified};t.prototype._computePath=function(){var e=this._item();if(!e.audio&&e.parent&&!this._urlDataSource.isRecycleBin(e.queryType)){for(var t=[],n=e;n;n=n.parent)t.unshift(n.name);return t}};t.prototype._computeTargetFileType=function(){var e=this.targetItem();return e?a.getShortcutFileType(e.Name):this._fileType()};t.prototype._computeTargetModified=function(){var e=this.targetItem();return e?s.getFullDisplayDate(e.TimeLastModified):this._modified()};t.prototype._computeTargetContainerPath=function(){var e=this.targetItem();if(e){var t=e.ServerRelativeUrl,n=e.ServerUrl,r=t.lastIndexOf("/");return n+(r>0?t.slice(0,r):t)}};t.prototype._computeTargetContainerName=function(){var e=this.targetItem();if(e){var t=e.ServerRelativeUrl,n=t.lastIndexOf("/"),r=t.lastIndexOf("/",n-1);return t.slice(r+1,n)}};t.dependencies=n.__assign({},r.default.dependencies);return t}(r.default);t.default=p});
define("odsp-next/controls/infoPane/sections/shortcutInformation/ShortcutInformationSection.html",[],function(){return'<div class="InfoPane-section InfoPaneSection--shortcutInformation" data-bind="css: { \'is-expanded\': sectionHelper.isExpanded, \'no-arrow\': !sectionHelper.showArrow }"><div class=InfoPane-sectionHeader data-bind="toggle: sectionHelper.isExpanded, attr: { \'aria-expanded\': sectionHelper.isExpanded(), tabindex: sectionHelper.showArrow ? 0 : -1, role: sectionHelper.showArrow ? \'button\' : \'\' }">\x3c!--ko if: sectionHelper.showArrow--\x3e<i class="InfoPane-sectionExpandButton ms-Icon ms-Icon--ChevronDown" data-bind="icon: true"></i>\x3c!--/ko--\x3e<span class=InfoPane-sectionHeaderText data-bind="text: strings.informationHeader"></span></div><div class="InfoPane-sectionContent InfoPaneSection-shortcutInformation"><table><tbody>\x3c!--ko if: targetFileType()--\x3e<tr><th data-bind="text: strings.informationFiletype"></th><td data-bind="text: targetFileType"></td></tr>\x3c!--/ko--\x3e\x3c!--ko if: targetModified()--\x3e<tr class=InfoPaneSection-information-groupPadding><th data-bind="text: strings.informationModified"></th><td data-bind="text: targetModified"></td></tr>\x3c!--/ko--\x3e\x3c!--ko if: targetContainerPath() && targetContainerName()--\x3e<tr><th data-bind="text: strings.informationPath"></th><td><a class=InfoPaneSection-information-targetPath data-bind="text: targetContainerName, click: targetPathOnClick, attr: { href: targetContainerPath }" target=_blank></a></td></tr>\x3c!--/ko--\x3e\x3c!--ko ifnot: targetContainerPath() && targetContainerName()--\x3e<tr><th data-bind="text: strings.informationPath"></th><td><div data-bind="foreach: { data: path }"><span class=InfoPaneSection-information-path data-bind="text: $data"></span></div></td></tr>\x3c!--/ko--\x3e</tbody></table></div></div>'});
define("odsp-next/controls/infoPane/sections/shortcutInformation/ShortcutInformationSection.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".InfoPaneSection-shortcutInformation table{border-spacing:0;width:100%}.InfoPaneSection-shortcutInformation tr:first-child td,.InfoPaneSection-shortcutInformation tr:first-child th{padding-top:0}.InfoPaneSection-shortcutInformation td,.InfoPaneSection-shortcutInformation th{padding:8px 0;width:50%;word-break:break-all}.InfoPaneSection-shortcutInformation th{vertical-align:top;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-weight:400}html[dir=ltr] .InfoPaneSection-shortcutInformation th{text-align:left}html[dir=rtl] .InfoPaneSection-shortcutInformation th{text-align:right}"}])});
define("odsp-next/controls/detailsPane/section/itemPolicy/ItemPolicySection",["require","exports","tslib","react","../../../infoPane/sections/policyTip/PolicyTipSection","../legacy/LegacySection"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return r.createElement(s.default,{sectionControlKey:i.resourceKey,item:t,resources:n})};return t}(r.Component);t.default=o});
define("odsp-next/controls/infoPane/sections/policyTip/PolicyTipSection",["require","exports","./PolicyTipSectionViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../../../bindings/component/ControlBinding","./PolicyTipSection.html","./PolicyTipSection.css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"ms-policy-tip-section",template:e("./PolicyTipSection.html"),viewModel:n.default,synchronous:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"ms-policy-tip-section",name:e("module").id,template:e("./PolicyTipSection.html"),viewModelType:n.default});t.default=s});
define("odsp-next/controls/infoPane/sections/policyTip/PolicyTipSectionViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/async/PromiseDebouncer","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../../../resources/DataSourceResourceKeys","../../../../utilities/features/Features","../../InfoPane.resx","../../../../providers/panel/PanelProvider","../../../../models/item/Item.resx","../../../policyTipMessageBar/PolicyTipMessageBar","../../../policyTipPanel/PolicyTipPanel","@ms/odsp-utilities/lib/modules/ModuleHelper","@ms/odsp-shared/lib/base/ViewModel","../../../../utilities/policyTip/PolicyTipHelper","office-ui-fabric-react/lib/Styling"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(t){n.__extends(m,t);function m(e,n){void 0===n&&(n={});var c=t.call(this,e,n)||this,h=c._item=e.item;c.viewTipLink=u.strings.policyTipLaunchDialogLink;var p=c.observables,m=c.resources;m.bind(a.resourceKey);c._panelProvider=m.consume(a.resourceKey.local);c._policyTipDataSource=m.consume(s.policyTip);c.isPolicyTipPanelEnabled=o.isFeatureEnabled(o.PolicyTipPanel);c.policyTipMessageBarTagName=l.default.tagName;c.policyTipMessageBarParams={item:h.peek(),onClick:c.onViewTipClick.bind(c)};c.policyTipInfo=p.create(null);if(c.isPolicyTipPanelEnabled){var g=new r.default;p.compute(function(){var e=h();g.debounce(c.trackPromise(c._policyTipDataSource.getPolicyTip(e).then(function(e){c.policyTipInfo(e)})))})}c.backgroundClass=p.pureCompute(function(){var e=h();if(!e||!e.policyTip)return"";var t=d.isPolicyTipFlagSet(e.policyTip,2),n=d.isPolicyTipFlagSet(e.policyTip,1);return t?"od-PolicyTipSection--block":n?"od-PolicyTipSection--notify":void 0});c.iconClass=p.pureCompute(function(){var e=h();if(!e||!e.policyTip)return"";var t=d.isPolicyTipFlagSet(e.policyTip,2),n=d.isPolicyTipFlagSet(e.policyTip,1);return t?v.getIconClassName("DRM")+" ms-fontColor-redDark":n?v.getIconClassName("IncidentTriangle")+" ms-fontColor-orange":void 0});c.text=p.pureCompute(function(){var e=h(),t=f.strings;if(!e||!e.policyTip)return"";var n=d.isPolicyTipFlagSet(e.policyTip,2),r=d.isPolicyTipFlagSet(e.policyTip,1);return n?t.policyTipBlockText:r?t.policyTipNotifyText:void 0});c.hasTip=p.pureCompute(function(){return!!(1&h().policyTip)});c.subscribe(h,function(e){e.policyTip&&i.Engagement.logData({name:"PolicyTip.InfoPaneSection.Shown"})});return c}m.prototype.onViewTipClick=function(t){var n=this,r=this._item.peek();if(!this.isPolicyTipPanelEnabled){i.Engagement.logData({name:"PolicyTip.InfoPaneSection.ViewTip.Click"});new Promise(function(t,n){e(["../../../../actions/PolicyTipAction"],t,n)}).then(h.getDefaultExport).then(function(e){new(n.resources.injected(e))({item:n.observables.create(r)}).execute(t)});return!1}var s={item:r,policyTipInfo:this.policyTipInfo.peek()};this._panelProvider.requestPanel({component:{name:c.default.tagName,params:s}})};m.dependencies=n.__assign({},p.default.dependencies);return m}(p.default);t.default=m});
define("odsp-next/controls/policyTipMessageBar/PolicyTipMessageBar",["require","exports","./PolicyTipMessageBarViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./PolicyTipMessageBar.html","./PolicyTipMessageBar.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-policy-tip-message-bar",template:e("./PolicyTipMessageBar.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/policyTipMessageBar/PolicyTipMessageBarViewModel",["require","exports","tslib","../../utilities/policyTip/PolicyTipHelper","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,i=t.item,s=t.onClick;n.item=i;n.onClick=s;var o=i.policyTip,u=r.isPolicyTipFlagSet(o,2),a=r.isPolicyTipFlagSet(o,1);n.isBlock=u;n.isNotify=!u&&a;n.isInfo=!u&&!a;n.hasPolicyTip=n.observables.create(!!o);n.messageBarAction=n.onClick;n.messageBarActionText=r.getPolicyTipActionText();n.messageBarText=r.getPolicyTipText(o);return n}return t}(i.default);t.default=s});
define("odsp-next/controls/policyTipMessageBar/PolicyTipMessageBar.html",[],function(){return"\x3c!--ko if: hasPolicyTip()--\x3e<div class=od-PolicyTipMessageBar data-bind=\"css: { 'od-PolicyTipMessageBar-block': isBlock, 'od-PolicyTipMessageBar-severeWarning': isNotify, 'od-PolicyTipMessageBar-warning': isInfo }\"><div class=od-PolicyTipMessageBar-content><div class=od-PolicyTipMessageBar-icon><i class=ms-Icon data-bind=\"icon: true, css: { 'ms-Icon--Blocked2': isBlock, 'ms-Icon--Warning': isNotify, 'ms-Icon--Info': isInfo }\"></i></div><div class=od-PolicyTipMessageBar-text><span data-bind=\"text: messageBarText\"></span> <a role=button class=od-Link href=javascript:; data-bind=\"text: messageBarActionText, click: messageBarAction\"></a></div></div></div>\x3c!--/ko--\x3e"});
define("odsp-next/controls/policyTipMessageBar/PolicyTipMessageBar.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-PolicyTipMessageBar{padding:8px;display:-ms-flexbox;display:flex}.od-PolicyTipMessageBar-content{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row}.od-PolicyTipMessageBar-text{font-size:12px;font-weight:400;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;overflow-x:auto}.od-PolicyTipMessageBar-icon{font-size:16px}[dir=ltr] .od-PolicyTipMessageBar-icon{padding-right:8px}[dir=rtl] .od-PolicyTipMessageBar-icon{padding-left:8px}.od-PolicyTipMessageBar-block{background-color:#fde7e9}.od-PolicyTipMessageBar-block .od-PolicyTipMessageBar-icon{color:#a80000}.od-PolicyTipMessageBar-severeWarning{background-color:#fed9cc}.od-PolicyTipMessageBar-severeWarning .od-PolicyTipMessageBar-icon{color:#d83b01}.od-PolicyTipMessageBar-severeWarning .od-PolicyTipMessageBar-text{color:#333}.od-PolicyTipMessageBar-warning{background-color:#fff4ce}.od-PolicyTipMessageBar-warning .od-PolicyTipMessageBar-icon{color:#333}.od-PolicyTipMessageBar-warning .od-PolicyTipMessageBar-text{color:#333}"}])});
define("odsp-next/controls/infoPane/sections/policyTip/PolicyTipSection.html",[],function(){return'<div class="od-PolicyTipSection InfoPane-section is-expanded">\x3c!--ko if: !isPolicyTipPanelEnabled--\x3e<div class=InfoPane-sectionContent data-bind="css: backgroundClass"><i class="od-PolicyTipSection-icon ms-Icon" data-bind="css: iconClass"></i><div class=od-PolicyTipSection-text><span data-bind="text: text"></span>\x3c!--ko if: hasTip--\x3e<br><a href=javascript: data-bind="click: onViewTipClick, text: viewTipLink"></a>\x3c!--/ko--\x3e</div></div>\x3c!--/ko--\x3e\x3c!--ko if: isPolicyTipPanelEnabled && policyTipInfo()--\x3e\x3c!--ko component: {\r\n name: policyTipMessageBarTagName,\r\n params: policyTipMessageBarParams\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko component: { name: \'ms-panel-host\' }--\x3e\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/infoPane/sections/policyTip/PolicyTipSection.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:"[dir=ltr] .od-PolicyTipSection.InfoPane-section{padding-left:20px}[dir=rtl] .od-PolicyTipSection.InfoPane-section{padding-right:20px}.od-PolicyTipSection .InfoPane-sectionContent{padding:8px}.od-PolicyTipSection--notify{background-color:rgba(216,59,1,.2)}.od-PolicyTipSection--block{background-color:rgba(232,17,35,.2)}.od-PolicyTipSection-icon{padding-top:2px;font-size:17px}html[dir=ltr] .od-PolicyTipSection-icon{float:left}html[dir=rtl] .od-PolicyTipSection-icon{float:right}[dir=ltr] .od-PolicyTipSection-text{margin-left:25px}[dir=rtl] .od-PolicyTipSection-text{margin-right:25px}"}])});
define("odsp-next/controls/detailsPane/section/itemSharing/ItemSharingSection",["require","exports","tslib","react","../../../infoPane/sections/sharing/SharingSection","../legacy/LegacySection"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.item,n=e.resources;return r.createElement(s.default,{sectionControlKey:i.resourceKey,item:t,resources:n})};return t}(r.Component);t.default=o});
define("odsp-next/controls/infoPane/sections/sharing/SharingSection",["require","exports","./SharingSectionViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../../../bindings/component/ControlBinding","./SharingSection.html","./SharingSection.css","../../../persona/Persona","../../../sharing/sharingLink/SharingLink"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"ms-sharing-info-pane-section",template:e("./SharingSection.html"),viewModel:n.default,synchronous:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"ms-sharing-info-pane-section",name:e("module").id,template:e("./SharingSection.html"),viewModelType:n.default});t.default=s});
define("odsp-next/controls/infoPane/sections/sharing/SharingSectionViewModel",["require","exports","tslib","../../../../providers/engagement/Engagement","../../../../bindings/html/BindableHtmlBinding","../../../../resources/ControlResourceKeys","../../InfoPane.resx","@ms/odsp-utilities/lib/string/StringHelper","../../../../bindings/toggle/ToggleBinding","../../../../bindings/tooltip/TooltipBinding","@ms/odsp-shared/lib/base/ViewModel","../../../overlays/panel/PanelOverlay","../../../dialogHost/DialogHost","./SharingSectionHelper","./SharingFacePileOption","../../../../bindings/keyboard/KeyboardBinding","../../../personaTile/PersonaTile","../../../../bindings/selection/SelectionBinding","../../../../bindings/react/ReactBinding","../../../../providers/peoplePicker/PeoplePickerProvider","../../../../utilities/peoplePicker/GraphPeoplePickerHelper","../../../../providers/sharing/SharingProvider","../../../../providers/suiteNav/SuiteNavProvider","../../../../providers/policyTip/PolicyTipProvider","../../../../controls/sharing/share/react/ShareCallout","office-ui-fabric-react/lib/Callout","../../../../utilities/features/Features","@ms/odsp-shared-sharing/lib/Share","../../../../providers/sharing/react/SharingStore"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var A=o.strings,O=function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var o=e.call(this,t,n)||this;o.personaTileTagName=m.default.tagName;o.panelOverlayTagName=c.default.tagName;o.dialogHostTagName=h.default.tagName;o.addBindingHandlers({toggle:a.default,bindableHtml:i.default,keyboard:v.default,selection:g.default,tooltip:f.default,react:y.default});o._engagement=o.resources.consume(r.resourceKey);var l=o.observables;o.permissionsFacepileCollection=l.createArray();o.infoPanePersonaTileCollection=l.createArray([]);o.groupPersonaTileCollection=l.createArray([]);o.peoplePersonaTileCollection=l.createArray([]);o.isExpanded=o.resources.consume(s.isSharingSectionExpanded.optional)||l.create(!0);o.strings=A;o.hasFocus=t.hasFocus;o.addPeopleText=A.addPeople;o.addPeopleScreenReaderText=A.addPeopleButtonName;o.viewPermissionsScreenRead=l.create("");o.openPanelActionText=A.openPanel;o.advancedText=A.advanced;o.stopSharingText=A.stopSharing;o.emailText=A.emailEveryone;o.showPermissionsPanel=l.create(!1);o.shouldShowLinks=l.create(!1);o.hasMultiLinks=l.create(!1);o.linksDetails=l.create("");o.groupsDetails=l.create("");o.numberOfGroups=l.create(0);o.totalFacePileCount=l.create(0);o.extraPersonaTooltipText=l.create("");o.showPermissionsPanelTitle=A.sharingOpenPermissionsPanelTitle;o.showPermissionsPanelHintText=A.sharingOpenPermissionsPanelHintText;o.extraPersonaText=l.create("");o.extraPersonaNumber=l.create(0);o.sharedWithGuestText=A.sharingGuestShared;o.permissionsPanelName=A.sharingPermissionsPanelName;o.isAddPeopleInReactEnabled=C.isFeatureEnabled(C.AddPeopleReact);o.shareCalloutComponent=T.default;o.shareCalloutProps=o.createPureComputed(o._computeShareCalloutComponentProps);o.shareCalloutTarget=l.create(null);o.shareCalloutActive=l.create(!1);var d=t.item;o.item=d;var b=o._sharingSectionHelper=new(o.managed(p.default))({item:d,hasFocus:t.hasFocus});o.fileName=b.fileName;o.accessSummaryScreenReaderText=l.pureCompute(o._setAccessSummary);o.sharingSectionSummary=l.pureCompute(function(){return u.format(A.sharingSectionSummary,o.fileName())});o.viewPermissionsScreenRead=l.pureCompute(function(){return u.format(A.sharingViewPermissionsScreenRead,o.fileName())});o.privateDescription=b.privateDescription;o.hasInheritedLink=b.hasInheritedLink;o.isShareLinkVisible=b.isShareLinkVisible;o.isLoading=b.isLoading;o.scopes=b.scopes;o.links=b.links;o.canUnshare=b.canUnshare;o.personaTileCollection=b.personaTileCollection;o.hasSettings=b.hasSettings;o.advancedUrl=b.advancedUrl;o.keyNav=b.keyNav;o.mailto=b.mailto;o.showEmailLink=b.showEmailLink;o.sharingApiErrorMessage=b.sharingApiErrorMessage;o._totalNumberOfLinks=b.totalNumberOfLinks;o.statusText=b.statusText;o.hasGuest=o.createPureComputed(o._calculateExternalUser);o.accessSummaryScreenReaderText=l.pureCompute(o._setAccessSummary);o.sharingSectionSummary=l.pureCompute(function(){return u.format(A.sharingSectionSummary,o.fileName())});o.viewPermissionsScreenRead=l.pureCompute(function(){return u.format(A.sharingViewPermissionsScreenRead,o.fileName())});o._actionMap=o.resources.consume(s.actionMap);o._showAction=new(o.managed(o._actionMap.ShowPermissionsAction))({item:d,engagementSource:"InfoPane"});l.compute(o._computeSparateGroupAndPeoplePersona);l.compute(o._calculateExtraPersona);l.compute(o._updateLinksData);return o}t.prototype.launchPermissionsPanel=function(e,t){this._engagement.logData({name:"ViewPermission.Sharing.InfoPaneSection.Click",isIntentional:!0});this._executeShowPermissionsPanel(t)};t.prototype.closeDialog=function(){this.onLinkRemoved()};t.prototype.onScopeClick=function(e){this._sharingSectionHelper.onScopeClick(e.scope.item)};t.prototype.onShareClick=function(e,t){this._engagement.logData({name:"AddPeopleFromInfoPane.Sharing.InfoPaneSection.Click",isIntentional:!0});if(this.isAddPeopleInReactEnabled){this.shareCalloutTarget(t.target);this.shareCalloutActive(!0)}else this._sharingSectionHelper.onShareClick()};t.prototype.onLinkRemoved=function(){this._sharingSectionHelper.onLinkRemoved()};t.prototype.onAdvancedClick=function(){this._engagement.logData({name:"AdvancedSettings.Sharing.InfoPaneSection.Click",isIntentional:!0});return!0};t.prototype.stopSharing=function(){this._sharingSectionHelper.stopSharing()};t.prototype.clickEmail=function(){this._engagement.logData({name:"EmailEveryone.Sharing.InfoPaneSection.Click",isIntentional:!0});return!0};t.prototype.moreThanOneLink=function(){return this._totalNumberOfLinks()>1};t.prototype._updateLinksData=function(){var e=this._totalNumberOfLinks();this.linksDetails(this._getLinksDetails());var t=0!==e;this.shouldShowLinks(t);var n=e>1;this.hasMultiLinks(n)};t.prototype._getLinksDetails=function(){return this._totalNumberOfLinks()>1?u.format(A.sharingLinkTitleMulti,this._totalNumberOfLinks()):A.sharingLinkTitleSingle};t.prototype._executeShowPermissionsPanel=function(e){this._showAction.execute(e).done()};t.prototype._computeSparateGroupAndPeoplePersona=function(){var e=this.personaTileCollection(),t=[],n=[];if(!this.showPermissionsPanel())for(var r=0,i=e;r<i.length;r++){var s=i[r];2===s.personaParams.person().entityType?t.push(s):n.push(s)}this.groupPersonaTileCollection(t.slice());this.peoplePersonaTileCollection(n);this.numberOfGroups(t.length);this.groupsDetails(this._getGroupsDetails())};t.prototype._getGroupsDetails=function(){return this.numberOfGroups()>1?u.format(A.sharingGroupTitleMulti,this.numberOfGroups()):A.sharingGroupTitleSingle};t.prototype._getAllUsers=function(e){for(var t={},n=0,r=e;n<r.length;n++){t[(f=r[n]).personaParams.person().userId]=!0}for(var i=0,s=this.links();i<s.length;i++){var o=s[i];if(o.linkMembers)for(var u=0,a=o.linkMembers;u<a.length;u++){var f,l=a[u],c=(f=this._sharingSectionHelper.convertPersonToPersonaTile(this.createObservable(l),l.userId)).personaParams.person.peek().userId;if(!t[c]){t[c]=!0;e.push(f)}}}return e};t.prototype._calculateExternalUser=function(){for(var e=0,t=this.peoplePersonaTileCollection();e<t.length;e++){if(t[e].personaParams.person().isExternal)return!0}for(var n=0,r=this.links();n<r.length;n++){var i=r[n];if(5===i.kind||4===i.kind)return!0;for(var s=0,o=i.linkInvitees;s<o.length;s++){if(o[s].isExternal)return!0}}return!1};t.prototype._calculateExtraPersona=function(){var e=(0===this._totalNumberOfLinks()?0:1)+(0===this.numberOfGroups()?0:1),t=this._getAllUsers(this.peoplePersonaTileCollection()),n=t.length,r=0;if(1+e+t.length>7){n=7-e-2;r=6}else r=e+t.length;var i=t.length-n;this.extraPersonaNumber(i);i>=99?this.extraPersonaText(A.sharingExtraNumberOverflow):this.extraPersonaText(u.format(A.sharingExtraNumberText,i));this.extraPersonaTooltipText(u.format(A.sharingMoreTitle,i));this.infoPanePersonaTileCollection(t.slice(0,n));this.totalFacePileCount(r);this._setFacepileContent()};t.prototype._setAccessSummary=function(){var e=this._totalNumberOfLinks()+" "+u.getLocalizedCountValue(A.sharinglocTextLink,A.sharingIntervals,this._totalNumberOfLinks());e+=" "+this.numberOfGroups()+" "+u.getLocalizedCountValue(A.sharinglocTextGroup,A.sharingIntervals,this.numberOfGroups());for(var t=0,n=this.infoPanePersonaTileCollection();t<n.length;t++){e+=" "+n[t].personaParams.person().name}this.extraPersonaNumber()&&(e+=" "+u.format(A.sharingAccessSummaryMore,this.extraPersonaNumber()));this.hasGuest()?e+=" "+u.format(A.sharingAccessSummarySharedWithGuest,this.fileName()):this.privateDescription()&&(e+=" "+A.sharingAccessSummaryNotShared);return e};t.prototype._setFacepileContent=function(){var e=0,t=[],n=this.infoPanePersonaTileCollection();if(this.shouldShowLinks()){var r=u.format(A.sharingLinksScreenRead,this.linksDetails(),this.fileName()),i=new d.default({key:e,linkNum:this._totalNumberOfLinks(),screenReadText:this.createObservable(r)});t.push(i);e++}if(this.numberOfGroups()){var s=u.format(A.sharingGroupsScreenRead,this.groupsDetails(),this.fileName()),o=new d.default({key:e,groupNum:this.numberOfGroups(),screenReadText:this.createObservable(s),personaTile:this.groupPersonaTileCollection()[0]});t.push(o);e++}for(var a=0,f=n;a<f.length;a++){var l=f[a],c=l.personaParams.person().name,h=u.format(A.sharingPersonaScreenRead,c,this.fileName()),p=new d.default({key:e,screenReadText:this.createObservable(h),personaTile:l});t.push(p);e++}if(this.extraPersonaNumber()){var v=u.format(A.sharingExtraPeopleScreenRead,this.extraPersonaNumber().toString()),m=new d.default({key:e,extraPersona:this.extraPersonaNumber(),screenReadText:this.createObservable(v)});t.push(m);e++}this.permissionsFacepileCollection(t)};t.prototype._computeShareComponentProps=function(){var e=this.resources.consume(b.resourceKey),t=this.resources.consume(w.resourceKey),n=this.resources.consume(E.resourceKey),r=this.resources.consume(S.resourceKey),i=this.resources.consume(x.resourceKey);if(this.item()){var s=this.item(),o=new L.default({item:this.item.peek(),accessChecked:!1,sharingInformation:null,defaultRecipients:[],mode:k.Mode.addPeople,sharingContextInformation:null},{sharingProvider:n,suiteNavProvider:r,peoplePickerProvider:e,policyTipProvider:i,graphPeoplePickerHelper:t});return{actionMap:this._actionMap,copyLinkShortcut:!1,item:s,peoplePickerProvider:e,graphPeoplePickerHelper:t,resources:this.resources,sharingInformation:null,sharingProvider:n,policyTipProvider:i,maxHeight:void 0,defaultRecipients:[],mode:k.Mode.addPeople,sharingStore:o}}};t.prototype._computeCalloutComponentProps=function(){var e=this;return{target:this.shareCalloutTarget(),hidden:!this.shareCalloutActive(),directionalHint:N.DirectionalHint.leftTopEdge,gapSpace:6,onDismiss:function(){e.shareCalloutActive(!1)}}};t.prototype._computeShareCalloutComponentProps=function(){return{shareProps:this._computeShareComponentProps(),calloutProps:this._computeCalloutComponentProps()}};t.dependencies=n.__assign({},l.default.dependencies);return t}(l.default);t.default=O});
define("odsp-next/controls/infoPane/sections/sharing/SharingFacePileOption",["require","exports","knockout"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.focused=n.observable(!1);this.index=e.key;this.linkNum=e.linkNum;this.groupNum=e.groupNum;this.personaTile=e.personaTile;this.extraPersona=e.extraPersona;this.screenReadText=e.screenReadText;this._disablePictureAlt()}e.prototype._disablePictureAlt=function(){this.personaTile&&(this.personaTile.personaParams.disablePictrueAlt=!0)};return e}();t.default=r});
define("odsp-next/controls/sharing/share/react/ShareCallout",["require","exports","tslib","office-ui-fabric-react/lib/Callout","./Share","react"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props.calloutProps,t=this.props.shareProps;return s.createElement(r.Callout,n.__assign({},e),s.createElement(i.default,n.__assign({onDismiss:e.onDismiss},t)))};return t}(s.Component);t.default=o});
define("odsp-next/controls/infoPane/sections/sharing/SharingSection.html",[],function(){return'\x3c!--ko if: !sharingApiErrorMessage()--\x3e<div class=od-SharingSection-PermissionsPile role=region data-bind="attr: { \'aria-label\': sharingSectionSummary }"><div class=InfoPane-sectionHeader><h2 class=InfoPane-sectionHeaderText data-bind="text: strings.sharingHasAccess"></h2></div>\x3c!--ko if: isLoading()--\x3e<div class=SharingSection-status data-bind="text: statusText"></div>\x3c!--/ko--\x3e\x3c!--ko if: !isLoading()--\x3e<div class=od-SharingSection-PermissionsPile-personas>\x3c!--ko if: isShareLinkVisible--\x3e<div class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role=button tabindex=0 data-bind="tooltip: { content: addPeopleText }, keyboard: { Enter: onShareClick, Space: onShareClick }, click: onShareClick, attr: { \'aria-label\': addPeopleScreenReaderText }"><div class=od-SharingSection-PermissionsPile-addFriend><i class="ms-Icon ms-Icon--AddFriend" data-bind="icon: true"></i></div></div>\x3c!--ko if: isAddPeopleInReactEnabled--\x3e<div data-bind="react: { componentType: shareCalloutComponent, props: shareCalloutProps }"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if: !privateDescription()--\x3e<div class=ms-accessible data-bind="text: accessSummaryScreenReaderText"></div><ul class=od-PermissionPile-FacePile>\x3c!--ko foreach: permissionsFacepileCollection--\x3e\x3c!--ko if: linkNum--\x3e<li class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role=button tabindex=0 data-bind="tooltip: { content: $parent.linksDetails() }, keyboard: { Enter: $parent.launchPermissionsPanel.bind($component), Space: $parent.launchPermissionsPanel.bind($component) }, click: $parent.launchPermissionsPanel.bind($component), attr: { \'aria-label\': screenReadText, \'setsize\': $parent.totalFacePileCount(), \'posinset\': index+1 }"><div class=od-SharingSection-PermissionsPile-personaIcon data-bind="css:{ \'od-SharingSection-PermissionsPile-personaIcon--many\': $parent.hasMultiLinks() }"><i class="ms-Icon ms-Icon--Link" data-bind="icon: true"></i>\x3c!--ko if: linkNum > 1--\x3e<div class=od-SharingSection-PermissionsPile-numberText data-bind="text: linkNum.toString()"></div>\x3c!--/ko--\x3e</div></div></li>\x3c!--/ko--\x3e\x3c!--ko if: groupNum > 1--\x3e<li class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role=button tabindex=0 data-bind="tooltip: { content: $parent.groupsDetails() }, keyboard: { Enter: $parent.launchPermissionsPanel.bind($component), Space: $parent.launchPermissionsPanel.bind($component) }, click: $parent.launchPermissionsPanel.bind($component), attr: { \'aria-label\': screenReadText }"><div class=od-SharingSection-PermissionsPile-personaIcon data-bind="css: { \'od-SharingSection-PermissionsPile-personaIcon--many\': groupNum > 1 }"><i class="ms-Icon ms-Icon--Group" data-bind="icon: true"></i><div class=od-SharingSection-PermissionsPile-numberText data-bind="text: groupNum"></div></div></div></li>\x3c!--/ko--\x3e\x3c!--ko if: personaTile && (!groupNum || groupNum === 1 && !$parent.showPermissionsPanel())--\x3e<li class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role=button tabindex=0 data-bind="tooltip: { content: personaTile.personaParams.person().name }, keyboard: { Enter: $parent.launchPermissionsPanel.bind($component), Space: $parent.launchPermissionsPanel.bind($component) }, click: $parent.launchPermissionsPanel.bind($component), attr: { \'aria-label\': screenReadText }"><div class=od-PersonaTile-Persona data-bind="component: { name: \'od-persona\', params: personaTile.personaParams }"></div></div></li>\x3c!--/ko--\x3e\x3c!--ko if: extraPersona--\x3e<li class="od-Persona od-Persona--xs"><div class="od-Persona-image od-SharingSection-PermissionsPile-personaBorder" role=button tabindex=0 data-bind="tooltip: { content: $parent.extraPersonaTooltipText }, keyboard: { Enter: $parent.launchPermissionsPanel.bind($component), Space: $parent.launchPermissionsPanel.bind($component) }, click: $parent.launchPermissionsPanel.bind($component), attr: { \'aria-label\': screenReadText }"><div class=od-SharingSection-PermissionsPile-personaMore><div class=od-SharingSection-PermissionsPile-moreNumber data-bind="text: $parent.extraPersonaText"></div></div></div></li>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</ul>\x3c!--/ko--\x3e</div>\x3c!--ko if: privateDescription() && !hasInheritedLink()--\x3e<div class=od-SharingSection-PermissionsPile-description><i class="ms-Icon ms-Icon--Lock" data-bind="icon: true"></i><div class=od-SharingSection-PermissionsPile-descriptionText data-bind="text: privateDescription"></div></div>\x3c!--/ko--\x3e\x3c!--ko if: hasGuest--\x3e<div class=od-SharingSection-PermissionsPile-description><i class="ms-Icon ms-Icon--Globe" data-bind="icon: true"></i><div class=od-SharingSection-PermissionsPile-descriptionText data-bind="text: sharedWithGuestText"></div></div>\x3c!--/ko--\x3e<div class=ms-font-s><a href=javascript:; class=od-Link data-bind="tooltip: { content: showPermissionsPanelTitle }, click: launchPermissionsPanel, attr: { \'aria-label\': viewPermissionsScreenRead }"><span data-bind="text: showPermissionsPanelHintText"></span></a></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/detailsPane/section/itemStatus/ItemStatusSection",["require","exports","react","office-ui-fabric-react/lib/Icon","../../../../controls/infoPane/InfoPane.resx","../../../infoPane/sections/itemStatus/ItemStatusSection.css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t=e.items.length>1?i.strings.externalItemsMessage:i.strings.externalItemMessage;return n.createElement("div",{className:"od-DetailsPane-LegacySection"},n.createElement("div",{className:"InfoPane-section InfoPaneSection--itemStatus no-arrow"},n.createElement(r.Icon,{className:"itemStatus-icon",iconName:"Globe"}),n.createElement("div",{className:"itemStatus-message"},t)))}});
define("odsp-next/controls/infoPane/sections/itemStatus/ItemStatusSection.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".InfoPaneSection--itemStatus{display:-ms-flexbox;display:flex}html[dir=ltr] .InfoPaneSection--itemStatus .itemStatus-icon{margin-right:8px}html[dir=rtl] .InfoPaneSection--itemStatus .itemStatus-icon{margin-left:8px}.InfoPaneSection--itemStatus .itemStatus-message{font-size:14px;font-weight:400}"}])});
define("odsp-next/controls/detailsPane/section/malwareDetected/MalwareDetectedSection",["require","exports","tslib","react","../../../malwareDetected/malwareDetectedMessage/MalwareDetectedMessage"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(r.Fragment,null,i.malwareDetectedMessage())};return t}(r.Component);t.default=s});
define("odsp-next/controls/detailsPane/globalSettings/GlobalSettingsMenu",["require","exports","tslib","react","../../../resources/DataSourceResourceKeys","../../../models/item/ItemParentHelper","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/common/DirectionalHint","office-ui-fabric-react/lib/Dialog","../../../models/itemActivity/ItemActivityFeedHelper","@ms/odsp-datasources/lib/Permissions","../../../providers/itemActivities/ItemCommentsStore","../../../models/comments/ItemActivityCommentsFeature.key","../../../utilities/item/ListItemTypeConverter","./GlobalSettingsMenu.resx","../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onDeleteAllConfirm=function(){var e=r.props.items,t=r.state.currentUserEmail,n=r._getSelectedItem(e),i=r._getCommentItemWrapper(n);r._itemCommentsStore.deleteAllComments(i,t).done();r._onDismissDeleteAllDialog()};r._onDismissDeleteAllDialog=function(){r.setState({hideDeleteAlldialog:!0})};r._isNewHelperEnabled=v.isFeatureEnabled(v.ActivityFeedRefactoring);r._resources=t.resources;r._isNewHelperEnabled?r._itemActivityFeedHelper=r._resources.consume(i.itemActivityFeedHelper):r._oldItemActivityFeedHelper=new(r._resources.injected(f.default));r._itemCommentsStore=r._resources.consume(c.resourceKey);r._itemParentHelper=r._resources.consume(s.resourceKey);var o=r._resources.consume(i.identity);r._isCommentsInActivityFeedEnabled=r._resources.consume(h.resourceKey);r.state={graphDataSource:r._resources.consume(i.graph.optional),hideDeleteAlldialog:!0,currentUserEmail:o.getIdentity().loginName};return r}t.prototype.componentDidMount=function(){var e=this;this.state.graphDataSource||this._resources.consumeAsync(i.graph).then(function(t){e.setState({graphDataSource:t})})};t.prototype.render=function(){var e=this.props.items,t=this._getSelectedItem(e),n=this._getMenuItems(t);return n?r.createElement(r.Fragment,null,r.createElement(o.IconButton,{className:"od-DetailsPane-GlobalSettingsMenu",role:"button",iconProps:{iconName:"More"},onRenderMenuIcon:function(){},menuProps:{directionalHint:u.DirectionalHint.bottomAutoEdge,isBeakVisible:!1,gapSpace:0,shouldFocusOnMount:!0,items:n}}),r.createElement(a.Dialog,{hidden:this.state.hideDeleteAlldialog,onDismiss:this._onDismissDeleteAllDialog,dialogContentProps:{type:a.DialogType.normal,title:d.strings.confirmDeleteAllComments}},r.createElement(a.DialogFooter,null,r.createElement(o.DefaultButton,{disabled:!1,onClick:this._onDeleteAllConfirm,text:d.strings.deleteButtonConfirm}),r.createElement(o.DefaultButton,{disabled:!1,primary:!0,onClick:this._onDismissDeleteAllDialog,text:d.strings.deleteButtonCancel})))):null};t.prototype._getMenuItems=function(e){var t=this,n=this._getIsCommentDisabledSetting(e);if(e&&this._userCanManageCommentsSettings(e)){var r={key:"detailsPaneItem.enabledDisableComments",name:n?d.strings.globalSettingsEnableComments:d.strings.globalSettingsDisableComments,onClick:function(r,i){var s=!n,o=t._getCommentItemWrapper(e);t._itemCommentsStore.setCommentsDisabled(o,s,t.state.currentUserEmail)}},i={key:"detailsPaneItem.deleteAllComments",name:d.strings.globalSettingsDeleteAllComments,onClick:function(e,n){t.setState({hideDeleteAlldialog:!1})}},s=[r];n||s.push(i);return s}};t.prototype._userCanManageCommentsSettings=function(e){return l.PermissionMask.hasItemPermission(e,l.PermissionMask.editListItems)};t.prototype._getSelectedItem=function(e){var t=1===e.length&&e[0].peek();return this._isNewHelperEnabled?t&&this._itemActivityFeedHelper.isNonOfficeFileCommentsAvailable(t)?t:void 0:t&&f.isNonOfficeFileCommentsAvailable(t,this._isCommentsInActivityFeedEnabled)?t:void 0};t.prototype._getCommentItemWrapper=function(e){var t,n;if(this._isNewHelperEnabled){t=this._itemActivityFeedHelper.getGraphItemUrl(e,this.state.graphDataSource);n=this._itemActivityFeedHelper.getAccessToken(e,this.state.graphDataSource)}else{t=this._oldItemActivityFeedHelper.getGraphItemUrl(e,this.state.graphDataSource);n=this._oldItemActivityFeedHelper.getAccessToken(e,this.state.graphDataSource)}if(t&&n){var r=this._itemParentHelper.getFacetedAncestorOrSelf(e,"list");return{item:p.convertToISPListItem(e),activityItemWrapper:{name:e.displayName,graphItemUrl:t,accessToken:n},parentListId:r.peek().list&&r.peek().list.id}}};t.prototype._getIsCommentDisabledSetting=function(e){return e&&e.comments&&e.comments.settings&&!!e.comments.settings.isCommentDisabled};return t}(r.Component);t.default=m});
define("odsp-next/controls/detailsPane/pane/primary/PrimaryPane.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-DetailsPane-PrimaryPane-wrapper{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.isFluent .od-DetailsPane-PrimaryPane-wrapper{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-DetailsPane-PrimaryPane{padding-bottom:12px}.od-DetailsPane-PrimaryPane--isCollapsed .od-DetailsPane-PrimaryPane{padding-bottom:0}.od-DetailsPane-PrimaryPane-header{padding:10px 16px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:14px;box-shadow:0 1px 3px rgba(0,0,0,.08);background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";display:-ms-flexbox;display:flex}.od-DetailsPane-PrimaryPane-header-icon{display:inline-block}.od-DetailsPane-PrimaryPane-header-icon .FileTypeIcon-icon{width:20px!important;height:20px!important}.od-DetailsPane-PrimaryPane-header-title{margin:0 0 0 12px;line-height:23px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;-ms-flex-positive:1;flex-grow:1;font-size:14px}.isFluent .od-DetailsPane-PrimaryPane-header-title{font-weight:600}.od-DetailsPane-PrimaryPane-body{position:relative}.od-DetailsPane-PrimaryPane--isCollapsed .od-DetailsPane-PrimaryPane-body{height:0;overflow:hidden}"}])});
define("odsp-next/controls/detailsPane/pane/secondary/SecondaryPane",["require","exports","tslib","react","../../parentHeightWatcher/ParentHeightWatcher","office-ui-fabric-react/lib/Sticky","../../DetailsPane.resx","../../DetailsPaneSectionList","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Utilities","./SecondaryPane.css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.componentDidMount=function(){if(this._headerDiv){this._onHeaderHeightChange();this._events.on(window,"resize",this._onHeaderHeightChange)}};t.prototype.shouldComponentUpdate=function(e,t){return e.items!==this.props.items||e.sectionGroup!==this.props.sectionGroup||e.minHeight!==this.props.minHeight||e.onHeightChange!==this.props.onHeightChange||e.onHeaderHeightChange!==this.props.onHeaderHeightChange||e.resources!==this.props.resources};t.prototype.componentDidUpdate=function(e){e.sectionGroup.sections.length&&this.props.sectionGroup.sections.length||e.sectionGroup.sections.length===this.props.sectionGroup.sections.length||this._onHeaderHeightChange()};t.prototype.componentWillUnmount=function(){this._headerDiv&&this._events.off(window,"resize",this._onHeaderHeightChange)};t.prototype.render=function(){var e=this,t=this.props,n=t.sectionGroup,o=t.onHeightChange,u=t.minHeight;return r.createElement("div",{className:"od-DetailsPane-SecondaryPane-wrapper",style:{minHeight:n.sections.length&&u||0}},r.createElement("div",{className:f.css("od-DetailsPane-SecondaryPane",{"od-DetailsPane-SecondaryPane--disabled":!n.sections.length})},r.createElement("div",{ref:function(t){e._headerDiv=t}},r.createElement(s.Sticky,{stickyPosition:s.StickyPositionType.Both},this._renderSectionsHeader())),r.createElement("div",{className:"od-DetailsPane-SecondaryPane-body"},r.createElement(i.default,{onHeightChange:o},this._renderSectionsBody()))))};t.prototype._renderSectionsHeader=function(){var e=this.props,t=e.sectionGroup,n=e.onHeaderClick,i=e.isHeaderClickDisabled;return r.createElement("button",{className:f.css("od-DetailsPane-SecondaryPane-header",{"od-DetailsPane-SecondaryPane-header--disabled":!t.sections.length,"od-DetailsPane-SecondaryPane-header--headerClickDisabled":i}),tabIndex:i?-1:void 0,onClick:i?void 0:n},r.createElement("div",{className:"od-DetailsPane-SecondaryPane-header-icon"},r.createElement(a.Icon,{iconName:"GripperBarHorizontal"})),r.createElement("h2",{className:"od-DetailsPane-SecondaryPane-header-text"},o.strings.moreDetailsTitle))};t.prototype._renderSectionsBody=function(){var e=this.props,t=e.items,n=e.sectionGroup,i=e.resources;return r.createElement(u.default,{items:t,sections:n.sections,resources:i})};t.prototype._onHeaderHeightChange=function(){if(this.props.onHeaderHeightChange){var e=this._headerDiv.clientHeight;this.props.onHeaderHeightChange(e)}};return t}(f.BaseComponent);t.default=l});
define("odsp-next/controls/detailsPane/pane/secondary/SecondaryPane.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-DetailsPane-SecondaryPane-wrapper{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-DetailsPane-SecondaryPane{padding-bottom:12px;box-shadow:0 -1px 6px rgba(0,0,0,.01)}.od-DetailsPane-SecondaryPane.od-DetailsPane-SecondaryPane--disabled{padding-bottom:0}.od-DetailsPane-SecondaryPane-header{padding:0 16px;text-align:center;height:48px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";box-shadow:0 -1px 6px rgba(0,0,0,.01);font-size:12px;border:0;width:100%;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.isFluent .od-DetailsPane-SecondaryPane-header{font-size:12px}.ms-ScrollablePane-stickyAbove .od-DetailsPane-SecondaryPane-header{box-shadow:0 -1px 3px rgba(0,0,0,.01)}.od-DetailsPane-SecondaryPane-header:hover{cursor:pointer}.od-DetailsPane-SecondaryPane-header--headerClickDisabled:hover{cursor:default}.od-DetailsPane-SecondaryPane-header--disabled{display:none}.od-DetailsPane-SecondaryPane-body{position:relative}.od-DetailsPane-SecondaryPane-header-icon{padding-top:3px;font-size:17px}.isFluent .od-DetailsPane-SecondaryPane-header-icon{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-DetailsPane-SecondaryPane-header-text{margin:0;font-size:12px;font-weight:400}"}])});
define("odsp-next/controls/detailsPane/DetailsPane.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-DetailsPaneWrapper{position:absolute;top:0;bottom:0;left:0;right:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}html[dir=ltr] .od-DetailsPaneWrapper{border-left:1px solid "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}html[dir=rtl] .od-DetailsPaneWrapper{border-right:1px solid "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-DetailsPane{height:100%;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-DetailsPane--secondaryPaneDisabled{background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.od-DetailsPane-scrollablePane{overflow-x:hidden}.od-DetailsPane-GlobalSettingsMenu{height:unset}"}])});
define("odsp-next/controls/detailsPaneHost/legacy/LegacyDetailsPaneHost.html",[],function(){return'\x3c!--ko if: useNewDetailsPane--\x3e<div data-bind="react: { componentType: detailsPaneComponentType, props: detailsPaneProps }"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: useNewDetailsPane--\x3e\x3c!--ko control: {\r\n specification: knockoutSpecification,\r\n placeholder: knockoutPlaceholder\r\n }--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e'});
define("odsp-next/controls/infoPane/InfoPane",["require","exports","./InfoPaneViewModel","../../bindings/component/ControlBinding","./InfoPane.html","./InfoPane.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"ms-info-pane",name:e("module").id,template:e("./InfoPane.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/infoPane/InfoPaneViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../bindings/toggle/ToggleBinding","@ms/odsp-utilities/lib/string/StringHelper","./InfoPane.resx","../detailsPane/IsDetailsPaneExpanded","../../resources/DataSourceResourceKeys","../../bindings/clientRect/ClientRectBinding","../../utilities/browser/ResponsiveUI","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../../bindings/focus/DelayedHasFocusBinding","../../bindings/focus/PreserveFocusBinding","../../utilities/features/Features","../../bindings/scrollContainer/ScrollContainerBinding","./FocusedInfoPaneSection.key","../../dataSources/url/QueryType","../../actions/base/ItemSelectionHelper","../../dataSources/infoPane/InfoPaneManager.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=o.strings,S=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({scrollContainer:m.default,toggle:i.default,clientRect:f.default,preserveFocus:d.default,delayedHasFocus:p.default});var s=r.observables;r._showSections=t.showSections||s.create(!0);r._responsiveUI=n.responsiveUI;r._sectionWithFocus=n.sectionWithFocus;r._isExpanded=n.isInfoPaneExpanded;r._urlDataSource=n.urlDataSource;r.ariaLabel=E.infoPaneAriaLabel;r.screenReaderInformation=E.screenReaderInformation;r.isPaneFocused=s.create(!1);r._allSections=s.createArray();r._itemSelectionHelper=new(r.scope.attached(n.itemSelectionHelperType))({allowMultiSelect:!1,canFallback:!0});r._wasEverExpanded=s.pureCompute(r._computeWasEverExpanded);(r.item=s.pureCompute(r._computeItem).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}})).equalityComparer=h.objectStrictEquality;r.selectionMessage=s.pureCompute(r._computeSelectionMessage);r.availableSections=r._getAvailableSections();r.size=s.create();r.size.equalityComparer=c.deepCompare;r.sizeCss=s.pureCompute(r._computeSizeCss).extend({rateLimit:500});s.backgroundCompute(r._computeAllSections);r.isEnabledInfoPaneStickyHeader=s.create(!1);r.isEnabledInfoPaneStickyHeader(r._checkDriveFeed());return r}t.prototype._computeWasEverExpanded=function(){return this._wasEverExpanded.peek()||this._isExpanded()};t.prototype._computeAllSections=function(){var e=this,t=this._sectionWithFocus;this._showSections()&&this._wasEverExpanded()&&this.resources.consumeAsync(w.typeResourceKey).then(function(n){for(var r,i,s=new(e.scope.attached(n))({}),o=(r=[]).concat.apply(r,s.getSectionGroups().map(function(e){return e.sections})),u=0,a=o;u<a.length;u++){var f=a[u],l=!1;if(t&&t.peek()===f.type){l=!0;i=f}f.legacyComponent.params={item:e.item,hasFocus:l}}t&&t(void 0);e._allSections(o);e.isPaneFocused(!i)})};t.prototype._getAvailableSections=function(){var e=this;return this.addDisposable(this._allSections.filter(function(t){var n=e.item();e.isEnabledInfoPaneStickyHeader(e._checkDriveFeed());if((7===t.type||0===t.type)&&v.isFeatureEnabled(v.SPListBulkEditItemProperties)){var r=e._itemSelectionHelper.selection().map(function(t){return e.observables.unwrap(t)});r&&0!==r.length||!n||(r=[n]);return!!r&&t.isAvailable(r)}return!!n&&t.isAvailable([n])}))};t.prototype._computeItem=function(){return this._itemSelectionHelper.firstItem()};t.prototype._computeSelectionMessage=function(){var e=this._computeSelectionLength();if(e>1&&!v.isFeatureEnabled(v.SPListBulkEditItemProperties))return s.format(E.selectedItemsFormatString,e)};t.prototype._computeSelectionLength=function(){return this._itemSelectionHelper.selection().length};t.prototype._computeSizeCss=function(){var e=this.size(),t=this._responsiveUI,n=l.default.determineWindowSize(e&&e.width||319);this.availableSections().length<5&&t.compareSize(n,"Large")>0&&(n="Large");return l.default.determineCssClass(n)};t.prototype._checkDriveFeed=function(){var e=this.item();if(!e)return!1;var t=this._urlDataSource.getKeyParams(e.key);return v.isFeatureEnabled(v.EnableInfoPaneStickyHeader)&&v.isFeatureEnabled(v.EnableNewActivityFeed)&&!!e.isRootFolder&&this._urlDataSource.getQueryType(t)===y.default.Files};t.dependencies=n.__assign({},r.default.dependencies,{itemSelectionHelperType:b.typeResourceKey,responsiveUI:l.resourceKey,urlDataSource:a.url,sectionWithFocus:g.focusedInfoPaneSectionResourceKey,isInfoPaneExpanded:u.resourceKey});return t}(r.default);t.default=S});
define("odsp-next/controls/infoPane/InfoPane.html",[],function(){return'<div aria-live=assertive><div role=alert class=ms-accessible data-bind="text: screenReaderInformation"></div></div><div class=InfoPane role=dialog tabindex=0 data-automationid=ms-info-pane data-bind="attr: {\'aria-label\': ariaLabel}, preserveFocus, class: \'od-InfoPane--\' + sizeCss(), delayedHasFocus: isPaneFocused, scrollContainer: {}, clientRect: { size: size }, css: {\'InfoPane-BackgroundColor\': isEnabledInfoPaneStickyHeader }">\x3c!--ko foreach: availableSections--\x3e\x3c!--ko component: legacyComponent--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: selectionMessage--\x3e<div class="InfoPane-selectionMessage ms-font-l" data-bind="text: selectionMessage"></div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/infoPane/InfoPane.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".InfoPane{box-sizing:border-box;outline:0;position:absolute;top:0;bottom:0;left:0;right:0;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch}.InfoPane::after,.InfoPane::before{display:table;content:'';line-height:0}.InfoPane::after{clear:both}.InfoPane-BackgroundColor{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.InfoPane-sectionHeaderText{font-size:17px;font-weight:300;margin-top:0;margin-bottom:0}.isFluent .InfoPane-sectionHeaderText{font-size:14px;font-weight:600}.InfoPane-section{padding:20px 20px 22px 40px;box-sizing:border-box;display:inline-block;width:100%}html[dir=rtl] .InfoPane-section{padding:20px 40px 22px 20px}.InfoPane-section.no-arrow{padding:20px 20px 22px 16px}html[dir=rtl] .InfoPane-section.no-arrow{padding:20px 16px 22px 20px}.InfoPane-section.no-arrow .InfoPane-sectionHeader{cursor:default}.InfoPane-sectionHeader{position:relative;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;height:32px;line-height:32px;cursor:pointer}.InfoPane-sectionHeader:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.InfoPane-sectionExpandButton.ms-Icon{font-size:17px;position:absolute;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";width:32px;height:32px;line-height:32px;text-align:center;transition:transform 167ms cubic-bezier(.1,.9,.2,1)}[dir=ltr] .InfoPane-sectionExpandButton.ms-Icon{left:-32px}[dir=rtl] .InfoPane-sectionExpandButton.ms-Icon{right:-32px}.InfoPane-section.is-expanded .InfoPane-sectionExpandButton.ms-Icon{-ms-transform:rotate(-180deg);transform:rotate(-180deg)}.InfoPane-section .InfoPane-sectionContent{display:none}.InfoPane-section.is-expanded .InfoPane-sectionContent{display:block}.InfoPane-sectionContent{margin-top:10px;font-size:12px}.InfoPane-selectionMessage{margin:0 0 20px 14px}html[dir=rtl] .InfoPane-selectionMessage{margin:0 14px 20px 0}.lg .InfoPane-selectionMessage,.xlg .InfoPane-selectionMessage,.xxlg .InfoPane-selectionMessage,.xxxlg .InfoPane-selectionMessage,.xxxxlg .InfoPane-selectionMessage{margin-top:18px;font-size:21px}.od-InfoPane-selectFile{font-size:12px;font-weight:400;margin:0 0 20px 14px}html[dir=rtl] .od-InfoPane-selectFile{margin:0 14px 20px 0}"}])});
define("odsp-next/dataSources/base/graph/GraphDataRequestor",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../../providers/graphToken/GraphTokenProvider","../../../dataSources/graphUrl/GraphUrlDataSource","@ms/odsp-graph/lib/base/dataRequestor/DataRequestor"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=n.createResolvedResourceKey(e("module").id,s.DataRequestor,{sessionManagementProvider:r.resourceKey,urlDataSource:i.resourceKey});t.default=s.DataRequestor});
define("odsp-next/providers/graphToken/GraphTokenProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._identityDataSource=n.identityDataSource;return r}t.prototype.getToken=function(){return this._identityDataSource.getGraphToken()};t.dependencies=n.__assign({},r.default.dependencies,{identityDataSource:s.identity});return t}(r.default);t.default=o;t.resourceKey=i.createResolvedResourceKey(e("module").id,o)});
define("odsp-next/dataSources/graphUrl/GraphUrlDataSource",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../utilities/features/Features"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.prototype.getApiName=function(){return"Graph"};e.prototype.getApiBaseUrl=function(){return r.isFeatureEnabled(r.UseNewShareDialog)?"https://graph.microsoft.com/beta":"https://graph.microsoft.com/v1.0"};return e}();t.GraphUrlDataSource=i;t.resourceKey=new n.ResourceKey({name:e("module").id,factory:new n.SimpleResourceFactory(i)})});
define("odsp-next/dataSources/people/graph/PeopleDataSource",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../base/graph/GraphDataRequestor","@ms/odsp-graph/lib/services/people/PeopleService"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=n.createResolvedResourceKey(e("module").id,i.default,{dataRequestor:r.resourceKey})});
define("@ms/odsp-graph/lib/services/people/PeopleService",["require","exports","@ms/odsp-utilities/lib/encoding/UriEncoding"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this._dataRequestor=t.dataRequestor}e.prototype.getContacts=function(e){var t="/me/contacts?$select=displayName,emailAddresses&$top=50";e&&e.length>0&&(t+='&$search="'+n.default.encodeURIComponent(e)+'"');return this._dataRequestor.send({path:t,apiName:"GetContacts",requestType:"GET",useAuthorizationHeaders:!0}).then(function(e){return e.value})};e.prototype.getPeople=function(){return this._dataRequestor.send({path:"/me/people",apiName:"GetTopCollaborators",requestType:"GET",useAuthorizationHeaders:!0}).then(function(e){return e&&e.value},function(e){})};return e}();t.default=r});
define("odsp-next/controls/clipboard/ClipboardHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/ControlResourceKeys","../dragAndDrop/Html5FileDragProcessor","../../providers/operator/UploadOperator.key","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","@ms/odsp-utilities/lib/logging/ErrorHelper","../../providers/moveCopy/MoveCopyProvider","../../models/store/ItemsStore","../../resources/DataSourceResourceKeys","../../providers/engagement/Engagement","../../models/item/ItemParentHelper","../../utilities/features/Features","../../utilities/events/EventTargetFilters","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=new m.ResourceKey({name:e("module").id+".isPasteToUploadFeatureEnabled",factory:new m.ConstantResourceFactory(d.isFeatureEnabled(d.PasteToUploadFromClipboard))}),y=new m.ResourceKey({name:e("module").id+".isMoveAndCopyFeatureEnabled",factory:new m.ConstantResourceFactory(d.isFeatureEnabled(d.MoveAndCopyWithClipboard))}),b=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.isEnabled,o=void 0===i?r.observables.create(!0):i,u=n.document,a=void 0===u?document:u;r._itemSetSelectionModel=n.itemSetSelectionModel;r._moveCopyProvider=n.moveCopyProvider;r._itemsStore=n.itemsStore;r._urlDataSource=n.urlDataSource;r._engagement=n.engagement;r._itemParentHelper=n.itemParentHelper;r._isPasteToUploadFromClipboardFeatureEnabled=n.isPasteToUploadFromClipboardFeatureEnabled;r._isMoveAndCopyWithClipboardFeatureEnabled=n.isMoveAndCopyWithClipboardFeatureEnabled;r._isEnabled=o;r._htmlDragProcessor=new s.default;if(r._isMoveAndCopyWithClipboardFeatureEnabled){r.events.on(a,"cut",r._onCut);r.events.on(a,"copy",r._onCopy)}(r._isMoveAndCopyWithClipboardFeatureEnabled||r._isPasteToUploadFromClipboardFeatureEnabled)&&r.events.on(a,"paste",r._onPaste);return r}t.prototype._onCut=function(e){this._putSelectionInClipboard(e,"move")};t.prototype._onCopy=function(e){this._putSelectionInClipboard(e,"copy")};t.prototype._onPaste=function(e){if(this._isEnabled.peek()&&!v.isInputElement(e.target)&&(this._isMoveAndCopyWithClipboardFeatureEnabled&&this._moveOrCopy(e.clipboardData)||this._isPasteToUploadFromClipboardFeatureEnabled&&this._upload(e.clipboardData))){e.stopPropagation();e.preventDefault()}};t.prototype._putSelectionInClipboard=function(e,t){var n=this;if(this._isEnabled.peek()&&!v.isInputElement(e.target)){var r=this._itemSetSelectionModel.selection.peek().map(function(e){return n.observables.peekUnwrap(e)}).filter(function(e){return!!e}).map(function(e){return e.key});if(r.length>0){this._engagement.logData({name:"Items.Clipboard.Copy",isIntentional:!0});var i={itemKeys:r,parentKey:this._itemSetSelectionModel.itemSet.peek().item.peek().key,operation:t};e.clipboardData.setData("application/x-onedrive-items",JSON.stringify(i));e.preventDefault();e.stopPropagation()}}};t.prototype._moveOrCopy=function(e){var t=function(e){try{for(var t=e.items,n=0;n<t.length;n++){if("application/x-onedrive-items"===t[n].type){return JSON.parse(e.getData("application/x-onedrive-items"))}}}catch(e){}}(e);if(t){for(var n=this.observables.peekUnwrap(this._itemsStore.getItem(t.parentKey)),r=this._itemSetSelectionModel.itemSet.peek().item.peek(),i=[],s={},o=0,u=t.itemKeys;o<u.length;o++){var f=u[o],l=this.observables.peekUnwrap(this._itemsStore.getItem(f));if(l){i.push(l);s[l.key]=!0}}if(i.length>0&&n){if(r&&n&&r.key===n.key)return!0;if(this._itemParentHelper.getAncestorOrSelf(r,function(e){return e.key in s}))return!0;this._engagement.logData({name:("move"===t.operation?"Move":"Copy")+"Items.Clipboard.Paste",isIntentional:!0});this._moveCopyProvider.copyItems({items:i,parentKey:n.key,targetId:r.id,targetKey:r.key,cid:this._urlDataSource.getOwnerId(),group:0,isAsync:!1,isMove:"move"===t.operation}).catch(function(e){a.default.log(e)})}return!0}return!1};t.prototype._upload=function(e){var t=this,n=this._htmlDragProcessor.getDataTransfer(e,!0);if(n.files){this._engagement.logData({name:"UploadItems.Clipboard.Paste",isIntentional:!0});var r=this._itemSetSelectionModel.itemSet.peek(),i=r.item.peek();this.resources.consumeAsync(o.asyncTypeResourceKey).then(function(e){var s=new e({files:n.files,parentItem:i,itemSet:r,wasDragAndDropped:!0,behavior:2,type:u.UploadProcessorType.Html5file});t.trackPromise(s.start());return s.wait()}).catch(function(e){a.default.log(e)});return!0}return!1};t.dependencies=n.__assign({},r.default.dependencies,{itemSetSelectionModel:i.itemsSelection,moveCopyProvider:f.resourceKey,itemsStore:l.resourceKey,urlDataSource:c.url,engagement:h.resourceKey,itemParentHelper:p.resourceKey,isMoveAndCopyWithClipboardFeatureEnabled:y,isPasteToUploadFromClipboardFeatureEnabled:g});return t}(r.default);t.default=b;t.typeResourceKey=m.createResolvedTypeResourceKey(e("module").id,b)});
define("odsp-next/providers/moveCopy/MoveCopyProvider",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/base/BaseModel","../item/ItemProvider","../quota/UserStateProvider.key","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../dataSources/item/ItemTaskObserver","../../models/operation/OperationState","../../models/operation/OperationBatch","../../models/operation/OperationType","../../providers/engagement/Engagement","../operation/OperationProvider","../../models/task/Task","../operation/MoveCopyItemsAsyncOperation","../../models/itemsScope/ItemsScopeFeature.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._itemProvider=n.itemProvider;r._itemTaskObserver=r.scope.attach(new n.itemTaskObserverType);r._moveCopyHelper=n.moveCopyItemsAsyncOperation;r._operationProvider=n.operationProvider;r._updateQuota=n.updateQuota;r._actionMap=n.actionMap;r._engagement=r.resources.consume(d.resourceKey);r._isItemsScopeEnabled=n.isItemsScopeEnabled;return r}t.prototype.copyItemsAsync=function(e){return this._handleMoveCopyItemsAsync(e)};t.prototype.moveItemsAsync=function(e){return this._handleMoveCopyItemsAsync(e)};t.prototype.copyItems=function(e){return this._handleMoveCopyItems(e)};t.prototype.moveItems=function(e){var t=this;return this._handleMoveCopyItems(e).then(function(n){for(var r=[],i={},s=0,o=n.items;s<o.length;s++){(f=o[s]).error||(i[f.id]=!0)}for(var u=0,a=e.items;u<a.length;u++){var f;i[(f=a[u]).id]&&r.push(new m.default(f.key).succeed({item:{key:f.key,parentKey:e.targetKey}}))}if(r.length){var l=t._itemTaskObserver;l.update(r);l.flush()}return n})};t.prototype.moveCopyOperationSuccess=function(e,t,n){for(var r=0,i=t.length;r<i;r++){var s=t[r],o=e.items[r],u=o&&o.error;if(u)this._moveCopyHelper.handleMoveCopyError(u,s);else{if(!e.items)throw new Error("No items returned from MoveCopy API");s.progress.current(1);s.state(c.default.completed)}}this._itemProvider.invalidateItem(n.parentKey);this._itemProvider.invalidateItem(n.targetKey);this._isItemsScopeEnabled()&&this.resources.consumeAsync(f.itemInvalidator).then(function(e){e.invalidateItems(n.parentKey)});n.isMove||this._updateQuota(!0);return e};t.prototype._getContext=function(e){return{parentKey:e.targetKey,ignoreListContext:!0,webId:e.webId,siteId:e.siteId}};t.prototype._handleMoveCopyItemsAsync=function(e){var t=this;return this._itemProvider.getItem(this._getContext(e)).then(function(n){var r=new h.default,i=n.item,s=e.items.map(function(n){return t._moveCopyHelper.registerOperation(n,e,i.peek(),null,r)});return t._moveCopyHelper.handleMoveCopyAsyncItems(e,s)},function(n){t._handleGetItemFailure(n,e)})};t.prototype._handleMoveCopyItems=function(e){var t=this,n=this.observables;return this._itemProvider.getItem(this._getContext(e)).then(function(i){var s=new h.default,o=i.item,u=e.items.map(function(i){var u,a={items:[i],parentKey:e.parentKey,targetId:e.targetId,targetKey:e.targetKey,cid:e.cid,group:e.group,isMove:e.isMove,nameConflict:e.nameConflict,taskId:e.taskId,deleteSource:e.deleteSource,isAsync:e.isAsync,overrideLock:e.overrideLock,ackMoveIfShared:e.ackMoveIfShared};return u=t._operationProvider.register({name:i.name,type:e.isMove?p.default.moveItems:p.default.copyItems,iconName:i.iconName,payloads:{moveItems:{item:i,destination:o.peek(),source:i.parent},copyItems:{item:i,destination:o.peek(),source:i.parent}},batch:s,actions:{rename:{isAvailable:n.create(!1),execute:function(){t._engagement.logData({name:"MoveCopyItems.Rename.Click"});a.nameConflict=2;u.actions().rename.isAvailable(!1);u.actions().overwrite.isAvailable(!1);u.state(c.default.started);return a.isAsync?t._moveCopyHelper.handleMoveCopyAsyncItems(a,[u]):t._moveCopyItems(a,[u])}},overwrite:{isAvailable:n.create(!1),execute:function(){t._engagement.logData({name:"MoveCopyItems.Overwrite.Click"});a.nameConflict=1;u.actions().rename.isAvailable(!1);u.actions().overwrite.isAvailable(!1);u.state(c.default.started);return a.isAsync?t._moveCopyHelper.handleMoveCopyAsyncItems(a,[u]):t._moveCopyItems(a,[u])}},cancel:{isAvailable:n.create(!1),execute:function(){u.actions().rename.isAvailable(!1);u.actions().overwrite.isAvailable(!1);u.state(c.default.canceled);return r.default.wrap(null)}},moveAnyway:{isAvailable:n.create(!1),execute:function(){a.deleteSource=!0;a.isMove=!1;a.isAsync=!0;u.actions().moveAnyway.isAvailable(!1);u.actions().rename.isAvailable(!1);u.actions().overwrite.isAvailable(!1);u.state(c.default.started);return t._moveCopyHelper.handleMoveCopyAsyncItems(a,[u])}},moveLockedFile:{isAvailable:n.create(!1),execute:function(){a.overrideLock=!0;u.actions().moveLockedFile.isAvailable(!1);return t.moveItems(a)}},vaultFileLimit:{isAvailable:n.create(!1),execute:function(){var e=new(t.managed(t._actionMap.VaultAction))({actionType:8,item:n.create(i),goPremiumSource:"PVault-QuotaErrorLearnMore"});u.state(c.default.expired);return e.execute({})}},moveSharedFileVault:{isAvailable:n.create(!1),execute:function(){u.state(c.default.completed);a.ackMoveIfShared=!1;return t.moveItems(a)}}},progress:{minimum:0,maximum:1,current:0}})});t._moveCopyHelper.markAllOperationsAsStarted(u);return t._moveCopyItems(e,u)},function(n){return t._handleGetItemFailure(n,e)})};t.prototype._handleGetItemFailure=function(e,t){var n=this;e.code=e.code||e.errorCode;var r=new h.default;t.items.map(function(i){var s=n._moveCopyHelper.registerOperation(i,t,null,null,r),o=s.actions().unlockVault;o.execute=function(){return new(n.managed(n._actionMap.VaultAction))({actionType:2,usePopup:!0,item:n.observables.create(i)}).execute({}).then(function(){o.isAvailable(!1);s.state(c.default.canceled);return t.isAsync?n._moveCopyHelper.handleMoveCopyAsyncItems(t,[s]):n._moveCopyItems(t,[s])})};n._moveCopyHelper.handleMoveCopyError(e,s)})};t.prototype._executeMoveCopy=function(e){return this.resources.consumeAsync(f.items).then(function(t){return e.isMove?t.moveItems(e):t.copyItems(e)})};t.prototype._moveCopyItems=function(e,t){var n=this;return this._executeMoveCopy(e).then(function(r){return n.moveCopyOperationSuccess(r,t,e)},function(i){return r.default.wrapError(n._moveCopyHelper.moveCopyOperationFailure(i,t,e))})};t.dependencies=n.__assign({},s.default.dependencies,{itemProvider:o.resourceKey,moveCopyItemsAsyncOperation:g.resourceKey,itemTaskObserverType:l.resourceKey,operationProvider:v.resourceKey,updateQuota:u.resourceKey,isItemsScopeEnabled:y.isItemsScopeEnabledResourceKey.lazy,actionMap:a.actionMap});return t}(s.default);t.default=b;t.resourceKey=i.createResolvedResourceKey(e("module").id,b)});
define("odsp-next/providers/operation/MoveCopyItemsAsyncOperation",["require","exports","tslib","@ms/odsp-utilities/lib/resources/Resources","../../models/operation/OperationType","../../models/operation/OperationState","../../models/operation/OperationBatch","@ms/odsp-utilities/lib/string/StringHelper","../../dataSources/item/IGetWorkProgressContext","@ms/odsp-utilities/lib/async/Promise","./OperationProvider","../item/ItemProvider","../../providers/engagement/Engagement","../../models/operation/OperationError","../../controls/commands/Commands.resx","../../controls/operation/monitor/OperationMonitor.resx","../../models/item/ItemType","../../dataSources/item/ITaskProgress","../../dataSources/item/ItemDataSource.resx","@ms/odsp-shared/lib/base/BaseModel","../../resources/ControlResourceKeys","../../resources/ProviderResourceKeys","../../resources/DataSourceResourceKeys","../quota/UserStateProvider.key","../../dataSources/vault/IVaultDataSource"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ODB_NAME_COLLISION=-2130575257;t.ODB_FILE_LOCKED=-2147018894;var N=8,C="InsufficientSpaceAvailable",k=162,L="InsufficientVaultQuota",A=function(r){n.__extends(A,r);function A(e,t){void 0===e&&(e={});var n=r.call(this,e,t)||this,i=n._moveCopyDataSource=t.moveCopyDataSource;n._itemProvider=t.itemProvider;n._operationProvider=t.operationProvider;n._bundleLoader=t.bundleLoader;n._updateQuota=t.updateQuota;n._actionMap=t.actionMap;n._engagement=n.resources.consume(h.resourceKey);n._pollsForProgressSinceCancel={};n._cancelPromises={};n._cachePromises={};i&&i.getCapabilities().supportsProgressCaching&&n._resumePendingProgress();return n}A.prototype.registerOperation=function(e,t,n,r,u){var a=this;u||(u=new o.default);var f={items:[e],parentKey:t.parentKey,targetId:t.targetId,targetKey:t.targetKey,cid:t.cid,group:t.group,isMove:t.isMove,nameConflict:t.nameConflict,taskId:t.taskId,deleteSource:t.deleteSource,isAsync:t.isAsync,ackMoveIfShared:t.ackMoveIfShared},l=this._getKey(t),c=this.observables,h=this._operationProvider.register({name:e.name,type:t.isMove?i.default.moveItems:i.default.copyItems,iconName:e.iconName,payloads:{moveItems:{item:e,destination:n,source:e.parent},copyItems:{item:e,destination:n,source:e.parent,taskId:r}},batch:u,actions:{rename:{isAvailable:c.create(!1),execute:function(){f.nameConflict=2;h.actions().rename.isAvailable(!1);h.actions().overwrite.isAvailable(!1);h.actions().cancel.isAvailable(!0);h.state(s.default.started);return a.handleMoveCopyAsyncItems(f,[h],r)}},overwrite:{isAvailable:c.create(!1),execute:function(){f.nameConflict=1;h.actions().rename.isAvailable(!1);h.actions().overwrite.isAvailable(!1);h.actions().cancel.isAvailable(!0);h.state(s.default.started);return a.handleMoveCopyAsyncItems(f,[h],r)}},cancel:{isAvailable:c.create(!0),execute:function(){h.actions().rename.isAvailable(!1);h.actions().overwrite.isAvailable(!1);var e=a._getKey(f),t=a._cachePromises[e]||a._cachePromises[l];return t?t.then(function(e){return a.cancelAsyncOperation(f,h,e.id)}):a.cancelAsyncOperation(f,h,r)}},moveAnyway:{isAvailable:c.create(!1),execute:function(){f.deleteSource=!0;f.isMove=!1;f.isAsync=!0;h.actions().moveAnyway.isAvailable(!1);h.actions().rename.isAvailable(!1);h.actions().overwrite.isAvailable(!1);h.actions().cancel.isAvailable(!0);h.state(s.default.started);return a.handleMoveCopyAsyncItems(f,[h],r)}},moveAnywaySchemaMismatch:{isAvailable:c.create(!1),execute:function(){a._engagement.logData({name:"MoveItemsAsync.MoveAnyway.Click"});f.allowSchemaMismatch=!0;h.actions().moveAnywaySchemaMismatch.isAvailable(!1);h.actions().cancel.isAvailable(!0);h.state(s.default.started);return a.handleMoveCopyAsyncItems(f,[h],r)}},moveAnywayVersionLimit:{isAvailable:c.create(!1),execute:function(){a._engagement.logData({name:"MoveItemsAsync.MoveAnywayVersionLimit.Click"});f.allowSmallerVersionLimit=!0;h.actions().moveAnywayVersionLimit.isAvailable(!1);h.actions().cancel.isAvailable(!1);h.state(s.default.started);return a.handleMoveCopyAsyncItems(f,[h],r)}},unlockVault:{isAvailable:c.create(!1),execute:function(){return new(a.managed(a._actionMap.VaultAction))({actionType:2,usePopup:!0,item:c.create(e)}).execute({}).then(function(){h.actions().unlockVault.isAvailable(!1);h.state(s.default.started);return a.handleMoveCopyAsyncItems(f,[h],r)})}},vaultFileLimit:{isAvailable:c.create(!1),execute:function(){a._engagement.logData({name:"Vault.PaywallError.LearnMore"});var t=new(a.managed(a._actionMap.VaultAction))({actionType:8,item:c.create(e),goPremiumSource:"PVault-QuotaErrorLearnMore"});h.state(s.default.expired);return t.execute({})}},moveSharedFileVault:{isAvailable:c.create(!1),execute:function(){h.state(s.default.completed);h.actions().moveSharedFileVault.isAvailable(!1);f.ackMoveIfShared=!1;f.deleteSource=!0;return a.handleMoveCopyAsyncItems(f,[h],r)}}},progress:{minimum:0,maximum:1,current:0}});h.state(s.default.started);return h};A.prototype.moveCopyOperationFailure=function(e,t,n){if(t)for(var r=0,i=t;r<i.length;r++){var s=i[r];this.handleMoveCopyError(e,s)}return e};A.prototype.handleMoveCopyAsyncItems=function(e,t,n){var r=this;this.markAllOperationsAsStarted(t);return function(e,t,n){if(n){var i={id:n,progress:null,pageStats:null,targetId:null};e.taskId||(e.taskId=n);return r.pollForProgress(i,e,t)}A._activeAsyncTasks[r._getKey(e)]=null;var s=r._getKey(e);r._cachePromises[s]=function(e){return r._moveCopyDataSource.copyItemsAsync(e)}(e);return r._cachePromises[s].then(function(n){var i=e.items.map(function(e){return e.key});r._progressCache&&r._progressCache.saveJobState(n,i,e.targetKey,e.isMove);e.taskId=n.id;r.pollForProgress(n,e,t);return n},function(n){return r.moveCopyOperationFailure(n,t,e)})}(e,t,n)};A.prototype.pollForProgress=function(e,t,n,r,i){var s=this;if(!e)return null;var o={workItemIds:[e.id],jobInfo:e.jobInfo,type:a.IGetWorkProgressTypes.itemCopy,items:t.items,lastProcessedTime:i};this._progressCache&&(o.progressCache=this._progressCache);var u=function(e){s._getItemDataSource().then(function(t){return t.getWorkProgress(e)}).then(function(i){r&&r(n,i);s._handleGetWorkProgressSuccess(i,n,t,e,u)})};if(n)for(var f=0;f<n.length;f++){var l=n[f];!l.payloads.peek().copyItems.taskId&&e&&e.progress&&(e.progress[f]?l.payloads.peek().copyItems.taskId=e.progress[f]&&e.progress[f].id:l.payloads.peek().copyItems.taskId=e.progress[0]&&e.progress[0].id)}if(e.progress){r&&r(n,e);this._handleGetWorkProgressSuccess(e,n,t,o,u)}else{var c=this.async.setTimeout(function(){u(o)},2e3);A._activeAsyncTasks[this._getKey(t)]=c}};A.prototype.handleMoveCopyError=function(e,n){var r=e.code;n.actions().cancel.isAvailable(!1);n.payloads.peek().copyItems.taskId="";if(1e3===r){n.actions().rename.isAvailable(!0);var i=!0,o=n.payloads.peek();(o.moveItems&&o.moveItems.item||o.copyItems&&o.copyItems.item).type===m.default.Folder&&(i=!1);n.actions().overwrite.isAvailable(i);n.error(new p.default({message:i?v.strings.conflictUploadErrorText:v.strings.conflictUploadFolderWithRenameErrorText}))}else if(r===t.ODB_NAME_COLLISION)if(n.payloads().moveItems.item.parentKey===n.payloads().moveItems.destination.key)n.error(new p.default({message:v.strings.sameLocationMoveCopyErrorText}));else{this._engagement.logData({name:"MoveCopyItems.NameConflictError"});if(n.payloads().moveItems.item.type===m.default.Folder){n.actions().rename.isAvailable(!0);n.error(new p.default({message:v.strings.conflictUploadFolderWithRenameErrorText}))}else{n.actions().overwrite.isAvailable(!0);n.actions().rename.isAvailable(!0);n.error(new p.default({message:v.strings.conflictUploadErrorText}))}}else if(-2147213282===r){this._engagement.logData({name:"MoveItemsAsync.SchemaMismatchError"});n.actions().moveAnywaySchemaMismatch.isAvailable(!0);n.error(new p.default({message:v.strings.moveFileFolderSchemaMismatch}))}else if(-2147213278===r){this._engagement.logData({name:"MoveItemsAsync.VersionLimitError"});n.actions().moveAnywayVersionLimit.isAvailable(!0);n.error(new p.default({message:v.strings.moveFileFolderVersionLimit}))}else if(-2147024713===r||-2147024816===r)if(n.payloads().moveItems.item.type===m.default.Folder){n.actions().rename.isAvailable(!0);n.error(new p.default({message:v.strings.conflictUploadFolderWithRenameErrorText}))}else{n.actions().overwrite.isAvailable(!0);n.actions().rename.isAvailable(!0);n.error(new p.default({message:v.strings.conflictUploadErrorText}))}else if(r===t.ODB_FILE_LOCKED)e.message&&n.error(new p.default({message:e.message}));else if(2028===r){n.actions().moveAnyway.isAvailable(!0);n.error(new p.default({message:d.strings.moveItemCannotMoveOwnItemIntoMountPointError}))}else if(2029===r){n.actions().moveAnyway.isAvailable(!0);n.error(new p.default({message:d.strings.moveItemCannotMoveSharedItemIntoOwnFolderError}))}else if(9001===r){n.actions().moveLockedFile.isAvailable(!0);n.error(new p.default({message:e.message}))}else if(-2130247142===r){var a=e.message;n.payloads().moveItems.item.type===m.default.Folder&&(n.payloads().moveItems.item.key===n.payloads().moveItems.destination.key?a=v.strings.moveFolderToSameLocationErrorText:0===n.payloads().moveItems.destination.key.indexOf(n.payloads().moveItems.item.key)&&(a=v.strings.moveFolderToOwnSubfolderErrorText));n.error(new p.default({message:a}))}else if(161===r){n.actions().unlockVault.isAvailable(!0);n.error(new p.default({message:v.strings.unlockRequiredMoveErrorText}))}else if(162===r){this._engagement.logData({name:"Vault.PaywallError.Shown"});n.actions().vaultFileLimit.isAvailable(!0);n.actions().vaultFileLimit.closeHostOnExecute=!0;n.error(new p.default({message:u.format(v.strings.insufficientVaultQuotaErrorText,T.VAULT_FREE_FILE_LIMIT)}))}else if(9018===r){n.actions().moveSharedFileVault.isAvailable(!0);n.actions().moveSharedFileVault.closeHostOnExecute=!0;n.error(new p.default({message:v.strings.moveSharedFileVaultErrorText}))}else{var f=v.strings,l=void 0;switch(r){case 3e3:l=y.strings.ItemNotFoundSubText;break;case 1007:l=f.moveFolderToSameLocationErrorText;break;case N:l=f.overQuotaCreateItemErrorText;break;case-2147213295:l=f.moveCopyIRMNotSupported;break;case-2147213288:l=f.moveCopyObjectsNotSameLevel;break;case-2147213287:l=f.moveCopyTargetIsSubfolder;break;case-2147213294:case-2147213293:l=f.moveFolderDeleteFail;break;case-2147213291:case-2147024684:case-2147213290:l=f.moveFileDeleteFail;break;case-2147213285:l=f.moveCopyPermissionsFail;break;case-2147213284:l=f.moveCopyNoScriptSourceFail;break;case-2147213283:l=f.moveCopyNoScriptTargetFail;break;case-2147213292:case-2147024809:l=f.moveCopyFatalErrorText;break;case 164:l=f.moveSpecialFoldersVaultError;break;default:l=e.message}n.error(new p.default({message:"string"==typeof l?l:void 0}))}n.state(s.default.failed)};A.prototype.markAllOperationsAsStarted=function(e){if(e)for(var t=0,n=e;t<n.length;t++){n[t].state(s.default.started)}};A.prototype._handleGetWorkProgressSuccess=function(e,t,n,r,i){var o=!1,u=!1,a=n.taskId;void 0!==this._pollsForProgressSinceCancel[a]&&(this._pollsForProgressSinceCancel[a]+=1);if(t&&e&&e.progress)for(var f=function(t){for(var n=void 0,r=t.payloads.peek(),i=0,f=e.progress;i<f.length;i++){var c=f[i];if(r.copyItems&&c.id===t.payloads.peek().copyItems.taskId&&l._hasMatchingItemIds(t,c)&&t.state.peek()!==s.default.completed&&t.state.peek()!==s.default.failed){n=c;break}}var h=function(){t.progress.current(1);t.actions().cancel&&t.actions().cancel.isAvailable(!1);t.state(s.default.completed);u=!0};if(n){var p=n.error,d=g.ITaskStatuses[n.status];if(d===g.ITaskStatuses.Cancelled||l._pollsForProgressSinceCancel[a]>=3){t.actions().cancel.isAvailable(!1);t.state(s.default.canceled);u=!0}else if(p){n.errorCode===C?p.code=N:n.errorCode===L&&(p.code=k);if(l._progressCache){t.progress.current(0);t.state()!==s.default.failed&&l.handleMoveCopyError(p,t)}else l.handleMoveCopyError(p,t)}else if(d===g.ITaskStatuses.Completed)h();else{var v=t.progress.current.peek();if(n.completedBytes>v){t.progress.current(n.completedBytes);t.progress.maximum(n.totalBytes)}o=!0}l._progressCache&&l._progressCache.updateJobState(a,t,n)}else t.state()!==s.default.failed&&h()},l=this,c=0,h=t;c<h.length;c++){f(h[c])}if(u){this._itemProvider.invalidateItem(n.parentKey);this._itemProvider.invalidateItem(n.targetKey);this._updateQuota()}if(o){var p=this.async.setTimeout(function(){i(r)},2e3);A._activeAsyncTasks[this._getKey(n)]=p}else if(this._progressCache){this._pollsForProgressSinceCancel={};this._progressCache.purgeJobState(a)}};A.prototype._hasMatchingItemIds=function(e,t){var n=e.payloads.peek().copyItems&&e.payloads.peek().copyItems.item;return!t.sourceResourceId||this._moveCopyDataSource.hasMatchingId(t.sourceResourceId,n)};A.prototype.cancelAsyncOperation=function(e,t,n){var r=this,i=n||e.taskId,o=A._activeAsyncTasks[this._getKey(e)];if(!this._cancelPromises[i]){var u={workItemIds:[i]};this._progressCache&&(u.progressCache=this._progressCache);this._cancelPromises[i]=this._getItemDataSource().then(function(e){return e.cancelWork(u)})}return this._cancelPromises[i].then(function(e){if(r._progressCache){var n=r._progressCache.getCacheData(),u=n&&n[i];if(e||!u){t.state(s.default.canceled);r._progressCache.cancelJobs(i);o&&r.async.clearTimeout(o)}else r._pollsForProgressSinceCancel[i]=0}t.actions().cancel.isAvailable(!1);r._cancelPromises[i]=void 0},function(e){r._cancelPromises[i]=void 0})};A.prototype._getKey=function(e){return e.items.map(function(e){return e.key}).join(",")+e.targetKey};A.prototype._resumePendingProgress=function(){var t=this;this._bundleLoader.queueLoad("odsp-next/providers/operation/MoveCopyAsyncProgressCache",function(){return new f.default(function(t,n){e(["odsp-next/providers/operation/MoveCopyAsyncProgressCache"],t,n)})}).then(function(e){t._progressCache=new(t.managed(e))({moveCopyHelper:t});t._progressCache.resumePendingProgress()})};A.prototype._getItemDataSource=function(){return this.resources.consumeAsync(S.items)};A.dependencies=n.__assign({},b.default.dependencies,{moveCopyDataSource:S.copy.optional,itemProvider:c.resourceKey,operationProvider:l.resourceKey,bundleLoader:E.bundleLoader,updateQuota:x.resourceKey,actionMap:w.actionMap,currentItem:w.currentItem});A._activeAsyncTasks={};return A}(b.default);t.default=A;t.resourceKey=r.createResolvedResourceKey(e("module").id,A)});
define("odsp-next/controls/vaultTeachingBubble/react/odc/VaultTeachingBubble",["require","exports","tslib","react","@ms/odsp-utilities/lib/scope/Scope","@ms/odsp-shared-react/lib/utilities/resources/Resources","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/logging/events/Engagement.event","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/common/DirectionalHint","@ms/odsp-shared-react/lib/utilities/resources/Resources","../../VaultTeachingBubbleHelper","../../../../dataSources/vault/IVaultDataSource","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../../dataSources/vault/odc/VaultDataSource.key","@ms/odsp-utilities/lib/resources/ResourceScope","../../VaultTeachingBubble.resx","office-ui-fabric-react/lib/TeachingBubble","../../../../resources/ControlResourceKeys","../../../../resources/ODCResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onLaterClick=function(){u.Engagement.logData({name:"Vault.FRE.TeachingBubble.Later"});r._dismiss()};r._onDismiss=function(){u.Engagement.logData({name:"Vault.FRE.TeachingBubble.Dismiss"});r._dismiss()};r._onGetStartedClick=function(){var e=r.props.vaultItem;u.Engagement.logData({name:"Vault.FRE.TeachingBubble.GetStarted"});r._onDismiss();var t=r._actionMap;return new(r._resources.injected(t.OpenAction))({item:r._observables.create(e),openRelation:2,itemSet:r._itemSet}).execute({}).then(function(t){if(t.resultType===o.ResultTypeEnum.Success){var n=r._odcUrlDataSource.getItemUrl(e.key);r._navigation.navigateTo({url:n})}})};var s=n.dependencies;r._resources=s&&s.resources||t.resources;r._actionMap=s&&s.actionMap||r._resources.consume(b.actionMap);r._itemSet=s&&s.itemSet||r._resources.consume(b.currentItemSet);r._navigation=s&&s.navigation||r._resources.consume(d.navigation);r._scope=new i.default;r._observables=r._scope.attach(new(r._resources.consume(p.observablesFactoryTypeResourceKey))({owner:r}));r._odcUrlDataSource=s&&s.odcUrlDataSource||r._resources.consume(w.urlDataSource);r._vaultDataSource=s&&s.vaultDataSource||r._resources.consume(v.resourceKey);r._vaultDataSource&&(r._vaultFreState=r._vaultDataSource.freState());r._isGuidedTourVisible=s&&s.isGuidedTourVisible||r._resources.consume(b.isGuidedTourVisible);r.state={isVisible:!!r._calculateVisibility(r._vaultFreState()),target:r.props.target};return r}t.prototype.componentWillUnmount=function(){this._scope.dispose()};t.prototype.componentDidMount=function(){var e=this;this._observables.compute(function(){var t=e._vaultFreState();e.setState({isVisible:!!e._calculateVisibility(t)})});if(this.props.getUpdatedTarget){var t=this.props.getUpdatedTarget();this.setState({target:t})}};t.prototype.render=function(){var e=this.props.directionalHint,t=void 0===e?f.DirectionalHint.rightCenter:e,n=g.strings.VaultTeachingDescription,i=this.state,s=i.isVisible,o=i.target,a={text:g.strings.GetStartButtonName,style:{borderRadius:"2px"},onClick:this._onGetStartedClick},l={text:g.strings.LaterButtonName,style:{borderRadius:"2px"},onClick:this._onLaterClick};s&&u.Engagement.logData({name:"Vault.FRE.TeachingBubble.Shown"});return s?r.createElement("div",{className:"od-vaultTeachingBubble"},r.createElement(y.TeachingBubble,{styles:{header:{marginBottom:"16px",fontSize:"20px"}},primaryButtonProps:a,secondaryButtonProps:l,calloutProps:{directionalHint:t},targetElement:o,headline:g.strings.VaultTeachingTile,hasCloseIcon:!0,closeButtonAriaLabel:g.strings.VaultTeachingCloseAriaLabel,onDismiss:this._onDismiss,hasCondensedHeadline:!0},n)):null};t.prototype._dismiss=function(){this._vaultDataSource.setVaultState(h.VaultFreState.BubbleShown)};t.prototype._calculateVisibility=function(e){return!this._isGuidedTourVisible()&&c.isVaultInContainer()&&e===h.VaultFreState.Created};t.contextTypes=s.RESOLVED_COMPONENT_CONTEXT_TYPES;return t}(a.BaseComponent);t.default=E;t.typeResourceKey=l.createResolvedComponentTypeResourceKey(e("module").id,E,{actionMap:b.actionMap,odcUrlDataSource:w.urlDataSource,resources:m.resourceScopeKey.local,vaultDataSource:v.resourceKey,isGuidedTourVisible:b.isGuidedTourVisible,navigation:d.navigation,itemSet:b.currentItemSet})});
define("odsp-next/controls/sharing/share/odc/Share",["require","exports","./ShareViewModel","../../../../bindings/component/ControlBinding","../Share.html"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"od-share-ko",name:e("module").id,template:e("../Share.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/sharing/share/odc/ShareViewModel",["require","exports","tslib","../../../../resources/ControlResourceKeys","../../../../bindings/focus/FocusTrapBinding","../../../../providers/peoplePicker/PeoplePickerProvider","../../../../bindings/react/ReactBinding","../react/Share","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-shared-sharing/lib/interfaces/SharingInterfaces","@ms/odsp-shared-sharing/lib/store/odc/SharingStore","../../../../dataSources/base/graph/GraphDataRequestor","@ms/odsp-graph/lib/services/sharing/SharingService","@ms/odsp-graph/lib/services/people/PeopleService","@ms/odsp-datasources/lib/providers/peoplePicker/odc/PeoplePickerProvider","@ms/odsp-datasources/lib/dataSources/peoplePicker/graph/PeoplePickerDataSource","../../../../providers/sharing/SharingProvider","../../../../providers/featureCards/FeatureCardsProvider","../../../featureCards/FeatureCards","../../../../providers/engagement/Engagement","@ms/odsp-utilities/lib/string/StringHelper","../../../../controls/sharing/shareByEmail/Sharing.resx"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S="ODCSharing",x=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._showFeatureCards=function(){r._engagement.logData({name:S+".LearnMoreClicked",isIntentional:!0});r.displayFeatureCards(!0)};var s=t.copyLinkShortcut,a=t.items,f=t.onDismiss,l=t.onResize,c=t.hideShareDialogOverflowButton,m=t.mode,w=n.actionMap;r._itemsBeingShared=a;r._onDismiss=f;r._onResize=l;r._dependencies=n;r._copyLinkShortcut=s;r._mode=m;r._hideShareDialogOverflowButton=c;r.displayFeatureCards=r.createObservable(!1);r._featureCardsProvider=r.resources.consume(g.resourceKey);r.featureCardIndex=0;r.featureCardsTagName=y.default.tagName;r.featureCardData=r._getFeatureCardsData();r._engagement=r.resources.consume(b.resourceKey);r.addBindingHandlers({react:o.default,focusTrap:i.default});r._showPermissionsAction=new(r.child(w.ShowPermissionsAction))({item:r.createObservable(r._itemsBeingShared()[0])});r.shareComponent=u.default;r.shareComponentProps=r.createPureComputed(r._computeShareProps);r._sharingService=new h.default({},{dataRequestor:r._dependencies.dataRequestor});var E=new p.default({},{dataRequestor:r._dependencies.dataRequestor});r._peoplePickerProvider=new d.PeoplePickerProvider(new v.PeoplePickerDataSource(E));return r}t.prototype.closeFeatureCards=function(){this.displayFeatureCards(!1)};t.prototype._computeShareProps=function(){var e=this._itemsBeingShared(),t=this._dependencies;if(e&&e[0]){e[0].name=e[0].name||"";var n=new l.default({itemName:e.length>1?w.format(E.strings.SharingBundleTempName,e.length):e[0].name,sharingService:this._sharingService,itemId:e[0].id,multiShareIds:e.length>1?e.map(function(e){return e.id||""}):void 0});return{actionMap:t.actionMap,copyLinkShortcut:this._copyLinkShortcut,hideShareDialogOverflowButton:this._hideShareDialogOverflowButton||!this._showPermissionsAction.isAvailable(),item:e[0],items:e,onDismiss:this._onDismiss,onResize:this._onResize,onManageAccessClicked:this._onManageAccessClicked.bind(this),peoplePickerProvider:this._peoplePickerProvider,graphPeoplePickerHelper:null,resources:t.resources,sharingProvider:null,policyTipProvider:null,mode:this._mode,sharingStore:n,clientId:f.ClientId.odc,premiumLearnMore:this._showFeatureCards,goPremium:function(){return window.open("https://onedrive.live.com/next?ocid=PROD_OneDrive-Web_ExpiringLinks_Normal_GoPremium&v=upgrade&hideLeftNav=true")}}}};t.prototype._onManageAccessClicked=function(){this._showPermissionsAction.isAvailable.peek()&&this._showPermissionsAction.execute(null);this._onDismiss()};t.prototype._getFeatureCardsData=function(){return this._featureCardsProvider.getFeatureCards()};t.dependencies=n.__assign({},a.default.dependencies,{peoplePickerProvider:s.resourceKey,actionMap:r.actionMap,dataRequestor:c.resourceKey,sharingProvider:m.resourceKey});return t}(a.default);t.default=x});
define("@ms/odsp-shared-sharing/lib/store/odc/SharingStore",["require","exports","tslib","@ms/odsp-datasources/lib/Sharing","@ms/odsp-datasources/lib/dataSources/roleAssignments/PrincipalType","@ms/odsp-graph/lib/models/error/Error","@ms/odsp-utilities/lib/logging/events/Qos.event","../../components/Share.resx","@ms/odsp-utilities/lib/string/StringHelper","../../utilities/EngagementHelper","@ms/odsp-utilities/lib/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c={ODC:"ODCSecureSharing"},h=function(){return null};var p=function(){function e(e){this._listeners=null;this.addPeople=h;this.getCompanyName=h;this.getOutlookAvailability=h;this.fetchSuiteNavInformation=h;this.navigateToOwa=h;this.fetchGroupsMemberCount=h;this.getGroupsMemberCount=h;this.fetchPolicyTipInformation=h;this.getPolicyTipInformation=h;this.updatePolicy=h;this.checkPermissions=h;this.getPermissionsMap=h;this.getDefaultRecipients=h;this.consumeDefaultRecipients=h;this.grantAccess=h;this.getGrantAccessResult=h;this.getAddPeopleResult=h;this.hasAccessRequestBeenCreated=h;this.isValidatingDefaultRecipients=h;this.fetchMemberCount=h;this.getMembersCounts=h;if(!e.itemId&&!e.itemUrl&&!e.multiShareIds)throw new Error("An itemId, itemUrl, or multiShareIds must be passed to the Sharing store");this._listeners=new Array;this._shareLink=null;this._itemUrl=e.itemUrl;this._multiShareIds=e.multiShareIds;this._itemId=this._multiShareIds?this._multiShareIds[0]:e.itemId;this._itemName=this._multiShareIds?a.format(u.default.sharingBundleName,this._multiShareIds.length):e.itemName;this._sharingService=e.sharingService;this._sharingInformation=null;this._isPremium=null;this._isBundleShare=this._multiShareIds&&this._multiShareIds.length>1;this._engagementHelper=new f.EngagementHelper(e.telemetryManager);if(this._isBundleShare){var t=new Date(Date.now());this._bundleName=a.format(u.default.sharingBundleNameDate,t.getMonth(),t.getDate(),t.getFullYear())}}e.prototype.getEngagementHelper=function(){return this._engagementHelper};e.prototype._emitChange=function(){this._listeners.forEach(function(e){return e()})};e.prototype.addListener=function(e){this._listeners.push(e);this._emitChange()};e.prototype.shouldInterruptCopyLink=function(e){var t=this;if(this._isPremium&&!this._multiShareIds){return this._sharingInformation.hasPermissionsInformation?new Promise(function(n,r){n(t._doesMatchingLinkExist(e))}):new Promise(function(n,r){t._sharingService.getPermissions(t._itemId).then(function(r){t._permissions=r;var i=t._parsePermissions(r),s=i.principals,o=i.sharingLinks;t._sharingInformation.sharingPrincipals=s;t._sharingInformation.sharingLinks=o;n(t._doesMatchingLinkExist(e))})})}return new Promise(function(e,t){e(!1)})};e.prototype._doesMatchingLinkExist=function(e){var t=this._sharingInformation.sharingLinks,n=!1;t.forEach(function(t){t.isEdit!==e||t.application||(n=t.hasPassword)});return n};e.prototype.getSharingInformation=function(){return this._sharingInformation};e.prototype.fetchSharingInformation=function(e){var t=this,i=this._itemId?this._sharingService.getItemInfo(this._itemId):this._sharingService.getItemInfoFromItemUrl(this._itemUrl),a=this._sharingService.getCurrentUserId(),f=this._sharingService.isUserPremium(),l=new o.default;Promise.all([this._toTuple(i),this._toTuple(a),this._toTuple(f)]).then(function(i){var a=i[0],f=i[1],c=i[2];if(t._isError(a)||t._isError(f)||t._isError(c)){if(t._isError(a)){var h=a.error;t._sharingInformation=n.__assign({},t._sharingInformation,{error:s.getResultCodeFromError(h),errorCategory:5,debugErrorMessage:JSON.stringify(a),errorMessage:h.message||u.default.getSharingInformationError});l.end({name:"SharingInformationPreReqs",resultType:o.ResultTypeEnum.Failure,resultCode:"Item Error: "+t._sharingInformation.error,extraData:{error:h}});t._emitChange();return}if(t._isError(f)){h=f.error;t._sharingInformation=n.__assign({},t._sharingInformation,{error:s.getResultCodeFromError(h),errorCategory:6,debugErrorMessage:JSON.stringify(f),errorMessage:h.message||u.default.getSharingInformationError});l.end({name:"SharingInformationPreReqs",resultType:o.ResultTypeEnum.Failure,resultCode:"Me Error: "+t._sharingInformation.error,extraData:{error:h}});t._emitChange();return}if(t._isError(c)){h=c.error;t._sharingInformation=n.__assign({},t._sharingInformation,{error:s.getResultCodeFromError(h),errorCategory:7,debugErrorMessage:JSON.stringify(c),errorMessage:h.message||u.default.getSharingInformationError});l.end({name:"SharingInformationPreReqs",resultType:o.ResultTypeEnum.Failure,resultCode:"Drive Error: "+t._sharingInformation.error,extraData:{error:h}});t._emitChange();return}}else{l.end({name:"SharingInformationPreReqs",resultType:o.ResultTypeEnum.Success});var p=a.value,d=f.value;t._itemId=p.id;t._isPremium=c.value;var v=t._getOwnerPrincipal(p);(e?t._sharingService.getPermissions(t._itemId):new Promise(function(e,t){e([])})).then(function(n){var i=d;t._permissions=n;var s,o,u=t._parsePermissions(n),a=u.principals,f=u.sharingLinks;a=[v].concat(a);t._sharingInformation={anonymousLinkExpirationRestrictionDays:-1,blockPeoplePickerAndSharing:!1,canAddExternalPrincipal:!0,canAddInternalPrincipal:!0,canManagePermissions:!0,defaultShareLinkToExistingAccess:!1,defaultSharingLink:{allowsAnonymousAccess:!0,audience:r.SharingAudience.anyone,expiration:null,isActive:!0,isEdit:!0,principals:[],shareId:null,sharingLinkKind:5,url:null,createdViaCopyLinkCommand:null,invitees:[],isReview:!1,updatePassword:!1,password:null,hasPassword:!1,blockDownload:!1,passwordLastModifiedBy:null},hasInheritedLinks:!1,isShared:!0,item:{name:t._itemName,hasDlpPolicy:!1,childCount:0},sharingLinks:f,sharingPrincipals:a,peoplePickerSettings:{},userDisplayName:"",error:null,errorCategory:null,errorMessage:null,debugErrorMessage:null,requiresAccessApproval:!1,userRole:v.id===i?3:null,defaultShareLinkPermission:2,defaultLinkKind:null,sharingAbilities:(s={enabled:!0,disabledReason:null},o={canGetEditLink:s,canGetReadLink:s,canHaveExternalUsers:s,canManageEditLink:s,canManageReadLink:s,linkExpiration:{defaultExpirationInDays:-1,enabled:!0,disabledReason:null},canRequestAccessForGrantAccess:s,canAddInternalPrincipal:s,canAddExternalPrincipal:s,supportsRestrictedView:s,canAddNewExternalPrincipals:s},{anonymousLinkAbilities:o,organizationLinkAbilities:o,peopleSharingLinkAbilities:o,directSharingAbilities:o}),directLink:null,hasPermissionsInformation:t._sharingInformation&&t._sharingInformation.hasPermissionsInformation||e,isGraphAvailable:!0,sharingLinkTemplates:null,webTemplateId:void 0,itemUniqueId:void 0,peoplePickerError:void 0};t._emitChange()},function(e){t._sharingInformation=n.__assign({},t._sharingInformation,{error:s.getResultCodeFromError(e),errorCategory:4,debugErrorMessage:JSON.stringify(e),errorMessage:e.message||u.default.getSharingInformationError});t._emitChange()})}})};e.prototype.shareLink=function(e){var t=e.settings,n=e.recipients,r=e.emailMessage,i=e.copyLinkCommand;0!==n.length?this._shareViaInvite(t,n,r):i?this._createSharingLink(t,{useOldPassword:!0}):this._createSharingLink(t)};e.prototype._getOwnerPrincipal=function(e){var t,n;if(e.shared&&e.shared.owner&&e.shared.owner.user){t=e.shared.owner.user.id;n=e.shared.owner.user.displayName}return{id:t||"",isExternal:!1,loginName:"",primaryText:n||"",secondaryText:"",role:3,type:i.default.user,imageUrl:"",email:""}};e.prototype._parsePermissions=function(e){for(var t=[],n=[],s=[],o=0,u=e;o<u.length;o++){var a=u[o];if(a.grantedTo&&a.grantedTo.user&&a.grantedTo.user.id){if(-1===s.indexOf(a.grantedTo.user.id)){var f=a.invitation&&a.invitation.email||a.grantedTo.user.displayName,l={id:a.grantedTo.user.id,isExternal:!1,loginName:f,primaryText:a.grantedTo.user.displayName||f,secondaryText:"",role:"write"===a.roles[0]?2:1,type:i.default.user,imageUrl:"",email:f};n.push(l);s.push(l.id)}}else if(a.link){var c={allowsAnonymousAccess:!0,audience:r.SharingAudience.anyone,expiration:a.expirationDateTime,isActive:!0,isEdit:"edit"===a.link.type,principals:[],shareId:a.shareId,sharingLinkKind:"edit"===a.link.type?5:4,url:a.link.webUrl,createdViaCopyLinkCommand:!a.grantedTo,invitees:[],updatePassword:!1,password:"",hasPassword:a.hasPassword,blockDownload:!1,application:a.link.application};t.push(c)}}return{principals:n,sharingLinks:t}};e.prototype._shareViaInvite=function(e,t,i){var o,a=this,f=t.map(function(e){return{email:e.email}}),l=e.isEdit?"write":"read",c=e.password,h=e.expiration;if(this._itemId||this.isBundleShare()){var p={itemIds:this.isBundleShare()?this._multiShareIds:[this._itemId],recipients:f,message:i,requireSignIn:!!e.requireSignIn,sendInvitation:!1!==e.sendInvitation,roles:[l],password:c,expiration:h,bundleName:this._bundleName};o=this._sharingService.invite(p)}else{p={itemUrl:this._itemUrl,recipients:f,message:i,requireSignIn:!!e.requireSignIn,sendInvitation:!1!==e.sendInvitation,roles:[l],password:c,expiration:h};o=this._sharingService.inviteFromItemUrl(p)}o.then(function(t){var n=t[0],i="edit"===n.link.type?5:4;a._shareLink={allowsAnonymousAccess:!0,audience:e.requireSignIn?r.SharingAudience.specificPeople:r.SharingAudience.anyone,expiration:n.expirationDateTime,isActive:!0,isEdit:"edit"===n.link.type,principals:[],shareId:"",sharingLinkKind:i,url:n.link.webUrl,createdViaCopyLinkCommand:!0,invitees:[],updatePassword:!1,password:"",hasPassword:n.hasPassword,blockDownload:n.preventDownload,passwordLastModifiedBy:null};a._emitChange()},function(e){var t=s.getResultCodeFromError(e);if(["ownerCannotShareWithSelf","maximumRecipientsExceeded","invalidAclEmailSpecified","duplicateMembersInRequest","secureSharingInvalidRequest"].indexOf(t)>-1)a._sharingInformation.peoplePickerError=e.response&&e.response.error&&(e.response.error.localizedMessage||e.response.error.message);else{a._sharingInformation=n.__assign({},a._sharingInformation,{error:t,errorCategory:8,errorMessage:e.response&&e.response.error&&(e.response.error.localizedMessage||e.response.error.message)||u.default.getSharingInformationError});e.response&&e.response.error&&e.response.error.fixItUrl&&(a._sharingInformation.fixItUrl=e.response.error.fixItUrl)}a._emitChange()})};e.prototype._createSharingLink=function(e,t){var i,o=this,a=e.isEdit?"edit":"view",f=e.preventDownload,l=t&&t.useOldPassword?null:e.password,c=e.expiration;if(this._itemId||this.isBundleShare()){var h={itemIds:this.isBundleShare()?this._multiShareIds:[this._itemId],type:a,scope:"anonymous",preventDownload:f,password:l,expiration:c,bundleName:this._bundleName};i=this._sharingService.createLink(h)}else{h={itemUrl:this._itemUrl,type:a,scope:"anonymous",preventDownload:f,password:l,expiration:c};i=this._sharingService.createLinkFromItemUrl(h)}i.then(function(e){var t="edit"===e.link.type?5:4;o._shareLink={allowsAnonymousAccess:!0,audience:r.SharingAudience.anyone,expiration:e.expirationDateTime,isActive:!0,isEdit:"edit"===e.link.type,principals:[],shareId:"",sharingLinkKind:t,url:e.link.webUrl,createdViaCopyLinkCommand:!0,invitees:[],updatePassword:!1,password:"",hasPassword:e.hasPassword,blockDownload:e.preventDownload,passwordLastModifiedBy:null};o._emitChange()},function(e){o._sharingInformation=n.__assign({},o._sharingInformation,{error:s.getResultCodeFromError(e),errorCategory:2,errorMessage:e.message||u.default.getSharingInformationError});o._emitChange()})};e.prototype.unshareLink=function(e,t){for(var n,r=this,i=0,s=this._permissions;i<s.length;i++){var o=s[i];o.shareId===t&&(n=o)}var u=n.inheritedFrom?n.inheritedFrom.id:this._itemId;(u?this._sharingService.unshareLink(u,n.id):this._sharingService.unshareLinkFromItemUrl(this._itemUrl,n.id)).then(function(){r.fetchSharingInformation(!0)})};e.prototype.getSharingLinkCreated=function(){return this._shareLink};e.prototype.updatePermissions=function(e,t){for(var n=this,r=[],i=0,s=this._permissions;i<s.length;i++){var o=s[i];o.grantedTo&&o.grantedTo.user&&o.grantedTo.user.id===e.id&&r.push(o)}for(var u=0,a=r;u<a.length;u++){var f=a[u],l=f.inheritedFrom?f.inheritedFrom.id:this._itemId;switch(t){case 0:this.unshareLink(5,f.shareId);break;case 2:(l?this._sharingService.updatePermissions(l,f.id,"write"):this._sharingService.updatePermissionsFromItemUrl(this._itemUrl,f.id,"write")).then(function(e){n.fetchSharingInformation(!0)});break;default:(l?this._sharingService.updatePermissions(l,f.id,"read"):this._sharingService.updatePermissionsFromItemUrl(this._itemUrl,f.id,"read")).then(function(e){n.fetchSharingInformation(!0)})}}};e.prototype.isPeopleSharingLinksEnabled=function(){return!1};e.prototype.showManageAccess=function(){return!1};e.prototype.isPasswordModificationAllowed=function(){return!0};e.prototype.isExpirationDateModificationAllowed=function(){return!0};e.prototype.isPremiumExperienceAllowed=function(){return this._isPremium};e.prototype.isPreventDownloadAllowed=function(){return!1};e.prototype.isReportProblemSupported=function(){return!1};e.prototype.isBundleShare=function(){return this._isBundleShare};e.prototype.getNavId=function(){return""};e.prototype.getSupportedAudienceOptions=function(){return l.default.isFeatureEnabled(c)?[r.SharingAudience.anyone,r.SharingAudience.specificPeople]:[r.SharingAudience.anyone]};e.prototype.isSpecificPeopleExpirationAllowed=function(){return!0};e.prototype.showAudienceLearnMore=function(){return!1};e.prototype.resetPeoplePickerError=function(){this._sharingInformation.peoplePickerError=void 0;this._emitChange()};e.prototype._toTuple=function(e){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);t={};return[4,e];case 1:return[2,(t.value=n.sent(),t)];case 2:return[2,{error:n.sent()}];case 3:return[2]}})})};e.prototype._isError=function(e){return!!e.error};return e}();t.default=p});
define("@ms/odsp-datasources/lib/Sharing",["require","exports","tslib","./interfaces/sharing/SharingInterfaces","./providers/sharing/SharingSiteProvider","./interfaces/sharing/enums/SharingInfoType","./interfaces/sharing/enums/SharingLinkKind","./interfaces/sharing/enums/SharingLinkType","./interfaces/sharing/enums/SharingRole","./dataSources/sharing/SharingDataSource","./providers/sharing/SharingProvider"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t);n.__exportStar(f,t);n.__exportStar(l,t)});
define("@ms/odsp-datasources/lib/providers/sharing/SharingSiteProvider",["require","exports","../../dataSources/sharing/SharingSiteDataSource"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._dataSource=e.sharingSiteDataSource||new n.SharingSiteDataSource(e.pageContext)}e.prototype.getSharingSettings=function(){return this._dataSource.getSharingSettings()};e.prototype.shareSite=function(e,t){return this._dataSource.shareSite(e,t)};e.prototype.getSiteSharingSettings=function(){return this._dataSource.getSiteSharingSettings()};e.prototype.setSiteSharingSettings=function(e){return this._dataSource.setSiteSharingSettings(e)};return e}();t.SharingSiteProvider=r});
define("@ms/odsp-datasources/lib/dataSources/sharing/SharingSiteDataSource",["require","exports","tslib","../../dataSources/base/DataSource","../../interfaces/ISpPageContext","@ms/odsp-utilities/lib/async/Promise","../base/DataBatchOperationHelper","@ms/odsp-utilities/lib/guid/Guid","@ms/odsp-utilities/lib/string/StringHelper"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,{dataSourceName:"SharingSiteDataSource"},{pageContext:t})||this,r=i.getSafeWebServerRelativeUrl(n._pageContext);n._getSharingSettingsUrl=r+"/_api/SP.Web.GetObjectSharingSettings?$expand=ObjectSharingInformation,SharePointSettings/PickerProperties";n._shareUrl=r+"/_api/SP.Web.ShareObject";n._getSiteSharingtSettingsUrl=r+"/_api/web?$select=MembersCanShare,TenantAdminMembersCanShare,RequestAccessEmail,UseAccessRequestDefault,AccessRequestSiteDescription,AssociatedOwnerGroup,AssociatedMemberGroup&$expand=AssociatedOwnerGroup,AssociatedMemberGroup,AssociatedMemberGroup/AllowMembersEditMembership";n._setSiteSharingSettingsUrl=r+"/_api/web";n._setUseAccessRequestDefaultUrl=r+"/_api/web/SetUseAccessRequestDefaultAndUpdate";n._setUseAccessRequestDescriptiontUrl=r+"/_api/web/SetAccessRequestSiteDescriptionAndUpdate";n._setGroupAllowMembersEditMembershipUrl=r+"/_api/web/SiteGroups({0})";return n}t.prototype.getSharingSettings=function(){var e=this;return this._getSharingSettingsRawResponse().then(function(t){return e._parseSettings(t)},function(t){return e._parseError(t)})};t.prototype.getSiteSharingSettings=function(){var e=this;return this.getData(function(){return e._getSiteSharingtSettingsUrl},function(e){return JSON.parse(e).d},"SP.Web.SiteSharingSettings",null,"GET",null,null,null,!0).then(function(t){var n={};n.membersCanShare=t.MembersCanShare;n.tenantAdminMembersCanShare=t.TenantAdminMembersCanShare;n.requestAccessEmail=t.RequestAccessEmail;n.useAccessRequestDefault=t.UseAccessRequestDefault;n.accessRequestSiteDescription=t.AccessRequestSiteDescription;n.ownersGroup=e.parseSPGroup(t.AssociatedOwnerGroup);n.membersGroup=e.parseSPGroup(t.AssociatedMemberGroup);return n},function(t){return e._parseError(t)})};t.prototype.setSiteSharingSettings=function(e){var t=this,n=u.default.generate(),r="multipart/mixed; boundary=batch_"+n,i=[],f=[],l=[];if(void 0!==e.membersCanShare||void 0!==e.requestAccessEmail){i.push(this._setSiteSharingSettingsUrl);l.push("MERGE");f.push(JSON.stringify({__metadata:{type:"SP.Web"},MembersCanShare:e.membersCanShare,RequestAccessEmail:e.requestAccessEmail}))}if(void 0!==e.useAccessRequestDefault){i.push(this._setUseAccessRequestDefaultUrl);l.push("POST");f.push(JSON.stringify({useAccessRequestDefault:e.useAccessRequestDefault}))}if(void 0!==e.accessRequestSiteDescription){i.push(this._setUseAccessRequestDescriptiontUrl);l.push("POST");f.push(JSON.stringify({description:e.accessRequestSiteDescription}))}if(e.membersGroup&&void 0!==e.defaultMembersGroupAddMembers){i.push(a.format(this._setGroupAllowMembersEditMembershipUrl,e.membersGroup.id));l.push("MERGE");f.push(JSON.stringify({__metadata:{type:"SP.Group"},AllowMembersEditMembership:e.defaultMembersGroupAddMembers}))}if(0!=i.length){var c=this.getData(function(){return o.DataBatchOperationHelper.getBatchOperationUrl(t._pageContext.webAbsoluteUrl)},function(e){return e},"SP.Web.SetSiteSharingSettings",function(){return o.DataBatchOperationHelper.getBatchContentExtended(n,i,"POST",o.DataBatchOperationHelper.defaultBatchRequestPostData,f,o.DataBatchOperationHelper.defaultBatchAcceptData,l)},"POST",null,r,void 0,void 0,void 0);return new s.default(function(e,t){c.then(function(n){var r=o.DataBatchOperationHelper.processBatchResponse(n);r.hasError?t(r):e(r)},function(e){t(e)})}).then(function(e){},function(e){return s.default.reject(e)})}};t.prototype.shareSite=function(e,n){var r=this;return this.getData(function(){return r._shareUrl},function(e){var r=JSON.parse(e).d,i=[];r.UniquelyPermissionedUsers&&r.UniquelyPermissionedUsers.results&&(i=r.UniquelyPermissionedUsers.results);var s=[];r.InvitedUsers&&r.InvitedUsers.results&&(s=r.InvitedUsers.results);var o={};o.statusCode=r.StatusCode;o.errorMessage=r.ErrorMessage;o.people=t._parsePeople(i,n.siteUrl);o.invitedUsers=t._parsePeople(s,n.siteUrl);return o},"ShareSite",function(){for(var t=[],r=0;r<e.length;r++){var i=e[r];t.push(i.rawPersonData)}n.roleValue===2..toString()?n.roleValue="role:1073741827":n.roleValue===1..toString()?n.roleValue="role:1073741826":n.roleValue===(0).toString()&&(n.roleValue="role:1073741829");var s={url:n.siteUrl,peoplePickerInput:JSON.stringify(t),roleValue:n.roleValue,groupId:n.groupId,sendEmail:n.sendEmail,emailBody:n.message,emailSubject:n.subject,includeAnonymousLinkInEmail:!n.requireSignIn,propagateAcl:n.propagateSharing,useSimplifiedRoles:!0};return JSON.stringify(s)})};t.prototype._getSharingSettingsRawResponse=function(){var e=this,t={useSimplifiedRoles:!0};t.objectUrl=this._pageContext.webAbsoluteUrl;return this.getData(function(){return e._getSharingSettingsUrl},function(e){return JSON.parse(e).d},"SP.Web.GetObjectSharingSettings",function(){return JSON.stringify(t)},"POST",null,null,null,!0)};t._parsePeople=function(e,n){return e.map(function(e){var r={siteUrl:n,role:t._parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:r}})};t._parseSharingRole=function(e){switch(e){case 0:return 5;case 1:return 1;case 2:return 2;default:return 1}};t.prototype._parseError=function(e){var t={};t.sharingApiErrorMessage=e.message.value;return t};t.prototype._parseSettings=function(e){var t={};t.canSendEmail=e.canSendEmail;t.pickerProperties={};t.itemUrl=e.itemUrl;t.mailSettings={defaultCharacterLimit:500};t.itemId=e.ItemId;t.itemName=e.ItemName;t.canManagePermissions=e.ObjectSharingInformation.CanManagePermissions;t.canSendEmail=e.CanSendEmail;t.pickerProperties={};t.supportsSharingPropagation=e.SupportsAclPropagation;t.showAdditionalExternalWarning=e.ShowExternalSharingWarning;t.sharedWithMany=e.ObjectSharingInformation.IsSharedWithSecurityGroup||e.ObjectSharingInformation.IsSharedWithMany;t.blockPeoplePickerAndSharing=e.BlockPeoplePickerAndSharing;t.canCurrentUserShareExternally=e.CanCurrentUserShareExternally;e.SharePointSettings&&e.SharePointSettings.PickerProperties&&this._setPickerProperties(e.SharePointSettings.PickerProperties,e.SharePointSettings.PickerProperties.PrincipalAccountType,t);var n=[];if(e.SimplifiedRoles&&e.SimplifiedRoles.results)for(var r=0;r<e.SimplifiedRoles.results.length;r++){var i={};i.name=e.SimplifiedRoles.results[r].Key;i.value=e.SimplifiedRoles.results[r].Value;n.push(i)}t.sharingRoles=n;t.showAdvanced=t.canManagePermissions;return t};t.prototype.parseSPGroup=function(e){return{id:e.Id,loginName:e.LoginName,principalType:e.PrincipalType,title:e.Title,allowMembersEditMembership:e.AllowMembersEditMembership,description:e.Description}};t.prototype._setPickerProperties=function(e,t,n){n.pickerProperties=e;n.pickerProperties.PrincipalAccountType=this._convertPrincipalType(t)};t.prototype._convertPrincipalType=function(e){if(!e)return 0;for(var t=0,n=0,r=e.split(",");n<r.length;n++){var i=r[n];"User"===i?t|=1:"DL"===i?t|=2:"SecGroup"===i?t|=4:"SPGroup"===i&&(t|=8)}return t};return t}(r.default);t.SharingSiteDataSource=f;t.default=f});
define("@ms/odsp-datasources/lib/dataSources/base/DataBatchOperationHelper",["require","exports","@ms/odsp-utilities/lib/guid/Guid","../../utilities/url/ApiUrlHelperBasic","@ms/odsp-utilities/lib/uri/SimpleUri"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){}e.getBatchOperationUrl=function(e,t){return new r.ApiUrlHelperBasic({webAbsoluteUrl:!e&&t?new i.SimpleUri(t).authority:e}).build().segment("$batch").toString()};e.processErrorResponse=function(e,t){var n={id:t};if((e=e.error?e.error:e)&&e.code){var r=e.code?e.code.split(","):e.error.code.split(","),i=Number(r[0]),s=e.message.value;n.error={code:i,message:s}}return{items:[n]}};e.getBatchResponseText=function(e){var t,n,r,i=[];e.split("\n").length>0&&(t=e.split("\n")[0]);if(t){n=(e=e.replace(t.trim()+"--","")).split(t);for(var s=1;s<n.length;s++)(r=n[s].split("\n\r")).length>2&&i.push(r[2])}return i};e.processBatchResponse=function(e,t,n){var r,i,s,o,u=[],a=!1;e.split("\n").length>0&&(r=e.split("\n")[0]);if(r){i=(e=e.replace(r.trim()+"--","")).split(r);for(var f=1;f<i.length;f++)if((s=i[f].split("\n\r")).length>2){try{o=JSON.parse(s[2])}catch(e){o=s[2]}var l=t&&t[f-1],c=l?{key:l.key,id:l.id,newId:n?n+"/"+l.name:null}:{};if((o=o.error?o.error:o)&&o.code){var h=o.code?o.code.split(","):o.error.code.split(","),p=Number(h[0]),d=o.message.value;c.error={code:p,message:d};a=!0}u.push(c)}}return{items:u,hasError:a}};e.getBatchContent=function(e,t,r,i){for(var s=[],o=0;o<t.length;o++){for(var u=t[o],a=n.default.generate(),f=[],l=0;l<u.length;l++){var c=u[l];f.push("--changeset_"+a);f.push("Content-Type: application/http");f.push("Content-Transfer-Encoding: binary");f.push("");f.push(r+" "+c+" HTTP/1.1");f.push(i);f.push("")}f.push("--changeset_"+a+"--");var h=f.join("\r\n");s.push("--batch_"+e);s.push('Content-Type: multipart/mixed; boundary="changeset_'+a+'"');s.push("Content-Length: "+h.length);s.push("Content-Transfer-Encoding: binary");s.push("");s.push(h);s.push("")}s.push("--batch_"+e+"--");return s.join("\r\n")};e.getBatchContentExtended=function(e,t,r,i,s,o,u){var a=n.default.generate(),f=[];s&&s.length!==t.length&&(s=null);for(var l=0;l<t.length;l++){var c=t[l];f.push("--changeset_"+a);f.push("Content-Type: application/http");f.push("Content-Transfer-Encoding: binary");f.push("");u?f.push(u[l]+" "+c+" HTTP/1.1"):f.push(r+" "+c+" HTTP/1.1");f.push(i);o&&f.push(o);if(s){f.push("");f.push(s[l])}f.push("")}f.push("--changeset_"+a+"--");var h=f.join("\r\n");(f=[]).push("--batch_"+e);f.push('Content-Type: multipart/mixed; boundary="changeset_'+a+'"');f.push("Content-Length: "+h.length);f.push("Content-Transfer-Encoding: binary");f.push("");f.push(h);f.push("");f.push("--batch_"+e+"--");return f.join("\r\n")};e.defaultBatchRequestPostData="Content-Type: application/json;odata=verbose";e.defaultBatchAcceptData="accept: application/json;odata=verbose";return e}();t.DataBatchOperationHelper=s;t.default=s});
define("@ms/odsp-datasources/lib/dataSources/sharing/SharingDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/dateTime/DateTime","../../utilities/url/ItemUrlHelper","../../utilities/url/UserPhotoUrlHelper","../../utilities/url/ApiUrlHelper","../base/DataSource","../../interfaces/sharing/SharingInterfaces","../../interfaces/ISpPageContext","@ms/odsp-utilities/lib/icons/ItemType","./SharingDataSourceHelper","../web/WebTemplateType","@ms/odsp-utilities/lib/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EDIT_ROLE="role:1073741827";t.VIEW_ROLE="role:1073741826";t.HasInheritedLinksUI={ODB:1657};var d=function(e){n.__extends(u,e);function u(t,n){void 0===n&&(n={pageContext:t.pageContext});var r=e.call(this,{dataSourceName:"SharingDataSource"},n)||this;r._getParentListId=t.getParentListId;r._itemUrlHelper=t.itemUrlHelper||new i.ItemUrlHelper({},{pageContext:t.pageContext});r._apiUrlHelper=t.apiUrlHelper||new o.ApiUrlHelper({},{pageContext:t.pageContext,itemUrlHelper:r._itemUrlHelper});r._sharingContextInformation=t.sharingContextInformation||void 0;r._sharingDataSourceHelper=new c.default({itemUrlHelper:r._itemUrlHelper,sharingContextInformation:r._sharingContextInformation,isItemUrlEncoded:t.isItemUrlEncoded});var s=f.getSafeWebServerRelativeUrl(r._pageContext);r._shareUrl=s+"/_api/SP.Web.ShareObject";return r}u.parsePeople=function(e){return e.map(function(e){var t={role:u.parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:t}})};u.parseSharingRole=function(e){switch(e){case 0:return 5;case 1:return 1;case 2:return 2;case 6:return 6;default:return 1}};u.prototype.getSharingInformation=function(e,t,n,r){var i,s=this,o=(r=r||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e))).segment("GetSharingInformation"),u="pickerSettings";t&&(u+=",permissionsInformation");n&&(u+=",sharingLinkTemplates");i=o.oDataParameter("$Expand",u).toString();return this.getData(function(){return i},function(t){var n=JSON.parse(t);return s._parseGetSharingInformationResponse(n,e)},"GetSharingInformation",null,"POST",null,null,null,!0,void 0,void 0,void 0,this._getExtraData())};u.prototype.emailWithoutPermissioning=function(e,t,n,r){var i=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("ForwardObjectLink").toString();return this.getData(function(){return i},function(e){var n=JSON.parse(e).d,r=[];n.UniquelyPermissionedUsers&&n.UniquelyPermissionedUsers.results&&(r=n.UniquelyPermissionedUsers.results);var i=[];n.InvitedUsers&&n.InvitedUsers.results&&(i=n.InvitedUsers.results);var s={};s.statusCode=n.StatusCode;s.errorMessage=n.ErrorMessage;s.people=u.parsePeople(r);s.invitedUsers=u.parsePeople(i);s.itemId=t&&t.id;i.length>0&&(s.invitationLink=i[0].InvitationLink);s.invalidEmails=[];if(n.UsersWithInvalidEmails&&n.UsersWithInvalidEmails.results)for(var o=0,a=n.UsersWithInvalidEmails.results;o<a.length;o++){var f=a[o];s.invalidEmails.push(f.User)}return s},"ForwardObjectLink",function(){for(var t=[],i=0,s=e;i<s.length;i++){var o=s[i];t.push(o.rawPersonData)}var u={peoplePickerInput:JSON.stringify(t),emailBody:n,emailSubject:r};return JSON.stringify(u)})};u.prototype.checkPermissions=function(e,t){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("CheckPermissions").toString();return this.getData(function(){return n},function(e){var t=JSON.parse(e);if(t.d){return t.d.CheckPermissions.results}return null},"CheckPermissions",function(){var t={recipients:e};return JSON.stringify(t)})};u.prototype.share=function(e,n){var r,i=this,s=!!this._sharingContextInformation||this._sharingDataSourceHelper.canUseSecurable(n.items[0]);if(9===n.linkType||6===n.linkType||5===n.linkType)return this._shareLink(e,n);if(s){var o=n.items[0],a=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,o,this._getParentListId(o));r=a.segment("ShareObject").toString()}else r=this._shareUrl;return this.getData(function(){return r},function(e){var t=JSON.parse(e).d,r=[];t.UniquelyPermissionedUsers&&t.UniquelyPermissionedUsers.results&&(r=t.UniquelyPermissionedUsers.results);var i=[];t.InvitedUsers&&t.InvitedUsers.results&&(i=t.InvitedUsers.results);var s={};s.statusCode=t.StatusCode;s.errorMessage=t.ErrorMessage;s.people=u.parsePeople(r);s.invitedUsers=u.parsePeople(i);s.itemId=n.items[0]&&n.items[0].id;i.length>0&&(s.invitationLink=i[0].InvitationLink);s.invalidEmails=[];if(t.UsersWithInvalidEmails&&t.UsersWithInvalidEmails.results)for(var o=0,a=t.UsersWithInvalidEmails.results;o<a.length;o++){var f=a[o];s.invalidEmails.push(f.User)}return s},"Share",function(){for(var r=[],o=0;o<e.length;o++){var u=e[o];r.push(u.rawPersonData)}n.roleValue===2..toString()?n.roleValue=t.EDIT_ROLE:n.roleValue===1..toString()&&(n.roleValue=t.VIEW_ROLE);var a={peoplePickerInput:JSON.stringify(r),roleValue:n.roleValue,sendEmail:n.sendEmail,emailBody:n.message,emailSubject:n.subject,includeAnonymousLinkInEmail:!n.requireSignIn,propagateAcl:n.propagateSharing,useSimplifiedRoles:!0};s||(a.url=i._sharingDataSourceHelper.getFileUrl(n.items[0]));return JSON.stringify(a)})};u.prototype.updatePermissions2=function(e,t,n){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return r},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole}:null},"UpdatePermissions2",function(){var t;switch(n){case 0:t=0;break;case 1:t=1;break;case 6:t=6;break;case 2:t=2;break;default:t=1}var r={userRoleAssignments:[{UserId:e.loginName,Role:t}],validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(r)})};u.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return s},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole,success:t.UpdateDocumentSharingInfo.results.map(function(e){return e.Status}).reduce(function(e,t){return e&&t},!0)}:null},"UpdatePermissionsMultiple",function(){var t;switch(n){case 0:t=0;break;case 1:t=1;break;case 6:t=6;break;case 2:t=2;break;default:t=1}var s={userRoleAssignments:e.map(function(e){return{UserId:e.userId,Role:t}}),validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:r,customMessage:i,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(s)})};u.prototype.parseRawSharingInformation=function(e){return this._parseGetSharingInformationResponse(e,void 0)};u.prototype.unshareLink=function(e){var t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.item,this._getParentListId(e.item)).segment("UnshareLink").toString();return this.getData(function(){return t},function(e){return!!JSON.parse(e).d},"UnshareLink",function(){var t={linkKind:e.kind,shareId:e.shareId};return JSON.stringify(t)})};u.prototype.shareLink=function(e){var t=e.settings,n=e.items[0],i=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.items[0],this._getParentListId(n)).segment("ShareLink").toString();return this.getData(function(){return i},function(e){var t=JSON.parse(e);return t.d?v(t):t.error?{error:5,errorMessage:t.error.message}:void 0},"ShareLink",function(){var n=null;t.expiration&&(n=r.convertDateToISOString(t.expiration.toString()));var i=null;if(e.recipients&&e.recipients.length>0){i=[];for(var s=0,o=e.recipients;s<o.length;s++){var u=o[s];u.rawPersonData&&i.push(u.rawPersonData)}}var a=null;if(t.inviteesToRemove&&t.inviteesToRemove.length>0){a=[];for(var f=0,l=t.inviteesToRemove;f<l.length;f++){var c=l[f];a.push({id:c.id,loginName:c.loginName,name:c.primaryText,isExternal:c.isExternal,principalType:c.type,email:c.email})}}var h={request:{createLink:!0,settings:{allowAnonymousAccess:t.allowAnonymousAccess,linkKind:t.sharingLinkKind,expiration:n,role:t.role,restrictShareMembership:t.restrictShareMembership,updatePassword:t.updatePassword,password:t.password,shareId:t.shareId}}};a&&(h.request.settings.inviteesToRemove={results:a});if(i&&i.length>0){h.request.peoplePickerInput=JSON.stringify(i);var p=e.emailData,d=e.emailSubject;void 0!==p&&void 0===d&&(h.request.emailData={body:e.emailData,subject:""});void 0===p&&void 0!==d&&(h.request.emailData={body:"",subject:e.emailSubject});void 0!==p&&void 0!==d&&(h.request.emailData={body:e.emailData,subject:e.emailSubject})}var v=e.settings.shareId;if(v){h.request.settings.shareId=v;h.request.emailData={body:""}}return JSON.stringify(h)},"POST",null,null,null,!0,void 0,void 0,void 0,this._getExtraData()).catch(function(e){var t="";try{t=JSON.stringify(e)}catch(e){}return{error:5,debugErrorMessage:t}})};u.prototype.getClientId=function(){switch(Number(this._pageContext.webTemplate)){case h.default.teamSite:case h.default.group:case h.default.subgroup:case h.default.sitePagePublishing:return a.ClientId.sharePoint;case h.default.mySite:return a.ClientId.odb;default:return a.ClientId.unknown}};u.prototype._shareLink=function(e,t){var n=this,i=t.items[0],s=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,i,this._getParentListId(i)).segment("ShareLink").toString();return this.getData(function(){return s},function(n){return{statusCode:0,errorMessage:"",people:e,itemId:t.items[0].id}},"ShareLink",function(){for(var i=[],s=0,o=e;s<o.length;s++){var u=o[s];i.push(u.rawPersonData)}var a=null;t.expiration&&(a=r.convertDateToISOString(t.expiration));var f={request:{peoplePickerInput:JSON.stringify(i),emailData:{body:t.message,subject:t.subject},linkKind:n._getSharingLinkKind(t.linkType,t.roleValue),createLink:!0,expiration:a}};return JSON.stringify(f)})};u.prototype._getSharingLinkKind=function(e,t){var n=1;6===e?n=5:5===e?n=4:9===e&&(n=t===2..toString()?3:2);return n};u.prototype._parseGetSharingInformationResponse=function(e,n){if(e.error)return{error:5,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,userRole:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0};var r=e.d,i=!!r.permissionsInformation,s=!!r.sharingLinkTemplates,o=p.default.isFeatureEnabled(t.HasInheritedLinksUI)&&i,u=i?this._parseSharingLinks(r.permissionsInformation.links.results,r.directUrl):[],f=s?this._parseSharingLinkTemplates(r.sharingLinkTemplates.templates.results):[],c=i?r.permissionsInformation.siteAdmins.results.concat(r.permissionsInformation.principals.results):[],h=this._parseSharingPrincipals(c),d=this._getDefaultSharingLink(r.defaultLinkKind,u,r.sharingAbilities),v={name:this._sharingContextInformation?this._sharingContextInformation.itemName:void 0,childCount:this._sharingContextInformation?this._sharingContextInformation.itemCount:void 0,hasDlpPolicy:this._sharingContextInformation?this._sharingContextInformation.hasDlpPolicy:void 0,extension:this._sharingContextInformation?this._sharingContextInformation.itemExtension:void 0,appmap:this._sharingContextInformation?this._sharingContextInformation.itemAppmap:void 0,itemType:this._sharingContextInformation?this._sharingContextInformation.itemType:void 0};if(n){var m=n.properties,g=m.ItemChildCount?parseInt(m.ItemChildCount,10):0,y=m.FolderChildCount?parseInt(m.FolderChildCount,10):0,b=n.type===l.default.OneNote?0:g+y,w=this._isPolicyTipFlagSet(n.policyTip,4);v={name:n.name,childCount:b,hasDlpPolicy:w,extension:n.extension,appmap:n.appMap,itemType:n.type}}var E=r.canRequestAccessForGrantAccess||r.canAddInternalPrincipal||u.length>1;return{anonymousLinkExpirationRestrictionDays:0===r.anonymousLinkExpirationRestrictionDays?-1:r.anonymousLinkExpirationRestrictionDays,canAddExternalPrincipal:r.canAddExternalPrincipal,canAddInternalPrincipal:r.canAddInternalPrincipal,defaultShareLinkToExistingAccess:r.defaultShareLinkToExistingAccess,canManagePermissions:E,defaultSharingLink:d,hasInheritedLinks:!!o&&r.permissionsInformation.hasInheritedLinks,isShared:this._computeIsShared(u,h),item:v,sharingLinks:u,sharingPrincipals:h,peoplePickerSettings:r.pickerSettings,userDisplayName:this._pageContext.userDisplayName,blockPeoplePickerAndSharing:r.blockPeoplePickerAndSharing,requiresAccessApproval:!r.canAddInternalPrincipal&&r.canRequestAccessForGrantAccess,userRole:r.currentRole,defaultShareLinkPermission:r.defaultShareLinkPermission,sharingAbilities:r.sharingAbilities,defaultLinkKind:r.defaultLinkKind,directLink:{allowsAnonymousAccess:!1,audience:a.SharingAudience.existing,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:1,url:r.directUrl,updatePassword:!1,password:"",passwordLastModifiedBy:null},hasPermissionsInformation:!!r.permissionsInformation,sharingLinkTemplates:f,webTemplateId:r.webTemplateId,itemUniqueId:r.itemUniqueId,customizedExternalSharingServiceUrl:r.customizedExternalSharingServiceUrl||""}};u.prototype._computeIsShared=function(e,t){for(var n=!1,r=0,i=e;r<i.length;r++){var s=i[r];s.isActive&&1!==s.sharingLinkKind&&(n=!0)}n||(n=t.length>0);return n};u.prototype._parseSharingLinks=function(e,t){var n=this,r=(e=e.filter(function(e){return!e.isInherited})).map(function(e){var t=e.linkDetails;return{allowsAnonymousAccess:t.AllowsAnonymousAccess,hasPassword:t.RequiresPassword,blockDownload:t.BlocksDownload,description:t.Description,audience:m(t.LinkKind,t.AllowsAnonymousAccess,t.RestrictedShareMembership),expiration:t.Expiration?new Date(t.Expiration):null,isActive:t.IsActive,isEdit:g(t.LinkKind)||t.IsEditLink,isReview:t.IsReviewLink,principals:n._parseSharingPrincipals(e.linkMembers.results,t.LinkKind),invitees:n._parseLinkInvitees(t),shareId:t.ShareId,sharingLinkKind:t.LinkKind,url:t.Url,updatePassword:t.UpdatePassword,password:t.Password,passwordLastModifiedBy:n._parseSharingPrincipal(t.PasswordLastModifiedBy),isCreateOnlyLink:t.IsCreateOnlyLink}});r.push({allowsAnonymousAccess:!1,audience:a.SharingAudience.specificPeople,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:1,url:t,updatePassword:!1,password:"",passwordLastModifiedBy:null});return r};u.prototype._parseSharingLinkTemplates=function(e){var t=this;return e.map(function(e){var n,r=e.linkDetails;null!==r&&(n={allowsAnonymousAccess:r.AllowsAnonymousAccess,hasPassword:r.RequiresPassword,blockDownload:r.BlocksDownload,audience:m(r.LinkKind,r.AllowsAnonymousAccess,r.RestrictedShareMembership),expiration:r.Expiration?new Date(r.Expiration):null,description:r.Description,isActive:r.IsActive,isEdit:g(r.LinkKind)||r.IsEditLink,isReview:r.IsReviewLink,principals:void 0,invitees:t._parseLinkInvitees(r),shareId:r.ShareId,sharingLinkKind:r.LinkKind,url:r.Url,updatePassword:r.UpdatePassword,password:r.Password,passwordLastModifiedBy:t._parseSharingPrincipal(r.PasswordLastModifiedBy)});return{linkDetails:n,passwordProtected:e.passwordProtected,role:e.role,scope:e.scope,shareKind:e.shareKind}})};u.prototype._parseLinkInvitees=function(e){var t=this,n=e.Invitations;if(!n)return[];for(var r=[],i=0,s=n.results;i<s.length;i++){var o=s[i];o&&o.invitee&&r.push(o.invitee)}return r.map(function(e){return{id:e.id,email:e.email,primaryText:e.name,isExternal:e.isExternal,loginName:e.loginName,role:null,secondaryText:e.jobTitle,type:e.principalType,imageUrl:t._getImageUrl(e.email)}})};u.prototype._parseSharingPrincipals=function(e,t){var n=this;return e.map(function(e){var r=e.principal;r||(r=e);var i={id:r.id,isExternal:r.isExternal,loginName:r.loginName,primaryText:r.name,role:e.role,secondaryText:r.jobTitle,type:r.principalType,imageUrl:n._getImageUrl(r.email),email:r.email};t&&(i.sharingLinkKind=t);return i})};u.prototype._getExtraData=function(){var e;this._sharingContextInformation&&(e={clientId:this._sharingContextInformation.clientId,mode:a.Mode[this._sharingContextInformation.mode]});return e};u.prototype._parseSharingPrincipal=function(e){if(e){var t=e.principal;t||(t=e);return{id:t.id,isExternal:t.isExternal,loginName:t.loginName,primaryText:t.name,role:e.role,secondaryText:t.jobTitle,type:t.principalType,imageUrl:this._getImageUrl(t.email),email:t.email}}return null};u.prototype._getDefaultSharingLink=function(e,t,n){(n.peopleSharingLinkAbilities.canManageEditLink.enabled||n.peopleSharingLinkAbilities.canManageReadLink.enabled)&&1===e&&(e=6);var r=e;5!==r||n.anonymousLinkAbilities.canManageEditLink.enabled||(r=4);4!==r||n.anonymousLinkAbilities.canManageReadLink.enabled||(r=3);3!==r||n.organizationLinkAbilities.canManageEditLink.enabled||(r=2);2!==r||n.organizationLinkAbilities.canManageReadLink.enabled||(r=1);return{allowsAnonymousAccess:void 0,audience:void 0,expiration:void 0,description:void 0,isActive:!0,isEdit:void 0,principals:void 0,shareId:void 0,sharingLinkKind:r,url:void 0,invitees:void 0,updatePassword:!1,password:"",passwordLastModifiedBy:void 0}};u.prototype._getImageUrl=function(e){if(e&&this._sharingContextInformation){var t=this._sharingContextInformation&&this._sharingContextInformation.clientId;return"word"===t||"powerpoint"===t||"excel"===t?null:e&&this._sharingContextInformation?this._sharingContextInformation.webAbsoluteUrl+s.getUserPhotoUrl({userLoginName:e}):null}if(e&&this._pageContext){return f.getSafeWebServerRelativeUrl(this._pageContext)+s.getUserPhotoUrl({userLoginName:e})}return null};u.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t};return u}(u.default);t.SharingDataSource=d;function v(e){if(e.d){var t=e.d.ShareLink.sharingLinkInfo,n=t.Expiration?new Date(t.Expiration):void 0;return{link:{allowsAnonymousAccess:t.AllowsAnonymousAccess,audience:m(t.LinkKind,t.AllowsAnonymousAccess,t.RestrictedShareMembership),expiration:n,description:t.Description,isActive:t.IsActive,isEdit:g(t.LinkKind)||t.IsEditLink,principals:null,invitees:null,shareId:t.ShareId,sharingLinkKind:t.LinkKind,url:t.Url,updatePassword:t.UpdatePassword,password:t.Password,passwordLastModifiedBy:t.PasswordLastModifiedBy}}}}t.parseSharingLinkInfo=v;function m(e,t,n){return 5===e||4===e?a.SharingAudience.anyone:3===e||2===e?a.SharingAudience.organization:1===e?a.SharingAudience.specificPeople:6===e?t?a.SharingAudience.anyone:!1===n?a.SharingAudience.organization:a.SharingAudience.specificPeopleFlex:void 0}function g(e){return 5===e||3===e||4!==e&&2!==e&&null}});
define("@ms/odsp-datasources/lib/dataSources/sharing/SharingDataSourceHelper",["require","exports","../../utilities/path/Path"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._itemUrlHelper=e.itemUrlHelper;this._sharingContextInformation=e.sharingContextInformation}e.prototype.getApiRoot=function(e,t,r){if(this._sharingContextInformation){if(this._sharingContextInformation.uniqueId){var i=this._sharingContextInformation.isFolder?"GetFolderById":"GetFileById",s={guid:this._sharingContextInformation.uniqueId};return e.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method(i,s).segment("ListItemAllFields")}return this._sharingContextInformation.listUrl?e.build().webByUrl({listUrl:this._sharingContextInformation.listUrl}).method("GetListItem",this._sharingContextInformation.serverRelativeItemUrl):this._sharingContextInformation.itemUrl?e.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("GetFileByUrl",n.canonicalizeUrl(this._sharingContextInformation.itemUrl)).segment("ListItemAllFields"):this._sharingContextInformation.listId&&this._sharingContextInformation.listItemId?e.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("Lists",this._sharingContextInformation.listId).method("GetItemById",this._sharingContextInformation.listItemId):e.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("GetListItemByResourceId",this._sharingContextInformation.resourceId)}var o;o=t.properties.path?this._itemUrlHelper.getUrlParts({path:t.properties.path}):this._itemUrlHelper.getItemUrlParts(t.key);var u=e.build().webByItemUrl(o).method("Lists",r);return u=t.properties.ID?u.method("GetItemById",t.properties.ID):u.method("GetItemByUniqueId",t.properties.uniqueId)};e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl};e.prototype.canUseSecurable=function(e){var t=e.properties;return!!t&&(!!t.ID||!!t.uniqueId)};return e}();t.default=r});
define("@ms/odsp-datasources/lib/providers/sharing/SharingProvider",["require","exports","../../dataSources/sharing/SharingDataSource"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._dataSource=e.sharingDataSource||new n.SharingDataSource({getParentListId:e.getParentListId,pageContext:e.pageContext});this._itemProvider=e.itemProvider}e.prototype.getSharingInformation=function(e,t,n,r){return this._dataSource.getSharingInformation(e,t,n,r)};e.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(n){t._invalidateItem(e.items[0]);return n})};e.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(n){t._invalidateItem(e.item);return n})};e.prototype.updatePermissions2=function(e,t,n){var r=this;return this._dataSource.updatePermissions2(e,t,n).then(function(e){r._invalidateItem(t);return e})};e.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var s=this;return this._dataSource.updatePermissionsMultiple(e,t,n,r,i).then(function(e){s._invalidateItem(t);return e})};e.prototype.getClientId=function(){return this._dataSource.getClientId()};e.prototype.parseRawSharingInformation=function(e){return this._dataSource.parseRawSharingInformation(e)};e.prototype.emailWithoutPermissioning=function(e,t,n,r){return this._dataSource.emailWithoutPermissioning(e,t,n,r).then(function(e){return e})};e.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)};e.prototype.share=function(e,t,n){return this._dataSource.share(e,t).then(function(e){return e})};e.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.parent&&e.parent.key&&this._itemProvider.invalidateItem(e.parent.key)};return e}();t.SharingProvider=r});
define("@ms/odsp-graph/lib/services/sharing/SharingService",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={ownerCannotShareWithSelf:!0,maximumRecipientsExceeded:!0,invalidAclEmailSpecified:!0,duplicateMembersInRequest:!0,secureSharingInvalidRequest:!0},r=function(){function e(e,t){this._dataRequestor=t.dataRequestor}e.prototype.createBundle=function(e,t){var r=JSON.stringify({children:e.map(function(e){return{id:e}}),bundle:{},name:t});r=r.slice(0,-1)+',"@microsoft.graph.conflictBehavior": "rename"}';return this._dataRequestor.send({path:"/drive/bundles",apiName:"bundles",requestType:"POST",useAuthorizationHeaders:!0,postData:r,getErrorAsMessage:!0,expectedErrorCodes:n}).then(function(e){return e})};e.prototype.isUserPremium=function(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:n}).then(function(e){return!!e.quota.storagePlanInformation&&!e.quota.storagePlanInformation.upgradeAvailable})};e.prototype.createLink=function(e){var t=this,n=e.itemIds,r=e.type,i=e.scope,s=e.preventDownload,o=e.password,u=e.expiration,a=e.bundleName;return 1===n.length?this.createLinkSingleItem(this.getDrivesPathFromItemId(n[0]),r,i,s,o,u):this.createBundle(n,a).then(function(e){return t.createLinkSingleItem(t.getDrivesPathFromItemId(e.id),r,i,s,o,u)})};e.prototype.createLinkFromItemUrl=function(e){var t=e.itemUrl,n=e.type,r=e.scope,i=e.preventDownload,s=e.password,o=e.expiration;return this.createLinkSingleItem(this.getSharesPathFromItemUrl(t),n,r,i,s,o)};e.prototype.getCurrentUserId=function(){return this._dataRequestor.send({path:"/me",apiName:"me",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:n}).then(function(e){return e.id})};e.prototype.getItemInfo=function(e){var t=""+this.getDrivesPathFromItemId(e);return this._dataRequestor.send({path:t,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:n}).then(function(e){return e})};e.prototype.getItemInfoFromItemUrl=function(e){var t=""+this.getSharesPathFromItemUrl(e);return this._dataRequestor.send({path:t,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:n}).then(function(e){return e})};e.prototype.getPermissions=function(e){var t=this.getDrivesPathFromItemId(e)+"/permissions";return this._dataRequestor.send({path:t,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:n}).then(function(e){return e.value})};e.prototype.getPermissionsFromItemUrl=function(e){var t=this.getSharesPathFromItemUrl(e)+"/permissions";return this._dataRequestor.send({path:t,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:n}).then(function(e){return e.value})};e.prototype.invite=function(e){var t=this,n=e.itemIds,r=e.recipients,i=e.message,s=e.requireSignIn,o=e.sendInvitation,u=e.roles,a=e.password,f=e.expiration,l=e.bundleName;return 1===n.length?this.inviteSingleItem(this.getDrivesPathFromItemId(n[0]),r,i,s,o,u,a,f):this.createBundle(n,l).then(function(e){return t.inviteSingleItem(t.getDrivesPathFromItemId(e.id),r,i,s,o,u,a,f)})};e.prototype.inviteFromItemUrl=function(e){var t=e.itemUrl,n=e.recipients,r=e.message,i=e.requireSignIn,s=e.sendInvitation,o=e.roles,u=e.password,a=e.expiration;return this.inviteSingleItem(this.getSharesPathFromItemUrl(t),n,r,i,s,o,u,a)};e.prototype.getDefaultLink=function(e,t,n){return this.inviteSingleItem(this.getSharesPathFromItemUrl(e),t,"",!0,!1,[],"",void 0,{prefer:"getDefaultLink"},n)};e.prototype.getDefaultLinkByUniqueId=function(e,t,n){return this.inviteSingleItem(this.getPathFromUniqueId(e),t,"",!0,!1,[],"",void 0,{prefer:"getDefaultLink"},n)};e.prototype.updatePermissions=function(e,t,r){var i=this.getDrivesPathFromItemId(e)+"/permissions/"+t,s={roles:[r]};return this._dataRequestor.send({path:i,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(s),getErrorAsMessage:!0,expectedErrorCodes:n}).then(function(e){return e.value})};e.prototype.updatePermissionsFromItemUrl=function(e,t,r){var i=this.getSharesPathFromItemUrl(e)+"/permissions/"+t,s={roles:[r]};return this._dataRequestor.send({path:i,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(s),getErrorAsMessage:!0,expectedErrorCodes:n}).then(function(e){return e.value})};e.prototype.unshareLink=function(e,t){var r=this.getDrivesPathFromItemId(e)+"/permissions/"+t;return this._dataRequestor.send({path:r,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:n}).then(function(){return!0})};e.prototype.unshareLinkFromItemUrl=function(e,t){var r=this.getSharesPathFromItemUrl(e)+"/permissions/"+t;return this._dataRequestor.send({path:r,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:n}).then(function(){return!0})};e.prototype.createLinkSingleItem=function(e,t,r,i,s,o){var u=e+"/createLink",a={type:t,scope:r,preventDownload:i};(s||""===s)&&(a.password=s);o&&(a.expirationDateTime=o);return this._dataRequestor.send({path:u,apiName:"createLink",requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(a),getErrorAsMessage:!0,expectedErrorCodes:n}).then(function(e){return e})};e.prototype.getSharesPathFromItemUrl=function(e){return"/shares/u!"+btoa(unescape(encodeURIComponent(e))).replace(/=+$/,"").replace("/","_").replace("+","-")+"/driveItem"};e.prototype.getPathFromUniqueId=function(e){return"/sites/root/items/"+e+"/driveItem"};e.prototype.getDrivesPathFromItemId=function(e){var t=e.split("!");return t.length>1?"/drives/"+t[0]+"/items/"+e:"/drive/items/"+e};e.prototype.inviteSingleItem=function(e,t,r,i,s,o,u,a,f,l){var c=e+"/invite",h={recipients:t,message:r,requireSignIn:i,sendInvitation:s,roles:o};u&&(h.password=u);a&&(h.expirationDateTime=a);return this._dataRequestor.send({path:c,apiName:"invite",requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(h),useMultiPart:l,headers:f,getErrorAsMessage:!0,expectedErrorCodes:n}).then(function(e){return e.value})};return e}();t.default=r});
define("@ms/odsp-datasources/lib/providers/peoplePicker/odc/PeoplePickerProvider",["require","exports","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return null},i=function(){function e(e){this.getPersonaDetails=r;this.subscribePresence=r;this.getPickerEntityInformation=r;this.addToMruCache=r;this._dataSource=e;this.MaxCacheSuggestions=0}e.prototype.search=function(e,t){var r,i=this,s={cached:null,promise:null};s.promise=new n.default(function(n,s){r=i._dataSource.search(e,t).then(function(e){e&&n(e)},function(e){s(e)})},function(){r&&r.cancel()});return s};e.prototype.resolve=function(e,t){return this._dataSource.resolve(e,t).then(function(e){return e})};return e}();t.PeoplePickerProvider=i});
define("@ms/odsp-datasources/lib/dataSources/peoplePicker/graph/PeoplePickerDataSource",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/string/EmailAddressParser","@ms/odsp-utilities/lib/killswitch/Killswitch"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e){this.service=e}e.prototype.getCapabilities=function(){return{supportsMruCaching:!1}};e.prototype.search=function(e,t){var n=!i.Killswitch.isActivated("e517cfbc-99a8-4e79-b3f8-7b7b38b93fab","04/07/2019","Picker enhancements for multiple emails in a contact");return this.service.getContacts(e).then(function(i){var s=r.default.isValidEmailSyntax(e,!1);if(!1!==t.resolveEmailIfNoResults&&0===i.length&&s)return[{email:e,name:e,userId:e,isResolved:!0}];var o=e.toLowerCase(),u=i.map(function(e){var t="",r="",i=e.emailAddresses;if(i&&i.length>0)for(var u=0,a=i;u<a.length;u++){var f=a[u];if(f&&f.address&&f.address.length>0){r||(r=f.address);if(n&&s&&0===f.address.toLowerCase().indexOf(o)){t=f.address;break}}}if(n){return{userId:s&&t||e.displayName,name:e.displayName,email:s?t:r,isResolved:!0}}return{userId:e.displayName,name:e.displayName,email:r,isResolved:!0}});return n?u.filter(function(e){return e.email&&e.email.length>0}):u})};e.prototype.resolve=function(e,t){var r,i=this,s=function(){if(r){r.cancel();r=void 0}};return new n.default(function(o,u){var a=function(e){s();o(e)};r=n.default.timeout(2e3).then(function(){a(i._getPersonFromQuery(e))});i.search(e,t).then(function(t){0===t.length?a(i._getPersonFromQuery(e)):a(t[0])},function(t){a(i._getPersonFromQuery(e))})},s)};e.prototype.getPersonaDetails=function(e){return null};e.prototype.subscribePresence=function(e,t){return{dispose:function(){}}};e.prototype.getPickerEntityInformation=function(e){return null};e.prototype._getPersonFromQuery=function(e){var t=new r.default(e),n={};if(t.getEmail()){n.name=t.getName()||"";n.image="";n.sharingInfo={type:0};n.isResolved=!0}n.email=t.getEmail()||e;return n};return e}();t.PeoplePickerDataSource=s});
define("odsp-next/controls/sharing/share/Share.html",[],function(){return'<div data-bind="interactionScope: { isScope: true }, react: { componentType: shareComponent, props: shareComponentProps }"></div>\x3c!--ko if: displayFeatureCards--\x3e<div data-bind="component: { name: featureCardsTagName, params: { cards: featureCardData, currentIndex: featureCardIndex, close: $component.closeFeatureCards.bind($component), includeOverlay: true } }"></div>\x3c!--/ko--\x3e'});