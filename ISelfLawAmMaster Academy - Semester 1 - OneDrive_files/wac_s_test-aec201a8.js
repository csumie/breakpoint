define("jquery.signalr",["jquery-1.7.2","lightobject"],function(){/*!
 * ASP.NET SignalR JavaScript Library v2.0.1-pre
 * http://signalr.net/
 *
 * Copyright Microsoft Open Technologies, Inc. All rights reserved.
 * Licensed under the Apache 2.0
 * https://github.com/SignalR/SignalR/blob/master/LICENSE.md
 *
 */
!function(e,t,n){"use strict";function o(t,n){if(e.isArray(t)){for(var o=t.length-1;o>=0;o--){var s=t[o];"string"===e.type(s)&&c.transports[s]||(n.log("Invalid transport: "+s+", removing it from the transports list."),t.splice(o,1))}0===t.length&&(n.log("No transports remain within the specified transport array."),t=null)}else if(c.transports[t]||"auto"===t){if("auto"===t&&c._.ieVersion<=8)return["longPolling"]}else n.log("Invalid transport: "+t.toString()+"."),t=null;return t}function s(e){return"http:"===e?80:"https:"===e?443:void 0}function r(e,t){return t.match(/:\d+$/)?t:t+":"+s(e)}function a(t,n){var o=this,s=[];o.tryBuffer=function(n){return t.state===e.signalR.connectionState.connecting?(s.push(n),!0):!1},o.drain=function(){if(t.state===e.signalR.connectionState.connected)for(;s.length>0;)n(s.shift())},o.clear=function(){s=[]}}var i={nojQuery:"jQuery was not found. Please ensure jQuery is referenced before the SignalR client JavaScript file.",noTransportOnInit:"No transport could be initialized successfully. Try specifying a different transport or none at all for auto initialization.",errorOnNegotiate:"Error during negotiation request.",stoppedWhileLoading:"The connection was stopped during page load.",stoppedWhileNegotiating:"The connection was stopped during the negotiate request.",errorParsingNegotiateResponse:"Error parsing negotiate response.",protocolIncompatible:"You are using a version of the client that isn't compatible with the server. Client version {0}, server version {1}.",sendFailed:"Send failed.",parseFailed:"Failed at parsing response: {0}",longPollFailed:"Long polling request failed.",eventSourceFailedToConnect:"EventSource failed to connect.",eventSourceError:"Error raised by EventSource",webSocketClosed:"WebSocket closed.",pingServerFailedInvalidResponse:"Invalid ping response when pinging server: '{0}'.",pingServerFailed:"Failed to ping server.",pingServerFailedStatusCode:"Failed to ping server.  Server responded with status code {0}, stopping the connection.",pingServerFailedParse:"Failed to parse ping server response, stopping the connection.",noConnectionTransport:"Connection is in an invalid state, there is no transport active."};if("function"!=typeof e)throw new Error(i.nojQuery);var c,u,d="complete"===t.document.readyState,l=e(t),m="__Negotiate Aborted__",g={onStart:"onStart",onStarting:"onStarting",onReceived:"onReceived",onError:"onError",onConnectionSlow:"onConnectionSlow",onReconnecting:"onReconnecting",onReconnect:"onReconnect",onStateChanged:"onStateChanged",onDisconnect:"onDisconnect"},p={processData:!0,timeout:null,async:!0,global:!1,cache:!1},h=function(e,n){if(n!==!1){var o;"undefined"!=typeof t.console&&(o="["+(new Date).toTimeString()+"] SignalR: "+e,t.console.debug?t.console.debug(o):t.console.log&&t.console.log(o))}},f=function(t,n,o){return n===t.state?(t.state=o,e(t).triggerHandler(g.onStateChanged,[{oldState:n,newState:o}]),!0):!1},v=function(e){return e.state===c.connectionState.disconnected},_=function(n){var o=n._.config,s=function(t){e(n).triggerHandler(g.onError,[t])};o&&!o.pingIntervalId&&o.pingInterval&&(n._.pingIntervalId=t.setInterval(function(){c.transports._logic.pingServer(n).fail(s)},o.pingInterval))},T=function(e){var n,o;e._.configuredStopReconnectingTimeout||(o=function(e){e.log("Couldn't reconnect within the configured timeout ("+e.disconnectTimeout+"ms), disconnecting."),e.stop(!1,!1)},e.reconnecting(function(){var e=this;e.state===c.connectionState.reconnecting&&(n=t.setTimeout(function(){o(e)},e.disconnectTimeout))}),e.stateChanged(function(e){e.oldState===c.connectionState.reconnecting&&t.clearTimeout(n)}),e._.configuredStopReconnectingTimeout=!0)};c=function(e,t,n){return new c.fn.init(e,t,n)},c._={defaultContentType:"application/x-www-form-urlencoded; charset=UTF-8",ieVersion:function(){var e,n;return"Microsoft Internet Explorer"===t.navigator.appName&&(n=/MSIE ([0-9]+\.[0-9]+)/.exec(t.navigator.userAgent),n&&(e=t.parseFloat(n[1]))),e}(),error:function(e,t,n){var o=new Error(e);return o.source=t,"undefined"!=typeof n&&(o.context=n),o},transportError:function(e,t,o,s){var r=this.error(e,o,s);return r.transport=t?t.name:n,r},format:function(){for(var e=arguments[0],t=0;t<arguments.length-1;t++)e=e.replace("{"+t+"}",arguments[t+1]);return e},firefoxMajorVersion:function(e){var t=e.match(/Firefox\/(\d+)/);return!t||!t.length||t.length<2?0:parseInt(t[1],10)}},c.events=g,c.resources=i,c.ajaxDefaults=p,c.changeState=f,c.isDisconnecting=v,c.connectionState={connecting:0,connected:1,reconnecting:2,disconnected:4},c.hub={start:function(){throw new Error("SignalR: Error loading hubs. Ensure your hubs reference is correct, e.g. <script src='/signalr/js'></script>.")}},l.load(function(){d=!0}),c.fn=c.prototype={init:function(t,n,o){var s=e(this);this.url=t,this.qs=n,this._={keepAliveData:{},connectingMessageBuffer:new a(this,function(e){s.triggerHandler(g.onReceived,[e])}),onFailedTimeoutHandle:null,lastMessageAt:(new Date).getTime(),lastActiveAt:(new Date).getTime(),beatInterval:5e3,beatHandle:null},"boolean"==typeof o&&(this.logging=o)},_parseResponse:function(e){var t=this;return e&&"text"===t.ajaxDataType?t.json.parse(e):e},json:t.JSON,isCrossDomain:function(n,o){var s;return n=e.trim(n),o=o||t.location,0!==n.indexOf("http")?!1:(s=t.document.createElement("a"),s.href=n,s.protocol+r(s.protocol,s.host)!==o.protocol+r(o.protocol,o.host))},ajaxDataType:"text",contentType:"application/json; charset=UTF-8",logging:!1,state:c.connectionState.disconnected,clientProtocol:"1.3",reconnectDelay:2e3,transportConnectTimeout:0,disconnectTimeout:3e4,reconnectWindow:3e4,keepAliveWarnAt:2/3,start:function(n,s){var r,a=this,u={pingInterval:3e5,waitForPageLoad:!0,transport:"auto",jsonp:!1},p=a._deferral||e.Deferred(),h=t.document.createElement("a");if(a._deferral=p,!a.json)throw new Error("SignalR: No JSON parser found. Please ensure json2.js is referenced before the SignalR.js file if you need to support clients without native JSON parsing support, e.g. IE<8.");if("function"===e.type(n)?s=n:"object"===e.type(n)&&(e.extend(u,n),"function"===e.type(u.callback)&&(s=u.callback)),u.transport=o(u.transport,a),!u.transport)throw new Error("SignalR: Invalid transport(s) specified, aborting start.");if(a._.config=u,!d&&u.waitForPageLoad===!0)return a._.deferredStartHandler=function(){a.start(n,s)},l.bind("load",a._.deferredStartHandler),p.promise();if(a.state===c.connectionState.connecting)return p.promise();if(f(a,c.connectionState.disconnected,c.connectionState.connecting)===!1)return p.resolve(a),p.promise();T(a),h.href=a.url,h.protocol&&":"!==h.protocol?(a.protocol=h.protocol,a.host=h.host,a.baseUrl=h.protocol+"//"+h.host):(a.protocol=t.document.location.protocol,a.host=t.document.location.host,a.baseUrl=a.protocol+"//"+a.host),a.wsProtocol="https:"===a.protocol?"wss://":"ws://","auto"===u.transport&&u.jsonp===!0&&(u.transport="longPolling"),0===a.url.indexOf("//")&&(a.url=t.location.protocol+a.url,a.log("Protocol relative URL detected, normalizing it to '"+a.url+"'.")),this.isCrossDomain(a.url)&&(a.log("Auto detected cross domain url."),"auto"===u.transport&&(u.transport=["webSockets","longPolling"]),"undefined"==typeof u.withCredentials&&(u.withCredentials=!0),u.jsonp||(u.jsonp=!e.support.cors,u.jsonp&&a.log("Using jsonp because this browser doesn't support CORS.")),a.contentType=c._.defaultContentType),a.withCredentials=u.withCredentials,a.ajaxDataType=u.jsonp?"jsonp":"text",e(a).bind(g.onStart,function(t,n){"function"===e.type(s)&&s.call(a),p.resolve(a)}),r=function(n,o){var s=c._.error(i.noTransportOnInit);if(o=o||0,o>=n.length)return e(a).triggerHandler(g.onError,[s]),p.reject(s),void a.stop();if(a.state!==c.connectionState.disconnected){var u=n[o],d=c.transports[u],m=!1,h=function(){m||(m=!0,t.clearTimeout(a._.onFailedTimeoutHandle),d.stop(a),r(n,o+1))};a.transport=d;try{a._.onFailedTimeoutHandle=t.setTimeout(function(){a.log(d.name+" timed out when trying to connect."),h()},a.transportConnectTimeout),d.start(a,function(){var n=c._.firefoxMajorVersion(t.navigator.userAgent)>=11,o=!!a.withCredentials&&n;a.state!==c.connectionState.disconnected&&(m||(m=!0,t.clearTimeout(a._.onFailedTimeoutHandle),d.supportsKeepAlive&&a._.keepAliveData.activated&&c.transports._logic.monitorKeepAlive(a),c.transports._logic.startHeartbeat(a),_(a),f(a,c.connectionState.connecting,c.connectionState.connected),a._.connectingMessageBuffer.drain(),e(a).triggerHandler(g.onStart),l.bind("unload",function(){a.log("Window unloading, stopping the connection."),a.stop(o)}),n&&l.bind("beforeunload",function(){t.setTimeout(function(){a.stop(o)},0)})))},h)}catch(v){a.log(d.name+" transport threw '"+v.message+"' when attempting to start."),h()}}};var v=a.url+"/negotiate",C=function(t,n){var o=c._.error(i.errorOnNegotiate,t,n._.negotiateRequest);e(n).triggerHandler(g.onError,o),p.reject(o),n.stop()};return e(a).triggerHandler(g.onStarting),v=c.transports._logic.prepareQueryString(a,v),v=c.transports._logic.addQs(v,{clientProtocol:a.clientProtocol}),a.log("Negotiating with '"+v+"'."),a._.negotiateRequest=e.ajax(e.extend({},e.signalR.ajaxDefaults,{xhrFields:{withCredentials:a.withCredentials},url:v,type:"GET",contentType:a.contentType,data:{},dataType:a.ajaxDataType,error:function(e,t){t!==m?C(e,a):p.reject(c._.error(i.stoppedWhileNegotiating,null,a._.negotiateRequest))},success:function(t){var n,o,s,d=[],l=[];try{n=a._parseResponse(t)}catch(m){return void C(c._.error(i.errorParsingNegotiateResponse,m),a)}return o=a._.keepAliveData,a.appRelativeUrl=n.Url,a.id=n.ConnectionId,a.token=n.ConnectionToken,a.webSocketServerUrl=n.WebSocketServerUrl,a.disconnectTimeout=1e3*n.DisconnectTimeout,a.transportConnectTimeout=a.transportConnectTimeout+1e3*n.TransportConnectTimeout,n.KeepAliveTimeout?(o.activated=!0,o.timeout=1e3*n.KeepAliveTimeout,o.timeoutWarning=o.timeout*a.keepAliveWarnAt,a._.beatInterval=(o.timeout-o.timeoutWarning)/3):o.activated=!1,a.reconnectWindow=a.disconnectTimeout+(o.timeout||0),n.ProtocolVersion&&n.ProtocolVersion===a.clientProtocol?(e.each(c.transports,function(e){return 0===e.indexOf("_")||"webSockets"===e&&!n.TryWebSockets?!0:void l.push(e)}),e.isArray(u.transport)?e.each(u.transport,function(t,n){e.inArray(n,l)>=0&&d.push(n)}):"auto"===u.transport?d=l:e.inArray(u.transport,l)>=0&&d.push(u.transport),void r(d)):(s=c._.error(c._.format(i.protocolIncompatible,a.clientProtocol,n.ProtocolVersion)),e(a).triggerHandler(g.onError,[s]),void p.reject(s))}})),p.promise()},starting:function(t){var n=this;return e(n).bind(g.onStarting,function(e,o){t.call(n)}),n},send:function(e){var t=this;if(t.state===c.connectionState.disconnected)throw new Error("SignalR: Connection must be started before data can be sent. Call .start() before .send()");if(t.state===c.connectionState.connecting)throw new Error("SignalR: Connection has not been fully initialized. Use .start().done() or .start().fail() to run logic after the connection has started.");return t.transport.send(t,e),t},received:function(t){var n=this;return e(n).bind(g.onReceived,function(e,o){t.call(n,o)}),n},stateChanged:function(t){var n=this;return e(n).bind(g.onStateChanged,function(e,o){t.call(n,o)}),n},error:function(t){var n=this;return e(n).bind(g.onError,function(e,o,s){t.call(n,o,s)}),n},disconnected:function(t){var n=this;return e(n).bind(g.onDisconnect,function(e,o){t.call(n)}),n},connectionSlow:function(t){var n=this;return e(n).bind(g.onConnectionSlow,function(e,o){t.call(n)}),n},reconnecting:function(t){var n=this;return e(n).bind(g.onReconnecting,function(e,o){t.call(n)}),n},reconnected:function(t){var n=this;return e(n).bind(g.onReconnect,function(e,o){t.call(n)}),n},stop:function(n,o){var s=this,r=s._deferral;return s._.deferredStartHandler&&l.unbind("load",s._.deferredStartHandler),delete s._deferral,delete s._.config,delete s._.deferredStartHandler,d||s._.config&&s._.config.waitForPageLoad!==!0?s.state!==c.connectionState.disconnected?(s.log("Stopping connection."),f(s,s.state,c.connectionState.disconnected),t.clearTimeout(s._.beatHandle),t.clearTimeout(s._.onFailedTimeoutHandle),t.clearInterval(s._.pingIntervalId),s.transport&&(o!==!1&&s.transport.abort(s,n),s.transport.supportsKeepAlive&&s._.keepAliveData.activated&&c.transports._logic.stopMonitoringKeepAlive(s),s.transport.stop(s),s.transport=null),s._.negotiateRequest&&(s._.negotiateRequest.abort(m),delete s._.negotiateRequest),e(s).triggerHandler(g.onDisconnect),delete s.messageId,delete s.groupsToken,delete s.id,delete s._.pingIntervalId,delete s._.lastMessageAt,s._.connectingMessageBuffer.clear(),s):void 0:(s.log("Stopping connection prior to negotiate."),void(r&&r.reject(c._.error(i.stoppedWhileLoading))))},log:function(e){h(e,this.logging)}},c.fn.init.prototype=c.fn,c.noConflict=function(){return e.connection===c&&(e.connection=u),c},e.connection&&(u=e.connection),e.connection=e.signalR=c}(window.jQuery,window),function(e,t,n){"use strict";function o(e){e._.keepAliveData.monitoring&&s(e),i.markActive(e)&&(e._.beatHandle=t.setTimeout(function(){o(e)},e._.beatInterval))}function s(t){var n,o=t._.keepAliveData;t.state===c.connectionState.connected&&(n=(new Date).getTime()-t._.lastMessageAt,n>=o.timeout?(t.log("Keep alive timed out.  Notifying transport that connection has been lost."),t.transport.lostConnection(t)):n>=o.timeoutWarning?o.userNotified||(t.log("Keep alive has been missed, connection may be dead/slow."),e(t).triggerHandler(u.onConnectionSlow),o.userNotified=!0):o.userNotified=!1)}function r(e){return e.state===c.connectionState.connected||e.state===c.connectionState.reconnecting}function a(e,n){var o=-1!==e.indexOf("?")?"&":"?";return n&&(e+=o+"connectionData="+t.encodeURIComponent(n)),e}var i,c=e.signalR,u=e.signalR.events,d=e.signalR.changeState;c.transports={},i=c.transports._logic={pingServer:function(t){var n,o,s=e.Deferred();return t.transport?(n=t.url+"/ping",n=i.addQs(n,t.qs),o=e.ajax(e.extend({},e.signalR.ajaxDefaults,{xhrFields:{withCredentials:t.withCredentials},url:n,type:"GET",contentType:t.contentType,data:{},dataType:t.ajaxDataType,success:function(e){var n;try{n=t._parseResponse(e)}catch(r){return s.reject(c._.transportError(c.resources.pingServerFailedParse,t.transport,r,o)),void t.stop()}"pong"===n.Response?s.resolve():s.reject(c._.transportError(c._.format(c.resources.pingServerFailedInvalidResponse,e.responseText),t.transport,null,o))},error:function(e){401===e.status||403===e.status?(s.reject(c._.transportError(c._.format(c.resources.pingServerFailedStatusCode,e.status),t.transport,e,o)),t.stop()):s.reject(c._.transportError(c.resources.pingServerFailed,t.transport,e,o))}}))):s.reject(c._.transportError(c.resources.noConnectionTransport,t.transport)),s.promise()},prepareQueryString:function(e,t){return t=i.addQs(t,e.qs),a(t,e.data)},addQs:function(t,n){var o,s=-1!==t.indexOf("?")?"&":"?";if(!n)return t;if("object"==typeof n)return t+s+e.param(n);if("string"==typeof n)return o=n.charAt(0),"?"!==o&&"&"!==o||(s=""),t+s+n;throw new Error("Query string property must be either a string or object.")},getUrl:function(e,n,o,s){var r="webSockets"===n?"":e.baseUrl,a=r+e.appRelativeUrl,c="transport="+n+"&connectionToken="+t.encodeURIComponent(e.token);return e.groupsToken&&(c+="&groupsToken="+t.encodeURIComponent(e.groupsToken)),o?(a+=s?"/poll":"/reconnect",e.messageId&&(c+="&messageId="+t.encodeURIComponent(e.messageId))):a+="/connect",a+="?"+c,a=i.prepareQueryString(e,a),a+="&tid="+Math.floor(11*Math.random())},maximizePersistentResponse:function(e){return{MessageId:e.C,Messages:e.M,Initialized:"undefined"!=typeof e.S,Disconnect:"undefined"!=typeof e.D,ShouldReconnect:"undefined"!=typeof e.T,LongPollDelay:e.L,GroupsToken:e.G}},updateGroups:function(e,t){t&&(e.groupsToken=t)},stringifySend:function(e,t){return"string"==typeof t||"undefined"==typeof t||null===t?t:e.json.stringify(t)},ajaxSend:function(n,o){var s,r=i.stringifySend(n,o),a=n.url+"/send?transport="+n.transport.name+"&connectionToken="+t.encodeURIComponent(n.token),d=function(t,n){e(n).triggerHandler(u.onError,[c._.transportError(c.resources.sendFailed,n.transport,t,s),o])};return a=i.prepareQueryString(n,a),s=e.ajax(e.extend({},e.signalR.ajaxDefaults,{xhrFields:{withCredentials:n.withCredentials},url:a,type:"jsonp"===n.ajaxDataType?"GET":"POST",contentType:c._.defaultContentType,dataType:n.ajaxDataType,data:{data:r},success:function(e){var t;if(e){try{t=n._parseResponse(e)}catch(o){return d(o,n),void n.stop()}i.triggerReceived(n,t)}},error:function(e,t){"abort"!==t&&"parsererror"!==t&&d(e,n)}}))},ajaxAbort:function(n,o){if("undefined"!=typeof n.transport){o="undefined"==typeof o?!0:o;var s=n.url+"/abort?transport="+n.transport.name+"&connectionToken="+t.encodeURIComponent(n.token);s=i.prepareQueryString(n,s),e.ajax(e.extend({},e.signalR.ajaxDefaults,{xhrFields:{withCredentials:n.withCredentials},url:s,async:o,timeout:1e3,type:"POST",contentType:n.contentType,dataType:n.ajaxDataType,data:{}})),n.log("Fired ajax abort async = "+o+".")}},tryInitialize:function(e,t){e.Initialized&&t()},triggerReceived:function(t,n){t._.connectingMessageBuffer.tryBuffer(n)||e(t).triggerHandler(u.onReceived,[n])},processMessages:function(t,n,o){var s;if(i.markLastMessage(t),n){if(s=i.maximizePersistentResponse(n),s.Disconnect)return t.log("Disconnect command received from server."),void t.stop(!1,!1);i.updateGroups(t,s.GroupsToken),s.MessageId&&(t.messageId=s.MessageId),s.Messages&&(e.each(s.Messages,function(e,n){i.triggerReceived(t,n)}),i.tryInitialize(s,o))}},monitorKeepAlive:function(t){var n=t._.keepAliveData;n.monitoring?t.log("Tried to monitor keep alive but it's already being monitored."):(n.monitoring=!0,i.markLastMessage(t),t._.keepAliveData.reconnectKeepAliveUpdate=function(){i.markLastMessage(t)},e(t).bind(u.onReconnect,t._.keepAliveData.reconnectKeepAliveUpdate),t.log("Now monitoring keep alive with a warning timeout of "+n.timeoutWarning+" and a connection lost timeout of "+n.timeout+"."))},stopMonitoringKeepAlive:function(t){var n=t._.keepAliveData;n.monitoring&&(n.monitoring=!1,e(t).unbind(u.onReconnect,t._.keepAliveData.reconnectKeepAliveUpdate),t._.keepAliveData={},t.log("Stopping the monitoring of the keep alive."))},startHeartbeat:function(e){o(e)},markLastMessage:function(e){e._.lastMessageAt=(new Date).getTime()},markActive:function(e){return i.verifyLastActive(e)?(e._.lastActiveAt=(new Date).getTime(),!0):!1},ensureReconnectingState:function(t){return d(t,c.connectionState.connected,c.connectionState.reconnecting)===!0&&e(t).triggerHandler(u.onReconnecting),t.state===c.connectionState.reconnecting},clearReconnectTimeout:function(e){e&&e._.reconnectTimeout&&(t.clearTimeout(e._.reconnectTimeout),delete e._.reconnectTimeout)},verifyLastActive:function(e){return(new Date).getTime()-e._.lastActiveAt>=e.reconnectWindow?(e.log("There has not been an active server connection for an extended period of time. Stopping connection."),e.stop(),!1):!0},reconnect:function(e,n){var o=c.transports[n];if(r(e)&&!e._.reconnectTimeout){if(!i.verifyLastActive(e))return;e._.reconnectTimeout=t.setTimeout(function(){i.verifyLastActive(e)&&(o.stop(e),i.ensureReconnectingState(e)&&(e.log(n+" reconnecting."),o.start(e)))},e.reconnectDelay)}},handleParseFailure:function(t,n,o,s,r){t.state===c.connectionState.connecting?(t.log("Failed to parse server response while attempting to connect."),s()):(e(t).triggerHandler(u.onError,[c._.transportError(c._.format(c.resources.parseFailed,n),t.transport,o,r)]),t.stop())},foreverFrame:{count:0,connections:{}}}}(window.jQuery,window),function(e,t,n){"use strict";var o=e.signalR,s=e.signalR.events,r=e.signalR.changeState,a=o.transports._logic;o.transports.webSockets={name:"webSockets",supportsKeepAlive:!0,send:function(e,t){var n=a.stringifySend(e,t);e.socket.send(n)},start:function(n,i,c){var u,d=!1,l=this,m=!i,g=e(n);return t.WebSocket?void(n.socket||(u=n.webSocketServerUrl?n.webSocketServerUrl:n.wsProtocol+n.host,u+=a.getUrl(n,this.name,m),n.log("Connecting to websocket endpoint '"+u+"'."),n.socket=new t.WebSocket(u),n.socket.onopen=function(){d=!0,n.log("Websocket opened."),a.clearReconnectTimeout(n),r(n,o.connectionState.reconnecting,o.connectionState.connected)===!0&&g.triggerHandler(s.onReconnect)},n.socket.onclose=function(t){if(this===n.socket){if(!d)return void(c?c():m&&l.reconnect(n));"undefined"!=typeof t.wasClean&&t.wasClean===!1?(e(n).triggerHandler(s.onError,[o._.transportError(o.resources.webSocketClosed,n.transport,t)]),n.log("Unclean disconnect from websocket: "+t.reason||"[no reason given].")):n.log("Websocket closed."),l.reconnect(n)}},n.socket.onmessage=function(t){var o;try{o=n._parseResponse(t.data)}catch(s){return void a.handleParseFailure(n,t.data,s,c,t)}o&&(e.isEmptyObject(o)||o.M?a.processMessages(n,o,i):a.triggerReceived(n,o))})):void c()},reconnect:function(e){a.reconnect(e,this.name)},lostConnection:function(e){this.reconnect(e)},stop:function(e){a.clearReconnectTimeout(e),e.socket&&(e.log("Closing the Websocket."),e.socket.close(),e.socket=null)},abort:function(e,t){a.ajaxAbort(e,t)}}}(window.jQuery,window),function(e,t,n){"use strict";var o=e.signalR,s=e.signalR.events,r=e.signalR.changeState,a=o.transports._logic;o.transports.serverSentEvents={name:"serverSentEvents",supportsKeepAlive:!0,timeOut:3e3,start:function(n,i,c){var u,d,l=this,m=!1,g=e(n),p=!i;if(n.eventSource&&(n.log("The connection already has an event source. Stopping it."),n.stop()),!t.EventSource)return void(c&&(n.log("This browser doesn't support SSE."),c()));u=a.getUrl(n,this.name,p);try{n.log("Attempting to connect to SSE endpoint '"+u+"'."),n.eventSource=new t.EventSource(u)}catch(h){return n.log("EventSource failed trying to connect with error "+h.Message+"."),void(c?c():(g.triggerHandler(s.onError,[o._.transportError(o.resources.eventSourceFailedToConnect,n.transport,h)]),p&&l.reconnect(n)))}p&&(d=t.setTimeout(function(){m===!1&&n.eventSource.readyState!==t.EventSource.OPEN&&l.reconnect(n)},l.timeOut)),n.eventSource.addEventListener("open",function(e){n.log("EventSource connected."),d&&t.clearTimeout(d),a.clearReconnectTimeout(n),m===!1&&(m=!0,r(n,o.connectionState.reconnecting,o.connectionState.connected)===!0&&g.triggerHandler(s.onReconnect))},!1),n.eventSource.addEventListener("message",function(e){var t;if("initialized"!==e.data){try{t=n._parseResponse(e.data)}catch(o){return void a.handleParseFailure(n,e.data,o,c,e)}a.processMessages(n,t,i)}},!1),n.eventSource.addEventListener("error",function(e){if(this===n.eventSource){if(!m)return void(c&&c());n.log("EventSource readyState: "+n.eventSource.readyState+"."),e.eventPhase===t.EventSource.CLOSED?(n.log("EventSource reconnecting due to the server connection ending."),l.reconnect(n)):(n.log("EventSource error."),g.triggerHandler(s.onError,[o._.transportError(o.resources.eventSourceError,n.transport,e)]))}},!1)},reconnect:function(e){a.reconnect(e,this.name)},lostConnection:function(e){this.reconnect(e)},send:function(e,t){a.ajaxSend(e,t)},stop:function(e){a.clearReconnectTimeout(e),e&&e.eventSource&&(e.log("EventSource calling close()."),e.eventSource.close(),e.eventSource=null,delete e.eventSource)},abort:function(e,t){a.ajaxAbort(e,t)}}}(window.jQuery,window),function(e,t,n){"use strict";var o=e.signalR,s=e.signalR.events,r=e.signalR.changeState,a=o.transports._logic,i=function(){var e=t.document.createElement("iframe");return e.setAttribute("style","position:absolute;top:0;left:0;width:0;height:0;visibility:hidden;"),e},c=function(){var e=null,n=1e3,s=0;return{prevent:function(){o._.ieVersion<=8&&(0===s&&(e=t.setInterval(function(){var e=i();t.document.body.appendChild(e),t.document.body.removeChild(e),e=null},n)),s++)},cancel:function(){1===s&&t.clearInterval(e),s>0&&s--}}}();o.transports.foreverFrame={name:"foreverFrame",supportsKeepAlive:!0,iframeClearThreshold:50,start:function(e,n,o){var s,r=this,u=a.foreverFrame.count+=1,d=i(),l=function(){e.log("Forever frame iframe finished loading and is no longer receiving messages, reconnecting."),r.reconnect(e)};return t.EventSource?void(o&&(e.log("This browser supports SSE, skipping Forever Frame."),o())):(d.setAttribute("data-signalr-connection-id",e.id),c.prevent(),s=a.getUrl(e,this.name),s+="&frameId="+u,t.document.body.appendChild(d),e.log("Binding to iframe's load event."),d.addEventListener?d.addEventListener("load",l,!1):d.attachEvent&&d.attachEvent("onload",l),d.src=s,a.foreverFrame.connections[u]=e,e.frame=d,e.frameId=u,void(n&&(e.onSuccess=function(){e.log("Iframe transport started."),n()})))},reconnect:function(e){var n=this;a.verifyLastActive(e)&&t.setTimeout(function(){if(a.verifyLastActive(e)&&e.frame&&a.ensureReconnectingState(e)){var t=e.frame,o=a.getUrl(e,n.name,!0)+"&frameId="+e.frameId;e.log("Updating iframe src to '"+o+"'."),t.src=o}},e.reconnectDelay)},lostConnection:function(e){this.reconnect(e)},send:function(e,t){a.ajaxSend(e,t)},receive:function(t,n){var s,r;if(a.processMessages(t,n,t.onSuccess),t.state===e.signalR.connectionState.connected&&(t.frameMessageCount=(t.frameMessageCount||0)+1,t.frameMessageCount>o.transports.foreverFrame.iframeClearThreshold&&(t.frameMessageCount=0,s=t.frame.contentWindow||t.frame.contentDocument,s&&s.document&&s.document.body)))for(r=s.document.body;r.firstChild;)r.removeChild(r.firstChild)},stop:function(e){var n=null;if(c.cancel(),e.frame){if(e.frame.stop)e.frame.stop();else try{n=e.frame.contentWindow||e.frame.contentDocument,n.document&&n.document.execCommand&&n.document.execCommand("Stop")}catch(o){e.log("Error occured when stopping foreverFrame transport. Message = "+o.message+".")}e.frame.parentNode===t.document.body&&t.document.body.removeChild(e.frame),delete a.foreverFrame.connections[e.frameId],e.frame=null,e.frameId=null,delete e.frame,delete e.frameId,delete e.onSuccess,delete e.frameMessageCount,e.log("Stopping forever frame.")}},abort:function(e,t){a.ajaxAbort(e,t)},getConnection:function(e){return a.foreverFrame.connections[e]},started:function(t){r(t,o.connectionState.reconnecting,o.connectionState.connected)===!0&&e(t).triggerHandler(s.onReconnect)}}}(window.jQuery,window),function(e,t,n){"use strict";var o=e.signalR,s=e.signalR.events,r=e.signalR.changeState,a=e.signalR.isDisconnecting,i=o.transports._logic;o.transports.longPolling={name:"longPolling",supportsKeepAlive:!1,reconnectDelay:3e3,start:function(n,c,u){var d=this,l=function(){l=e.noop,n.log("LongPolling connected."),c(),u=null},m=function(){return u?(u(),u=null,n.log("LongPolling failed to connect."),!0):!1},g=n._,p=0,h=function(n){t.clearTimeout(g.reconnectTimeoutId),g.reconnectTimeoutId=null,r(n,o.connectionState.reconnecting,o.connectionState.connected)===!0&&(n.log("Raising the reconnect event"),e(n).triggerHandler(s.onReconnect))},f=36e5;n.pollXhr&&(n.log("Polling xhr requests already exists, aborting."),n.stop()),n.messageId=null,g.reconnectTimeoutId=null,g.pollTimeoutId=t.setTimeout(function(){!function r(c,u){var v=c.messageId,_=null===v,T=!_,C=!u,w=i.getUrl(c,d.name,T,C);a(c)!==!0&&(n.log("Opening long polling request to '"+w+"'."),c.pollXhr=e.ajax(e.extend({},e.signalR.ajaxDefaults,{xhrFields:{withCredentials:n.withCredentials},url:w,type:"GET",dataType:n.ajaxDataType,contentType:n.contentType,success:function(o){var s,u,d,f=0;n.log("Long poll complete."),p=0;try{s=n._parseResponse(o)}catch(v){return void i.handleParseFailure(c,o,v,m,c.pollXhr)}null!==g.reconnectTimeoutId&&h(c),s&&(u=i.maximizePersistentResponse(s)),i.processMessages(c,s,l),u&&"number"===e.type(u.LongPollDelay)&&(f=u.LongPollDelay),u&&u.Disconnect||a(c)!==!0&&(d=u&&u.ShouldReconnect,d&&!i.ensureReconnectingState(c)||(f>0?g.pollTimeoutId=t.setTimeout(function(){r(c,d)},f):r(c,d)))},error:function(a,u){if(t.clearTimeout(g.reconnectTimeoutId),g.reconnectTimeoutId=null,"abort"===u)return void n.log("Aborted xhr request.");if(!m()){if(p++,n.state!==o.connectionState.reconnecting&&(n.log("An error occurred using longPolling. Status = "+u+".  Response = "+a.responseText+"."),e(c).triggerHandler(s.onError,[o._.transportError(o.resources.longPollFailed,n.transport,a,c.pollXhr)])),(n.state===o.connectionState.connected||n.state===o.connectionState.reconnecting)&&!i.verifyLastActive(n))return;if(!i.ensureReconnectingState(c))return;g.pollTimeoutId=t.setTimeout(function(){r(c,!0)},d.reconnectDelay)}}})),T&&u===!0&&(g.reconnectTimeoutId=t.setTimeout(function(){h(c)},Math.min(1e3*(Math.pow(2,p)-1),f))))}(n)},250)},lostConnection:function(e){throw new Error("Lost Connection not handled for LongPolling")},send:function(e,t){i.ajaxSend(e,t)},stop:function(e){t.clearTimeout(e._.pollTimeoutId),t.clearTimeout(e._.reconnectTimeoutId),delete e._.pollTimeoutId,delete e._.reconnectTimeoutId,e.pollXhr&&(e.pollXhr.abort(),e.pollXhr=null,delete e.pollXhr)},abort:function(e,t){i.ajaxAbort(e,t)}}}(window.jQuery,window),function(e,t,n){"use strict";function o(e){return e+d}function s(e,t,n){var o,s=e.length,r=[];for(o=0;s>o;o+=1)e.hasOwnProperty(o)&&(r[o]=t.call(n,e[o],o,e));return r}function r(t){return e.isFunction(t)?null:"undefined"===e.type(t)?null:t}function a(e){for(var t in e)if(e.hasOwnProperty(t))return!0;return!1}function i(e,t){var n,o=e._.invocationCallbacks;a(o)&&e.log("Clearing hub invocation callbacks with error: "+t+"."),e._.invocationCallbackId=0,delete e._.invocationCallbacks,e._.invocationCallbacks={};for(var s in o)n=o[s],n.method.call(n.scope,{E:t})}function c(e,t){return new c.fn.init(e,t)}function u(t,n){var o={qs:null,logging:!1,useDefaultPath:!0};return e.extend(o,n),t&&!o.useDefaultPath||(t=(t||"")+"/signalr"),new u.fn.init(t,o)}var d=".hubProxy",l=e.signalR;c.fn=c.prototype={init:function(e,t){this.state={},this.connection=e,this.hubName=t,this._={callbackMap:{}}},hasSubscriptions:function(){return a(this._.callbackMap)},on:function(t,n){var s=this,r=s._.callbackMap;return t=t.toLowerCase(),r[t]||(r[t]={}),r[t][n]=function(e,t){n.apply(s,t)},e(s).bind(o(t),r[t][n]),s},off:function(t,n){var s,r=this,i=r._.callbackMap;return t=t.toLowerCase(),s=i[t],s&&(s[n]?(e(r).unbind(o(t),s[n]),delete s[n],a(s)||delete i[t]):n||(e(r).unbind(o(t)),delete i[t])),r},invoke:function(t){var n=this,o=n.connection,a=e.makeArray(arguments).slice(1),i=s(a,r),c={H:n.hubName,M:t,A:i,I:o._.invocationCallbackId},u=e.Deferred(),d=function(t){var s,r,a=n._maximizeHubResponse(t);e.extend(n.state,a.State),a.Error?(a.StackTrace&&o.log(a.Error+"\n"+a.StackTrace+"."),s=a.IsHubException?"HubException":"Exception",r=l._.error(a.Error,s),r.data=a.ErrorData,u.rejectWith(n,[r])):u.resolveWith(n,[a.Result])};return o._.invocationCallbacks[o._.invocationCallbackId.toString()]={scope:n,method:d},o._.invocationCallbackId+=1,e.isEmptyObject(n.state)||(c.S=n.state),o.send(c),u.promise()},_maximizeHubResponse:function(e){return{State:e.S,Result:e.R,Id:e.I,IsHubException:e.H,Error:e.E,StackTrace:e.T,ErrorData:e.D}}},c.fn.init.prototype=c.fn,u.fn=u.prototype=e.connection(),u.fn.init=function(t,n){var s={qs:null,logging:!1,useDefaultPath:!0},r=this;e.extend(s,n),e.signalR.fn.init.call(r,t,s.qs,s.logging),r.proxies={},r._.invocationCallbackId=0,r._.invocationCallbacks={},r.received(function(t){var n,s,a,i,c,u;t&&("undefined"!=typeof t.I?(a=t.I.toString(),i=r._.invocationCallbacks[a],i&&(r._.invocationCallbacks[a]=null,delete r._.invocationCallbacks[a],i.method.call(i.scope,t))):(n=this._maximizeClientHubInvocation(t),r.log("Triggering client hub event '"+n.Method+"' on hub '"+n.Hub+"'."),c=n.Hub.toLowerCase(),u=n.Method.toLowerCase(),s=this.proxies[c],e.extend(s.state,n.State),e(s).triggerHandler(o(u),[n.Args])))}),r.error(function(e,t){var n,o;r.transport&&"webSockets"===r.transport.name||t&&(n=t.I,o=r._.invocationCallbacks[n],o&&(r._.invocationCallbacks[n]=null,delete r._.invocationCallbacks[n],o.method.call(o.scope,{E:e})))}),r.reconnecting(function(){r.transport&&"webSockets"===r.transport.name&&i(r,"Connection started reconnecting before invocation result was received.")}),r.disconnected(function(){i(r,"Connection was disconnected before invocation result was received.")})},u.fn._maximizeClientHubInvocation=function(e){
return{Hub:e.H,Method:e.M,Args:e.A,State:e.S}},u.fn._registerSubscribedHubs=function(){var t=this;t._subscribedToHubs||(t._subscribedToHubs=!0,t.starting(function(){var n=[];e.each(t.proxies,function(e){this.hasSubscriptions()&&(n.push({name:e}),t.log("Client subscribed to hub '"+e+"'."))}),0===n.length&&t.log("No hubs have been subscribed to.  The client will not receive data from hubs.  To fix, declare at least one client side function prior to connection start for each hub you wish to subscribe to."),t.data=t.json.stringify(n)}))},u.fn.createHubProxy=function(e){e=e.toLowerCase();var t=this.proxies[e];return t||(t=c(this,e),this.proxies[e]=t),this._registerSubscribedHubs(),t},u.fn.init.prototype=u.fn,e.hubConnection=u}(window.jQuery,window),function(e,t){e.signalR.version="2.0.1-pre"}(window.jQuery)}),define("controlpathpart",["jbase","basecontrol"],function(){!function(){var e="attr",t="index",n="itemIndex",o="member",s="elementId";defineClass("JBase.UI.ControlPathPart",function(t){if(this.pathPart=t,this._automationType,this._descriptors=[],t){_pathPart=t;var n=t.indexOf("[");if(-1===n)this._automationType=t;else{this._automationType=t.substr(0,n);for(var o=t.substr(n+1,t.length-2-n),s=o.split(","),r=0;r<s.length;r++){var a=s[r],i=a.split("="),c=e,u=i[0],d=i[1];if(-1!==u.indexOf(":")){var l=u.split(":");c=l[0],u=l[1]}this._descriptors.push({type:c,name:u,value:d})}}}},{_pathPart:null,_automationType:"",_instructions:[],toString:function(){return this._pathPart||(this._pathPart=this._generatePathPartString()),this._pathPart},findRootControl:function(e){e=e||document.body;var t,n=!e||!e.control||this._automationType&&this._automationType!==e.control.automationType?null:e.control;for(t=0;!n&&t<e.childNodes.length;t++){var o=e.childNodes[t];n=!o.control||this._automationType&&this._automationType!==o.control.automationType?null:o.control}if(!n)for(t=0;!n&&t<e.childNodes.length;t++)n=this.findRootControl(e.childNodes[t]);return n},findChild:function(e){var n,r=[];if(e){if(e.children){var a=e.children;if(this._descriptors.length>=1){var i=this._descriptors[0];switch(i.type){case t:var c=Number(i.name);a=[a[c]];break;case o:a=[e[i.name]];break;case s:a=[byId(i.name)]}}for(var u=0;u<a.length;u++){n=a[u];for(var d=n&&(!this._automationType||n.automationType===this._automationType),l=0;d&&l<this._descriptors.length;l++){var m=this._descriptors[l];this.isMatch(n,m)||(d=!1)}d&&r.push(n)}}}else{var g=this.findRootControl();g&&r.push(g)}if(r.length>1)throw'Path part "'+this.toString()+'" resolved to '+r.length+" controls.";return 1===r.length?r[0]:null},isMatch:function(s,r){var a=!0;switch(r.type){case e:var i=r.name?r.name.split("."):[],c=s;a=i.length>0;for(var u=0;a&&u<i.length;u++){var d=i[u];u<i.length-1?(c=c[d],a=!!c):a=c[d]===r.value}break;case t:var l=Number(r.name);a=s===s.parent.children[l];break;case o:a=s.parent&&s.parent[r.name]===s;break;case n:var m=Number(r.name),g=s.parent,p=g&&g.dataContext&&g.dataContext.itemSet?g.dataContext.itemSet:null;p&&s.dataContext&&p.getCount()>m&&(a=s.dataContext.item===p.peek(m));break;default:a=!1}return a},_generatePathPartString:function(){var t=this._automationType;if(this._descriptors&&this._descriptors.length){t+="[";for(var n=0;n<this._descriptors.length;n++){n>0&&(t+=",");var o=this._descriptors[n];o.type!==e&&(t+=o.type+":"),o.name&&(t+=o.name),o.value&&(t+="="+o.value)}t+="]"}return t}})}()}),define("controlpath",["controlpathpart"],function(){!function(){function e(e){var t,n=e.parent;if(n)for(var o in n)if(e===n[o]){t=o;break}return t}function t(e){var t=-1,n=e.parent,o=n&&n.dataContext?n.dataContext.itemSet:null,s=e.dataContext?e.dataContext.item:null;return o&&s&&(t=o.peekIndexOf(s)),t}function n(e){var t=-1,n=e.parent;if(n)for(var o=0;o<n.children.length;o++)if(n.children[o]===e){t=o;break}return t}defineClass("JBase.UI.ControlPath",function(e){if(this._pathParts=[],e)for(var t=e.split("/"),n=0;n<t.length;n++){var o=t[n];o&&this._pathParts.push(new JBase.UI.ControlPathPart(o))}},{findControl:function(){for(var e,t="",n="",o=0;o<this._pathParts.length;o++){var s=this._pathParts[o];try{e=this._pathParts[o].findChild(e)}catch(r){e=null,n=r}if(!e){for(var a="",i=o;i<this._pathParts.length;i++)a+=this._pathParts[i].toString()+"/";throw"Unable to resolve controlPath: "+n+"\n\nResolved path:\n"+t+"\n\nRemaining unresolved path:\n"+a}t+=s.toString()+"/"}return e},toString:function(){for(var e="",t=0;t<this._pathParts.length;t++)e+=this._pathParts[t].toString()+"/";return e}},{fromServerPathParts:function(e){for(var t=new JBase.UI.ControlPath,n=0;n<e.length;n++){var o=e[n],s=new JBase.UI.ControlPathPart;switch(s._automationType=o.controlType,o.type){case"getElementById":s._descriptors.push({type:"elementId",name:o.value});break;case"member":s._descriptors.push({type:"member",name:o.value});break;case"index":s._descriptors.push({type:"index",name:Number(o.value)});break;case"property":s._descriptors.push({type:"attr",name:o.value.name,value:o.value.value});break;case"itemIndex":s._descriptors.push({type:"itemIndex",name:Number(o.value)})}t._pathParts.push(s)}return t},findControl:function(e){var t=new JBase.UI.ControlPath(e);return t.findControl()},getPath:function(o){for(var s="",r=!0;o;){if(o.automationType){var a=o.automationType;if(o.automationId)a+="[automationId="+o.automationId+"]";else{var i=t(o);if(i>=0)a+="[itemIndex:"+i+"]";else{var c=e(o);if(c)a+="[member:"+c+"]";else{var u=n(o);u>=0&&(a+="[index:"+u+"]")}}}s="/"+a+s}r&&(s||(s="/[className=c-"+o.__className,o.automationId&&(s+=",id="+o.automationId),s+="]"),r=!1),o=o.parent}return s}})}()}),define("messagejsenumcreator",["jquery.signalr","basecontrol","controlpath","lightobject","lightstring","cookie","jquery-1.7.2"],function(){window.TestCommunicationDefaultTestManager="",window.TestCommunicationChunkSize=2048,window.TestCommunicationChunkSendTimeout=3e4,window.TestCommunicationMaxConcurrentChunks=10,window.TestCommunicationBaseUrl="wingman.live-int.com",window.TestCommunicationManagedBrowserIdPrefix="ManagedBrowser-",window.TestCommunicationScreenshotLogPrefix="Screenshot: ",window.TestCommunicationMessageTypes={Send:"Send",Broadcast:"Broadcast",RegisterGroup:"RegisterGroup",UnRegisterGroup:"UnRegisterGroup",Ping:"Ping"},window.TestCommunicationForwardedMessageTypes={TestCommunicationServer_RegisterGroup:"TestCommunicationServer_RegisterGroup",TestCommunicationServer_RegisterGroupAck:"TestCommunicationServer_RegisterGroupAck",TestCommunicationServer_UnRegisterGroup:"TestCommunicationServer_UnRegisterGroup",TestCommunicationServer_UnRegisterGroupAck:"TestCommunicationServer_UnRegisterGroupAck",BrowserPool_Available:"BrowserPool_Available",BrowserPool_AvailableResponse:"BrowserPool_AvailableResponse",BrowserPool_Checkin:"BrowserPool_Checkin",BrowserPool_CheckinResponse:"BrowserPool_CheckinResponse",BrowserPool_Checkout:"BrowserPool_Checkout",BrowserPool_CheckoutResponse:"BrowserPool_CheckoutResponse",BrowserPool_RegisterBrowser:"BrowserPool_RegisterBrowser",BrowserPool_RegisterBrowserResponse:"BrowserPool_RegisterBrowserResponse",BrowserPool_RegisteredBrowserClientGuid:"BrowserPool_RegisteredBrowserClientGuid",BrowserPool_UnRegisterBrowser:"BrowserPool_UnRegisterBrowser",BrowserPool_UnRegisteredBrowserAck:"BrowserPool_UnRegisteredBrowserAck",BrowserPool_UpdateHeartbeat:"BrowserPool_UpdateHeartbeat",BrowserPool_BrowserDoesNotExist:"BrowserPool_BrowserDoesNotExist",BrowserPool_SetMachineExpiration:"BrowserPool_SetMachineExpiration",TestManager_TestsChanged:"TestManager_TestsChanged",TestManager_GetTestList:"TestManager_GetTestList",TestManager_GetTestListResponse:"TestManager_GetTestListResponse",TestManager_RunTests:"TestManager_RunTests",TestManager_CancelRun:"TestManager_CancelRun",TestManager_TestsStopped:"TestManager_TestsStopped",TestManager_RunDataMessage:"TestManager_RunDataMessage",TestManager_RunLocationMessage:"TestManager_RunLocationMessage",TestRunner_Command:"TestRunner_Command",TestRunner_SendResults:"TestRunner_SendResults",TestRunner_ErrorMessage:"TestRunner_ErrorMessage",TestListener_LogMessage:"TestListener_LogMessage",RemoteTestMode_TestStartMessage:"RemoteTestMode_TestStartMessage",RemoteTestMode_TestEndMessage:"RemoteTestMode_TestEndMessage",LiveUnit_GetTestFromLiveUnit:"LiveUnit_GetTestFromLiveUnit",LiveUnit_GetTestFromLiveUnitResponse:"LiveUnit_GetTestFromLiveUnitResponse",LiveUnit_RunLiveUnitTests:"LiveUnit_RunLiveUnitTests",LiveUnit_RunLiveUnitTestsResponse:"LiveUnit_RunLiveUnitTestsResponse",PingMessage:"PingMessage",PingResponseMessage:"PingResponseMessage",ChunkMessage:"ChunkMessage",ChunkResponseMessage:"ChunkResponseMessage",CompressedMessage:"CompressedMessage",BrowserManager_TakeScreenshot:"BrowserManager_TakeScreenshot",BrowserManager_TakeScreenshotResponse:"BrowserManager_TakeScreenshotResponse",BrowserManager_SaveFiddlerTrace:"BrowserManager_SaveFiddlerTrace",BrowserManager_SaveFiddlerTraceResponse:"BrowserManager_SaveFiddlerTraceResponse"},window.TestModeResults={Invalid:"Invalid",Pass:"Pass",Fail:"Fail",Block:"Block",Skip:"Skip",Warning:"Warning",Retry:"Retry"}}),define("testconnection",["messagejsenumcreator"],function(){!function(){var e="TestConnection",t="https://"+window.TestCommunicationBaseUrl+"/default.aspx",n=5e3,o={transport:"auto",withCredentials:!1},s=3e4,r=1e4,a=100;defineClass("JBase.TestRunner.TestConnection",function(){this._groups={},this._chunkedRequests={},this._chunks=[],this._handledResourceIdsHashSet={},this._handledResourceIdsQueue=[],this._sendAndWaitOnResponseCallbacks=[]},{isConnected:!1,_connection:null,_isFirstConnect:!0,_chunksBeingSent:0,_setIntervalHandler:null,_disposed:!1,_loadedOnce:!1,_fallbackToIframe:!1,_$iFrame:null,start:function(){var e=window.jQuery.connection("https://"+window.TestCommunicationBaseUrl+"/service");this.setConnection(e)},setConnection:function(t){this._connection=t,this._connection.logging=!0,this._connection.received(bind(this,this._onReceivedData)),this._connection.reconnecting(bind(this,this._onReconnecting)),this._connection.reconnected(bind(this,this._onReconnected)),this._connection.disconnected(bind(this,this._onDisconnected)),this._connection.error(bind(this,this._onError));var s=this;this._setIntervalHandler=setInterval(function(){s._disposed||s.garbageCollect()},15e3),this._connection.start(o,function(){if("1"==s._connection.state)if(s._loadedOnce=!0,s.isConnected=!0,s._isFirstConnect)s._isFirstConnect=!1,Trace.log("Connected to test comm server - "+s._connection.id+" ("+s._getTransportName()+")",e),raiseEvent(s,"connected",{});else{Trace.log("Reconnected from test comm server after disconnect - "+s._connection.id,e);for(var t in s._groups)s.registerGroup(t);raiseEvent(this,"reconnected",{})}else"4"==s._connection.state&&setTimeout(function(){s._disposed||s._restartConnection()},Math.round(n+Math.random()*n)),s.isConnected=!1})},send:function(e,t,n,o){this._sendMessage(TestCommunicationMessageTypes.Send,e,t,n,o,!0)},sendAndWaitOnResponse:function(e,t,n,o,s){this._sendAndWaitOnResponse(TestCommunicationMessageTypes.Send,e,t,n,o,!0,s)},sendResponse:function(e,t,n){this._sendMessage(TestCommunicationMessageTypes.Send,e.sId,t,n,e.rId,!0)},broadcast:function(e,t,n,o){this._sendMessage(TestCommunicationMessageTypes.Broadcast,e,t,n,o,!0)},broadcastResponse:function(e,t,n,o){this._sendMessage(TestCommunicationMessageTypes.Broadcast,t,n,o,e.rId,!0)},broadcastAndWaitOnResponse:function(e,t,n,o,s){this._sendAndWaitOnResponse(TestCommunicationMessageTypes.Broadcast,e,t,n,o,!1,s)},registerGroup:function(e){var t=this;this._sendAndWaitOnResponse(TestCommunicationMessageTypes.RegisterGroup,"e",TestCommunicationForwardedMessageTypes.TestCommunicationServer_RegisterGroup,{groupName:e},function(){return t._groups[e]=!0,!0},!1)},unregisterGroup:function(e){var t=this;this._sendAndWaitOnResponse(TestCommunicationMessageTypes.UnRegisterGroup,"e",TestCommunicationForwardedMessageTypes.TestCommunicationServer_UnRegisterGroup,{groupName:e},function(){return delete t._groups[e],!0},!1)},garbageCollect:function(){var e=(new Date).getTime();for(var t in this._chunkedRequests){var n=this._chunkedRequests[t];e-n.lastWrite>6e4&&delete this._chunkedRequests[t]}},dispose:function(){this._disposed||(this._disposed=!0,clearInterval(this._setIntervalHandler),this._connection&&this._connection.stop(),this.garbageCollect(),this._$iFrame&&this._$iFrame.remove())},_getRequestGuid:function(){return"BrowserClient_"+Math.random()},_getTransportName:function(){return this._connection&&this._connection.transport?this._connection.transport.name:"No Transport"},_getChunkMessageSize:function(){var e=window.TestCommunicationChunkSize;return"jsonp"==this._connection.ajaxDataType&&(e=256),e},_sendMessage:function(e,t,n,o,s,a){s=s||this._getRequestGuid();var i=this,c=Object.toJSON({t:e,dId:t,d:{t:n,d:o,rId:s}}),u=this._getChunkMessageSize();a&&c.length>u?e==TestCommunicationMessageTypes.Broadcast?this._sendAndWaitOnResponse(TestCommunicationMessageTypes.Broadcast,t,TestCommunicationForwardedMessageTypes.PingMessage,{},function(e){return e&&i._chunkMessage(e.sId,c,n),!0},!1,r):this._chunkMessage(t,c,n):this._connection.send(c)},_sendAndWaitOnResponse:function(e,t,n,o,r,a,i){function c(e){var t=(new Date).getTime()-l>i;if(t||e.rId==d){var n,o=!1;try{o=r(t?null:e,t)}catch(s){o=!0,n=s}if(o||t){for(var a=0;a<u._sendAndWaitOnResponseCallbacks.length;a++)if(u._sendAndWaitOnResponseCallbacks[a]==c){u._sendAndWaitOnResponseCallbacks.splice(a,1);break}m&&clearTimeout(m)}if(n)throw n}}var u=this,d=this._getRequestGuid();i=i||s;var l=(new Date).getTime();this._sendAndWaitOnResponseCallbacks.push(c),this._sendMessage(e,t,n,o,d,a);var m;m=setTimeout(c,i+100)},_chunkMessage:function(e,t,n){for(var o=this._getChunkMessageSize(),s=Math.ceil(t.length/o),r=0,a=this._getRequestGuid(),i=0;i<t.length;i+=o){var c=Math.min(i+o,t.length);this._enqueueChunk(e,t.substring(i,c),a,r++,s,n)}},_enqueueChunk:function(e,t,n,o,s,r){this._chunks.push({destinationId:e,messageChunk:t,requestId:n,sequence:o,totalCount:s,dataType:r}),this._startSendingChunks()},_startSendingChunks:function(){for(;this._chunks.length&&this._chunksBeingSent<window.TestCommunicationMaxConcurrentChunks;)this._sendFirstChunk()},_sendFirstChunk:function(){var e=this,t=this._chunks[0];this._chunks.splice(0,1),e._chunksBeingSent++,this._sendAndWaitOnResponse(TestCommunicationMessageTypes.Send,t.destinationId,TestCommunicationForwardedMessageTypes.ChunkMessage,{c:t.messageChunk,s:t.sequence,cRid:t.requestId,t:t.totalCount},function(){return e._chunksBeingSent--,e._startSendingChunks(),raiseEvent(e,"sentChunk",{sequence:t.sequence,totalCount:t.totalCount,chunkMessageType:t.dataType}),!0},!1,window.TestCommunicationChunkSendTimeout)},_restartConnection:function(){this._connection&&(Trace.log("Restarting the connection",e),this._connection.start(o))},_onError:function(t){if(!this._loadedOnce&&!this._fallbackToIframe&&(Trace.log("Falling back to iframe",e),this._fallbackToIframe=!0,this._connection)){var n=this._connection;this._connection=null,n.stop(),this._loadIFrame()}var o="No error defined";"string"==typeof t?o=t:t&&t.stack?o=t.message+" - "+t.stack:t&&t.responseText&&(o=t.responseText),Trace.log("Error in connection - "+o,e)},_onDisconnected:function(){if(this._connection){Trace.log("Disconnected from test comm server",e),this.isConnected=!1;var t=this;setTimeout(function(){t._disposed||t._restartConnection()},Math.round(n+Math.random()*n))}},_onReconnecting:function(){this._connection&&(Trace.log("Reconnecting to test comm server",e),this.isConnected=!1)},_onReconnected:function(){if(this._connection){Trace.log("Reconnected to test comm server",e);for(var t in this._groups)this.registerGroup(t);this.isConnected=!0,raiseEvent(this,"reconnected",{})}},_onReceivedData:function(t){if(this._connection){var n=!0;if(t&&this._haveNotHandledRequestId(t.rId)){switch(t.t){case TestCommunicationForwardedMessageTypes.PingMessage:this.sendResponse(t,TestCommunicationForwardedMessageTypes.PingResponseMessage,{});break;case TestCommunicationForwardedMessageTypes.TestCommunicationServer_RegisterGroupAck:Trace.log("Registered to group - "+t.d.groupName,e);break;case TestCommunicationForwardedMessageTypes.TestCommunicationServer_UnRegisterGroupAck:Trace.log("UnRegistered to group - "+t.d.groupName,e);break;case TestCommunicationForwardedMessageTypes.ChunkMessage:n=!1,this._processChunk(t);break;case TestCommunicationForwardedMessageTypes.CompressedMessage:n=!1,this._processCompressedMessage(t)}if(n){for(var o=0;o<this._sendAndWaitOnResponseCallbacks.length;o++)try{this._sendAndWaitOnResponseCallbacks[o](t)}catch(s){Trace.log("Error in SendAndWaitOnResponse callback - "+s.message+" - "+s.stack,e)}raiseEvent(this,"receiveddata",t)}}}},_haveNotHandledRequestId:function(e){var t=!0;if(e)if(this._handledResourceIdsHashSet[e])t=!1;else if(this._handledResourceIdsHashSet[e]=1,this._handledResourceIdsQueue.push(e),this._handledResourceIdsQueue.length>a){var n=this._handledResourceIdsQueue[0];this._handledResourceIdsQueue.splice(0,1),delete this._handledResourceIdsHashSet[n]}return t},_processCompressedMessage:function(e){var t=Object.fromJSON(this._decompressMessage(e.d.compressedMessage));raiseEvent(this,"receiveddata",t)},_processChunk:function(e){var t=this._chunkedRequests,n=e.d,o=t[n.cRid];if(o||(t[n.cRid]=o={recievedCount:0,data:{}}),o.data[n.s]||(o.recievedCount++,o.totalCount=n.t,o.data[n.s]=n.c),o.lastWrite=(new Date).getTime(),this.sendResponse(e,TestCommunicationForwardedMessageTypes.ChunkResponseMessage,{}),raiseEvent(this,"recievedChunk",{recievedCount:o.recievedCount,totalCount:o.totalCount,chunkMessageType:n.cmt}),o.totalCount==o.recievedCount){for(var s="",r=0;r<o.totalCount;r++)s+=o.data[r];delete t[n.cRid];var a=Object.fromJSON(s);a.d.sId=e.sId,this._onReceivedData(a.d)}},_decompressMessage:function(e){for(var t,n,o=[],s="",r=256,a=0;256>a;a+=1)o[a]=String.fromCharCode(a);var i=String.fromCharCode(e[0]);for(t=i,a=1;a<e.length;a+=1){if(n=e[a],o[n])s=o[n];else{if(n!==r)return null;s=i+i.charAt(0)}t+=s,o[r++]=i+s.charAt(0),i=s}return t},_loadIFrame:function(){var e=this;this._$iFrame=jQuery('<iframe src="'+t+'"></iframe>'),this._$iFrame.hide(),jQuery(function(){document.domain.endsWith(".live-tst.com")?document.domain="live-tst.com":document.domain="live-int.com",jQuery(document.body).append(e._$iFrame)})}},null,Shared.ObjectEventing)}()}),define("testchannelmanager",["testconnection"],function(){!function(){var e="TestChannelManager",t="wingcg",n=3e5,o=50,s=100;defineClass("JBase.TestRunner.TestChannelManager",function(){window.$B=window.$B||{},this._getCommandsRequestXHR=null,this._commandTypeProcessors={},this._isTestManagePage=window.$Config&&window.$Config.isTestManagePage;var e=window.document.domain.split(".");window.document.domain=e[e.length-2]+"."+e[e.length-1],this._isTestManagePage||this._restorePersistedState();var t=this._getQueryVariable("remote");t&&this.setTestMachine(t);var n=this._getQueryVariable("clientguid");n&&this.setClientGuid("clear"==n?"":n);var o=this._getQueryVariable("wingmangroup");o&&this.setBrowserGroup(o),this._lastCommandId="",this._lastSendResultsData="",this._connectionStarted=!1,this._shouldCheckin=!1,this.connection=new JBase.TestRunner.TestConnection,this._lastDataDate=(new Date).getTime(),this._commandRequestMessage=null,this._noRegister=this._getQueryVariable("noregister"),this._talkToBrowserPool=!this._isTestManagePage&&!this._noRegister,this._testHost="",this._disposed=!1,this.addObjectListener(this.connection,"connected",this._onConnected),this.addObjectListener(this.connection,"receiveddata",this._onReceivedData),this.addObjectListener(this.connection,"recievedChunk",this._onReceivedChunk),this.addObjectListener(this.connection,"sentChunk",this._onSentChunk),jQuery(window).bind("unload",bind(this,this.dispose))},{_responseLoadrId:null,_responseLoadsId:null,_registerBrowserInterval:null,start:function(){this.connection.start()},registerCommandTypeProcessor:function(e,t){this._commandTypeProcessors[e]=t},reportError:function(e,t){var n="";window.TraceWindowSerializationHelpers&&(n=window.TraceWindowSerializationHelpers.serializeEvents(Trace.events));var o={type:"error",message:e,traceCategory:t};n&&(o.traceLogs=n),Trace.log("ERROR: "+e,t),this._sendCommandResults(o,null,!0)},setTestMachine:function(e){this._testMachine=e,this.persistState()},setClientGuid:function(e){this._clientGuid=e,this.persistState()},setBrowserGroup:function(e){this._browserGroup=e,this.persistState()},SetConnection:function(e){this._disposed||this.connection.setConnection(e)},getPersistedState:function(){return this._testMachine=this._testMachine?this._testMachine:"",this._clientGuid=this._clientGuid?this._clientGuid:"",this._browserGroup=this._browserGroup?this._browserGroup:"",this._responseLoadrId=this._responseLoadrId?this._responseLoadrId:"",this._responseLoadsId=this._responseLoadsId?this._responseLoadsId:"",this._clientGuid+","+this._testMachine+","+this._browserGroup+","+this._responseLoadrId+","+this._responseLoadsId},persistState:function(){var e=window.document.domain;$Cookie.setCookie(t,this.getPersistedState(),"."==e[0]?e:"."+e)},setTestHost:function(e){this._testHost&&this.connection.unregisterGroup("TestManager_"+this._testHost+"_Watcher"),this._testHost=e.toUpperCase(),this._testHost&&this.connection.registerGroup("TestManager_"+this._testHost+"_Watcher")},dispose:function(){this._disposed||(this._disposed=!0,this.connection.dispose())},_restorePersistedState:function(){var e=$Cookie.getCookie(t);if(e){var n=e.split(",");this._clientGuid=n[0],this._testMachine=n[1],this._browserGroup=n[2],this._responseLoadrId=n[3],this._responseLoadsId=n[4]}},_onConnected:function(){var t=this;this._startTestManager(),this._isTestManagePage||(this._clientGuid?this.connection.registerGroup(this._clientGuid):(Trace.log("Trying to register the browser",e),this._registerBrowser()),!this._registerBrowserInterval&&this._talkToBrowserPool&&(this._registerBrowserInterval=setInterval(function(){t.connection.isConnected&&(t._clientGuid?t._sendHeartbeat():t._registerBrowser())},Math.round(1e3*(10+2*Math.random())))))},_sendHeartbeat:function(){if(this._talkToBrowserPool){var e=!(this._lastDataDate&&!((new Date).getTime()-this._lastDataDate>n));e=e&&!this._isTestManagePage&&!this._noRegister,this.connection.broadcast("BrowserPool",TestCommunicationForwardedMessageTypes.BrowserPool_UpdateHeartbeat,{browserId:this._clientGuid,idle:e})}},_checkIn:function(){this.connection.broadcast("BrowserPool",TestCommunicationForwardedMessageTypes.BrowserPool_Checkin,{browserId:this._clientGuid})},_registerBrowser:function(){if(this._talkToBrowserPool){var e={browserType:this._browserType(),os:this._operatingSystem(),browserVersion:$B.V,browserGroup:this._browserGroup};this._clientGuid&&(e.browserId=this._clientGuid),this.connection.broadcast("BrowserPool",TestCommunicationForwardedMessageTypes.BrowserPool_RegisterBrowser,e)}},_getQueryVariable:function(e){for(var t=window.location.search.substring(1),n=t.split("&"),o=0;o<n.length;o++){var s=n[o].split("=");if(decodeURIComponent(s[0])==e)return decodeURIComponent(s[1])}return""},_browserType:function(){navigator.userAgent;return $B.IE?$B.V>=10&&window.innerWidth==screen.width&&window.innerHeight==screen.height?"IEModern":"IE":$B.Firefox?"Firefox":$B.Chrome?"Chrome":$B.SF_iPhone&&!$B.Mobile?"iPad":$B.SF_iPhone?"iPhone":$B.Safari?"Safari":$B.Opera?"Opera":"Unknown"},_operatingSystem:function(){var e=navigator.userAgent;return $B.CR_Win||$B.Win6?-1!=e.indexOf(" ARM;")?"Windows RT":-1!=e.indexOf("Windows NT 6.1")?"Windows 7":-1!=e.indexOf("Windows NT 6.2")?"Windows 8":"Windows":$B.CR_Mac?"Mac":-1!=e.indexOf("iPad Other - Mozilla/5.0 (iPad; CPU OS")?"iOS":"Unknown OS"},_startTestManager:function(){this._isTestManagePage&&(this.connection.registerGroup("BrowserPool_Watcher"),this.connection.registerGroup("TestManager_Watcher"),this.setTestHost(window.TestCommunicationDefaultTestManager))},_onReceivedData:function(t){var n=!1;if(t)switch(t.t){case TestCommunicationForwardedMessageTypes.BrowserPool_RegisterBrowserResponse:var o=t.d;this._clientGuid!=o.browserId&&(this.setClientGuid(o.browserId),Trace.log("Got client guid - "+this._clientGuid,e),this._shouldCheckin=!0,this.connection.registerGroup(this._clientGuid));break;case TestCommunicationForwardedMessageTypes.BrowserPool_CheckinResponse:n=!0;break;case TestCommunicationForwardedMessageTypes.BrowserPool_BrowserDoesNotExist:this._registerBrowser();break;case TestCommunicationForwardedMessageTypes.TestRunner_Command:n=!0,this._parseCommands(t,t.d.d);break;case TestCommunicationForwardedMessageTypes.TestCommunicationServer_RegisterGroupAck:var s=t.d.groupName;if(this._isTestManagePage){if("BrowserPool_Watcher"==s&&this.connection.broadcast("BrowserPool",TestCommunicationForwardedMessageTypes.BrowserPool_Available,{}),this._testHost&&s=="TestManager_"+this._testHost+"_Watcher"){var r="TestManager_"+this._testHost;this.connection.broadcast(r,TestCommunicationForwardedMessageTypes.TestManager_GetTestList,{depth:3}),Trace.log("Fetching Available Tests From: "+r,e)}}else this._shouldCheckin?(this._shouldCheckin=!1,this._checkIn()):(this._responseLoadrId&&(this.connection.sendResponse({rId:this._responseLoadrId,sId:this._responseLoadsId},TestCommunicationForwardedMessageTypes.TestRunner_SendResults,{d:Object.toJSON({})}),this._responseLoadrId=null,this._responseLoadsId=null,this.persistState()),this._sendHeartbeat());break;case TestCommunicationForwardedMessageTypes.TestManager_TestsChanged:this.connection.broadcast("TestManager_"+this._testHost,TestCommunicationForwardedMessageTypes.TestManager_GetTestList,{depth:3});break;case TestCommunicationForwardedMessageTypes.LiveUnit_RunLiveUnitTests:case TestCommunicationForwardedMessageTypes.LiveUnit_GetTestFromLiveUnit:case TestCommunicationForwardedMessageTypes.BrowserPool_AvailableResponse:case TestCommunicationForwardedMessageTypes.TestManager_GetTestListResponse:case TestCommunicationForwardedMessageTypes.TestListener_LogMessage:case TestCommunicationForwardedMessageTypes.RemoteTestMode_TestStartMessage:case TestCommunicationForwardedMessageTypes.RemoteTestMode_TestEndMessage:case TestCommunicationForwardedMessageTypes.TestManager_TestsStopped:raiseEvent(this,t.t,t);break;case TestCommunicationForwardedMessageTypes.TestCommunicationServer_UnRegisterGroupAck:case TestCommunicationForwardedMessageTypes.ChunkResponseMessage:break;case TestCommunicationForwardedMessageTypes.PingMessage:case TestCommunicationForwardedMessageTypes.PingResponseMessage:t.d.resetIdle&&(n=!0);break;default:Trace.log("ERROR - Unknown message type - "+t.t+" - "+t.d,e)}n&&(this._lastDataDate=(new Date).getTime())},_onReceivedChunk:function(e){raiseEvent(this,"Chunk_"+e.chunkMessageType,e)},_onSentChunk:function(e){raiseEvent(this,"SentChunk_"+e.chunkMessageType,e)},_sendResponseOnLoad:function(){this._commandRequestMessage&&(this._responseLoadrId=this._commandRequestMessage.rId,this._responseLoadsId=this._commandRequestMessage.sId,this.persistState())},_parseCommands:function(t,n,r){var a=n._id;if(r=r||0,a!=this._lastCommandId){this._lastCommandId=a,this._commandRequestMessage=t;var i=n.type;if(i){Trace.startContext("Parsing command type: "+i,e);try{var c=this._commandTypeProcessors[i];if(c)c.parse(n);else if(o>r){var u=this;setTimeout(function(){u._parseCommands(t,n,r+1)},s)}else this.reportError("No command parser for command - type: "+i,e)}catch(d){this.reportError("Parsing command - type: "+i+" message: "+d.message,e)}finally{Trace.endContext()}}else this.reportError("Command has no type",e)}},_sendCommandResults:function(e,t,n){this._lastSendResultsData=e;var o=Object.toJSON(e);this.connection.sendResponse(this._commandRequestMessage,TestCommunicationForwardedMessageTypes.TestRunner_SendResults,n?{error:o}:{d:o}),t&&t()}},null,Shared.ObjectEventing);var r=JBase.TestRunner.TestChannelManager.Current=new JBase.TestRunner.TestChannelManager;r.start()}()}),define("liveunitmanager",["testchannelmanager"],function(){!function(){defineClass("JBase.TestRunner.LiveUnitManager",function(){this._liveUnitGetTestsMessage=null,this._liveUnit=null,this._$window=jQuery(window),this._$iFrame=null,this._testChannelManager=JBase.TestRunner.TestChannelManager.Current,this.addObjectListener(this._testChannelManager,TestCommunicationForwardedMessageTypes.LiveUnit_GetTestFromLiveUnit,this._onGetTestFromLiveUnit),this.addObjectListener(this._testChannelManager,TestCommunicationForwardedMessageTypes.LiveUnit_RunLiveUnitTests,this._onRunLiveUnitTests)},{setqUnit:function(e,t){this._qUnit=e,this._liveUnitGetTestsMessage&&(this._liveUnitGetTestsMessage.t==TestCommunicationForwardedMessageTypes.LiveUnit_RunLiveUnitTests?this._runTests(t,e):this._getTests(t,e))},_getTests:function(e,t){var n=[],o=[];if(o.length){for(var s=[],r=4,a=0;a<o.length;a++){var i=o[a];s.push({key:"Error_msg"+a,name:"Error message: "+i.message,type:r,props:{},testCount:1}),s.push({key:"Error_url"+a,name:"Error url: "+i.url,type:r,props:{},testCount:1}),s.push({key:"Error_line"+a,name:"Error line: "+i.line,type:r,props:{},testCount:1}),s.push({key:"Error_debug"+a,name:"To debug go to: /testresources/unittests/"+this._liveUnitGetTestsMessage.d.htmlFile+"?run=1",type:r,props:{},testCount:1})}n.push({key:"Error",name:"Load error",type:r,props:{},testCount:s.length,children:s})}else{var c=t.__latchTestList;for(var u in c){var d=c[u],l=[];for(var m in d)l.push({key:u+"."+m,name:m,type:0,props:{},testCount:1});n.push({key:u,name:u,type:1,props:{},testCount:l.length,children:l})}}this._testChannelManager.connection.sendResponse(this._liveUnitGetTestsMessage,TestCommunicationForwardedMessageTypes.LiveUnit_GetTestFromLiveUnitResponse,{tests:n}),this._liveUnitGetTestsMessage=null},_runTests:function(e,t){var n=this._liveUnitGetTestsMessage,o=this,s=n.d.sessionKey,r="",a=0,i=n.d.senderId;t.log(function(e){var t=e.result?8:2;e.result||("undefined"!=typeof e.actual&&o._logMessage(i,s,r,a++,"Actual: "+e.actual,t),"undefined"!=typeof e.expected&&o._logMessage(i,s,r,a++,"Expected: "+e.expected,t)),o._logMessage(i,s,r,a++,e.message,t),e.result||o._logMessage(i,s,r,a++,"Source: "+e.source,t)}),t.testStart(function(e){var t=r=n.d.htmlFile+"."+e.module+"."+e.name;a=0,o._testChannelManager.connection.send(i,TestCommunicationForwardedMessageTypes.RemoteTestMode_TestStartMessage,{sessionKey:s,key:t})}),t.testDone(function(e){var t=n.d.htmlFile+"."+e.module+"."+e.name,r=e.duration;if(e.failed>0){var c=o._testChannelManager._clientGuid;0==c.indexOf(TestCommunicationManagedBrowserIdPrefix)?o._testChannelManager.connection.broadcastAndWaitOnResponse(c+"_BrowserManager",TestCommunicationForwardedMessageTypes.BrowserManager_TakeScreenshot,{browserId:c,logLocation:o._liveUnitGetTestsMessage.d.screenshotDropRoot},function(e){return o._logMessage(i,s,t,a++,e?TestCommunicationScreenshotLogPrefix+e.d.screenshotLink:"Timed out getting screenshot",2),o._testChannelManager.connection.send(i,TestCommunicationForwardedMessageTypes.RemoteTestMode_TestEndMessage,{sessionKey:s,key:t,testResult:2,duration:r}),!0},2e4):o._testChannelManager.connection.send(i,TestCommunicationForwardedMessageTypes.RemoteTestMode_TestEndMessage,{sessionKey:s,key:t,testResult:2,duration:r})}else o._testChannelManager.connection.send(i,TestCommunicationForwardedMessageTypes.RemoteTestMode_TestEndMessage,{sessionKey:s,key:t,testResult:1,duration:r})}),t.done(function(){o._testChannelManager.connection.sendResponse(n,TestCommunicationForwardedMessageTypes.LiveUnit_RunLiveUnitTestsResponse,{})}),t.start()},_logMessage:function(e,t,n,o,s,r){this._testChannelManager.connection.send(e,TestCommunicationForwardedMessageTypes.TestListener_LogMessage,{sessionKey:t,key:n,timeStamp:this._getDateTimeString(),sequence:o,message:s,logMessageType:r})},_getDateTimeString:function(){var e,t,n=new Date,o=n.getHours(),s=n.getMinutes(),r=n.getSeconds();return t=o>=12?"PM":"AM",o>12&&(o-=12),0==o&&(o=12),10>s&&(s="0"+s),e=o+":"+s+":"+r+" "+t;
},_loadIframe:function(e){this._$iFrame&&this._$iFrame.remove(),this._$iFrame=jQuery('<iframe src="/testresources/unittests/'+e+'" frameBorder="0" style="position:absolute; border: 0xp; top:0px; left:0px; width:'+this._$window.width()+"px;height:"+this._$window.height()+'px"></iframe>'),jQuery(document.body).append(this._$iFrame)},_onGetTestFromLiveUnit:function(e){this._loadIframe(e.d.htmlFile),this._liveUnitGetTestsMessage=e},_onRunLiveUnitTests:function(e){this._loadIframe(e.d.htmlFile),this._liveUnitGetTestsMessage=e}},null,Shared.ObjectEventing),JBase.TestRunner.LiveUnitManager.Current=new JBase.TestRunner.LiveUnitManager}()}),define("basecommandparser",["liveunitmanager"],function(){!function(){var e="BaseCommandParser",t=100,n=100;defineClass("JBase.TestRunner.CommandParsers.BaseCommandParser",function(e){this.testChannelManager=e,e&&e.registerCommandTypeProcessor(this.commandType,this)},{commandType:null,parse:null,getControlFromCommand:function(o,s,r){var a=o.id,i=this;if(a){var c=null,u=null,d=0,l=JBase.UI.ControlPath.fromServerPathParts(a),m=function(){try{u=null,c=l.findControl(),r||(u="Control was not expected to exist, but it was found.")}catch(o){r&&(u=o)}u?d>t?i.reportError(u,e):(d++,setTimeout(m,n)):s(c)};m()}else i.reportError("No id on command - ???",e)},getElementFromCommand:function(o,s,r,a,i){var c=o.path;i=i||0;var u="";if(c){var d=jQuery(o.path);d.length>0?r?s(d):u="Element exists, but expected to not be there.":0==d.length&&(r?u="Failed to find element using path - "+c:s(d))}else u="No path passed on command.";if(u)if(i++,i>t)a?this.reportError(u,e):s(null);else{var l=this;setTimeout(function(){l.getElementFromCommand(o,s,r,a,i)},n)}},sendResponseOnLoad:function(){this.testChannelManager._sendResponseOnLoad()},sendCommandResults:function(e,t,n){this.testChannelManager._sendCommandResults(e,n)},reportError:function(e,t){this.testChannelManager.reportError(e,t)}})}()}),define("executefunction",["basecommandparser"],function(){!function(){var e="ExecuteFunction";defineSubClass("JBase.TestRunner.CommandParsers.ExecuteFunction",JBase.TestRunner.CommandParsers.BaseCommandParser,function(e){},{commandType:"executefunction",parse:function(t){var n=this;this.getControlFromCommand(t,function(o){var s=o[t.executeFunction];if(s)try{for(var arguments=t.arguments||[],r=0;r<arguments.length;r++){var a=arguments[r];for(var i in a){var c,u,d=a[i];if(d&&d.__argReplacement)switch(d.type){case"controlElementAtIndex":a[i]=o.__subElementsByIndex[d.value];break;case"controlPageX":c=jQuery(o.__subElementsByIndex[d.value]),u=c.offset(),a[i]=u.left+c.width()/2;break;case"controlPageY":c=jQuery(o.__subElementsByIndex[d.value]),u=c.offset(),a[i]=u.top+c.height()/2;break;default:return void n.reportError("Unknown argument replacement of type ("+d.type+") in executeFunction ("+t.executeFunction+") from control on element - "+JBase.UI.ControlPath.fromServerPathParts(t.id).toString(),e)}}}var l=s.apply(o,arguments);n.sendCommandResults({executeFunctionResult:l},t)}catch(m){n.reportError("Exception thrown ("+m.message+") in executeFunction ("+t.executeFunction+") from control on element - "+t.id,e)}else n.reportError("Failed to get executeFunction ("+t.executeFunction+") from control on element - "+o.element.id+" - "+t.id+" - "+o.__fullName,e)},!0)}});new JBase.TestRunner.CommandParsers.ExecuteFunction(JBase.TestRunner.TestChannelManager.Current)}()}),define("getcontrolstate",["executefunction"],function(){!function(){var e="GetControlState";defineSubClass("JBase.TestRunner.CommandParsers.GetControlState",JBase.TestRunner.CommandParsers.BaseCommandParser,function(e){},{commandType:"getcontrolstate",parse:function(t){var n=this;this.getControlFromCommand(t,function(o){if(o._getControlState){var s=o._getControlState();n.sendCommandResults(s,t)}else n.reportError("Failed to get control state from control on element - "+JBase.UI.ControlPath.fromServerPathParts(t.id).toString(),e)},!0)}});new JBase.TestRunner.CommandParsers.GetControlState(JBase.TestRunner.TestChannelManager.Current)}()}),define("waitforcontrolstate",["getcontrolstate"],function(){!function(){var e="WaitForControlState",t=150,n=100;defineSubClass("JBase.TestRunner.CommandParsers.WaitForControlState",JBase.TestRunner.CommandParsers.BaseCommandParser,function(e){},{commandType:"waitforcontrolstate",parse:function(e){var n=this;this.getControlFromCommand(e,function(o){n.waitForControlState(e,o,t)},!0)},waitForControlState:function(t,o,s){var r=this.getMemberNameValue(t.memberName,o),a=t.memberValue,i=!1;switch(t.comparisonType){case"equals":i=r===a;break;case"notEquals":i=r!==a;break;case"greaterThan":i=r>a;break;case"greaterThanOrEqualTo":i=r>=a;break;case"lessThan":i=a>r;break;case"lessThanOrEqualTo":i=a>=r}if(i)this.sendCommandResults({},t);else if(0==s)this.reportError("Failed to get expected control state from control on element - memberName:"+t.memberName+" comparison:"+t.comparisonType+" expectedValue:"+a+" returnedValue:"+r+" path:"+JBase.UI.ControlPath.fromServerPathParts(t.id).toString(),e);else{var c=this;setTimeout(function(){c.waitForControlState(t,o,s-1)},n)}},getMemberNameValue:function(e,t){for(var n=e.split("."),o=0,s=t;o<n.length&&s;o++)s=s[n[o]];return o==n.length?s:void 0}});new JBase.TestRunner.CommandParsers.WaitForControlState(JBase.TestRunner.TestChannelManager.Current)}()}),define("waitforcontrolexists",["waitforcontrolstate"],function(){!function(){defineSubClass("JBase.TestRunner.CommandParsers.WaitForControlExists",JBase.TestRunner.CommandParsers.BaseCommandParser,function(e){},{commandType:"waitforcontrolexists",parse:function(e){var t=this;this.getControlFromCommand(e,function(n){t.sendCommandResults({},e)},e.expectedToExist)}});new JBase.TestRunner.CommandParsers.WaitForControlExists(JBase.TestRunner.TestChannelManager.Current)}()}),define("getcontrolelementid",["waitforcontrolexists"],function(){!function(){var e="GetControlState";defineSubClass("JBase.TestRunner.CommandParsers.GetControlElementId",JBase.TestRunner.CommandParsers.BaseCommandParser,function(e){},{commandType:"getcontrolelementid",parse:function(t){var n=this;this.getControlFromCommand(t,function(o){if(o.id){var s=o.id;n.sendCommandResults(s,t)}else n.reportError("Failed to get control id from control on element - "+JBase.UI.ControlPath.fromServerPathParts(t.id).toString(),e)},!0)}});new JBase.TestRunner.CommandParsers.GetControlElementId(JBase.TestRunner.TestChannelManager.Current)}()}),define("setcookies",["getcontrolelementid"],function(){!function(){var e="SetCookies";defineSubClass("JBase.TestRunner.CommandParsers.SetCookies",JBase.TestRunner.CommandParsers.BaseCommandParser,function(e){},{commandType:"setcookies",parse:function(t){var n=t.cookies;if(n&&n.length>0){for(var o=0;o<n.length;o++){var s=n[o],r=s.Name,a=s.Value,i=s.Path,c=s.Domain,u=s.Secure,d=r+"="+escape(a);d+=";expires=Fri, 31 Dec 2037 20:00:00 UTC",d+=";path="+i,d+=";domain="+c,u&&(d+=";secure"),document.cookie=d}this.sendCommandResults({},t)}else this.reportError("There are no cookies on the command "+t.id,e)}});new JBase.TestRunner.CommandParsers.SetCookies(JBase.TestRunner.TestChannelManager.Current)}()}),define("clearcookies",["setcookies"],function(){!function(){defineSubClass("JBase.TestRunner.CommandParsers.ClearCookies",JBase.TestRunner.CommandParsers.BaseCommandParser,function(e){},{commandType:"clearcookies",parse:function(e){var t=document.cookie.split(";"),n=new Date;n.setTime(n.getTime()+-864e6);for(var o="; expires="+n.toGMTString(),s=t.length-1;s>=0;s--)for(var r=t[s],a=r.split("="),i=a[0].replace(/^\s+|\s+$/g,""),c=i+"=;",u=window.parent.document.location.host;u&&u.indexOf(".")>=0;){for(var d=c+"domain="+u+o,l=0;2>l;l++)for(var m=0;2>m;m++)window.parent.document.cookie=d+(0==l?"":"; path=/")+(0==m?"":"; secure");0==u.indexOf(".")&&(u=u.substring(1)),u=u.substring(u.indexOf("."))}JBase.TestRunner.TestChannelManager.Current.persistState(),this.sendCommandResults({},e)}});new JBase.TestRunner.CommandParsers.ClearCookies(JBase.TestRunner.TestChannelManager.Current)}()}),define("navigate",["clearcookies"],function(){!function(){defineSubClass("JBase.TestRunner.CommandParsers.Navigate",JBase.TestRunner.CommandParsers.BaseCommandParser,function(e){},{commandType:"navigate",parse:function(e){e.url;this.sendResponseOnLoad(),window.parent.location=e.url}});new JBase.TestRunner.CommandParsers.Navigate(JBase.TestRunner.TestChannelManager.Current)}()}),define("setremotemachine",["navigate"],function(){!function(){var e="SetRemoteMachine";defineSubClass("JBase.TestRunner.CommandParsers.SetRemoteMachine",JBase.TestRunner.CommandParsers.BaseCommandParser,function(e){},{commandType:"setremotemachine",parse:function(t){this.testChannelManager.setTestMachine(t.machine),Trace.log("Setting test machine - "+t.machine,e),this.sendCommandResults({},t)}});new JBase.TestRunner.CommandParsers.SetRemoteMachine(JBase.TestRunner.TestChannelManager.Current)}()}),define("executejavascript",["setremotemachine"],function(){!function(){var c_traceCategory="ExecuteJavascript";defineSubClass("JBase.TestRunner.CommandParsers.ExecuteJavascript",JBase.TestRunner.CommandParsers.BaseCommandParser,function(e){},{commandType:"executejavascript",parse:function(command){this.sendResponseOnLoad();var result=eval(command.code);this.sendCommandResults(result,command)}});var executeJavascript=new JBase.TestRunner.CommandParsers.ExecuteJavascript(JBase.TestRunner.TestChannelManager.Current)}()}),define("visible",["executejavascript"],function(){!function(){defineSubClass("JBase.TestRunner.CommandParsers.Visible",JBase.TestRunner.CommandParsers.BaseCommandParser,function(e){},{commandType:"visible",parse:function(e){var t=this;this.getElementFromCommand(e,function(n){n&&1==n.length&&n.is(":visible")?t.sendCommandResults(!0,e):t.sendCommandResults(!1,e)},e.expectedToExist,!1)}});new JBase.TestRunner.CommandParsers.Visible(JBase.TestRunner.TestChannelManager.Current)}()}),define("exists",["visible"],function(){!function(){defineSubClass("JBase.TestRunner.CommandParsers.Exists",JBase.TestRunner.CommandParsers.BaseCommandParser,function(e){},{commandType:"exists",parse:function(e){var t=this;this.getElementFromCommand(e,function(n){n&&1==n.length?t.sendCommandResults(!0,e):t.sendCommandResults(!1,e)},e.expectedToExist,!1)}});new JBase.TestRunner.CommandParsers.Exists(JBase.TestRunner.TestChannelManager.Current)}()}),define("click",["exists"],function(){!function(){var e="Click";defineSubClass("JBase.TestRunner.CommandParsers.Click",JBase.TestRunner.CommandParsers.BaseCommandParser,function(e){},{commandType:"click",parse:function(t){var n=this;this.getElementFromCommand(t,function(o){1!=o.length?n.reportError("Element is not unique with path - "+t.path,e):(o.click(),n.sendCommandResults({},t))},!0,!0)}});new JBase.TestRunner.CommandParsers.Click(JBase.TestRunner.TestChannelManager.Current)}()}),define("inputtext",["click"],function(){!function(){var e="InputText";defineSubClass("JBase.TestRunner.CommandParsers.InputText",JBase.TestRunner.CommandParsers.BaseCommandParser,function(e){},{commandType:"inputtext",parse:function(t){var n=this;this.getElementFromCommand(t,function(o){1!=o.length?n.reportError("Element is not unique with path - "+t.path,e):(o.val(t.text),o.trigger({type:"keydown",which:13,target:o[0]}),n.sendCommandResults({},t))},!0,!0)}});new JBase.TestRunner.CommandParsers.InputText(JBase.TestRunner.TestChannelManager.Current)}()}),define("getcurrenturl",["inputtext"],function(){!function(){defineSubClass("JBase.TestRunner.CommandParsers.GetCurrentUrl",JBase.TestRunner.CommandParsers.BaseCommandParser,function(e){},{commandType:"getcurrenturl",parse:function(e){this.sendCommandResults(window.location.href,e)}});new JBase.TestRunner.CommandParsers.GetCurrentUrl(JBase.TestRunner.TestChannelManager.Current)}()}),define("keypress",["getcurrenturl"],function(){!function(){var e="KeyPress",t=["keydown","keyup","keypress"];defineSubClass("JBase.TestRunner.CommandParsers.KeyPress",JBase.TestRunner.CommandParsers.BaseCommandParser,function(e){},{commandType:"keypress",createKeyEvent:function(e,t){var n=0;switch(t.key){case"{ESC}":n=27;break;case"{DOWN}":n=40;break;case"{UP}":n=38;break;case"{LEFT}":n=37;break;case"{RIGHT}":n=39;break;case"{ENTER}":n=13;break;default:n=t.key.toLowerCase().charCodeAt(0)-32}var o=jQuery.Event(e);return o.which=n,o.result=void 0,o},parse:function(t){var n=this;t.path?this.getElementFromCommand(t,function(o){1!=o.length?n.reportError("Element is not unique with path - "+t.path,e):(n.processKeyEvent(t,o),n.sendCommandResults({},t))},!0,!0):(this.processKeyEvent(t,jQuery(window.document.activeElement||window.document)),this.sendCommandResults({},t))},processKeyEvent:function(e,t){var n=t[0].nodeName,o=this.fireKeyEvent(e,t);if(o)switch(n){case"SELECT":this.processSelectKeyEvent(e,t)}},processSelectKeyEvent:function(e,t){switch(e.key){case"{DOWN}":t[0].selectedIndex<t[0].childCount-1&&t[0].selectedIndex++;break;case"{UP}":0!=t[0].selectedIndex&&t[0].selectedIndex--}},fireKeyEvent:function(e,n){for(var o,s=!0,r=0;r<t.length;r++)if(o=this.createKeyEvent(t[r],e),n.trigger(o),o.isDefaultPrevented()){s=!1;break}return s}});new JBase.TestRunner.CommandParsers.KeyPress(JBase.TestRunner.TestChannelManager.Current)}()}),define("selectindex",["keypress"],function(){!function(){var e="SelectIndex";defineSubClass("JBase.TestRunner.CommandParsers.SelectIndex",JBase.TestRunner.CommandParsers.BaseCommandParser,function(e){},{commandType:"selectindex",parse:function(t){var n=this;this.getElementFromCommand(t,function(o){1!=o.length?n.reportError("Element is not unique with path - "+t.path,e):(o[0].selectedIndex=t.indexToSelect,n.sendCommandResults({},t))},!0,!0)}});new JBase.TestRunner.CommandParsers.SelectIndex(JBase.TestRunner.TestChannelManager.Current)}()}),define("skytest",["selectindex"],function(){!function(){jQuery(window).bind("unload",function(){JBase.TestRunner.TestChannelManager.Current.dispose()})}()}),define("Wac_s_Test",function(){});