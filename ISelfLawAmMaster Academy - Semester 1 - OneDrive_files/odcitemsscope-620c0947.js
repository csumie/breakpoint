define("odsp-next/models/itemsScope/ItemsScopePLTBundleRoot",["require","exports","tslib","./ItemsScopeManager","../../controls/itemContent/itemsScope/ItemsScopeItemContent"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.knockoutResourceKey=i.knockoutResourceKey});
define("odsp-next/models/itemsScope/ItemsScopeManager",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/ControlResourceKeys","../../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/resources/Resources","../itemCache/ItemCacheStore","@ms/items-view/lib/private/operations/readItems","@ms/items-view/lib/private/operations/getItems","@ms/items-view/lib/private/operations/blockItemPage","@ms/items-view/lib/private/operations/pageLoad","../../pages/files/UseItemsScope.key","./ItemsScopeCurrentItemKey.key","./facets/CurrentItemsScopeFacets","@ms/items-view/lib/private/utilities/Graft","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/itemsScope/ItemsScope","../../utilities/killSwitch/KillSwitch","./ItemsScopeAddonHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._viewParams=n.viewParams;var i=r._itemCacheStore=n.itemCacheStore;r._bundleLoaderProvider=n.bundleLoaderProvider;r._itemsScopeCurrentItemKey=n.itemsScopeCurrentItemKey;r._useItemsScope=n.useItemsScope;r.itemsScopeItemKey=g.getNextItemsScopeItemKey();i.dispatch(l.blockItemPage());r._initializeHandlePageLoad();r._initializeUpdateViewParams();r._initializeOpenItem();return r}t.prototype.unblockItemPageRender=function(){var e=this;this._itemCacheStore.dispatch(a.readItems(function(e){return l.itemPageIsBlocked(e)}))&&this.async.setTimeout(function(){return e._itemCacheStore.dispatch(l.unblockItemPage())},0)};t.prototype._initializeUpdateViewParams=function(){var e=this,t=this._itemCacheStore.dispatch;this.observables.compute(function(){var n,r=e._viewParams();t(f.resolveItems({items:(n={},n[e.itemsScopeItemKey]=m.pack({viewParams:d.currentViewParamsFacet},{viewParams:new v.MirrorPatch(r)}),n)}))})};t.prototype._initializeOpenItem=function(){var e=this,t=this._itemCacheStore.dispatch,n=this.observables.pureCompute(function(){if(!y.default.isActivated("992AD818-56F1-4142-AB5E-2DECAA7504C8","6/10/2019","Do not let ItemsScope navigate to unsupported pivots.")){if(!e._useItemsScope())return n.peek()}return e._itemsScopeCurrentItemKey()});this.observables.compute(function(){var r=n();t(b.openItemWithAddon({itemsScopeItemKey:e.itemsScopeItemKey,currentItemKey:r}))})};t.prototype._initializeHandlePageLoad=function(){var e=this,t=this._bundleLoaderProvider;this.observables.backgroundCompute(function(){t.isPageLoaded.peek()?e._itemCacheStore.dispatch(c.signalItemsViewRenderComplete(e.itemsScopeItemKey)):t.isPageLoaded()})};t.dependencies=n.__assign({},r.default.dependencies,{viewParams:i.viewParams,itemCacheStore:u.resourceKey,bundleLoaderProvider:s.bundleLoader,useItemsScope:h.resourceKey,itemsScopeCurrentItemKey:p.resourceKey});return t}(r.default);t.ItemsScopeManager=w;t.resourceKey=o.createResolvedResourceKey(e("module").id,w)});
define("odsp-next/models/itemCache/ItemCacheStore",["require","exports","@ms/items-view/lib/private/store/createStore","@ms/items-view/lib/private/operations/pageLoad","../../providers/bundleLoader/PageLoadMonitor","@ms/odsp-utilities/lib/resources/Resources","@ms/items-view/lib/private/addons/registerControlHandler","../../dataSources/url/PageType","../../dataSources/url/QueryType","../../resources/DataSourceResourceKeys","../itemsScope/facets/OdspNextAppFacets","../itemsScope/ItemsScopeKeyConverter.key","../itemsScope/controls/ItemKeyToStoreKeyControl","../itemsScope/controls/ViewParamsToItemKeyControl","../itemsScope/ItemsScopeAddon.key","./ItemCacheConfiguration.key","../itemsScope/KnockoutStoreItemControlHandler","../itemsScope/controls/KnockoutStoreItemControl"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=new s.ResourceKey({name:e("module").id+".oneItemCacheInstance",factory:new s.ConstantResourceFactory({created:!1})}),b={pageLoadMonitor:i.resourceKey,itemsScopeKeyConverter:c.resourceKey,resources:s.resourceScopeKey,itemsScopeAddon:d.resourceKey,itemCacheConfiguration:v.resourceKey,oneItemCacheInstance:y,knockoutStoreItemControlHandler:m.resourceKey};t.resourceKey=new s.ResourceKey({name:e("module").id,factory:{dependencies:b,create:function(e){var t=e.pageLoadMonitor,i=e.itemsScopeKeyConverter,s=e.resources,c=e.itemsScopeAddon,d=e.itemCacheConfiguration,v=e.oneItemCacheInstance,m=e.knockoutStoreItemControlHandler;if(v.created)throw new Error("Attempted to create a second instance of the ItemCacheStore.");v.created=!0;var y=n.createItemCacheStore({configuration:d});y.dispatch(o.registerControlHandler(l.odspNextAppKeyFacet,h.itemKeyToStoreKeyControl)(o.createControlHandler()(function(){return function(){return i.itemKeyToStoreKeyControlHandler}})));y.dispatch(o.registerControlHandler(l.odspNextAppKeyFacet,p.viewParamsToItemKeyControl)(o.createControlHandler()(function(){return function(){return i.viewParamsToItemKeyControlHandler}})));y.dispatch(o.registerControlHandler(l.odspNextAppKeyFacet,g.knockoutStoreItemControl)(o.createControlHandler()(function(){return m})));y.dispatch(c);y.dispatch(r.waitForPageLoad()).then(function(){var e=function(e){var t=e.consume(f.url);return u.default[t.getPageType()]+"-"+(a.default[t.getQueryType()]||"Default")}(s);t.pageLoaded(e)});return{instance:y,disposable:y}}}})});
define("@ms/items-view/lib/private/store/createStore",["require","exports","tslib","redux","redux-thunk","redux-batched-subscribe","./enhancers/NextStoreUpdateEnhancer","./middleware/RunOnceMiddleware","./middleware/LoggingMiddleware","../models/Facet","./reducers/itemCacheReducer","../operations/getItems","../facets/ConfigurationFacets","../operations/pruneItems","../utilities/Graft","./ItemCacheDebugger","../facets/ItemFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DEFAULT_CONFIGURATION=f.pack({},{});t.notifierFacet=new f.Facet("storeNotifier");t.createItemCacheStore=function(e){var f,y,b,w,E,S,x=e.configuration,T=void 0===x?t.DEFAULT_CONFIGURATION:x,N=e.createStore,C=void 0===N?r.createStore:N,k=m.displayNameFacet.unpack(T),L={configuration:T},A=(b=t.notifierFacet.unpack(T)||g(),{notifier:function(e){w=e;b(e)},forceNotify:function(){var e=w;e&&b(function(){if(w===e){w=void 0;e()}},{urgent:!0})}}),O=A.notifier,M=A.forceNotify,_=C(function(e,t){return d.withGraft({freeze:!0})(function(n){return l.itemCacheReducer(e,t,{graft:n})})},function(e){if("undefined"!=typeof window&&"function"==typeof window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__)return window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({name:e});return r.compose}(k)(r.applyMiddleware(a.loggingMiddleware,u.runOnceMiddleware,i.default.withExtraArgument(L)),o.nextStoreUpdateEnhancer(M),s.batchedSubscribe(O)));_.dispatch(c.supportFacets({keyFacet:h.configurationItemKeyFacet,facets:[]}));_.dispatch(c.resolveItems({items:(f={},f[h.configurationItemKey]=T,f)}));_.dispatch(p.registerPermanentItemDemands({items:(y={},y[h.configurationItemKey]={},y)}));"undefined"!=typeof window&&("$ic"in window?window.$ic instanceof v.ItemCacheDebugger?E=window.$ic:console.warn("The $ic global has already been claimed, so the ItemCache debugger cannot be initialized."):E=window.$ic=new v.ItemCacheDebugger);var D=n.__assign({},_,{dispose:function(){S&&S()}});E&&(S=E.registerStore(D));return D};function g(){var e=null;return function(t,n){void 0===n&&(n={});if(n.urgent){if(null!==e){window.clearTimeout(e);e=null}t()}else null===e&&(e=window.setTimeout(function(){e=null;t()},0))}}t.createDefaultStoreNotifier=g});
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define("redux",["exports"],t):t(e.Redux={})}(this,function(e){"use strict";var t=function(e){var t,n=("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()).Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}(),n=function(){return Math.random().toString(36).substring(7).split("").join(".")},r={INIT:"@@redux/INIT"+n(),REPLACE:"@@redux/REPLACE"+n(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+n()}};function i(e,t){var n=t&&t.type;return"Given "+(n&&'action "'+n+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function s(e,t){return function(){return t(e.apply(this,arguments))}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}e.createStore=function e(n,i,s){var o;if("function"==typeof i&&"function"==typeof s||"function"==typeof s&&"function"==typeof arguments[3])throw Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function");if("function"==typeof i&&void 0===s&&(s=i,i=void 0),void 0!==s){if("function"!=typeof s)throw Error("Expected the enhancer to be a function.");return s(e)(n,i)}if("function"!=typeof n)throw Error("Expected the reducer to be a function.");var u=n,a=i,f=[],l=f,c=!1;function h(){l===f&&(l=f.slice())}function p(){if(c)throw Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return a}function d(e){if("function"!=typeof e)throw Error("Expected the listener to be a function.");if(c)throw Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var t=!0;return h(),l.push(e),function(){if(t){if(c)throw Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");t=!1,h();var n=l.indexOf(e);l.splice(n,1)}}}function v(e){if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(c)throw Error("Reducers may not dispatch actions.");try{c=!0,a=u(a,e)}finally{c=!1}for(var t=f=l,n=0;t.length>n;n++)(0,t[n])();return e}return v({type:r.INIT}),(o={dispatch:v,subscribe:d,getState:p,replaceReducer:function(e){if("function"!=typeof e)throw Error("Expected the nextReducer to be a function.");u=e,v({type:r.REPLACE})}})[t]=function(){var e,n=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function t(){e.next&&e.next(p())}return t(),{unsubscribe:n(t)}}})[t]=function(){return this},e},o},e.combineReducers=function(e){for(var t=Object.keys(e),n={},s=0;t.length>s;s++){var o=t[s];"function"==typeof e[o]&&(n[o]=e[o])}var u,a=Object.keys(n);try{!function(e){Object.keys(e).forEach(function(t){var n=e[t];if(void 0===n(void 0,{type:r.INIT}))throw Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===n(void 0,{type:r.PROBE_UNKNOWN_ACTION()}))throw Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+r.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}(n)}catch(e){u=e}return function(e,t){if(void 0===e&&(e={}),u)throw u;for(var r=!1,s={},o=0;a.length>o;o++){var f=a[o],l=e[f],c=(0,n[f])(l,t);if(void 0===c){var h=i(f,t);throw Error(h)}s[f]=c,r=r||c!==l}return r?s:e}},e.bindActionCreators=function(e,t){if("function"==typeof e)return s(e,t);if("object"!=typeof e||null===e)throw Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var n=Object.keys(e),r={},i=0;n.length>i;i++){var o=n[i],u=e[o];"function"==typeof u&&(r[o]=s(u,t))}return r},e.applyMiddleware=function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},i={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},s=t.map(function(e){return e(i)});return function(e){for(var t=1;arguments.length>t;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){o(e,t,n[t])})}return e}({},n,{dispatch:r=u.apply(void 0,s)(n.dispatch)})}}},e.compose=u,e.__DO_NOT_USE__ActionTypes=r,Object.defineProperty(e,"__esModule",{value:!0})});
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("redux-thunk",[],t):"object"==typeof exports?exports.ReduxThunk=t():e.ReduxThunk=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t){"use strict";function n(e){return function(t){var n=t.dispatch,r=t.getState;return function(t){return function(i){return"function"==typeof i?i(n,r,e):t(i)}}}}t.__esModule=!0;var r=n();r.withExtraArgument=n,t.default=r}])});
define("redux-batched-subscribe",["require","exports","module"],function(e,t,n){"use strict";t.__esModule=!0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};t.batchedSubscribe=function(e){if("function"!=typeof e)throw new Error("Expected batch to be a function.");var t=[],n=t;function i(){n===t&&(n=t.slice())}function s(e){if("function"!=typeof e)throw new Error("Expected listener to be a function.");var t=!0;i();n.push(e);return function(){if(t){t=!1;i();var r=n.indexOf(e);n.splice(r,1)}}}function o(){for(var e=t=n,r=0;r<e.length;r++)e[r]()}function u(){e(o)}return function(e){return function(){var t=e.apply(void 0,arguments),n=t.subscribe;function i(){var e=t.dispatch.apply(t,arguments);u();return e}return r({},t,{dispatch:i,subscribe:s,subscribeImmediate:n})}}}});
define("@ms/items-view/lib/private/store/enhancers/NextStoreUpdateEnhancer",["require","exports","tslib","../actions/createActionCreator","../../utilities/async/Signal"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.createActionCreator("waitForNextStoreUpdate"),o=r.createActionCreator("forceNextStoreUpdate");t.waitForNextStoreUpdate=function(){var e=this;return function(t){return n.__awaiter(e,void 0,void 0,function(){var e;return n.__generator(this,function(n){switch(n.label){case 0:e=new i.Signal;t(s({signal:e}));return[4,e.promise];case 1:return[2,n.sent()]}})})}};t.forceStoreUpdate=function(){return function(e){e(o({}))}};t.nextStoreUpdateEnhancer=function(e){var t=this;return function(r){return function(u,a){var f=r(u,a),l=f.dispatch,c=n.__rest(f,["dispatch"]),h=c.getState(),p=new i.Signal,d=p.resolve,v=p.promise;c.subscribe(function(){var e,t=d;e=new i.Signal,d=e.resolve,v=e.promise;t(h);h=c.getState()});return n.__assign({},c,{dispatch:function(r){if("function"!=typeof r){if(s.matches(r)){var i=r.payload.signal;n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return[4,v];case 1:e=t.sent();i.resolve(e);return[2]}})});return r}if(o.matches(r)){e();return r}return l(r)}return l(r)}})}}}});
define("@ms/items-view/lib/private/store/actions/createActionCreator",["require","exports","../../utilities/objects"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=0;t.createActionCreator=function(e){var t=e+"_"+ ++r;return n.assign(function(e){return{type:t,payload:e}},{type:t,actionType:void 0,payloadType:void 0,matches:function(e){return!!e&&e.type===t}})};t.createAsyncActionCreator=function(e){return n.assign(function(t){return e(t)},{actionType:void 0,payloadType:void 0})}});
define("@ms/items-view/lib/private/utilities/async/Signal",["require","exports","tslib","@ms/utilities-async/lib/signal/Signal"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/utilities-async/lib/signal/Signal",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){var e,t;this.promise=new Promise(function(n,r){e=n;t=r});this.resolve=e;this.reject=t};t.Signal=n});
define("@ms/items-view/lib/private/store/middleware/RunOnceMiddleware",["require","exports","../../utilities/objects","../../models/AutoKeyFacet","../../models/Facet"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=new i.Facet("runOnce"),o=new r.AutoKeyFacet("runOnce");t.asOnceOnly=function(e){return n.assign(function(t){return t(e)},s.pack(o.serializeNext()))};t.runOnceMiddleware=function(e){e.dispatch;var t={};return function(e){return function(n){if("function"==typeof n){var r=s.unpack(n);if(r){var i=t[r];if(r in t)return i;var o=e(n);t[r]=o;return o}return e(n)}return e(n)}}}});
define("@ms/items-view/lib/private/models/AutoKeyFacet",["require","exports","tslib","./KeyFacet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t,{id:r.numberPart()})||this;n._lastId=0;return n}t.prototype.next=function(){return{id:++this._lastId}};t.prototype.serializeNext=function(){return this.serialize(this.next())};return t}(r.KeyFacet);t.AutoKeyFacet=i});
define("@ms/items-view/lib/private/models/KeyFacet",["require","exports","tslib","./Facet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e.string="string";e.number="number";e.boolean="boolean";e.subKey="subKey";e.array="array"}(t.KeyPartType||(t.KeyPartType={}));var i={};t.stringPart=function(e){void 0===e&&(e=i);var t=e.shouldNormalizeCasing,n=e.shouldNormalizeToEmpty,r=t?o:function(e){return e};return{serialize:n?function(e){return r(e)||""}:r,deserialize:function(e){return e}}};t.arrayPart=function(e){return{serialize:function(t){return t?t.map(function(t){return e.serialize(t)}):void 0},deserialize:function(t){return t?t.map(function(t){return e.deserialize(t)}):void 0}}};t.numberPart=function(){return{serialize:function(e){return e},deserialize:function(e){return e}}};t.enumPart=function(e){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[e[n]]=n);return{serialize:function(t){return e[t]},deserialize:function(e){return t[e]}}};t.booleanPart=function(){return{serialize:function(e){return e},deserialize:function(e){return e}}};t.subKeyPart=function(e){return{serialize:function(t){return t?e.serialize(t):void 0},deserialize:function(t){return t?e.deserialize(t):void 0}}};var s=function(e){n.__extends(t,e);function t(n,r){var i=e.call(this,n)||this;i._options=r;i._partKeys=Object.keys(r);var s=i._prefix="{"+JSON.stringify(i.id);t._keyFacetsByPrefix[s]=i;return i}t.get=function(e){if(!e)throw new Error("Unable to determine the KeyFacet for an empty or undefined key.");var t=e.split(":",1)[0],n=this._keyFacetsByPrefix[t];if(!n){var r=JSON.parse(t.slice(1));throw new Error("Unable to determine the KeyFacet for a key with prefix '"+r+"'. Only use key values created by invoking [KeyFacet].serialize(___) when storing or fetching items in the Item Cache. This error will typically occur if multiple versions of the @ms/items-view package have been bundled into the application.")}return n};t.prototype.matches=function(e){if(!e)return!1;var t=this._prefix;return e.slice(0,t.length)===t};t.prototype.serialize=function(e){var t,n=this;return JSON.stringify(((t={})[this.id]=this._partKeys.map(function(t){var r=n._options[t],i=e[t];return r.serialize(i)}),t))};t.prototype.deserialize=function(e){var t=JSON.parse(e)[this.id];if(!t)throw new Error("Input '"+e+"' does not match key '"+this.id+"'.");for(var n={},r=0;r<this._partKeys.length;r++){var i=this._partKeys[r],s=t[r],o=this._options[i].deserialize(s);n[i]=null===o?void 0:o}return n};t._keyFacetsByPrefix={};return t}(r.Facet);t.KeyFacet=s;function o(e){return e?(""+e).toUpperCase():e}});
define("@ms/items-view/lib/private/models/Facet",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=0,r=function(){function e(t){this.id=i(t);e._facetsById[this.id]=this}e.get=function(t){if(!t)throw new Error("Unable to determine the Facet for an empty or undefined id.");var n=e._facetsById[t];if(!n)throw new Error("Unable to determine the Facet for id '"+t+"'. Only store objects into a facet collection that have been created using the pack function. This error will typically occur if multiple versions of the @ms/items-view package have been bundled into the application.");return n};e.prototype.unpack=function(e){return e[this.id]};e.prototype.pack=function(e){var t;return(t={})[this.id]=e,t};e._facetsById={};return e}();t.Facet=r;t.unpack=function(e,t){var n={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];n[r]=t[i.id]}return n};t.pack=function(e,t){var n={};for(var r in e)if(e.hasOwnProperty(r)){n[e[r].id]=t[r]}return n};t.merge=function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(t[s]=i[s])}return t};t.createDynamicFacet=function(e){var t=new r(e);return function(e){return{id:t.id+"_"+e}}};function i(e){return e+"_"+ ++n}t.getNextId=i});
define("@ms/items-view/lib/private/store/middleware/LoggingMiddleware",["require","exports","../../utilities/performance"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e.all="all";e.origin="origin";e.none="none"}(r||(r={}));var i=function(){try{if("sessionStorage"in window){var e=window.sessionStorage.itemCacheLogging;if(e)switch(e.toLowerCase()){case"all":return"all";case"origin":return"origin";case"none":default:return"none"}}}catch(e){}return"none"}();function s(e,t,r){"undefined"!=typeof console&&console.log(n.now()," current state: ",e," dispatching action: ",t," new state: ",r)}t.loggingMiddleware=function(e){e.dispatch;var t=e.getState;return function(e){return function(n){var r,o,u="function"==typeof n;switch(i){case"origin":u||(r=t());o=e(n);u||s(r,n,t());break;case"all":r=t();o=e(n);s(r,n,t());break;case"none":default:o=e(n)}return o}}}});
define("@ms/items-view/lib/private/utilities/performance",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.now=function(){return window.performance&&performance.now?Math.round(performance.now()):Date.now()};var n="EUPL";function r(e){return 0===e.lastIndexOf(n+".")?e:n+"."+e}t.mark=function(e){window.performance&&performance.mark&&performance.mark(r(e))};t.getMarkTime=function(e){if(window.performance&&performance.mark){var t=performance.getEntriesByName(r(e));return t&&t.length>0?Math.round(t[0].startTime):NaN}return NaN};t.measure=function(e,t,n){window.performance&&performance.measure&&performance.measure(r(e),r(t),r(n))}});
define("@ms/items-view/lib/private/store/reducers/itemCacheReducer",["require","exports","./itemMapReducer","./keyMapReducer","./operationMapReducer","../../utilities/Graft","../actions/createActionCreator"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.mapKeys=o.createActionCreator("mapKeys");t.processBatch=o.createActionCreator("processBatch");var u={itemMap:n.itemMapReducer(void 0,void 0),keyMap:r.keyMapReducer(void 0,void 0),operationMap:i.operationMapReducer(void 0,void 0)};t.itemCacheReducer=function e(o,f,l){void 0===o&&(o=u);void 0===l&&(l={});var c=l.graft,h=void 0===c?s.graft:c;if(f){if(!t.processBatch.matches(f)){if(t.mapKeys.matches(f)){for(var p=r.keyMapReducer(o.keyMap,r.moveKeys(f.payload)),d={},v=0,m=Object.keys(f.payload.mappings);v<m.length;v++){var g=m[v],y=f.payload.mappings[g],b=r.getMappedKey(p,y);if(b){var w=a(o,y),E=a(o,g);if(E&&w!==E){var S=h({mergedItem:w},{mergedItem:E}).mergedItem;S&&(d[b]=S)}}}return h(o,{keyMap:new s.ReplacePatch(p),itemMap:new s.ReplacePatch(n.itemMapReducer(o.itemMap,n.updateItems({items:d})))})}if(n.updateItems.matches(f)){var x=f.payload.items;p=r.keyMapReducer(o.keyMap,r.addKeys({keys:Object.keys(x)}),l);return h(o,{keyMap:new s.ReplacePatch(p),itemMap:new s.ReplacePatch(n.itemMapReducer(o.itemMap,n.updateItems({items:r.remapKeys(p,x)}),l))})}if(n.pruneItems.matches(f)){x=f.payload.items;return h(o,{itemMap:new s.ReplacePatch(n.itemMapReducer(o.itemMap,n.pruneItems({items:r.remapKeys(o.keyMap,x)}),l))})}return h(o,{keyMap:new s.ReplacePatch(r.keyMapReducer(o.keyMap,f,l)),itemMap:new s.ReplacePatch(n.itemMapReducer(o.itemMap,f,l)),operationMap:new s.ReplacePatch(i.operationMapReducer(o.operationMap,f,l))})}for(var T=0,N=f.payload.actions;T<N.length;T++){o=e(o,N[T],l)}}return o};function a(e,t){return n.getItem(e.itemMap,r.getMappedKey(e.keyMap,t))}t.getCacheItem=a});
define("@ms/items-view/lib/private/store/reducers/itemMapReducer",["require","exports","../../utilities/Graft","../../store/actions/createActionCreator"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={items:{}};t.updateItems=r.createActionCreator("updateItems");t.pruneItems=r.createActionCreator("pruneItems");t.itemMapReducer=function(e,r,s){void 0===e&&(e=i);void 0===s&&(s={});var o=s.graft,u=void 0===o?n.graft:o;if(r){if(t.updateItems.matches(r)){var a={},f=r.payload.items;for(var l in f)Object.prototype.hasOwnProperty.call(f,l)&&(a[l]=f[l]);return u(e,{items:a})}if(t.pruneItems.matches(r)){f=r.payload.items,a={};for(var l in f)Object.prototype.hasOwnProperty.call(f,l)&&(a[l]=e.items[l]);return u(e,{items:new n.ReplacePatch(a)})}}return e};t.getItem=function(e,t){return e.items[t]}});
define("@ms/items-view/lib/private/utilities/Graft",["require","exports","tslib","@ms/utilities-objects/lib/is"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){var e={},t=new WeakMap;Object.freeze(e);t.set(e,!0);return!!t.get(e)}(),s=function(){function e(){this.isDelete=!0}e.prototype.apply=function(e){};return e}();t.Delete=s;var o=function(){this.isPatch=!0};t.Patch=o;var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this)||this;n._value=t;return n}t.prototype.apply=function(){return this._value};return t}(o);t.ReplacePatch=u;var a=function(e){n.__extends(t,e);function t(t){var n=e.call(this)||this;n._value=t;return n}t.prototype.apply=function(e){void 0===e&&(e=this._value);return e};return t}(o);t.DefaultPatch=a;var f=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this)||this;r._value=t;r._match=n;return r}t.prototype.apply=function(e){return this._match(e)?e:this._value};return t}(o);t.IfNotMatchPatch=f;var l=function(e){n.__extends(t,e);function t(t){var n=e.call(this)||this;n._increment=t;return n}t.prototype.apply=function(e){void 0===e&&(e=0);return e+this._increment};return t}(o);t.IncrementPatch=l;var c=function(e){n.__extends(t,e);function t(t){var n=e.call(this)||this;n._values=t;return n}t.prototype.apply=function(e){var t=this._values;return e?e.concat(t):t.slice()};return t}(o);t.ArrayConcatPatch=c;var h=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this)||this;r._values=t;r._getKey=n;return r}t.prototype.apply=function(e){var t=this;if(!e)return this._values;var n={};if(e)for(var r=0,i=e;r<i.length;r++){var s=i[r],o=this._getKey(s);n[o]=!0}var u=this._values.filter(function(e){return!n[t._getKey(e)]});return u.length>0?e.concat(u):e};return t}(o);t.ArrayConcatIfNotMatchKeyPatch=h;var p=function(e){n.__extends(t,e);function t(t){var n=e.call(this)||this;n._value=t;return n}t.prototype.apply=function(e){var t=this._value;return e?e.filter(function(e){return!r.is(e,t)}):e};return t}(o);t.ArrayRemovePatch=p;var d=function(e){n.__extends(t,e);function t(t){var n=e.call(this)||this;n._match=t;return n}t.prototype.apply=function(e){var t=this._match;return e?e.filter(function(e){return!t(e)}):e};return t}(o);t.ArrayRemoveMatchPatch=d;var v=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this)||this;r._match=t;r._values=n;return r}t.prototype.apply=function(e){for(var t=this._values,n=this._match,r=-1,i=0,s=e.length;i<s;i++)if(n(e[i])){r=i;break}return r>-1?e.slice(0,r).concat(t,e.slice(r+1)):e};return t}(o);t.ArraySpliceMatchPatch=v;var m=function(e){n.__extends(t,e);function t(t){var n=e.call(this)||this;n._values=t;return n}t.prototype.apply=function(e){var t=this._values;if(!e)return t;if(e.length!==t.length)return t;for(var n=0;n<t.length;n++)if(!r.is(t[n],e[n]))return t;return e};return t}(o);t.ArrayMirrorPatch=m;var g=function(e){n.__extends(t,e);function t(t){var n=e.call(this)||this;n._value=t;return n}t.prototype.apply=function(e,n){var r=this._value;if(!e||!r||"object"!=typeof r||Object.getPrototypeOf(r)!==Object.prototype||T(r)||x(r))return n.graft({value:e},{value:r}).value;var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(i[o]=new s);for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(i[o]=new t(r[o]));return n.graft(e,i)};return t}(o);t.MirrorPatch=g;var y=function(e){n.__extends(t,e);function t(t){var n=e.call(this)||this;n._patches=t;return n}t.prototype.apply=function(e,t){var n=this._patches,r=t.graft;return n.reduce(function(e,t){return r(e,t)},e)};return t}(o);t.MultiPatch=y;function b(e){void 0===e&&(e={});var t=e.freeze,s=void 0!==t&&t;return function(e){var t=new Map,o=new Map;var u=e(function e(u,a){var f=t.has(u)?u:void 0;if(a){if(o.has(a))throw new Error("Encountered a circular reference in patch supplied to graft().");o.set(a,!0);for(var l in a)if(Object.prototype.hasOwnProperty.call(a,l)){var c=u[l],h=a[l];if(!r.is(h,c)){var p=void 0;if(h&&x(h))p=h;else if(h&&T(h))p=h.apply(c,{graft:e});else if(h&&"object"==typeof h&&Object.getPrototypeOf(h)!==Object.prototype)p=h;else if(h&&"object"==typeof h&&c&&"object"==typeof c){p=e(c,h)}else if("object"==typeof h&&h&&S(h)){p=e({},h);i&&s&&p&&"object"==typeof p&&!t.has(p)&&(Object.isFrozen(p)||Object.freeze(p))}else p=h;if(!(r.is(p,c)&&l in u)){if(!f){f=n.__assign({},u);t.set(f,!0)}x(p)?delete f[l]:f[l]=p}}}o.delete(a)}return f||u});s&&t.forEach(function(e,t){Object.isFrozen(t)||Object.freeze(t)});return u}}t.withGraft=b;function w(e,t){return b()(function(n){return n(e,t)})}t.graft=w;function E(e,t){if(!r.is(e,t)){var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=e[i],u=t[i];if(i in t){if(!r.is(u,o))if("object"==typeof u&&u&&Object.getPrototypeOf(u)!==Object.prototype)n[i]=u;else if("object"==typeof u&&u&&"object"==typeof o&&o){var a=E(o,u);a&&Object.keys(a).length>0&&(n[i]=a)}else n[i]=u}else n[i]=new s}for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(i in e||(n[i]=t[i]));return n}}t.diff=E;t.subtract=function(e,t){return w({},E(t,e))};t.isSubset=function(e,t){return r.is(w(e,t),e)};function S(e){var t=new WeakMap;return function e(n){if(n){if(t.has(n))throw new Error("Encountered circular reference in patch supplied to graft().");t.set(n,!0);for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)){var i=n[r];if(i&&i instanceof s)return!0;if(i&&i instanceof o)return!0;if(i&&"object"==typeof i&&Object.getPrototypeOf(i)===Object.prototype&&e(i))return!0}t.delete(n)}return!1}(e)}function x(e){return e instanceof s}t.isPatchDeletion=x;function T(e){return e instanceof o}t.isPatchOperation=T});
define("@ms/items-view/lib/private/store/reducers/keyMapReducer",["require","exports","tslib","../../utilities/Graft","../actions/createActionCreator","../../models/AutoKeyFacet"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.cacheKeyFacet=new s.AutoKeyFacet("cacheKey");var o={lastAutoId:0,mappings:{}};t.addKeys=i.createActionCreator("addKeys");t.moveKeys=i.createActionCreator("moveKeys");t.keyMapReducer=function(e,i,s){void 0===e&&(e=o);void 0===s&&(s={});var u=s.graft,a=void 0===u?r.graft:u;if(i){if(t.addKeys.matches(i)){for(var f=i.payload.keys,l=e.lastAutoId,c={},h=0,p=f;h<p.length;h++){var d=p[h];e.mappings[d]||(c[d]=t.cacheKeyFacet.serialize({id:++l}))}return a(e,{lastAutoId:l,mappings:c})}if(t.moveKeys.matches(i)){var v=i.payload.mappings,m=(c={},{});l=e.lastAutoId;for(var g in v)if(Object.prototype.hasOwnProperty.call(v,g)){var y=v[g],b=e.mappings[y]||m[y];if(b)c[g]=b;else{var w=t.cacheKeyFacet.serialize({id:++l});c[g]=m[y]=w}}return a(e,{lastAutoId:l,mappings:n.__assign({},m,c)})}}return e};function u(e,t){return e.mappings[t]}t.getMappedKey=u;t.remapKeys=function(e,t){for(var n={},r=0,i=Object.keys(t);r<i.length;r++){var s=i[r];n[u(e,s)]=t[s]}return n}});
define("@ms/items-view/lib/private/store/reducers/operationMapReducer",["require","exports","../../store/actions/createActionCreator","../../models/KeyFacet","../../models/Facet","../../utilities/Graft"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=new r.KeyFacet("operation",{operationTypeId:r.stringPart(),keyFacetId:r.stringPart()});t.getOperationTypeKey=function(e){var t=e.operationTypeFacet,n=e.keyFacet;return o.serialize({operationTypeId:t.id,keyFacetId:n.id})};t.isOperationTypeKey=function(e){return o.matches(e)};t.getOperationKeyParts=function(e){var t=o.deserialize(e),n=t.keyFacetId,r=t.operationTypeId;return{keyFacet:i.Facet.get(n),operationTypeFacet:i.Facet.get(r)}};t.registerOperators=n.createActionCreator("registerOperators");t.editQueue=n.createActionCreator("editQueue");var u={lastOperationId:0,operations:{}};t.operationMapReducer=function(e,n,r){void 0===e&&(e=u);void 0===r&&(r={});var i,o=r.graft,a=void 0===o?s.graft:o;if(n){if(t.editQueue.matches(n)){var f=n.payload,l=f.key,c=f.queue;return a(e,{operations:(i={},i[l]={queue:c},i)})}if(t.registerOperators.matches(n)){var h=n.payload.operators,p={};for(var d in h)if(Object.prototype.hasOwnProperty.call(h,d)){var v=h[d];p[d]={operator:v}}return a(e,{operations:p})}}return e}});
define("@ms/items-view/lib/private/operations/getItems",["require","exports","tslib","../store/actions/createActionCreator","../utilities/objects","../utilities/Graft","../utilities/async/Signal","../models/Facet","../store/actions/implementOperation","../facets/DemandFacets","./readItems","../store/middleware/RunOnceMiddleware","../utilities/async/all","./getItemsOperation","./resolveItems","../models/itemCache/excludeResolvedDemands","../models/itemCache/ItemCacheEvaluator","../models/items/ItemResolver"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";var y=this;Object.defineProperty(t,"__esModule",{value:!0});t.getItemsOperation=p.getItemsOperation;t.resolveItems=d.resolveItems;t.resolveItemsForBatch=d.resolveItemsForBatch;t.supportFacets=d.supportFacets;var b=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});return e.call(this,t)||this}return t}(a.ItemOperationError);t.GetItemsError=b;function w(e){return e instanceof a.ItemOperationError&&!!a.noRegisteredHandlerErrorFacet.unpack(e.facets)}function E(e,t){for(var n=void 0,r=function(t,r,i,u){for(var a=u,f=0,l=[],c=[],p=0,d=e;p<d.length;p++){var v=d[p],m=v.itemKey,g=v.startSignal,y=v.completeSignal,b=v.options;if(t===m){f++;var w=a;a=s.subtract(a,b);if(!s.isSubset(a,w)){c.push(y.promise);l.push(g.promise)}}}var E=a.demands;if(E&&Object.keys(E).length>0||0===f){n||(n=e.slice());var S=new o.Signal,x=new o.Signal;x.promise.then(S.resolve,S.reject);l.push(S.promise);c.push(x.promise);n.push({itemKey:t,startSignal:S,completeSignal:x,options:a})}Promise.race(l).then(function(){return r.resolve()},r.reject);h.waitForAll(c).then(function(){return i.resolve()},i.reject)},i=0,u=t;i<u.length;i++){var a=u[i];r(a.itemKey,a.startSignal,a.completeSignal,a.options)}return n||e}function S(e){var t=e.items,r=e.resolution;return function(e){e(function(e){return function(t){t(x).updateItems(e)}}({items:e(l.readItems(function(e){var s={},o=function(o){if(Object.prototype.hasOwnProperty.call(t,o)){var a=t[o].demands,l=e.demandItemFacet(f.resolvedFacet,o),c=i.mapObject(a,function(){return r},function(e){return l&&l[e]&&"unhandled"!==l[e]?void 0:e});s[o]=n.__assign({},f.resolvedFacet.pack(n.__assign({},u.pack({},{}),c)))}};for(var a in t)o(a);return s}))}))}}var x=c.asOnceOnly(function(e){var t,n=new g.ItemResolver;function r(){var r=n;n=new g.ItemResolver;t=void 0;e(r.execute())}return{resolveItems:function(e){n.resolveItems(e);t||(t=setTimeout(r,0))},updateItems:function(e){n.updateItems(e);t||(t=setTimeout(r,0))},flush:function(){if(t){clearTimeout(t);r()}}}});t.getItems=r.createAsyncActionCreator(function(e){return function(t){return n.__awaiter(y,void 0,void 0,function(){var r,i,s,o,u,f,c;return n.__generator(this,function(h){switch(h.label){case 0:t(x).flush();r=t(l.readItems(function(t){return v.excludeResolvedDemands(t,e)})).items;if(!(Object.keys(r).length>0))return[3,5];i=t(a.startOperation({operationTypeFacet:p.getItemsOperation,enqueueOperations:E,items:r})),s=i.started,o=i.completed,u=i.items;for(f in u)Object.prototype.hasOwnProperty.call(u,f)&&t(T(n.__assign({itemKey:f,options:r[f]},u[f])));h.label=1;case 1:h.trys.push([1,4,,5]);return[4,s];case 2:h.sent();return[4,o];case 3:h.sent();return[3,5];case 4:if(w(c=h.sent()))return[2];throw c;case 5:return[2]}})})}});function T(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,s,o,u;return n.__generator(this,function(l){switch(l.label){case 0:l.trys.push([0,3,,4]);return[4,e.started];case 1:l.sent();return[4,e.completed];case 2:l.sent();r(S({items:(t={},t[e.itemKey]=e.options,t),resolution:"unsupported"}));return[3,4];case 3:o=l.sent();(u=w(o))||r(function(e){return function(t){t(x).resolveItems(e)}}({items:(i={},i[e.itemKey]=n.__assign({},f.errorFacet.pack(o instanceof a.ItemOperationError?o:new b({innerError:o}))),i)}));r(S({items:(s={},s[e.itemKey]=e.options,s),resolution:u?"unhandled":"failed"}));return[3,4];case 4:return[2]}})})}}var N=c.asOnceOnly(function(e){var n,r=e(m.getItemCacheEvaluator),s={items:{}};function o(){var i=s;s={items:{}};n=void 0;r.publishComputedFacets();e(t.getItems(i)).catch(function(){})}return function(e){for(var t in e.items)if(Object.prototype.hasOwnProperty.call(e.items,t)){var r=e.items[t],a=s.items[t]||(s.items[t]={demands:u.pack({},{})});i.assign(a.demands,r.demands)}n||(n=setTimeout(o,0))}});t.batchedGetItems=function(e){return function(t){t(N)(e)}}});
define("@ms/items-view/lib/private/store/actions/implementOperation",["require","exports","tslib","../reducers/operationMapReducer","../reducers/itemCacheReducer","../../utilities/Graft","../../models/Facet","../../models/KeyFacet","../../utilities/async/Signal","../../facets/OperationFacets","./createActionCreator","../enhancers/NextStoreUpdateEnhancer","../../utilities/async/CancelError","../../utilities/async/all","@ms/utilities-error/lib/ApiError"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getOperationTypeKey=r.getOperationTypeKey;t.editQueue=r.editQueue;t.STATUS_CODE_ZERO=0;var v=function(e){n.__extends(t,e);function t(n){var r=e.call(this,n)||this,i=n.innerError,s=i instanceof t?i:void 0,u=s?{facets:s.facets}:{},a=n.facets,f=void 0===a?u.facets:a;r.facets=f||o.pack({},{});return r}return t}(d.ApiError);t.ItemOperationError=v;t.noRegisteredHandlerErrorFacet=new o.Facet("noRegisteredHandlerError");function m(e){return function(t,n){return n().operationMap.operations[e.key]}}t.getOperationState=m;function g(e){var i=e.items,o=e.enqueueOperations;return function(u,f){var l=f(),c={},h={},d=[],g=[],y={};for(var E in i)if(E&&Object.prototype.hasOwnProperty.call(i,E)){var S=w(l,E),x=S.preferredItemKey,T=S.keyFacet;if((D=(_=r.getOperationTypeKey({operationTypeFacet:e.operationTypeFacet,keyFacet:T}))in h?h[_]:h[_]=u(m({key:_})))&&D.operator){var N=c[_];N||(N=c[_]=[]);var C=new a.Signal,k=new a.Signal;k.promise.then(C.resolve,C.reject);y[E]={started:C.promise,completed:k.promise};d.push(C.promise);g.push(k.promise);N.push({itemKey:x,startSignal:C,completeSignal:k,options:i[E]})}else{var L=Promise.resolve(void 0),A=Promise.reject(new v({message:"There is no operation handler registered for '"+_+"'.",facets:n.__assign({},t.noRegisteredHandlerErrorFacet.pack(_))}));y[E]={started:L,completed:A};d.push(L);g.push(A)}}for(var O=0,M=Object.keys(c);O<M.length;O++){var _,D=u(m({key:_=M[O]})),P=o?o(D&&D.queue||[],c[_]):new s.ArrayConcatPatch(c[_]);u(r.editQueue({key:_,queue:P}));u(b({key:_}))}return{started:Promise.race(d).then(function(){}),completed:p.waitForAll(g).then(function(){}),items:y}}}t.startOperation=g;t.cancelOperation=function(e){var t=this,i=e.operationTypeFacet,s=e.items;return function(e,o){return n.__awaiter(t,void 0,void 0,function(){var t,u,a,f,l,p,d,v,m,g,b,E,S;return n.__generator(this,function(n){switch(n.label){case 0:t=[];u={};a=o();for(f in s)if(Object.prototype.hasOwnProperty.call(s,f)){l=w(a,f),p=l.keyFacet,d=l.preferredItemKey;m=r.getOperationTypeKey({operationTypeFacet:i,keyFacet:p});v=u[m]||(u[m]={items:{}});(v.items[d]||(v.items[d]=[])).push(s[f])}for(m in u)if(Object.prototype.hasOwnProperty.call(u,m)){b=e(y({key:g=m,items:u[g].items})).completeSignals;t.push.apply(t,b)}return[4,e(c.waitForNextStoreUpdate())];case 1:n.sent();for(E=0,S=t;E<S.length;E++)S[E].reject(new h.CancelError);return[2]}})})}};function y(e){var t=e.key,n=e.items;return function(e){var i=[],o=e(m({key:t}));if(o){var u=o.queue;if(u&&u.length){for(var a=void 0,f=0,l=u.length;f<l;f++){var c=u[f],h=c.itemKey,p=c.options,d=n[h];if(d)for(var v=0,g=d;v<g.length;v++){var y=g[v];p=s.subtract(p,y)}if(d&&0===Object.keys(p).length){a||(a=u.slice(0,f));i.push(c.completeSignal)}else a&&a.push(c)}a&&e(r.editQueue({key:t,queue:a}))}}return{completeSignals:i}}}t.cleanupOperationQueue=y;function b(e){var t=e.key;return function(e){var n=e(m({key:t}));if(n){var r=n.operator;r&&r()}}}t.processOperation=b;t.implementOperation=function(e){var t=this,r=e.operationTypeFacet,i=e.enqueueOperations;return l.createAsyncActionCreator(function(e){return function(s){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,s(g({operationTypeFacet:r,items:e.items,enqueueOperations:i})).completed];case 1:t.sent();return[2]}})})}})};function w(e,t){var n=i.getCacheItem(e,t),r=n&&f.preferredKeyFacetFacet.unpack(n),s=n&&r&&r.unpack(n);return{preferredItemKey:s&&r&&r.serialize(s)||t,keyFacet:s&&r||u.KeyFacet.get(t)}}});
define("@ms/items-view/lib/private/facets/OperationFacets",["require","exports","../models/Facet","../models/KeyFacet","../utilities/Memoizer"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=new r.KeyFacet("keyFacet",{keyFacetId:r.stringPart()});t.getKeyFacetItemKey=i.createMemoizer(function(e){return s.serialize({keyFacetId:e.id})});t.isKeyFacetItemKey=function(e){return s.matches(e)};t.computedFacetSelectorsKeyFacet=new r.KeyFacet("computedFacetSelectors",{itemKey:r.stringPart()});t.supportedFacetsFacet=new n.Facet("supportedFacets");t.controlHandlersFacet=new n.Facet("controlHandlers");t.computedFacetSelectorsFacet=new n.Facet("computedFacetSelectors");t.preferredKeyFacetFacet=new n.Facet("preferredKeyFacet");t.operationQueueOperationsFacet=new n.Facet("operationQueueOperations");t.operationQueueHandlerFacet=new n.Facet("operationQueueHandler");t.registeredOperationHandlersFacet=new n.Facet("registeredOperationHandlers");t.operationHandlerConfigurationFacet=new n.Facet("operationHandlerConfiguration")});
define("@ms/items-view/lib/private/utilities/Memoizer",["require","exports","./objects"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createMemoizer=function(e){var t=new WeakMap;return function(n){if(t.has(n))return t.get(n);var r=e(n);t.set(n,r);return r}};var r=function(){function e(){this._lastInvocations=new WeakMap}e.prototype.evaluate=function(e){var t=this._lastInvocations;return function(r){var i=t.get(e);if(!i||!n.areShallowEqual(i.props,r)){var s=e(r);t.set(e,{props:r,result:s});return s}return i.result}};return e}();t.Memoizer=r});
define("@ms/items-view/lib/private/utilities/async/CancelError",["require","exports","tslib","@ms/utilities-async/lib/cancel/CancelError"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/utilities-async/lib/cancel/CancelError",["require","exports","tslib","@ms/utilities-error/lib/index","../signal/Signal"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={message:"Canceled"});var n=e.call(this,t)||this;n.name="Canceled";return n}return t}(r.CustomError);t.CancelError=s;t.isCancel=function(e){return e instanceof s};var o=function(e){var t,n=e.catch(function(e){t=e;return Promise.reject(e)});this.subscribe=function(e){var t=e;n.then(function(){t=void 0},function(e){if(t){var n=t;t=void 0;n(e)}});return function(){t=void 0}};this.isCanceled=function(){return!!t};this.throwIfCanceled=function(){if(t)throw new s(t)}};t.CancelToken=o;var u=function(){var e=new i.Signal,t=e.reject,n=e.resolve,r=e.promise;this.cancel=function(e){return t(new s(e))};this.dispose=function(){return n()};this.token=new o(r)};t.CancelSource=u;t.raceWithCancel=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var r,s,o=this;return n.__generator(this,function(u){switch(u.label){case 0:return t?[3,2]:[4,e];case 1:return[2,u.sent()];case 2:r=new i.Signal;s=t.subscribe(function(e){r.reject(e)});n.__awaiter(o,void 0,void 0,function(){var t,i,o;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,3,4]);i=(t=r).resolve;return[4,e];case 1:i.apply(t,[n.sent()]);return[3,4];case 2:o=n.sent();r.reject(o);return[3,4];case 3:s();return[7];case 4:return[2]}})});return[4,r.promise];case 3:return[2,u.sent()]}})})}});
define("@ms/utilities-error/lib/index",["require","exports","./CustomError","./ApiError","./ModuleLoadError"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CustomError=n.CustomError;t.ApiError=r.ApiError;t.ModuleLoadError=i.ModuleLoadError});
define("@ms/utilities-error/lib/ModuleLoadError",["require","exports","tslib","./ApiError"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.chunkName=t.chunkName;return n}return t}(r.ApiError);t.ModuleLoadError=i});
define("@ms/items-view/lib/private/utilities/async/all",["require","exports","tslib","./CancelError"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.waitForAll=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,i,s,o,u,a,f=this;return n.__generator(this,function(l){switch(l.label){case 0:return[4,Promise.all(e.map(function(e){return n.__awaiter(f,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);return[4,e];case 1:t.sent();return[3,3];case 2:return[2,t.sent()];case 3:return[2]}})})}))];case 1:t=l.sent();i=[];s=!0;for(o=0,u=t;o<u.length;o++)if(a=u[o]){r.isCancel(a)||(s=!1);i.push(a)}else s=!1;if(i.length>0)throw s?new r.CancelError:i[0];return[2]}})})}});
define("@ms/items-view/lib/private/facets/DemandFacets",["require","exports","../models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.errorFacet=new n.Facet("error");!function(e){e.unresolved="";e.resolved="resolved";e.failed="failed";e.unhandled="unhandled";e.unsupported="unsupported"}(t.DemandResolution||(t.DemandResolution={}));t.resolvedFacet=new n.Facet("resolved");t.invalidationFacet=new n.Facet("invalidation")});
define("@ms/items-view/lib/private/operations/readItems",["require","exports","../models/itemCache/ItemCacheEvaluator","../models/controls/ControlFacet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.readItems=function(e){return function(t,i){return t(n.getItemCacheEvaluator).evaluate({selector:e,controlHandlers:r.NO_CONTROL_HANDLERS,state:i(),owner:{}}).result}}});
define("@ms/items-view/lib/private/models/itemCache/ItemCacheEvaluator",["require","exports","tslib","./ItemCacheObserver","../../controls/itemCacheSuspenseControl","../../store/middleware/RunOnceMiddleware","./excludeResolvedDemands","@ms/utilities-objects/lib/index","./bindItemCacheSelectorToProps","../../store/reducers/itemMapReducer","../../facets/OperationFacets"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e){this._debug=e}e.prototype.toString=function(){return JSON.stringify(this._debug)};e.prototype.dispose=function(){};return e}(),h=function(){function e(e){this._dispatch=e;this._selectorEvaluations=new WeakMap;this._suspenderEvaluations=new WeakMap;this._selectors=u.createFastMap()}e.prototype.evaluate=function(e){var t=e.selector,s=e.controlHandlers,a=e.state,f=e.owner,l=e.suspender,h=this._getSelectorEvaluationState(t),p=l?this._getSuspenderEvaluationState(t,l):void 0,d=p?p.selector:void 0,v=t!==d&&{previous:d,current:t},m=h.controlHandlers,g=u.areShallowDifferent(s,m,{debug:!0});if(g){h.previousEvaluation=void 0;h.controlHandlers=s}else{var y=h.evaluationsPerState.get(a);if(y){p&&(p.previousEvaluation=y);return y}}var b=h.previousEvaluation,w=p&&p.previousEvaluation,E=b||p&&p.previousEvaluation,S=w&&w.demands,x=new r.ItemCacheObserver({controlHandlers:s,dispatch:this._dispatch,owner:f,previousDemands:b&&b.demands,previousDependencies:b&&b.dependencies,state:a,evaluator:this});try{var T=void 0;if(!b||(T=x.haveDependenciesChanged())){var N=l?x.demandItemFacet(i.itemCacheSuspenseControl,void 0):void 0,C=i.itemCacheSuspenseControl.evaluate(N)(x,{}),k=C.mode,L=void 0===k?"none":k,A=C.getItems;if(E&&("debounce"===L||"freeze"===L)&&("debounce"!==L||S&&o.hasUnresolvedDemands(x,{items:S})))E=n.__assign({},E,{demands:n.__assign({},S||{})});else{var O=new c({haveControlHandlersChanged:g,hasSelectorChanged:v,haveDependenciesChanged:T,owner:f});E={result:x.evaluate(t).result,dependencies:x.getDependencies(),demands:x.getDemands()};h.previousEvaluation=E;h.evaluationsPerState.set(a,E);O.dispose();if("wait"===L){var M={items:E.demands};if(A&&o.hasUnresolvedDemands(x,M))throw A(M)}}}else{h.evaluationsPerState.set(a,b);E=b}}finally{x.dispose();if(p){p.previousEvaluation=E;p.selector=t}}return E};e.prototype.getComputedFacetSelector=function(e){var t=e.computedItemFacet,n=e.itemKey,r=this._selectors,i=r.get(n||"")||function(){var e=u.createFastMap();r.set(n||"",e);return e}(),s=t.id;return i.get(s)||function(){var e=a.bindItemCacheSelectorToProps(t.compute,{itemKey:n});i.set(s,e);return e}()};e.prototype.publishComputedFacets=function(){var e=this._selectors;this._selectors=u.createFastMap();var t={};e.some(function(e,n){var r={};e.some(function(e,t){r[t]=e});var i=l.computedFacetSelectorsKeyFacet.serialize({itemKey:n});t[i]=l.computedFacetSelectorsFacet.pack(r)});this._dispatch(f.updateItems({items:t}))};e.prototype._getSelectorEvaluationState=function(e){var t=this._selectorEvaluations,n=t.get(e);if(!n){n={evaluationsPerState:new WeakMap};t.set(e,n)}return n};e.prototype._getSuspenderEvaluationState=function(e,t){var n=this._suspenderEvaluations,r=n.get(t);if(!r){r={selector:e};n.set(t,r)}return r};return e}();t.getItemCacheEvaluator=s.asOnceOnly(function(e){return new h(e)})});
define("@ms/items-view/lib/private/models/itemCache/ItemCacheObserver",["require","exports","../../operations/getItemsOperation","../../store/reducers/itemCacheReducer","../../facets/DemandFacets","../../utilities/objects","../../facets/OperationFacets","../KeyFacet","./ComputedItemFacet","../controls/ControlFacet","@ms/utilities-objects/lib/is","@ms/utilities-objects/lib/fastMap/fastMap","../../utilities/Memoizer","./bindItemCacheSelectorToProps","./excludeResolvedDemands"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v,m,g="The IItemCache instance may only be used within an invocation of `mapItemCacheToProps` passed to`connectToItemCache`.",y=((v={})[o.preferredKeyFacetFacet.id]=!0,v[i.resolvedFacet.id]=!0,v[o.supportedFacetsFacet.id]=!0,v[o.controlHandlersFacet.id]=!0,v[o.registeredOperationHandlersFacet.id]=!0,v),b=((m={})[i.resolvedFacet.id]=!0,m[o.supportedFacetsFacet.id]=!0,m[o.controlHandlersFacet.id]=!0,m[o.registeredOperationHandlersFacet.id]=!0,m),w=h.createMemoizer(function(e){var t=c.createFastMap(),i=h.createMemoizer(function(t){var i=o.getKeyFacetItemKey(t),s=r.getCacheItem(e,i),u=s&&o.controlHandlersFacet.unpack(s),a=s&&o.supportedFacetsFacet.unpack(s),f=s&&o.registeredOperationHandlersFacet.unpack(s);return{keyFacetItemKey:i,controlHandlers:u,isOperationHandlerRegistered:f&&f[n.getItemsOperation.id],supportedFacets:a}});return function(n){var s=t.get(n||"");if(s)return s;var a=n&&r.getCacheItem(e,n)||void 0;if(o.isKeyFacetItemKey(n)||o.computedFacetSelectorsKeyFacet.matches(n))s={item:a,computedFacetSelectorsData:void 0,preferredKeyFacet:void 0,keyFacetData:void 0};else{var f=a&&o.preferredKeyFacetFacet.unpack(a),l=f||n&&u.KeyFacet.get(n)||void 0,c=l&&i(l),h=o.computedFacetSelectorsKeyFacet.serialize({itemKey:n||""}),p=r.getCacheItem(e,h);s={item:a,computedFacetSelectorsData:{itemKey:h,computedFacetSelectors:p&&o.computedFacetSelectorsFacet.unpack(p)},preferredKeyFacet:f,keyFacetData:c}}t.set(n||"",s);return s}}),E=function(){function e(e){var t=e.dispatch,n=e.state,r=this._scope={isDisposed:!1};this._getItemData=w(n);this._state=n;this._previousDemands=e.previousDemands;this._previousDependencies=e.previousDependencies;this._controlHandlers=e.controlHandlers||f.NO_CONTROL_HANDLERS;this._owner=e.owner||{};this._evaluator=e.evaluator;this._entries=c.createFastMap();this._dispatch=function(e){if(!r.isDisposed)throw new Error("Attempted to invoke the store dispatch within a callback to an IItemCache. This could disrupt the ability to track dependencies and cause unwanted cascading updates. Instead, hold onto dispatch in a local variable and invoke it in an asynchronous callback, such as an event handler, or simply return it from the selector before using it.");return t(e)}}Object.defineProperty(e.prototype,"dispatch",{get:function(){if(this._scope.isDisposed)throw new Error("Attempted to access the store dispatch on an ItemCache outside of its completed callback. This can cause a memory leak because an ItemCache holds onto stale store state. To obtain the store dispatch, access it during the callback and store it in a local variable.");return this._dispatch},enumerable:!0,configurable:!0});e.prototype.evaluate=function(e){return{result:e(this)}};e.prototype.demandItem=function(e,t){if(this._scope.isDisposed)throw new Error(g);for(var n={},r=0,i=Object.keys(e);r<i.length;r++){var s=i[r],o=e[s];if(!o)throw new Error("Mapping '"+s+"' was not passed a valid Facet or IFacet instance in demandItem.");n[s]=this.demandItemFacet(o,t)}return n};e.prototype.demandItemFacet=function(e,t){if(this._scope.isDisposed)throw new Error(g);var n=this._addEntry(t);if(n.itemData.computedFacetSelectorsData){if(e instanceof f.ControlFacet)return this._addControl(n,t,e);if(e instanceof a.ComputedItemFacet)return this._addComputedValue(n,t,e)}if(t){y[e.id]||this._addResolution(n,e);var r=this._addValue(n,t,e);return!r&&e instanceof u.KeyFacet&&e.matches(t)?e.deserialize(t):r}};e.prototype.isItemFacetResolved=function(e,t){if(this._scope.isDisposed)throw new Error(g);if(!t)return!1;if(y[e.id])return!1;var n=this._addEntry(t);return e instanceof a.ComputedItemFacet?this._addComputedResolution(n,t,e):"resolved"===this._addResolution(n,e)};e.prototype.haveDependenciesChanged=function(){var e,t,n,r,s,u=this._previousDependencies;if(!u)return!0;for(var a in u)if(Object.prototype.hasOwnProperty.call(u,a)){var f=u[a],l=this._getItemData(a),c=l.item;if(l.computedFacetSelectorsData){var h=S(f,c,function(e,t,n){return n===i.resolvedFacet.id?S(e,t,O):x(e,t)});if(h)return(s={})[a]=h,s}else{var p=o.controlHandlersFacet.unpack(f),d=c&&o.controlHandlersFacet.unpack(c),v=!!p&&S(p,d,x);if(v)return(e={})[a]=((t={})[o.controlHandlersFacet.id]=v,t),e;var m=o.registeredOperationHandlersFacet.unpack(f),g=c&&o.registeredOperationHandlersFacet.unpack(c),y=!!m&&S(m,g,x);if(y)return(n={})[a]=((r={})[o.registeredOperationHandlersFacet.id]=y,r),n}}return!1};e.prototype.dispose=function(){this._scope.isDisposed=!0};e.prototype.getDemands=function(){var e=this._entries,t={};e.some(function(e,n){if(n&&e&&e.demands){var r={};e.demands.some(function(e,t){r[t]=e});t[n]={demands:r}}});var n=this._previousDemands;return n?!s.areShallowEqual(t,n,A)?t:n:t};e.prototype.getDependencies=function(){var e=this._entries,t={};e.some(function(e,n){if(n&&e&&e.dependencies){var r={};e.dependencies.some(function(e,t){r[t]=e});t[n]=r}});var n=this._previousDependencies;return n?!s.areShallowEqual(t,n,k)?t:n:t};e.prototype._addEntry=function(e){var t=this._entries,n=t.get(e||"");if(n)return n;var r=this._getItemData(e);n={itemData:r,computedResolutions:c.createFastMap(),computedValues:c.createFastMap(),controls:c.createFastMap(),keyFacetEntry:r.keyFacetData?this._addEntry(r.keyFacetData.keyFacetItemKey):void 0,computedFacetSelectorsEntry:r.computedFacetSelectorsData?this._addEntry(r.computedFacetSelectorsData.itemKey):void 0,demands:void 0,dependencies:void 0};t.set(e||"",n);return n};e.prototype._addComputedValue=function(e,t,n){var r=e.computedValues,i=n.id;if(r.has(i))return r.get(i);var s=this._addComputation(e,t,n);if(s){var o=s.result,u=s.demands,a=s.dependencies;this._mergeDemands(u);this._mergeDependencies(a);r.set(i,o);return o}var f=p.bindItemCacheSelectorToProps(n.compute,{itemKey:t}),l=this.evaluate(f).result;r.set(i,l);return l};e.prototype._addComputedResolution=function(e,t,n){var r=e.computedResolutions,i=n.id;if(r.has(i))return r.get(i);var s=this._addComputation(e,t,n);if(s){var o=s.demands,u=s.dependencies,a=!d.hasUnresolvedDemands(this,{items:o});this._mergeDependencies(u);r.set(i,a);return a}return!1};e.prototype._addComputation=function(e,t,n){var r=e.itemData.computedFacetSelectorsData,i=this._evaluator;if(r&&i){var s=r.computedFacetSelectors,o=s&&s[n.id]||i.getComputedFacetSelector({computedItemFacet:n,itemKey:t,state:this._state});return i.evaluate({controlHandlers:this._controlHandlers,owner:this._owner,selector:o,state:this._state})}};e.prototype._addControl=function(e,t,n){var r,i=e.controls,s=n.id;if(i.has(s))return i.get(s);var u=e.itemData.keyFacetData,a=u&&u.controlHandlers;r=a&&n.unpack(a);var f=e.keyFacetEntry;f&&T(f,o.controlHandlersFacet.id,n.pack(r));T(e,o.preferredKeyFacetFacet.id,e.itemData.preferredKeyFacet);var l=n.unpack(this._controlHandlers),c=n.compose(r,l);i.set(s,c);return c};e.prototype._addValue=function(e,t,r){var i,s=r.id,u=e.itemData.item,a=u&&u[s];if(e.itemData.keyFacetData){b[s]||T(e,s,a);y[s]||N(e,s);var f=e.keyFacetEntry;if(f){T(e,o.preferredKeyFacetFacet.id,e.itemData.preferredKeyFacet);T(f,o.registeredOperationHandlersFacet.id,((i={})[n.getItemsOperation.id]=e.itemData.keyFacetData.isOperationHandlerRegistered,i))}}return a};e.prototype._addResolution=function(e,t){var n,r=e.itemData,s=r&&r.item,o=s&&i.resolvedFacet.unpack(s),u=t.id,a=o&&o[u];T(e,i.resolvedFacet.id,((n={})[u]=a,n));return a};e.prototype._mergeDemands=function(e){for(var t=0,n=Object.keys(e);t<n.length;t++)for(var r=n[t],i=this._addEntry(r),s=e[r].demands,o=0,u=Object.keys(s);o<u.length;o++){N(i,u[o])}};e.prototype._mergeDependencies=function(e){for(var t=0,n=Object.keys(e);t<n.length;t++)for(var r=n[t],i=this._addEntry(r),s=e[r],o=0,u=Object.keys(s);o<u.length;o++){var a=u[o];T(i,a,s[a])}};return e}();t.ItemCacheObserver=E;function S(e,t,n){var r;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var s=e[i],o=t&&t[i];if(n(s,o,i))return(r={})[i]={previous:s,current:o},r}return!1}function x(e,t){return!l.is(e,t)&&{previous:e,current:t}}function T(e,t,n){var r=e.dependencies||(e.dependencies=c.createFastMap());if(t===i.resolvedFacet.id||t===o.controlHandlersFacet.id||t===o.registeredOperationHandlersFacet.id){var u=r.get(t);u?s.assign(u,n):r.set(t,n)}else r.set(t,n)}function N(e,t){var n=e.demands;(n||(e.demands=c.createFastMap())).set(t,!0);return!n}function C(e){return"resolved"===e?"resolved":""}function k(e,t){return s.areShallowEqual(e,t,L)}function L(e,t,n){return n===i.resolvedFacet.id?s.areShallowEqual(e,t):l.is(e,t)}function A(e,t){return s.areShallowEqual(e.demands,t.demands)}function O(e,t){return C(e)!==C(t)}});
define("@ms/items-view/lib/private/operations/getItemsOperation",["require","exports","../models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getItemsOperation=new n.Facet("getItems")});
define("@ms/items-view/lib/private/models/itemCache/ComputedItemFacet",["require","exports","tslib","../Facet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r.compute=n;return r}return t}(r.Facet);t.ComputedItemFacet=i});
define("@ms/items-view/lib/private/models/controls/ControlFacet",["require","exports","tslib","../Facet","../../utilities/Memoizer"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NO_CONTROL_HANDLERS=r.pack({},{});var s=function(e){n.__extends(t,e);function t(t,r){void 0===r&&(r={});var s=e.call(this,t)||this;s._reducer=function(e,t){return t&&e&&s._memoizer(t)(e)||t||e};s._memoizer=function(e){return i.createMemoizer(function(t){return i.createMemoizer(function(r){function i(i,s){var o=r(i,s),u=t(i,n.__assign({},s,o)),a={};for(var f in u)if(Object.prototype.hasOwnProperty.call(u,f)){var l=e[f];a[f]=l&&f in o?l.merge(o[f],u[f]):u[f]}return n.__assign({},o,a)}i.previous=r;i.current=t;return i})})}(r);return s}Object.defineProperty(t.prototype,"default",{get:function(){return u},enumerable:!0,configurable:!0});t.get=function(e){return r.Facet.get(e)};t.prototype.compose=function(e,t){return this._reducer(e,t)};t.prototype.evaluate=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=e.length>0&&this._reducer(a,e.reduce(this._reducer))||u;function i(e,t){var i=r(e,t);return n.__assign({},t,i)}i.handler=r;return i};return t}(r.Facet);t.ControlFacet=s;var o={};function u(){return o}t.defaultControlHandler=u;function a(e,t){return t}t.childControlOption=function(e){return{merge:function(t,n){return e.compose(t,n)}}}});
define("@ms/utilities-objects/lib/fastMap/fastMap",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(){try{var e=new Map([[2,3]]);if(e===e.set(1,1)&&3===e.get(2))return!0}catch(e){}return!1}t.shouldUseMap=n;var r=function(){function e(e){this.map=e||new Map}e.prototype.get=function(e){return this.map.get(e)};e.prototype.has=function(e){return this.map.has(e)};e.prototype.set=function(e,t){this.map.set(e,t);return this};e.prototype.clear=function(){this.map.clear()};e.prototype.keys=function(){return Array.from(this.map.keys())};e.prototype.some=function(e){for(var t=this.map.entries(),n=t.next();!n.done;n=t.next()){var r=n.value,i=e(r[1],r[0]);if(i)return i}return!1};e.prototype.size=function(){return this.map.size};e.prototype.toString=function(){return this.map.toString()};return e}(),i=function(){function e(e){this.map=e}e.prototype.some=function(e){for(var t=0,n=this.map;t<n.length;t++){var r=n[t],i=e(r[1],r[0]);if(i)return i}return!1};return e}(),s=function(){function e(e){this.map=e||Object.create(null);this._keys=e?void 0:[]}e.prototype.get=function(e){return this.map[e]};e.prototype.has=function(e){return e in this.map};e.prototype.set=function(e,t){this.map[e]=t;this._keys=void 0;return this};e.prototype.clear=function(){this.map={};this._keys=[]};e.prototype.keys=function(){return this._keys||(this._keys=Object.keys(this.map))};e.prototype.some=function(e){if(this._keys){for(var t=0,n=this.keys();t<n.length;t++){var r=n[t];if(i=e(this.map[r],r))return i}return!1}for(var r in this.map)if(Object.prototype.hasOwnProperty.call(this.map,r)){var i;if(i=e(this.map[r],r))return i}return!1};e.prototype.size=function(){return this.keys().length};e.prototype.toString=function(){return JSON.stringify(this.map)};return e}(),o=n();t.iterableFromData=function(e){return Array.isArray(e)?new i(e):e instanceof Map?new r(e):function(e){return!(!e||Array.isArray(e)||!e.map||!e.some)}(e)?e:new s(e)};t.createFastMap=function(e){void 0===e&&(e=o);return e?new r:new s}});
define("@ms/items-view/lib/private/models/itemCache/bindItemCacheSelectorToProps",["require","exports","../../utilities/objects"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.bindItemCacheSelectorToProps=function(e,t){function r(n){return e(n,t)}n.assign(r,{selector:e,props:t});return r}});
define("@ms/items-view/lib/private/models/itemCache/excludeResolvedDemands",["require","exports","../../operations/getItemsOperation","../../facets/DemandFacets","../../facets/OperationFacets","../KeyFacet"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={items:{}};t.hasUnresolvedDemands=function(e,t){var n=u(e,t,!0);return n!==o&&n};t.excludeResolvedDemands=function(e,t){return u(e,t,!1)};function u(e,t,n){for(var u,l,c=t.items,h=!1,p=!0,d={},v=0,m=Object.keys(c);v<m.length;v++){var g=m[v];if(i.isKeyFacetItemKey(g)){h=!0;p=!1}else{for(var y=e.demandItemFacet(r.resolvedFacet,g),b=e.demandItemFacet(i.preferredKeyFacetFacet,g)||s.KeyFacet.get(g),w=c[g].demands,E=!1,S=!0,x={},T=0,N=Object.keys(w);T<N.length;T++){var C=N[T];if(C!==r.resolvedFacet.id&&C!==i.preferredKeyFacetFacet.id&&a(e,C,y,b)&&f(e,C,b)){if(n)return{items:(u={},u[g]={demands:(l={},l[C]=!0,l)},u)};E=!0;x[C]=!0}else S=!1}if(E){h=!0;d[g]=S?c[g]:{demands:x}}else p=!1}}return n||!h?o:p?t:{items:d}}function a(e,t,r,s){var o=i.getKeyFacetItemKey(s),u=r&&r[t];if(!u)return!0;if("unhandled"!==u)return!1;var a=e.demandItemFacet(i.registeredOperationHandlersFacet,o);return!!a&&!!a[n.getItemsOperation.id]}function f(e,t,n){var r=i.getKeyFacetItemKey(n),s=e.demandItemFacet(i.supportedFacetsFacet,r);return!s||!!s.demands[t]}});
define("@ms/items-view/lib/private/controls/itemCacheSuspenseControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemCacheSuspenseControl=new n.ControlFacet("itemCacheSuspense")});
define("@ms/utilities-objects/lib/index",["require","exports","tslib","./areShallowEqual","./assign","./deepCompare","./deepCopy","./fastMap/fastMap","./is","./safeSerialize"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t);n.__exportStar(f,t)});
define("@ms/items-view/lib/private/operations/resolveItems",["require","exports","tslib","../store/actions/implementOperation","./getItemsOperation","../utilities/Graft","../models/Facet","../utilities/objects","../facets/DemandFacets","../facets/OperationFacets","../models/KeyFacet","./pruneItems","../store/reducers/itemMapReducer","../store/actions/createActionCreator","./processBatchWithEffects","../store/reducers/itemCacheReducer"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.supportFacets=function(e){var t=e.keyFacet,s=e.facets,a=f.getKeyFacetItemKey(t),l=r.getOperationTypeKey({operationTypeFacet:i.getItemsOperation,keyFacet:t}),p=n.__assign({},o.pack({},{}),u.makeObject(s.map(function(e){return e.id}),function(){return!0}));return function(e){var t,i;e(c.registerPermanentItemDemands({items:(t={},t[a]={},t)}));e(h.updateItems({items:(i={},i[a]=n.__assign({},f.supportedFacetsFacet.pack({demands:p})),i)}));var s=e(r.getOperationState({key:l})),o=s&&s.queue;if(o&&o.length>0){var d=function(e,t){for(var r=void 0,i=[],s=0,o=e.length;s<o;s++){var a=e[0],f=a.completeSignal,l=a.options.demands,c=void 0,h=u.pickObject(l,t);h!==l&&(c=n.__assign({},a,{options:n.__assign({},a.options,{demands:h})}));if(c){r||(r=e.slice(0,s));Object.keys(c.options.demands).length>0?r.push(c):i.push(f)}else r&&r.push(a)}return{newQueue:r||e,workToComplete:i}}(o,p),v=d.newQueue,m=d.workToComplete;e(r.editQueue({key:l,queue:v}));for(var g=0,y=m;g<y.length;g++){y[g].resolve()}}}};var m=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this)||this;r._completedOperation=t;r._updateCompleteSignals=n;return r}t.prototype.apply=function(e){if(e){var t=function(e,t){for(var r=void 0,i=[],o=0,u=e.length;o<u;o++){var a=e[o],f=a.itemKey,l=a.completeSignal,c=a.options,h=t.items[f],p=void 0;if(h&&(p=s.subtract(c,h))&&!s.isSubset(p,c)){r||(r=e.slice(0,o));Object.keys(p).length>0&&Object.keys(p.demands).length>0?r.push(n.__assign({},a,{options:p})):i.push(l)}else r&&r.push(a)}return{newQueue:r||e,workToComplete:i}}(e,this._completedOperation),r=t.newQueue,i=t.workToComplete;this._updateCompleteSignals(i);return r}};return t}(s.Patch);t.resolveItemsForBatch=p.createAsyncActionCreator(function(e){var t,f,c=e.items,p={},d={};for(var g in c)if(Object.prototype.hasOwnProperty.call(c,g)){var y=l.KeyFacet.get(g),b=r.getOperationTypeKey({operationTypeFacet:i.getItemsOperation,keyFacet:y}),w=c[g],E={demands:w&&"object"==typeof w?u.mapObject(w,function(){return!0}):o.pack({},{})};d[g]=n.__assign(((t={})[y.id]=new s.DefaultPatch(y.deserialize(g)),t),a.resolvedFacet.pack(n.__assign(((f={})[y.id]="resolved",f),u.mapObject(E.demands,function(){return"resolved"}))));var S=p[b];S||(p[b]=S={items:{}});S.items[g]=E}var x=[];return function(){return{action:v.processBatch({actions:[h.updateItems({items:d}),h.updateItems(e)].concat(Object.keys(p).map(function(e){var t=p[e];return r.editQueue({key:e,queue:new m(t,function(e){x.push.apply(x,e)})})}))}),effect:function(){for(var e=0,t=x;e<t.length;e++){t[e].resolve()}}}}});t.resolveItems=p.createAsyncActionCreator(function(e){return d.processBatchWithEffects({actionsWithEffects:[t.resolveItemsForBatch(e)]})})});
define("@ms/items-view/lib/private/operations/pruneItems",["require","exports","../models/itemCache/ItemPreserver","../store/actions/createActionCreator","../store/reducers/itemMapReducer"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.pruneLastAccessedItems=r.createAsyncActionCreator(function(e){return function(t){var r=t(n.getItemPreserver);r.trimLastAccesses(Date.now(),e.maxAge);var s=r.getPreservedItems();t(i.pruneItems({items:s}))}});t.registerItemDemands=r.createAsyncActionCreator(function(e){return function(t){t(n.getItemPreserver).registerDemands(e.owner,e.items)}});t.removeItemDemands=r.createAsyncActionCreator(function(e){return function(t){t(n.getItemPreserver).removeDemands(e.owner)}});t.recordLastItemAccesses=r.createAsyncActionCreator(function(e){return function(t){t(n.getItemPreserver).recordLastAccesses(e.items,Date.now())}});t.registerPermanentItemDemands=r.createAsyncActionCreator(function(e){return function(n){n(t.registerItemDemands({owner:{},items:e.items}))}})});
define("@ms/items-view/lib/private/models/itemCache/ItemPreserver",["require","exports","../../utilities/objects","../../store/middleware/RunOnceMiddleware","../../operations/configuration/readConfiguration","../../facets/ConfigurationFacets"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=6e5,u=864e5,a=function(){function e(e,t){void 0===t&&(t={});var n=t.pageDuration,r=void 0===n?o:n,i=t.maxAge,s=void 0===i?u:i;this._pageDuration=r;this._maxPages=Math.ceil(s/r);this._lastWriteTime=e;this._currentDemands=new Map;this._lastAccessPages=[]}e.prototype.registerDemands=function(e,t){this._currentDemands.set(e,t)};e.prototype.removeDemands=function(e){this._currentDemands.delete(e)};e.prototype.recordLastAccesses=function(e,t){this._fillPages(t);this._lastAccessPages.splice(this._maxPages,1/0);n.assign(this._lastAccessPages[0],e);this._lastWriteTime=t};e.prototype.trimLastAccesses=function(e,t){void 0===t&&(t=this._pageDuration*this._maxPages);this._fillPages(e);this._lastAccessPages.splice(Math.min(this._maxPages,Math.floor(t/this._pageDuration)),1/0);this._lastWriteTime=e};e.prototype.getPreservedItems=function(){var e={};this._currentDemands.forEach(function(t){n.assign(e,t)});for(var t=0,r=this._lastAccessPages;t<r.length;t++){var i=r[t];n.assign(e,i)}return e};e.prototype.getDemandsByOwner=function(){return this._currentDemands};e.prototype._fillPages=function(e){for(var t=e-this._lastWriteTime;t>=this._pageDuration||0===this._lastAccessPages.length;){this._lastAccessPages.unshift({});t-=this._pageDuration}};return e}();t.ItemPreserver=a;t.getItemPreserver=r.asOnceOnly(function(e){var t=e(i.readConfiguration({pruningConfiguration:s.pruningConfigurationFacet})).pruningConfiguration;return new a(Date.now(),{maxAge:t&&t.maxAge,pageDuration:t&&t.pageDuration})})});
define("@ms/items-view/lib/private/operations/configuration/readConfiguration",["require","exports","../readItem","../../facets/ConfigurationFacets"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.readConfiguration=function(e){return function(t){return t(n.readItem(e,r.configurationItemKey))}}});
define("@ms/items-view/lib/private/operations/readItem",["require","exports","./readItems"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.readItem=function(e,t){return function(r){return r(n.readItems(function(n){return n.demandItem(e,t)}))}}});
define("@ms/items-view/lib/private/facets/ConfigurationFacets",["require","exports","../models/Facet","../models/KeyFacet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.backgroundTaskQueueFacet=new n.Facet("backgroundTaskQueue");t.errorHandlerFacet=new n.Facet("errorHandler");t.offlineCacheFacet=new n.Facet("offlineCache");t.configurationItemKeyFacet=new r.KeyFacet("configuration",{});t.configurationItemKey=t.configurationItemKeyFacet.serialize({});t.localeFacet=new n.Facet("locale");t.pruningConfigurationFacet=new n.Facet("pruningConfiguration");t.loginUserFacet=new n.Facet("loginUser");t.enableFileHoverCardConfigurationFacet=new n.Facet("enableFileHoverCard");t.enableShimmeredDetailsListConfigurationFacet=new n.Facet("enableShimmeredDetailsList");t.enableSharePointBackingItemsFacet=new n.Facet("enableSharePointBackingItems");t.enableFollowItemConfigurationFacet=new n.Facet("enableFollowItem");t.maxParallelImageLoadCountFacet=new n.Facet("maxParallelImageLoadCount");t.enableItemCountInFileSizeColumnFacet=new n.Facet("enableItemCountInFileSizeColumn");t.isItemsViewLayoutPersistenceEnableConfigurationFacet=new n.Facet("enablePersistentLayout");t.enableFluentIconsFacet=new n.Facet("enableFluentIcons");t.enableTrendingConfigurationFacet=new n.Facet("enableTrending");t.enableReadOnlyConfigurationFacet=new n.Facet("enableReadOnly");t.enableItemDetailsRowRenderDebounceFacet=new n.Facet("enableItemDetailsRowRenderDebounce");t.enableDetailsListPreComputePagesFacet=new n.Facet("enableDetailsListPreComputePages");t.enableDetailsListFieldRenderPageLoadBarrierFacet=new n.Facet("enableDetailsListFieldRenderPageLoadBarrier");t.enableListLoadingSpinnerFacet=new n.Facet("enableListLoadingSpinner");t.enableDeleteCancelConfirmationStringsConfigurationFacet=new n.Facet("enableDeleteCancelConfirmationStrings");t.enableNewConflictUploadErrorStringsConfigurationFacet=new n.Facet("enableNewConflictUploadErrorStrings");t.disableSkipViewportMeasureConfigurationFacet=new n.Facet("disableSkipViewportMeasure");t.disableShimmerBeforePageLoadConfigurationFacet=new n.Facet("disableShimmerBeforePageLoad");t.enableReactDragDropConfigurationFacet=new n.Facet("enableReactDragDrop");t.reactDragDropConfigurationFacet=new n.Facet("reactDragDrop");!function(e){e.prod="prod";e.trailblazer="trailblazer";e.pathfinder="pathfinder";e.test="test"}(t.Environment||(t.Environment={}));t.sharedByMeYouEnabledFacet=new n.Facet("sharedByMeYouEnabled")});
define("@ms/items-view/lib/private/operations/processBatchWithEffects",["require","exports","../store/actions/createActionCreator","../store/reducers/itemCacheReducer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.processBatchWithEffects=n.createAsyncActionCreator(function(e){return function(t){for(var n=[],i=[],s=0,o=e.actionsWithEffects.map(function(e){return t(e)});s<o.length;s++){var u=o[s],a=u.action,f=u.effect;n.push(a);i.push(f)}t(r.processBatch({actions:n}));for(var l=0,c=i;l<c.length;l++){f=c[l];t(f)}}})});
define("@ms/items-view/lib/private/models/items/ItemResolver",["require","exports","../../operations/resolveItems","../../operations/invalidateItems","../../store/reducers/itemCacheReducer","../../operations/processBatchWithEffects","../../store/reducers/itemMapReducer","../../store/reducers/keyMapReducer"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){this._invalidateItems=[];this._resolveItems=[];this._mapKeys=[];this._moveKeys=[];this._updateItems=[]}e.prototype.mapKeys=function(e){if(this._done)throw new Error("This ItemResolver has been merged or executed, and may no longer be modified.");this._mapKeys.push(e)};e.prototype.moveKeys=function(e){if(this._done)throw new Error("This ItemResolver has been merged or executed, and may no longer be modified.");this._moveKeys.push(e)};e.prototype.invalidateItems=function(e){if(this._done)throw new Error("This ItemResolver has been merged or executed, and may no longer be modified.");this._invalidateItems.push(e)};e.prototype.resolveItems=function(e){if(this._done)throw new Error("This ItemResolver has been merged or executed, and may no longer be modified.");this._resolveItems.push(e)};e.prototype.updateItems=function(e){if(this._done)throw new Error("This ItemResolver has been merged or executed, and may no longer be modified.");this._updateItems.push(e)};e.prototype.merge=function(e){var t,n,r,i,s;e._done=!0;(t=this._moveKeys).push.apply(t,e._moveKeys);(n=this._mapKeys).push.apply(n,e._mapKeys);(r=this._invalidateItems).push.apply(r,e._invalidateItems);(i=this._resolveItems).push.apply(i,e._resolveItems);(s=this._updateItems).push.apply(s,e._updateItems)};e.prototype.execute=function(){var e=this;this._done=!0;return function(t){t(i.processBatch({actions:e._moveKeys.map(function(e){return u.moveKeys(e)})}));t(i.processBatch({actions:e._mapKeys.map(function(e){return i.mapKeys(e)})}));t(s.processBatchWithEffects({actionsWithEffects:e._invalidateItems.map(r.invalidateItemsForBatch)}));t(i.processBatch({actions:e._updateItems.map(function(e){return o.updateItems(e)})}));t(s.processBatchWithEffects({actionsWithEffects:e._resolveItems.map(n.resolveItemsForBatch)}))}};return e}();t.ItemResolver=a});
define("@ms/items-view/lib/private/operations/invalidateItems",["require","exports","tslib","../store/actions/createActionCreator","../utilities/Graft","../utilities/objects","../models/Facet","../models/KeyFacet","../store/reducers/itemMapReducer","../facets/DemandFacets","./readItems","./processBatchWithEffects"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=new u.KeyFacet("invalidation",{itemKey:u.stringPart(),facetId:u.stringPart()});t.invalidateItemsForBatch=r.createAsyncActionCreator(function(e){var t=e.items,r=e.skipInvalidationTriggers,u=void 0!==r&&r;return l.readItems(function(e){var r=[],l={},c={},p={},d=function(e,t){var n=h.serialize({itemKey:e,facetId:t});if(!l[n]){l[n]=!0;r.push(n);c[e]||(c[e]={});c[e][t]=!0}},v={};for(var m in t)if(Object.prototype.hasOwnProperty.call(t,m))for(var g=0,y=t[m];g<y.length;g++){d(m,y[g].id)}var b=[];if(!u)for(var w=void 0;w=r.pop();){var E=h.deserialize(w),S=(m=E.itemKey,E.facetId),x=e.demandItemFacet(f.invalidationFacet,m);if(x){var T=x.triggers[S];if(T){var N=T.targets,C=void 0===N?{}:N,k=T.callbacks,L=void 0===k?[]:k;for(var A in C)if(Object.prototype.hasOwnProperty.call(C,A)){var O=C[A];for(var M in O)Object.prototype.hasOwnProperty.call(O,M)&&O[M]&&d(A,M)}if(L.length>0){p[m]||(p[m]={});p[m][S]=!0;b.push.apply(b,L)}}}}for(var m in c)if(Object.prototype.hasOwnProperty.call(c,m)){var _=c[m];v[m]=o.pack({resolved:f.resolvedFacet},{resolved:s.mapObject(_,function(){return new i.Delete})})}if(!u)for(var m in p)if(Object.prototype.hasOwnProperty.call(p,m)){_=p[m];v[m]=n.__assign({},v[m]||{},o.pack({invalidation:f.invalidationFacet},{invalidation:{triggers:s.mapObject(_,function(){return new i.Delete})}}))}return{action:a.updateItems({items:v}),effect:function(e){for(var t=0,n=b;t<n.length;t++){e((0,n[t])())}}}})});t.invalidateItems=r.createAsyncActionCreator(function(e){return c.processBatchWithEffects({actionsWithEffects:[t.invalidateItemsForBatch(e)]})});var p=function(){function e(e,t){this._targets=e;this._callbacks=t}e.prototype.forFacet=function(t){var n=this,r=t.id;return{thenInvalidate:function(t){for(var i=[],s=1;s<arguments.length;s++)i[s-1]=arguments[s];return"string"==typeof t?new e(n._targets.concat([{facetId:r,itemKey:t,facets:i}]),n._callbacks):new e(n._targets,n._callbacks.concat([{facetId:r,callback:t}]))}}};e.prototype.pack=function(){for(var e=o.pack({},{}),t=0,n=this._targets;t<n.length;t++)for(var r=n[t],i=r.facetId,s=r.itemKey,u=r.facets,a=(e[i]||(e[i]={targets:{}})).targets,l=a[s]||(a[s]=o.pack({},{})),c=0,h=u;c<h.length;c++){l[h[c].id]=!0}for(var p=0,d=this._callbacks;p<d.length;p++){var v=d[p],m=(i=v.facetId,v.callback);(e[i]||(e[i]={callbacks:[]})).callbacks.push(m)}return f.invalidationFacet.pack({triggers:e})};return e}();t.getInvalidationFacet=function(){return new p([],[])}});
define("@ms/items-view/lib/private/store/ItemCacheDebugger",["require","exports","./reducers/itemCacheReducer","../models/itemCache/ItemPreserver","../models/KeyFacet","../facets/DemandFacets","../facets/OperationFacets","../models/Facet","../models/itemCache/ComputedItemFacet"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(){function e(){this._stores=new Map}Object.defineProperty(e.prototype,"stores",{get:function(){var e=[];this._stores.forEach(function(t,n){e.push(n)});return e},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"states",{get:function(){return this.stores.map(function(e){return e.getState()})},enumerable:!0,configurable:!0});e.prototype.registerStore=function(e){var t=this;this._stores.set(e,!0);return function(){t._stores.delete(e)}};e.prototype.getItems=function(e){void 0===e&&(e={});var t={},r=e.facet,i=e.value;this._stores.forEach(function(s,o){for(var u=o.getState(),a=function(s){var o=n.getCacheItem(u,s);if(!o)return"continue";if(!l(s,e))return"continue";if(("string"==typeof r||"string"==typeof i)&&!Object.keys(o).some(function(e){if("string"==typeof r&&e.indexOf(r)<0)return!1;var t=o[e];if("string"==typeof i)try{if(JSON.stringify(t).indexOf(i)<0)return!1}catch(e){console.warn(e)}return!0}))return"continue";for(var a=0,f=Object.keys(o);a<f.length;a++){var c=f[a],h=o[c];(t[s]||(t[s]={}))[c]=h}},f=0,c=Object.keys(u.keyMap.mappings);f<c.length;f++){a(c[f])}});return t};e.prototype.getDependencies=function(e){void 0===e&&(e={});var t={},n=e.facet,i=e.component;this._stores.forEach(function(f,c){c.dispatch(r.getItemPreserver).getDemandsByOwner().forEach(function(r,f){for(var c=0,h=Object.keys(r);c<h.length;c++){var p=h[c];if(l(p,e))for(var d=r[p],v=0,m=Object.keys(d);v<m.length;v++){var g=m[v];try{if(u.Facet.get(g)instanceof a.ComputedItemFacet)continue}catch(e){console.warn(e)}if(g!==s.resolvedFacet.id&&g!==o.preferredKeyFacetFacet.id&&!("string"==typeof n&&g.indexOf(n)<0)){var y=t[p]||(t[p]={}),b=y[g]||(y[g]=[]);if("string"==typeof i){if(!f.component)continue;if("function"==typeof f.component){var w=f.component.displayName||f.component.name;if("string"!=typeof w)continue;if(w.indexOf(i)<0)continue}else if(f.component.indexOf(i)<0)continue}b.push(f)}}}})});return t};return e}();t.ItemCacheDebugger=f;function l(e,t){void 0===t&&(t={});var n=t.itemKey,r=t.keyFacet,s=t.key;if("string"==typeof n&&e.indexOf(n)<0)return!1;try{var o=i.KeyFacet.get(e);if("string"==typeof r&&o.id.indexOf(r)<0)return!1;var u=o.deserialize(e);if("string"==typeof s&&!Object.keys(u).some(function(e){return(""+u[e]).indexOf(s)>-1}))return!1}catch(e){console.warn(e)}return!0}});
define("@ms/items-view/lib/private/facets/ItemFacets",["require","exports","../models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.displayNameFacet=new n.Facet("displayName");t.deletedFacet=new n.Facet("deleted");t.fileNameFacet=new n.Facet("fileName");t.folderFacet=new n.Facet("folder");t.parentFolderItemFacet=new n.Facet("parentFolderItem");t.fileSizeFacet=new n.Facet("fileSize");t.dateModifiedFacet=new n.Facet("dateModified");t.dateAccessedFacet=new n.Facet("dateAccessed");t.dateFollowedFacet=new n.Facet("dateFollowed");t.modifiedByPersonFacet=new n.Facet("modifiedBy");t.isSharedFacet=new n.Facet("isShared");t.averageRatingFacet=new n.Facet("averageRating");t.ratingCountFacet=new n.Facet("ratingCount");t.hasUserRatedFacet=new n.Facet("hasUserRated");t.userRatingFacet=new n.Facet("userRating");t.allRatingsFacet=new n.Facet("allRatings");t.likesCountFacet=new n.Facet("likesCount");t.hasUserLikedFacet=new n.Facet("hasUserLiked");t.fieldsFacet=n.createDynamicFacet("fields");t.analyticsItemFacet=new n.Facet("analyticsKey");t.likedByItemFacet=new n.Facet("likedByItemFacet");t.likedByPeopleFacet=new n.Facet("likedByPeopleFacet");t.openUrlFacet=new n.Facet("openUrl");t.isNewFacet=new n.Facet("isNew");t.isCheckedOutFacet=new n.Facet("isCheckedOut");t.malwareDetectedFacet=new n.Facet("malwareDetected");t.missingMetadataFacet=new n.Facet("missingMetadata");t.needsPublishingFacet=new n.Facet("needsPublishing");t.policyTipFacet=new n.Facet("policyTip");t.retentionPolicyFacet=new n.Facet("retentionPolicy");t.showRetentionPolicyIconFacet=new n.Facet("showRetentionPolicyIconFacet");t.vroomUrlFacet=new n.Facet("vroomUrl");t.canonicalUrlFacet=new n.Facet("canonicalUrl");t.parentFolderItemNameFacet=new n.Facet("parentFolderItemName");t.followedItemFacet=new n.Facet("followedItem");t.isFollowedFacet=new n.Facet("isFollowed");t.activityItemFacet=new n.Facet("activityItem");t.eTagFacet=new n.Facet("eTag")});
define("@ms/items-view/lib/private/operations/pageLoad",["require","exports","tslib","../utilities/async/Signal","./getItems","../store/enhancers/NextStoreUpdateEnhancer","./logPageLoad","../utilities/performance","../models/Facet","../models/KeyFacet","./pruneItems","./readItems","../facets/LoggerFacets","../facets/ConfigurationFacets","../addons/registerOperationHandler","./configuration/readConfiguration","./clearItems"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=new f.KeyFacet("pageLoad",{}),y=g.serialize({}),b=new a.Facet("pageLoadSignal"),w=d.createAddon(function(){return function(e){e(i.supportFacets({keyFacet:g,facets:[h.hasPageLoadedFacet]}));e(d.registerOperationHandler(g,i.getItemsOperation)(d.createSingleItemOperationHandler()(T)))}});function E(){return function(e){var t=(e(v.readConfiguration({pageLoadConfiguration:h.pageLoadConfigurationFacet})).pageLoadConfiguration||{}).enablePageLoadBarrier;return void 0!==t&&t}}function S(e){var t=(e.demandItemFacet(h.pageLoadConfigurationFacet,p.configurationItemKey)||{}).enablePageLoadBarrier;return!(void 0!==t&&t)||!!e.demandItemFacet(h.hasPageLoadedFacet,y)}t.isPageLoaded=S;function x(){return function(e){e(w);return e(c.readItems(S))}}t.getHasPageLoaded=x;t.getPageLoadBarrier=function(e){var t=(e.demandItemFacet(h.pageLoadConfigurationFacet,p.configurationItemKey)||{}).enablePageLoadBarrier;if(void 0!==t&&t){var n=e.demandItemFacet(b,y);if(n)return n.promise}};t.signalItemsViewRenderComplete=function(e,t){var a=this;return function(f){return n.__awaiter(a,void 0,void 0,function(){var a,d,v,m,g,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I;return n.__generator(this,function(q){switch(q.label){case 0:f(w);v=f(c.readItems(function(t){return{pageLoadSignal:t.demandItemFacet(b,y),hasPageLoaded:t.demandItemFacet(h.hasPageLoadedFacet,y),itemsViewRenderCompleteInfo:t.demandItemFacet(h.lastNavigationEventFacet,e),logger:t.demandItemFacet(h.loggerFacet,p.configurationItemKey),pageLoadConfiguration:t.demandItemFacet(h.pageLoadConfigurationFacet,p.configurationItemKey)}})),m=v.pageLoadSignal,g=v.hasPageLoaded,E=v.itemsViewRenderCompleteInfo,S=v.logger,x=v.pageLoadConfiguration;N=(T=E||{}).renderComplete,C=void 0!==N&&N,k=T.keyChanges,L=void 0===k?void 0:k;A=(S||{}).continueLoggingAfterPLT,O=void 0!==A&&A;_=(M=x||{}).pageLoadReadySignal,D=void 0===_?void 0:_,P=M.pageLoadContinueSignal,H=void 0===P?void 0:P;B=O||!C?t||u.now():void 0;j=f(c.readItems(function(t){return{ScopeInitTime:t.demandItemFacet(h.itemsScopeInitTimeFacet,e)}})).ScopeInitTime,F=void 0===j?NaN:j;B&&f(o.logPageLoad(B,{isFullPageLoad:!g,keyChanges:L,itemsScopeItemKey:e,itemsScopeInitTime:F}));I=m||new r.Signal;D&&D.resolve();return H?[4,H.promise]:[3,2];case 1:q.sent();q.label=2;case 2:f(i.resolveItems({items:(a={},a[e]=n.__assign({},h.lastNavigationEventFacet.pack({renderComplete:!0,keyChanges:L})),a[y]=n.__assign({},b.pack(I),h.hasPageLoadedFacet.pack(!0)),a)}));f(l.registerPermanentItemDemands({items:(d={},d[y]={},d)}));f(s.waitForNextStoreUpdate()).then(function(){return I.resolve()});return[2]}})})}};t.signalItemsViewNavigationStart=function(e){var t=e.itemsScopeItemKey,r=n.__rest(e,["itemsScopeItemKey"]);return function(e){var s;e(w);u.mark("signalItemsViweNavigationStart_key("+t+")");var o=h.resetPerfLoggerKeyFacet.serialize({}),a=e(c.readItems(function(e){return{hasPageLoaded:e.demandItemFacet(h.hasPageLoadedFacet,y),resetPerfLogger:e.demandItemFacet(h.resetPerfLoggerFacet,o)}})),f=a.hasPageLoaded,l=a.resetPerfLogger;l&&l({isFullPageLoad:!f,keyChanges:r,itemsScopeItemKey:t});e(i.resolveItems({items:(s={},s[t]=n.__assign({},h.lastNavigationEventFacet.pack({renderComplete:!1,keyChanges:r})),s)}))}};t.waitForPageLoad=function(){var e=this;return function(t){return n.__awaiter(e,void 0,void 0,function(){var e;return n.__generator(this,function(r){switch(r.label){case 0:t(w);return[4,t(T({itemKey:y,options:{demands:n.__assign({},a.pack({},{}),(e={},e[h.hasPageLoadedFacet.id]=!0,e))}}))];case 1:r.sent();return[2]}})})}};t.waitForPageLoadReady=function(){var e=this;return function(t){return n.__awaiter(e,void 0,void 0,function(){var e,r,i;return n.__generator(this,function(n){switch(n.label){case 0:e=t(c.readItems(function(e){return e.demandItemFacet(h.pageLoadConfigurationFacet,p.configurationItemKey)}));r=(e||{}).pageLoadReadySignal;return(i=void 0===r?void 0:r)?[4,i.promise]:[2];case 1:n.sent();return[2]}})})}};t.resetPageLoad=function(){return function(e){var t;e(w);if(e(E())){e(x())&&e(m.clearItems({items:(t={},t[y]=!0,t)}))}}};function T(e){var t=this,s=e.itemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,o,u,a;return n.__generator(this,function(f){switch(f.label){case 0:if(!e(E()))return[2];if(u=e(c.readItems(function(e){return e.demandItemFacet(b,s)})))a=u;else{a=new r.Signal;e(i.resolveItems({items:(t={},t[s]=n.__assign({},b.pack(a)),t)}));l.registerPermanentItemDemands({items:(o={},o[s]={},o)})}return[4,a.promise];case 1:f.sent();return[2]}})})}}});
define("@ms/items-view/lib/private/operations/logPageLoad",["require","exports","../facets/LoggerFacets","./readItems","./configuration/readConfiguration"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.logPageLoad=function(e,t){return function(s){var o=s(i.readConfiguration({logger:n.loggerFacet})).logger;if(e){var u=n.internalPerfLoggerKeyFacet.serialize({}),a=s(r.readItems(function(e){return e.demandItemFacet(n.internalPerfLoggerFacet,u)}));a&&a(e,t);o&&o.logRenderEndTime&&o.logRenderEndTime(e,t)}}}});
define("@ms/items-view/lib/private/facets/LoggerFacets",["require","exports","../models/Facet","@ms/telemetry-manager/lib/events/ResultTypeEnum","../models/KeyFacet"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.pageLoadConfigurationFacet=new n.Facet("pageLoadConfiguration");t.hasPageLoadedFacet=new n.Facet("hasPageLoaded");t.resetPerfLoggerFacet=new n.Facet("resetPerfLogger");t.resetPerfLoggerKeyFacet=new i.KeyFacet("resetPerfLoggerKey",{});t.internalPerfLoggerFacet=new n.Facet("internalPerfLogger");t.internalPerfLoggerKeyFacet=new i.KeyFacet("internalPerfLoggerKey",{});t.itemsScopeInitTimeFacet=new n.Facet("itemsScopeInitTime");t.lastNavigationEventFacet=new n.Facet("lastNavigationEvent");!function(e){e.success=r.ResultTypeEnum.Success;e.failure=r.ResultTypeEnum.Failure;e.expectedFailure=r.ResultTypeEnum.ExpectedFailure}(t.ResultType||(t.ResultType={}));!function(e){e[e.unknown=1]="unknown";e[e.odb=2]="odb";e[e.sharePoint=3]="sharePoint";e[e.ngsc=4]="ngsc";e[e.word=5]="word";e[e.powerpoint=6]="powerpoint";e[e.excel=7]="excel";e[e.onenoteWeb=8]="onenoteWeb";e[e.wac=9]="wac";e[e.visio=10]="visio";e[e.officecom=11]="officecom";e[e.listPart=12]="listPart";e[e.outlookWeb=13]="outlookWeb";e[e.odIos=14]="odIos";e[e.odAndroid=15]="odAndroid";e[e.teams=16]="teams";e[e.sample=17]="sample";e[e.odc=18]="odc";e[e.wordAndroid=19]="wordAndroid";e[e.excelAndroid=20]="excelAndroid";e[e.powerpointAndroid=21]="powerpointAndroid";e[e.wordIos=22]="wordIos";e[e.excelIos=23]="excelIos";e[e.powerpointIos=24]="powerpointIos";e[e.onenote=25]="onenote";e[e.teamsIos=26]="teamsIos";e[e.teamsAndroid=27]="teamsAndroid";e[e.onenoteIos=28]="onenoteIos";e[e.visioIos=29]="visioIos";e[e.onenoteAndroid=30]="onenoteAndroid";e[e.visioAndroid=31]="visioAndroid";e[e.outlookWindows=32]="outlookWindows";e[e.outlookMac=33]="outlookMac";e[e.onenoteUWP=34]="onenoteUWP";e[e.officemobileIos=35]="officemobileIos";e[e.officemobileAndroid=36]="officemobileAndroid";e[e.odcWac=37]="odcWac";e[e.outlookGroupsWeb=38]="outlookGroupsWeb"}(t.ClientId||(t.ClientId={}));t.loggerFacet=new n.Facet("logger")});
define("@ms/items-view/lib/private/addons/registerOperationHandler",["require","exports","tslib","../utilities/Graft","../utilities/async/Signal","../store/middleware/RunOnceMiddleware","../store/actions/implementOperation","../models/Facet","../store/reducers/operationMapReducer","../store/enhancers/NextStoreUpdateEnhancer","@ms/utilities-error/lib/ApiError","../operations/handleError","../utilities/objects","../store/reducers/itemMapReducer","../facets/OperationFacets","../utilities/async/TimeoutError","../operations/configuration/readConfiguration","../utilities/async/CancelError","../models/error/ErrorStrings.resx"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=6e4;t.createAddon=function(e){return s.asOnceOnly(e())};function w(e,t){var r=o.getOperationTypeKey({keyFacet:e,operationTypeFacet:t});return function(i){return function(s){var f,l,c,h=s(i({key:r}));s(a.registerOperators({operators:(f={},f[r]=h,f)}));s(p.updateItems({items:(l={},l[d.getKeyFacetItemKey(e)]=n.__assign({},d.registeredOperationHandlersFacet.pack(n.__assign({},u.pack({},{}),(c={},c[t.id]=!0,c)))),l)}));s(o.processOperation({key:r}))}}}t.registerOperationHandler=w;var E=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});return e.call(this,t)||this}return t}(l.ApiError);t.OperationHandlerError=E;var S=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.items=t.items;return n}return t}(l.ApiError);t.BatchedItemsOperationHandlerError=S;t.createSingleItemOperationHandler=function(e){void 0===e&&(e={});var t=e.mergeForSameItemKey,s=void 0===t||t,u=e.maxParallelOperationCount,a=void 0===u?1:u,l=e.prioritizeRecent,h=void 0!==l&&l,p=e.maxQueueSize,v=void 0===p?void 0:p;return function(t){return function(u){var l=u.key;return function(u){var p=0,y=!1,w=u(m.readConfiguration({operationHandlerConfiguration:d.operationHandlerConfigurationFacet})).operationHandlerConfiguration,S=void 0===w?{}:w,x=S.defaultTimeout,N=void 0===x?b:x,C=S.enableTimeout,k=void 0!==C&&C,L=e.timeout,A=void 0===L?k?N:void 0:L;function O(){return n.__awaiter(this,void 0,void 0,function(){var e,t,i,d,m,b,w,E,S,x,T,N,C,k,L,A,O,_,D;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,u(f.waitForNextStoreUpdate())];case 1:n.sent();e=[];for(;p<a;){if((t=u(o.getOperationState({key:l})))&&t.queue&&t.queue.length>0){i=t.queue.slice(0);if(d=h?i.pop():i.shift()){m=[];b=[d.startSignal];w=[d.completeSignal];for(E=0,S=i;E<S.length;E++){x=S[E];if(s&&x.itemKey===d.itemKey){d=r.graft(d,{options:x.options});b.push(x.startSignal);w.push(x.completeSignal)}else m.push(x)}p++;e.push({operation:d,startSignals:b,completeSignals:w});T=[];if(p===a&&"number"==typeof v)for(;m.length>v;)(N=h?m.shift():m.pop())&&T.push(N);u(o.editQueue({key:l,queue:m}));if(T.length>0){C=new g.CancelError;for(k=0,L=T;k<L.length;k++){(A=L[k]).startSignal.reject(C);A.completeSignal.reject(C)}}continue}}break}y=!1;for(O=0,_=e;O<_.length;O++)M(_[O]);return[3,3];case 2:D=n.sent();u(c.handleError({error:D}));return[3,3];case 3:return[2]}})})}function M(e){var r=e.operation,s=e.startSignals,a=e.completeSignals;return n.__awaiter(this,void 0,void 0,function(){var e,f,h,d,v,m,g,b,w,S,x,N,C;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,5,,6]);for(f=0,h=s;f<h.length;f++)h[f].resolve();d=new i.Signal,v=d.resolve,m=d.reject,g=d.promise;n.label=1;case 1:n.trys.push([1,3,,4]);return[4,T(u(t({itemKey:r.itemKey,options:r.options})),A)];case 2:n.sent();v();return[3,4];case 3:b=n.sent();m(b instanceof Error?b:new E({message:"The handler for '"+l+"' threw a non-error: "+b}));return[3,4];case 4:w=u(o.cleanupOperationQueue({key:l,items:(e={},e[r.itemKey]=[r.options],e)})).completeSignals;for(S=0,x=a.concat(w);S<x.length;S++){N=x[S];g.then(N.resolve,N.reject)}p--;if(!y){y=!0;O()}return[3,6];case 5:C=n.sent();u(c.handleError({error:C}));return[3,6];case 6:return[2]}})})}return function(){if(!y){y=!0;O()}}}}}};t.createBatchedItemsOperationHandler=function(e){void 0===e&&(e={});var t=e.maxParallelOperationCount,s=void 0===t?1:t,u=e.maxItemCountPerBatch,a=void 0===u?1/0:u,l=e.areSameBatch,p=void 0===l?x:l;return function(t){return function(u){var l=u.key;return function(u){var v=0,g=!1,y=u(m.readConfiguration({operationHandlerConfiguration:d.operationHandlerConfigurationFacet})).operationHandlerConfiguration,w=void 0===y?{}:y,x=w.defaultTimeout,N=void 0===x?b:x,C=w.enableTimeout,k=void 0!==C&&C,L=e.timeout,A=void 0===L?k?N:void 0:L;function O(){return n.__awaiter(this,void 0,void 0,function(){var e,t,i,h,d,m,y,b,w,E,S,x,T,N,C,k;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,u(f.waitForNextStoreUpdate())];case 1:n.sent();t=[];for(;v<s&&(i=u(o.getOperationState({key:l})))&&(h=i.queue)&&h.length>0;){d={items:{}};m=[];y=[];b={};w=[];E=h[0];for(S=0,x=h;S<x.length;S++){T=x[S];if(Object.keys(d.items).length>=a&&!(T.itemKey in d.items)||E!==T&&!p({itemKey:E.itemKey,options:E.options},{itemKey:T.itemKey,options:T.options}))w.push(T);else{d=r.graft(d,{items:(e={},e[T.itemKey]=T.options,e)});m.push(T.startSignal);y.push(T.completeSignal);b[T.itemKey]=T.completeSignal}}v++;t.push({batchOperation:d,startSignals:m,completeSignals:y,completeSignalsMap:b});u(o.editQueue({key:l,queue:w}))}g=!1;for(N=0,C=t;N<C.length;N++)M(C[N]);return[3,3];case 2:k=n.sent();u(c.handleError({error:k}));return[3,3];case 3:return[2]}})})}function M(e){var r=e.batchOperation,s=e.startSignals,a=e.completeSignals,f=e.completeSignalsMap;return n.__awaiter(this,void 0,void 0,function(){var e,p,d,m,y,b,w,x,N,C,k,L,M,_,D,P,H;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,5,,6]);for(e=0,p=s;e<p.length;e++)p[e].resolve();d=new i.Signal,m=d.resolve,y=d.reject,b=d.promise;n.label=1;case 1:n.trys.push([1,3,,4]);return[4,T(u(t(r)),A)];case 2:n.sent();m();return[3,4];case 3:if((w=n.sent())instanceof S)for(x=0,N=Object.keys(f);x<N.length;x++){C=N[x];k=f[C];(L=w.items[C])?k.reject(L instanceof Error?L:new E({message:"The handler for '"+l+"' and item '"+C+"' threw a non-error: "+L})):k.resolve()}y(w instanceof Error?w:new E({message:"The handler for '"+l+"' threw a non-error: "+w}));return[3,4];case 4:M=u(o.cleanupOperationQueue({key:l,items:h.mapObject(r.items,function(e){return[e]})})).completeSignals;for(_=0,D=a.concat(M);_<D.length;_++){P=D[_];b.then(P.resolve,P.reject)}v--;if(!g){g=!0;O()}return[3,6];case 5:H=n.sent();u(c.handleError({error:H}));return[3,6];case 6:return[2]}})})}return function(){if(!g){g=!0;O()}}}}}};t.createDeferredOperationHandler=function(e){var t=this;return function(r){var i=r.key,s=a.getOperationKeyParts(i),u=s.keyFacet,f=s.operationTypeFacet;return function(r){var s=!1;return function(){var a=r(o.getOperationState({key:i}));if(a&&a.queue&&a.queue.length>0&&!s){s=!0;n.__awaiter(t,void 0,void 0,function(){var t,a,l,h,p,d,v,m,g,b,E,x,T,N,C;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,3,4]);return[4,e()];case 1:if(!(t=n.sent()))throw new Error(y.default.DefaultTitle);r(w(u,f)(t));return[3,4];case 2:a=n.sent();l=a instanceof Error?a:new Error(y.default.DefaultTitle);if((h=r(o.getOperationState({key:i})))&&h.queue&&h.queue.length>0){p=[];d=[];v={};for(m=0,g=h.queue;m<g.length;m++){b=g[m];p.push(b.startSignal);d.push(b.completeSignal);v[b.itemKey]=new o.ItemOperationError({innerError:l})}r(o.editQueue({key:i,queue:[]}));E=new S({innerError:l,items:v});for(x=0,T=p;x<T.length;x++)T[x].reject(E);for(N=0,C=d;N<C.length;N++)C[N].reject(E)}r(c.handleError({error:l}));return[3,4];case 3:s=!1;return[7];case 4:return[2]}})})}}}}};function x(){return!0}function T(e,t){return n.__awaiter(this,void 0,void 0,function(){var r,s,o,u,a;return n.__generator(this,function(n){switch(n.label){case 0:r=new i.Signal,s=r.resolve,o=r.reject,u=r.promise;e.then(function(){return s()},function(e){return o(e)});"number"==typeof t&&(a=setTimeout(function(){o(new v.TimeoutError({timeout:t}))},t));n.label=1;case 1:n.trys.push([1,,3,4]);return[4,u];case 2:n.sent();return[3,4];case 3:"number"==typeof a&&clearTimeout(a);return[7];case 4:return[2]}})})}});
define("@ms/items-view/lib/private/operations/handleError",["require","exports","../store/actions/createActionCreator","../facets/ConfigurationFacets","./configuration/readConfiguration"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.handleError=n.createAsyncActionCreator(function(e){var t=e.error;return function(e){var n=e(i.readConfiguration({errorHandler:r.errorHandlerFacet})).errorHandler;n?n(t):window.setTimeout(function(){throw t},0)}})});
define("@ms/items-view/lib/private/utilities/async/TimeoutError",["require","exports","tslib","@ms/utilities-async/lib/wait/TimeoutError"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/utilities-async/lib/wait/TimeoutError",["require","exports","tslib","@ms/utilities-error/lib/CustomError"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(t){var r=e.call(this,n.__assign({message:"Timeout"},t))||this;r.timeout=t.timeout;return r}return t}(r.CustomError);t.TimeoutError=i});
define("@ms/items-view/lib/private/operations/clearItems",["require","exports","../store/actions/createActionCreator","../utilities/Graft","../store/reducers/itemMapReducer"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.clearItems=n.createAsyncActionCreator(function(e){var t=e.items;return function(e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=new r.Delete);e(i.updateItems({items:n}))}})});
define("@ms/items-view/lib/private/addons/registerControlHandler",["require","exports","tslib","../operations/getItems","../models/Facet","./registerOperationHandler","../operations/pruneItems","../operations/readItems","../models/AutoKeyFacet","../facets/OperationFacets"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=new a.AutoKeyFacet("loader"),c=new i.Facet("loader"),h=new i.Facet("isLoaded"),p=s.createAddon(function(){return function(e){e(s.registerOperationHandler(l,r.getItemsOperation)(s.createSingleItemOperationHandler({maxParallelOperationCount:16})(v)))}});t.demandControlHandler=function(e){return function(t,n){return t.demandItemFacet(e,n)||e.default}};function d(e,t){return function(n){return function(r){r(p);r(n({keyFacet:e,controlFacet:t}))()}}}t.registerControlHandler=d;t.createControlHandler=function(){return function(e){return function(t){var n=t.keyFacet,i=t.controlFacet,s=f.getKeyFacetItemKey(n);return function(t){return function(){var n,o=t(e());t(r.resolveItems({items:(n={},n[s]=f.controlHandlersFacet.pack(i.pack(o)),n)}))}}}}};t.createDeferredControlHandler=function(e){var t=this;return function(i){var s=i.keyFacet,u=i.controlFacet,a=f.getKeyFacetItemKey(s);return function(i){return function(){var p,v,m,g=l.serializeNext();i(r.resolveItems({items:(p={},p[a]=f.controlHandlersFacet.pack(u.pack(function(e){e.demandItemFacet(h,g);return{}})),p)}));var y={};i(o.registerItemDemands({owner:y,items:{items:(v={},v[g]={},v)}}));i(r.resolveItems({items:(m={},m[g]=c.pack(function(){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,,2,3]);return[4,e()];case 1:t=n.sent();i(d(s,u)(t));return[3,3];case 2:i(o.removeItemDemands({owner:y}));return[7];case 3:return[2]}})})}),m)}))}}}};t.asAsyncControlHandler=function(e){var t=this;return function(i){var s,u,a;i(p);var f=l.serializeNext(),d={};i(o.registerItemDemands({owner:d,items:{items:(s={},s[f]={},s)}}));i(r.resolveItems({items:(u={},u[f]=c.pack(function(){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,,2,3]);return[4,e()];case 1:t=n.sent();a=t;return[3,3];case 2:i(o.removeItemDemands({owner:d}));return[7];case 3:return[2]}})})}),u)}));return function(e,t){if(a)return a(e,t);e.demandItemFacet(h,f);return{}}}};function v(e){var t=this;return function(i){return n.__awaiter(t,void 0,void 0,function(){var t,s;return n.__generator(this,function(n){switch(n.label){case 0:if(!(s=i(u.readItems(function(t){return t.demandItemFacet(c,e.itemKey)}))))throw new Error("An async control handler is being loaded but was never registered.");return[4,s()];case 1:n.sent();i(r.resolveItems({items:(t={},t[e.itemKey]=h.pack(!0),t)}));return[2]}})})}}});
define("odsp-next/models/itemsScope/facets/OdspNextAppFacets",["require","exports","@ms/items-view/lib/private/models/KeyFacet","@ms/items-view/lib/private/models/Facet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.odspNextAppKeyFacet=new n.KeyFacet("odspNextApp",{});t.odspNextAppItemKey=t.odspNextAppKeyFacet.serialize({});t.odspNextQueryRootKeyFacet=new n.KeyFacet("odspNextQueryRoot",{queryType:n.numberPart()});t.resourceScopeFacet=new r.Facet("resourceScopeFacet");t.defaultGraphEndpointFacet=new r.Facet("defaultGraphEndpoint");t.hasPageLoadedFacet=new r.Facet("hasPageLoad");t.isLightspeedAppFacet=new r.Facet("isLightspeedApp");t.sessionIdFacet=new r.Facet("sessionId")});
define("odsp-next/models/itemsScope/controls/ItemKeyToStoreKeyControl",["require","exports","@ms/items-view/lib/private/models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemKeyToStoreKeyControl=new n.ControlFacet("itemKeyToStoreKeyControl")});
define("odsp-next/models/itemsScope/controls/ViewParamsToItemKeyControl",["require","exports","@ms/items-view/lib/private/models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.viewParamsToItemKeyControl=new n.ControlFacet("viewParamsToItemKeyControl")});
define("odsp-next/models/itemsScope/KnockoutStoreItemControlHandler",["require","exports","tslib","@ms/odsp-utilities/lib/resources/Resources","@ms/items-view/lib/private/addons/registerControlHandler","../../providers/item/ItemProvider.key"],function(e,t,n,r,i,s){"use strict";var o=this;Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id,factory:{dependencies:{resources:r.resourceScopeKey},create:function(e){var t=e.resources;return{instance:function(e){return e(i.asAsyncControlHandler(function(){return n.__awaiter(o,void 0,void 0,function(){var e;return n.__generator(this,function(n){switch(n.label){case 0:return[4,t.consumeAsync(s.resourceKey)];case 1:e=n.sent();return[2,function(){return{getItem:function(t){return e.getItemSync({parentKey:t,ignoreChildren:!0}).item}}}]}})})}))}}}}})});
define("odsp-next/providers/item/ItemProvider.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemProvider"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/models/itemsScope/controls/KnockoutStoreItemControl",["require","exports","@ms/items-view/lib/private/models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.knockoutStoreItemControl=new n.ControlFacet("knockoutStoreItemControl")});
define("@ms/items-view/lib/private/operations/blockItemPage",["require","exports","tslib","../models/Facet","../models/KeyFacet","./getItems"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.blockItemPageKeyFacet=new i.KeyFacet("blockItemPageKey",{});t.blockItemPageFacet=new r.Facet("blockItemPage");function o(e){return function(r){var i,o=t.blockItemPageKeyFacet.serialize({});r(s.resolveItems({items:(i={},i[o]=n.__assign({},t.blockItemPageFacet.pack(e)),i)}))}}t.blockItemPage=function(){return o(!0)};t.unblockItemPage=function(){return o(!1)};t.itemPageIsBlocked=function(e){var n=t.blockItemPageKeyFacet.serialize({});return e.demandItemFacet(t.blockItemPageFacet,n)}});
define("odsp-next/models/itemsScope/ItemsScopeCurrentItemKey.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../resources/ControlResourceKeys","../itemCache/ItemCacheObservable","./controls/ViewParamsToItemKeyControl","./facets/OdspNextAppFacets"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:{viewParamsObservable:r.viewParams,itemCacheObservablesFactory:i.resourceKey},create:function(e){var t=e.viewParamsObservable,n=e.itemCacheObservablesFactory.pureCompute(function(e){var n=e.demandItemFacet(s.viewParamsToItemKeyControl,o.odspNextAppItemKey);return s.viewParamsToItemKeyControl.evaluate(n)(e,{viewParams:t(),isNavigation:!0}).itemKey});return{instance:n,disposable:n}}}})});
define("odsp-next/models/itemCache/ItemCacheObservable",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/base/BaseModel","./ItemCacheStore","@ms/odsp-utilities/lib/scope/Scope","@ms/odsp-shared/lib/utilities/object/EqualityComparers","@ms/items-view/lib/private/utilities/objects","@ms/items-view/lib/private/models/itemCache/ItemCacheObserver","@ms/items-view/lib/private/operations/getItems","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/models/itemCache/ItemCacheEvaluator"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.controlHandlersResourceKey=new n.ResourceKey({name:e("module").id+".controlHandlers",factory:new n.ConstantResourceFactory(l.pack({},{}))});var h={itemCacheStore:i.resourceKey,observablesFactoryType:r.observablesFactoryTypeResourceKey,controlHandlers:t.controlHandlersResourceKey},p=function(){function e(e,t){void 0===e&&(e={});var n=this._scope=new s.default,r=this._itemCacheStore=t.itemCacheStore,i=this._observables=n.attach(new t.observablesFactoryType({owner:this}));this._controlHandlers=t.controlHandlers;var u=this._stateObservable=i.create(r.getState());u.equalityComparer=o.objectStrictEquality;n.attach({dispose:r.subscribe(function(){u(r.getState())})});this._itemCacheEvaluator=r.dispatch(c.getItemCacheEvaluator)}e.prototype.dispose=function(){this._scope.dispose()};e.prototype.pureCompute=function(e){var t,n,r,i=this,s=this._observables,l=this._stateObservable,c=this._itemCacheStore.dispatch,h=this._controlHandlers,p=this._itemCacheEvaluator,d=s.pureCompute(function(){var e,r=l(),i=new a.ItemCacheObserver({state:r,previousDependencies:t,previousDemands:n,dispatch:c});try{e=i.haveDependenciesChanged()}finally{i.dispose()}var s=d.peek();return e||!s?r:s});d.equalityComparer=o.objectStrictEquality;var v=s.pureCompute(function(){d();var s,o,v=new a.ItemCacheObserver({state:l.peek(),previousDependencies:t,previousDemands:n,dispatch:c,evaluator:p,owner:i,controlHandlers:h});try{s=e(v,{});var m=v.getDemands(),g=v.getDependencies();m===n&&g===t||(o=!0);n=m;t=g}finally{v.dispose()}o&&c(f.batchedGetItems({items:n}));return r&&u.areShallowEqual(s,r)?r:r=s});v.equalityComparer=o.objectStrictEquality;return v};return e}();t.ItemCacheObservablesFactory=p;t.resourceKey=n.createResolvedResourceKey(e("module").id,p,h)});
define("odsp-next/models/itemsScope/facets/CurrentItemsScopeFacets",["require","exports","@ms/items-view/lib/private/models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.currentViewParamsFacet=new n.Facet("currentViewParams")});
define("@ms/items-view/lib/private/components/itemsScope/ItemsScope",["require","exports","tslib","react","../../operations/openItem","../../operations/getItems","../../utilities/components/Props","../../addons/registerOperationHandler","../itemCacheProvider/ItemCacheProvider","../decorators/connectToItemsScope","../../utilities/components/RenderProps","../../utilities/performance","../../operations/readItems","../../facets/LoggerFacets","../decorators/withControlHandler","../../controls/itemsScopeControl","../../models/itemsScope/getNextItemsScopeItemKey","../decorators/connectToItemCache","../../operations/logQoS","@ms/utilities-error/lib/ApiError","../../facets/DemandFacets","../../operations/handleError"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getNextItemsScopeItemKey=m.getNextItemsScopeItemKey;var S=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._itemsScopeControlHandler=function(e,t){return t.itemsScopeItemKey?{}:{itemsScopeItemKey:n.props.itemsScopeItemKey}};n._controlHandlers=v.itemsScopeControl.pack(n._itemsScopeControlHandler);n._sessionAttemptCount=0;n._endQoS=n.props.itemCacheDispatch(y.logQoS({name:"ItemsScope.Session"}));n.state={hasError:!1};return n}t.getDerivedStateFromProps=function(e,t){return e.itemsScopeError?{hasError:!1}:t};t.getDerivedStateFromError=function(e){return{hasError:!0}};t.prototype.render=function(){return this.state.hasError?null:d.renderChildrenWithControlHandlers(this.props.children,this._controlHandlers)};t.prototype.componentDidCatch=function(e,t){var r,i=this.props,o=i.itemCacheDispatch,u=i.onError;o(this._endQoS(n.__assign({resultType:p.ResultType.failure,error:e&&e.message,resultCode:"RenderError"},e instanceof b.ApiError?{resultCode:e.code}:{},{extraData:n.__assign({},e instanceof b.ApiError?{correlationId:e.correlationId}:{},{stack:e.stack,componentStack:t.componentStack,sessionCount:++this._sessionAttemptCount})})));o(E.handleError({error:e}));o(s.resolveItems({items:(r={},r[this.props.itemsScopeItemKey]=n.__assign({},w.errorFacet.pack(e)),r)}));this._endQoS=o(y.logQoS({name:"ItemsScope.Session"}));u&&u(e)};t.prototype.componentWillUnmount=function(){try{this.props.itemCacheDispatch(this._endQoS({resultType:p.ResultType.success}))}catch(e){}};return t}(r.PureComponent),x=g.connectToItemCache(function(e,t){var n=t.itemsScopeItemKey,r=e.demandItemFacet(v.itemsScopeControl,void 0),i=v.itemsScopeControl.evaluate(r)(e,{}).onError;return{itemsScopeError:e.isItemFacetResolved(w.errorFacet,n)?e.demandItemFacet(w.errorFacet,n):void 0,onError:i}})(S),T=u.createAddon(function(){return function(e){e(s.supportFacets({keyFacet:m.itemsScopeItemKeyFacet,facets:[]}))}});t.createInitializer=function(e,t){return function(n){return function(r){r(e);r(i.openItem({itemsScopeItemKey:n.itemsScopeItemKey,currentItemKey:t}))}}};t.ItemsScope=o.injectInitialProps(function(e){var t=e.itemsScopeItemKey,r=void 0===t?m.getNextItemsScopeItemKey():t,i=e.initializer;return{itemsScopeItemKey:r,initializer:function(){return function(e){e(T);e(function(e){return function(t){var r;c.mark("ItemsScope.Init.Start ("+e+")");t(h.readItems(function(t){return t.demandItemFacet(p.itemsScopeInitTimeFacet,e)}))||t(s.resolveItems({items:(r={},r[e]=n.__assign({},p.itemsScopeInitTimeFacet.pack(Math.round(c.now()))),r)}))}}(r));i&&e(i({itemsScopeItemKey:r}))}}}})(function(e){var t=e.itemsScopeItemKey,i=e.children,s=n.__rest(e,["itemsScopeItemKey","children"]);return r.createElement(a.ItemCacheProvider,n.__assign({},s),r.createElement(x,{itemsScopeItemKey:t},l.renderChildrenWithProps(i,{itemsScopeItemKey:t})))});t.WithItemsScope=f.connectToItemsScope()(function(e){var t=e.itemsScopeItemKey,n=e.children;return l.renderChildrenWithProps(n,{itemsScopeItemKey:t})});t.WithItemsScope.displayName="WithItemsScope"});
define("@ms/items-view/lib/private/operations/openItem",["require","exports","tslib","../store/actions/createActionCreator","../facets/ScopeFacets","../store/enhancers/NextStoreUpdateEnhancer","./getItems","./resetItems"],function(e,t,n,r,i,s,o,u){"use strict";var a=this;Object.defineProperty(t,"__esModule",{value:!0});t.openItem=r.createAsyncActionCreator(function(e){var t=e.itemsScopeItemKey,r=e.currentItemKey;return function(e){return n.__awaiter(a,void 0,void 0,function(){var a,f,l;return n.__generator(this,function(c){switch(c.label){case 0:e(u.resetItems({items:(a={},a[t]=!0,a)}));e(o.resolveItems({items:(f={},f[t]=n.__assign({},i.currentItemFacet.pack({itemKey:r})),f)}));l=e(s.waitForNextStoreUpdate());e(s.forceStoreUpdate());return[4,l];case 1:c.sent();return[2]}})})}})});
define("@ms/items-view/lib/private/facets/ScopeFacets",["require","exports","../models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.currentItemFacet=new n.Facet("currentItem");t.currentSelectionFacet=new n.Facet("currentSelection");t.selectedItemsFacet=new n.Facet("selectedItems");t.availableLayoutsFacet=new n.Facet("availableLayouts");t.layoutTypeFacet=new n.Facet("layoutType");t.defaultLayoutFacet=new n.Facet("defaultLayoutType");t.preferredLayoutFacet=new n.Facet("preferredLayout");t.hasLayoutFacet=new n.Facet("hasLayout");t.groupsCollapsedFacet=new n.Facet("groupsCollapsed");t.allGroupsCollapsedFacet=new n.Facet("allGroupsCollapsed");t.startItemIndexInViewFacet=new n.Facet("startItemIndexInView")});
define("@ms/items-view/lib/private/operations/resetItems",["require","exports","tslib","../store/actions/createActionCreator","../utilities/Graft","../store/reducers/itemMapReducer","../models/Facet","../facets/DemandFacets","./readItems"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resetItems=r.createAsyncActionCreator(function(e){var t=e.items;return function(e){e(s.updateItems({items:e(a.readItems(function(e){var r,s={};for(var a in t)if(Object.prototype.hasOwnProperty.call(t,a)){var f=e.demandItemFacet(u.resolvedFacet,a),l={};if(f)for(var c in f)Object.prototype.hasOwnProperty.call(f,c)&&"failed"===f[c]&&(l[c]=new i.Delete);s[a]=o.pack({resolved:u.resolvedFacet,error:u.errorFacet},{resolved:n.__assign({},l,(r={},r[u.errorFacet.id]=new i.Delete,r)),error:new i.Delete})}return s}))}))}})});
define("@ms/items-view/lib/private/utilities/components/Props",["require","exports","tslib","react"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.injectProps=function(e){return function(t){var i,s=t;return function(t){n.__extends(o,t);function o(n){var r=t.call(this,n)||this,s=e(r.props);if(function(e){return"function"==typeof e}(s)){i=s;r.state=s(r.props)}else{i=e;r.state=s}return r}o.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState(i(e))};o.prototype.render=function(){return r.createElement(s,n.__assign({},this.props,this.state))};return o}(r.PureComponent)}};t.injectInitialProps=function(e){return function(t){var i=t;return function(t){n.__extends(s,t);function s(n){var r=t.call(this,n)||this;r.state=e(r.props);return r}s.prototype.render=function(){return r.createElement(i,n.__assign({},this.props,this.state))};return s}(r.PureComponent)}};t.wrapWithParent=function(e){var t=e;return function(e){var n=e;return function(e){return r.createElement(t,e,r.createElement(n,e))}}}});
define("@ms/items-view/lib/private/components/itemCacheProvider/ItemCacheProvider",["require","exports","tslib","react","../../store/createStore","../backgroundTaskRunner/BackgroundTaskHost","../../facets/ConfigurationFacets","../../operations/configuration/readConfiguration","../decorators/connectToItemCache"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=r.createContext(void 0);t.ItemCacheProvider=function(e){var c=e.store,h=e.configuration,p=e.initializer,d=e.children;if("store"in e&&!e.store)throw new Error("The 'store' prop was passed to ItemCacheProvider, but did not have a value.");if(c&&h)throw new Error("Cannot initialize an ItemCacheProvider with both 'store' and 'configuration' props.");var v=r.useContext(f);if(v&&h)throw new Error("Cannot initialize an ItemCacheProvider with 'configuration' when a store is already available via context.");var m,g=r.useRef(),y=r.useRef(),b=c||v||(m=g.current||(g.current=i.createItemCacheStore({configuration:h}))),w=r.useRef(),E=w.current;w.current=!0;b===v||E||p&&b.dispatch(p());r.useLayoutEffect(function(){b!==v||E||p&&b.dispatch(p());return function(){m&&m.dispose()}},[]);if(b!==v){var S=y.current||(y.current=function(e){var i=e.dispatch(u.readConfiguration({backgroundTaskQueueFromConfiguration:o.backgroundTaskQueueFacet})).backgroundTaskQueueFromConfiguration;return i?{enqueue:function(s){i.enqueue(n.__assign({},s,{content:r.createElement(t.ItemCacheProvider,{store:e},s.content)}))}}:void 0}(b));return r.createElement(f.Provider,{value:b},r.createElement(a.ConnectToItemCacheProvider,{store:b},r.createElement(s.BackgroundTaskContextProvider,{scope:"headless",queue:S,onQueueTask:S?void 0:l},r.createElement(s.BackgroundTaskContextProvider,{scope:"global"},d))))}return r.createElement(r.Fragment,null,d)};function l(e){return n.__assign({},e,{content:r.createElement(s.BackgroundTaskContextProvider,{scope:"global"},e.content)})}});
define("@ms/items-view/lib/private/components/backgroundTaskRunner/BackgroundTaskHost",["require","exports","tslib","react","../../models/AutoKeyFacet","../../models/controls/ControlFacet"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){void 0===e&&(e={});var t=this;this.enqueue=function(e){var n=t._onQueueTask;n&&(e=n(e));var r=t._queue;r?r.enqueue(e):t._earlyTasks.push(e)};this.queueRef=function(e){t._queue=e;if(e)for(var n=0,r=t._earlyTasks.splice(0,1/0);n<r.length;n++){var i=r[n];e.enqueue(i)}};this._earlyTasks=[];this._queue=null;this._onQueueTask=e&&e.onQueueTask};t.BackgroundTaskBuffer=o;var u=r.createContext({});t.backgroundTaskQueueControl=new s.ControlFacet("backgroundTaskQueue");t.BackgroundTaskContextProvider=function(e){var t=a(e),i=t[0],s=t[1],o=r.useContext(u),f=r.useMemo(function(){var t;return n.__assign({},o,((t={})[e.scope]=i,t))},[e.scope,i]);return r.createElement(r.Fragment,null,s,r.createElement(r.Fragment,{key:"children"},r.createElement(u.Provider,{value:f},e.children)))};t.useBackgroundTaskQueue=function(e){return r.useContext(u)[e.scope]};t.useComposedBackgroundTaskQueues=function(e){var t=e.queue,i=e.scope,s=r.useContext(u);return r.useMemo(function(){var e;return n.__assign({},s,((e={})[i]=t,e))},[i,t])};function a(e){var t=e.queue,n=e.onQueueTask,i=r.useState(!1),s=i[0],u=i[1],a=r.useRef(),f=r.useRef(),c=t||f.current||(f.current=new o({onQueueTask:function(e){a.current||u(!0);return n?n(e):e}})),h=f.current;r.useLayoutEffect(function(){return function(){a.current=!0}},[]);return[c,r.useMemo(function(){return h&&s?r.createElement(l,{key:"host",queueRef:h.queueRef}):null},[h,s])]}t.useBackgroundTaskHost=a;var f=new i.AutoKeyFacet("backgroundTask"),l=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._backgroundTaskQueue={enqueue:function(e){return n._enqueue(e)}};n.state={tasks:{}};return n}t.prototype.componentDidMount=function(){this.props.queueRef(this._backgroundTaskQueue)};t.prototype.render=function(){var e=this,t=Object.keys(this.state.tasks);return t.length>0?r.createElement(r.Fragment,null,t.map(function(t){return r.createElement(r.Fragment,{key:t},e.state.tasks[t])})):null};t.prototype.componentWillUnmount=function(){this._isDisposed=!0;this.props.queueRef(null)};t.prototype._enqueue=function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,i;return n.__generator(this,function(s){switch(s.label){case 0:t=e.content,r=e.promise;i=f.serializeNext();this.setState(function(e){var r;return{tasks:n.__assign({},e.tasks,(r={},r[i]=t,r))}});s.label=1;case 1:s.trys.push([1,3,4,5]);return[4,r];case 2:s.sent();return[3,5];case 3:s.sent();return[3,5];case 4:this._isDisposed||this.setState(function(e){var t=e.tasks,r=i;t[r];return{tasks:n.__rest(t,["symbol"==typeof r?r:r+""])}});return[7];case 5:return[2]}})})};return t}(r.PureComponent);t.BackgroundTaskHost=l});
define("@ms/items-view/lib/private/components/decorators/connectToItemCache",["require","exports","tslib","react","@ms/utilities-objects/lib/index","../../models/Facet","./connectToItemCache.v2"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ConnectToItemCacheProvider=o.ItemCacheReduxProvider;t.connectToItemCacheLinkFacet=new s.Facet("connectToItemCacheLink");t.contentLinkFacet=new s.Facet("contentLink");t.connectToItemCache=function(e,r){return function(s){var u=function(e,t){function r(r,i){var s=r.dispatch,o=e?e(r,i):{},u=t?t(s,i):{itemCacheDispatch:s};return n.__assign({},o,u)}i.assign(r,{mapItemCacheToProps:e,mapItemCacheDispatchToProps:t});return r}(e,r),a=t.connectToItemCacheLinkFacet.unpack(s),f=a?function(e,t){function r(r,i){var s=r.dispatch,o=e(r,i),u=t(r,n.__assign({},i,{itemCacheDispatch:s},o));return n.__assign({},o,u)}i.assign(r,{outer:e,inner:t});return r}(u,a.mapItemCacheToProps):u,l=a?a.component:s,c=o.connectWithReduxItemCache(f)(l);i.assign(c,t.connectToItemCacheLinkFacet.pack({mapItemCacheToProps:f,component:l}));return c}};function u(e){return e.content}t.ItemCacheComponent=u;i.assign(u,t.contentLinkFacet.pack({}));t.evaluateItemCacheComponent=function e(i,s){if(!s)return null;if(s.type===r.Fragment)return r.createElement(r.Fragment,null,s.props.children);if("function"==typeof s.type){if(t.contentLinkFacet.unpack(s.type))return e(i,s.type(s.props));var o=t.connectToItemCacheLinkFacet.unpack(s.type);if(o){var u=o.component,a=o.mapItemCacheToProps(i,s.props);return e(i,r.createElement(u,n.__assign({},s.props,{itemCacheDispatch:i.dispatch},a)))}}return s}});
define("@ms/items-view/lib/private/components/decorators/connectToItemCache.v2",["require","exports","tslib","react","react-redux","@ms/utilities-objects/lib/index","./withItemCacheDemander","./withControlHandler","react-redux","../../models/itemCache/ItemCacheEvaluator","../../models/itemCache/bindItemCacheSelectorToProps","../../hooks/useDebugOwner"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ITEM_CACHE_CONTEXT=r.createContext(void 0);var h={context:t.ITEM_CACHE_CONTEXT};t.ItemCacheReduxProvider=function(e){n.__extends(i,e);function i(){return null!==e&&e.apply(this,arguments)||this}i.prototype.render=function(){return r.createElement(a.Provider,{store:this.props.store,context:t.ITEM_CACHE_CONTEXT},this.props.children)};return i}(r.PureComponent);t.connectWithReduxItemCache=function(e,t){return function(a){var g,y,b,w=o.withItemCacheDemander()(a),E=v(p(d((y=function(e,t){return function(r){var i,o,u={component:t(),fiber:c.getCurrentFiber()},a=r(f.getItemCacheEvaluator);return function(t,f){var h=f,p=h.itemCacheConnectorControlHandlers,d=n.__rest(h,["itemCacheConnectorControlHandlers"]),v=!i||s.areShallowDifferent(i,d,{debug:!0}),m=!o||v?l.bindItemCacheSelectorToProps(e,d):o,g=c.suspendReactEnvironment(function(){return a.evaluate({selector:m,controlHandlers:p,state:t,owner:u,suspender:u})}),y=g.result,b=g.demands,w=g.dependencies;i=d;o=m;return n.__assign({},y,{itemCacheDemanderDemands:b,itemCacheDemanderDependencies:w,itemCacheDemanderDispatch:r,itemCacheOwner:u})}}}(e,function(){return g}),b=m(t),function(e){var t=y(e),r=b(e);return function(e,i){return n.__assign({},t(e,i),r(e,i))}})))(w)),S=i.connectAdvanced(E,h)(w);function x(e){var t=r.useContext(u.CONTROL_HANDLER_CONTEXT);return r.createElement(S,n.__assign({},e,{key:"connect",itemCacheConnectorControlHandlers:t}))}g=x;s.assign(x,{displayName:"ConnectWithRedux"});return x}};t.connectWithReduxDispatch=function(e){return function(t){var n=v(p(d(m(e)))(t)),r=i.connectAdvanced(n,h)(t);r.displayName="ConnectWithReduxDispatch";return r}};function p(e){return function(t){return function(t){var r=e(t);return function(e,t){return n.__assign({},t,r(e,t))}}}}function d(e){return function(t){var n,r=e(t);return function(e,t){var i=!n||s.areShallowDifferent(t,n);n=t;return r(e,i?t:n)}}}function v(e){return function(t){var n,r=e(t);return function(e,t){var i=r(e,t);return!n||s.areShallowDifferent(i,n)?n=i:n}}}function m(e){return function(t){var n,r,i={itemCacheDispatch:t};return function(o,u){var a=!n||s.areShallowDifferent(n,u);n=u;a&&(r=e?e(t,u):i);return r}}}});
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("redux")):"function"==typeof define&&define.amd?define('react-redux',["exports","react","redux"],t):t(e.ReactRedux={},e.React,e.Redux)}(this,function(e,g,r){"use strict";var S="default"in g?g.default:g;function w(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}function t(e,t){return e(t={exports:{}},t.exports),t.exports}function n(){}var o=t(function(e){e.exports=function(){function e(e,t,r,n,o,i){if("SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"!==i){var a=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}var r={array:e.isRequired=e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t};return r.checkPropTypes=n,r.PropTypes=r}()}),x=S.createContext(null),i=function(n){function e(e){var t;t=n.call(this,e)||this;var r=e.store;return t.state={storeState:r.getState(),store:r},t}w(e,n);var t=e.prototype;return t.componentDidMount=function(){this._isMounted=!0,this.subscribe()},t.componentWillUnmount=function(){this.unsubscribe&&this.unsubscribe(),this._isMounted=!1},t.componentDidUpdate=function(e){this.props.store!==e.store&&(this.unsubscribe&&this.unsubscribe(),this.subscribe())},t.subscribe=function(){var e=this,r=this.props.store;this.unsubscribe=r.subscribe(function(){var t=r.getState();e._isMounted&&e.setState(function(e){return e.storeState===t?null:{storeState:t}})});var t=r.getState();t!==this.state.storeState&&this.setState({storeState:t})},t.render=function(){return S.createElement((this.props.context||x).Provider,{value:this.state},this.props.children)},e}(g.Component);function C(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(){return(E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function R(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)t.indexOf(r=i[n])<0&&(o[r]=e[r]);return o}i.propTypes={store:o.shape({subscribe:o.func.isRequired,dispatch:o.func.isRequired,getState:o.func.isRequired}),context:o.object,children:o.any};var a,s=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&Symbol.for,n=r?Symbol.for("react.element"):60103,o=r?Symbol.for("react.portal"):60106,i=r?Symbol.for("react.fragment"):60107,a=r?Symbol.for("react.strict_mode"):60108,s=r?Symbol.for("react.profiler"):60114,p=r?Symbol.for("react.provider"):60109,c=r?Symbol.for("react.context"):60110,u=r?Symbol.for("react.async_mode"):60111,f=r?Symbol.for("react.concurrent_mode"):60111,d=r?Symbol.for("react.forward_ref"):60112,l=r?Symbol.for("react.suspense"):60113,m=r?Symbol.for("react.memo"):60115,y=r?Symbol.for("react.lazy"):60116;function v(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case u:case f:case i:case s:case a:return e;default:switch(e=e&&e.$$typeof){case c:case d:case p:return e;default:return t}}case o:return t}}}function h(e){return v(e)===f}t.typeOf=v,t.AsyncMode=u,t.ConcurrentMode=f,t.ContextConsumer=c,t.ContextProvider=p,t.Element=n,t.ForwardRef=d,t.Fragment=i,t.Profiler=s,t.Portal=o,t.StrictMode=a,t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===i||e===f||e===s||e===a||e===l||"object"==typeof e&&null!==e&&(e.$$typeof===y||e.$$typeof===m||e.$$typeof===p||e.$$typeof===c||e.$$typeof===d)},t.isAsyncMode=function(e){return h(e)||v(e)===u},t.isConcurrentMode=h,t.isContextConsumer=function(e){return v(e)===c},t.isContextProvider=function(e){return v(e)===p},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},t.isForwardRef=function(e){return v(e)===d},t.isFragment=function(e){return v(e)===i},t.isProfiler=function(e){return v(e)===s},t.isPortal=function(e){return v(e)===o},t.isStrictMode=function(e){return v(e)===a}});(a=s)&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default");var p=t(function(e){e.exports=s}),f={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},d={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},l={};l[p.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0};var m=Object.defineProperty,y=Object.getOwnPropertyNames,v=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,P=Object.getPrototypeOf,b=Object.prototype;var T=function e(t,r,n){if("string"==typeof r)return t;if(b){var o=P(r);o&&o!==b&&e(t,o,n)}var i=y(r);v&&(i=i.concat(v(r)));for(var a=l[t.$$typeof]||f,s=l[r.$$typeof]||f,p=0;p<i.length;++p){var c=i[p];if(!(d[c]||n&&n[c]||s&&s[c]||a&&a[c])){var u=h(r,c);try{m(t,c,u)}catch(e){}}}return t},M=function(e,t,r,n,o,i,a,s){if(!e){var p;if(void 0===t)p=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[r,n,o,i,a,s],u=0;(p=Error(t.replace(/%s/g,function(){return c[u++]}))).name="Invariant Violation"}throw p.framesToPop=1,p}};function c(m,e){void 0===e&&(e={});var t=e.getDisplayName,a=void 0===t?function(e){return"ConnectAdvanced("+e+")"}:t,r=e.methodName,s=void 0===r?"connectAdvanced":r,n=e.renderCountProp,p=void 0===n?void 0:n,o=e.shouldHandleStateChanges,c=void 0===o||o,i=e.storeKey,y=void 0===i?"store":i,u=e.withRef,f=void 0!==u&&u,d=e.forwardRef,v=void 0!==d&&d,l=e.context,h=void 0===l?x:l,P=R(e,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"]);M(void 0===p,"renderCountProp is removed. render counting is built into the latest React dev tools profiling extension"),M(!f,"withRef is removed. To access the wrapped instance, use a ref on the connected component");var b="To use a custom Redux store for specific components,  create a custom React context with React.createContext(), and pass the context object to React-Redux's Provider and specific components like:  <Provider context={MyContext}><ConnectedComponent context={MyContext} /></Provider>. You may also pass a {context : MyContext} option to connect";M("store"===y,"storeKey has been removed and does not do anything. "+b);var O=h;return function(e){var t=e.displayName||e.name||"Component",o=a(t),f=E({},P,{getDisplayName:a,methodName:s,renderCountProp:p,shouldHandleStateChanges:c,storeKey:y,displayName:o,wrappedComponentName:t,WrappedComponent:e}),d=P.pure,r=g.Component,l=e;d&&(r=g.PureComponent);var n=function(u){function e(e){var t,o,i,a,s,p,r,n,c;return t=u.call(this,e)||this,M(v?!e.wrapperProps[y]:!e[y],"Passing redux store in props has been removed and does not do anything. "+b),t.selectDerivedProps=function(e,t,r){if(d&&o===t&&i===e)return a;r!==s&&(p=m((s=r).dispatch,f));var n=p(i=e,o=t);return a===n?a:a=n},t.selectChildElement=function(e,t){return e===r&&t===n||(c=S.createElement(l,E({},r=e,{ref:n=t}))),c},t.renderWrappedComponent=t.renderWrappedComponent.bind(C(C(t))),t}w(e,u);var t=e.prototype;return t.renderWrappedComponent=function(e){M(e,'Could not find "store" in the context of "'+o+'". Either wrap the root component in a <Provider>, or pass a custom React context provider to <Provider> and the corresponding React context consumer to '+o+" in connect options.");var t,r=this.props;v&&(r=this.props.wrapperProps,t=this.props.forwardedRef);var n=this.selectDerivedProps(e.storeState,r,e.store);return this.selectChildElement(n,t)},t.render=function(){return S.createElement((this.props.context||O).Consumer,null,this.renderWrappedComponent)},e}(r);if(n.WrappedComponent=e,n.displayName=o,v){var i=S.forwardRef(function(e,t){return S.createElement(n,{wrapperProps:e,forwardedRef:t})});return i.displayName=o,i.WrappedComponent=e,T(i,e)}return T(n,e)}}var u=Object.prototype.hasOwnProperty;function O(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}function j(e,t){if(O(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e);if(r.length!==Object.keys(t).length)return!1;for(var n=0;n<r.length;n++)if(!u.call(t,r[n])||!O(e[r[n]],t[r[n]]))return!1;return!0}function _(o){return function(e,t){var r=o(e,t);function n(){return r}return n.dependsOnOwnProps=!1,n}}function q(e){return null!=e.dependsOnOwnProps?!!e.dependsOnOwnProps:1!==e.length}function $(o,e){return function(e,t){var n=function(e,t){return n.dependsOnOwnProps?n.mapToProps(e,t):n.mapToProps(e)};return n.dependsOnOwnProps=!0,n.mapToProps=function(e,t){n.mapToProps=o,n.dependsOnOwnProps=q(o);var r=n(e,t);return"function"==typeof r&&(n.mapToProps=r,n.dependsOnOwnProps=q(r),r=n(e,t)),r},n}}function D(e,t,r){return E({},r,e,t)}function N(r,n,o,i){return function(e,t){return o(r(e,t),n(i,t),t)}}function F(a,s,p,c,e){var u,f,d,l,m,y=e.areStatesEqual,v=e.areOwnPropsEqual,h=e.areStatePropsEqual,r=!1;function n(e,t){var r,n,o=!v(t,f),i=!y(e,u);return u=e,f=t,o&&i?(d=a(u,f),s.dependsOnOwnProps&&(l=s(c,f)),m=p(d,l,f)):o?(a.dependsOnOwnProps&&(d=a(u,f)),s.dependsOnOwnProps&&(l=s(c,f)),m=p(d,l,f)):(i&&(r=a(u,f),n=!h(r,d),d=r,n&&(m=p(d,l,f))),m)}return function(e,t){return r?n(e,t):(d=a(u=e,f=t),l=s(c,f),m=p(d,l,f),r=!0,m)}}function W(e,t){var r=t.initMapStateToProps,n=t.initMapDispatchToProps,o=t.initMergeProps,i=R(t,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),a=r(e,i),s=n(e,i),p=o(e,i);return(i.pure?F:N)(a,s,p,e,i)}function k(r,e,n){for(var t=e.length-1;0<=t;t--){var o=e[t](r);if(o)return o}return function(e,t){throw Error("Invalid value of type "+typeof r+" for "+n+" argument when connecting component "+t.wrappedComponentName+".")}}function A(e,t){return e===t}var H,I,K,U,V,L,Y,z,B,G,J,Q,X=(U=void 0===(K=(I=void 0===H?{}:H).connectHOC)?c:K,L=void 0===(V=I.mapStateToPropsFactories)?[function(e){return"function"==typeof e?$(e):void 0},function(e){return e?void 0:_(function(){return{}})}]:V,z=void 0===(Y=I.mapDispatchToPropsFactories)?[function(e){return"function"==typeof e?$(e):void 0},function(e){return e?void 0:_(function(e){return{dispatch:e}})},function(t){return t&&"object"==typeof t?_(function(e){return r.bindActionCreators(t,e)}):void 0}]:Y,G=void 0===(B=I.mergePropsFactories)?[function(e){return"function"==typeof e?(p=e,function(e,t){var o,i=t.pure,a=t.areMergedPropsEqual,s=!1;return function(e,t,r){var n=p(e,t,r);return s?i&&a(n,o)||(o=n):(s=!0,o=n),o}}):void 0;var p},function(e){return e?void 0:function(){return D}}]:B,Q=void 0===(J=I.selectorFactory)?W:J,function(e,t,r,n){void 0===n&&(n={});var o=n.pure,i=void 0===o||o,a=n.areStatesEqual,s=void 0===a?A:a,p=n.areOwnPropsEqual,c=void 0===p?j:p,u=n.areStatePropsEqual,f=void 0===u?j:u,d=n.areMergedPropsEqual,l=void 0===d?j:d,m=R(n,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),y=k(e,L,"mapStateToProps"),v=k(t,z,"mapDispatchToProps"),h=k(r,G,"mergeProps");return U(Q,E({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:!!e,initMapStateToProps:y,initMapDispatchToProps:v,initMergeProps:h,pure:i,areStatesEqual:s,areOwnPropsEqual:c,areStatePropsEqual:f,areMergedPropsEqual:l},m))});e.Provider=i,e.connectAdvanced=c,e.ReactReduxContext=x,e.connect=X,Object.defineProperty(e,"__esModule",{value:!0})});

define("@ms/items-view/lib/private/components/decorators/withItemCacheDemander",["require","exports","tslib","react","../../operations/pruneItems","../../operations/getItems"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.withItemCacheDemander=function(){return function(e){var t=e===r.Fragment?u:o;return function(r){n.__extends(o,r);function o(e){var t=r.call(this,e)||this;t._demandOwner=e.itemCacheOwner;return t}o.prototype.render=function(){return t(e,this.props)};o.prototype.componentDidMount=function(){this._getItems()};o.prototype.componentDidUpdate=function(e){var t=this.props,n=t.itemCacheDemanderDemands,r=t.itemCacheDemanderDependencies;n===e.itemCacheDemanderDemands&&r===e.itemCacheDemanderDependencies||this._getItems()};o.prototype.componentWillUnmount=function(){this.props.itemCacheDemanderDispatch(i.removeItemDemands({owner:this._demandOwner}))};o.prototype._getItems=function(){var e=this.props,t=e.itemCacheDemanderDispatch,n=e.itemCacheDemanderDemands,r=e.itemCacheDemanderDependencies;t(i.recordLastItemAccesses({items:r}));t(s.batchedGetItems({items:n}));t(i.registerItemDemands({owner:this._demandOwner,items:r}))};return o}(r.PureComponent)}};function o(e,t){var i=t,s=(i.itemCacheDemanderDispatch,i.itemCacheDemanderDemands,i.itemCacheDemanderDependencies,i.itemCacheConnectorControlHandlers,i.itemCacheOwner,n.__rest(i,["itemCacheDemanderDispatch","itemCacheDemanderDemands","itemCacheDemanderDependencies","itemCacheConnectorControlHandlers","itemCacheOwner"]));return r.createElement(e,n.__assign({},s))}function u(e,t){return r.createElement(r.Fragment,null,t.children)}});
define("@ms/items-view/lib/private/components/decorators/withControlHandler",["require","exports","tslib","react","prop-types","../../models/controls/ControlFacet","../../models/Facet","../../utilities/components/RenderProps","../../utilities/objects","../../utilities/Memoizer"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CONTROL_HANDLER_CONTEXT_TYPES={controlHandlers:i.any};t.CONTROL_HANDLER_CONTEXT=r.createContext(s.NO_CONTROL_HANDLERS);t.withControlHandler=function(e,i){return function(s){var u=s;return function(s){n.__extends(a,s);function a(){return null!==s&&s.apply(this,arguments)||this}a.prototype.render=function(){var s=this.props;return r.createElement(t.CONTROL_HANDLER_CONTEXT.Consumer,null,function(t){var a=o.unpack({controlHandler:e},t).controlHandler,f=void 0===a?e.default:a;return r.createElement(u,n.__assign({},s,i?i(f):{controlHandler:f}))})};return a}(r.PureComponent)}};function l(e){return function(i){var o=i;return function(i){n.__extends(u,i);function u(){return null!==i&&i.apply(this,arguments)||this}u.prototype.render=function(){var i=this.props;return r.createElement(t.CONTROL_HANDLER_CONTEXT.Consumer,null,function(t){for(var u={},a=0,f=Object.keys(e);a<f.length;a++){var l=f[a],c=e[l];if(!c)throw new Error("No facet mapped to '"+l+"'.");var h=t[c.id],p=void 0===h?s.ControlFacet.get(c.id).default:h;u[l]=p}return r.createElement(o,n.__assign({},i,u))})};return u}(r.PureComponent)}}t.withControlHandlers=l;var c=f.createMemoizer(function(e){return f.createMemoizer(function(t){return n.__assign({},e,a.mapObject(t,function(t,n){var r=s.ControlFacet.get(n),i=r.unpack(e);return i&&r.compose(t,i)||t}))})}),h=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.controlHandlers;return p(e.children,t)};return t}(r.PureComponent);t.ControlHandlerProvider=h;function p(e,n){return r.createElement(t.CONTROL_HANDLER_CONTEXT.Consumer,null,function(i){return r.createElement(t.CONTROL_HANDLER_CONTEXT.Provider,{value:c(i)(n)},e)})}t.renderChildrenWithControlHandlers=p;t.useComposedControlHandlers=function(e,t){return c(e)(t)};t.createWithControlHandlers=function(e){var t=l(e)(function(e){var t=e,r=t.children,i=n.__rest(t,["children"]);return u.renderChildrenWithProps(r,i)});t.displayName="WithControlHandlers";return t}});
define("@ms/items-view/lib/private/utilities/components/RenderProps",["require","exports","tslib","react","./Fragment"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t){return u(e)?e(t):r.createElement(i.Fragment,null,e)}t.renderChildrenWithProps=s;var o=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return null};t.prototype.componentDidMount=function(){this.props.onUpdate(this.props.stateProps)};t.prototype.componentDidUpdate=function(e){var t=this.props,n=t.stateProps,r=t.onUpdate;n===e.stateProps&&r===e.onUpdate||r(n)};return t}(r.PureComponent);t.StatePropsUpdater=o;t.withBothRenderProps=function(e,t){var i=e,o=t;return function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.children,u=n.__rest(e,["children"]);return r.createElement(i,n.__assign({},u),function(e){return r.createElement(o,n.__assign({},u),function(r){return s(t,n.__assign({},e,r))})})};return t}(r.PureComponent)};function u(e){return"function"==typeof e}t.isRenderProp=u});
define("@ms/items-view/lib/private/utilities/components/Fragment",["require","exports","tslib","react","prop-types"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DefaultFragment=r.Fragment;var s={fragment:i.any};t.Fragment=r.Fragment;var o=function(e){n.__extends(i,e);function i(){return null!==e&&e.apply(this,arguments)||this}i.prototype.getChildContext=function(){return{fragment:{override:this.props.override}}};i.prototype.render=function(){return r.createElement(t.Fragment,null,this.props.children)};i.childContextTypes=s;return i}(r.PureComponent);t.FragmentProvider=o});
define("@ms/items-view/lib/private/hooks/useDebugOwner",["require","exports","react"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;t.suspendReactEnvironment=function(e){var t=null,n=null,i=!1;try{t=r.ReactCurrentDispatcher.current;n=r.ReactCurrentOwner.current;i=!0}catch(e){}if(i){r.ReactCurrentDispatcher.current=null;r.ReactCurrentOwner.current=null}try{return e()}finally{if(i){r.ReactCurrentDispatcher.current=t;r.ReactCurrentOwner.current=n}}};function i(){try{return r.ReactCurrentOwner.current}catch(e){return null}}t.getCurrentFiber=i;t.useDebugOwner=function(){var e=i();return n.useState(function(){return{component:e&&e.type,fiber:e}})[0]}});
define("@ms/items-view/lib/private/components/decorators/connectToItemsScope",["require","exports","./connectToItemCache","../../models/itemsScope/getItemsScope"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getItemsScope=r.getItemsScope;t.connectToItemsScope=function(){return function(e){var t=n.connectToItemCache(function(e){return r.getItemsScope(e)})(e);t.displayName="ConnectToItemsScope";return t}}});
define("@ms/items-view/lib/private/models/itemsScope/getItemsScope",["require","exports","../../controls/itemsScopeControl"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getItemsScope=function(e,t){void 0===t&&(t={});var r=e.demandItemFacet(n.itemsScopeControl,void 0);return n.itemsScopeControl.evaluate(r)(e,{})}});
define("@ms/items-view/lib/private/controls/itemsScopeControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemsScopeControl=new n.ControlFacet("itemsScopeControl")});
define("@ms/items-view/lib/private/models/itemsScope/getNextItemsScopeItemKey",["require","exports","../AutoKeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemsScopeItemKeyFacet=new n.AutoKeyFacet("itemsScope");t.getNextItemsScopeItemKey=function(){return t.itemsScopeItemKeyFacet.serializeNext()}});
define("@ms/items-view/lib/private/operations/logQoS",["require","exports","@ms/telemetry-manager/lib/events/Qos.event","./telemetry/getTelemetryManager"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.logQoS=function(e){return function(t){var i=t(r.getTelemetryManager),s=new(n.Qos.withManager(i))(e);return function(e){return function(t){s.end(e)}}}}});
define("@ms/items-view/lib/private/operations/telemetry/getTelemetryManager",["require","exports","@ms/telemetry-manager/lib/Manager","../../store/middleware/RunOnceMiddleware","../../facets/TelemetryFacets","../../facets/LoggerFacets","@ms/telemetry-manager/lib/events/Qos.event","@ms/telemetry-manager/lib/EventBase","@ms/telemetry-manager/lib/events/Engagement.event","../configuration/readConfiguration"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getTelemetryManager=r.asOnceOnly(function(e){for(var t=n.createManager(),r=e(f.readConfiguration({telemetryHandlers:i.telemetryHandlersConfigurationFacet,logger:s.loggerFacet})),l=r.telemetryHandlers,c=void 0===l?[]:l,h=r.logger,p=0,d=c;p<d.length;p++){d[p].attach(t)}var v=h&&h.logQoSData,m=h&&h.logEngagementData;if(v){var g=new WeakMap;t.addLogHandler(function(e){if(o.Qos.isTypeOf(e))if(e.eventType===u.ClonedEventType.End){var t=g.get(e.vector);t&&t(e.data)}else e.eventType===u.ClonedEventType.Start&&g.set(e.vector,v(e.data,e.context))})}m&&t.addLogHandler(function(e){a.Engagement.isTypeOf(e)&&e.eventType===u.ClonedEventType.Single&&m(e.data,e.context)});return t})});
define("@ms/items-view/lib/private/facets/TelemetryFacets",["require","exports","../models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.telemetryHandlersConfigurationFacet=new n.Facet("telemetryHandlersConfiguration")});
define("odsp-next/models/itemsScope/ItemsScopeAddonHelper",["require","exports","tslib","@ms/items-view/lib/private/operations/getItems","@ms/items-view/lib/private/models/KeyFacet","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/operations/pageLoad","@ms/items-view/lib/private/operations/openItem","@ms/items-view/lib/private/models/Facet","./facets/OdspNextAppFacets","@ms/items-view/lib/private/operations/readItems"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=new a.Facet("keyFacetsToAddonLoaders");function h(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,s,o;return n.__generator(this,function(n){switch(n.label){case 0:t=e.currentItemKey;s=i.KeyFacet.get(t);return(o=r(l.readItems(function(e){var t=e.demandItemFacet(c,f.odspNextAppItemKey);return t&&t[s.id]})))?[4,r(o)]:[3,2];case 1:n.sent();n.label=2;case 2:return[2]}})})}}t.loadRequiredAddon=h;t.openItemWithAddon=function(e){return function(t){t(h(e));t(u.openItem(e))}};t.registerDeferredAddon=function(e,t){var i=this;return function(u){for(var a,l={},h=0,p=e;h<p.length;h++){var d=p[h];l[d.id]=t;u(s.registerOperationHandler(d,r.getItemsOperation)(s.createDeferredOperationHandler(function(){return n.__awaiter(i,void 0,void 0,function(){var e=this;return n.__generator(this,function(r){return[2,function(){return function(){return function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,u(o.waitForPageLoad())];case 1:e.sent();u(t);return[2]}})})}}}]})})})))}u(r.resolveItems({items:(a={},a[f.odspNextAppItemKey]=c.pack(l),a)}))}}});
define("odsp-next/controls/itemContent/itemsScope/ItemsScopeItemContent",["require","exports","tslib","react","office-ui-fabric-react/lib/Fabric","@uifabric/utilities/lib/css","@ms/odsp-shared-react/lib/utilities/resources/Resources","@ms/items-view/lib/private/components/decorators/connectToItemCache","./StickyHeaderContent","./ItemsViewContent","../../itemContent/itemsScope/ItemContentControl","../../itemsScope/CurrentItemsScope","../../../models/itemsScope/facets/OdspNextAppFacets","../../../models/itemCache/ItemCacheStore","./ItemContentControlHandlers","../../../bindings/component/ReactControlBinding","@ms/items-view/lib/private/components/backgroundTaskRunner/BackgroundTaskHost","@ms/items-view/lib/private/utilities/components/Async","@ms/items-view/lib/private/components/decorators/afterPageLoad","../ItemContent.css","./ItemsScopeItemContent.css","../../../utilities/icons/InitializeIcons"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";var b=this;Object.defineProperty(t,"__esModule",{value:!0});var w=y.afterPageLoad()(g.asAsync(function(){return n.__awaiter(b,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./TransclusionContent"],t,n)})];case 1:return[2,t.sent().TransclusionContent]}})})})),E=y.afterPageLoad()(g.asAsync(function(){return n.__awaiter(b,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["@ms/items-view/lib/private/components/itemAutoRefresh/ItemAutoRefresh"],t,n)})];case 1:return[2,t.sent().CurrentItemAutoRefresh]}})})})),S=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.headerContentAs,n=e.itemsViewContentAs,i=e.transclusionContentAs;return r.createElement(r.Fragment,null,r.createElement(t,null),r.createElement(n,null),r.createElement(i,null),r.createElement(E,null))};return t}(r.PureComponent),x=u.connectToItemCache(function(e){var t=e.demandItemFacet(l.itemContentControl,h.odspNextAppItemKey),n=l.itemContentControl.evaluate(t)(e,{headerContentAs:a.StickyHeaderContent,itemsViewContentAs:f.ItemsViewContent,transclusionContentAs:w});return{headerContentAs:n.headerContentAs,itemsViewContentAs:n.itemsViewContentAs,transclusionContentAs:n.transclusionContentAs}})(S),T=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.className,t=this.context.dependencies,o=t.currentItemsScope,u=t.itemContentControlHandlers;return r.createElement(i.Fabric,{className:s.css("od-ItemsScopeItemContent","od-ItemContent",e)},r.createElement(u,null,r.createElement(o,null,r.createElement(m.BackgroundTaskContextProvider,{scope:"global"},r.createElement(x,n.__assign({},this.props,this.context.dependencies))))))};t.contextTypes=o.RESOLVED_COMPONENT_CONTEXT_TYPES;return t}(r.PureComponent);t.default=T;t.resourceKey=o.createResolvedComponentTypeResourceKey(e("module").id,T,{itemCacheStore:p.resourceKey,currentItemsScope:c.resourceKey.local,itemContentControlHandlers:d.resourceKey});t.knockoutResourceKey=v.createKnockoutResourceKeyFromReactKey(t.resourceKey,{automationName:"ms-items-scope-item-content",name:e("module").id+".knockout"})});
define("odsp-next/controls/itemContent/itemsScope/StickyHeaderContent",["require","exports","react","@uifabric/utilities/lib/css","@uifabric/styling/lib/index","office-ui-fabric-react/lib/Sticky","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../../utilities/features/Features","./HeaderContent","../../base/react/WithResources"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.StickyHeaderContent=function(e){var t=f.useResourceScope(),l=r.css("od-ItemContent-header--sticky",!0===i.getTheme().isInverted?"od-header-bottom-sticky-shadow-dark-theme":"od-header-bottom-sticky-shadow-neutral-theme"),c=t.consume(o.platformDetection),h=n.createElement(a.HeaderContent,null);return u.isFeatureEnabled(u.MakeListHeaderSticky)&&!c.isMobile?n.createElement(s.Sticky,{stickyPosition:s.StickyPositionType.Header,stickyClassName:l},h):h}});
define("office-ui-fabric-react/lib/Sticky",["require","exports","tslib","./components/Sticky/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("office-ui-fabric-react/lib/components/Sticky/index",["require","exports","tslib","./Sticky","./Sticky.types"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("office-ui-fabric-react/lib/components/Sticky/Sticky",["require","exports","tslib","react","prop-types","../../Utilities","./Sticky.types"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._root=r.createRef();n._stickyContentTop=r.createRef();n._stickyContentBottom=r.createRef();n._nonStickyContent=r.createRef();n._placeHolder=r.createRef();n.syncScroll=function(e){var t=n.nonStickyContent;t&&n.props.isScrollSynced&&(t.scrollLeft=e.scrollLeft)};n._onScrollEvent=function(e,t){if(n.root&&n.nonStickyContent){var r=n._getNonStickyDistanceFromTop(e),i=!1,s=!1;if(n.canStickyTop){i=r-n._getStickyDistanceFromTop()<e.scrollTop}n.canStickyBottom&&e.clientHeight-t.offsetHeight<=r&&(s=r-Math.floor(e.scrollTop)>=n._getStickyDistanceFromTopForFooter(e,t));document.activeElement&&n.nonStickyContent.contains(document.activeElement)&&(n.state.isStickyTop!==i||n.state.isStickyBottom!==s)?n._activeElement=document.activeElement:n._activeElement=void 0;n.setState({isStickyTop:n.canStickyTop&&i,isStickyBottom:s,distanceFromTop:r})}};n._getStickyDistanceFromTop=function(){var e=0;n.stickyContentTop&&(e=n.stickyContentTop.offsetTop);return e};n._getStickyDistanceFromTopForFooter=function(e,t){var r=0;n.stickyContentBottom&&(r=e.clientHeight-t.offsetHeight+n.stickyContentBottom.offsetTop);return r};n._getNonStickyDistanceFromTop=function(e){var t=0,r=n.root;if(r){for(;r&&r.offsetParent!==e;){t+=r.offsetTop;r=r.offsetParent}r&&r.offsetParent===e&&(t+=r.offsetTop)}return t};n.state={isStickyTop:!1,isStickyBottom:!1,distanceFromTop:void 0};n._activeElement=void 0;return n}Object.defineProperty(t.prototype,"root",{get:function(){return this._root.current},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"placeholder",{get:function(){return this._placeHolder.current},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"stickyContentTop",{get:function(){return this._stickyContentTop.current},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"stickyContentBottom",{get:function(){return this._stickyContentBottom.current},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"nonStickyContent",{get:function(){return this._nonStickyContent.current},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"canStickyTop",{get:function(){return this.props.stickyPosition===o.StickyPositionType.Both||this.props.stickyPosition===o.StickyPositionType.Header},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"canStickyBottom",{get:function(){return this.props.stickyPosition===o.StickyPositionType.Both||this.props.stickyPosition===o.StickyPositionType.Footer},enumerable:!0,configurable:!0});t.prototype.componentDidMount=function(){var e=this.context.scrollablePane;if(e){e.subscribe(this._onScrollEvent);e.addSticky(this)}};t.prototype.componentWillUnmount=function(){var e=this.context.scrollablePane;if(e){e.unsubscribe(this._onScrollEvent);e.removeSticky(this)}};t.prototype.componentDidUpdate=function(e,t){var n=this.context.scrollablePane;if(n){var r=this.state,i=r.isStickyBottom,s=r.isStickyTop,o=r.distanceFromTop,u=!1;if(t.distanceFromTop!==o){n.sortSticky(this,!0);u=!0}if(t.isStickyTop!==s||t.isStickyBottom!==i){this._activeElement&&this._activeElement.focus();n.updateStickyRefHeights();u=!0}u&&n.syncScrollSticky(this)}};t.prototype.shouldComponentUpdate=function(e,t){if(!this.context.scrollablePane)return!0;var n=this.state,r=n.isStickyTop,i=n.isStickyBottom,s=n.distanceFromTop;return r!==t.isStickyTop||i!==t.isStickyBottom||this.props.stickyPosition!==e.stickyPosition||this.props.children!==e.children||s!==t.distanceFromTop||a(this._nonStickyContent,this._stickyContentTop)||a(this._nonStickyContent,this._stickyContentBottom)||a(this._nonStickyContent,this._placeHolder)};t.prototype.render=function(){var e=this.state,t=e.isStickyTop,n=e.isStickyBottom,i=this.props,s=i.stickyClassName,o=i.children;return this.context.scrollablePane?r.createElement("div",{ref:this._root},this.canStickyTop&&r.createElement("div",{ref:this._stickyContentTop,"aria-hidden":!t,style:{pointerEvents:t?"auto":"none"}},r.createElement("div",{style:this._getStickyPlaceholderHeight(t)})),this.canStickyBottom&&r.createElement("div",{ref:this._stickyContentBottom,"aria-hidden":!n,style:{pointerEvents:n?"auto":"none"}},r.createElement("div",{style:this._getStickyPlaceholderHeight(n)})),r.createElement("div",{style:this._getNonStickyPlaceholderHeightAndWidth(),ref:this._placeHolder},r.createElement("div",{ref:this._nonStickyContent,className:t||n?s:void 0,style:this._getContentStyles(t||n)},o))):r.createElement("div",null,this.props.children)};t.prototype.addSticky=function(e){this.nonStickyContent&&e.appendChild(this.nonStickyContent)};t.prototype.resetSticky=function(){this.nonStickyContent&&this.placeholder&&this.placeholder.appendChild(this.nonStickyContent)};t.prototype.setDistanceFromTop=function(e){var t=this._getNonStickyDistanceFromTop(e);this.setState({distanceFromTop:t})};t.prototype._getContentStyles=function(e){return{backgroundColor:this.props.stickyBackgroundColor||this._getBackground(),overflow:e?"hidden":""}};t.prototype._getStickyPlaceholderHeight=function(e){var t=this.nonStickyContent?this.nonStickyContent.offsetHeight:0;return{visibility:e?"hidden":"visible",height:e?0:t}};t.prototype._getNonStickyPlaceholderHeightAndWidth=function(){var e=this.state,t=e.isStickyTop,n=e.isStickyBottom;if(t||n){var r=0,i=0;if(this.nonStickyContent&&this.nonStickyContent.firstElementChild){r=this.nonStickyContent.offsetHeight;i=this.nonStickyContent.firstElementChild.scrollWidth+(this.nonStickyContent.firstElementChild.offsetWidth-this.nonStickyContent.firstElementChild.clientWidth)}return{height:r,width:i}}return{}};t.prototype._getBackground=function(){if(this.root){for(var e=this.root;"rgba(0, 0, 0, 0)"===window.getComputedStyle(e).getPropertyValue("background-color")||"transparent"===window.getComputedStyle(e).getPropertyValue("background-color");){if("HTML"===e.tagName)return;e.parentElement&&(e=e.parentElement)}return window.getComputedStyle(e).getPropertyValue("background-color")}};t.defaultProps={stickyPosition:o.StickyPositionType.Both,isScrollSynced:!0};t.contextTypes={scrollablePane:i.object};return t}(s.BaseComponent);t.Sticky=u;function a(e,t){return e&&t&&e.current&&t.current&&e.current.offsetHeight!==t.current.offsetHeight}});
define("office-ui-fabric-react/lib/components/Sticky/Sticky.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Both=0]="Both";e[e.Header=1]="Header";e[e.Footer=2]="Footer"}(t.StickyPositionType||(t.StickyPositionType={}))});
define("odsp-next/controls/itemContent/itemsScope/HeaderContent",["require","exports","tslib","react","@uifabric/utilities/lib/css","@ms/items-view/lib/private/controls/itemsBreadcrumbBetaControl","@ms/items-view/lib/private/components/decorators/withControlHandler","@ms/items-view/lib/private/components/itemsBreadcrumb/ItemsBreadcrumbBeta","@ms/items-view/lib/private/components/withItemCache/WithItemCache","./ItemContentBreadcrumb","./ItemContentBreadcrumbControl","../../../models/itemsScope/facets/OdspNextAppFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=i.css("od-ItemsScopeItemContent-header","od-ItemContent-header"),p=function(e,t){return{breadcrumbAs:f.default}};t.HeaderContent=function(e){return r.createElement("div",{className:h},r.createElement(a.WithItemCache,null,function(e){var t=e.itemCache.demandItemFacet(l.itemContentBreadcrumbControl,c.odspNextAppItemKey);return r.createElement(o.ControlHandlerProvider,{controlHandlers:n.__assign({},s.itemsBreadcrumbBetaControl.pack(s.itemsBreadcrumbBetaControl.compose(p,t)))},r.createElement(u.ItemsBreadcrumbBeta,null))}))}});
define("@ms/items-view/lib/private/controls/itemsBreadcrumbBetaControl",["require","exports","../models/controls/ControlFacet","../components/controls/defaultRenderComponentControlOption"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.crumbControl=new n.ControlFacet("crumbControl");t.itemsBreadcrumbBetaControl=new n.ControlFacet("itemsBreadcrumbBetaControl",{crumbControlHandler:n.childControlOption(t.crumbControl),breadcrumbAs:r.defaultRenderComponentOption()})});
define("@ms/items-view/lib/private/components/controls/defaultRenderComponentControlOption",["require","exports","tslib","react","../../utilities/Memoizer","../decorators/connectToItemCache"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function o(e){var t=e;return i.createMemoizer(function(s){if(e===s)throw new Error("Attempted to compose a component with itself.");var o=s,u=i.createMemoizer(function(e){return function(t){return r.createElement(o,n.__assign({},t,{defaultRender:e}))}});return function(e){var i=e.defaultRender;return r.createElement(t,n.__assign({},e,{defaultRender:i?u(i):o}))}})}function u(e){var t=e;return i.createMemoizer(function(n){if(e===n)throw new Error("Attempted to compose a component with itself.");var r=n,o=i.createMemoizer(function(e){var t=s.connectToItemCache(function(t,n){return{defaultRender:e}})(r);t.displayName="InnerWithDefaultRender";return t}),u=s.connectToItemCache(function(e,t){var n=t.defaultRender;return{defaultRender:n?o(n):r}})(t);u.displayName="OuterWithDefaultRender";return u})}t.defaultRenderComponentOption=function(e){void 0===e&&(e={});var t=e.useItemCache,n=void 0!==t&&t,r=i.createMemoizer(n?u:o);return{merge:function(e,t){return t&&e&&"function"==typeof t&&"function"==typeof e&&r(t)(e)||t||e}}}});
define("@ms/items-view/lib/private/components/itemsBreadcrumb/ItemsBreadcrumbBeta",["require","exports","tslib","react","office-ui-fabric-react/lib/Breadcrumb","../../controls/itemsBreadcrumbBetaControl","../withItemCache/WithItemCache","../../facets/ItemFacets","../actions/open/OpenAction","../withAction/WithAction","../decorators/selectors","../telemetry/TelemetryProvider","@uifabric/experiments/lib/components/signals/Signals","./ItemsBreadcrumb.scss","office-ui-fabric-react/lib/Tooltip","../../models/items/ItemStrings.resx","../actions/manageAccess/ManageAccessAction","../decorators/connectToItemsScope","../defaultDropZone/DefaultDropZone"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=c.createTelemetryProvider({withContext:{component:"Breadcrumb"}}),w=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,u=t.itemKey,a=t.tooltipHostProps,c=void 0===a?{}:a,h=n.__rest(t,["itemKey","tooltipHostProps"]),p=c.calloutProps,d=void 0===p?{}:p;return r.createElement(b,null,r.createElement(o.WithItemCache,null,function(t){var o=t.itemCache,a=g.getItemsScope(o).itemsScopeItemKey;if(!a)throw new Error("Cannot use an ItemsBreadcrumbBeta outside of an ItemsScope.");for(var p=l.getItemKey(o,{itemKey:u})||u,v=o.demandItemFacet(s.itemsBreadcrumbBetaControl,p),b=s.itemsBreadcrumbBetaControl.evaluate(v)(o,{itemKey:u,itemsScopeItemKey:a,leafItemKey:p,crumbControlHandler:s.crumbControl.default,breadcrumbAs:i.Breadcrumb}),w=b.leafItemKey,E=b.crumbControlHandler,S=b.breadcrumbAs,x={},T={},C={},k={},L=[],A=w;A&&!(A in x);){var O=N(o,{crumbControlHandler:E,currentItemKey:A}),M=O.displayName,_=O.parentItemKey,D=O.action,P=O.isSharedItem;T[A]=M;x[A]=f.evaluateAction(o,D);C[A]=P;k[A]=f.evaluateAction(o,r.createElement(y.ItemDefaultDropZone,{itemKey:l.getItemKey(o,{itemKey:A}),showDropTargetHint:!0}));L.unshift(A);A=_}x.share=f.evaluateAction(o,r.createElement(m.ItemManageAccessAction,{itemKey:p}));return r.createElement(f.WithActionSet,{actions:x},function(t){var i=t.actions,s=L.map(function(e){var t=i[e],n=t&&!!t.isToggled,r=t&&t.isAvailable?function(){t.execute({}).catch(function(){})}:void 0,s=C[e]&&n,o=s?i.share:void 0,u=o&&o.isAvailable?function(){o.execute({}).catch(function(){})}:void 0;return{text:T[e]||"​",key:e,onClick:r,isSharedItem:s,isCurrentItem:!!n,onClickShare:u,dragDropElement:n?null:k[e]}});return r.createElement(S,n.__assign({},h,{tooltipHostProps:n.__assign({calloutProps:n.__assign({isBeakVisible:!1},d)},c),items:s,onRenderItem:e._onRenderBreadcrumbItem}))})}))};t.prototype._onRenderBreadcrumbItem=function(e,t){var n=e&&e.isCurrentItem&&e.isSharedItem?r.createElement(d.TooltipHost,{content:v.default.sharedFolderTooltip,id:"breadcrumbSharedIcon",calloutProps:{gapSpace:0}},r.createElement(h.SharedSignal,{onClick:e.onClickShare,className:p.sharedPeopleIcon,"aria-labelledby":"breadcrumbSharedIcon"})):null,i=e&&e.dragDropElement||null;return y.renderChildrenWithDropZoneElement(r.createElement(r.Fragment,null,t&&e&&t(e),n),i)};return t}(r.PureComponent);t.ItemBreadcrumbBeta=w;t.ItemsBreadcrumbBeta=l.withCurrentItemSet()(w);t.ItemsBreadcrumbBeta.displayName="ItemsBreadcrumbBeta";function E(e,t){var n=e.demandItemFacet(u.parentFolderItemFacet,l.getItemKey(e,{itemKey:t.itemKey}));return n&&n.itemKey}function S(e,t){return e.demandItemFacet(u.isSharedFacet,l.getItemKey(e,{itemKey:t.itemKey}))}function x(e,t){return e.demandItemFacet(u.displayNameFacet,l.getItemKey(e,{itemKey:t.itemKey}))}function T(e,t){return r.createElement(a.ItemOpenAction,{itemKey:t.itemKey})}function N(e,t){var n=t.currentItemKey,r=t.crumbControlHandler;return s.crumbControl.evaluate(r)(e,{itemKey:n,displayName:x(e,{itemKey:n}),parentItemKey:E(e,{itemKey:n}),action:T(0,{itemKey:n}),isSharedItem:S(e,{itemKey:n})})}});
define("office-ui-fabric-react/lib/Breadcrumb",["require","exports","tslib","./components/Breadcrumb/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("office-ui-fabric-react/lib/components/Breadcrumb/index",["require","exports","tslib","./Breadcrumb","./Breadcrumb.base"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("office-ui-fabric-react/lib/components/Breadcrumb/Breadcrumb",["require","exports","../../Utilities","./Breadcrumb.base","./Breadcrumb.styles"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Breadcrumb=n.styled(r.BreadcrumbBase,i.getStyles,void 0,{scope:"Breadcrumb"})});
define("office-ui-fabric-react/lib/components/Breadcrumb/Breadcrumb.base",["require","exports","tslib","react","../../Utilities","../../FocusZone","../../Link","../../Icon","../../Button","../../common/DirectionalHint","../../ResizeGroup","../../Tooltip"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=i.classNamesFunction(),p="overflow",d=function(){return null},v=function(e){n.__extends(t,e);function t(t){var l=e.call(this,t)||this;l._focusZone=r.createRef();l._onReduceData=function(e){var t=e.renderedItems,r=e.renderedOverflowItems,i=e.props.overflowIndex,s=t[i];(t=t.slice()).splice(i,1);r=r.concat([s]);if(void 0!==s)return n.__assign({},e,{renderedItems:t,renderedOverflowItems:r})};l._onRenderBreadcrumb=function(e){var t=e.props,o=t.ariaLabel,c=t.dividerAs,h=void 0===c?u.Icon:c,v=t.onRenderItem,m=void 0===v?l._onRenderItem:v,g=t.overflowAriaLabel,y=t.overflowIndex,b=e.renderedOverflowItems,w=e.renderedItems,E=b.map(function(e,t){return{name:e.text,key:e.key,onClick:e.onClick?l._onBreadcrumbClicked.bind(l,e):null,href:e.href}}),S=w.length-1,x=b&&0!==b.length,T=w.map(function(e,t){return r.createElement("li",{className:l._classNames.listItem,key:e.key||String(t)},m(e,l._onRenderItem),(t!==S||x&&t===y-1)&&r.createElement(h,{className:l._classNames.chevron,iconName:i.getRTL()?"ChevronLeft":"ChevronRight",item:e}))});x&&T.splice(y,0,r.createElement("li",{className:l._classNames.overflow,key:p},r.createElement(a.IconButton,{className:l._classNames.overflowButton,iconProps:{iconName:"More"},role:"button","aria-haspopup":"true",ariaLabel:g,onRenderMenuIcon:d,menuProps:{items:E,directionalHint:f.DirectionalHint.bottomLeftEdge}}),y!==S+1&&r.createElement(h,{className:l._classNames.chevron,iconName:i.getRTL()?"ChevronLeft":"ChevronRight",item:b[b.length-1]})));var N=i.getNativeProps(l.props,i.htmlElementProperties,["className"]);return r.createElement("div",n.__assign({className:l._classNames.root,role:"navigation","aria-label":o},N),r.createElement(s.FocusZone,n.__assign({componentRef:l._focusZone,direction:s.FocusZoneDirection.horizontal},l.props.focusZoneProps),r.createElement("ol",{className:l._classNames.list},T)))};l._onRenderItem=function(e){return e.onClick||e.href?r.createElement(o.Link,{className:l._classNames.itemLink,href:e.href,"aria-current":e.isCurrentItem?"page":void 0,onClick:l._onBreadcrumbClicked.bind(l,e)},r.createElement(c.TooltipHost,n.__assign({content:e.text,overflowMode:c.TooltipOverflowMode.Parent},l.props.tooltipHostProps),e.text)):r.createElement("span",{className:l._classNames.item},r.createElement(c.TooltipHost,n.__assign({content:e.text,overflowMode:c.TooltipOverflowMode.Parent},l.props.tooltipHostProps),e.text))};l._onBreadcrumbClicked=function(e,t){e.onClick&&e.onClick(t,e)};l._validateProps(t);return l}t.prototype.focus=function(){this._focusZone.current&&this._focusZone.current.focus()};t.prototype.render=function(){var e=this.props,t=e.onReduceData,n=void 0===t?this._onReduceData:t,i=e.overflowIndex,s=e.maxDisplayedItems,o=e.items,u=e.className,a=e.theme,f=e.styles,c=o.slice(),p=c.splice(i,c.length-s),d={props:this.props,renderedItems:c,renderedOverflowItems:p};this._classNames=h(f,{className:u,theme:a});return r.createElement(l.ResizeGroup,{onRenderData:this._onRenderBreadcrumb,onReduceData:n,data:d})};t.prototype.componentWillReceiveProps=function(e){this._validateProps(e)};t.prototype._validateProps=function(e){var t=e.maxDisplayedItems,n=e.overflowIndex,r=e.items;if(n<0||t>1&&n>t-1||r.length>0&&n>r.length-1)throw new Error("Breadcrumb: overflowIndex out of range")};t.defaultProps={items:[],maxDisplayedItems:999,overflowIndex:0};return t}(i.BaseComponent);t.BreadcrumbBase=v});
define("office-ui-fabric-react/lib/components/Breadcrumb/Breadcrumb.styles",["require","exports","../../Styling","../../Utilities"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},s=n.getScreenSelector(0,n.ScreenWidthMaxSmall),o=n.getScreenSelector(n.ScreenWidthMinMedium,n.ScreenWidthMaxMedium);t.getStyles=function(e){var t,u,a,f,l=e.className,c=e.theme;return{root:["ms-Breadcrumb",c.fonts.medium,{margin:"23px 0 1px"},l],list:["ms-Breadcrumb-list",{whiteSpace:"nowrap",padding:0,margin:0,display:"flex",alignItems:"stretch"}],listItem:["ms-Breadcrumb-listItem",{listStyleType:"none",margin:"0",padding:"0",display:"flex",position:"relative",alignItems:"center"}],chevron:["ms-Breadcrumb-chevron",{color:c.palette.neutralSecondary,fontSize:c.fonts.small.fontSize,selectors:(t={},t[n.HighContrastSelector]={color:"WindowText",MsHighContrastAdjust:"none"},t[o]={fontSize:8},t[s]={fontSize:8},t)}],overflow:["ms-Breadcrumb-overflow",{position:"relative",display:"flex",alignItems:"center"}],overflowButton:["ms-Breadcrumb-overflowButton",n.getFocusStyle(c),i,{fontSize:16,height:"100%",cursor:"pointer",selectors:(u={":hover":{backgroundColor:c.palette.neutralLighter},":active":{backgroundColor:c.palette.neutralTertiaryAlt,color:c.semanticColors.bodyText},":hover:active":{backgroundColor:c.palette.neutralQuaternary}},u[s]={padding:"4px 6px"},u[o]={fontSize:c.fonts.mediumPlus.fontSize},u)}],itemLink:["ms-Breadcrumb-itemLink",n.getFocusStyle(c),i,c.fonts.xLarge,{textDecoration:"none",color:c.semanticColors.bodyText,padding:"0 8px",selectors:(a={":hover":{backgroundColor:c.semanticColors.menuItemBackgroundHovered,color:"initial",cursor:"pointer",selectors:(f={},f[n.HighContrastSelector]={color:"Highlight"},f)},":focus":{color:c.palette.neutralDark},":active":{backgroundColor:c.palette.neutralTertiaryAlt,color:c.palette.neutralPrimary}},a[o]=c.fonts.large,a[s]=[c.fonts.medium],a["."+r.IsFocusVisibleClassName+" &:focus"]={outline:"none"},a)}],item:["ms-Breadcrumb-item",c.fonts.xLarge,{color:c.semanticColors.bodyText,padding:"0 8px",selectors:{":hover":{cursor:"default"}}}]}}});
define("@ms/items-view/lib/private/components/withItemCache/WithItemCache",["require","exports","react","../decorators/connectToItemCache","../../utilities/components/RenderProps"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WithItemCache=r.connectToItemCache(function(e,t){var n=t.children,r=e.dispatch;return{children:i.renderChildrenWithProps(n,{itemCache:e,dispatch:r})}},function(){return{}})(n.Fragment);t.WithItemCache.displayName="WithItemCache"});
define("@ms/items-view/lib/private/components/actions/open/OpenAction",["require","exports","tslib","../../../operations/openItem","../../../facets/ScopeFacets","../../../controls/openActionControl","../../decorators/connectToItemCache","../../action/Action","../../decorators/selectors","../../decorators/connectToItemsScope","../../../models/telemetry/getItemEngagement"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";var c=this;Object.defineProperty(t,"__esModule",{value:!0});t.ItemOpenAction=o.connectToItemCache(function(e,t){var o=t.itemKey,u=e.dispatch,a=f.getItemsScope(e).itemsScopeItemKey,p=e.demandItemFacet(i.currentItemFacet,a),d=p&&p.itemKey,v=e.demandItemFacet(s.openActionControl,o);if(!a)return{};var m=s.openActionControl.evaluate(v)(e,{itemKey:o,itemsScopeItemKey:a,openItem:r.openItem,stageItem:h,isAvailable:!0}),g=m.itemKey,y=m.openItem,b=m.stageItem,w=m.isAvailable,E=g?function(){return n.__awaiter(c,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:e={currentItemKey:g,itemsScopeItemKey:a};return b?[4,u(b(e))]:[3,2];case 1:t.sent();t.label=2;case 2:return[4,u(y(e))];case 3:t.sent();return[2]}})})}:void 0;return n.__assign({isAvailable:!!g&&g!==d&&w,isToggled:g===d,onExecute:E},l.getItemActionEngagement(e,{itemKey:g,engagement:{name:"Open",isIntentional:!0}}))})(u.Action);t.OpenAction=a.withSelectedItems()(a.withExactlyOneItem()(t.ItemOpenAction));function h(e){var t=this;return function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})})}}});
define("@ms/items-view/lib/private/controls/openActionControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openActionControl=new n.ControlFacet("openActionControl")});
define("@ms/items-view/lib/private/components/action/Action",["require","exports","tslib","../../utilities/async/CancelError","../../facets/LoggerFacets","../telemetry/TelemetryProvider","@ms/telemetry-manager/lib/events/Engagement.event","@ms/telemetry-manager/lib/events/Qos.event","../withAction/WithAction"],function(e,t,n,r,i,s,o,u,a){"use strict";var f=this;Object.defineProperty(t,"__esModule",{value:!0});t.ActionBase=a.ActionBase;t.Action=s.withTelemetry(function(e,t){var s=e.telemetry,a=t.onExecute,l=t.engagement,c=void 0===l?{name:"Action"}:l,h=t.getEngagement;return a?{onExecute:function(e){return n.__awaiter(f,void 0,void 0,function(){var t,f,l,p,d,v,m;return n.__generator(this,function(g){switch(g.label){case 0:t=e.event&&e.event.dataTransfer?"Drop":"Click";l=[{usageType:t}];return h?[4,h()]:[3,2];case 1:p=g.sent();return[3,3];case 2:p={};g.label=3;case 3:f=n.__assign.apply(void 0,l.concat([p,c]));d=f.name;s(o.Engagement).withData(function(e){return n.__assign({},e,f)}).logData({name:d});v=new(s(u.Qos).withData(function(e){return n.__assign({},e)}))({name:d});g.label=4;case 4:g.trys.push([4,6,,7]);return[4,a(e)];case 5:g.sent();v.end({resultType:i.ResultType.success});return[3,7];case 6:m=g.sent();r.isCancel(m)?v.end({resultType:i.ResultType.expectedFailure}):v.end({resultType:i.ResultType.failure});throw m;case 7:return[2]}})})}}:{}})(a.ActionBase);t.Action.displayName="Action"});
define("@ms/items-view/lib/private/components/telemetry/TelemetryProvider",["require","exports","tslib","react","../../controls/telemetryContextControl","../decorators/withControlHandler","../decorators/connectToItemCache","../../utilities/components/RenderProps","../../operations/telemetry/getTelemetryManager","../../operations/readItems","../../hooks/useItemCacheSelector"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c={},h=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._telemetryContextControlHandler=function(e,t){return{withContext:n.props.withContext}};n._controlHandlers=i.telemetryContextControl.pack(n._telemetryContextControlHandler);return n}t.prototype.render=function(){return s.renderChildrenWithControlHandlers(this.props.children,this._controlHandlers)};return t}(r.PureComponent);t.TelemetryProvider=h;t.createTelemetryProvider=function(e){var t=e.withContext,n=i.telemetryContextControl.pack(function(){return{withContext:t}});return function(e){var t=e.children;return s.renderChildrenWithControlHandlers(t,n)}};t.withTelemetry=function(e){return function(t){return o.connectToItemCache(function(t,n){var r=p(t);return e?e(r,n):r})(t)}};function p(e){var t=e.dispatch,n=e.demandItemFacet(i.telemetryContextControl,void 0);return{telemetry:function(e){var r=t(a.getTelemetryManager),s=t(f.readItems(function(e){return i.telemetryContextControl.evaluate(n)(e,{itemKey:void 0,withContext:c})})).withContext;return e.withManager(r).withContext(s)}}}t.getTelemetry=p;function d(){return l.useItemCacheSelector(p,[])}t.useTelemetry=d;t.TelemetryConsumer=function(e){return u.renderChildrenWithProps(e.children,d())}});
define("@ms/items-view/lib/private/controls/telemetryContextControl",["require","exports","tslib","../models/controls/ControlFacet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.telemetryContextControl=new r.ControlFacet("telemetryContext",{withContext:{merge:function(e,t){return function(r){e&&(r="function"==typeof e?n.__assign({},r,e(r)):n.__assign({},e,r));t&&(r="function"==typeof t?n.__assign({},r,t(r)):n.__assign({},t,r));return r}}}})});
define("@ms/items-view/lib/private/hooks/useItemCacheSelector",["require","exports","tslib","react","../components/decorators/withControlHandler","../operations/getItems","../models/itemCache/ItemCacheEvaluator","../operations/pruneItems","./useShallowMemo","../models/itemCache/bindItemCacheSelectorToProps","../components/decorators/connectToItemCache.v2","./useDebugOwner"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemCacheHooksProvider=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(h,{store:this.props.store},this.props.children)};return t}(r.PureComponent);function h(e){var t=e.store,n=function(e){var t=r.useState(e.getState),n=t[0],i=t[1],s=r.useRef(0);r.useLayoutEffect(function(){return e.subscribe(function(){s.current+=1;i(e.getState())})},[e]);return[n,e.dispatch]}(t)[0],i=r.useMemo(function(){return{store:t,storeState:n}},[n,t]);return r.createElement(l.ITEM_CACHE_CONTEXT.Provider,{value:i},e.children)}function p(){var e=r.useContext(l.ITEM_CACHE_CONTEXT);if(!e)throw new Error("Cannot invoke useItemCacheDispatch from a component outside of an ItemCacheProvider or ItemsScope. Make sure that useItemCacheDispatch is being invoked inside a component which has an ItemCacheProvider or ItemsScope in its React ancestry.");return e.store.dispatch}t.useItemCacheDispatch=p;function d(e,t){var n=c.useDebugOwner(),a=r.useContext(l.ITEM_CACHE_CONTEXT);if(!a)throw new Error("Cannot invoke useItemCache from a component outside of an ItemCacheProvider or ItemsScope. Make sure that useItemCache is being invoked inside a component which has as ItemCacheProvider or ItemsScope in its React ancestry.");var f=a.store,h=a.storeState,p=f.dispatch,d=r.useMemo(function(){return p(o.getItemCacheEvaluator)},[p]),v=r.useMemo(function(){return e},t),m=r.useContext(i.CONTROL_HANDLER_CONTEXT),g=c.suspendReactEnvironment(function(){return d.evaluate({selector:v,controlHandlers:m,state:h,owner:n,suspender:n})}),y=g.result,b=g.demands,w=g.dependencies;!function(e){var t=e.dispatch,n=e.demands,i=e.dependencies,o=e.owner;r.useLayoutEffect(function(){t(u.registerItemDemands({items:i,owner:o}));t(u.recordLastItemAccesses({items:i}))},[t,i]);r.useLayoutEffect(function(){return function(){t(u.removeItemDemands({owner:o}))}},[t]);r.useLayoutEffect(function(){t(s.batchedGetItems({items:n}))},[t,n,i])}({dispatch:p,demands:b,dependencies:w,owner:n});return y}t.useItemCacheSelector=d;t.withItemCacheSelector=function(e,t){var i=t?Object.keys(t):void 0;return function(t){var s=t;return function(t){var o=a.useShallowMemo(function(){return t},t),u=i?i.map(function(e){return o[e]}):[o],l=r.useMemo(function(){return f.bindItemCacheSelectorToProps(e,o)},u),c={itemCacheDispatch:p()},h=d(l,[l]),v=r.useMemo(function(){return n.__assign({},o,h,c)},[o,h]);return r.useMemo(function(){return s===r.Fragment?r.createElement(r.Fragment,null,v.children):r.createElement(s,n.__assign({},v))},[v])}}}});
define("@ms/items-view/lib/private/hooks/useShallowMemo",["require","exports","react","@ms/utilities-objects/lib/areShallowEqual"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.useShallowMemo=function(e,t){var i=n.useRef();r.areShallowDifferent(i.current,t,{debug:!0})&&(i.current=t);return n.useMemo(e,[i.current])}});
define("@ms/items-view/lib/private/components/withAction/WithAction",["require","exports","tslib","react","../../utilities/components/RenderProps","../decorators/connectToItemCache","../../utilities/objects","../../utilities/components/Relay","../../utilities/Memoizer","../../utilities/Graft","../../hooks/useShallowMemo","../../hooks/useAssignObjects","../backgroundTaskRunner/BackgroundTaskHost","../../utilities/async/CancelError","../../utilities/async/Signal"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.state={};return n}t.getDerivedStateFromError=function(e){return{error:e}};t.prototype.render=function(){return this.state.error?null:r.createElement(r.Fragment,null,this.props.children)};t.prototype.componentDidCatch=function(e){this.props.reject(e)};t.prototype.componentWillUnmount=function(){this.props.reject(new p.CancelError({message:"The task host for the Wizard action was unmounted before the action completed."}))};return t}(r.PureComponent),m=a.createMemoizer(function(e){return{actions:e}}),g={},y=u.createRelay(g,{propsFilter:{isAvailable:!0,isToggled:!0,onExecute:!0}});t.renderComponentOnExecute=function(e,t){var i=this;void 0===t&&(t={});var s=e,o=t.scope,u=void 0===o?"local":o;return function(e){return n.__awaiter(i,void 0,void 0,function(){var t,i,o,a,f,l,c,h;return n.__generator(this,function(p){switch(p.label){case 0:t=e.backgroundTaskQueues;if(!(i=t[u]))throw new Error("No background task queue with scope '"+u+"' available to execute action.");o=new d.Signal,a=o.promise,f=o.resolve,l=o.reject;c={resolve:f,reject:l,onExecuteProps:e};h=r.createElement(v,n.__assign({},c),r.createElement(s,n.__assign({},c)));i.enqueue({content:h,promise:a,scope:u});return[4,a];case 1:p.sent();return[2]}})})}};var b="isAvailable";t.ActionBase=y.Sender;function w(e){var t=e;return"function"==typeof t?r.createElement(t,null):t||null}t.renderAction=w;function E(e){return w(e.action)}t.ActionSelector=E;o.assign(E,s.contentLinkFacet.pack({}));t.evaluateAction=function(e,t){return s.evaluateItemCacheComponent(e,w(t))};t.INITIAL_ACTION_STATE={isAvailable:!1,executingCount:0,execute:A};var S=function(e){n.__extends(t,e);function t(t,n,r){var i=e.call(this)||this;i._key=t;i._onExecute=n;i._wrapExecute=r;return i}t.prototype.apply=function(e){var t=this._key,n=this._onExecute,r=this._wrapExecute;return e&&e.wrapped===this._onExecute?e:r(t,n)};return t}(f.Patch);function x(e,t){return function(n){var r;return f.graft(n,((r={})[e]=new f.IncrementPatch(t),r))}}function T(e,t){var i=r.useState({}),s=i[0],u=i[1],a=r.useRef();r.useLayoutEffect(function(){return function(){a.current=!0}},[]);function l(e,r){var i=this;if(!r)return A;var s=function(s){void 0===s&&(s={});return n.__awaiter(i,void 0,void 0,function(){return n.__generator(this,function(i){switch(i.label){case 0:u(x(e,1));i.label=1;case 1:i.trys.push([1,,3,4]);return[4,r(n.__assign({},s,{backgroundTaskQueues:t}))];case 2:i.sent();return[3,4];case 3:a.current||u(x(e,-1));return[7];case 4:return[2]}})})};s.wrapped=r;return s}var c=r.useRef({});return r.useMemo(function(){return c.current=(t=c.current,n=o.mapObject(e,function(e,t){void 0===e&&(e=g);void 0===t&&(t="action");var n=s[t],r=void 0===n?0:n,i=e.isToggled,o=e.onExecute;return{isToggled:i,isAvailable:b in e?!!e.isAvailable:!!o,execute:new S(t,o,l),executingCount:r}}),f.graft({values:t},{values:new f.MirrorPatch(n)}).values);var t,n},[s,e])}t.WithActionSet=function(e){var t=e.actions,n=e.children,r=e.onActionsUpdated;return N(t,m,n,r)};t.useActionSet=function(e){var t=C(e);return[t[0],t[1]]};t.WithAction=function(e){var n,r=e.action,i=e.children,s=e.actionKey,o=void 0===s?"action":s,u=e.onActionUpdated;return N(((n={})[o]=r||null,n),function(e){return e[o]||t.INITIAL_ACTION_STATE},i,u)};t.useAction=function(e){var n=C(r.useMemo(function(){return{action:e}},[e])),i=n[0].action,s=n[1];return[i||t.INITIAL_ACTION_STATE,s]};function N(e,t,n,s){var o=L(e),u=o[0],a=o[1],f=k(),l=f[0],h=f[1];return r.createElement(r.Fragment,null,h,r.createElement(y.Receiver,{values:a},function(e){var o=e.values,a=T(c.useAssignObjects(o,u),l),f=t(a);r.useLayoutEffect(function(){s&&s(f)},[f,s]);return i.renderChildrenWithProps(n,f)}))}function C(e){var t=L(e),n=t[0],i=t[1],s=r.useState({}),o=s[0],u=s[1];function a(e){var t=e.values;r.useLayoutEffect(function(){u(t)},[t]);return null}var f=r.useMemo(function(){return Object.keys(i).length>0?r.createElement(y.Receiver,{values:i},a):null},[i]),l=c.useAssignObjects(o,n),h=k(),p=h[0],d=h[1];return[T(l,p),r.useMemo(function(){return r.createElement(r.Fragment,null,f,d)},[f,d])]}function k(){var e=h.useBackgroundTaskHost({}),t=e[0],n=e[1];return[h.useComposedBackgroundTaskQueues({scope:"local",queue:t}),n]}function L(e){return l.useShallowMemo(function(){var n={},r={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var s=w(e[i]);s?s.type===t.ActionBase?n[i]=s.props:r[i]=s:n[i]=g}return[n,r]},e)}function A(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})})}});
define("@ms/items-view/lib/private/utilities/components/Relay",["require","exports","react","./RenderProps","../Graft","../objects","../Memoizer","../../hooks/useShallowMemo"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createRelay=function(e,t){void 0===t&&(t={});var a=t.merge,f=void 0===a?function(e){return new i.MirrorPatch(e)}:a,l=t.remove,c=void 0===l?function(){return new i.Delete}:l,h=t.allowSenderOutsideReceiver,p=void 0!==h&&h,d=t.propsFilter,v=n.createContext(void 0),m=n.createContext("");function g(e){var t=e.receiver,i=e.children,s=n.useState(t.receiverState)[1];t.contentSetState=s;var o=t.lastRenderedState=t.receiverState;return r.renderChildrenWithProps(i,t.mapStateToProps(o))}function y(e){var t=n.useContext(m),r=n.useContext(v);if(!r&&!p)throw new Error("Cannot render a Sender outside of a available Receiver.");var o=u.useShallowMemo(function(){return d?s.pickObject(e,d):e},e);n.useMemo(function(){r&&function(e){var t,n=e.senderKey,r=e.receiver;r.receiverState=i.graft(r.receiverState,{values:(t={},t[n]=f(e.value),t)})}({value:o,senderKey:t,receiver:r})},[o,r]);n.useLayoutEffect(function(){r&&function(e){var t,n=e.senderKey,r=e.receiver;r.receiverState=i.graft(r.receiverState,{values:(t={},t[n]=f(e.value),t)});r.receiverState!==r.lastRenderedState&&r.contentSetState&&r.contentSetState(r.receiverState)}({value:o,senderKey:t,receiver:r})},[o,r]);n.useLayoutEffect(function(){if(r)return function(){!function(e){var t,n=e.senderKey,r=e.receiver;r.receiverState=i.graft(r.receiverState,{values:(t={},t[n]=c(e.value),t)});r.isDisposed||r.receiverState===r.lastRenderedState||r.contentSetState&&r.contentSetState(r.receiverState)}({value:o,senderKey:t,receiver:r})}},[r])}return{Receiver:function(t){var r=t.values,i=t.children,u=n.useRef(),a=n.useRef(t);a.current=t;var f=u.current||(u.current={receiverState:{values:{}},lastRenderedState:void 0,contentSetState:void 0,isDisposed:void 0,mapStateToProps:o.createMemoizer(function(t){return{values:s.mapObject(a.current.values,function(n,r){return r in t.values?t.values[r]:e})}})});n.useLayoutEffect(function(){return function(){f.isDisposed=!0}},[]);var l=Object.keys(r).map(function(e){var t=r[e];return n.createElement(m.Provider,{key:e,value:e},t)});return n.createElement(n.Fragment,null,l.length?n.createElement(v.Provider,{key:"context",value:f},l):null,n.createElement(g,{key:"content",children:i,receiver:f}))},Sender:function(e){y(e);return null},useSender:y}}});
define("@ms/items-view/lib/private/hooks/useAssignObjects",["require","exports","react","tslib"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.useAssignObjects=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.useMemo(function(){return r.__assign.apply(r,[{}].concat(e))},e)}});
define("@ms/items-view/lib/private/components/decorators/selectors",["require","exports","tslib","../../facets/ScopeFacets","./connectToItemCache","../../controls/selectedItemsControl","./connectToItemsScope","../../models/items/getItemSetKey","../../models/items/getItemKey","../../models/itemsScope/getCurrentItemSetKey"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getItemSetKey=u.getItemSetKey;t.getItemKey=a.getItemKey;t.getCurrentItemSetKey=f.getCurrentItemSetKey;var l=[];function c(e,t){return t}function h(e){return function(t){return function(r,i){var s=e(r,i);return t(r,n.__assign({},i,s))}}}function p(){return h(o.getItemsScope)}function d(){return h(p()(function(e,t){var n=t.itemsScopeItemKey;if(!n)return{itemKeys:l};var i=e.demandItemFacet(s.selectedItemsControl,void 0),o=s.selectedItemsControl.evaluate(i)(e,{itemsScopeItemKey:n}).itemKeys;return{itemKeys:void 0===o?function(e,t){var n=e.demandItemFacet(r.selectedItemsFacet,t);return n&&n.itemKeys||l}(e,n):o}}))}t.withSelectedItems=function(){return function(e){var t=i.connectToItemCache(d()(c))(e);t.displayName="WithSelectedItems";return t}};function v(){return h(p()(function(e,t){var n=e.demandItemFacet(r.currentItemFacet,t.itemsScopeItemKey);return{itemKey:a.getItemKey(e,{itemKey:n&&n.itemKey})}}))}t.withCurrentItem=function(){return function(e){var t=i.connectToItemCache(v()(c))(e);t.displayName="WithCurrentItem";return t}};t.withCurrentItemSet=function(){return function(e){var t=i.connectToItemCache(h(function(e,t){return{itemKey:f.getCurrentItemSetKey(e)}})(c))(e);t.displayName="WithCurrentItemSet";return t}};t.withOnlyCurrentItem=function(){return function(e){var t=i.connectToItemCache(h(v()(d()(function(e,t){return{itemKey:t.itemKeys.length>0?void 0:t.itemKey}})))(c))(e);t.displayName="WithOnlyCurrentItem";return t}};t.withExactlyOneItem=function(){return function(e){var t=i.connectToItemCache(h(function(e,t){var n=t.itemKeys;return{itemKey:1===n.length?n[0]:void 0}})(c))(e);t.displayName="WithExactlyOneItem";return t}};t.withCurrentItemAsFallback=function(){return function(e){var t=i.connectToItemCache(h(v()(function(e,t){var n=t.itemKeys,r=t.itemKey;return{itemKeys:n.length>0?n||l:r&&[r]||l}}))(c))(e);t.displayName="WithCurrentItemAsFallback";return t}}});
define("@ms/items-view/lib/private/controls/selectedItemsControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.selectedItemsControl=new n.ControlFacet("selectedItems")});
define("@ms/items-view/lib/private/models/items/getItemSetKey",["require","exports","../../facets/SetFacets"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getItemSetKey=function(e,t){var r=t.itemKey;if(r){var i=e.demandItemFacet(n.defaultChildItemSetFacet,r);i&&(r=i.itemKey)}return r}});
define("@ms/items-view/lib/private/facets/SetFacets",["require","exports","../models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.childItemsFacet=new n.Facet("childItems");t.schemaFacet=new n.Facet("schema");t.defaultChildItemSetFacet=new n.Facet("defaultChildItemSet");t.childItemSetsFacet=new n.Facet("childItemSets");t.parentItemFacet=new n.Facet("parentItem");t.parentItemSetsFacet=new n.Facet("parentItemSets");t.pageFacet=new n.Facet("page");t.filterOptionSetsFacet=new n.Facet("filterOptionSets");t.sortFacet=new n.Facet("sort")});
define("@ms/items-view/lib/private/models/items/getItemKey",["require","exports","../../facets/SetFacets"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getItemKey=function(e,t){var r=t.itemKey;if(r){var i=e.demandItemFacet(n.parentItemFacet,r);i&&(r=i.itemKey)}return r}});
define("@ms/items-view/lib/private/models/itemsScope/getCurrentItemSetKey",["require","exports","../../facets/ScopeFacets","../items/getItemSetKey","./getItemsScope","../../controls/currentItemSetControl"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getCurrentItemSetKey=function(e,t){void 0===t&&(t=i.getItemsScope(e).itemsScopeItemKey);var o=e.demandItemFacet(n.currentItemFacet,t),u=e.demandItemFacet(s.currentItemSetControl,void 0);return s.currentItemSetControl.evaluate(u)(e,{itemKey:r.getItemSetKey(e,{itemKey:o&&o.itemKey}),itemsScopeItemKey:t}).itemKey}});
define("@ms/items-view/lib/private/controls/currentItemSetControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.currentItemSetControl=new n.ControlFacet("currentItemSet")});
define("@ms/items-view/lib/private/models/telemetry/getItemEngagement",["require","exports","tslib","../../utilities/Graft","../../controls/itemEngagementControl","../../facets/ItemFacets","../../operations/readItems"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getItemEngagement=function(e,t){var n=t.engagement,r=void 0===n?{}:n,s=t.itemKey,o=e.demandItemFacet(i.itemEngagementControl,s);return u(e,{itemKey:s,engagement:r,controlHandler:o})};t.getItemActionEngagement=function(e,t){var r=this,s=t.engagement,a=t.itemKey,f=e.demandItemFacet(i.itemEngagementControl,a),l=e.dispatch;return{engagement:s,getEngagement:function(){return n.__awaiter(r,void 0,void 0,function(){return n.__generator(this,function(e){return[2,l(o.readItems(function(e){return u(e,{itemKey:a,controlHandler:f,engagement:s})}))]})})}}};function u(e,t){var o=t.itemKey,u=t.engagement,a=t.controlHandler,f=e.demandItemFacet(s.folderFacet,o),l=!f&&e.isItemFacetResolved(s.fileNameFacet,o)?e.demandItemFacet(s.fileNameFacet,o):void 0,c=n.__assign({},l||f?{objectType:f?"Folder":"File"}:{},{extraData:n.__assign({},l?{extension:l.extension}:{})});return i.itemEngagementControl.evaluate(a)(e,{itemKey:o,engagement:r.graft(u,c)}).engagement}});
define("@ms/items-view/lib/private/controls/itemEngagementControl",["require","exports","../models/controls/ControlFacet","../models/controls/graftControlOption"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemEngagementControl=new n.ControlFacet("itemEngagement",{engagement:r.graftControlOption()})});
define("@ms/items-view/lib/private/models/controls/graftControlOption",["require","exports","../../utilities/Graft"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graftControlOption=function(){return{merge:function(e,t){return t&&e&&n.graft({value:e},{value:t}).value||t||e}}}});
define("@uifabric/experiments/lib/components/signals/Signals",["require","exports","tslib","react","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Utilities","./Signal","./Signals.scss","./Signal.scss","../../Utilities","./Signal","./SignalField"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(l,t);n.__exportStar(c,t);t.YouCheckedOutSignal=function(e){return r.createElement(h,n.__assign({},e,{signalClass:u.youCheckedOut,iconName:"checkedoutbyyou12"}))};t.BlockedSignal=function(e){return r.createElement(h,n.__assign({},e,{signalClass:u.blocked,iconName:"blocked12"}))};t.MissingMetadataSignal=function(e){return r.createElement(h,n.__assign({},e,{signalClass:u.missingMetadata,iconName:f.getRTL()?"TagUnknown12Mirror":"TagUnknown12"}))};t.WarningSignal=function(e){return r.createElement(h,n.__assign({},e,{signalClass:u.warning,iconName:"warning12"}))};t.AwaitingApprovalSignal=function(e){return r.createElement(h,n.__assign({},e,{signalClass:u.awaitingApproval,iconName:"clock"}))};t.TrendingSignal=function(e){return r.createElement(h,n.__assign({},e,{signalClass:u.trending,iconName:"market"}))};t.SomeoneCheckedOutSignal=function(e){return r.createElement(h,n.__assign({},e,{signalClass:u.someoneCheckedOut,iconName:"checkedoutbyother12"}))};t.RecordSignal=function(e){return r.createElement(h,n.__assign({},e,{signalClass:u.record,iconName:"lock"}))};t.NeedsRepublishingSignal=function(e){return r.createElement(h,n.__assign({},e,{signalClass:u.needsRepublishing,iconName:"readingmode"}))};t.NewSignal=function(e){e.ariaLabel;var t=n.__rest(e,["ariaLabel"]);return r.createElement("span",n.__assign({},t,{className:s.css(a.signal,u.newSignal)}),r.createElement(i.Icon,{ariaLabel:e.ariaLabel,className:s.css(u.newIcon),iconName:"glimmer"}))};t.LiveEditSignal=function(e){var t=e.className,i=n.__rest(e,["className"]);return r.createElement(o.Signal,n.__assign({className:s.css(t,u.liveEdit)},i))};t.MentionSignal=function(e){return r.createElement(h,n.__assign({},e,{signalClass:u.mention,iconName:"accounts"}))};t.CommentsSignal=function(e){e.ariaLabel;var t=e.className,a=e.children,f=n.__rest(e,["ariaLabel","className","children"]);return r.createElement(o.Signal,n.__assign({className:s.css(u.comments,t)},f),r.createElement(i.Icon,{ariaLabel:e.ariaLabel,className:s.css(u.commentsIcon),iconName:"MessageFill"}),a?r.createElement("span",{className:s.css(u.commentsCount)},a):null)};t.UnseenReplySignal=function(e){return r.createElement(h,n.__assign({},e,{signalClass:u.unseenReply,iconName:"commentprevious"}))};t.UnseenEditSignal=function(e){return r.createElement(h,n.__assign({},e,{signalClass:u.unseenEdit,iconName:"edit"}))};t.ReadOnlySignal=function(e){return r.createElement(h,n.__assign({},e,{signalClass:u.readOnly,iconName:"uneditablesolid12"}))};t.EmailedSignal=function(e){return r.createElement(h,n.__assign({},e,{signalClass:u.emailed,iconName:"mail"}))};t.SharedSignal=function(e){return r.createElement(h,n.__assign({},e,{signalClass:u.shared,iconName:"people"}))};t.MalwareDetectedSignal=function(e){return r.createElement(h,n.__assign({},e,{signalClass:u.malwareDetected,iconName:"BlockedSiteSolid12"}))};t.ATPSignal=t.MalwareDetectedSignal;t.ExternalSignal=function(e){return r.createElement(h,n.__assign({},e,{signalClass:u.external,iconName:"Globe"}))};t.NotFollowedSignal=function(e){return r.createElement(h,n.__assign({},e,{signalClass:u.bookmarkOutline,iconName:"SingleBookmark"}))};t.FollowedSignal=function(e){return r.createElement(h,n.__assign({},e,{signalClass:u.bookmarkFilled,iconName:"SingleBookmarkSolid"}))};function h(e){e.ariaLabel;var t=e.className,o=e.signalClass,u=n.__rest(e,["ariaLabel","className","signalClass"]);return r.createElement(i.Icon,n.__assign({},u,{ariaLabel:e.ariaLabel,className:s.css(a.signal,o,t)}))}});
define("@uifabric/experiments/lib/components/signals/Signal",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","./Signal.scss"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Signal=function(e){e.ariaLabel;var t=e.className,o=(e.children,n.__rest(e,["ariaLabel","className","children"]));return r.createElement("span",n.__assign({"aria-label":e.ariaLabel},o,{className:i.css(s.signal,t)}),e.children)}});
define("@uifabric/experiments/lib/components/signals/Signal.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".signal_63cd35e0{display:inline-block;margin:0 4px;position:relative;-webkit-transition:color 0.2s linear;transition:color 0.2s linear}.dark_63cd35e0 .signal_63cd35e0,.signal_63cd35e0 .dark_63cd35e0.selected_63cd35e0{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.isFluent_63cd35e0 .signal_63cd35e0{color:"},{theme:"yellowDark",defaultValue:"#d29200"},{rawString:"}html[dir='ltr'] .signal_63cd35e0:first-child{margin-left:0}html[dir='rtl'] .signal_63cd35e0:first-child{margin-right:0}html[dir='ltr'] .signal_63cd35e0:last-child{margin-right:0}html[dir='rtl'] .signal_63cd35e0:last-child{margin-left:0}i.signal_63cd35e0{top:0.2em}\n"}]);t.signal="signal_63cd35e0";t.dark="dark_63cd35e0";t.selected="selected_63cd35e0";t.isFluent="isFluent_63cd35e0"});
define("@uifabric/experiments/lib/components/signals/Signals.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".newSignal_2363b69c{width:0;height:1em;position:relative;line-height:1em;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}html[dir='ltr'] .newSignal_2363b69c{margin-right:0}html[dir='rtl'] .newSignal_2363b69c{margin-left:0}.selected_2363b69c .newSignal_2363b69c{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.newIcon_2363b69c{position:absolute;bottom:100%;font-size:0.66em;margin-bottom:-0.9em}html[dir='ltr'] .newIcon_2363b69c{right:-.15em}html[dir='rtl'] .newIcon_2363b69c{left:-.15em}.comments_2363b69c{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.selected_2363b69c .comments_2363b69c{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.commentsIcon_2363b69c{vertical-align:middle}.commentsCount_2363b69c{font-size:0.9em;font-weight:600;vertical-align:baseline}html[dir='ltr'] .commentsCount_2363b69c{margin-left:.2em}html[dir='rtl'] .commentsCount_2363b69c{margin-right:.2em}.trending_2363b69c{color:"},{theme:"green",defaultValue:"#107c10"},{rawString:"}.blocked_2363b69c{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.warning_2363b69c{color:#cf3902}.shared_2363b69c{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.selected_2363b69c .shared_2363b69c{color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.lock_2363b69c{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.selected_2363b69c .lock_2363b69c{color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.missingMetadata_2363b69c{color:#cf3902}.youCheckedOut_2363b69c{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.someoneCheckedOut_2363b69c{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.selected_2363b69c .someoneCheckedOut_2363b69c{color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.awaitingApproval_2363b69c{color:#ad3100}.mention_2363b69c{position:relative;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.selected_2363b69c .mention_2363b69c{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.unseenEdit_2363b69c{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.selected_2363b69c .unseenEdit_2363b69c{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.unseenReply_2363b69c{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.selected_2363b69c .unseenReply_2363b69c{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}i.unseenReply_2363b69c{top:0.25em}.emailed_2363b69c{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.selected_2363b69c .emailed_2363b69c{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}i.emailed_2363b69c{top:0.25em}.malwareDetected_2363b69c{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.readOnly_2363b69c{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.selected_2363b69c .readOnly_2363b69c{color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.external_2363b69c{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.selected_2363b69c .external_2363b69c{color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.record_2363b69c{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.selected_2363b69c .record_2363b69c{color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.liveEdit_2363b69c{display:none}.bookmarkOutline_2363b69c{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.bookmarkFilled_2363b69c{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.needsRepublishing_2363b69c{color:"},{theme:"yellowDark",defaultValue:"#d29200"},{rawString:"}\n"}]);t.newSignal="newSignal_2363b69c";t.selected="selected_2363b69c";t.newIcon="newIcon_2363b69c";t.comments="comments_2363b69c";t.commentsIcon="commentsIcon_2363b69c";t.commentsCount="commentsCount_2363b69c";t.trending="trending_2363b69c";t.blocked="blocked_2363b69c";t.warning="warning_2363b69c";t.shared="shared_2363b69c";t.lock="lock_2363b69c";t.missingMetadata="missingMetadata_2363b69c";t.youCheckedOut="youCheckedOut_2363b69c";t.someoneCheckedOut="someoneCheckedOut_2363b69c";t.awaitingApproval="awaitingApproval_2363b69c";t.mention="mention_2363b69c";t.unseenEdit="unseenEdit_2363b69c";t.unseenReply="unseenReply_2363b69c";t.emailed="emailed_2363b69c";t.malwareDetected="malwareDetected_2363b69c";t.readOnly="readOnly_2363b69c";t.external="external_2363b69c";t.record="record_2363b69c";t.liveEdit="liveEdit_2363b69c";t.bookmarkOutline="bookmarkOutline_2363b69c";t.bookmarkFilled="bookmarkFilled_2363b69c";t.needsRepublishing="needsRepublishing_2363b69c"});
define("@uifabric/experiments/lib/Utilities",["require","exports","tslib","office-ui-fabric-react/lib/Utilities"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@uifabric/experiments/lib/components/signals/SignalField",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","./SignalField.scss"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SignalField=function(e){e.before,e.after;var t,o=e.className,u=e.signalsFieldMode,a=void 0===u?"compact":u,f=n.__rest(e,["before","after","className","signalsFieldMode"]);return r.createElement("span",n.__assign({},f,{className:i.css(s.signalField,(t={},t[s.wide]="wide"===a,t[s.compact]="compact"===a,t),o)}),e.before,r.createElement("span",{className:s.signalFieldValue},e.children),e.after)}});
define("@uifabric/experiments/lib/components/signals/SignalField.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".signalField_eb02b4e4{max-width:100%;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row nowrap;flex-direction:row nowrap}.signalField_eb02b4e4,.signalField_eb02b4e4.compact_eb02b4e4{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex}.signalField_eb02b4e4.wide_eb02b4e4{display:-webkit-box;display:-ms-flexbox;display:flex;vertical-align:top}.signalFieldValue_eb02b4e4{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}html[dir='ltr'] .signalFieldValue_eb02b4e4{text-align:left}html[dir='rtl'] .signalFieldValue_eb02b4e4{text-align:right}\n"}]);t.signalField="signalField_eb02b4e4";t.compact="compact_eb02b4e4";t.wide="wide_eb02b4e4";t.signalFieldValue="signalFieldValue_eb02b4e4"});
define("@ms/items-view/lib/private/components/itemsBreadcrumb/ItemsBreadcrumb.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".sharedPeopleIcon_82306f4f{cursor:pointer}\n"}]);t.sharedPeopleIcon="sharedPeopleIcon_82306f4f"});
define("@ms/items-view/lib/private/components/actions/manageAccess/ManageAccessAction",["require","exports","../../decorators/connectToItemCache","../../withAction/WithAction","../../../controls/sharedFieldClickActionControl","../../decorators/selectors"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemManageAccessAction=n.connectToItemCache(function(e,t){var n=t.itemKey,s=e.demandItemFacet(i.sharedFieldClickActionControl,t.itemKey),o=i.sharedFieldClickActionControl.evaluate(s)(e,{itemKey:n}).onClickAction;return{action:r.evaluateAction(e,o)}})(r.ActionSelector);t.ManageAccessAction=s.withSelectedItems()(s.withExactlyOneItem()(t.ItemManageAccessAction))});
define("@ms/items-view/lib/private/controls/sharedFieldClickActionControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedFieldClickActionControl=new n.ControlFacet("sharedFieldClickActionControl")});
define("@ms/items-view/lib/private/components/defaultDropZone/DefaultDropZone",["require","exports","tslib","react","../actions/defaultDrop/DefaultDropAction","../decorators/asActionDropZone","../../utilities/dragAndDrop/files","../decorators/selectors","../decorators/connectToItemCache","../../controls/itemDragDropControl","../withAction/WithAction","../../utilities/components/RenderProps","../../models/configuration/getConfiguration","../../facets/ConfigurationFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=s.asActionDropZone(o.isFileDropEvent)(i.ItemDefaultDropAction);t.ItemDefaultDropZone=a.connectToItemCache(function(e,t){var i=t.itemKey,s=h.getConfiguration(e,{reactDragDropConfiguration:p.reactDragDropConfigurationFacet}).reactDragDropConfiguration,o=void 0===s?d:s,u=e.demandItemFacet(f.itemDragDropControl,t.itemKey),a=f.itemDragDropControl.evaluate(u)(e,{itemKey:i,itemDropZone:o}).itemDropZone;return{action:l.evaluateAction(e,r.createElement(a,n.__assign({},t)))}})(l.ActionSelector);t.DefaultDropZone=u.withCurrentItem()(t.ItemDefaultDropZone);t.renderChildrenWithDropZoneElement=function(e,t){return t?r.cloneElement(t,void 0,e):c.renderChildrenWithProps(e,s.DEFAULT_ACTION_DROP_ZONE_STATE_PROPS)}});
define("@ms/items-view/lib/private/components/actions/defaultDrop/DefaultDropAction",["require","exports","tslib","react","../../decorators/selectors","./handlers/upload","../../../controls/defaultDropActionControl","../../withAction/WithAction","../../decorators/connectToItemCache","./handlers/moveCopy","../../action/Action","../../withItemCache/WithItemCache"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";var h=this;Object.defineProperty(t,"__esModule",{value:!0});var p=[s.uploadDefaultDropActionHandler,f.moveCopyDefaultDropActionHandler];t.ItemDefaultDropAction=a.connectToItemCache(function(e,t){var i=t.itemKey;if(!i)return{action:null};for(var s=e.demandItemFacet(o.defaultDropActionControl,i),a=o.defaultDropActionControl.evaluate(s)(e,{itemKey:i,handlers:p}).handlers,f={},d=0,v=a;d<v.length;d++){var m=v[d],g=m.evaluate(e,{itemKey:i}).action;f[m.key]=u.evaluateAction(e,g)}return{action:r.createElement(c.WithItemCache,null,function(e){var t=e.dispatch;return r.createElement(u.WithActionSet,{actions:f},function(e){var i=e.actions,s=a.filter(function(e){var t=i[e.key];return!!t&&t.isAvailable});return r.createElement(l.Action,{isAvailable:s.length>0,onExecute:function(e){return n.__awaiter(h,void 0,void 0,function(){var r,o,u,a;return n.__generator(this,function(n){switch(n.label){case 0:r=0,o=s;n.label=1;case 1:if(!(r<o.length))return[3,4];u=o[r];return(a=i[u.key])&&t(u.canHandleEvent(e))?[4,a.execute(e)]:[3,3];case 2:return[2,n.sent()];case 3:r++;return[3,1];case 4:return[2]}})})}})})})}})(u.ActionSelector);t.DefaultDropAction=i.withOnlyCurrentItem()(t.ItemDefaultDropAction)});
define("@ms/items-view/lib/private/components/actions/defaultDrop/handlers/upload",["require","exports","../../../../models/Facet","../../upload/UploadEntriesAction","react","../../../../facets/ItemFacets","../../../../utilities/dragAndDrop/files","../../../reactDragDrop/DropTargetWrapper","../../../../facets/DragDropFacets"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=a.dragDropKeyFacet.serialize({}),l=new n.Facet("uploadDefaultDropActionHandler").id;t.uploadDefaultDropActionHandler={key:l,evaluate:function(e,t){var n=t.itemKey,o=e.demandItemFacet(a.draggedItemFacet,f),l=o&&o.draggedItem,c=!l||l.type===u.DragType.FILE,h=e.demandItemFacet(s.folderFacet,n);return{action:c&&h?i.createElement(r.ItemUploadEntriesAction,{itemKey:n}):void 0}},canHandleEvent:function(e){return function(t){return e.event&&e.event&&o.isFileDropEvent(e.event)||!1}}}});
define("@ms/items-view/lib/private/components/actions/upload/UploadEntriesAction",["require","exports","tslib","react","../../../utilities/components/Props","./UploadAction","../../decorators/selectors","../../../utilities/dragAndDrop/files"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.componentDidMount=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t,r,i;return n.__generator(this,function(n){e=this.props,t=e.onContinue;if((r=e.onExecuteProps)&&r.event){i=u.getFileDropEntries(r.event);t(i)}else this.props.onCancel();return[2]})})};t.prototype.render=function(){return null};return t}(r.PureComponent);t.ItemUploadEntriesAction=i.injectInitialProps(function(){return{fileSelector:a}})(s.ItemUploadAction);t.UploadEntriesAction=o.withOnlyCurrentItem()(t.ItemUploadEntriesAction)});
define("@ms/items-view/lib/private/components/actions/upload/UploadAction",["require","exports","tslib","react","../../../facets/ItemFacets","../../uploader/Uploader","../../decorators/connectToItemCache","../../../controls/uploadItemsActionControl","../../decorators/selectors","../../../utilities/Graft","../../../models/telemetry/getItemEngagement","../../../facets/GroupFacets","../../withAction/WithAction","../../action/Action"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemUploadAction=o.connectToItemCache(function(e,t){var o=t.itemKey,a=t.engagement,d=void 0===a?{}:a,v=t.onItemUploaded,m=e.demandItemFacet(u.uploadItemsActionControl,o),g=e.demandItem({folder:i.folderFacet},t.itemKey).folder,y=e.demandItemFacet(c.isGroupFacet,o),b=e.dispatch,w=v?function(e){return function(){v(e)}}:void 0,E=u.uploadItemsActionControl.evaluate(m)(e,{itemKey:o,targetItemKey:o,isAvailable:!1,onItemUploaded:w}),S=E.isAvailable,x=E.onItemUploaded,T=E.targetItemKey,N=E.action,C=S&&(!!g||y)&&!!T,k=h.renderComponentOnExecute(function(e){return r.createElement(s.Uploader,n.__assign({},t,e,{itemKey:T||"",onItemUploaded:x?function(e){b(x(e))}:v}))},{scope:"headless"});return{action:N||r.createElement(p.Action,n.__assign({isAvailable:C,onExecute:k},l.getItemActionEngagement(e,{itemKey:o,engagement:f.graft({name:"Upload",isIntentional:!0},d)})))}})(h.ActionSelector);t.UploadAction=a.withOnlyCurrentItem()(t.ItemUploadAction)});
define("@ms/items-view/lib/private/components/uploader/Uploader",["require","exports","tslib","react","../../utilities/async/CancelError","../decorators/connectToItemCache","../../utilities/components/Async"],function(e,t,n,r,i,s,o){"use strict";var u=this;Object.defineProperty(t,"__esModule",{value:!0});var a=o.asAsync(function(){return n.__awaiter(u,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./UploaderCore"],t,n)})];case 1:return[2,t.sent().UploaderCore]}})})}),f={entries:void 0,entryBatchKey:void 0,isCanceled:!1},l=function(t){n.__extends(s,t);function s(e){var n=t.call(this,e)||this;n._onContinueDialog=function(e){n.setState({entries:e})};n._onCancelDialog=function(){n.setState({isCanceled:!0})};n.state=f;return n}s.prototype.render=function(){var e=this.props,t=e.fileSelector,i=n.__rest(e,["fileSelector"]),s=this.state.entryBatchKey;return s?r.createElement(a,n.__assign({},i,{entryBatchKey:s})):r.createElement(t,{onExecuteProps:this.props.onExecuteProps,onContinue:this._onContinueDialog,onCancel:this._onCancelDialog})};s.prototype.componentDidMount=function(){this._onStateChanged(f)};s.prototype.componentDidUpdate=function(e,t){this._onStateChanged(t)};s.prototype._onStateChanged=function(e){var t=this.state,n=t.isCanceled,r=t.entries;!e.isCanceled&&n?this.props.reject(new i.CancelError):!e.entries&&r&&this._loadEntries(r)};s.prototype._loadEntries=function(t){return n.__awaiter(this,void 0,void 0,function(){var r,i;return n.__generator(this,function(n){switch(n.label){case 0:return[4,new Promise(function(t,n){e(["../../operations/DeferredOperations"],t,n)})];case 1:r=n.sent().createEntryBatch;i=this.props.itemCacheDispatch(r({entries:t})).itemKey;this.setState({entryBatchKey:i});return[2]}})})};return s}(r.PureComponent);t.BaseUploader=l;t.Uploader=s.connectToItemCache()(l)});
define("@ms/items-view/lib/private/controls/uploadItemsActionControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadItemsActionControl=new n.ControlFacet("uploadItemsActionControl")});
define("@ms/items-view/lib/private/facets/GroupFacets",["require","exports","../models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultCollapsedFacet=new n.Facet("defaultCollapsed");t.countFacet=new n.Facet("count");t.isGroupFacet=new n.Facet("isGroup");t.isDropEnabledFacet=new n.Facet("isDropEnabled");t.GROUP_ITEM_LIMIT=30;t.foldersGroupFacet=new n.Facet("foldersGroup");t.documentsGroupFacet=new n.Facet("documentsGroup");t.mediaGroupFacet=new n.Facet("mediaGroup")});
define("@ms/items-view/lib/private/utilities/dragAndDrop/files",["require","exports","../fileSystem/FileEntries"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getFileDropEntries=function(e){var t,r;try{t=e.dataTransfer.items;r=e.dataTransfer.files}catch(e){window.setTimeout(function(){throw e},0)}var i=[],s=[];if(t&&t.length)for(var o=0;o<t.length;o++){var u=t[o];if(u.getAsEntry)s.push(u.getAsEntry());else if(u.webkitGetAsEntry)s.push(u.webkitGetAsEntry());else if("function"==typeof u.getAsFile){var a=u.getAsFile();a&&i.push(a)}}else if(r&&r.length>0){o=0;for(var f=r.length;o<f;o++)i.push(r[o])}return n.buildEntriesFromEntryList(s).concat(n.buildEntriesFromFileList(i))};t.isFileDropEvent=function(e){var t=e.dataTransfer;if(t){var n=t.files,r=t.types;if(n&&n.length>0)return!0;if(r)return Array.prototype.slice.call(r,0).some(function(e){return"files"===e.toLowerCase()})}return!1}});
define("@ms/items-view/lib/private/utilities/fileSystem/FileEntries",["require","exports","tslib","../async/Signal"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.unknown=0]="unknown";e[e.file=1]="file";e[e.directory=2]="directory"}(t.EntryType||(t.EntryType={}));function i(e){return{name:e.name,type:2,getEntries:function(){return Promise.resolve({entries:o(e)})}}}function s(e){return e.type?{name:e.name,type:1,getFile:function(){return Promise.resolve(e)}}:{name:e.name,type:0,getFile:function(){return Promise.resolve(e)}}}function o(e){var t=[];for(var n in e.directories)n&&t.push(i(e.directories[n]));for(var r=0,o=e.files;r<o.length;r++){var u=o[r];t.push(s(u))}return t}t.buildEntriesFromFileList=function(e){for(var t={name:"",directories:{},files:[]},n=0,r=e;n<r.length;n++){for(var i=r[n],s=i.webkitRelativePath,u=t,a=0,f=(void 0===s?i.name:s).split("/").slice(0,-1);a<f.length;a++){var l=f[a];u=u.directories[l]||(u.directories[l]={name:l,directories:{},files:[]})}u.files.push(i)}return o(t)};function u(e){var t=new r.Signal,n=t.resolve,i=t.reject,s=t.promise;e.readEntries(n,i);return s}function a(e){return!0===e.isDirectory?{name:e.name,type:2,getEntries:function(){return function e(t){return n.__awaiter(this,void 0,void 0,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:return[4,u(t)];case 1:r=n.sent();return[2,r.length?{entries:r.map(a),getEntries:function(){return e(t)}}:{entries:[]}]}})})}(e.createReader())}}:{name:e.name,type:1,getFile:function(){return function(e){var t=new r.Signal,n=t.resolve,i=t.reject,s=t.promise;e.file(n,i);return s}(e)}}}t.buildEntriesFromEntryList=function(e){return e.map(a)}});
define("@ms/items-view/lib/private/components/reactDragDrop/DropTargetWrapper",["require","exports","tslib","react","react","../../utilities/components/Async","@uifabric/utilities/lib/css","@ms/utilities-react-drag-drop/lib/Constants","./DragDropWrapper.scss","../../utilities/components/RenderProps"],function(e,t,n,r,i,s,o,u,a,f){"use strict";var l=this;Object.defineProperty(t,"__esModule",{value:!0});t.DragType={DOCUMENT:"Document",FILE:u.NATIVE_FILE_DRAG_TYPE};var c={canDrop:!1,isOver:!1,isOverCurrent:!1,didDrop:!1},h=function(e){var t,i=e.children,s=e.collectedProps,u=e.connectDropTarget,l=e.layoutMode,h=void 0===l?"static":l,p=e.showDropTargetHint,d=void 0!==p&&p,v=n.__rest(e,["children","collectedProps","connectDropTarget","layoutMode","showDropTargetHint"]),m=s||c,g=m.canDrop,y=void 0!==g&&g,b=m.isOver,w=void 0!==b&&b,E=m.isOverCurrent,S=void 0!==E&&E,x=m.didDrop,T=void 0!==x&&x,N={isDroppable:y,isDropping:S,hasDropped:T,hasDropFinished:T},C=f.renderChildrenWithProps(i,N);return u?r.createElement("div",n.__assign({ref:u},s,v,{className:o.css("connectDropTargetWrapper",(t={},t[a.root]="absolute"!==h,t[a.canDrop]=d&&y&&!w&&!S,t[a.dragOver]=S&&y,t))}),C):r.createElement("div",n.__assign({className:"connectDropTargetWrapper"},v),C)},p=s.asAsync(function(){return n.__awaiter(l,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./DragDropHook"],t,n)})];case 1:return[2,t.sent().DropTargetHook]}})})});t.DropTargetRelay=function(e){var t=e.children,s=e.acceptType,o=e.dropTargetKey,u=e.handlers,a=e.layoutMode,f=e.showDropTargetHint,l=e.barrier,c=n.__rest(e,["children","acceptType","dropTargetKey","handlers","layoutMode","showDropTargetHint","barrier"]),d=i.useState(),v=d[0],m=d[1],g=v&&v.collectedProps||void 0,y=v&&v.connectDropTarget||void 0;return r.createElement("div",{className:"DropTargetRelay"},r.createElement(p,{acceptType:s,dropTargetKey:o,handlers:u,hookCallback:function(e){e.connectDropTarget&&m({collectedProps:e.collectedProps,connectDropTarget:e.connectDropTarget})},barrier:l}),r.createElement(h,n.__assign({dropTargetKey:o,collectedProps:g,connectDropTarget:y,layoutMode:a,showDropTargetHint:f},c),t))}});
define("@ms/utilities-react-drag-drop/lib/Constants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.HTML5Backend=0]="HTML5Backend"}(t.Backend||(t.Backend={}));t.NATIVE_FILE_DRAG_TYPE="__NATIVE_FILE__"});
define("@ms/items-view/lib/private/components/reactDragDrop/DragDropWrapper.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".root_07d26fe8{position:relative}.canDrop_07d26fe8:after{content:' ';display:block;pointer-events:none;border:2px dashed "},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";position:absolute;top:0;left:0;bottom:0;right:0}.dragOver_07d26fe8:after{content:' ';display:block;pointer-events:none;border:2px dashed "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";position:absolute;top:0;left:0;bottom:0;right:0}\n"}]);t.root="root_07d26fe8";t.canDrop="canDrop_07d26fe8";t.dragOver="dragOver_07d26fe8"});
define("@ms/items-view/lib/private/facets/DragDropFacets",["require","exports","../models/KeyFacet","../models/Facet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dragDropKeyFacet=new n.KeyFacet("dragDrop",{});t.draggedItemFacet=new r.Facet("draggedItem")});
define("@ms/items-view/lib/private/controls/defaultDropActionControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultDropActionControl=new n.ControlFacet("defaultDropActionControl")});
define("@ms/items-view/lib/private/components/actions/defaultDrop/handlers/moveCopy",["require","exports","react","../../moveCopy/MoveCopyAction","../../../../models/Facet","../../../../facets/ItemFacets","../../../reactDragDrop/DropTargetWrapper","../../../../facets/DragDropFacets"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=u.dragDropKeyFacet.serialize({}),f=new i.Facet("moveCopyDefaultDropActionHandler").id;t.moveCopyDefaultDropActionHandler={key:f,evaluate:function(e,t){var i=t.itemKey,f=e.demandItemFacet(u.draggedItemFacet,a),l=f&&f.draggedItem,c=!l||l.type===o.DragType.DOCUMENT,h=e.demandItemFacet(s.folderFacet,i);return{action:c&&h?n.createElement(r.MoveCopyToFolderAction,{itemKey:i,itemKeys:l&&l.itemKeys||[],isMove:!0}):void 0}},canHandleEvent:function(e){return function(t){if(e&&e.event){var n=e.event.dataTransfer;return n&&n.type===o.DragType.DOCUMENT||!1}return!1}}}});
define("@ms/items-view/lib/private/components/actions/moveCopy/MoveCopyAction",["require","exports","tslib","react","../../decorators/connectToItemCache","../../../facets/ItemFacets","../../action/Action","../../../models/telemetry/getItemEngagement","../../decorators/selectors","../../withAction/WithAction","../../../controls/moveCopyActionControl"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MoveCopyToFolderAction=i.connectToItemCache(function(e,t){var r,i=t.itemKey,o=t.itemKeys,a=void 0===o?[]:o,f=t.isMove,c=void 0!==f&&f,h=t.isCrossSite,p=void 0!==h&&h,d=e.demandItem({folder:s.folderFacet},i).folder&&a.length>0;if(d=d&&!a.some(function(t){var n=e.demandItemFacet(s.parentFolderItemFacet,t),r=n?n.itemKey:void 0;return t===i||r===i})){var v=e.demandItemFacet(l.moveCopyActionControl,i);r=l.moveCopyActionControl.evaluate(v)(e,{itemKey:i,itemKeys:a,isMove:c,isCrossSite:p}).action}return n.__assign({action:r,isAvailable:d&&!1,onExecute:void 0},u.getItemActionEngagement(e,{itemKey:i,engagement:{name:c?"Move":"Copy",isIntentional:!0}}))})(function(e){return e.action?r.createElement(f.ActionSelector,{action:e.action}):r.createElement(o.Action,n.__assign({},e))});t.MoveCopyItemsToFolderAction=a.withSelectedItems()(t.MoveCopyToFolderAction)});
define("@ms/items-view/lib/private/controls/moveCopyActionControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.moveCopyActionControl=new n.ControlFacet("moveCopyActionControl")});
define("@ms/items-view/lib/private/components/decorators/asActionDropZone",["require","exports","tslib","react","@uifabric/utilities/lib/EventGroup","../withAction/WithAction","@uifabric/utilities/lib/css","./ActionDropZone.scss","../../utilities/components/RenderProps","../telemetry/TelemetryProvider","../../hooks/useEventHandler"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=f.createTelemetryProvider({withContext:{usageType:"Drop"}});t.DEFAULT_ACTION_DROP_ZONE_STATE_PROPS={isDroppable:!1,isDropping:!1,hasDropped:!1,hasDropFinished:!1};t.asActionDropZone=function(e){return function(t){var i=t;return function(t){var s=t,o=s.children,u=s.layoutMode,a=(s.enableDrag,n.__rest(s,["children","layoutMode","enableDrag"]));return h({layoutMode:u,action:r.createElement(i,n.__assign({},a)),canHandleEvent:e?function(n){return e(n,t)}:void 0,children:o})}}};function h(e){var t,f=e,h=f.children,d=f.layoutMode,v=function(e,t){var o=this,u=r.useState(!1),a=u[0],f=u[1],c=s.useAction(a?e:null),h=c[0],d=h.isAvailable,v=h.execute,m=c[1];r.useLayoutEffect(function(){var e=new i.EventGroup(null);e.on(document,"drop",p);e.on(document,"dragenter",function(){f(!0)},!0);return function(){e.dispose()}},[]);var g=r.useRef({dragCounter:0,handled:!1}).current,y=r.useState(!1),b=y[0],w=y[1],E=r.useState(!1),S=E[0],x=E[1],T=r.useState(!1),N=T[0],C=T[1],k=l.useEventHandler(function(e){e.preventDefault();if(d&&(!t||t(e))){e.persist();e.stopPropagation();n.__awaiter(o,void 0,void 0,function(){return n.__generator(this,function(t){try{v({event:e})}catch(e){}finally{C(!0)}return[2]})});g.handled=!1;g.dragCounter=0;x(!0)}}),L=l.useEventHandler(function(e){e.preventDefault();0===g.dragCounter&&d&&(!t||t(e))&&(g.handled=!0);g.handled&&e.stopPropagation();g.dragCounter+=1;w(g.dragCounter>0&&g.handled);x(!1);C(!1)}),A=l.useEventHandler(function(e){g.handled&&e.stopPropagation();g.dragCounter-=1;0===g.dragCounter&&(g.handled=!1);w(g.dragCounter>0&&g.handled)}),O=r.useMemo(function(){return{onDragEnter:L,onDragLeave:A,onDragOver:p,onDrop:k}},[]);return[r.useMemo(function(){return{isDroppable:!1,hasDropFinished:N,hasDropped:S,isDropping:b}},[N,S,b]),O,m]}(f.action,f.canHandleEvent),m=v[0],g=v[1],y=v[2];return r.createElement("div",{onDrop:g.onDrop,onDragEnter:g.onDragEnter,onDragLeave:g.onDragLeave,onDragOver:g.onDragOver,className:o.css(u.root,(t={},t[u.dragOver]=m.isDropping,t[u.snap]="absolute"===d,t))},y?r.createElement(c,null,y):null,a.renderChildrenWithProps(h,m))}t.ActionDropZone=h;function p(e){e.preventDefault()}});
define("@ms/items-view/lib/private/components/decorators/ActionDropZone.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".root_ac5b3318{position:relative}.root_ac5b3318.snap_ac5b3318{position:absolute;top:0;left:0;right:0;bottom:0}.dragOver_ac5b3318:after{content:' ';display:block;pointer-events:none;border:2px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";position:absolute;top:0;left:0;bottom:0;right:0}\n"}]);t.root="root_ac5b3318";t.snap="snap_ac5b3318";t.dragOver="dragOver_ac5b3318"});
define("@ms/items-view/lib/private/controls/itemDragDropControl",["require","exports","../models/controls/ControlFacet","../components/controls/defaultRenderComponentControlOption"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemDragDropControl=new n.ControlFacet("itemDragDrop",{itemDropZone:r.defaultRenderComponentOption({useItemCache:!0})})});
define("@ms/items-view/lib/private/models/configuration/getConfiguration",["require","exports","../../facets/ConfigurationFacets"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getConfiguration=function(e,t){return e.demandItem(t,n.configurationItemKey)}});
define("odsp-next/controls/itemContent/itemsScope/ItemContentBreadcrumb",["require","exports","tslib","react","@uifabric/utilities/lib/css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.items,s=e.defaultRender;if(1===t.length){var u=t[0];return r.createElement("h1",{className:i.css("od-ItemContent-title"),"data-automationid":"TitleSpan"},u.text)}return s?r.createElement("div",{className:i.css("od-ItemsScopeItemContent-breadcrumb","od-ItemContent-breadcrumb")},r.createElement(s,n.__assign({},e,{styles:o}))):null};return t}(r.PureComponent);t.default=s;function o(e){return{root:{marginTop:"7px",marginBottom:"1px"},list:{marginLeft:"-8px"}}}});
define("odsp-next/controls/itemContent/itemsScope/ItemContentBreadcrumbControl",["require","exports","@ms/items-view/lib/private/models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemContentBreadcrumbControl=new n.ControlFacet("itemContentBreadcrumbControl")});
define("odsp-next/controls/itemContent/itemsScope/ItemsViewContent",["require","exports","tslib","react","@ms/items-view/lib/private/components/itemsView/ItemsView","@ms/items-view/lib/private/components/layouts/DetailsLayout","@uifabric/utilities/lib/css","office-ui-fabric-react/lib/Sticky","@uifabric/styling/lib/index","../../../utilities/features/Features","../../base/react/WithResources","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../itemsScope/ItemSetDetailsListControlHandler","../../itemsScope/ItemSetTilesListControlHandler","@ms/items-view/lib/private/controls/itemSetDetailsListControl","@ms/items-view/lib/private/controls/itemSetTilesListControl","@ms/items-view/lib/private/components/decorators/withControlHandler"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=o.css("od-ItemsScopeItemContent-list","od-ItemContent-list"),y=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.resources,t=e.consume(h.resourceKey),o=e.consume(p.resourceKey),u=e.consume(c.platformDetection),a=f.isFeatureEnabled(f.MakeListHeaderSticky)&&!u.isMobile?{onRenderDetailsHeader:b,onRenderDetailsFooter:w}:{},l=r.createElement(i.ItemsView,null,r.createElement(s.DetailsLayout,n.__assign({key:"details"},a)),r.createElement(s.CompactDetailsLayout,n.__assign({key:"compact"},a)));return r.createElement("div",{className:g},r.createElement(m.ControlHandlerProvider,{controlHandlers:n.__assign({},d.itemSetDetailsListControl.pack(t),v.itemSetTilesListControl.pack(o))},l))};return t}(r.PureComponent);t.ItemsViewContent=l.withResources()(y);function b(e,t){return e&&t?r.createElement(u.Sticky,{stickyPosition:u.StickyPositionType.Header,stickyClassName:o.css(g,"od-ItemContent-list--sticky"),isScrollSynced:!0},t(e)):null}function w(e,t){if(!t||!e)return null;var n=o.css("od-ItemContent-footer","od-ItemContent-footer--sticky",!0===a.getTheme().isInverted?"od-footer-top-sticky-shadow-dark-theme":"od-footer-top-sticky-shadow-neutral-theme");return r.createElement(u.Sticky,{stickyPosition:u.StickyPositionType.Footer,stickyClassName:n,isScrollSynced:!0},t(e))}});
define("@ms/items-view/lib/private/components/itemsView/ItemsView",["require","exports","tslib","react","../../operations/switchLayout","../../operations/pageLoad","../../facets/ScopeFacets","../layoutManager/LayoutManager","../layouts/DetailsLayout","../layouts/TilesLayout","../layoutSwitcher/LayoutSwitcher","../itemsError/ItemError","../decorators/connectToItemCache","../decorators/connectToItemsScope","../defaultDropZone/DefaultDropZone","../../controls/itemsViewControl","../decorators/selectors","../withAction/WithAction","../pageLoadTracker/PageLoadTracker","../../facets/DemandFacets","../telemetry/TelemetryProvider","../itemsEmptyFolder/ItemEmptyFolder"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S,x=w.createTelemetryProvider({withContext:{component:"ItemsView"}}),T=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=n.props,i=r.layoutType,s=r.defaultLayout,o=r.isLayoutResolved,u=r.layouts,a=(i?[i.id]:[]).concat(s?[s.id]:[],Object.keys(u)).map(function(e){return u[e]}).filter(function(e){return e&&e.isAvailable})[0];n.state={selectedLayoutType:!1!==o?a.facet:void 0};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.layoutType,n=e.defaultLayout,r=e.isLayoutResolved,i=e.layouts,s=this.props,o=(t?[t.id]:[]).concat(n?[n.id]:[],Object.keys(i)).map(function(e){return i[e]}).filter(function(e){return e&&e.isAvailable})[0];!o||!1===r||t===s.layoutType&&(n===s.defaultLayout&&this.state.selectedLayoutType||!n&&s.defaultLayout||r===s.isLayoutResolved)||this.setState({selectedLayoutType:o.facet})};t.prototype.render=function(){var e=this.props,t=e.pinnedItemsView,n=e.shouldShowEmptyFolder,i=e.shouldShowPinnedItems,s=e.dragDropElement,o=e.isItemsScopeError,u=this.state.selectedLayoutType,a=u&&u.id,f=a&&this.props.layouts[a],h=f&&f.content,p=f&&f.itemKey||this.props.itemSetKey,v=!n||n({layoutKey:a}),m=!i||i({layoutKey:a});return o?r.createElement(c.ItemError,{key:"error",itemKey:p}):r.createElement(x,null,d.renderChildrenWithDropZoneElement(r.createElement(r.Fragment,null,m&&t,r.createElement(y.PageLoadTracker,{qosName:"ItemsView.Load",onLoadItem:this.props.onLoadItem},r.createElement(l.LayoutSwitcher,{key:"layout",layoutKey:a},h),r.createElement(c.ItemError,{key:"error",itemKey:p}),v&&r.createElement(E.ItemEmptyFolder,{key:"emptyFolder",itemKey:p}))),s))};t.prototype.componentDidMount=function(){var e=this.props,t=e.layouts,n=e.isLayoutResolved,r=e.setDefaultLayout,i=this.state.selectedLayoutType;i&&!1!==n&&r({layoutType:i});this._clearLayoutIfInactive(this.props);this._updateAvailableLayouts(t)};t.prototype.componentDidUpdate=function(e,t){var n=this.props,r=n.layouts,i=n.isLayoutResolved,s=n.setDefaultLayout,o=this.state.selectedLayoutType;!o||o===t.selectedLayoutType&&i===e.isLayoutResolved||!1===i||s({layoutType:o});this._clearLayoutIfInactive(this.props);e.layouts!==r&&this._updateAvailableLayouts(r)};t.prototype._clearLayoutIfInactive=function(e){var t=e.layoutType,n=e.layouts,r=e.isLayoutResolved,i=e.switchLayout;!t||n[t.id]&&n[t.id].isAvailable||!1===r||i({layoutType:void 0})};t.prototype._updateAvailableLayouts=function(e){var t={};for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=e[n];r&&(t[r.facet.id]=r.isAvailable)}this.props.updateAvailableLayouts({layouts:t})};return t}(r.PureComponent);t.ItemsView=h.connectToItemCache(function(e){var t=p.getItemsScope(e).itemsScopeItemKey;if(!t)throw new Error("An ItemsView component must be instantiated within an ItemsScope component.");var n=e.dispatch,u=e.demandItem({layoutType:o.layoutTypeFacet},t).layoutType,a=e.isItemFacetResolved(b.errorFacet,t),f=m.getCurrentItemSetKey(e),l=e.demandItemFacet(v.itemsViewControl,f),c=v.itemsViewControl.evaluate(l)(e,{itemsScopeItemKey:t,itemKey:f,setDefaultLayout:i.setDefaultLayout,isLayoutResolved:!!f&&void 0,pinnedItemsView:void 0,additionalLayouts:void 0}),h=c.defaultLayout,y=c.pinnedItemsView,w=c.additionalLayouts,E=c.setDefaultLayout,S=c.isLayoutResolved,x=c.shouldShowEmptyFolder,T=c.shouldShowPinnedItems,N=c.onLoadItem,C=c.enableDropZone;return{itemSetKey:f,layoutType:u,switchLayout:function(e){n(i.switchLayout({itemsScopeItemKey:t,layoutType:e.layoutType}))},updateAvailableLayouts:function(e){n(i.updateAvailableLayouts({itemsScopeItemKey:t,layouts:e.layouts}))},pinnedItemsView:y,additionalLayouts:w,defaultLayout:h,setDefaultLayout:function(e){n(E({layoutType:e.layoutType,itemsScopeItemKey:t}))},isLayoutResolved:S,shouldShowEmptyFolder:x,shouldShowPinnedItems:T,dragDropElement:void 0===C||C?g.evaluateAction(e,r.createElement(d.DefaultDropZone,{showDropTargetHint:!0})):null,onLoadItem:function(e){n(s.signalItemsViewNavigationStart({currentItemKey:e.itemKey,previousItemKey:e.previousItemKey,itemsScopeItemKey:t}));var r=N?N(e):void 0;return function(e){n(s.signalItemsViewRenderComplete(t,e.endTime));r&&r(e)}},isItemsScopeError:a}})((S=T,function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.children,i=e.additionalLayouts,s=n.__rest(e,["children","additionalLayouts"]);return r.createElement(u.LayoutManager,{key:"manager",withLayouts:function(e){var t=e.layouts;return r.createElement(S,n.__assign({layouts:t},s))}},t,r.createElement(u.LayoutManager,null,r.createElement(a.DetailsLayout,{key:"detailsLayout"}),r.createElement(a.CompactDetailsLayout,{key:"compactDetailsLayout"}),r.createElement(f.TilesLayout,{key:"tilesLayout"}),i))};return t}(r.PureComponent)))});
define("@ms/items-view/lib/private/operations/switchLayout",["require","exports","../store/actions/createActionCreator","../facets/ScopeFacets","./getItems"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.updateAvailableLayouts=n.createAsyncActionCreator(function(e){var t=e.layouts,n=e.itemsScopeItemKey;return function(e){var s;e(i.resolveItems({items:(s={},s[n]=r.availableLayoutsFacet.pack(t),s)}))}});t.switchLayout=n.createAsyncActionCreator(function(e){var t=e.itemsScopeItemKey,n=e.layoutType;return function(e){var s;e(i.resolveItems({items:(s={},s[t]=r.layoutTypeFacet.pack(n),s)}))}});t.setDefaultLayout=n.createAsyncActionCreator(function(e){return function(t){var n;t(i.resolveItems({items:(n={},n[e.itemsScopeItemKey]=r.defaultLayoutFacet.pack(e.layoutType),n)}))}})});
define("@ms/items-view/lib/private/components/layoutManager/LayoutManager",["require","exports","tslib","react","../../utilities/Graft","../../utilities/components/Relay","../../utilities/components/RenderProps","../../utilities/objects","../../models/AutoKeyFacet","../../utilities/Memoizer"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=new a.AutoKeyFacet("layoutManager"),c={children:{},layouts:{}},h=s.createRelay(c,{merge:function(e){return{children:u.mapObject(e.children,function(e){return new i.ReplacePatch(e)}),layouts:u.mapObject(e.layouts,function(e){return n.__assign({},e,{content:new i.ReplacePatch(e.content)})})}},remove:function(e){return{children:u.mapObject(e.children,function(){return new i.Delete}),layouts:u.mapObject(e.layouts,function(){return new i.Delete})}},allowSenderOutsideReceiver:!0}),p=f.createMemoizer(function(e){return function(t){var n=t.layouts;e(n)}}),d=f.createMemoizer(function(e){var t={};for(var n in e.children)if(Object.prototype.hasOwnProperty.call(e.children,n)){var r=e.children[n];for(var i in r.layouts)Object.prototype.hasOwnProperty.call(r.layouts,i)&&(t[i]=r.layouts[i])}for(var i in e.layouts)Object.prototype.hasOwnProperty.call(e.layouts,i)&&(t[i]=e.layouts[i]);return{layouts:t}}),v=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._id=l.serializeNext();return n}t.prototype.render=function(){var e=this,t=this.props,n=t.withLayouts,i=t.children,s=t.onUpdateLayouts,u=s?p(s):void 0;return r.createElement(h.Receiver,{values:{"":i?r.createElement(r.Fragment,null,i):null}},function(t){var i,s=t.values[""],a=d(void 0===s?c:s);return r.createElement(r.Fragment,null,u?r.createElement(o.StatePropsUpdater,{stateProps:a,onUpdate:u}):null,r.createElement(h.Sender,{children:(i={},i[e._id]=a,i),layouts:{}}),o.renderChildrenWithProps(n,a))})};return t}(r.PureComponent);t.LayoutManager=v;t.asLayout=function(e){return function(t){var i=t,s=e.id;return function(t){n.__extends(o,t);function o(){return null!==t&&t.apply(this,arguments)||this}o.prototype.render=function(){var t,o=this.props,u=o.isAvailable,a=void 0===u||u,f=n.__rest(o,["isAvailable"]),l=r.createElement(i,n.__assign({},f));return r.createElement(h.Sender,{children:{},layouts:(t={},t[s]={facet:e,isAvailable:a,content:l,itemKey:f.itemKey},t)})};return o}(r.PureComponent)}}});
define("@ms/items-view/lib/private/components/layouts/DetailsLayout",["require","exports","../decorators/selectors","../decorators/withCollapsibleGroups","../decorators/connectToSelection","../layoutManager/LayoutManager","./DetailsLayoutTypeFacet","../itemSetDetailsList/ItemSetDetailsList","../decorators/withSelectedItemsContextMenu","../decorators/connectToItemCache"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=r.withCurrentGroups()(u.ItemSetDetailsList),c=a.withSelectedItemsContextMenu()(l),h=i.withItemSetSelection()(c);t.DetailsLayout=n.withCurrentItemSet()(s.asLayout(o.detailsLayoutType)(h));t.CompactDetailsLayout=n.withCurrentItemSet()(s.asLayout(o.compactDetailsLayoutType)(f.connectToItemCache(function(){return{compact:!0}})(h)))});
define("@ms/items-view/lib/private/components/decorators/withCollapsibleGroups",["require","exports","./connectToItemCache","../../facets/ScopeFacets","../../operations/toggleCollapseGroup","../../operations/toggleCollapseAll","./connectToItemsScope","../../facets/SetFacets","../../operations/readItems","../../facets/GroupFacets"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=3;t.withCurrentGroups=function(){return function(e){var t=n.connectToItemCache(function(e,t){var n=e.demandItem({groupsCollapsed:r.groupsCollapsedFacet,allGroupsCollapsed:r.allGroupsCollapsedFacet},t.itemsScopeItemKey);return{groupsCollapsed:n.groupsCollapsed,allGroupsCollapsed:n.allGroupsCollapsed}},function(e,t){return{onToggleGroupCollapsed:function(n){e(i.toggleCollapseGroup({itemsScopeItemKey:t.itemsScopeItemKey,groupKey:n.itemKey,isCollapsed:n.isCollapsed}))},onToggleCollapseAll:function(n){e(s.toggleCollapseAll({itemsScopeItemKey:t.itemsScopeItemKey,newAllCollapsed:n.newAllCollapsed,groups:n.groups}))},onGetGroupItemLimit:function(t){var n=e(a.readItems(function(e){return e.isItemFacetResolved(u.childItemsFacet,t.itemKey)})),r=t.count?t.count:0;return n?t.isShowingAll?r:Math.min(r,f.GROUP_ITEM_LIMIT):Math.min(r,l)}}})(e);return o.connectToItemsScope()(t)}}});
define("@ms/items-view/lib/private/operations/toggleCollapseGroup",["require","exports","tslib","../facets/ScopeFacets","../store/actions/createActionCreator","./getItems"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.toggleCollapseGroup=i.createAsyncActionCreator(function(e){var t=e.itemsScopeItemKey,i=e.groupKey,o=e.isCollapsed;return function(e){var u,a;e(s.resolveItems({items:(u={},u[t]=n.__assign({},r.groupsCollapsedFacet.pack((a={},a[i]=!o,a))),u)}))}})});
define("@ms/items-view/lib/private/operations/toggleCollapseAll",["require","exports","tslib","../facets/ScopeFacets","../store/actions/createActionCreator","./getItems"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.toggleCollapseAll=i.createAsyncActionCreator(function(e){var t=e.itemsScopeItemKey,i=e.newAllCollapsed,o=e.groups;return function(e){for(var u,a={},f=0,l=o;f<l.length;f++){var c=l[f];-1===c.key.indexOf("groupPage-")&&(a[c.key]=i);if(c.children)for(var h=0,p=c.children;h<p.length;h++){a[p[h].key]=i}}e(s.resolveItems({items:(u={},u[t]=n.__assign({},r.groupsCollapsedFacet.pack(a),r.allGroupsCollapsedFacet.pack(i)),u)}))}})});
define("@ms/items-view/lib/private/components/decorators/connectToSelection",["require","exports","tslib","react","office-ui-fabric-react/lib/Selection","../../utilities/components/Props","../../operations/selectItems","./connectToItemCache","../../facets/ScopeFacets","../../models/AutoKeyFacet","../../operations/readItems","../../controls/itemSetSelectionControl","../../utilities/components/Fragment","../keyboard/KeyboardShortcut","../../models/Facet","../keyboard/KeyboardMap.resx","../../models/itemsScope/getItemsScope","../../utilities/Memoizer","../decorators/withActionInvoker","../../store/enhancers/NextStoreUpdateEnhancer","../../facets/SetFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function E(e){switch(e){case i.SelectionMode.single:return"single";case i.SelectionMode.none:return"none";default:case i.SelectionMode.multiple:return"multiple"}}var S={multiple:i.SelectionMode.multiple,single:i.SelectionMode.single,none:i.SelectionMode.none},x=new f.AutoKeyFacet("selection"),T={key:new d.Facet("SelectAll").id,automationId:"SelectAll",shortcutProps:{keySequences:["CtrlA","MetaA"],content:v.default.selectAllDesc}},N={key:new d.Facet("DeselectAll").id,automationId:"DeselectAll",shortcutProps:{keySequences:["CtrlD","MetaD"],content:v.default.deselectAllDesc}},C={},k=g.createMemoizer(function(e){var t={};return function(r){return t[r]||(t[r]=n.__assign({},e,{selectionMode:r}))}});t.withItemSetSelection=function(e){return function(t){var f=x.serializeNext(),d=t;var v=function(t){n.__extends(i,t);function i(){var e=null!==t&&t.apply(this,arguments)||this;e._onSelectAllShortcut=function(){var t=e.props.selection;t&&!t.isAllSelected()&&t.setAllSelected(!0)};e._onDeselectAllShortcut=function(){var t=e.props.selection;t&&t.setAllSelected(!1)};return e}i.prototype.render=function(){var t=this.props,i=t.selection,s=(t.currentSelectionKey,n.__rest(t,["selection","currentSelectionKey"])),o=T.shortcutProps,u=N.shortcutProps;return r.createElement(h.Fragment,null,r.createElement(d,n.__assign({},s,e?e(i,this.props):{selection:i})),o?r.createElement(p.KeyboardShortcut,{key:T.key,cmdKey:o.keySequences[0],keySequences:o.keySequences,description:o.content,onExecute:this._onSelectAllShortcut}):null,u?r.createElement(p.KeyboardShortcut,{key:N.key,cmdKey:u.keySequences[0],keySequences:u.keySequences,description:u.content,onExecute:this._onDeselectAllShortcut}):null)};i.prototype.componentDidUpdate=function(e){var t=this.props,n=t.currentSelectionKey,r=t.selection;n!==e.currentSelectionKey&&n!==f&&r.getSelectedCount()&&r.setAllSelected(!1)};i.prototype.componentWillUnmount=function(){var e=this.props,t=e.currentSelectionKey,n=e.selection;t===f&&n.getSelectedCount()&&n.setAllSelected(!1)};return i}(r.PureComponent),g=s.injectInitialProps(function(e){var t=e.itemsScopeItemKey,n=e.selectionZoneProps,r=(void 0===n?{}:n).selectionMode,s=void 0===r?i.SelectionMode.multiple:r,u=e.itemCacheDispatch,c=new i.Selection({onSelectionChanged:function(){var e=c.getSelection().filter(function(e){return!u(l.readItems(function(t){return t.isItemFacetResolved(w.pageFacet,e.key)}))}).map(function(e){return e.key}),n=u(l.readItems(function(e){return e.demandItemFacet(a.currentSelectionFacet,t)}));if(0!==e.length||n&&f===n.selectionKey){u(o.selectItems({itemsScopeItemKey:t,selectedItemKeys:e,currentSelectionKey:f}));u(b.forceStoreUpdate())}},selectionMode:s,canSelectItem:e.canSelectItem});return{selection:c}})(v);var L=u.connectToItemCache(function(e,t){var n=t.selectionZoneProps,r=void 0===n?C:n,s=r.selectionMode,o=void 0===s?i.SelectionMode.multiple:s,u=m.getItemsScope(e).itemsScopeItemKey;if(!u)throw new Error("connectToSelection must be used within an ItemsScope.");var f=e.dispatch,h=e.demandItemFacet(a.currentSelectionFacet,u),p=e.demandItemFacet(c.itemSetSelectionControl,void 0),d=c.itemSetSelectionControl.evaluate(p)(e,{itemsScopeItemKey:u,selectionMode:E(o)}),v=d.selectionMode,g=d.canSelectItem,y=g?function(e){return!!e&&f(l.readItems(function(t){return g(t,{itemKey:""+e.key})}))}:void 0;return{currentSelectionKey:h&&h.selectionKey,itemsScopeItemKey:u,selectionZoneProps:k(r)(S[v]),canSelectItem:y}})(g),A=y.withActionInvoker()(L);A.displayName="WithItemSetSelection";return A}}});
define("office-ui-fabric-react/lib/Selection",["require","exports","tslib","./utilities/selection/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/items-view/lib/private/operations/selectItems",["require","exports","tslib","../store/actions/createActionCreator","../facets/ScopeFacets","../models/Facet","../utilities/Graft","./getItems"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=new s.Facet("noSelection").id;t.selectItems=r.createAsyncActionCreator(function(e){var t=e.itemsScopeItemKey,r=e.selectedItemKeys,a=e.currentSelectionKey;return function(e){var f;e(u.resolveItems({items:(f={},f[t]=n.__assign({},s.pack({selectedItems:i.selectedItemsFacet},{selectedItems:{itemKeys:new o.ArrayMirrorPatch(r)}}),a?i.currentSelectionFacet.pack({selectionKey:a}):{}),f)}))}});t.clearSelection=r.createAsyncActionCreator(function(e){var n=e.itemsScopeItemKey;return function(e){e(t.selectItems({selectedItemKeys:[],currentSelectionKey:a,itemsScopeItemKey:n}))}})});
define("@ms/items-view/lib/private/controls/itemSetSelectionControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemSetSelectionControl=new n.ControlFacet("currentSelectionControl")});
define("@ms/items-view/lib/private/components/keyboard/KeyboardShortcut",["require","exports","tslib","react","./KeyboardContext"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._registerKeyboard=function(){t.props.registerKeyboardShortcut&&(t._dispose=t.props.registerKeyboardShortcut(t.props))};return t}t.prototype.render=function(){return null};t.prototype.componentDidMount=function(){this._registerKeyboard()};t.prototype.componentDidUpdate=function(){var e=this._dispose;e&&e();this._registerKeyboard()};t.prototype.componentWillUnmount=function(){var e=this._dispose;e&&e()};return t}(r.PureComponent);t.KeyboardShortcutBase=s;var o=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this;return r.createElement(i.KEYBOARD_CONTEXT.Consumer,null,function(t){var i=t.keyboardManager;return r.createElement(s,n.__assign({},e.props,{registerKeyboardShortcut:i.registerKeyboardShortcut}))})};return t}(r.PureComponent);t.KeyboardShortcut=o});
define("@ms/items-view/lib/private/components/keyboard/KeyboardContext",["require","exports","react","@uifabric/utilities/lib/EventGroup","./keyboardMapping"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e){var t=this;this._shortcuts={};this.registerKeyboardShortcut=function(e){t._shortcuts[e.cmdKey]={keySequences:e.keySequences,description:e.description,onExecute:e.onExecute};return function(){delete t._shortcuts[e.cmdKey]}};this.registerActiveChild=function(e){if(e)t._hasActiveChildren++;else{t._hasActiveChildren--;0===t._hasActiveChildren&&t.setIsActive(!0)}};this.hasActiveChildren=function(){return t._hasActiveChildren>0};this.setIsActive=function(e){if(e&&!t._isActive){t._isActive=e;t._raisedEvent=!0;r.EventGroup.raise(document,"resetKeyboardZoneState",t,!0)}};this._onProcessKeys=function(e){var n=e.target,r=i.getKeyPressed(e);if(!n||!i.isInputElement(n)){var s=t._shortcuts[r]?t._shortcuts[r].onExecute:void 0;if(s&&(t._isActive||t._isDefault)&&!t.hasActiveChildren()){s();e.preventDefault()}}};this._events=new r.EventGroup(this);this._isDefault=e.isDefault;this._isActive=!1;this._hasActiveChildren=0;this._shortcuts={};this._raisedEvent=!1;if(this._events){this._events.on(document,"keydown",this._onProcessKeys);this._events.on(document,"resetKeyboardZoneState",function(e){t._raisedEvent?t._raisedEvent=!1:t._isActive=!1})}}e.prototype.dispose=function(){this._events.dispose()};return e}();t.KeyboardManager=s;var o={keyboardManager:new s({isDefault:!0})};t.KEYBOARD_CONTEXT=n.createContext(o)});
define("@ms/items-view/lib/private/components/keyboard/keyboardMapping",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={INPUT:!0,TEXTAREA:!0},r={A:!0,BUTTON:!0};t.isInputElement=function(e){var t=e;return t&&(t.tagName in n||t.isContentEditable)};t.isButtonElement=function(e){return e&&e.tagName in r};t.getKeyPressed=function(e){var t;t=i(e.keyCode);e.metaKey&&(t="Meta"+t);e.ctrlKey&&(t="Ctrl"+t);e.altKey&&(t="Alt"+t);e.shiftKey&&(t="Shift"+t);return t};function i(e){var t;if(e>=65&&e<=91)t=String.fromCharCode(e);else switch(e){case 8:t="Backspace";break;case 9:t="Tab";break;case 13:t="Enter";break;case 27:t="Esc";break;case 32:t="Space";break;case 37:t="Left";break;case 38:t="Up";break;case 39:t="Right";break;case 40:t="Down";break;case 46:t="Delete";break;case 113:t="F2";break;case 191:t="/";break;case 121:t="F10";break;default:t=""}return t}t.getKeyPressedFromCode=i});
define("@ms/items-view/lib/private/components/decorators/withActionInvoker",["require","exports","tslib","react","../../utilities/components/Relay","../../utilities/objects","../../utilities/Graft","../../models/AutoKeyFacet","../../hooks/useShallowMemo","../../hooks/useEventHandler"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=new u.AutoKeyFacet("actionInvokerId"),c=i.createRelay({actions:{}},{merge:function(e){return{actions:s.mapObject(e.actions,function(e){return new o.MirrorPatch(e)})}},remove:function(e){return{actions:s.mapObject(e.actions,function(){return new o.Delete})}},allowSenderOutsideReceiver:!0});t.withActionInvoker=function(){return function(e){var t=e;return function(e){var i=r.useRef(),s=f.useEventHandler(function(e,t,n){!function(e,t,n,r){var i=e&&e.key;if(r)for(var s in r.actions)if(Object.prototype.hasOwnProperty.call(r.actions,s)){var o=r.actions[s];if(o.itemKey===i&&(void 0===o.index||o.index===t)&&o.isAvailable){o.execute({event:n}).catch(function(){});break}}}(e,t,n,i.current)});return r.createElement(c.Receiver,{values:{"":r.createElement(t,n.__assign({},e,{onItemInvoked:s}))}},function(e){var t=e.values[""];i.current=t;return null})}}};t.RegisterInvokeAction=function(e){h(e);return null};function h(e){var t=r.useState(function(){return l.serializeNext()})[0],n=a.useShallowMemo(function(){var n;return{actions:(n={},n[t]=e,n)}},e);c.useSender(n)}t.useInvokeAction=h});
define("@ms/items-view/lib/private/components/layouts/DetailsLayoutTypeFacet",["require","exports","../../models/layouts/LayoutTypeFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.detailsLayoutType=new n.LayoutTypeFacet("details");t.compactDetailsLayoutType=new n.LayoutTypeFacet("compactDetails")});
define("@ms/items-view/lib/private/models/layouts/LayoutTypeFacet",["require","exports","tslib","../Facet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name=t;return n}return t}(r.Facet);t.LayoutTypeFacet=i});
define("@ms/items-view/lib/private/components/itemSetDetailsList/ItemSetDetailsList",["require","exports","tslib","react","./decorators/withDetailsListShimmer","../decorators/withColumnSelector","./decorators/withItemSetRowsAndGroups","./InjectableItemSetDetailsList","./ItemSetDetailsHeader","./hooks/useEnableShimmerAfterPageLoadProps","./hooks/useItemDetailsRowDebounceEnabledProps","./hooks/usePageLoadBarrierProps"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e,t){return e&&t?r.createElement(a.ItemSetDetailsHeader,n.__assign({},e,{defaultRender:t})):null};function p(e){var t=e.detailsListAs;return t?r.createElement(t,n.__assign({},e)):null}t.ItemSetDetailsList=function(e){var t=e.onRenderDetailsHeader,a=n.__rest(e,["onRenderDetailsHeader"]),d=i.useDetailsListShimmer(),v=s.useColumnSelector(e),m=o.useItemSetRowsAndGroups(e),g=f.useEnableShimmerAfterPageLoadProps(),y=l.useItemDetailsRowDebounceEnabledProps(),b=c.usePageLoadBarrierProps(),w=r.useMemo(function(){return{onRenderDetailsHeader:t?(e=t,n=h,function(t,r){return e(t,function(e){return n(e,r)})}):h};var e,n},[t]);return r.createElement(u.InjectableItemSetDetailsList,n.__assign({},a,v,m,w,b,y,g,d,{onRenderDetailsList:p}))};t.ItemSetDetailsList.displayName="ItemSetDetailsList"});
define("@ms/items-view/lib/private/components/itemSetDetailsList/decorators/withDetailsListShimmer",["require","exports","tslib","react","office-ui-fabric-react/lib/ShimmeredDetailsList","../../decorators/connectToItemCache"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.withDetailsListShimmer=function(){return function(e){var t=s.connectToItemCache(o)(e);t.displayName="WithDetailsListShimmer";return t}};function o(){return{detailsListAs:u}}t.useDetailsListShimmer=o;function u(e){return r.createElement(i.ShimmeredDetailsList,n.__assign({},e,{enableShimmer:!!e.enableShimmer&&0===e.items.length}))}});
define("office-ui-fabric-react/lib/ShimmeredDetailsList",["require","exports","tslib","./components/DetailsList/ShimmeredDetailsList","./components/DetailsList/ShimmeredDetailsList.base"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("office-ui-fabric-react/lib/components/DetailsList/ShimmeredDetailsList",["require","exports","../../Utilities","./ShimmeredDetailsList.base","./ShimmeredDetailsList.styles"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShimmeredDetailsList=n.styled(r.ShimmeredDetailsListBase,i.getStyles,void 0,{scope:"ShimmeredDetailsList"})});
define("office-ui-fabric-react/lib/components/DetailsList/ShimmeredDetailsList.base",["require","exports","tslib","react","../../Utilities","../../utilities/selection/interfaces","./DetailsList","../../Shimmer","./DetailsList.types","./DetailsRow.styles"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=i.classNamesFunction(),c=10,h=7,p=.95,d=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onRenderShimmerPlaceholder=function(e,t){var i=n.props.onRenderCustomPlaceholder,s=i?i(t):n._renderDefaultShimmerPlaceholder(t);return r.createElement(u.Shimmer,{customElementsGroup:s})};n._renderDefaultShimmerPlaceholder=function(e){var t=e.columns,n=e.compact,i=e.selectionMode,o=e.checkboxVisibility,l=e.cellStyleProps,c=void 0===l?f.DEFAULT_CELL_STYLE_PROPS:l,d=f.DEFAULT_ROW_HEIGHTS.rowHeight,v=f.DEFAULT_ROW_HEIGHTS.compactRowHeight,m=n?v:d+1,g=[];i!==s.SelectionMode.none&&o!==a.CheckboxVisibility.hidden&&g.push(r.createElement(u.ShimmerElementsGroup,{key:"checkboxGap",shimmerElements:[{type:u.ShimmerElementType.gap,width:"40px",height:m}]}));t.map(function(e,t){var n=[],i=c.cellLeftPadding+c.cellRightPadding+e.calculatedWidth+(e.isPadded?c.cellExtraRightPadding:0);n.push({type:u.ShimmerElementType.gap,width:c.cellLeftPadding,height:m});if(e.isIconOnly){n.push({type:u.ShimmerElementType.line,width:e.calculatedWidth,height:e.calculatedWidth});n.push({type:u.ShimmerElementType.gap,width:c.cellRightPadding,height:m})}else{n.push({type:u.ShimmerElementType.line,width:e.calculatedWidth*p,height:h});n.push({type:u.ShimmerElementType.gap,width:c.cellRightPadding+(e.calculatedWidth-e.calculatedWidth*p)+(e.isPadded?c.cellExtraRightPadding:0),height:m})}g.push(r.createElement(u.ShimmerElementsGroup,{key:t,width:i+"px",shimmerElements:n}))});g.push(r.createElement(u.ShimmerElementsGroup,{key:"endGap",width:"100%",shimmerElements:[{type:u.ShimmerElementType.gap,width:"100%",height:m}]}));return r.createElement("div",{style:{display:"flex"}},g)};n._shimmerItems=t.shimmerLines?new Array(t.shimmerLines):new Array(c);return n}t.prototype.render=function(){var e=this.props,t=e.detailsListStyles,i=e.enableShimmer,s=e.items,u=e.listProps,a=(e.onRenderCustomPlaceholder,e.removeFadingOverlay),f=(e.shimmerLines,e.styles),c=e.theme,h=n.__rest(e,["detailsListStyles","enableShimmer","items","listProps","onRenderCustomPlaceholder","removeFadingOverlay","shimmerLines","styles","theme"]),p=u&&u.className;this._classNames=l(f,{theme:c,className:p,enableShimmer:i});var d=n.__assign({},u,{className:i&&!a?this._classNames.root:p});return r.createElement(o.DetailsList,n.__assign({},h,{items:i?this._shimmerItems:s,onRenderMissingItem:this._onRenderShimmerPlaceholder,listProps:d,styles:t}))};return t}(i.BaseComponent);t.ShimmeredDetailsListBase=d});
define("office-ui-fabric-react/lib/Shimmer",["require","exports","tslib","./components/Shimmer/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("office-ui-fabric-react/lib/components/Shimmer/index",["require","exports","tslib","./Shimmer","./Shimmer.base","./Shimmer.types","./ShimmerLine/ShimmerLine","./ShimmerLine/ShimmerLine.base","./ShimmerCircle/ShimmerCircle","./ShimmerCircle/ShimmerCircle.base","./ShimmerGap/ShimmerGap","./ShimmerGap/ShimmerGap.base","./ShimmerElementsGroup/ShimmerElementsGroup","./ShimmerElementsGroup/ShimmerElementsGroup.base"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);n.__exportStar(a,t);n.__exportStar(f,t);n.__exportStar(l,t);n.__exportStar(c,t);n.__exportStar(h,t);n.__exportStar(p,t)});
define("office-ui-fabric-react/lib/components/Shimmer/Shimmer",["require","exports","../../Utilities","./Shimmer.styles","./Shimmer.base"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Shimmer=n.styled(i.ShimmerBase,r.getStyles,void 0,{scope:"Shimmer"})});
define("office-ui-fabric-react/lib/components/Shimmer/Shimmer.styles",["require","exports","../../Styling","../../Utilities"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={root:"ms-Shimmer-container",shimmerWrapper:"ms-Shimmer-shimmerWrapper",dataWrapper:"ms-Shimmer-dataWrapper"},s=n.keyframes({"0%":{backgroundPosition:"-1000%"},"100%":{backgroundPosition:"1000%"}}),o=n.keyframes({"100%":{backgroundPosition:"-1000%"},"0%":{backgroundPosition:"1000%"}});t.getStyles=function(e){var t,u=e.isDataLoaded,a=e.className,f=e.theme,l=e.transitionAnimationInterval,c=e.shimmerColor,h=e.shimmerWaveColor,p=f.palette,d=n.getGlobalClassNames(i,f),v=r.getRTL();return{root:[d.root,f.fonts.medium,{position:"relative",height:"auto"},a],shimmerWrapper:[d.shimmerWrapper,{background:(c||p.neutralLighter)+"\n                    linear-gradient(\n                      to right,\n                      "+(c||p.neutralLighter)+" 0%,\n                      "+(h||p.neutralLight)+" 50%,\n                      "+(c||p.neutralLighter)+" 100%)\n                    0 0 / 90% 100%\n                    no-repeat",animationDuration:"2s",animationTimingFunction:"ease-in-out",animationDirection:"normal",animationIterationCount:"infinite",animationName:v?o:s,transition:"opacity "+l+"ms",selectors:(t={},t[n.HighContrastSelector]={background:"WindowText\n                        linear-gradient(\n                          to right,\n                          transparent 0%,\n                          Window 50%,\n                          transparent 100%)\n                        0 0 / 90% 100%\n                        no-repeat"},t)},u&&{opacity:"0",position:"absolute",top:"0",bottom:"0",left:"0",right:"0"}],dataWrapper:[d.dataWrapper,{position:"absolute",top:"0",bottom:"0",left:"0",right:"0",opacity:"0",background:"none",backgroundColor:"transparent",border:"none",transition:"opacity "+l+"ms"},u&&{opacity:"1",position:"static"}],screenReaderText:n.hiddenContentStyle}}});
define("office-ui-fabric-react/lib/components/Shimmer/Shimmer.base",["require","exports","tslib","react","../../Utilities","./ShimmerElementsGroup/ShimmerElementsGroup"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i.classNamesFunction(),u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.state={contentLoaded:t.isDataLoaded};return n}t.prototype.componentWillReceiveProps=function(e){var t=this,n=e.isDataLoaded;if(void 0!==this._lastTimeoutId){this._async.clearTimeout(this._lastTimeoutId);this._lastTimeoutId=void 0}n?this._lastTimeoutId=this._async.setTimeout(function(){t.setState({contentLoaded:n});t._lastTimeoutId=void 0},200):this.setState({contentLoaded:n})};t.prototype.render=function(){var e=this.props,t=e.styles,u=e.shimmerElements,a=e.children,f=e.isDataLoaded,l=e.width,c=e.className,h=e.customElementsGroup,p=e.theme,d=e.ariaLabel,v=e.shimmerColors,m=this.state.contentLoaded;this._classNames=o(t,{theme:p,isDataLoaded:f,className:c,transitionAnimationInterval:200,shimmerColor:v&&v.shimmer,shimmerWaveColor:v&&v.shimmerWave});var g=i.getNativeProps(this.props,i.divProperties);return r.createElement("div",n.__assign({},g,{className:this._classNames.root}),!m&&r.createElement("div",{style:{width:l||"100%"},className:this._classNames.shimmerWrapper},h||r.createElement(s.ShimmerElementsGroup,{shimmerElements:u,backgroundColor:v&&v.background})),a&&r.createElement("div",{className:this._classNames.dataWrapper},a),d&&!f&&r.createElement("div",{role:"status","aria-live":"polite"},r.createElement(i.DelayedRender,null,r.createElement("div",{className:this._classNames.screenReaderText},d))))};t.defaultProps={isDataLoaded:!1};return t}(i.BaseComponent);t.ShimmerBase=u});
define("office-ui-fabric-react/lib/components/Shimmer/ShimmerElementsGroup/ShimmerElementsGroup",["require","exports","../../../Utilities","./ShimmerElementsGroup.base","./ShimmerElementsGroup.styles"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShimmerElementsGroup=n.styled(r.ShimmerElementsGroupBase,i.getStyles,void 0,{scope:"ShimmerElementsGroup"})});
define("office-ui-fabric-react/lib/components/Shimmer/ShimmerElementsGroup/ShimmerElementsGroup.base",["require","exports","tslib","react","../../../Utilities","../Shimmer.types","../ShimmerLine/ShimmerLine","../ShimmerGap/ShimmerGap","../ShimmerCircle/ShimmerCircle"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=i.classNamesFunction(),l=function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._getRenderedElements=function(e,t){return e?e.map(function(e,f){e.type;var l=n.__rest(e,["type"]);switch(e.type){case s.ShimmerElementType.circle:return r.createElement(a.ShimmerCircle,n.__assign({key:f},l,{styles:i._getStyles(e,t)}));case s.ShimmerElementType.gap:return r.createElement(u.ShimmerGap,n.__assign({key:f},l,{styles:i._getStyles(e,t)}));case s.ShimmerElementType.line:return r.createElement(o.ShimmerLine,n.__assign({key:f},l,{styles:i._getStyles(e,t)}))}}):r.createElement(o.ShimmerLine,{height:s.ShimmerElementsDefaultHeights.line,styles:{root:[{borderWidth:"0px"}]}})};i._getStyles=function(e,t){var r,o=i.props.backgroundColor,u=e.verticalAlign,a=e.type,f=e.height,l=t&&f?t-f:0;u&&"center"!==u?u&&"top"===u?r={borderBottomWidth:(l||0)+"px",borderTopWidth:"0px"}:u&&"bottom"===u&&(r={borderBottomWidth:"0px",borderTopWidth:(l||0)+"px"}):r={borderBottomWidth:(l?Math.floor(l/2):0)+"px",borderTopWidth:(l?Math.ceil(l/2):0)+"px"};if(o)switch(a){case s.ShimmerElementType.circle:return{root:n.__assign({},r,{borderColor:o}),svg:{fill:o}};case s.ShimmerElementType.gap:return{root:n.__assign({},r,{borderColor:o,backgroundColor:o})};case s.ShimmerElementType.line:return{root:n.__assign({},r,{borderColor:o}),topLeftCorner:{fill:o},topRightCorner:{fill:o},bottomLeftCorner:{fill:o},bottomRightCorner:{fill:o}}}return{root:n.__assign({},r)}};i._findMaxElementHeight=function(e){return e.map(function(e){switch(e.type){case s.ShimmerElementType.circle:e.height||(e.height=s.ShimmerElementsDefaultHeights.circle);case s.ShimmerElementType.line:e.height||(e.height=s.ShimmerElementsDefaultHeights.line);case s.ShimmerElementType.gap:e.height||(e.height=s.ShimmerElementsDefaultHeights.gap)}return e}).reduce(function(e,t){return t.height&&t.height>e?t.height:e},0)};return i}t.prototype.render=function(){var e=this.props,t=e.styles,n=e.width,i=e.shimmerElements,s=e.rowHeight,o=e.flexWrap,u=e.theme;this._classNames=f(t,{theme:u,flexWrap:o});var a=s||this._findMaxElementHeight(i||[]);return r.createElement("div",{style:{width:n||"auto"},className:this._classNames.root},this._getRenderedElements(i,a))};t.defaultProps={flexWrap:!1};return t}(i.BaseComponent);t.ShimmerElementsGroupBase=l});
define("office-ui-fabric-react/lib/components/Shimmer/Shimmer.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.line=1]="line";e[e.circle=2]="circle";e[e.gap=3]="gap"}(t.ShimmerElementType||(t.ShimmerElementType={}));!function(e){e[e.line=16]="line";e[e.gap=16]="gap";e[e.circle=24]="circle"}(t.ShimmerElementsDefaultHeights||(t.ShimmerElementsDefaultHeights={}))});
define("office-ui-fabric-react/lib/components/Shimmer/ShimmerLine/ShimmerLine",["require","exports","../../../Utilities","./ShimmerLine.base","./ShimmerLine.styles"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShimmerLine=n.styled(r.ShimmerLineBase,i.getStyles,void 0,{scope:"ShimmerLine"})});
define("office-ui-fabric-react/lib/components/Shimmer/ShimmerLine/ShimmerLine.base",["require","exports","tslib","react","../../../Utilities"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.classNamesFunction(),o=function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.height,n=e.styles,i=e.width,o=e.borderStyle,u=e.theme;this._classNames=s(n,{theme:u,height:t,borderStyle:o});return r.createElement("div",{style:{width:i||"100%",minWidth:"number"==typeof i?i+"px":"auto"},className:this._classNames.root},r.createElement("svg",{width:"2",height:"2",className:this._classNames.topLeftCorner},r.createElement("path",{d:"M0 2 A 2 2, 0, 0, 1, 2 0 L 0 0 Z"})),r.createElement("svg",{width:"2",height:"2",className:this._classNames.topRightCorner},r.createElement("path",{d:"M0 0 A 2 2, 0, 0, 1, 2 2 L 2 0 Z"})),r.createElement("svg",{width:"2",height:"2",className:this._classNames.bottomRightCorner},r.createElement("path",{d:"M2 0 A 2 2, 0, 0, 1, 0 2 L 2 2 Z"})),r.createElement("svg",{width:"2",height:"2",className:this._classNames.bottomLeftCorner},r.createElement("path",{d:"M2 2 A 2 2, 0, 0, 1, 0 0 L 0 2 Z"})))};return t}(i.BaseComponent);t.ShimmerLineBase=o});
define("office-ui-fabric-react/lib/components/Shimmer/ShimmerLine/ShimmerLine.styles",["require","exports","../../../Styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={root:"ms-ShimmerLine-root",topLeftCorner:"ms-ShimmerLine-topLeftCorner",topRightCorner:"ms-ShimmerLine-topRightCorner",bottomLeftCorner:"ms-ShimmerLine-bottomLeftCorner",bottomRightCorner:"ms-ShimmerLine-bottomRightCorner"};t.getStyles=function(e){var t,i=e.height,s=e.borderStyle,o=e.theme,u=o.palette,a=n.getGlobalClassNames(r,o),f=s||{},l={position:"absolute",fill:u.white};return{root:[a.root,o.fonts.medium,{height:i+"px",boxSizing:"content-box",position:"relative",borderTopStyle:"solid",borderBottomStyle:"solid",borderColor:u.white,selectors:(t={},t[n.HighContrastSelector]={borderColor:"Window",selectors:{"> *":{fill:"Window"}}},t)},f],topLeftCorner:[a.topLeftCorner,{top:"0",left:"0"},l],topRightCorner:[a.topRightCorner,{top:"0",right:"0"},l],bottomRightCorner:[a.bottomRightCorner,{bottom:"0",right:"0"},l],bottomLeftCorner:[a.bottomLeftCorner,{bottom:"0",left:"0"},l]}}});
define("office-ui-fabric-react/lib/components/Shimmer/ShimmerGap/ShimmerGap",["require","exports","../../../Utilities","./ShimmerGap.base","./ShimmerGap.styles"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShimmerGap=n.styled(r.ShimmerGapBase,i.getStyles,void 0,{scope:"ShimmerGap"})});
define("office-ui-fabric-react/lib/components/Shimmer/ShimmerGap/ShimmerGap.base",["require","exports","tslib","react","../../../Utilities"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.classNamesFunction(),o=function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.height,n=e.styles,i=e.width,o=e.borderStyle,u=e.theme;this._classNames=s(n,{theme:u,height:t,borderStyle:o});return r.createElement("div",{style:{width:i||"10px",minWidth:"number"==typeof i?i+"px":"auto"},className:this._classNames.root})};return t}(i.BaseComponent);t.ShimmerGapBase=o});
define("office-ui-fabric-react/lib/components/Shimmer/ShimmerGap/ShimmerGap.styles",["require","exports","../../../Styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={root:"ms-ShimmerGap-root"};t.getStyles=function(e){var t,i=e.height,s=e.borderStyle,o=e.theme,u=o.palette,a=s||{};return{root:[n.getGlobalClassNames(r,o).root,o.fonts.medium,{backgroundColor:u.white,height:i+"px",boxSizing:"content-box",borderTopStyle:"solid",borderBottomStyle:"solid",borderColor:u.white,selectors:(t={},t[n.HighContrastSelector]={backgroundColor:"Window",borderColor:"Window"},t)},a]}}});
define("office-ui-fabric-react/lib/components/Shimmer/ShimmerCircle/ShimmerCircle",["require","exports","../../../Utilities","./ShimmerCircle.styles","./ShimmerCircle.base"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShimmerCircle=n.styled(i.ShimmerCircleBase,r.getStyles,void 0,{scope:"ShimmerCircle"})});
define("office-ui-fabric-react/lib/components/Shimmer/ShimmerCircle/ShimmerCircle.styles",["require","exports","../../../Styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={root:"ms-ShimmerCircle-root",svg:"ms-ShimmerCircle-svg"};t.getStyles=function(e){var t,i,s=e.height,o=e.borderStyle,u=e.theme,a=u.palette,f=n.getGlobalClassNames(r,u),l=o||{};return{root:[f.root,u.fonts.medium,{width:s+"px",height:s+"px",minWidth:s+"px",boxSizing:"content-box",borderTopStyle:"solid",borderBottomStyle:"solid",borderColor:a.white,selectors:(t={},t[n.HighContrastSelector]={borderColor:"Window"},t)},l],svg:[f.svg,{display:"block",fill:a.white,selectors:(i={},i[n.HighContrastSelector]={fill:"Window"},i)}]}}});
define("office-ui-fabric-react/lib/components/Shimmer/ShimmerCircle/ShimmerCircle.base",["require","exports","tslib","react","../../../Utilities"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.classNamesFunction(),o=function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.height,n=e.styles,i=e.borderStyle,o=e.theme;this._classNames=s(n,{theme:o,height:t,borderStyle:i});return r.createElement("div",{className:this._classNames.root},r.createElement("svg",{viewBox:"0 0 10 10",width:t,height:t,className:this._classNames.svg},r.createElement("path",{d:"M0,0 L10,0 L10,10 L0,10 L0,0 Z M0,5 C0,7.76142375 2.23857625,10 5,10 C7.76142375,10 10,7.76142375 10,5 C10,2.23857625 7.76142375,2.22044605e-16 5,0 C2.23857625,-2.22044605e-16 0,2.23857625 0,5 L0,5 Z"})))};return t}(i.BaseComponent);t.ShimmerCircleBase=o});
define("office-ui-fabric-react/lib/components/Shimmer/ShimmerElementsGroup/ShimmerElementsGroup.styles",["require","exports","../../../Styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={root:"ms-ShimmerElementsGroup-root"};t.getStyles=function(e){var t=e.flexWrap,i=e.theme;return{root:[n.getGlobalClassNames(r,i).root,i.fonts.medium,{display:"flex",alignItems:"center",flexWrap:t?"wrap":"nowrap"}]}}});
define("office-ui-fabric-react/lib/components/DetailsList/ShimmeredDetailsList.styles",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=function(e){var t=e.theme,n=e.className,r=e.enableShimmer,i=t.semanticColors,s={position:"relative",selectors:{":after":{content:'""',position:"absolute",top:0,right:0,bottom:0,left:0,backgroundImage:"linear-gradient(to bottom,\n                          transparent 30%,\n                          "+t.palette.whiteTranslucent40+" 65%,\n                          "+i.listBackground+" 100%)"}}};return{root:[r&&s,n]}}});
define("@ms/items-view/lib/private/components/decorators/withColumnSelector",["require","exports","./connectToItemCache","../../controls/itemSetColumnsControl","../columns/fileTypeIcon/fileTypeIconColumn","../columns/displayName/displayNameColumn","../columns/fields/fieldsColumn","../../hooks/useItemCacheSelector","../../models/itemCache/bindItemCacheSelectorToProps"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.withColumnSelector=function(){return n.connectToItemCache(l)};t.useColumnSelector=function(e){var t=e.columnReorderOptions,n=e.columnSelector,r=e.columns,i=e.itemKey,s=e.layoutMode,o=e.onColumnResize,f=e.skipViewportMeasures;return u.useItemCacheSelector(a.bindItemCacheSelectorToProps(l,e),[t,n,r,i,s,o,f])};var f=[i.fileTypeIconColumn,s.displayNameColumn,o.fieldsColumn];function l(e,t){var n,i=t.columns,s=t.columnSelector?(n=t.columnSelector,function(e,t){return{columns:n(e,t.itemSetKey,t.columns)}}):e.demandItemFacet(r.itemSetColumnsControl,t.itemKey),u=r.itemSetColumnsControl.evaluate(s)(e,{itemSetKey:t.itemKey,columns:i}),a=u.columns,l=void 0===a?f:a,c=u.onColumnResize,h=u.layoutMode,p=u.skipViewportMeasures,d=u.columnReorderOptions;return{columns:l.filter(function(e){return e.key!==o.fieldsColumn.key}),onColumnResize:c,layoutMode:h,skipViewportMeasures:p,columnReorderOptions:d}}});
define("@ms/items-view/lib/private/controls/itemSetColumnsControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemSetColumnsControl=new n.ControlFacet("itemSetColumns")});
define("@ms/items-view/lib/private/components/columns/fileTypeIcon/fileTypeIconColumn",["require","exports","../createColumn","../columns.resx","../../../models/Facet","../columns.scss","../../itemFileTypeIcon/ItemFileTypeIcon","./fileTypeIconColumn.scss"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileTypeIconColumn=n.createColumn({key:new i.Facet("fileTypeIconColumn").id,name:r.default.FileType,isIconOnly:!0,iconName:"page",iconClassName:""+s.fileTypeIcon,className:s.fileTypeIconColumn,headerClassName:s.fileTypeIconHeader,fieldName:"",isCollapsible:!1,isResizable:!1,minWidth:n.ColumnWidth.iconMin,maxWidth:n.ColumnWidth.iconMax},o.ItemFileTypeIcon)(function(e,t){return function(e){var r,i=e.column,s=i?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,r=e;n<r.length;n++){var i=r[n];return"number"==typeof i?i:void 0}}(i.currentWidth,i.calculatedWidth,i.minWidth):void 0;r="number"==typeof s?s>=96?96:s>=48?48:s>=40?40:s>=32?32:s>=24?24:s>=20?20:16:n.ColumnWidth.iconMin;return{className:u.icon,itemKey:t,size:r}}},function(e,t){return""+s.fileTypeIcon})});
define("@ms/items-view/lib/private/components/columns/createColumn",["require","exports","tslib","react","../decorators/connectToItemCache","../../utilities/components/Decorators"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.iconMin=20]="iconMin";e[e.iconMax=20]="iconMax";e[e.regularMin=90]="regularMin";e[e.regularMax=130]="regularMax";e[e.displayNameMin=180]="displayNameMin";e[e.displayNameMax=280]="displayNameMax";e[e.sharedMax=150]="sharedMax"}(t.ColumnWidth||(t.ColumnWidth={}));function o(e,t){var o=e.data,a=n.__rest(void 0===o?{}:o,[]),f=n.__rest(e,["data"]),l=i.connectToItemCacheLinkFacet.unpack(t),c=l?l.component:t;return function(e,o){var h=i.connectToItemCache(function(t,r){var i=r.itemKey,s=n.__rest(r,["itemKey"]),o=e(t,i),a=l?l.mapItemCacheToProps(t,r):{},f=u(o)?o(n.__assign({},s,{key:i})):o;return n.__assign({},a,f)})(t);return n.__assign({},f,{data:n.__assign({},a,{renderHandler:function(t,r){if(r.renderer)return{};var i=r.itemKey,a=e(t,i),f=o?o(t,i):"",h=l?l.mapItemCacheToProps(t,{itemKey:i}):{},p=u(a)?a:function(e){return a};return{renderer:function(e,t,r){var i=p(n.__assign({},e,{index:t,column:r}));return s.renderComponentWithProps(c,n.__assign({},h,i))},getValueKey:function(){return f}}}}),onRender:function(e,t,i){return r.createElement(h,n.__assign({itemKey:e.key},e,{index:t,column:i}))}})}}t.createColumn=o;t.createFacetColumn=function(e,t,n){return function(r){return o(e,n)(function(e,n){var i=e.demandItem(t,n);return r(i)})}};function u(e){return"function"==typeof e}});
define("@ms/items-view/lib/private/utilities/components/Decorators",["require","exports","react"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.renderComponentWithProps=function(e,t){return e===n.Fragment?n.createElement(n.Fragment,null,t.children):n.createElement(e,t)}});
define("@ms/items-view/lib/private/components/columns/columns.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".fileTypeIcon_9a419b77{font-size:20px;overflow:visible}.fileTypeIconColumn_9a419b77{overflow:visible}.fileTypeIconHeader_9a419b77 .ms-DetailsHeader-cellName{text-overflow:initial;overflow:visible}.fileTypeIconHeader_9a419b77 .fileTypeIcon_9a419b77{font-size:16px}\n"}]);t.fileTypeIcon="fileTypeIcon_9a419b77";t.fileTypeIconColumn="fileTypeIconColumn_9a419b77";t.fileTypeIconHeader="fileTypeIconHeader_9a419b77"});
define("@ms/items-view/lib/private/components/itemFileTypeIcon/ItemFileTypeIcon",["require","exports","tslib","react","office-ui-fabric-react/lib/Icon","@uifabric/file-type-icons/lib/index","../decorators/connectToItemCache","../../facets/ItemFacets","../../facets/DocumentFacets","../../controls/itemFileTypeIconControl","../brandIcon/brandIconHelper","../../utilities/components/DeferredRender","../fields/FieldHelper","@uifabric/utilities/lib/css","./ItemFileTypeIcon.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FileTypeIcon=function(e){var t,o=e.extension,u=e.type,a=e.className,f=e.isOneNote,h=e.size,v=e.isFolder,m=e.preferAppIcon,g=void 0!==m&&m,y=e.pageLoadBarrier,b=24===h?20:h,w=e.iconAs||i.Icon,E=f?"one":o;return r.createElement(c.DeferredRender,{barrier:y},r.createElement(w,n.__assign({defaultRender:i.Icon,className:p.css(d.root,a,(t={},t[d.inset24]=24===h,t))},(g&&E?l.getBrandTypeIconProps({size:b,extension:E}):void 0)||s.getFileTypeIconProps(n.__assign({},o||u||f||v?{extension:E,type:void 0!==u?u:v?2:void 0}:{type:3},{size:b})))))};t.ItemFileTypeIcon=o.connectToItemCache(function(e,n){var r=n.itemKey,s=e.demandItem({fileName:u.fileNameFacet,folder:u.folderFacet,fileIconType:a.fileIconTypeFacet,oneNote:a.oneNoteFacet,controlHandler:f.itemFileTypeIconControl},r),o=s.fileName,l=s.folder,c=s.fileIconType,p=s.oneNote,d=s.controlHandler,v=o&&o.extension,m=f.itemFileTypeIconControl.evaluate(d)(e,{itemKey:r,iconAs:i.Icon,fileTypeIconAs:t.FileTypeIcon}),g=m.iconAs;return{extension:v,defaultRender:m.fileTypeIconAs,isFolder:!!l,type:c,isOneNote:!!p,iconAs:g,pageLoadBarrier:h.getFieldRenderBarrier(e)}})(function(e){var t=e.defaultRender,i=n.__rest(e,["defaultRender"]);return t?r.createElement(t,n.__assign({},i)):null})});
define("@uifabric/file-type-icons/lib/index",["require","exports","./initializeFileTypeIcons","./getFileTypeIconProps","./FileIconType","./version"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeFileTypeIcons=n.initializeFileTypeIcons;t.getFileTypeIconProps=r.getFileTypeIconProps;t.FileIconType=i.FileIconType});
define("@uifabric/file-type-icons/lib/initializeFileTypeIcons",["require","exports","react","@uifabric/styling","./FileTypeIconMap"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s="_png",o="_svg",u="https://spoprod-a.akamaihd.net/files/fabric/assets/item-types/",a=[16,20,32,40,48,64,96],f="?refresh1";t.initializeFileTypeIcons=function(e,t){void 0===e&&(e=u);a.forEach(function(u){!function(e,t,u){var a=Object.keys(i.FileTypeIconMap),l={};a.forEach(function(r){l[r+t+s]=n.createElement("img",{src:e+t+"/"+r+".png"+f});l[r+t+o]=n.createElement("img",{src:e+t+"/"+r+".svg"+f});if(20!==t){l[r+t+"_1.5x"+s]=n.createElement("img",{src:e+t+"_1.5x/"+r+".png"+f,height:"100%",width:"100%"});l[r+t+"_1.5x"+o]=n.createElement("img",{src:e+t+"_1.5x/"+r+".svg"+f,height:"100%",width:"100%"})}l[r+t+"_2x"+s]=n.createElement("img",{src:e+t+"_2x/"+r+".png"+f,height:"100%",width:"100%"});l[r+t+"_3x"+s]=n.createElement("img",{src:e+t+"_3x/"+r+".png"+f,height:"100%",width:"100%"});l[r+t+"_4x"+s]=n.createElement("img",{src:e+t+"_4x/"+r+".png"+f,height:"100%",width:"100%"})});r.registerIcons({fontFace:{},style:{width:t,height:t,overflow:"hidden"},icons:l},u)}(e,u,t)})}});
define("@uifabric/file-type-icons/lib/FileTypeIconMap",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FileTypeIconMap={accdb:{extensions:["accdb","mdb"]},archive:{extensions:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z"]},audio:{extensions:["aif","aiff","aac","amr","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","oga","ra","rm","wav","wma","wv"]},channelfolder:{},code:{extensions:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","Hcp","h","h++","haml","handlebars","hbs","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","ps1xml","psd1","psm1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","shtml","sml","svn-base","swift","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"]},css:{},csv:{extensions:["csv"]},docset:{},docx:{extensions:["b","doc","docm","docx","docb"]},dotx:{extensions:["dot","dotm","dotx"]},email:{extensions:["eml","msg","ost","pst"]},exe:{extensions:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"]},folder:{},font:{extensions:["ttf","otf","woff"]},genericfile:{},html:{extensions:["htm","html","mht"]},link:{extensions:["lnk","link","url","website","webloc"]},linkedfolder:{},splist:{extensions:["listitem"]},model:{extensions:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layer","layout","max","mtl","obj","off","ply","skp","stp","stl","t","thl","x"]},mpp:{extensions:["mpp"]},mpt:{extensions:["mpt"]},multiple:{},one:{extensions:["one"]},onetoc:{extensions:["ms-one-stub","onetoc","onetoc2","onepkg"]},pdf:{extensions:["pdf"]},photo:{extensions:["arw","bmp","cr2","crw","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psd","raw","tga","tif","tiff","wdp"]},photo360:{},potx:{extensions:["pot","potm","potx"]},powerbi:{extensions:["pbix"]},ppsx:{extensions:["pps","ppsm","ppsx"]},pptx:{extensions:["ppt","pptm","pptx","sldx","sldm"]},presentation:{extensions:["odp","gslides","key"]},pub:{extensions:["pub"]},spo:{extensions:["aspx"]},sponews:{},spreadsheet:{extensions:["odc","ods","gsheet","numbers"]},rtf:{extensions:["epub","gdoc","odt","rtf","wri","pages"]},sharedfolder:{},sway:{},sysfile:{extensions:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","ldt","lrprev","pkpass","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xlb","xll"]},txt:{extensions:["dif","diff","readme","out","plist","properties","text","txt"]},vaultclosed:{},vaultopen:{},vector:{extensions:["ai","cvs","dgn","gdraw","pd","emf","eps","fig","ind","indd","indt","indb","ps","svg","svgz","wmf","oxps","xps","xd","sketch"]},video:{extensions:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4","mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"]},video360:{},vsdx:{extensions:["vdx","vsd","vsdm","vsdx","vsw","vdw"]},vssx:{extensions:["vss","vssm","vssx"]},vstx:{extensions:["vst","vstm","vstx","vsx"]},xlsx:{extensions:["xlc","xls","xlsb","xlsm","xlsx"]},xltx:{extensions:["xlt","xltm","xltx"]},xml:{extensions:["xaml","xml","xsl"]},xsn:{extensions:["xsn"]},zip:{extensions:["zip"]}}});
define("@uifabric/file-type-icons/lib/getFileTypeIconProps",["require","exports","./FileTypeIconMap","./FileIconType"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s="genericfile",o="folder",u="sharedfolder",a="docset",f="splist",l="multiple",c=16;t.getFileTypeIconProps=function(e){var t=s;if(e.extension)t=function(e){if(!i){i={};for(var t in n.FileTypeIconMap)if(n.FileTypeIconMap.hasOwnProperty(t)){var r=n.FileTypeIconMap[t].extensions;if(r)for(var o=0;o<r.length;o++)i[r[o]]=t}}e=e.replace(".","").toLowerCase();return i[e]||s}(e.extension);else if(e.type)switch(e.type){case r.FileIconType.docset:t=a;break;case r.FileIconType.folder:t=o;break;case r.FileIconType.listItem:t=f;break;case r.FileIconType.sharedFolder:t=u;break;case r.FileIconType.multiple:t=l}return{iconName:t+function(e,t){void 0===t&&(t="svg");var n=window.devicePixelRatio,r="";"svg"===t&&1<n&&n<=1.5?20!==e&&(r="_1.5x"):"png"===t&&(1<n&&n<=1.5?r=20===e?"_2x":"_1.5x":1.5<n&&n<=2?r="_2x":2<n&&n<=3?r="_3x":3<n&&(r="_4x"));return e+r+"_"+t}(e.size||c,e.imageFileType)}}});
define("@uifabric/file-type-icons/lib/FileIconType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.docset=1]="docset";e[e.folder=2]="folder";e[e.genericFile=3]="genericFile";e[e.listItem=4]="listItem";e[e.sharedFolder=5]="sharedFolder";e[e.multiple=6]="multiple"}(t.FileIconType||(t.FileIconType={}))});
define("@uifabric/file-type-icons/lib/version",["require","exports","@uifabric/set-version"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.setVersion("@uifabric/file-type-icons","6.5.5")});
define("@ms/items-view/lib/private/facets/DocumentFacets",["require","exports","../models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileIconTypeFacet=new n.Facet("fileIconType");t.oneNoteFacet=new n.Facet("oneNote")});
define("@ms/items-view/lib/private/controls/itemFileTypeIconControl",["require","exports","../models/controls/ControlFacet","../components/controls/defaultRenderComponentControlOption"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemFileTypeIconControl=new n.ControlFacet("itemFileTypeIconControl",{iconAs:r.defaultRenderComponentOption(),fileTypeIconAs:r.defaultRenderComponentOption()})});
define("@ms/items-view/lib/private/components/brandIcon/brandIconHelper",["require","exports","react","@uifabric/file-type-icons/lib/FileTypeIconMap","@uifabric/styling/lib/utilities/icons","./brandIconMap"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,u,a=16,f=48,l="https://static2.sharepointonline.com/files/fabric/assets/brand-icons/product/",c=[16,20,32,40,48,64,96],h=["svg","png"];t.getBrandTypeIconProps=function(e){var t=function(e){if(!u){u={};for(var t in s.brandIconMap)if(s.brandIconMap.hasOwnProperty(t))for(var n=s.brandIconMap[t],r=0,i=n;r<i.length;r++){var o=i[r];u[o]=t}}return u[e]}(function(e){if(!o){o={};for(var t in r.FileTypeIconMap)if(r.FileTypeIconMap.hasOwnProperty(t)){var n=r.FileTypeIconMap[t].extensions;if(n)for(var i=0;i<n.length;i++)o[n[i]]=t}}e=e.replace(".","").toLowerCase();return o[e]}(e.extension));if(t){var n=e.imageFileType||"svg",i=function(e,t){if("svg"===e)return 16===t||48===t?t:f;return t||a}(n,e.size);return{iconName:n+"/"+t+"_"+i+"x"+p(i,n)+"."+n}}};function p(e,t){var n=window.devicePixelRatio,r="1";"svg"===t&&1<n&&n<=1.5?20!==e&&(r="1_5"):"png"===t&&(1<n&&n<=1.5?r=20===e?"2":"1_5":1.5<n&&n<=2?r="2":2<n&&n<=3?r="3":3<n&&(r="4"));return r}t.initializeBrandTypeIcons=function(e,t){void 0===e&&(e=l);c.forEach(function(r){var o=function(o){s.brandIconMap.hasOwnProperty(o)&&h.forEach(function(s){var u,a=p(r,s);i.registerIcons({fontFace:{},style:{width:"1"===a?r:"100%",height:"1"===a?r:"100%",overflow:"hidden"},icons:(u={},u[s+"/"+o+"_"+r+"x"+a+"."+s]=n.createElement("img",{alt:"",src:""+e+s+"/"+o+"_"+r+"x"+a+"."+s}),u)},t)})};for(var u in s.brandIconMap)o(u)})}});
define("@ms/items-view/lib/private/components/brandIcon/brandIconMap",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.brandIconMap={access:["accdb"],delve:[],excel:["csv","ods","xls","xlsx","xltx"],infopath:["xsn"],office:[],onedrive:[],onenote:["one","onepkg","onetoc"],outlook:[],powerpoint:["odp","potx","ppsx","pptx"],project:["mpp","mpt","pub"],sharepoint:[],sway:[],visio:["vstx"],word:["docx","dotx","odt"]}});
define("@ms/items-view/lib/private/utilities/components/DeferredRender",["require","exports","tslib","react","react-dom","./RenderProps"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=new WeakMap,u=new WeakMap,a=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onBarrier=function(){n._isDisposed||n.setState({hasResolved:!0})};var r=n.props.barrier;n.state={hasResolved:!r||!!o.get(r)};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.barrier;t!==this.props.barrier&&(this.state={hasResolved:!t||!!o.get(t)})};t.prototype.render=function(){var e=this.props,t=e.placeholder,n=e.children,i=this.state.hasResolved;return s.isRenderProp(n)?r.createElement(r.Fragment,null,n({hasResolved:i})):i?s.renderChildrenWithProps(n,{hasResolved:i}):t?r.createElement(r.Fragment,null,t):null};t.prototype.componentDidMount=function(){var e=this.props.barrier;!this.state.hasResolved&&e&&this._subscribe(e)};t.prototype.componentDidUpdate=function(e){var t=this.props.barrier,n=e.barrier;if(t!==n){n&&this._unsubscribe(n);!this.state.hasResolved&&t&&this._subscribe(t)}};t.prototype.componentWillUnmount=function(){var e=this.props.barrier;e&&this._unsubscribe(e);this._isDisposed=!0};t.prototype._subscribe=function(e){if(!o.has(e)){if(!u.has(e)){var t=[];u.set(e,t);e.then(function(){o.set(e,!0);i.unstable_batchedUpdates(function(){for(var e=0,n=t;e<n.length;e++){(0,n[e])()}});u.delete(e)})}u.get(e).push(this._onBarrier)}};t.prototype._unsubscribe=function(e){var t=u.get(e);if(t){var n=t.indexOf(this._onBarrier);n>-1&&t.splice(n,1)}};return t}(r.PureComponent);t.DeferredRender=a});
define("@ms/items-view/lib/private/components/fields/FieldHelper",["require","exports","./FieldStrings.resx","../../models/configuration/getConfiguration","../../facets/ConfigurationFacets","../../operations/pageLoad"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getBooleanDisplayValue=function(e){return e?n.default.Yes:n.default.No};t.getFieldRenderBarrier=function(e){return r.getConfiguration(e,{enableDetailsListFieldRenderPageLoadBarrier:i.enableDetailsListFieldRenderPageLoadBarrierFacet}).enableDetailsListFieldRenderPageLoadBarrier?s.getPageLoadBarrier(e):void 0}});
define("@ms/items-view/lib/private/components/itemFileTypeIcon/ItemFileTypeIcon.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".root_65accb41{display:block}.root_65accb41>img{display:block}.root_65accb41.inset24_65accb41{padding:2px}\n"}]);t.root="root_65accb41";t.inset24="inset24_65accb41"});
define("@ms/items-view/lib/private/components/columns/fileTypeIcon/fileTypeIconColumn.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".icon_0c9cb012{display:block;overflow:visible}\n"}]);t.icon="icon_0c9cb012"});
define("@ms/items-view/lib/private/components/columns/displayName/displayNameColumn",["require","exports","../columns.resx","../../fields/nameHero/NameHeroField","../../../models/Facet","../createColumn","../../../facets/ItemFacets"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DISPLAY_NAME_COLUMN_KEY=new i.Facet("displayNameColumn").id;t.displayNameColumn=s.createColumn({key:t.DISPLAY_NAME_COLUMN_KEY,name:n.default.Name,fieldName:"",isCollapsible:!1,minWidth:s.ColumnWidth.displayNameMin,maxWidth:s.ColumnWidth.displayNameMax},r.NameHeroField)(function(e){return function(e){return{itemKey:e.key,onClick:e.isInvokable?function(){}:void 0,isDisabled:e.isDisabled}}},function(e,t){return e.demandItemFacet(o.displayNameFacet,t)||""})});
define("@ms/items-view/lib/private/components/fields/nameHero/NameHeroField",["require","exports","tslib","react","../../decorators/connectToItemCache","../../../facets/ItemFacets","../name/NameField","../signal/SignalIcon","@uifabric/experiments/lib/components/signals/SignalField","./NameHeroField.scss","office-ui-fabric-react/lib/Button","../../withAction/WithAction","../../actions/share/ShareAction","../../actions/follow/FollowAction","../../../components/commands/Commands.resx","../../../controls/mobileOpenControl","../../../controls/fabricOptimizerControl","../../fileHoverCard/getItemHoverCard","../../../utilities/components/DeferredRender","../FieldHelper","../../actions/openContextMenu/OpenContextMenuAction","../../../controls/itemHeroCommandsControl","../../commandSet/CommandSet"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x="\r",T=d.default;t.NameHeroField=i.connectToItemCache(function(e,t){var n=t.itemKey,i=e.demandItemFacet(s.displayNameFacet,n),o=u.getNewSignal(e,n),a=o?[o.signal]:void 0,f=function(e,t){var n=u.getStorageSignals(e,t),r=n.length>0,i=r?2:3,s=u.getLifeCycleSignals(e,t,i,!1),o=[],a=[];if(r){var f=n[0];o.push(f.signal);a.push(f.title||"")}for(var l=0,c=s;l<c.length;l++){var h=c[l];o.push(h.signal);a.push(h.title||"")}return{signals:o,titles:a}}(e,n),d=f.titles,y=f.signals;y&&0===y.length&&(y=void 0);var x={itemKey:n},L=e.demandItemFacet(v.mobileOpenControl,n),A=v.mobileOpenControl.evaluate(L)(e,x).mobileOpenProperty,M=e.demandItemFacet(m.fabricOptimizerControl,n),_=M&&M(e,{})||{},D=_.renderMenuHero,P=_.renderShareHero,H=_.replaceSignals,B=b.getFieldRenderBarrier(e),j=function(e,t){var n=t.itemKey,i=[{key:E.SHARE_HERO_COMMAND_KEY,iconOnly:!0,action:r.createElement(h.ItemShareAction,{itemKey:n}),ariaLabel:T.ShareCommandTooltipV3,title:T.ShareCommandTooltipV3,automationId:"FieldRender-ShareHero",iconProps:N},{key:E.FOLLOW_HERO_COMMAND_KEY,iconOnly:!0,action:r.createElement(p.ItemFollowAction,{itemKey:n}),ariaLabel:T.FollowCommandTooltip,title:T.FollowCommandTooltip,postProcess:O,automationId:"FieldRender-Followed"},{key:E.MORE_HERO_COMMAND_KEY,iconOnly:!0,action:r.createElement(w.OpenContextMenuAction,{itemKey:n}),ariaLabel:T.ShowActions,title:T.ShowActions,automationId:"FieldRender-DotDotDot",iconProps:C,subMenuProps:k}],s=e.demandItemFacet(E.itemHeroCommandsControl,n),o=E.itemHeroCommandsControl.evaluate(s)(e,{itemKey:n,commands:i,heroButtonAs:l.IconButton}),u=o.commands,a=o.heroButtonAs;return{commands:u,heroButtonAs:a}}(e,x),F=j.commands,I=j.heroButtonAs,q=c.evaluateAction(e,r.createElement(S.CommandSet,{commands:F}));return{beforeSignals:H?H(a):a,afterSignals:H?H(y):y,signalTitles:d,linkText:i,hoverCard:g.getItemHoverCard(e,x),mobileOpenProperty:A,heroCommandSet:q,heroButtonAs:I,pageLoadBarrier:B,renderMenuHero:D,renderShareHero:P}})(function(e){var t=e.itemKey,i=e.beforeSignals,s=e.afterSignals,u=e.signalTitles,c=e.hoverCard,h=e.heroCommandSet,p=e.pageLoadBarrier,d=e.linkText,v=e.onClick,m=e.heroButtonAs,g=u&&d+(d?x:"")+u.join(x)||"",b=r.createElement("div",{className:""+f.fieldRendererRendererWithCommands},r.createElement("div",{className:""+f.nameFieldWidthOnHover},r.createElement(a.SignalField,{signalsFieldMode:"wide",before:i?r.createElement(y.DeferredRender,{barrier:p},i):null,after:s?r.createElement(y.DeferredRender,{barrier:p},r.createElement("span",{className:""+f.signalsShowHide},s)):null},r.createElement(y.DeferredRender,{barrier:p},function(t){var n=t.hasResolved;return r.createElement(o.NameField,{ariaDescription:c?T.FileHoverCardShortcutHint:void 0,isDisabled:e.isDisabled,linkText:d,onClick:n?v:void 0,mobileOpenProperty:e.mobileOpenProperty,title:g,disableTooltip:!!c})})),e.children||null),r.createElement("div",{className:""+f.fieldRendererHeroCommandContainer},r.createElement(y.DeferredRender,{barrier:e.pageLoadBarrier},h?r.cloneElement(h,void 0,function(e){var t=e.menuItems;return r.createElement(r.Fragment,null,t.map(function(e){return r.createElement(m,n.__assign({key:e.key},e,{buttonType:l.ButtonType.hero,className:f.heroButton,"aria-expanded":!e.subMenuProps&&void 0,"aria-haspopup":e.subMenuProps?"menu":void 0}))}))}):null)));return c?r.createElement(c,{itemKey:t},b):b});var N={iconName:"Share"},C={iconName:"MoreVertical"},k={items:[]};var L={iconName:"SingleBookmark"},A={iconName:"SingleBookmarkSolid"};function O(e){return n.__assign({},e,{iconProps:e.actionState&&e.actionState.isToggled?A:L})}});
define("@ms/items-view/lib/private/components/fields/name/NameField",["require","exports","tslib","react","office-ui-fabric-react/lib/Link","@uifabric/utilities/lib/css","@uifabric/utilities/lib/object","./NameField.scss","../baseText/BaseTextField","../../../utilities/components/Fragment"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NameField=function(e){var t,h=e.linkUrl,p=e.linkText,d=e.onClick,v=e.isDisabled,m=e.ariaDescription,g=e.ariaLabel,y=e.disableTooltip,b=e.title,w=e.mobileOpenProperty,E=e.linkAs||i.Link;m&&(t=o.getId("description"));g=g||p;return v||!h&&!d?r.createElement(a.BaseText,{"data-automationid":"FieldRenderer-name",className:s.css(u.nameField),isDisabled:v,text:p||"",ariaLabel:g,title:b}):r.createElement(f.Fragment,null,r.createElement(E,n.__assign({"aria-describedby":t,"data-automationid":"FieldRenderer-name","data-selection-invoke":!0,className:s.css(u.nameField,u.clickable),getStyles:l,href:h,onDragStart:c,onClick:d,title:y?void 0:b||p},w),p||""),m?r.createElement("span",{id:t,className:u.ariaDescription},m):null)};function l(e){return{root:{userSelect:"none"}}}function c(e){e.preventDefault()}});
define("@ms/items-view/lib/private/components/fields/name/NameField.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".ariaDescription_f59ebb65{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.ms-DetailsRow-cell .nameField_f59ebb65{font-size:14px;display:inline;max-width:100%;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.ms-DetailsRow-cell .ms-Link.nameField_f59ebb65{font-size:14px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.ms-DetailsRow-cell .ms-Link.nameField_f59ebb65.clickable_f59ebb65:hover{text-decoration:underline;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.ms-DetailsRow-cell .ms-Link.nameField_f59ebb65:visited,.ms-DetailsRow-cell .ms-Link.nameField_f59ebb65:focus{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}@media screen and (-ms-high-contrast: active){.ms-DetailsRow.is-selected .ms-DetailsRow-cell .ms-Link.nameField_f59ebb65{color:HighlightText}}@media screen and (-ms-high-contrast: black-on-white){.ms-DetailsRow.is-selected .ms-DetailsRow-cell .ms-Link.nameField_f59ebb65{color:HighlightText}}.isFluent .ms-DetailsRow.is-selected .ms-DetailsRow-cell .ms-Link.nameField_f59ebb65{font-weight:600}.isFluent .ms-DetailsRow:hover .ms-DetailsRow-cell .ms-Link.nameField_f59ebb65,.isFluent .ms-DetailsRow.is-selected .ms-DetailsRow-cell .ms-Link.nameField_f59ebb65{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}\n"}]);t.ariaDescription="ariaDescription_f59ebb65";t.nameField="nameField_f59ebb65";t.clickable="clickable_f59ebb65"});
define("@ms/items-view/lib/private/components/fields/baseText/BaseTextField",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","../Field.scss"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BaseText=function(e){var t,o=e.text,u=e.isDisabled,a=e.noTextRender,f=e.ariaLabel,l=e.title,c=e.children,h=n.__rest(e,["text","isDisabled","noTextRender","ariaLabel","title","children"]);return c||!a&&o?r.createElement("div",n.__assign({},h,{"aria-label":a?f||o:void 0,title:l,dir:"auto",className:i.css(e.className,(t={},t[""+s.disabledField]=u,t))}),!a&&o,c):null}});
define("@ms/items-view/lib/private/components/fields/Field.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".field_c4544792{text-decoration:none;text-overflow:ellipsis;overflow:hidden}.display_c4544792{cursor:pointer;white-space:nowrap}.nofill_c4544792{position:relative;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.disabledField_c4544792{opacity:0.4}\n"}]);t.field="field_c4544792";t.display="display_c4544792";t.nofill="nofill_c4544792";t.disabledField="disabledField_c4544792"});
define("@ms/items-view/lib/private/components/fields/signal/SignalIcon",["require","exports","react","../../../facets/ItemFacets","../../../facets/ItemAnalyticsFacets","../../../facets/ConfigurationFacets","@uifabric/experiments/lib/components/signals/Signals","@ms/utilities-strings/lib/index","../FieldStrings.resx","../../../controls/itemLifeCycleSignalsControl","../../../models/Facet","../../../facets/computed/isReadOnlyFacet","../../../models/configuration/getConfiguration"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=[y,x,w,C,L,O,D,H,E,_,j,R],d=[I],v=[];t.newSignalKey=new l.Facet("newSignal").id;t.youCheckedOutSignalKey=new l.Facet("youCheckedOutSignal").id;t.someoneCheckedOutSignalKey=new l.Facet("someoneCheckedOutSignal").id;t.malwareSignalKey=new l.Facet("malwareSignal").id;t.needsPublishingSignalKey=new l.Facet("needsPublishingSignal").id;t.dlpBlockedSignalKey=new l.Facet("dlpBlockedSignal").id;t.missingMetadataSignalKey=new l.Facet("missingMetadataSignal").id;t.dlpWarningSignalKey=new l.Facet("dlpWarningSignal").id;t.retentionRecordSignalKey=new l.Facet("retentionRecordSignal").id;t.followedSignalKey=new l.Facet("followedSignal").id;t.trendingSignalKey=new l.Facet("trendingSignal").id;t.readOnlySignalKey=new l.Facet("readOnlySignal").id;t.sharedSignalKey=new l.Facet("sharedSignal").id;t.getStorageSignals=function(e,t){return m(e,{itemKey:t,control:f.itemStorageSignalsControl,signalHandlers:v,maxCount:1})};t.getSocialSignals=function(e,t){return m(e,{itemKey:t,control:f.itemSocialSignalsControl,signalHandlers:d,maxCount:1})};t.getLifeCycleSignals=function(e,t,n,r){return m(e,{itemKey:t,control:f.itemLifeCycleSignalsControl,signalHandlers:p,maxCount:n,offset:r?0:1})};function m(e,t){for(var n=t.itemKey,r=t.control,i=t.signalHandlers,s=t.maxCount,o=[],u=t.offset||0;o.length<s&&u<i.length;){var a=(0,i[u])(e,n);a&&o.push(a);u++}var f=e.demandItemFacet(r,n),l=r.evaluate(f)(e,{itemKey:n,signals:o}).signals;return void 0===l?[]:l}var g={signal:n.createElement(o.NewSignal,{key:t.newSignalKey,ariaLabel:a.default.itemSignalNew,title:a.default.itemSignalNewTooltip}),title:a.default.itemSignalNewTooltip,key:t.newSignalKey};function y(e,t){return e.demandItemFacet(r.isNewFacet,t)?g:null}t.getNewSignal=y;var b={signal:n.createElement(o.YouCheckedOutSignal,{key:t.youCheckedOutSignalKey,ariaLabel:a.default.itemSignalYouCheckedOut,title:a.default.itemSignalYouCheckedOutTooltip}),title:a.default.itemSignalYouCheckedOutTooltip,key:t.youCheckedOutSignalKey};function w(e,t){var n=e.demandItemFacet(r.isCheckedOutFacet,t);return n&&n.byYou?b:null}t.getYouCheckedOutSignal=w;function E(e,i){var s=e.demandItemFacet(r.isCheckedOutFacet,i),f=s&&s.byOther;if(f){var l=e.demandItemFacet(r.displayNameFacet,f),c=l?u.format(a.default.itemSignalSomeoneCheckedOutTooltip,l):a.default.itemSignalSomeoneCheckedOut;return{signal:n.createElement(o.SomeoneCheckedOutSignal,{key:t.someoneCheckedOutSignalKey,ariaLabel:a.default.itemSignalSomeoneCheckedOut,title:c}),title:c,key:t.someoneCheckedOutSignalKey}}return null}t.getSomeoneCheckedOutSignal=E;var S={signal:n.createElement(o.MalwareDetectedSignal,{key:t.malwareSignalKey,ariaLabel:a.default.itemSignalMalwareDetected,title:a.default.itemSignalMalwareDetectedTooltip}),title:a.default.itemSignalMalwareDetectedTooltip,key:t.malwareSignalKey};function x(e,t){return e.demandItemFacet(r.malwareDetectedFacet,t)?S:null}t.getMalwareSignal=x;var T={signal:n.createElement(o.NeedsRepublishingSignal,{key:t.needsPublishingSignalKey,ariaLabel:a.default.itemSignalNeedsPublishing,title:a.default.itemSignalNeedsPublishingTooltip}),title:a.default.itemSignalNeedsPublishingTooltip,key:t.needsPublishingSignalKey};t.getNeedPublishingSignal=function(e,t){return e.demandItemFacet(r.needsPublishingFacet,t)?T:null};var N={signal:n.createElement(o.BlockedSignal,{key:t.dlpBlockedSignalKey,ariaLabel:a.default.itemSignalBlocked,title:a.default.itemSignalBlockedTooltip}),title:a.default.itemSignalBlockedTooltip,key:t.dlpBlockedSignalKey};function C(e,t){var n=e.demandItemFacet(r.policyTipFacet,t);return!n||2!==n&&3!==n?null:N}t.getDlpBlockedSignal=C;var k={signal:n.createElement(o.MissingMetadataSignal,{key:t.missingMetadataSignalKey,ariaLabel:a.default.itemSignalMissingMetadata,title:a.default.itemSignalMissingMetadataTooltip}),title:a.default.itemSignalMissingMetadataTooltip,key:t.missingMetadataSignalKey};function L(e,t){return e.demandItemFacet(r.missingMetadataFacet,t)?k:null}t.getMissingMetadataSignal=L;var A={signal:n.createElement(o.WarningSignal,{key:t.dlpWarningSignalKey,ariaLabel:a.default.itemSignalWarning,title:a.default.itemSignalWarningTooltip}),title:a.default.itemSignalWarningTooltip,key:t.dlpWarningSignalKey};function O(e,t){var n=e.demandItemFacet(r.policyTipFacet,t);return n&&1===n?A:null}t.getDlpWarningSignal=O;var M={signal:n.createElement(o.RecordSignal,{key:t.retentionRecordSignalKey,ariaLabel:a.default.itemSignalIsRecord,title:a.default.itemSignalIsRecordTooltip}),title:a.default.itemSignalIsRecordTooltip,key:t.retentionRecordSignalKey};function _(e,t){return e.demandItemFacet(r.showRetentionPolicyIconFacet,t)?M:null}t.getRetentionRecordSignal=_;function D(e,t){return null}t.getAwaitingApprovalSignal=D;var P={signal:n.createElement(o.TrendingSignal,{key:t.trendingSignalKey,ariaLabel:a.default.itemSignalTrending,title:a.default.itemSignalIsTrendingTooltip}),title:a.default.itemSignalIsTrendingTooltip,key:t.trendingSignalKey};function H(e,t){if(!h.getConfiguration(e,{isTrendingEnabled:s.enableTrendingConfigurationFacet}).isTrendingEnabled)return null;var n=e.demandItemFacet(r.analyticsItemFacet,t),o=n&&n.itemKey;return o&&e.demandItemFacet(i.isTrendingFacet,o)?P:null}t.getTrendingSignal=H;var B={signal:n.createElement(o.FollowedSignal,{key:t.followedSignalKey,ariaLabel:a.default.itemSignalIsFollowed,title:a.default.itemSignalIsFollowed}),title:a.default.itemSignalIsFollowed,key:t.followedSignalKey};function j(e,t){var n=e.demandItemFacet(r.followedItemFacet,t);return e.demandItemFacet(r.isFollowedFacet,n&&n.itemKey)?B:null}t.getFollowedSignal=j;var F={signal:n.createElement(o.SharedSignal,{key:t.sharedSignalKey,ariaLabel:a.default.sharedColumnSharedFieldText}),key:t.sharedSignalKey};function I(e,t){return e.demandItemFacet(r.isSharedFacet,t)?F:null}t.getSharedSignal=I;var q={signal:n.createElement(o.ReadOnlySignal,{key:t.readOnlySignalKey,ariaLabel:a.default.itemSignalReadOnly,title:a.default.itemSignalReadOnly}),key:t.readOnlySignalKey};function R(e,t){return h.getConfiguration(e,{isReadOnlyEnabled:s.enableReadOnlyConfigurationFacet}).isReadOnlyEnabled&&e.demandItemFacet(c.isReadOnlyFacet,t)?q:null}t.getReadOnlySignal=R});
define("@ms/items-view/lib/private/facets/ItemAnalyticsFacets",["require","exports","../models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isTrendingFacet=new n.Facet("isTrending");t.viewCountFacet=new n.Facet("viewCount");t.viewerCountFacet=new n.Facet("viewerCount");t.likeCountFacet=new n.Facet("likeCount");t.commentCountFacet=new n.Facet("commentCount");t.activitiesFacet=new n.Facet("activities");t.keyPointsFacet=new n.Facet("keyPoints");t.lifeCycleStatusFacet=new n.Facet("lifeCycleStatus");t.incompleteDataFacet=new n.Facet("incompleteData");t.recommendedActionsFacet=new n.Facet("recommendedActions");t.recommendedPeopleFacet=new n.Facet("recommendedPeople");t.conversationsFacet=new n.Facet("conversations")});
define("@ms/items-view/lib/private/controls/itemLifeCycleSignalsControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemLifeCycleSignalsControl=new n.ControlFacet("itemLifeCycleSignalsControl");t.itemSocialSignalsControl=new n.ControlFacet("itemSocialSignalsControl");t.itemStorageSignalsControl=new n.ControlFacet("itemStorageSignalsControl")});
define("@ms/items-view/lib/private/facets/computed/isReadOnlyFacet",["require","exports","../../models/itemCache/ComputedItemFacet","../../controls/itemIsReadOnlyControl"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isReadOnlyFacet=new n.ComputedItemFacet("isReadOnly",function(e,t){var n=t.itemKey,i=e.demandItemFacet(r.itemIsReadOnlyControl,n);return r.itemIsReadOnlyControl.evaluate(i)(e,{itemKey:n}).isReadOnly})});
define("@ms/items-view/lib/private/controls/itemIsReadOnlyControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemIsReadOnlyControl=new n.ControlFacet("itemIsReadOnlyControl")});
define("@ms/items-view/lib/private/components/fields/nameHero/NameHeroField.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".heroButton_5bebb74f{display:block;position:relative;left:0;top:0;width:1px;height:100%;text-align:center;outline:none;border:none;background-color:transparent;margin:0;padding:0;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";font-size:14px;opacity:0;border-radius:0;cursor:pointer}.heroButton_5bebb74f:hover{width:36px;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.heroButton_5bebb74f i{opacity:0}html[dir='ltr'] .heroButton_5bebb74f i{right:10px}html[dir='rtl'] .heroButton_5bebb74f i{left:10px}.ms-DetailsRow-cell--VerticallyCenter .heroButton_5bebb74f i{position:relative;top:1px}html[dir='ltr'] .ms-DetailsRow-cell--VerticallyCenter .heroButton_5bebb74f i{right:0}html[dir='rtl'] .ms-DetailsRow-cell--VerticallyCenter .heroButton_5bebb74f i{left:0}@media screen and (-ms-high-contrast: active){.ms-DetailsRow:hover .heroButton_5bebb74f{color:ButtonText}}@media screen and (-ms-high-contrast: active){.is-selected .heroButton_5bebb74f,.is-selected:hover .heroButton_5bebb74f{color:HighlightText}}.is-selected .heroButton_5bebb74f,.ms-DetailsRow:hover .heroButton_5bebb74f{opacity:1;width:36px}.is-selected .heroButton_5bebb74f i,.ms-DetailsRow:hover .heroButton_5bebb74f i{opacity:1}.is-selected .heroButton_5bebb74f .signalsShowHide_5bebb74f,.ms-DetailsRow:hover .heroButton_5bebb74f .signalsShowHide_5bebb74f{visibility:hidden}.ms-DetailsRow-cell .ms-DetailsRow-cell--DotDotDot{padding:0;overflow:visible}.fieldRendererHeroCommandContainer_5bebb74f{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-negative:0;flex-shrink:0;margin-top:-11px;margin-bottom:-11px;padding-top:1px;padding-bottom:1px;white-space:nowrap}.fieldRendererRendererWithMetadata_5bebb74f{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;min-width:0;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;overflow:hidden}.ms-DetailsRow .fieldRendererRendererWithCommands_5bebb74f,.ms-DetailsRow-cell .fieldRendererRendererWithCommands_5bebb74f{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;max-width:100%}.ms-DetailsRow .nameFieldWidthOnHover_5bebb74f,.ms-DetailsRow-cell .nameFieldWidthOnHover_5bebb74f{width:100%}.ms-DetailsRow.is-selected .signalsShowHide_5bebb74f,.ms-DetailsRow:hover .signalsShowHide_5bebb74f,.ms-DetailsRow-cell.is-selected .signalsShowHide_5bebb74f,.ms-DetailsRow-cell:hover .signalsShowHide_5bebb74f{visibility:hidden}.ms-DetailsRow.is-selected .nameFieldWidthOnHover_5bebb74f,.ms-DetailsRow:hover .nameFieldWidthOnHover_5bebb74f,.ms-DetailsRow-cell.is-selected .nameFieldWidthOnHover_5bebb74f,.ms-DetailsRow-cell:hover .nameFieldWidthOnHover_5bebb74f{min-width:0}.ms-DetailsRow.is-selected .heroButton_5bebb74f,.ms-DetailsRow:hover .heroButton_5bebb74f,.ms-DetailsRow-cell.is-selected .heroButton_5bebb74f,.ms-DetailsRow-cell:hover .heroButton_5bebb74f{width:36px}\n"}]);t.heroButton="heroButton_5bebb74f";t.signalsShowHide="signalsShowHide_5bebb74f";t.fieldRendererHeroCommandContainer="fieldRendererHeroCommandContainer_5bebb74f";t.fieldRendererRendererWithMetadata="fieldRendererRendererWithMetadata_5bebb74f";t.fieldRendererRendererWithCommands="fieldRendererRendererWithCommands_5bebb74f";t.nameFieldWidthOnHover="nameFieldWidthOnHover_5bebb74f"});
define("@ms/items-view/lib/private/components/actions/share/ShareAction",["require","exports","../../sharingCallout/SharingCallout","../../base/actions/share/ShareAction","../../decorators/connectToItemCache"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(){return{sharingWizard:n.SharingCallout}}t.ItemAddPeopleAction=i.connectToItemCache(s)(r.ItemAddPeopleAction);t.ItemCopyLinkAction=i.connectToItemCache(s)(r.ItemCopyLinkAction);t.ItemShareAction=i.connectToItemCache(s)(r.ItemShareAction);t.CopyLinkAction=i.connectToItemCache(s)(r.CopyLinkAction);t.ShareAction=i.connectToItemCache(s)(r.ShareAction);t.AddPeopleAction=i.connectToItemCache(s)(r.AddPeopleAction)});
define("@ms/items-view/lib/private/components/sharingCallout/SharingCallout",["require","exports","tslib","react","office-ui-fabric-react/lib/Callout","office-ui-fabric-react/lib/Spinner","../../utilities/components/Props","../../utilities/async/CancelError","./SharingCallout.scss","../decorators/connectToItemCache","../../facets/ItemFacets","office-ui-fabric-react/lib/Utilities","../withAction/WithAction","../../controls/sharingCalloutControl","../../facets/ConfigurationFacets","@uifabric/utilities/lib/dom/findElementRecursive","./ShareDialog.resx","../actions/manageAccess/ManageAccessAction","@ms/utilities-browser/lib/PlatformDetection"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=2,w="&mode=copy",E=7,S="&mode=addPeople",x={sharingInformation:void 0,isSharingDialogLoaded:!1,didSharingHappen:!1,iframeSource:"#",isOpen:!0,iframeHeight:0,error:void 0},T=function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._listenForMessages=function(e){var t;try{t=JSON.parse(e.data)}catch(e){return}var n=t.name;if("share_resize"===n&&t.height)i.setState({iframeHeight:t.height});else if("share_ready"===n)i.setState({isSharingDialogLoaded:!0});else if("share_error"===n)t.error?i.setState({error:t.error}):i.setState({error:{name:"ShareError",message:m.default.sharedialogErrorMessage}});else if("share_completed"===n)i.setState({didSharingHappen:!0});else if("share_dismiss"===n)i._onClose();else if("share_manageAccessClicked"===n){var r=i.props.openManageAccess;if(r){r();i._onClose()}}};i._onClose=function(){var e=i.state.error;i.state.didSharingHappen?i.props.resolve():e?i.props.reject(e):i.props.reject(new u.CancelError);i.setState({isOpen:!1,error:void 0})};i._getSharingInformation=function(){return n.__awaiter(i,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,this.props.getSharingInformation()];case 1:e=n.sent();this.setState({sharingInformation:e});return[3,3];case 2:t=n.sent();this.props.reject(t);return[3,3];case 3:return[2]}})})};i._update=function(e){var t=i.state.sharingInformation;if(t&&!e.sharingInformation){var n=t.authToken,r=t.webAbsoluteUrl,s=t.serverRelativeItemUrl,o=t.listUrl,u=t.cookieAuthIframeUrl,a=i.props,f=a.initializeShareFrame,l=a.defaultRecipients,c=a.openManageAccess,h=void 0;switch(i.props.mode){case b:h=w;break;case E:h=S;break;default:h=""}if(n&&r&&s&&o&&f){var p=i.props;f({parentElement:i._sharePrefetchRef.current,sharingInformation:t,calloutProps:p,onError:function(e){i.setState({error:e})}})}else u?i.setState({iframeSource:""+u+h+(l&&l.length>0?"&defaultRecipients="+encodeURI(l.join(",")):"")+"&ma="+(c?1:0)}):i.props.reject(new Error("Missing sharing information"))}};i.state=x;i._sharePrefetchRef=r.createRef();return i}t.prototype.UNSAFE_componentWillMount=function(){this._getSharingInformation()};t.prototype.componentDidMount=function(){window.addEventListener("message",this._listenForMessages,!1);this._update(x)};t.prototype.componentWillUnmount=function(){window.removeEventListener("message",this._listenForMessages,!1)};t.prototype.componentDidUpdate=function(e,t){this._update(t)};t.prototype.render=function(){var e=this.state,t=e.isSharingDialogLoaded,n=e.iframeSource,o=e.isOpen,u=e.iframeHeight,f=e.error,l=f,c=l&&l.resultCode&&l.resultCode.indexOf("ShareDomainNotReachable")>=0?r.createElement("div",{className:""+a.errorContainer},r.createElement("span",null,m.default.sharedialogErrorMessage),r.createElement("span",{className:""+a.errorCode},"(",l.resultCode,")")):null,h="#"===n?null:r.createElement("iframe",{id:"shareFrame",name:"shareFrame",src:n,style:{visibility:t?"visible":"hidden",width:t?"100%":"0",height:u+"px"}}),p=this.props.mode===b?150:402,d=u||p,v=t?"flex-start":"center",g=(new y.PlatformDetection).isIE;return o?r.createElement(i.Callout,{onDismiss:this._onClose,target:this.props.calloutTarget,preventDismissOnScroll:!0,preventDismissOnLostFocus:g,isBeakVisible:!1,hideOverflow:!0},r.createElement("div",{className:""+a.sharingContents,ref:this._sharePrefetchRef,style:{minHeight:d+"px",alignItems:v}},!t&&!f&&r.createElement(s.Spinner,{size:s.SpinnerSize.large}),c,h)):null};return t}(r.PureComponent);t.StyledSharingCalloutInner=c.styled(T,function(e){return{}});var N=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.sharingCallout,i=n.__rest(e,["sharingCallout"]);return r.createElement(h.WithAction,{action:r.createElement(g.ItemManageAccessAction,{itemKey:i.itemKey})},function(e){var s=e.isAvailable,o=e.execute,u=s?function(){o({})}:void 0;return r.createElement(t,n.__assign({openManageAccess:u},i))})};return t}(r.PureComponent),C=o.injectInitialProps(function(e){var t,n=e.onExecuteProps,r=n&&n.event,i=r?r.target:void 0,s=function(e){return'.ms-Button--commandBar[data-automationId="'+e+'"]'},o=document.querySelectorAll(s("shareCommand")),u=document.querySelectorAll(s("copyLinkCommand")),a=document.querySelectorAll(s("addPeopleCommand")),f=o[0],l=u[0],c=a[0];2===o.length&&(f=o[1]);2===u.length&&(l=u[1]);2===a.length&&(c=a[1]);switch(e.mode){case 1:t=f;break;case 2:t=l;break;case 7:t=c}t||(t=i&&v.findElementRecursive(i,function(e){return"BUTTON"===e.tagName}));return{calloutTarget:t||i}})(N);t.SharingCallout=f.connectToItemCache(function(e,n){var r=n.itemKey,i=e.demandItem({displayName:l.displayNameFacet},r).displayName,s=e.demandItemFacet(d.localeFacet,d.configurationItemKey),o=e.demandItemFacet(p.sharingCalloutControl,r),u=p.sharingCalloutControl.evaluate(o)(e,{itemKey:r}).initializeShareFrame;return{itemName:i||"",locale:s&&s.language||"en-US",sharingCallout:t.StyledSharingCalloutInner,initializeShareFrame:u}})(C)});
define("@ms/items-view/lib/private/components/sharingCallout/SharingCallout.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".sharingContents_2187ac2e{display:-webkit-box;display:-ms-flexbox;display:flex;min-height:150px;min-width:320px;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.sharingContents_2187ac2e iframe{border:none;width:0}.errorContainer_2187ac2e{padding:20px;max-width:280px;font-size:14px}.errorCode_2187ac2e{margin-top:30px;font-size:12px;color:#666;display:block}\n"}]);t.sharingContents="sharingContents_2187ac2e";t.errorContainer="errorContainer_2187ac2e";t.errorCode="errorCode_2187ac2e"});
define("@ms/items-view/lib/private/controls/sharingCalloutControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharingCalloutControl=new n.ControlFacet("sharingCallout")});
define("@ms/items-view/lib/private/components/base/actions/share/ShareAction",["require","exports","tslib","react","../../../decorators/withWizard","../../../decorators/connectToItemCache","../../../decorators/selectors","../../../../controls/shareActionControl","../../../../controls/copyLinkActionControl","../../../../operations/getSharingClientId","../../../../facets/ItemFacets","../../../../models/telemetry/getItemEngagement"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";var h=this;Object.defineProperty(t,"__esModule",{value:!0});var p=s.connectToItemCache(function(e,t){var r=e.dispatch;return{getSharingInformation:function(){return n.__awaiter(h,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,r(t.getSharingInformation())];case 1:return[2,e.sent()]}})})},getClientId:function(){return r(f.getSharingClientId())}}})(i.withWizard(void 0,{isBackgroundTask:!0})(function(e){var t=e.sharingWizard,i=n.__rest(e,["sharingWizard"]);return r.createElement(t,n.__assign({},i))})),d=function(){return function(){return Promise.reject(new Error("Cannot share."))}};function v(e,t){var n=t.itemKey,r=e.demandItemFacet(u.shareActionControl,n),i=u.shareActionControl.evaluate(r)(e,{itemKey:n,getSharingInformation:d,defaultRecipients:[],customLabeledAudienceConfig:void 0,isAvailable:!1});return{isAvailable:i.isAvailable,getSharingInformation:i.getSharingInformation,defaultRecipients:i.defaultRecipients,customLabeledAudienceConfig:i.customLabeledAudienceConfig}}t.ItemShareAction=s.connectToItemCache(function(e,t){var r=v(e,t),i=e.demandItemFacet(l.malwareDetectedFacet,t.itemKey);return n.__assign({},r,{isAvailable:!i&&r.isAvailable},c.getItemActionEngagement(e,{itemKey:t.itemKey,engagement:{name:"Share",isIntentional:!0}}),{mode:1})})(p);t.ItemCopyLinkAction=s.connectToItemCache(function(e,t){var r=t.itemKey,i=v(e,{itemKey:t.itemKey}),s=e.demandItemFacet(l.malwareDetectedFacet,t.itemKey),o=e.demandItemFacet(a.copyLinkActionControl,r),u=a.copyLinkActionControl.evaluate(o)(e,{itemKey:r,isAvailable:!s&&i.isAvailable}).isAvailable;return n.__assign({},i,{isAvailable:u},c.getItemActionEngagement(e,{itemKey:r,engagement:{name:"CopyLink",isIntentional:!0}}),{mode:2})})(p);t.ItemAddPeopleAction=s.connectToItemCache(function(e,t){var r=v(e,t),i=e.demandItemFacet(l.malwareDetectedFacet,t.itemKey);return n.__assign({},r,{isAvailable:!i&&r.isAvailable},c.getItemActionEngagement(e,{itemKey:t.itemKey,engagement:{name:"AddPeople",isIntentional:!0}}),{mode:7})})(p);t.ShareAction=o.withSelectedItems()(o.withCurrentItemAsFallback()(o.withExactlyOneItem()(t.ItemShareAction)));t.CopyLinkAction=o.withSelectedItems()(o.withCurrentItemAsFallback()(o.withExactlyOneItem()(t.ItemCopyLinkAction)));t.AddPeopleAction=o.withSelectedItems()(o.withCurrentItemAsFallback()(o.withExactlyOneItem()(t.ItemAddPeopleAction)))});
define("@ms/items-view/lib/private/components/decorators/withWizard",["require","exports","tslib","react","../action/Action","./connectToItemCache","../withAction/WithAction"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.withWizard=function(e,t){void 0===t&&(t={});return function(u){var a=t.isBackgroundTask,f=t.backgroundTaskScope,l=void 0===f?a?"global":"local":f,c=u;return s.connectToItemCache(function(t,i){var s=i,u=(s.isAvailable,s.isToggled,s.engagement,n.__rest(s,["isAvailable","isToggled","engagement"]));return{onExecute:o.renderComponentOnExecute(function(t){var i=e?e(t,u):t;return r.createElement(c,n.__assign({},u,i))},{scope:l})}})(i.Action)}}});
define("@ms/items-view/lib/private/controls/shareActionControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.shareActionControl=new n.ControlFacet("shareActionControl")});
define("@ms/items-view/lib/private/controls/copyLinkActionControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.copyLinkActionControl=new n.ControlFacet("copyLinkActionControl")});
define("@ms/items-view/lib/private/operations/getSharingClientId",["require","exports","../facets/LoggerFacets","./configuration/readConfiguration"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getSharingClientId=function(){return function(e){var t=e(r.readConfiguration({logger:n.loggerFacet})).logger;return t&&t.sharingClientId?n.ClientId[t.sharingClientId]:n.ClientId[n.ClientId.unknown]}}});
define("@ms/items-view/lib/private/components/actions/follow/FollowAction",["require","exports","tslib","../../decorators/connectToItemCache","../../action/Action","../../decorators/selectors","../../../operations/followItem","../../../facets/ItemFacets","../../../facets/ConfigurationFacets","../../../models/telemetry/getItemEngagement","../../../controls/followItemActionControl","../../../facets/DocumentFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";var h=this;Object.defineProperty(t,"__esModule",{value:!0});t.ItemFollowAction=r.connectToItemCache(function(t,r){var i=r.itemKey,s=t.dispatch;if(!t.demandItemFacet(a.enableFollowItemConfigurationFacet,a.configurationItemKey))return{isAvailable:!1};var p=t.demandItemFacet(u.followedItemFacet,i),d=p&&p.itemKey||"",v=t.demandItemFacet(u.isFollowedFacet,d),m=t.isItemFacetResolved(u.isFollowedFacet,d),g=t.demandItemFacet(c.oneNoteFacet,i),y=t.demandItemFacet(l.followItemActionControl,i),b=!!p&&m&&!g;return n.__assign({isAvailable:b,isToggled:!!v,onExecute:function(){return n.__awaiter(h,void 0,void 0,function(){var t,r,u;return n.__generator(this,function(n){switch(n.label){case 0:return[4,s(o.followItem({items:(t={},t[d]={isFollowed:!v},t)}))];case 1:n.sent();return[4,new Promise(function(t,n){e(["../../../operations/DeferredOperations"],t,n)})];case 2:r=n.sent().demandItems;return[4,s(r(function(e){return l.followItemActionControl.evaluate(y)(e,{itemKey:i})}))];case 3:u=n.sent().onFollow;!v&&u&&s(u());return[2]}})})}},f.getItemActionEngagement(t,{itemKey:i,engagement:{name:v?"Unfollow":"Follow",isIntentional:!0}}))})(i.Action);t.FollowAction=s.withSelectedItems()(s.withExactlyOneItem()(t.ItemFollowAction))});
define("@ms/items-view/lib/private/operations/followItem",["require","exports","../models/Facet","../store/actions/implementOperation"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.followItemOperation=new n.Facet("followed");t.followItem=r.implementOperation({operationTypeFacet:t.followItemOperation})});
define("@ms/items-view/lib/private/controls/followItemActionControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.followItemActionControl=new n.ControlFacet("followItemActionControl")});
define("@ms/items-view/lib/private/controls/mobileOpenControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.mobileOpenControl=new n.ControlFacet("mobileOpenControl")});
define("@ms/items-view/lib/private/controls/fabricOptimizerControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fabricOptimizerControl=new n.ControlFacet("fabricOptimizer")});
define("@ms/items-view/lib/private/components/fileHoverCard/getItemHoverCard",["require","exports","tslib","react","../../controls/itemHoverCardControl","../../facets/ItemFacets","../../facets/DocumentFacets","../../facets/ConfigurationFacets"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(r.Fragment,null,this.props.children)};return t}(r.PureComponent);t.getItemHoverCard=function(e,t){var n=t.itemKey,r=e.demandItemFacet(i.itemHoverCardControl,n),s=i.itemHoverCardControl.evaluate(r)(e,{itemKey:n,hoverCard:a,isAvailable:f(e,{itemKey:n})}),o=s.hoverCard;return s.isAvailable&&o?o:void 0};function f(e,t){var n=e.demandItem({fileName:s.fileNameFacet,folder:s.folderFacet,analyticsKey:s.analyticsItemFacet,oneNote:o.oneNoteFacet},t.itemKey),r=n.fileName,i=n.folder,a=n.analyticsKey,f=n.oneNote,l=e.demandItemFacet(u.enableFileHoverCardConfigurationFacet,u.configurationItemKey),c=a&&a.itemKey,h=r&&r.extension;return!(!(l&&h&&c)||i||f)}});
define("@ms/items-view/lib/private/controls/itemHoverCardControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemHoverCardControl=new n.ControlFacet("itemHoverCardControl")});
define("@ms/items-view/lib/private/components/actions/openContextMenu/OpenContextMenuAction",["require","exports","tslib","../../decorators/connectToItemCache","../../action/Action","../../../models/telemetry/getItemEngagement","@uifabric/utilities/lib/dom/findElementRecursive","@uifabric/utilities/lib/focus"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenContextMenuAction=r.connectToItemCache(function(e,t){return n.__assign({onExecute:function(e){return n.__awaiter(this,void 0,void 0,function(){var t,r,i,s;return n.__generator(this,function(n){t=e.event;r=t&&t.target;if(t&&r){i=o.findElementRecursive(r,function(e){return u.isElementTabbable(e)})||r;(s=document.createEvent("CustomEvent")).initCustomEvent("contextmenu",!0,!0,t);i.dispatchEvent(s);i.setAttribute("aria-expanded","true")}return[2]})})}},s.getItemActionEngagement(e,{itemKey:t.itemKey,engagement:{name:"ShowActions"}}))})(i.Action)});
define("@ms/items-view/lib/private/controls/itemHeroCommandsControl",["require","exports","../models/controls/ControlFacet","../models/Facet","../components/controls/defaultRenderComponentControlOption"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MORE_HERO_COMMAND_KEY=r.getNextId("moreHeroCommand");t.SHARE_HERO_COMMAND_KEY=r.getNextId("shareHeroCommand");t.FOLLOW_HERO_COMMAND_KEY=r.getNextId("followHeroCommand");t.itemHeroCommandsControl=new n.ControlFacet("itemHeroCommands",{heroButtonAs:i.defaultRenderComponentOption()})});
define("@ms/items-view/lib/private/components/commandSet/CommandSet",["require","exports","tslib","react","office-ui-fabric-react/lib/ContextualMenu","../../utilities/objects","../withAction/WithAction","../../utilities/components/RenderProps","../../utilities/performance","../../facets/LoggerFacets","../../operations/readItem","../telemetry/TelemetryProvider","@ms/telemetry-manager/lib/events/Engagement.event","../decorators/connectToItemCache"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=[];t.CommandSet=p.connectToItemCache(function(e,t){var r=t.commands,i=void 0===r?d:r,u=t.children,p=t.onMenuItemsChanged,v=e.dispatch,m=c.getTelemetry(e).telemetry;return{actions:function e(t,n,r){var i={};if(n)for(var u=0,a=n;u<a.length;u++){var f=a[u],l=f.action,c=r+"-"+f.key;l&&(i[c]=o.evaluateAction(t,l));s.assign(i,e(t,f.subMenuProps&&f.subMenuProps.items,c))}return i}(e,i,""),children:u,commands:i,logCommandStart:function(e){var t=f.resetPerfLoggerKeyFacet.serialize({}),r=v(l.readItem({resetPerfLogger:f.resetPerfLoggerFacet},t)).resetPerfLogger,i=e.engagement;i&&m(h.Engagement).logData(n.__assign({usageType:"Click"},i));r&&r();a.mark("EUPL."+e.automationId+".click")},onMenuItemsChanged:p}})(function(e){var t=e.actions,s=e.commands,a=e.logCommandStart,f=e.onMenuItemsChanged,l=e.children;return r.createElement(o.WithActionSet,{actions:t},function(e){var t=function e(t,r,s,u){var a=[];var f=function(t){var i=t.action,f=t.automationId,l=t.postProcess,c=t.subMenuProps,h=n.__rest(t,["action","automationId","postProcess","subMenuProps"]),p=n.__assign({},h,f?{"data-automationid":f}:{}),d=s+"-"+t.key,v=r.actions[d]||o.INITIAL_ACTION_STATE,m=v.isAvailable||v.isToggled||t.isPermanent,g=c&&(i&&m||!i)&&e(c.items,r,d,u),y=void 0;i||c?(m||g&&g.length>0)&&(y=n.__assign({},p,m?n.__assign({disabled:!v.isAvailable&&!v.isToggled,canCheck:"boolean"==typeof v.isToggled,checked:v.isToggled},v.isAvailable?{onClick:function(e){u&&u(t);e&&e.persist();t.onClick&&t.onClick(e);v.execute({event:e}).catch(function(e){})}}:{},{actionState:v}):{},g&&g.length>0?n.__assign({},c?{subMenuProps:n.__assign({},c,{isBeakVisible:!1,items:g}),onMenuClick:function(e){u&&u(t);t.onMenuClick&&t.onMenuClick(e)}}:{}):{})):y=p;y&&a.push(l?l(y):y)};for(var l=0,c=t;l<c.length;l++){var h=c[l];f(h)}return function(e){for(var t=!0,n=[],r=0,s=e;r<s.length;r++){var o=s[r];if(o.itemType===i.ContextualMenuItemType.Divider){if(t)continue;t=!0}else t=!1;n.push(o)}t&&n.pop();return n}(a)}(s,e,"",a);return r.createElement(r.Fragment,null,f?r.createElement(u.StatePropsUpdater,{stateProps:t,onUpdate:f}):null,u.renderChildrenWithProps(l,{menuItems:t}))})});var v=[];t.connectToCommandSets=function(e,i){return function(o){var u=o,a=p.connectToItemCache(function(t,o){var a=e(o),f=[];for(var l in a)if(Object.prototype.hasOwnProperty.call(a,l)){var c=a[l];f.push({key:l,subMenuProps:{items:c||v}})}return{commands:f,children:function(e){var t=e.menuItems,f=n.__assign({},s.mapObject(a,function(){return v}),s.makeObject(t,function(e){return e&&e.subMenuProps&&e.subMenuProps.items||v},function(e){return e.key})),l=n.__assign({},o,i(f,o));return r.createElement(u,n.__assign({},l))}}})(t.CommandSet);a.displayName="ConnectToCommandSets";return a}}});
define("@ms/items-view/lib/private/components/columns/fields/fieldsColumn",["require","exports","../../../models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fieldsColumn={key:new n.Facet("fieldsColumn").id,name:"Fields",fieldName:"",minWidth:0}});
define("@ms/items-view/lib/private/components/itemSetDetailsList/decorators/withItemSetRowsAndGroups",["require","exports","tslib","react","../../cache/DetailsList.resx","../../decorators/connectToItemCache","../../itemPage/ItemPage","../ItemDetailsRow","../../../controls/itemSetDetailsListControl","../GroupItemDetailsHeader","../../../controls/childItemsControl","../../../facets/SetFacets","../../../facets/GroupFacets","../../../facets/ItemFacets","../../../facets/DemandFacets","../../../facets/ScopeFacets","../../../models/configuration/getConfiguration","../../../facets/ConfigurationFacets","../../../models/itemCache/bindItemCacheSelectorToProps","../../../hooks/useItemCacheSelector","../../../models/KeyFacet","../../../models/itemCache/ComputedItemFacet","../../../utilities/Memoizer","../../../controls/itemSetPagingControl"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=0,N=0,C=[];t.withItemSetRowsAndGroups=function(){return s.connectToItemCache(M)};t.useItemSetRowsAndGroups=function(e){var t=e.allGroupsCollapsed,n=e.columns,r=void 0===n?C:n,i=e.enableShimmer,s=e.groupsCollapsed,o=e.itemKey,u=e.onGetGroupItemLimit,a=e.onItemInvoked,f=e.onRenderDetailsFooter,l=e.onToggleCollapseAll,c=e.onToggleGroupCollapsed,h=e.selection,p=e.layoutSupportsRandomAccess;return b.useItemCacheSelector(y.bindItemCacheSelectorToProps(M,e),[t,r,i,s,o,u,a,f,l,c,h,p])};var k=new w.KeyFacet("detailsListItem",{__isPage:w.booleanPart(),itemKey:w.stringPart(),itemSetKey:w.stringPart()}),L=new E.ComputedItemFacet("detailsListItem",function(e,t){var r=e.demandItemFacet(k,t.itemKey);if(r)return S.createMemoizer(function(e){return n.__assign({},r,{key:r.itemKey,Renderer:e})})});function A(e,t){var n=e.demandItemFacet(L,k.serialize(t));return n?n(t.Renderer):t}var O=[];function M(e,t){var r=t.groupsCollapsed,s=t.allGroupsCollapsed,o=void 0===s?e.demandItemFacet(v.allGroupsCollapsedFacet,t.itemKey):s,y=t.onToggleGroupCollapsed,b=t.onToggleCollapseAll,w=t.onGetGroupItemLimit,E=t.enableShimmer,S=t.selection,C=t.layoutSupportsRandomAccess,k=void 0!==C&&C,L=[],M=0,P=[],F=e.demandItemFacet(x.itemSetPagingControl,t.itemKey),I=x.itemSetPagingControl.evaluate(F)(e,{setItemKey:t.itemKey}),q=I.totalItemCount,R=I.getPageKeys,U=k&&!!q&&void 0!==R,z=e.demandItemFacet(c.childItemsFacet,t.itemKey),W=e.demandItemFacet(l.childItemsControl,t.itemKey),X=l.childItemsControl.evaluate(W)(e,{itemKey:t.itemKey,itemKeys:z&&z.itemKeys}).itemKeys,V=m.getConfiguration(e,{enableDetailsListPreComputePages:g.enableDetailsListPreComputePagesFacet}).enableDetailsListPreComputePages,$=e.demandItemFacet(a.itemSetDetailsListControl,t.itemKey),J=a.itemSetDetailsListControl.evaluate($)(e,{itemSetKey:t.itemKey,rowRenderer:u.ItemDetailsRow,groupProps:{},listProps:n.__assign({renderedWindowsAhead:N,renderedWindowsBehind:T},V?{onRenderPage:_}:{}),groupHeaderRenderer:f.GroupItemDetailsHeader,onRenderDetailsFooter:t.onRenderDetailsFooter}),K=J.rowRenderer,Q=J.groupHeaderRenderer,G=J.groupProps,Y=J.listProps,Z=J.itemSetKey,ee=J.onRenderDetailsFooter,te=n.__rest(J,["rowRenderer","groupHeaderRenderer","groupProps","listProps","itemSetKey","onRenderDetailsFooter"]);if(Z&&X)for(var ne=0,re=X;ne<re.length;ne++){var ie=re[ne];if(void 0===ie){if(!U)break;L.push(void 0)}else if(e.isItemFacetResolved(c.pageFacet,ie)){U?L.push(void 0):L.push(A(e,{key:ie,itemKey:ie,itemSetKey:Z,Renderer:H,__isPage:!0}));P.length>0&&P.push({key:"groupPage-"+ie,name:"",startIndex:M,count:1,isCollapsed:!1,data:{itemKey:ie,itemSetKey:Z,selection:S,HeaderRenderer:B}})}else if(e.isItemFacetResolved(h.isGroupFacet,ie)){var se=e.demandItem({displayName:p.displayNameFacet,groupCount:h.countFacet,defaultCollapsed:h.defaultCollapsedFacet},ie),oe=se.displayName,ue=se.groupCount,ae=se.defaultCollapsed,fe=M,le=[],ce=!0,he=void 0;if(e.isItemFacetResolved(c.childItemsFacet,ie)&&(he=e.demandItemFacet(c.childItemsFacet,ie)))if(e.isItemFacetResolved(h.isGroupFacet,he.itemKeys[0]))for(var pe=void 0,de=M,ve=!0,me=0,ge=he.itemKeys;me<ge.length;me++){var ye=ge[me],be=e.demandItem({nestedGroupDisplayName:p.displayNameFacet,nestedGroupCount:h.countFacet,nestedGroupDefaultCollapsed:h.defaultCollapsedFacet},ye),we=be.nestedGroupDisplayName,Ee=be.nestedGroupCount,Se=be.nestedGroupDefaultCollapsed;if(e.isItemFacetResolved(c.childItemsFacet,ye)&&(pe=e.demandItemFacet(c.childItemsFacet,ye))){var xe=pe.itemKeys,Te=Ee||M-de;if(xe.length>h.GROUP_ITEM_LIMIT){ve=!1;xe=xe.slice(0,h.GROUP_ITEM_LIMIT);Te=h.GROUP_ITEM_LIMIT}for(var Ne=0,Ce=xe;Ne<Ce.length;Ne++){var ke=Ce[Ne],Le=(Pe=e.isItemFacetResolved(c.pageFacet,ke))?H:K;L.push(A(e,{key:ke,itemKey:ke,itemSetKey:Z,__isPage:Pe,Renderer:Le}));M++}if(xe.length<Te)for(var Ae=xe.length;Ae<Te;Ae++){L.push(void 0);M++}}else{L.push(A(e,{key:ye,itemKey:ye,itemSetKey:Z,Renderer:H,__isPage:!0}));M++;if(Ee)for(Ae=1;Ae<Ee;Ae++){L.push(void 0);M++}}var Oe=r&&void 0!==r[ye]?r[ye]:void 0!==o?o:Se;e.isItemFacetResolved(c.pageFacet,ye)?le.push({key:"groupPage-"+ye,name:"",startIndex:de,count:1,level:1,isCollapsed:!1,data:{itemKey:ye,itemSetKey:Z,selection:S,HeaderRenderer:B}}):le.push({key:ye,startIndex:de,count:Ee||M-de,level:1,isCollapsed:Oe,isShowingAll:ve,name:we||"",data:{itemKey:ye,itemSetKey:Z,selection:S,HeaderRenderer:Q}});de=M}else{var Me=he.itemKeys;Te=ue||M-fe;if(Me.length>h.GROUP_ITEM_LIMIT){ce=!1;Me=Me.slice(0,h.GROUP_ITEM_LIMIT);Te=h.GROUP_ITEM_LIMIT}for(var _e=0,De=Me;_e<De.length;_e++){var Pe;ke=De[_e],Le=(Pe=e.isItemFacetResolved(c.pageFacet,ke))?H:K;L.push(A(e,{key:ke,itemKey:ke,itemSetKey:Z,__isPage:Pe,Renderer:Le}));M++}if(Me.length<Te)for(Ae=Me.length;Ae<Te;Ae++){L.push(void 0);M++}}else{L.push(A(e,{key:ie,itemKey:ie,itemSetKey:Z,Renderer:H,__isPage:!0}));M++;if(ue)for(Ae=1;Ae<ue;Ae++){L.push(void 0);M++}}var He=r&&void 0!==r[ie]?r[ie]:void 0!==o?o:ae;P.push({key:ie,startIndex:fe,count:ue||M-fe,isCollapsed:He,isShowingAll:ce,name:oe||"",children:le.length>0?le:void 0,data:{itemKey:ie,itemSetKey:Z,selection:S,HeaderRenderer:Q}})}else{L.push(A(e,{key:ie,itemKey:ie,itemSetKey:Z,__isPage:!1,Renderer:K}));M++}}var Be=y?function(e){var t=e.data&&e.data.itemKey;y({itemKey:t,isCollapsed:!!e.isCollapsed})}:void 0,je=b?function(e){b({groups:P,newAllCollapsed:e})}:void 0,Fe=w?function(e){var t=e.data&&e.data.itemKey;return w({itemKey:t,count:e.count,isShowingAll:e.isShowingAll})}:void 0,Ie=e.isItemFacetResolved(c.childItemsFacet,t.itemKey)||e.isItemFacetResolved(d.errorFacet,t.itemKey),qe=void 0===E?!Ie:E;return n.__assign({},te,{onRenderDetailsFooter:ee,items:L||O,groups:P.length>0?P:void 0,groupProps:n.__assign({},G,{getGroupItemLimit:Fe,onToggleCollapseAll:je,headerProps:{onToggleCollapse:Be,onGroupHeaderClick:t.onItemInvoked,isCollapsedGroupSelectVisible:!1},showAllProps:{onToggleSummarize:t.onItemInvoked,showAllLinkText:i.default.ShowAll},onRenderHeader:D,isAllGroupsCollapsed:o}),listProps:Y,setKey:t.itemKey,onRenderRow:j,isDataReadyForLayout:Ie,getPageKeys:R,enableShimmer:qe})}function _(e,t){if(!t)return null;var n=t(e);return e.page.isSpacer?n:r.cloneElement(n,void 0,r.createElement(P,null,n.props.children))}function D(e,t){if(!e||!e.group)return null;var i=e.group.data,s=i.HeaderRenderer,o=n.__rest(i,["HeaderRenderer"]);return r.createElement(s,n.__assign({},e,o,{defaultRender:t}))}function P(e){var t=b.useItemCacheSelector(function(t){return r.Children.map(e.children,function(e){if(e){var n=e;if("div"===n.type)return r.cloneElement(n,void 0,r.Children.map(n.props.children,function(e){if(e){var n=e;return s.evaluateItemCacheComponent(t,n)}return e}))}return e})},[e]);return r.createElement(r.Fragment,null,t)}function H(e){return r.createElement(o.ItemPage,{itemKey:e.itemKey,layout:"row"})}function B(e){return null}function j(e,t){if(!e)return null;var i=e.item,s=i.Renderer,o=n.__rest(i,["Renderer"]);return r.createElement(s,n.__assign({},e,o,{defaultRender:t}))}});
define("@ms/items-view/lib/private/components/itemPage/ItemPage",["require","exports","tslib","react","../withItemCache/WithItemCache","../../facets/SetFacets","../../operations/blockItemPage","office-ui-fabric-react/lib/Spinner","@uifabric/utilities/lib/css","./ItemPage.scss","../../models/configuration/getConfiguration","../../facets/ConfigurationFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.itemKey,n=e.layout,h=void 0===n?"none":n;return r.createElement(i.WithItemCache,null,function(e){var n=e.itemCache,i=o.itemPageIsBlocked(n),p=l.getConfiguration(n,{enableListLoadingSpinner:c.enableListLoadingSpinnerFacet}).enableListLoadingSpinner;i||n.demandItemFacet(s.childItemsFacet,t);return"none"!==h?r.createElement("div",{className:a.css(f.root,"row"===h?f.row:f.tile)},p?r.createElement(u.Spinner,null):null):null})};return t}(r.PureComponent);t.ItemPage=h});
define("@ms/items-view/lib/private/components/itemPage/ItemPage.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".root_d998d9d0{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.row_d998d9d0{height:80px}.tile_d998d9d0{position:absolute;top:0;left:0;bottom:0;right:0}\n"}]);t.root="root_d998d9d0";t.row="row_d998d9d0";t.tile="tile_d998d9d0"});
define("@ms/items-view/lib/private/components/itemSetDetailsList/ItemDetailsRow",["require","exports","tslib","office-ui-fabric-react/lib/DetailsList","react","../../models/items/AriaHelper","../../models/items/AriaHelper","../defaultDropZone/DefaultDropZone","../../utilities/performance","../withAction/WithAction","../../controls/itemAriaLabelControl","../../models/schema/itemColumnRenderControl","../actions/defaultClick/DefaultClickAction","../decorators/withActionInvoker","../../controls/itemDetailsRowControl","../../utilities/components/DeferredRender","../../models/Facet","../../utilities/Memoizer","../../models/KeyFacet","../../models/controls/ControlFacet","../../models/itemCache/ComputedItemFacet","../../hooks/useShallowMemo","../decorators/connectToItemCache"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PAGE_LOAD_BARRIER_CONTEXT=i.createContext(void 0);var x=new y.KeyFacet("itemDetailsRow",{itemKey:y.stringPart(),itemIndex:y.numberPart()});t.itemDetailsRowColumnsControl=new b.ControlFacet("itemDetailsRowColumns");var T=new w.ComputedItemFacet("itemDetailsRowData",function(e,n){var r=e.demandItemFacet(x,n.itemKey);if(r){var f=e.demandItemFacet(t.itemDetailsRowColumnsControl,void 0),p=t.itemDetailsRowColumnsControl.evaluate(f)(e,{}).columns;if(p){var v=r.itemIndex;return function(e,t){var n=t.itemKey,r=t.itemIndex,f=t.columns;a.mark("ItemDetailsRow.render("+n+")");var p=e.demandItemFacet(l.itemAriaLabelControl,n),v=l.itemAriaLabelControl.evaluate(p)(e,{itemKey:n,itemAriaLabel:s.getRowAriaLabel(e,{itemKey:n}),itemCheckboxAriaLabel:o.getRowCheckboxAriaLabel(e,{itemKey:n})}),g=v.itemAriaLabel,y=v.itemCheckboxAriaLabel,b=e.demandItemFacet(d.itemDetailsRowControl,n),w=d.itemDetailsRowControl.evaluate(b)(e,{itemKey:n,rowData:m.pack({},{}),enableUpdateAnimations:!1}),E=w.rowData,x=w.enableUpdateAnimations,T=function(e,t){for(var n=t.itemKey,r=t.itemIndex,i=t.columns,s=t.rowData,o={renderers:{},getValueKeys:{}},u=0,a=i;u<a.length;u++){var f=a[u],l=f.data,h=c.itemColumnRenderControl.evaluate(l&&l.renderHandler)(e,{itemKey:n,itemIndex:r,column:f,rowData:s}),p=h.renderer,d=void 0===p?f.onRender:p,v=h.getValueKey;o.renderers[f.key]=d;o.getValueKeys[f.key]=v}return o}(e,{itemKey:n,itemIndex:r,columns:f,rowData:E}),N=T.renderers,C=T.getValueKeys,k=S.evaluateItemCacheComponent(e,i.createElement(h.ItemDefaultClickAction,{itemKey:n})),L=S.evaluateItemCacheComponent(e,i.createElement(u.ItemDefaultDropZone,{itemKey:n,enableDrag:!0,itemIndex:r}));return{getRowAriaLabel:function(){return g},invokeAction:k,renderers:N,getValueKeys:C,checkButtonAriaLabel:y,enableUpdateAnimations:x,dragDropElement:L}}(e,{columns:p,itemIndex:-1===v?void 0:v,itemKey:r.itemKey})}}}),N=g.createMemoizer(function(e){e.onRender;return n.__rest(e,["onRender"])}),C={dragDropElement:null,invokeAction:null,renderers:{},getValueKeys:{}};t.ItemDetailsRow=S.connectToItemCache(function(e,t){var n=x.serialize(t);return{performanceData:e.demandItemFacet(T,n)||C}})(function(e){var t=E.useShallowMemo(function(){return e},e),s=t.performanceData,o=t.defaultRender,a=t.selection,l=t.item,c=t.itemKey,h=t.itemIndex,d=t.columns,v=i.useMemo(function(){return o?i.memo(o):void 0},[o]);i.useRef(0).current+=1;var m=i.useMemo(function(){return d.map(N)},[d]),g=f.useAction(s.invokeAction),y=g[0],b=g[1],w=y.isAvailable,S=!(w||a.canSelectItem(l)&&a.mode!==r.SelectionMode.none),x=i.useMemo(function(){return n.__assign({},l,{isInvokable:w,isDisabled:S,renderers:s.renderers,getValueKeys:s.getValueKeys})},[l,w,S,s.renderers,s.getValueKeys]);p.useInvokeAction(n.__assign({},y,{itemKey:c,index:h}));return i.useMemo(function(){return u.renderChildrenWithDropZoneElement(i.createElement(i.Fragment,null,b,v&&s?i.createElement(v,n.__assign({},t,{key:"row",checkButtonAriaLabel:s.checkButtonAriaLabel,getRowAriaLabel:s.getRowAriaLabel,onRenderDetailsCheckbox:A,columns:m,item:x,onRenderItemColumn:k,getCellValueKey:s.enableUpdateAnimations?L:void 0,enableUpdateAnimations:s.enableUpdateAnimations})):null),s.dragDropElement)},[b,t,s,m,x])});t.ItemDetailsRow.displayName="ItemDetailsRow";function k(e,t,n){if(!n||!n.key)return null;var r=e.renderers[n.key]||n.onRender;return r?r(e,t,n):null}function L(e,t,n){if(!n||!n.key)return"";var r=e.getValueKeys[n.key];return r?r(e,t,n):n.key+t}function A(e,n){var r=e;return i.createElement(t.PAGE_LOAD_BARRIER_CONTEXT.Consumer,null,function(e){return i.createElement(v.DeferredRender,{barrier:e},n(r))})}});
define("@ms/items-view/lib/private/models/items/AriaHelper",["require","exports","../../facets/ItemFacets","@ms/utilities-strings/lib/index","@ms/items-view-utilities/lib/string/DriveSpaceHelper","./ItemStrings.resx","../../components/fields/FieldStrings.resx","../../facets/GroupFacets"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getRowAriaLabel=function(e,t){var a=t.itemKey,f=e.demandItem({displayName:n.displayNameFacet,folder:n.folderFacet,dateModified:n.dateModifiedFacet,modifiedByPerson:n.modifiedByPersonFacet,missingMetadata:n.missingMetadataFacet,policyTip:n.policyTipFacet,isCheckedOut:n.isCheckedOutFacet,isMalwareDetected:n.malwareDetectedFacet,retentionPolicy:n.retentionPolicyFacet,count:u.countFacet,isShared:n.isSharedFacet,isNew:n.isNewFacet},a),l=f.displayName,c=f.folder,h=f.dateModified,p=f.modifiedByPerson,d=f.missingMetadata,v=f.policyTip,m=f.isCheckedOut,g=f.isMalwareDetected,y=f.retentionPolicy,b=f.count,w=f.isShared,E=f.isNew,S=e.isItemFacetResolved(n.folderFacet,a)&&!c,x=S?e.demandItemFacet(n.fileSizeFacet,a):void 0,T=S?e.demandItemFacet(n.fileNameFacet,a):void 0,N=[];l&&N.push(l);if(c){N.push(s.default.fileTypeFolder);b&&N.push(r.format(s.default.folderItemCount,b));w&&N.push(s.default.folderIsShared)}else if(T&&T.extension){var C=T.extension,k="."===C[0]?C.substring(1):C;N.push(k+" "+s.default.fileTypeNoExtension)}E&&N.push(o.default.itemSignalNew);if(m)if(m.byYou)N.push(o.default.itemSignalYouCheckedOut);else if(m.byOther){var L=(O=e.demandItem({displayName:n.displayNameFacet},m.byOther))&&O.displayName?r.format(o.default.itemSignalSomeoneCheckedOutTooltip,O.displayName):o.default.itemSignalSomeoneCheckedOut;N.push(L)}g&&N.push(o.default.itemSignalMalwareDetected);v&&(2===v||3===v?N.push(s.default.policyTipBlockText):1===v&&N.push(s.default.policyTipNotifyText));y&&1===y&&N.push(o.default.itemSignalIsRecord);d&&N.push(s.default.missingMetadataText);if(h)try{var A=new Date(h).toLocaleDateString();N.push(r.format(s.default.dateModifiedLabelFormat,A))}catch(e){}if(p){var O;(O=e.demandItem({displayName:n.displayNameFacet},p.itemKey))&&O.displayName&&N.push(r.format(s.default.gridViewSubTitle,O.displayName))}x&&N.push(i.default.getDisplayString(x,{ignoreZero:!0}));return N.join(", ")};t.getRowCheckboxAriaLabel=function(e,t){var i=e.demandItem({displayName:n.displayNameFacet,fileName:n.fileNameFacet},t.itemKey),o=i.displayName,u=i.fileName,a=[];o?a.push(o):u&&a.push(u.name);return r.format(s.default.checkboxAriaLabel,a[0])}});
define("@ms/items-view-utilities/lib/string/DriveSpaceHelper",["require","exports","./DriveSpaceHelper.resx","../locale/Locale"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s=1024,o=1048576,u=1073741824,a=1099511627776,f=/\.?0+$/;!function(e){e.getDisplayString=function(e,r){void 0===r&&(r={});if("number"!=typeof e||isNaN(e)||r.ignoreZero&&0===e||e<0)return"";var i=r.trimDecimal||!1;return 1===e?n.default.fileSizeBytesSingular:e<s?t(n.default.fileSizeBytesPlural,e,i):e<1e3*s?t(n.default.fileSizeKB,e/s,i):e<1e3*o?t(n.default.fileSizeMB,e/o,i):e<1e3*u?t(n.default.fileSizeGB,e/u,i):t(n.default.fileSizeTB,e/a,i)};function t(e,t,n){return e.replace("{0}",function(e,t){if(e>=100||e===Math.floor(e))return e.toFixed(0);var n=e.toFixed(e>=10?1:2);return(t?n.replace(f,""):n).replace(".",r.Locale.numberRadix)}(t,n))}}(i||(i={}));t.default=i});
define("@ms/items-view-utilities/lib/locale/Locale",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}e.invalidate=function(t,n){e.isRightToLeft=window.document&&"rtl"===document.documentElement.getAttribute("dir");e.safeLeft=e.isRightToLeft?"right":"left";e.safeRight=e.isRightToLeft?"left":"right";e.language=t||"en-US";e.lcid=n||1033;e.numberRadix=1.2.toLocaleString(e.language).replace(/\d+/g,"")};return e}();t.Locale=n;n.invalidate()});
define("@ms/items-view/lib/private/controls/itemAriaLabelControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemAriaLabelControl=new n.ControlFacet("itemAriaLabelControl")});
define("@ms/items-view/lib/private/models/schema/itemColumnRenderControl",["require","exports","../controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemColumnRenderControl=new n.ControlFacet("itemColumnRender")});
define("@ms/items-view/lib/private/components/actions/defaultClick/DefaultClickAction",["require","exports","../../../controls/defaultClickActionControl","./handlers/open","./handlers/openUrl","../../withAction/WithAction","../../decorators/connectToItemCache"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=[r.openDefaultClickActionHandler,i.openUrlDefaultClickActionHandler];t.ItemDefaultClickAction=o.connectToItemCache(function(e,t){for(var r,i=e.demandItemFacet(n.defaultClickActionControl,t.itemKey),o=0,a=n.defaultClickActionControl.evaluate(i)(e,{itemKey:t.itemKey,handlers:u}).handlers;o<a.length;o++){var f=a[o].evaluate(e,t).action;if(f){r=f;break}}return{action:s.evaluateAction(e,r)}})(s.ActionSelector)});
define("@ms/items-view/lib/private/controls/defaultClickActionControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultClickActionControl=new n.ControlFacet("defaultClickActionControl")});
define("@ms/items-view/lib/private/components/actions/defaultClick/handlers/open",["require","exports","react","../../../../models/Facet","../../open/OpenAction","../../../../facets/ItemFacets","../../../../facets/GroupFacets"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openDefaultClickActionHandler={key:new r.Facet("openDefaultClickHandler").id,evaluate:function(e,t){var r=t.itemKey;return{action:e.demandItemFacet(s.folderFacet,r)||e.demandItemFacet(o.isGroupFacet,r)?n.createElement(i.ItemOpenAction,{itemKey:r}):void 0}}}});
define("@ms/items-view/lib/private/components/actions/defaultClick/handlers/openUrl",["require","exports","react","../../../../models/Facet","../../openUrl/OpenUrlAction","../../../../facets/ItemFacets"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openUrlDefaultClickActionHandler={key:new r.Facet("openUrlDefaultClickHandler").id,evaluate:function(e,t){var r=t.itemKey;return{action:e.demandItemFacet(s.openUrlFacet,r)?n.createElement(i.ItemOpenUrlAction,{itemKey:r}):void 0}}}});
define("@ms/items-view/lib/private/components/actions/openUrl/OpenUrlAction",["require","exports","tslib","../../decorators/connectToItemCache","../../action/Action","../../decorators/selectors","../../../facets/ItemFacets","../../../controls/targetWindowControl","../../../models/telemetry/getItemEngagement","../../../utilities/Graft"],function(e,t,n,r,i,s,o,u,a,f){"use strict";var l=this;Object.defineProperty(t,"__esModule",{value:!0});var c=function(){return n.__awaiter(l,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})})};t.ItemOpenUrlAction=r.connectToItemCache(function(e,t){var r=t.itemKey,i=t.engagement,s=e.demandItem({openUrl:o.openUrlFacet},r).openUrl,h=e.demandItemFacet(u.targetWindowControl,void 0),p=u.targetWindowControl.evaluate(h)(e,{}).targetWindow;return n.__assign({isAvailable:!!s,onExecute:s?function(){return n.__awaiter(l,void 0,void 0,function(){return n.__generator(this,function(e){p?p.location.href=s:window.open(s);return[2]})})}:c},a.getItemActionEngagement(e,{itemKey:r,engagement:f.graft({name:"OpenUrl",isIntentional:!0},i)}))})(i.Action);t.OpenUrlAction=s.withSelectedItems()(s.withExactlyOneItem()(t.ItemOpenUrlAction))});
define("@ms/items-view/lib/private/controls/targetWindowControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.targetWindowControl=new n.ControlFacet("targetWindowControl")});
define("@ms/items-view/lib/private/controls/itemDetailsRowControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemDetailsRowControl=new n.ControlFacet("itemDetailsRowControl")});
define("@ms/items-view/lib/private/controls/itemSetDetailsListControl",["require","exports","../models/controls/ControlFacet","../components/controls/defaultRenderComponentControlOption","../models/controls/graftControlOption"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemSetDetailsListControl=new n.ControlFacet("itemDetailsListControl",{rowRenderer:r.defaultRenderComponentOption(),groupHeaderRenderer:r.defaultRenderComponentOption(),listProps:i.graftControlOption()})});
define("@ms/items-view/lib/private/components/itemSetDetailsList/GroupItemDetailsHeader",["require","exports","tslib","react","../defaultDropZone/DefaultDropZone","../../facets/GroupFacets","../actions/defaultClick/DefaultClickAction","../decorators/withActionInvoker","../withAction/WithAction","../withItemCache/WithItemCache","../telemetry/TelemetryProvider"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=l.createTelemetryProvider({withContext:{component:"GroupHeader"}}),h=function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onKeyDown=function(e){var n=t.props,r=n.group,i=n.isCollapsedGroupSelectVisible;if("ArrowLeft"===e.key||"ArrowRight"===e.key)e.preventDefault();else if(" "===e.key&&r&&(i||!r.isCollapsed)){t._onToggleSelectGroup(r);e.preventDefault()}};t._onKeyUp=function(e){var r=t.props,i=r.group,s=r.onToggleCollapse,o=r.onGroupHeaderClick;if(i)if("ArrowLeft"===e.key&&s){s(n.__assign({},i,{isCollapsed:!1}))}else if("ArrowRight"===e.key&&s){s(n.__assign({},i,{isCollapsed:!0}))}else"Enter"===e.key&&o&&o(i)};t._onToggleSelectGroup=function(e){var n=t.props.selection;if(n)if(e.children){for(var r=!0,i=0,o=e.children;i<o.length;i++){if(!(h=o[i]).isCollapsed){var u=h.count>s.GROUP_ITEM_LIMIT?s.GROUP_ITEM_LIMIT:h.count,a=n.isRangeSelected(h.startIndex,u);r=r&&a}}for(var f=!r,l=0,c=e.children;l<c.length;l++){var h;if(!(h=c[l]).isCollapsed){u=h.count>s.GROUP_ITEM_LIMIT?s.GROUP_ITEM_LIMIT:h.count;f!==(a=n.isRangeSelected(h.startIndex,u))&&n.toggleRangeSelected(h.startIndex,u)}}}else{var p=e.count>s.GROUP_ITEM_LIMIT?s.GROUP_ITEM_LIMIT:e.count;n.toggleRangeSelected(e.startIndex,p)}};return t}t.prototype.componentDidUpdate=function(e){var t=this.props,r=t.hasDropFinished,i=n.__rest(t,["hasDropFinished"]);!e.hasDropFinished&&r&&i.onToggleCollapse&&i.group&&i.group.isCollapsed&&i.onToggleCollapse(i.group)};t.prototype.render=function(){var e=this.props,t=e.defaultRender,i=n.__rest(e,["defaultRender"]);return r.createElement("div",{onKeyDown:this._onKeyDown,onKeyUp:this._onKeyUp},t?r.createElement(t,n.__assign({},i,{onToggleSelectGroup:this._onToggleSelectGroup})):null)};return t}(r.PureComponent),p=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.itemKey,s=e.defaultRender,l=e.itemSetKey,p=n.__rest(e,["itemKey","defaultRender","itemSetKey"]);return r.createElement(c,null,r.createElement(f.WithItemCache,null,function(e){var f=e.itemCache,c=a.evaluateAction(f,r.createElement(o.ItemDefaultClickAction,{itemKey:t})),d=a.evaluateAction(f,r.createElement(i.ItemDefaultDropZone,{itemKey:t,showDropTargetHint:!0}));return r.createElement(a.WithAction,{action:c},function(e){return i.renderChildrenWithDropZoneElement(function(i){var o=i.hasDropFinished;return r.createElement(r.Fragment,null,r.createElement(u.RegisterInvokeAction,n.__assign({},e,{itemKey:t})),s?r.createElement(s,n.__assign({itemKey:t,itemSetKey:l},p),r.createElement(h,n.__assign({hasDropFinished:o},p))):null)},d)})}))};return t}(r.PureComponent);t.GroupItemDetailsHeader=p});
define("@ms/items-view/lib/private/controls/childItemsControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.childItemsControl=new n.ControlFacet("childItemsControl")});
define("@ms/items-view/lib/private/controls/itemSetPagingControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemSetPagingControl=new n.ControlFacet("itemSetPagingControl")});
define("@ms/items-view/lib/private/components/itemSetDetailsList/InjectableItemSetDetailsList",["require","exports","tslib","office-ui-fabric-react/lib/DetailsList","../decorators/withCachedScrollPosition","../decorators/withLayoutRenderComplete","../../utilities/components/Props","./DetailsList.resx","@ms/utilities-objects/lib/areShallowEqual","./DetailsListWrapper"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={constrainMode:r.ConstrainMode.unconstrained,ariaLabelForGrid:u.default.listTooltip,ariaLabelForSelectionColumn:u.default.selectionColumnHeaderAriaLabel,ariaLabelForSelectAllCheckbox:u.default.toggleSelectAllAriaLabel,ariaLabelForListHeader:u.default.ColumnHeaderOperationAriaLabel,layoutMode:r.DetailsListLayoutMode.justified};var c=o.wrapWithParent(f.DetailsListWrapper)(function(e){return(0,e.onRenderDetailsList)(n.__rest(e,["onRenderDetailsList"]))}),h=o.injectProps(function(){var e;return function(t){return n.__assign({},l,t,function(t){var r=t.selection,i=t.selectionZoneProps,s=i||r?n.__assign({},i||{},r?{selection:r,disableAutoSelectOnInputElements:!0}:{}):void 0,o=!e||a.areShallowDifferent(e,s)?s:e;e=o;return{selection:r,selectionZoneProps:o}}(t))}})(c),p=s.withLayoutRenderComplete({qosName:"Details"})(h);t.InjectableItemSetDetailsList=i.withCachedScrollPosition()(p)});
define("@ms/items-view/lib/private/components/decorators/withCachedScrollPosition",["require","exports","tslib","react","./connectToItemCache","./connectToItemsScope","../../facets/ScopeFacets","../../operations/getItems"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.withCachedScrollPosition=function(){return function(e){var t=e,a=function(e){n.__extends(i,e);function i(t){var n=e.call(this,t)||this;n._onComponentRef=function(e){n._component=e||void 0;n._component&&0!==n.props.cachedScrollPosition&&n.setState({hasComponentReference:!0})};n.state={hasComponentReference:!1,initialScrollPositionSet:!1};return n}i.prototype.render=function(){var e=this.props,i=(e.cachedScrollPosition,n.__rest(e,["cachedScrollPosition"]));return r.createElement(t,n.__assign({componentRef:this._onComponentRef},i))};i.prototype.componentDidUpdate=function(e,t){if(this._component&&0!==this.props.cachedScrollPosition&&!t.initialScrollPositionSet&&!this.state.initialScrollPositionSet){this._component.scrollToIndex(this.props.cachedScrollPosition);this.setState({initialScrollPositionSet:!0})}};i.prototype.componentWillUnmount=function(){if(this._component){var e=this.props.saveScrollPosition;e&&e({lastScrollPosition:0})}};return i}(r.PureComponent),f=i.connectToItemCache(function(e,t){var r=t.itemKey,i=t.itemsScopeItemKey,s=e.dispatch,a=e.demandItemFacet(o.startItemIndexInViewFacet,i),f=r?function(e){var t,a;s(u.resolveItems({items:(t={},t[i]=n.__assign({},o.startItemIndexInViewFacet.pack((a={},a[r]=e.lastScrollPosition,a))),t)}))}:void 0;return{cachedScrollPosition:r&&a&&a[r]||0,saveScrollPosition:f}})(a);return s.connectToItemsScope()(f)}}});
define("@ms/items-view/lib/private/components/decorators/withLayoutRenderComplete",["require","exports","react","../../utilities/components/Decorators","../../utilities/components/Relay","../../utilities/objects","../../utilities/Graft","../../utilities/performance"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.INITIAL_LAYOUT_TRACKER_STATE={layouts:{}};t.LAYOUT_TRACKER_RELAY=i.createRelay(t.INITIAL_LAYOUT_TRACKER_STATE,{merge:function(e){return{layouts:s.mapObject(e.layouts,function(e){return new o.MirrorPatch(e)})}},remove:function(e){return{layouts:s.mapObject(e.layouts,function(){return new o.Delete})}},allowSenderOutsideReceiver:!0});var a=0;t.withLayoutRenderComplete=function(e){void 0===e&&(e={});var t=e.qosName;return function(e){return function(i){var s=i.isDataReadyForLayout,o=i.itemKey,l=n.useState(function(){return++a})[0],c=n.useRef(),h=n.useRef(),p=n.useRef(),d=h.current,v=p.current;h.current=s;p.current=i.itemKey;if(s&&(!d||o!==v)){c.current=u.now();t&&u.mark("Layout."+t+".Render "+l+" start")}var m=c.current;return n.createElement(n.Fragment,null,r.renderComponentWithProps(e,i),n.createElement(f,{isDataReadyForLayout:s,startTime:m,qosName:t,id:l}))}}};function f(e){var r=e.startTime,i=e.qosName,s=e.isDataReadyForLayout,o=e.id,a=n.useRef(),f=n.useRef(),l=n.useRef(),c=f.current;f.current=r;var h=l.current;l.current=s;!s&&h&&(a.current=void 0);if(s&&r!==c){a.current=u.now();if(i){u.mark("Layout."+i+".Render "+o+" end");try{u.measure("Layout."+i+".Render","Layout."+i+".Render "+o+" start","Layout."+i+".Render "+o+" end")}catch(e){}}}var p=a.current,d=n.useMemo(function(){var e;return{layouts:(e={},e[o]={isReady:s,startTime:r,endTime:p},e)}},[s,r,p]);t.LAYOUT_TRACKER_RELAY.useSender(d);return null}});
define("@ms/items-view/lib/private/components/itemSetDetailsList/DetailsListWrapper",["require","exports","react","office-ui-fabric-react/lib/MarqueeSelection","../telemetry/TelemetryProvider","./ItemDetailsRow","../decorators/withControlHandler","../itemCacheSuspense/ItemCacheSuspense","@uifabric/utilities/lib/dom/findElementRecursive"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=i.createTelemetryProvider({withContext:{component:"DetailsRow"}});function l(e){return!a.findElementRecursive(e.target,function(e){return null!==e.getAttribute("data-selection-index")})}t.DetailsListWrapper=function(e){var t=e.selection,i=e.disableMarqueeSelection,a=e.enableItemDetailsRowRenderDebounce,c=e.columns,h=e.children,p=n.useMemo(function(){return s.itemDetailsRowColumnsControl.pack(function(){return{columns:c}})},[c]),d=t&&!i?n.createElement(r.MarqueeSelection,{selection:t,onShouldStartSelection:l},h):h,v=a?n.createElement(u.ItemCacheSuspense,{mode:"debounce",fallback:null},d):d;return n.createElement(f,null,n.createElement(o.ControlHandlerProvider,{controlHandlers:p},n.createElement(s.PAGE_LOAD_BARRIER_CONTEXT.Provider,{value:e.pageLoadBarrier},v)))}});
define("office-ui-fabric-react/lib/MarqueeSelection",["require","exports","tslib","./components/MarqueeSelection/MarqueeSelection","./utilities/selection/index"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("office-ui-fabric-react/lib/components/MarqueeSelection/MarqueeSelection",["require","exports","../../Utilities","./MarqueeSelection.base","./MarqueeSelection.styles"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MarqueeSelection=n.styled(r.MarqueeSelectionBase,i.getStyles,void 0,{scope:"MarqueeSelection"})});
define("office-ui-fabric-react/lib/components/MarqueeSelection/MarqueeSelection.base",["require","exports","tslib","react","../../Utilities"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.classNamesFunction(),o=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._root=r.createRef();n._onMouseDown=function(e){var t=n.props,r=t.isEnabled,s=t.onShouldStartSelection;if(!n._isMouseEventOnScrollbar(e)&&!n._isInSelectionToggle(e)&&!n._isTouch&&r&&!n._isDragStartInSelection(e)&&(!s||s(e))&&n._scrollableSurface&&0===e.button&&n._root.current){n._selectedIndicies={};n._preservedIndicies=void 0;n._events.on(window,"mousemove",n._onAsyncMouseMove);n._events.on(n._scrollableParent,"scroll",n._onAsyncMouseMove);n._events.on(window,"click",n._onMouseUp,!0);n._autoScroll=new i.AutoScroll(n._root.current);n._scrollTop=n._scrollableSurface.scrollTop;n._rootRect=n._root.current.getBoundingClientRect();n._onMouseMove(e)}};n._onTouchStart=function(e){n._isTouch=!0;n._async.setTimeout(function(){n._isTouch=!1},0)};n._onPointerDown=function(e){if("touch"===e.pointerType){n._isTouch=!0;n._async.setTimeout(function(){n._isTouch=!1},0)}};n.state={dragRect:void 0};return n}t.prototype.componentDidMount=function(){this._scrollableParent=i.findScrollableParent(this._root.current);this._scrollableSurface=this._scrollableParent===window?document.body:this._scrollableParent;var e=this.props.isDraggingConstrainedToRoot?this._root.current:this._scrollableSurface;this._events.on(e,"mousedown",this._onMouseDown);this._events.on(e,"touchstart",this._onTouchStart,!0);this._events.on(e,"pointerdown",this._onPointerDown,!0)};t.prototype.componentWillUnmount=function(){this._autoScroll&&this._autoScroll.dispose()};t.prototype.render=function(){var e=this.props,t=e.rootProps,i=e.children,o=e.theme,u=e.className,a=e.styles,f=this.state.dragRect,l=s(a,{theme:o,className:u});return r.createElement("div",n.__assign({},t,{className:l.root,ref:this._root}),i,f&&r.createElement("div",{className:l.dragMask}),f&&r.createElement("div",{className:l.box,style:f},r.createElement("div",{className:l.boxFill})))};t.prototype._isMouseEventOnScrollbar=function(e){var t=e.target,n=t.offsetWidth-t.clientWidth;if(n){var r=t.getBoundingClientRect();if(i.getRTL()){if(e.clientX<r.left+n)return!0}else if(e.clientX>r.left+t.clientWidth)return!0;if(e.clientY>r.top+t.clientHeight)return!0}return!1};t.prototype._getRootRect=function(){return{left:this._rootRect.left,top:this._rootRect.top+(this._scrollTop-this._scrollableSurface.scrollTop),width:this._rootRect.width,height:this._rootRect.height}};t.prototype._onAsyncMouseMove=function(e){var t=this;this._async.requestAnimationFrame(function(){t._onMouseMove(e)});e.stopPropagation();e.preventDefault()};t.prototype._onMouseMove=function(e){if(this._autoScroll){void 0!==e.clientX&&(this._lastMouseEvent=e);var t=this._getRootRect(),n={x:e.clientX-t.left,y:e.clientY-t.top};this._dragOrigin||(this._dragOrigin=n);if(void 0!==e.buttons&&0===e.buttons)this._onMouseUp(e);else if(this.state.dragRect||i.getDistanceBetweenPoints(this._dragOrigin,n)>5){if(!this.state.dragRect){var r=this.props.selection;e.shiftKey||r.setAllSelected(!1);this._preservedIndicies=r&&r.getSelectedIndices&&r.getSelectedIndices()}var s=this.props.isDraggingConstrainedToRoot?{x:Math.max(0,Math.min(t.width,this._lastMouseEvent.clientX-t.left)),y:Math.max(0,Math.min(t.height,this._lastMouseEvent.clientY-t.top))}:{x:this._lastMouseEvent.clientX-t.left,y:this._lastMouseEvent.clientY-t.top},o={left:Math.min(this._dragOrigin.x,s.x),top:Math.min(this._dragOrigin.y,s.y),width:Math.abs(s.x-this._dragOrigin.x),height:Math.abs(s.y-this._dragOrigin.y)};this._evaluateSelection(o,t);this.setState({dragRect:o})}return!1}};t.prototype._onMouseUp=function(e){this._events.off(window);this._events.off(this._scrollableParent,"scroll");this._autoScroll&&this._autoScroll.dispose();this._autoScroll=this._dragOrigin=this._lastMouseEvent=this._selectedIndicies=this._itemRectCache=void 0;if(this.state.dragRect){this.setState({dragRect:void 0});e.preventDefault();e.stopPropagation()}};t.prototype._isPointInRectangle=function(e,t){return e.top<t.y&&e.bottom>t.y&&e.left<t.x&&e.right>t.x};t.prototype._isDragStartInSelection=function(e){var t=this.props.selection;if(!this._root.current||t&&0===t.getSelectedCount())return!1;for(var n=this._root.current.querySelectorAll("[data-selection-index]"),r=0;r<n.length;r++){var i=n[r],s=Number(i.getAttribute("data-selection-index"));if(t.isIndexSelected(s)){var o=i.getBoundingClientRect();if(this._isPointInRectangle(o,{x:e.clientX,y:e.clientY}))return!0}}return!1};t.prototype._isInSelectionToggle=function(e){for(var t=e.target;t&&t!==this._root.current;){if("true"===t.getAttribute("data-selection-toggle"))return!0;t=t.parentElement}return!1};t.prototype._evaluateSelection=function(e,t){if(e&&this._root.current){var n=this.props.selection,r=this._root.current.querySelectorAll("[data-selection-index]");this._itemRectCache||(this._itemRectCache={});for(var i=0;i<r.length;i++){var s=r[i],o=s.getAttribute("data-selection-index"),u=this._itemRectCache[o];u||(u={left:(u=s.getBoundingClientRect()).left-t.left,top:u.top-t.top,width:u.width,height:u.height,right:u.left-t.left+u.width,bottom:u.top-t.top+u.height}).width>0&&u.height>0&&(this._itemRectCache[o]=u);u.top<e.top+e.height&&u.bottom>e.top&&u.left<e.left+e.width&&u.right>e.left?this._selectedIndicies[o]=!0:delete this._selectedIndicies[o]}var a=this._allSelectedIndices||{};this._allSelectedIndices={};for(var o in this._selectedIndicies)this._selectedIndicies.hasOwnProperty(o)&&(this._allSelectedIndices[o]=!0);if(this._preservedIndicies)for(var f=0,l=this._preservedIndicies;f<l.length;f++){o=l[f];this._allSelectedIndices[o]=!0}var c=!1;for(var o in this._allSelectedIndices)if(this._allSelectedIndices[o]!==a[o]){c=!0;break}if(!c)for(var o in a)if(this._allSelectedIndices[o]!==a[o]){c=!0;break}if(c){n.setChangeEvents(!1);n.setAllSelected(!1);for(var h=0,p=Object.keys(this._allSelectedIndices);h<p.length;h++){o=p[h];n.setIndexSelected(Number(o),!0,!1)}n.setChangeEvents(!0)}}};t.defaultProps={rootTagName:"div",rootProps:{},isEnabled:!0};return t}(i.BaseComponent);t.MarqueeSelectionBase=o});
define("office-ui-fabric-react/lib/components/MarqueeSelection/MarqueeSelection.styles",["require","exports","../../Styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=function(e){var t,r,i,s=e.theme,o=e.className,u=s.palette;return{root:[o,{position:"relative",cursor:"default"}],dragMask:[{position:"absolute",background:"rgba(255, 0, 0, 0)",left:0,top:0,right:0,bottom:0,selectors:(t={},t[n.HighContrastSelector]={background:"none",backgroundColor:"transparent"},t)}],box:[{position:"absolute",boxSizing:"border-box",border:"1px solid "+u.themePrimary,pointerEvents:"none",zIndex:10,selectors:(r={},r[n.HighContrastSelector]={borderColor:"Highlight"},r)}],boxFill:[{position:"absolute",boxSizing:"border-box",backgroundColor:u.themePrimary,opacity:.1,left:0,top:0,right:0,bottom:0,selectors:(i={},i[n.HighContrastSelector]={background:"none",backgroundColor:"transparent"},i)}]}}});
define("@ms/items-view/lib/private/components/itemCacheSuspense/ItemCacheSuspense",["require","exports","tslib","react","../decorators/withControlHandler","../../controls/itemCacheSuspenseControl","../../operations/getItems","../../utilities/async/wait"],function(e,t,n,r,i,s,o,u){"use strict";var a=this;Object.defineProperty(t,"__esModule",{value:!0});var f={none:s.itemCacheSuspenseControl.pack(function(e,t){return{}}),freeze:s.itemCacheSuspenseControl.pack(function(e,t){return{mode:"freeze"}}),debounce:s.itemCacheSuspenseControl.pack(function(e,t){return t.mode?{}:{mode:"debounce"}}),wait:s.itemCacheSuspenseControl.pack(function(e,t){if(t.mode&&"debounce"!==t.mode)return{};var r=e.dispatch;return{mode:"wait",getItems:function(e){return n.__awaiter(a,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,u.wait(0)];case 1:t.sent();return[4,r(o.getItems(e))];case 2:return[2,t.sent()]}})})}}})};t.ItemCacheSuspense=function(e){e.mode;var t=n.__rest(e,["mode"]);return i.renderChildrenWithControlHandlers(r.createElement(r.Suspense,n.__assign({},t)),f[e.mode])}});
define("@ms/items-view/lib/private/utilities/async/wait",["require","exports","tslib","@ms/utilities-async/lib/wait/wait"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/utilities-async/lib/wait/wait",["require","exports","tslib","../signal/Signal","../cancel/CancelError","./TimeoutError"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.wait=function(e,t){return n.__awaiter(this,void 0,void 0,function(){var s,o,u,a,f,l;return n.__generator(this,function(n){switch(n.label){case 0:s=new r.Signal,o=s.resolve,u=s.reject,a=s.promise;t&&t.throwIfCanceled();f=window.setTimeout(function(){return o()},e);l=t&&t.subscribe(function(){window.clearTimeout(f);u(new i.CancelError)});n.label=1;case 1:n.trys.push([1,,3,4]);return[4,a];case 2:n.sent();return[3,4];case 3:l&&l();return[7];case 4:return[2]}})})};t.createTimeoutCancelSource=function(e,t){var r=new i.CancelSource,o=t&&t.subscribe(r.cancel),u=window.setTimeout(function(){r.cancel(new s.TimeoutError({timeout:e}))},e);r.token.subscribe(function(){window.clearTimeout(u)});return n.__assign({},r,{dispose:function(){clearTimeout(u);o&&o();r.dispose()}})}});
define("@ms/items-view/lib/private/components/itemSetDetailsList/ItemSetDetailsHeader",["require","exports","tslib","react","../decorators/withCommandColumns","./DetailsList.resx","../decorators/connectToItemCache","../../operations/pageLoad","../fields/FieldHelper","../../utilities/components/DeferredRender"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemSetDetailsHeader=o.connectToItemCache(function(e,t){var r=a.getFieldRenderBarrier(e),i=u.isPageLoaded(e);return{columns:r||i||!t.columns?t.columns:t.columns.map(function(e){e.name,e.iconName,e.iconClassName,e.headerCommand,e.onColumnClick,e.onColumnContextMenu,e.columnActionsMode;var t=n.__rest(e,["name","iconName","iconClassName","headerCommand","onColumnClick","onColumnContextMenu","columnActionsMode"]);return n.__assign({},t,{name:""})}),pageLoadBarrier:r}})(i.withCommandColumns()(function(e){var t=e.defaultRender,i=e.pageLoadBarrier,o=n.__rest(e,["defaultRender","pageLoadBarrier"]);return r.createElement(f.DeferredRender,{barrier:i,placeholder:r.createElement("div",{style:{height:"35px"}})},t(n.__assign({ariaLabelForToggleAllGroupsButton:s.default.toggleAllGroupsButtonAriaLabel},o)))}))});
define("@ms/items-view/lib/private/components/decorators/withCommandColumns",["require","exports","tslib","react","office-ui-fabric-react/lib/ContextualMenu","@ms/telemetry-manager/lib/events/Engagement.event","../../utilities/components/Fragment","../../utilities/components/Async","./afterPageLoad","../columnDivider/ColumnDivider","../telemetry/TelemetryProvider"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";var c=this;Object.defineProperty(t,"__esModule",{value:!0});var h=a.afterPageLoad()(u.asAsync(function(){return n.__awaiter(c,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../DeferredComponents"],t,n)})];case 1:return[2,t.sent().ActionContextMenu]}})})}));t.withCommandColumns=function(){return function(e){var t=e,u=function(e){n.__extends(u,e);function u(t){var n=e.call(this,t)||this;n._onDividerClick=function(e,t,r){var i=e.target;t&&t.dividerCommand&&t.dividerCommand.subMenuProps&&n.setState({contextMenu:{target:i,commands:t.dividerCommand.subMenuProps.items,targetColumnKey:t.key},addIconVisibleForIndex:r,contextMenuIsOpen:!0})};n._onRenderDivider=function(e,t){if(!e)return null;var i=e.column,o=e.columnIndex,u=n.state,a=u.contextMenuIsOpen,l=u.addIconVisibleForIndex,c=n.props.telemetry(s.Engagement);return r.createElement(f.default,{column:i,engagement:c,columnIndex:o,defaultRender:t,onAddNewColumn:n._onDividerClick,addIconVisibleForIndex:a?l:-1})};n._onColumnClick=function(e,t){var r=e&&e.target;t&&t.headerCommand&&t.headerCommand.subMenuProps&&n.setState({contextMenu:{target:r,targetColumnKey:t.key,commands:t.headerCommand.subMenuProps.items},contextMenuIsOpen:!0})};n._onDismissContextMenu=function(){n.setState({addIconVisibleForIndex:-1,contextMenuIsOpen:!1})};n._isColumnOrderChanged=function(e){if(n.props.columns)for(var t=0;t<e.length;t++)if(e[t].key!==n.props.columns[t].key)return!0;return!1};n.state={addIconVisibleForIndex:-1,contextMenuIsOpen:!1};return n}u.prototype.UNSAFE_componentWillReceiveProps=function(e){(this.state.contextMenuIsOpen&&e.columns&&this._isColumnOrderChanged(e.columns)||e.setKey!==this.props.setKey)&&this.setState({contextMenu:void 0,contextMenuIsOpen:!1})};u.prototype.render=function(){var e=this,s=this.props,u=s.columns,a=void 0===u?[]:u,f=n.__rest(s,["columns"]),l=this.state.contextMenu,c=a.map(function(t){return n.__assign({},t,{onRenderDivider:t.dividerCommand?e._onRenderDivider:void 0,onColumnClick:t.headerCommand?e._onColumnClick:void 0,isMenuOpen:e.state.contextMenuIsOpen&&e.state.contextMenu&&e.state.contextMenu.targetColumnKey===t.key})});return r.createElement(o.Fragment,null,r.createElement(t,n.__assign({},f,{columns:c})),l?r.createElement(h,{target:l.target,commands:l.commands,directionalHint:i.DirectionalHint.bottomLeftEdge,isOpen:this.state.contextMenuIsOpen,onDismiss:this._onDismissContextMenu}):null)};return u}(r.PureComponent);return l.withTelemetry()(u)}}});
define("@ms/items-view/lib/private/components/decorators/afterPageLoad",["require","exports","tslib","react","./connectToItemCache","../../operations/pageLoad"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function o(){return function(e){var t=i.connectToItemCache(function(e,t){return{hasPageLoaded:!!t.bypassPageLoadBarrier||s.isPageLoaded(e)}})(e);t.displayName="WithPageLoad";return t}}t.withPageLoad=o;t.afterPageLoad=function(){return function(e){var t=e;var i=o()(function(e){var i=e,s=(i.hasPageLoaded,n.__rest(i,["hasPageLoaded"]));return e.hasPageLoaded?r.createElement(t,n.__assign({},s)):null});i.displayName="AfterPageLoad";return i}}});
define("@ms/items-view/lib/private/components/columnDivider/ColumnDivider",["require","exports","tslib","react","office-ui-fabric-react/lib/Icon","@uifabric/utilities/lib/css","./ColumnDivider.scss"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onClickIcon=function(e){n.setState({isActive:!0});var t=n.props,r=t.engagement,i=t.onAddNewColumn,s=t.column,o=t.columnIndex;r.logData({name:"ColumnDividerIcon.ColumnHeader.Click"});try{i(e,s,o)}finally{n.setState({isActive:!1})}};n.state={isActive:!1};return n}t.prototype.render=function(){var e,t,u=this.state.isActive,a=this.props,f=a.defaultRender,l=n.__rest(a,["defaultRender"]),c=l.columnIndex,h=l.addIconVisibleForIndex===c;return r.createElement("div",{className:o.msItemsScopeAddcolumn,key:"divider-wrapper-"+c},r.createElement("div",{className:o.msDetailsHeaderDivider},f&&r.createElement(f,n.__assign({},l)),r.createElement("span",{className:s.css(o.msDetailsHeaderDividerIcon,(e={},e[o.msDetailsHeaderDividerIconVisible]=!!u||h,e))},r.createElement(i.Icon,{iconName:"CircleAdditionSolid","data-automationid":"msListCustomDividerIcon",className:o.msDetailsHeaderDividerAddIcon,onClick:this._onClickIcon}),r.createElement("span",{"data-automationid":"msListCustomDivider",className:s.css(o.msDetailsHeaderIconBar,(t={},t[o.msDetailsHeaderIconBarVisible]=!!u||h,t))}))))};return t}(r.PureComponent);t.ColumnDivider=u;t.default=u});
define("@ms/items-view/lib/private/components/columnDivider/ColumnDivider.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".msItemsScopeAddcolumn_2c141d90{display:inline-block;height:inherit}.msItemsScopeAddcolumn_2c141d90 .msDetailsHeaderDivider_2c141d90{display:inline-block;height:100%}.msItemsScopeAddcolumn_2c141d90 .msDetailsHeaderDivider_2c141d90:hover .msDetailsHeaderDividerIcon_2c141d90{display:inline}.msItemsScopeAddcolumn_2c141d90 .msDetailsHeaderDividerIcon_2c141d90{display:none;color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";position:absolute;z-index:5;width:0px;font-size:16px}[dir='ltr'] .msItemsScopeAddcolumn_2c141d90 .msDetailsHeaderDividerIcon_2c141d90{margin-left:-8px}[dir='rtl'] .msItemsScopeAddcolumn_2c141d90 .msDetailsHeaderDividerIcon_2c141d90{margin-right:-8px}.msItemsScopeAddcolumn_2c141d90 .msDetailsHeaderDividerIcon_2c141d90:hover{display:inline;cursor:pointer;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.msItemsScopeAddcolumn_2c141d90 .msDetailsHeaderDividerIcon_2c141d90:hover .msDetailsHeaderIconBar_2c141d90{display:inline}.msItemsScopeAddcolumn_2c141d90 .msDetailsHeaderDividerAddIcon_2c141d90{width:32px;height:32px;text-align:center;position:absolute;top:-43px;margin-top:20px}html[dir='ltr'] .msItemsScopeAddcolumn_2c141d90 .msDetailsHeaderDividerAddIcon_2c141d90{margin-left:-7px}html[dir='rtl'] .msItemsScopeAddcolumn_2c141d90 .msDetailsHeaderDividerAddIcon_2c141d90{margin-right:-8px}.msItemsScopeAddcolumn_2c141d90 .msDetailsHeaderDividerIconVisible_2c141d90{display:inline;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.msItemsScopeAddcolumn_2c141d90 .msDetailsHeaderIconBar_2c141d90{display:none;background:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";position:absolute;width:1px;height:33px}[dir='ltr'] .msItemsScopeAddcolumn_2c141d90 .msDetailsHeaderIconBar_2c141d90{left:8px}[dir='rtl'] .msItemsScopeAddcolumn_2c141d90 .msDetailsHeaderIconBar_2c141d90{right:8px}.msItemsScopeAddcolumn_2c141d90 .msDetailsHeaderIconBarVisible_2c141d90{display:inline}\n"}]);t.msItemsScopeAddcolumn="msItemsScopeAddcolumn_2c141d90";t.msDetailsHeaderDivider="msDetailsHeaderDivider_2c141d90";t.msDetailsHeaderDividerIcon="msDetailsHeaderDividerIcon_2c141d90";t.msDetailsHeaderIconBar="msDetailsHeaderIconBar_2c141d90";t.msDetailsHeaderDividerAddIcon="msDetailsHeaderDividerAddIcon_2c141d90";t.msDetailsHeaderDividerIconVisible="msDetailsHeaderDividerIconVisible_2c141d90";t.msDetailsHeaderIconBarVisible="msDetailsHeaderIconBarVisible_2c141d90"});
define("@ms/items-view/lib/private/components/itemSetDetailsList/hooks/useEnableShimmerAfterPageLoadProps",["require","exports","../../../hooks/useItemCacheSelector","../../../facets/ConfigurationFacets","../../../models/configuration/getConfiguration","../../../operations/pageLoad"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.useEnableShimmerAfterPageLoadProps=function(){return n.useItemCacheSelector(o,[])};function o(e){var t=i.getConfiguration(e,{disableShimmerBeforePageLoadConfiguration:r.disableShimmerBeforePageLoadConfigurationFacet}).disableShimmerBeforePageLoadConfiguration;return void 0===t||t?s.isPageLoaded(e)?{}:{enableShimmer:!1}:{}}});
define("@ms/items-view/lib/private/components/itemSetDetailsList/hooks/useItemDetailsRowDebounceEnabledProps",["require","exports","../../../hooks/useItemCacheSelector","../../../facets/ConfigurationFacets","../../../models/configuration/getConfiguration"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.useItemDetailsRowDebounceEnabledProps=function(){return n.useItemCacheSelector(s,[])};function s(e){return{enableItemDetailsRowRenderDebounce:i.getConfiguration(e,{enableItemDetailsRowRenderDebounce:r.enableItemDetailsRowRenderDebounceFacet}).enableItemDetailsRowRenderDebounce}}});
define("@ms/items-view/lib/private/components/itemSetDetailsList/hooks/usePageLoadBarrierProps",["require","exports","../../../hooks/useItemCacheSelector","../../fields/FieldHelper"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.usePageLoadBarrierProps=function(){return n.useItemCacheSelector(i,[])};function i(e){return{pageLoadBarrier:r.getFieldRenderBarrier(e)}}});
define("@ms/items-view/lib/private/components/decorators/withSelectedItemsContextMenu",["require","exports","tslib","react","../../utilities/components/Async","./afterPageLoad","../../components/selectionVisibility/SelectionVisibility","@uifabric/utilities/lib/EventGroup","../../utilities/performance","../../facets/LoggerFacets","../../hooks/useItemCacheSelector","../../hooks/useEventHandler"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";var h=this;Object.defineProperty(t,"__esModule",{value:!0});var p=s.afterPageLoad()(i.asAsync(function(){return n.__awaiter(h,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../DeferredComponents"],t,n)})];case 1:return[2,t.sent().ItemsContextMenu]}})})}));t.withSelectedItemsContextMenu=function(e){return function(t){var i=t,s="DocLibContextMenuDismissed";return function(t){var f=l.useItemCacheSelector(d,[]),h=r.useState({}),v=h[0],m=h[1],g=c.useEventHandler(function(e,t,n){f&&f();a.mark("Items-View.ContextMenu.Start");if(n){m({isContextMenuOpen:!0,contextMenuTarget:n instanceof MouseEvent?n:n.target});n.stopPropagation()}}),y=c.useEventHandler(function(){var e=v.contextMenuTarget;m({isContextMenuOpen:!1,contextMenuTarget:void 0});var t=e instanceof MouseEvent?e.target:e;t&&t.getAttribute("data-iscontextmenuhost")?t.setAttribute("aria-expanded","false"):u.EventGroup.raise(document,s)}),b=r.useState(function(){return{onItemContextMenu:g}})[0],w=r.useMemo(function(){return e?e(b,t):b},[b,t]);return r.useMemo(function(){return r.createElement(r.Fragment,null,r.createElement(i,n.__assign({},t,w)),r.createElement(o.ShowOnlyWithSelection,null,r.createElement(p,{target:v.contextMenuTarget,onDismiss:y,isOpen:!!v.isContextMenuOpen})))},[t,w,v])}}};function d(e){return e.demandItemFacet(f.resetPerfLoggerFacet,f.resetPerfLoggerKeyFacet.serialize({}))}});
define("@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility",["require","exports","../decorators/selectors","../decorators/connectToItemCache","../withAction/WithAction"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e.hideWithSelection="hideWithSelection";e.showOnlyWithSelection="showOnlyOnSelection"}(t.SelectionVisibilityMode||(t.SelectionVisibilityMode={}));t.SelectionVisibility=n.withSelectedItems()(r.connectToItemCache(function(e,t){var n=t.visibilityMode,r=t.children,i=t.itemKeys.length>0;return{action:("showOnlyOnSelection"===n?i:!i)?r:null}})(i.ActionSelector));t.ShowOnlyWithSelection=r.connectToItemCache(function(){return{visibilityMode:"showOnlyOnSelection"}})(t.SelectionVisibility);t.HideWithSelection=r.connectToItemCache(function(){return{visibilityMode:"hideWithSelection"}})(t.SelectionVisibility)});
define("@ms/items-view/lib/private/components/layouts/TilesLayout",["require","exports","tslib","../../utilities/components/Async","../decorators/selectors","../decorators/connectToSelection","../layoutManager/LayoutManager","../decorators/connectToItemCache","../../controls/tilesLayoutControl","./TilesLayoutTypeFacet","../decorators/withSelectedItemsContextMenu"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";var c=this;Object.defineProperty(t,"__esModule",{value:!0});var h=r.asAsync(function(){return n.__awaiter(c,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../itemSetTilesList/ItemSetTilesList"],t,n)})];case 1:return[2,t.sent().ItemSetTilesList]}})})}),p=l.withSelectedItemsContextMenu()(h),d=s.withItemSetSelection()(p),v=o.asLayout(f.tilesLayoutType)(d);t.TilesLayout=u.connectToItemCache(function(e){var t=i.getCurrentItemSetKey(e),n=e.demandItemFacet(a.tilesLayoutControl,t),r=a.tilesLayoutControl.evaluate(n)(e,{itemKey:t,isAvailable:!0}),s=r.itemKey;return{isAvailable:r.isAvailable,itemKey:s}})(v);t.TilesLayout.displayName="TilesLayout"});
define("@ms/items-view/lib/private/controls/tilesLayoutControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.tilesLayoutControl=new n.ControlFacet("tilesLayoutControl")});
define("@ms/items-view/lib/private/components/layouts/TilesLayoutTypeFacet",["require","exports","../../models/layouts/LayoutTypeFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.tilesLayoutType=new n.LayoutTypeFacet("tiles")});
define("@ms/items-view/lib/private/components/layoutSwitcher/LayoutSwitcher",["require","exports","tslib","react","react-transition-group","office-ui-fabric-react/lib/Utilities","./LayoutSwitcher.scss","../itemCacheSuspense/ItemCacheSuspense"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(n){var r=e.call(this,n)||this;r._onPreviousLayoutExited=function(){r.setState(t._initialState)};r._async=new s.Async(r);r.state=t._initialState;return r}t.prototype.render=function(){var e=this.state,n=e.transitionPreviousLayout,a=e.transitionCurrentLayout,f=e.previousLayoutClasses,l=e.currentLayoutClasses,c=e.previousLayout,h=e.previousLayoutKey;return r.createElement("div",{className:s.css(o.layoutPositiningContainer,!n&&o.layoutPositiningContainerTransitioning)},c&&h?r.createElement(i.CSSTransition,{key:h,timeout:{enter:0,exit:200},in:n,classNames:f||t._growOutAnimationClassNames,onExited:this._onPreviousLayoutExited},r.createElement("div",{className:o.layoutSwitcherContainer,ref:function(e){t._previousLayoutRef=e}},r.createElement(u.ItemCacheSuspense,{mode:"freeze",fallback:null},c))):null,this.props.children&&this.props.layoutKey?r.createElement(i.CSSTransition,{key:this.props.layoutKey,timeout:{enter:200,exit:0},in:a,classNames:l||t._growOutAnimationClassNames},r.createElement("div",{className:s.css(c&&o.hideLayout,o.layoutSwitcherContainer),ref:function(e){t._currentLayoutRef=e}},r.createElement(u.ItemCacheSuspense,{mode:"none",fallback:null},this.props.children))):null)};t.prototype.UNSAFE_componentWillReceiveProps=function(e){!this.state.previousLayoutKey&&this.props.layoutKey&&e.layoutKey!==this.props.layoutKey?this.setState({previousLayoutKey:this.props.layoutKey,previousLayout:this.props.children,previousLayoutClasses:void 0,currentLayoutClasses:void 0}):this.state.previousLayoutKey&&e.layoutKey&&this.state.previousLayoutKey===e.layoutKey&&this.setState(t._initialState)};t.prototype.componentDidUpdate=function(e,n){var r=this;if(!n.previousLayoutKey&&this.state.previousLayoutKey){this._async.setTimeout(function(){if(t._previousLayoutRef&&t._currentLayoutRef){r._determineTransitionDirection();r.setState({transitionCurrentLayout:!1})}},0);this.setState({transitionPreviousLayout:!1})}};t.prototype.componentWillUnmount=function(){this._async.dispose()};t.prototype._determineTransitionDirection=function(){var e=t._previousLayoutRef,n=t._currentLayoutRef,r=e&&e.clientHeight,i=n&&n.clientHeight;r&&i&&(r<=i?this.setState({previousLayoutClasses:t._growOutAnimationClassNames,currentLayoutClasses:t._shrinkInAnimationClassNames}):this.setState({previousLayoutClasses:t._shrinkInAnimationClassNames,currentLayoutClasses:t._growOutAnimationClassNames}))};t._growOutAnimationClassNames={enter:o.enterAnimationGrowOut,exit:o.exitAnimationGrowOut};t._shrinkInAnimationClassNames={enter:o.enterAnimationShrinkIn,exit:o.exitAnimationShrinkIn};t._initialState={previousLayoutKey:void 0,previousLayout:void 0,transitionPreviousLayout:!0,transitionCurrentLayout:!0};return t}(r.PureComponent);t.LayoutSwitcher=a});
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react"),require("react-dom")):"function"==typeof define&&define.amd?define("react-transition-group",["exports","react","react-dom"],t):t((e=e||self).ReactTransitionGroup={},e.React,e.ReactDOM)}(this,function(e,t,n){"use strict";var r="default"in t?t.default:t,i="default"in n?n.default:n;function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function o(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;e.__proto__=t}function u(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function a(e,t){return e(t={exports:{}},t.exports),t.exports}var f=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable;function h(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}var p=function(){try{if(!Object.assign)return!1;var e=new String("abc");e[5]="de";if("5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e});return"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,r,i=h(e),s=1;s<arguments.length;s++){n=Object(arguments[s]);for(var o in n)l.call(n,o)&&(i[o]=n[o]);if(f){r=f(n);for(var u=0;u<r.length;u++)c.call(n,r[u])&&(i[r[u]]=n[r[u]])}}return i},d="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",v=function(){},m=d,g={};v=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(e){}};var y=function(e,t,n,r,i){for(var s in e)if(e.hasOwnProperty(s)){var o;try{if("function"!=typeof e[s]){var u=Error((r||"React class")+": "+n+" type `"+s+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[s]+"`.");u.name="Invariant Violation";throw u}o=e[s](t,s,r,n,null,m)}catch(e){o=e}!o||o instanceof Error||v((r||"React class")+": type specification of "+n+" `"+s+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof o+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).");if(o instanceof Error&&!(o.message in g)){g[o.message]=!0;var a=i?i():"";v("Failed "+n+" type: "+o.message+(null!=a?a:""))}}},b=function(){};b=function(e){var t="Warning: "+e;"undefined"!=typeof console&&console.error(t);try{throw new Error(t)}catch(e){}};function w(){return null}var E=function(e,t){var n="function"==typeof Symbol&&Symbol.iterator,r="@@iterator";var i="<<anonymous>>",s={array:f("array"),bool:f("boolean"),func:f("function"),number:f("number"),object:f("object"),string:f("string"),symbol:f("symbol"),any:a(w),arrayOf:function(e){return a(function(t,n,r,i,s){if("function"!=typeof e)return new u("Property `"+s+"` of component `"+r+"` has invalid PropType notation inside arrayOf.");var o=t[n];if(!Array.isArray(o)){return new u("Invalid "+i+" `"+s+"` of type `"+c(o)+"` supplied to `"+r+"`, expected an array.")}for(var a=0;a<o.length;a++){var f=e(o,a,r,i,s+"["+a+"]",d);if(f instanceof Error)return f}return null})},element:a(function(t,n,r,i,s){var o=t[n];return e(o)?null:new u("Invalid "+i+" `"+s+"` of type `"+c(o)+"` supplied to `"+r+"`, expected a single ReactElement.")}),instanceOf:function(e){return a(function(t,n,r,s,o){if(!(t[n]instanceof e)){var a=e.name||i;return new u("Invalid "+s+" `"+o+"` of type `"+function(e){if(!e.constructor||!e.constructor.name)return i;return e.constructor.name}(t[n])+"` supplied to `"+r+"`, expected instance of `"+a+"`.")}return null})},node:a(function(e,t,n,r,i){return l(e[t])?null:new u("Invalid "+r+" `"+i+"` supplied to `"+n+"`, expected a ReactNode.")}),objectOf:function(e){return a(function(t,n,r,i,s){if("function"!=typeof e)return new u("Property `"+s+"` of component `"+r+"` has invalid PropType notation inside objectOf.");var o=t[n],a=c(o);if("object"!==a)return new u("Invalid "+i+" `"+s+"` of type `"+a+"` supplied to `"+r+"`, expected an object.");for(var f in o)if(o.hasOwnProperty(f)){var l=e(o,f,r,i,s+"."+f,d);if(l instanceof Error)return l}return null})},oneOf:function(e){if(!Array.isArray(e)){b("Invalid argument supplied to oneOf, expected an instance of array.");return w}return a(function(t,n,r,i,s){for(var a=t[n],f=0;f<e.length;f++)if(o(a,e[f]))return null;return new u("Invalid "+i+" `"+s+"` of value `"+a+"` supplied to `"+r+"`, expected one of "+JSON.stringify(e)+".")})},oneOfType:function(e){if(!Array.isArray(e)){b("Invalid argument supplied to oneOfType, expected an instance of array.");return w}for(var t=0;t<e.length;t++){var n=e[t];if("function"!=typeof n){b("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+v(n)+" at index "+t+".");return w}}return a(function(t,n,r,i,s){for(var o=0;o<e.length;o++){if(null==(0,e[o])(t,n,r,i,s,d))return null}return new u("Invalid "+i+" `"+s+"` supplied to `"+r+"`.")})},shape:function(e){return a(function(t,n,r,i,s){var o=t[n],a=c(o);if("object"!==a)return new u("Invalid "+i+" `"+s+"` of type `"+a+"` supplied to `"+r+"`, expected `object`.");for(var f in e){var l=e[f];if(l){var h=l(o,f,r,i,s+"."+f,d);if(h)return h}}return null})},exact:function(e){return a(function(t,n,r,i,s){var o=t[n],a=c(o);if("object"!==a)return new u("Invalid "+i+" `"+s+"` of type `"+a+"` supplied to `"+r+"`, expected `object`.");var f=p({},t[n],e);for(var l in f){var h=e[l];if(!h)return new u("Invalid "+i+" `"+s+"` key `"+l+"` supplied to `"+r+"`.\nBad object: "+JSON.stringify(t[n],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(e),null,"  "));var v=h(o,l,r,i,s+"."+l,d);if(v)return v}return null})}};function o(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function u(e){this.message=e;this.stack=""}u.prototype=Error.prototype;function a(e){var n={},r=0;function s(s,o,a,f,l,c,h){f=f||i;c=c||a;if(h!==d){if(t){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");p.name="Invariant Violation";throw p}if("undefined"!=typeof console){var v=f+":"+a;if(!n[v]&&r<3){b("You are manually calling a React.PropTypes validation function for the `"+c+"` prop on `"+f+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details.");n[v]=!0;r++}}}return null==o[a]?s?null===o[a]?new u("The "+l+" `"+c+"` is marked as required in `"+f+"`, but its value is `null`."):new u("The "+l+" `"+c+"` is marked as required in `"+f+"`, but its value is `undefined`."):null:e(o,a,f,l,c)}var o=s.bind(null,!1);o.isRequired=s.bind(null,!0);return o}function f(e){return a(function(t,n,r,i,s,o){var a=t[n];if(c(a)!==e){return new u("Invalid "+i+" `"+s+"` of type `"+h(a)+"` supplied to `"+r+"`, expected `"+e+"`.")}return null})}function l(t){switch(typeof t){case"number":case"string":case"undefined":return!0;case"boolean":return!t;case"object":if(Array.isArray(t))return t.every(l);if(null===t||e(t))return!0;var i=function(e){var t=e&&(n&&e[n]||e[r]);if("function"==typeof t)return t}(t);if(!i)return!1;var s,o=i.call(t);if(i!==t.entries){for(;!(s=o.next()).done;)if(!l(s.value))return!1}else for(;!(s=o.next()).done;){var u=s.value;if(u&&!l(u[1]))return!1}return!0;default:return!1}}function c(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":function(e,t){return"symbol"===e||("Symbol"===t["@@toStringTag"]||"function"==typeof Symbol&&t instanceof Symbol)}(t,e)?"symbol":t}function h(e){if(null==e)return""+e;var t=c(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}function v(e){var t=h(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}}s.checkPropTypes=y;s.PropTypes=s;return s},S=a(function(e){var t="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;e.exports=E(function(e){return"object"==typeof e&&null!==e&&e.$$typeof===t},!0)}),x=S.object,T=S.oneOfType,N=S.element,C=S.bool,k=S.func,L=a(function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}}});u(L);var A=a(function(e,t){t.__esModule=!0;t.default=function(e,t){return e.classList?!!t&&e.classList.contains(t):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")};e.exports=t.default});u(A);var O=u(a(function(e,t){t.__esModule=!0;t.default=function(e,t){e.classList?e.classList.add(t):(0,n.default)(e,t)||("string"==typeof e.className?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))};var n=L(A);e.exports=t.default}));function M(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function _(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++){n=s[r];t.indexOf(n)>=0||(i[n]=e[n])}return i}function D(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);null!=e&&this.setState(e)}function P(e){this.setState(function(t){var n=this.constructor.getDerivedStateFromProps(e,t);return null!=n?n:null}.bind(this))}function H(e,t){try{var n=this.props,r=this.state;this.props=e;this.state=t;this.__reactInternalSnapshotFlag=!0;this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(n,r)}finally{this.props=n;this.state=r}}D.__suppressDeprecationWarning=!0;P.__suppressDeprecationWarning=!0;H.__suppressDeprecationWarning=!0;function B(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if("function"!=typeof e.getDerivedStateFromProps&&"function"!=typeof t.getSnapshotBeforeUpdate)return e;var n=null,r=null,i=null;"function"==typeof t.componentWillMount?n="componentWillMount":"function"==typeof t.UNSAFE_componentWillMount&&(n="UNSAFE_componentWillMount");"function"==typeof t.componentWillReceiveProps?r="componentWillReceiveProps":"function"==typeof t.UNSAFE_componentWillReceiveProps&&(r="UNSAFE_componentWillReceiveProps");"function"==typeof t.componentWillUpdate?i="componentWillUpdate":"function"==typeof t.UNSAFE_componentWillUpdate&&(i="UNSAFE_componentWillUpdate");if(null!==n||null!==r||null!==i){var s=e.displayName||e.name,o="function"==typeof e.getDerivedStateFromProps?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error("Unsafe legacy lifecycles will not be called for components using new component APIs.\n\n"+s+" uses "+o+" but also contains the following legacy lifecycles:"+(null!==n?"\n  "+n:"")+(null!==r?"\n  "+r:"")+(null!==i?"\n  "+i:"")+"\n\nThe above lifecycles should be removed. Learn more about this warning here:\nhttps://fb.me/react-async-component-lifecycle-hooks")}if("function"==typeof e.getDerivedStateFromProps){t.componentWillMount=D;t.componentWillReceiveProps=P}if("function"==typeof t.getSnapshotBeforeUpdate){if("function"!=typeof t.componentDidUpdate)throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=H;var u=t.componentDidUpdate;t.componentDidUpdate=function(e,t,n){var r=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:n;u.call(this,e,t,r)}}return e}var j=S.oneOfType([S.number,S.shape({enter:S.number,exit:S.number,appear:S.number}).isRequired]),F=S.oneOfType([S.string,S.shape({enter:S.string,exit:S.string,active:S.string}),S.shape({enter:S.string,enterDone:S.string,enterActive:S.string,exit:S.string,exitDone:S.string,exitActive:S.string})]),I="unmounted",q="exited",R="entering",U="entered",z=function(e){o(t,e);function t(t,n){var r;r=e.call(this,t,n)||this;var i,s=n.transitionGroup,o=s&&!s.isMounting?t.enter:t.appear;r.appearStatus=null;if(t.in)if(o){i=q;r.appearStatus=R}else i=U;else i=t.unmountOnExit||t.mountOnEnter?I:q;r.state={status:i};r.nextCallback=null;return r}var n=t.prototype;n.getChildContext=function(){return{transitionGroup:null}};t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===I?{status:q}:null};n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)};n.componentDidUpdate=function(e){var t=null;if(e!==this.props){var n=this.state.status;this.props.in?n!==R&&n!==U&&(t=R):n!==R&&n!==U||(t="exiting")}this.updateStatus(!1,t)};n.componentWillUnmount=function(){this.cancelNextCallback()};n.getTimeouts=function(){var e,t,n,r=this.props.timeout;e=t=n=r;if(null!=r&&"number"!=typeof r){e=r.exit;t=r.enter;n=void 0!==r.appear?r.appear:t}return{exit:e,enter:t,appear:n}};n.updateStatus=function(e,t){void 0===e&&(e=!1);if(null!==t){this.cancelNextCallback();var n=i.findDOMNode(this);t===R?this.performEnter(n,e):this.performExit(n)}else this.props.unmountOnExit&&this.state.status===q&&this.setState({status:I})};n.performEnter=function(e,t){var n=this,r=this.props.enter,i=this.context.transitionGroup?this.context.transitionGroup.isMounting:t,s=this.getTimeouts(),o=i?s.appear:s.enter;if(t||r){this.props.onEnter(e,i);this.safeSetState({status:R},function(){n.props.onEntering(e,i);n.onTransitionEnd(e,o,function(){n.safeSetState({status:U},function(){n.props.onEntered(e,i)})})})}else this.safeSetState({status:U},function(){n.props.onEntered(e)})};n.performExit=function(e){var t=this,n=this.props.exit,r=this.getTimeouts();if(n){this.props.onExit(e);this.safeSetState({status:"exiting"},function(){t.props.onExiting(e);t.onTransitionEnd(e,r.exit,function(){t.safeSetState({status:q},function(){t.props.onExited(e)})})})}else this.safeSetState({status:q},function(){t.props.onExited(e)})};n.cancelNextCallback=function(){if(null!==this.nextCallback){this.nextCallback.cancel();this.nextCallback=null}};n.safeSetState=function(e,t){t=this.setNextCallback(t);this.setState(e,t)};n.setNextCallback=function(e){var t=this,n=!0;this.nextCallback=function(r){if(n){n=!1;t.nextCallback=null;e(r)}};this.nextCallback.cancel=function(){n=!1};return this.nextCallback};n.onTransitionEnd=function(e,t,n){this.setNextCallback(n);var r=null==t&&!this.props.addEndListener;if(e&&!r){this.props.addEndListener&&this.props.addEndListener(e,this.nextCallback);null!=t&&setTimeout(this.nextCallback,t)}else setTimeout(this.nextCallback,0)};n.render=function(){var e=this.state.status;if(e===I)return null;var t=this.props,n=t.children,i=_(t,["children"]);delete i.in;delete i.mountOnEnter;delete i.unmountOnExit;delete i.appear;delete i.enter;delete i.exit;delete i.timeout;delete i.addEndListener;delete i.onEnter;delete i.onEntering;delete i.onEntered;delete i.onExit;delete i.onExiting;delete i.onExited;if("function"==typeof n)return n(e,i);var s=r.Children.only(n);return r.cloneElement(s,i)};return t}(r.Component);z.contextTypes={transitionGroup:x};z.childContextTypes={transitionGroup:function(){}};z.propTypes={children:T([k.isRequired,N.isRequired]).isRequired,in:C,mountOnEnter:C,unmountOnExit:C,appear:C,enter:C,exit:C,timeout:function(e){var t=j;e.addEndListener||(t=t.isRequired);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return t.apply(void 0,[e].concat(r))},addEndListener:k,onEnter:k,onEntering:k,onEntered:k,onExit:k,onExiting:k,onExited:k};function W(){}z.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:W,onEntering:W,onEntered:W,onExit:W,onExiting:W,onExited:W};z.UNMOUNTED=0;z.EXITED=1;z.ENTERING=2;z.ENTERED=3;z.EXITING=4;var X=B(z),V=function(e,t){return e&&t&&t.split(" ").forEach(function(t){return O(e,t)})},$=function(e,t){return e&&t&&t.split(" ").forEach(function(t){return r=t,void((n=e).classList?n.classList.remove(r):"string"==typeof n.className?n.className=M(n.className,r):n.setAttribute("class",M(n.className&&n.className.baseVal||"",r)));var n,r})},J=function(e){o(t,e);function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=e.call.apply(e,[this].concat(r))||this).onEnter=function(e,n){var r=t.getClassNames(n?"appear":"enter").className;t.removeClasses(e,"exit");V(e,r);t.props.onEnter&&t.props.onEnter(e,n)};t.onEntering=function(e,n){var r=t.getClassNames(n?"appear":"enter").activeClassName;t.reflowAndAddClass(e,r);t.props.onEntering&&t.props.onEntering(e,n)};t.onEntered=function(e,n){var r=t.getClassNames("appear").doneClassName,i=t.getClassNames("enter").doneClassName,s=n?r+" "+i:i;t.removeClasses(e,n?"appear":"enter");V(e,s);t.props.onEntered&&t.props.onEntered(e,n)};t.onExit=function(e){var n=t.getClassNames("exit").className;t.removeClasses(e,"appear");t.removeClasses(e,"enter");V(e,n);t.props.onExit&&t.props.onExit(e)};t.onExiting=function(e){var n=t.getClassNames("exit").activeClassName;t.reflowAndAddClass(e,n);t.props.onExiting&&t.props.onExiting(e)};t.onExited=function(e){var n=t.getClassNames("exit").doneClassName;t.removeClasses(e,"exit");V(e,n);t.props.onExited&&t.props.onExited(e)};t.getClassNames=function(e){var n=t.props.classNames,r="string"==typeof n,i=r?(r&&n?n+"-":"")+e:n[e];return{className:i,activeClassName:r?i+"-active":n[e+"Active"],doneClassName:r?i+"-done":n[e+"Done"]}};return t}var n=t.prototype;n.removeClasses=function(e,t){var n=this.getClassNames(t),r=n.className,i=n.activeClassName,s=n.doneClassName;r&&$(e,r);i&&$(e,i);s&&$(e,s)};n.reflowAndAddClass=function(e,t){if(t){e&&e.scrollTop;V(e,t)}};n.render=function(){var e=s({},this.props);delete e.classNames;return r.createElement(X,s({},e,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))};return t}(r.Component);J.defaultProps={classNames:""};J.propTypes=s({},X.propTypes,{classNames:F,onEnter:k,onEntering:k,onEntered:k,onExit:k,onExiting:k,onExited:k});function K(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Q(e,n){var r=Object.create(null);e&&t.Children.map(e,function(e){return e}).forEach(function(e){r[e.key]=function(e){return n&&t.isValidElement(e)?n(e):e}(e)});return r}function G(e,t,n){return null!=n[t]?n[t]:e.props[t]}function Y(e,n,r){var i=Q(e.children),s=function(e,t){e=e||{};t=t||{};function n(n){return n in t?t[n]:e[n]}var r,i=Object.create(null),s=[];for(var o in e)if(o in t){if(s.length){i[o]=s;s=[]}}else s.push(o);var u={};for(var a in t){if(i[a])for(r=0;r<i[a].length;r++){var f=i[a][r];u[i[a][r]]=n(f)}u[a]=n(a)}for(r=0;r<s.length;r++)u[s[r]]=n(s[r]);return u}(n,i);Object.keys(s).forEach(function(o){var u=s[o];if(t.isValidElement(u)){var a=o in n,f=o in i,l=n[o],c=t.isValidElement(l)&&!l.props.in;!f||a&&!c?f||!a||c?f&&a&&t.isValidElement(l)&&(s[o]=t.cloneElement(u,{onExited:r.bind(null,u),in:l.props.in,exit:G(u,"exit",e),enter:G(u,"enter",e)})):s[o]=t.cloneElement(u,{in:!1}):s[o]=t.cloneElement(u,{onExited:r.bind(null,u),in:!0,exit:G(u,"exit",e),enter:G(u,"enter",e)})}});return s}var Z=Object.values||function(e){return Object.keys(e).map(function(t){return e[t]})},ee=function(e){o(n,e);function n(t,n){var r,i=(r=e.call(this,t,n)||this).handleExited.bind(K(K(r)));r.state={handleExited:i,firstRender:!0};return r}var i=n.prototype;i.getChildContext=function(){return{transitionGroup:{isMounting:!this.appeared}}};i.componentDidMount=function(){this.appeared=!0;this.mounted=!0};i.componentWillUnmount=function(){this.mounted=!1};n.getDerivedStateFromProps=function(e,n){var r,i,s=n.children,o=n.handleExited;return{children:n.firstRender?(r=e,i=o,Q(r.children,function(e){return t.cloneElement(e,{onExited:i.bind(null,e),in:!0,appear:G(e,"appear",r),enter:G(e,"enter",r),exit:G(e,"exit",r)})})):Y(e,s,o),firstRender:!1}};i.handleExited=function(e,t){var n=Q(this.props.children);if(!(e.key in n)){e.props.onExited&&e.props.onExited(t);this.mounted&&this.setState(function(t){var n=s({},t.children);delete n[e.key];return{children:n}})}};i.render=function(){var e=this.props,t=e.component,n=e.childFactory,i=_(e,["component","childFactory"]),s=Z(this.state.children).map(n);delete i.appear;delete i.enter;delete i.exit;return null===t?s:r.createElement(t,i,s)};return n}(r.Component);ee.childContextTypes={transitionGroup:S.object.isRequired};ee.propTypes={component:S.any,children:S.node,appear:S.bool,enter:S.bool,exit:S.bool,childFactory:S.func};ee.defaultProps={component:"div",childFactory:function(e){return e}};var te=B(ee),ne=function(e){o(t,e);function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=e.call.apply(e,[this].concat(r))||this).handleEnter=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onEnter",0,n)};t.handleEntering=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onEntering",0,n)};t.handleEntered=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onEntered",0,n)};t.handleExit=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onExit",1,n)};t.handleExiting=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onExiting",1,n)};t.handleExited=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.handleLifecycle("onExited",1,n)};return t}var i=t.prototype;i.handleLifecycle=function(e,t,i){var s,o=this.props.children,u=r.Children.toArray(o)[t];u.props[e]&&(s=u.props)[e].apply(s,i);this.props[e]&&this.props[e](n.findDOMNode(this))};i.render=function(){var e=this.props,t=e.children,n=e.in,i=_(e,["children","in"]),s=r.Children.toArray(t),o=s[0],u=s[1];delete i.onEnter;delete i.onEntering;delete i.onEntered;delete i.onExit;delete i.onExiting;delete i.onExited;return r.createElement(te,i,n?r.cloneElement(o,{key:"first",onEnter:this.handleEnter,onEntering:this.handleEntering,onEntered:this.handleEntered}):r.cloneElement(u,{key:"second",onEnter:this.handleExit,onEntering:this.handleExiting,onEntered:this.handleExited}))};return t}(r.Component);ne.propTypes={in:S.bool.isRequired,children:function(e,t){return 2!==r.Children.count(e[t])?new Error('"'+t+'" must be exactly two transition components.'):null}};e.CSSTransition=J;e.ReplaceTransition=ne;e.Transition=X;e.TransitionGroup=te;Object.defineProperty(e,"__esModule",{value:!0})});
define("@ms/items-view/lib/private/components/layoutSwitcher/LayoutSwitcher.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".layoutSwitcherContainer_ddf7dac2{opacity:1;-webkit-transform-origin:top;transform-origin:top;-webkit-transform:scaleY(1);transform:scaleY(1);-webkit-transition:opacity .167s cubic-bezier(0.1, 0.25, 0.75, 0.9),-webkit-transform .167s cubic-bezier(0.1, 0.25, 0.75, 0.9);transition:opacity .167s cubic-bezier(0.1, 0.25, 0.75, 0.9),-webkit-transform .167s cubic-bezier(0.1, 0.25, 0.75, 0.9);transition:opacity .167s cubic-bezier(0.1, 0.25, 0.75, 0.9),transform .167s cubic-bezier(0.1, 0.25, 0.75, 0.9);transition:opacity .167s cubic-bezier(0.1, 0.25, 0.75, 0.9),transform .167s cubic-bezier(0.1, 0.25, 0.75, 0.9),-webkit-transform .167s cubic-bezier(0.1, 0.25, 0.75, 0.9);width:100%}.layoutPositiningContainer_ddf7dac2{position:relative}.layoutPositiningContainerTransitioning_ddf7dac2{overflow:hidden}.hideLayout_ddf7dac2{position:absolute;top:0;opacity:0;-webkit-transform:scaleY(1);transform:scaleY(1);-webkit-transition:opacity .167s cubic-bezier(0.1, 0.25, 0.75, 0.9),-webkit-transform .167s cubic-bezier(0.1, 0.25, 0.75, 0.9);transition:opacity .167s cubic-bezier(0.1, 0.25, 0.75, 0.9),-webkit-transform .167s cubic-bezier(0.1, 0.25, 0.75, 0.9);transition:opacity .167s cubic-bezier(0.1, 0.25, 0.75, 0.9),transform .167s cubic-bezier(0.1, 0.25, 0.75, 0.9);transition:opacity .167s cubic-bezier(0.1, 0.25, 0.75, 0.9),transform .167s cubic-bezier(0.1, 0.25, 0.75, 0.9),-webkit-transform .167s cubic-bezier(0.1, 0.25, 0.75, 0.9)}.enterAnimationGrowOut_ddf7dac2{opacity:0;-webkit-transform:scaleY(1.1);transform:scaleY(1.1)}.exitAnimationGrowOut_ddf7dac2{opacity:0;-webkit-transform:scaleY(1.1);transform:scaleY(1.1)}.enterAnimationShrinkIn_ddf7dac2{opacity:0;-webkit-transform:scaleY(0.9);transform:scaleY(0.9)}.exitAnimationShrinkIn_ddf7dac2{opacity:0;-webkit-transform:scaleY(0.9);transform:scaleY(0.9)}\n"}]);t.layoutSwitcherContainer="layoutSwitcherContainer_ddf7dac2";t.layoutPositiningContainer="layoutPositiningContainer_ddf7dac2";t.layoutPositiningContainerTransitioning="layoutPositiningContainerTransitioning_ddf7dac2";t.hideLayout="hideLayout_ddf7dac2";t.enterAnimationGrowOut="enterAnimationGrowOut_ddf7dac2";t.exitAnimationGrowOut="exitAnimationGrowOut_ddf7dac2";t.enterAnimationShrinkIn="enterAnimationShrinkIn_ddf7dac2";t.exitAnimationShrinkIn="exitAnimationShrinkIn_ddf7dac2"});
define("@ms/items-view/lib/private/components/itemsError/ItemError",["require","exports","react","office-ui-fabric-react/lib/Button","../../models/error/ErrorStrings.resx","./ItemError.scss","../withLayoutRenderComplete/WithLayoutRenderComplete","../../controls/itemErrorControl","../decorators/withResponsiveMode","../../store/actions/implementOperation","../../models/Facet","../../facets/ErrorFacets","../withAction/WithAction","../actions/retry/RetryAction","../../models/itemsScope/getCurrentError","../withItemCache/WithItemCache"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=3;function g(){return"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-react-assets/images/error/error"+(Math.floor(Math.random()*m)+1)+".svg"}var y={small:140,large:208};t.ErrorBase=a.withResponsiveMode()(function(e){var t=e.error,r=e.onError,o=e.title,u=e.subText,f=e.errorImageUrl,l=e.errorDetailsContent,c=e.actions,h=e.responsiveMode;n.useLayoutEffect(function(){r&&r()},[]);var p=h?h>a.ResponsiveMode.large?"large":"small":"large",d=y[p];return n.createElement("div",{className:s.itemError},f?n.createElement("div",{className:s.itemErrorImageContainer,style:{height:d+"px",width:d+"px"}},n.createElement("img",{className:s.itemErrorImage,src:f})):null,n.createElement("div",{className:s.itemErrorTitle},o||i.default.DefaultTitle),l?n.createElement("div",{className:s.itemErrorMessage},l):n.createElement("div",{className:s.itemErrorMessage},u||t.message||i.default.DefaultSubText),c?n.createElement("div",{className:s.itemErrorActions},c):null)});t.ItemError=function(e){var s=e.itemKey,a=n.useState(g)[0],m=n.useCallback(function(e){var v=e.itemCache,m=v.dispatch,g=d.getCurrentError(v),y=g.error,b=g.isItemsScopeError;if(!y)return null;var w,E,S=v.demandItemFacet(u.itemErrorControl,b?void 0:s),x=u.itemErrorControl.evaluate(S)(v,{itemKey:s,error:y,errorRenderer:t.ErrorBase}),T=x.errorRenderer,N=x.onError,C=N&&s?function(){m(N({itemKey:s,error:y}))}:void 0;if(y instanceof f.ItemOperationError){var k=l.unpack({accessDeniedError:c.accessDeniedErrorFacet,itemNotFoundError:c.itemNotFoundErrorFacet,offlineError:c.offlineErrorFacet},y.facets),L=k.accessDeniedError,A=k.itemNotFoundError,O=k.offlineError;if(L||A){w=i.default.ItemNotFoundTitle;E=i.default.ItemNotFoundSubText}else O&&(E=i.default.offlineActionFailed)}return n.createElement(o.WithLayoutRenderComplete,{isDataReadyForLayout:!!y,itemKey:s},n.createElement(T,{error:y,itemKey:s,onError:C,title:w,subText:E,errorImageUrl:a,actions:n.createElement(h.WithAction,{action:n.createElement(p.RetryAction,null)},function(e){var t=e.isAvailable,s=e.execute;return t?n.createElement(r.DefaultButton,{text:i.default.retryButtonLabel,onClick:function(e){s({event:e}).catch()}}):null})}))},[s]);return n.createElement(v.WithItemCache,null,m)}});
define("@ms/items-view/lib/private/components/itemsError/ItemError.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".itemError_58a93e79{text-align:center}.itemErrorImageContainer_58a93e79{padding-top:52px;margin:0 auto}.itemErrorImage_58a93e79{height:100%;width:100%}.itemErrorTitle_58a93e79{padding:16px 16px 0px 16px;font-size:21px;font-weight:100;max-width:400px;color:#666;margin:0 auto}.itemErrorMessage_58a93e79{padding:6px 16px 0px 16px;font-size:14px;font-weight:400;max-width:400px;color:#666;margin:0 auto}.itemErrorMessage_58a93e79 a{color:#0078d4;text-decoration:none}.itemErrorMessage_58a93e79 a:hover,.itemErrorMessage_58a93e79 a:focus{color:#004578}.itemErrorActions_58a93e79{margin-top:16px}\n"}]);t.itemError="itemError_58a93e79";t.itemErrorImageContainer="itemErrorImageContainer_58a93e79";t.itemErrorImage="itemErrorImage_58a93e79";t.itemErrorTitle="itemErrorTitle_58a93e79";t.itemErrorMessage="itemErrorMessage_58a93e79";t.itemErrorActions="itemErrorActions_58a93e79"});
define("@ms/items-view/lib/private/components/withLayoutRenderComplete/WithLayoutRenderComplete",["require","exports","react","../decorators/withLayoutRenderComplete"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WithLayoutRenderComplete=r.withLayoutRenderComplete()(n.Fragment)});
define("@ms/items-view/lib/private/controls/itemErrorControl",["require","exports","../models/controls/ControlFacet","../components/controls/defaultRenderComponentControlOption"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemErrorControl=new n.ControlFacet("itemErrorControl",{errorRenderer:r.defaultRenderComponentOption()})});
define("@ms/items-view/lib/private/components/decorators/withResponsiveMode",["require","exports","office-ui-fabric-react/lib/utilities/decorators/withResponsiveMode"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ResponsiveMode=n.ResponsiveMode;t.setResponsiveMode=n.setResponsiveMode;t.withResponsiveMode=function(){return function(e){var t=e;return n.withResponsiveMode(t)}}});
define("@ms/items-view/lib/private/facets/ErrorFacets",["require","exports","../models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.httpStatusErrorFacet=new n.Facet("httpStatus");t.conflictErrorFacet=new n.Facet("conflict");t.offlineErrorFacet=new n.Facet("offlineError");t.accessDeniedErrorFacet=new n.Facet("accessDeniedError");t.retryErrorFacet=new n.Facet("retryError");t.fileNotFoundErrorFacet=new n.Facet("fileNotFound");t.invalidNameErrorFacet=new n.Facet("invalidNameError");t.fileSizeErrorFacet=new n.Facet("fileSizeError");t.emptyFolderUnsupportedFacet=new n.Facet("emptyFolderUnsupported");t.overQuotaErrorFacet=new n.Facet("overQuotaError");t.lockMismatchErrorFacet=new n.Facet("lockMismatchError");t.authFailureErrorFacet=new n.Facet("authFailureError");t.folderUploadUnsupportedFacet=new n.Facet("folderUploadUnsupported");t.targetFolderErrorFacet=new n.Facet("targetFolderError");t.malwareErrorFacet=new n.Facet("malwareError");t.throttleErrorFacet=new n.Facet("throttleError");t.versionMismatchFacet=new n.Facet("versionMismatch");t.itemNotFoundErrorFacet=t.fileNotFoundErrorFacet});
define("@ms/items-view/lib/private/components/actions/retry/RetryAction",["require","exports","tslib","react","../../action/Action","../../withItemCache/WithItemCache","../../../operations/resetItems","../../decorators/selectors","../../../models/telemetry/getItemEngagement","../../decorators/connectToItemsScope","../../../operations/selectItems","../../../models/itemsScope/getCurrentError"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";var h=this;Object.defineProperty(t,"__esModule",{value:!0});var p=function(){return n.__awaiter(h,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})})},d=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,u=t.itemKey,h=n.__rest(t,["itemKey"]);return r.createElement(s.WithItemCache,null,function(t){var s=t.itemCache,d=t.dispatch,v=f.getItemsScope(s).itemsScopeItemKey,m=!!c.getCurrentError(s,{itemKey:u}),g=u?function(){return n.__awaiter(e,void 0,void 0,function(){var e,t;return n.__generator(this,function(r){switch(r.label){case 0:v&&d(l.clearSelection({itemsScopeItemKey:v}));return[4,d(o.resetItems({items:n.__assign((e={},e[u]=!0,e),v?(t={},t[v]=!0,t):{})}))];case 1:r.sent();return[2]}})})}:p;return r.createElement(i.Action,n.__assign({},h,{isAvailable:m,onExecute:g},a.getItemActionEngagement(s,{itemKey:u,engagement:{name:"Retry",isIntentional:!0}})))})};return t}(r.PureComponent);t.ItemRetryAction=d;t.RetryAction=u.withCurrentItemSet()(d)});
define("@ms/items-view/lib/private/models/itemsScope/getCurrentError",["require","exports","./getItemsScope","./getCurrentItemSetKey","../../facets/DemandFacets"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getCurrentError=function(e,t){void 0===t&&(t={});var s=t.itemKey,o=void 0===s?r.getCurrentItemSetKey(e):s,u=n.getItemsScope(e).itemsScopeItemKey,a=e.isItemFacetResolved(i.errorFacet,u)?e.demandItemFacet(i.errorFacet,u):void 0,f=e.isItemFacetResolved(i.errorFacet,o)?e.demandItemFacet(i.errorFacet,o):void 0;return{error:a||f,isItemsScopeError:!!a}}});
define("@ms/items-view/lib/private/controls/itemsViewControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemsViewControl=new n.ControlFacet("itemsViewControl")});
define("@ms/items-view/lib/private/components/pageLoadTracker/PageLoadTracker",["require","exports","tslib","react","../../operations/pageLoad","../decorators/connectToItemCache","../decorators/connectToItemsScope","../../utilities/components/RenderProps","../telemetry/TelemetryProvider","@ms/telemetry-manager/lib/events/Qos.event","@ms/utilities-error/lib/ApiError","../../models/telemetry/getItemEngagement","@ms/telemetry-manager/lib/events/Engagement.event","../decorators/withLayoutRenderComplete","../../utilities/Graft","../../utilities/performance","../../models/itemsScope/getCurrentItemKey","@uifabric/utilities/lib/Async","../../utilities/async/CancelError","../../hooks/useEventHandler","../../facets/ScopeFacets","../../models/itemsScope/getCurrentError","../../utilities/async/TimeoutError"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function x(e){var t=e.error,n=e.values,i=e.onLoadItemEnd,s=r.useRef(),o=r.useRef(),u=(n[""]||p.INITIAL_LAYOUT_TRACKER_STATE).layouts,a=Object.keys(u),f=a.length>0&&a.every(function(e){var t=u[e];return t.isReady&&!!t.endTime})||!!t,l=o.current;i!==l&&(s.current=void 0);var c=s.current;s.current=f;r.useLayoutEffect(function(){var e=new g.Async(void 0);if(f&&!c&&i){e.setTimeout(function(){i({endTime:v.now(),error:t})},0);return function(){e.dispose()}}},[f,i]);return null}var T=0;t.PageLoadTracker=s.connectToItemCache(function(e,t){var n=t.qosName,r=o.getItemsScope(e).itemsScopeItemKey;if(!r)throw new Error("Cannot use PageLoadTracker outside of an ItemsScope.");var s=e.demandItemFacet(w.currentItemFacet,r),u=s&&s.itemKey,a=m.getCurrentItemKey(e),f=E.getCurrentError(e).error,l=c.getItemActionEngagement(e,{itemKey:a,engagement:{name:n,isIntentional:!1}}),h=l.engagement,p=l.getEngagement,d=i.isPageLoaded(e);return{itemKey:u,error:f,engagement:h,getEngagement:p,pageLoaded:d}})(a.withTelemetry()(function(e){var t=r.useState(function(){return++T})[0],i=r.useRef(),s=r.useRef(),o=s.current,a=e.itemKey,c=e.qosName,m=e.pageLoaded,g=e.onLoadItem,w=e.telemetry,E=e.engagement,N=e.getEngagement,C=i.current;i.current=a;var k={isInitialLoad:!m},L=b.useEventHandler(function(){(function(e,t,r,i){return n.__awaiter(this,void 0,void 0,function(){var s,o,u,a;return n.__generator(this,function(f){switch(f.label){case 0:o=d.graft;return r?[4,r()]:[3,2];case 1:u=f.sent();return[3,3];case 2:u={};f.label=3;case 3:s=o.apply(void 0,[u,n.__assign({},t,{extraData:i})]);a=s.name;e(h.Engagement).withData(function(e){return n.__assign({},e,s)}).logData({name:a});return[2]}})})})(w,E,N,k).catch()});if(a!==C||!o){var A=v.now();o&&!o.completed&&o({endTime:A,error:new y.CancelError({message:"Interrupted"})});var O=new(e.telemetry(f.Qos))({name:c,extraData:k});!function(e,t){v.mark(t+" "+e+" start")}(t,c);var M=g?g({itemKey:a,previousItemKey:C,startTime:A}):void 0,_=function(e){if(!_.completed){_.completed=!0;var r=e.error;!function(e,t,n){v.mark(t+" "+e+" end");try{v.measure(t+" ("+n+")",t+" "+e+" start",t+" "+e+" end")}catch(e){}}(t,c,r?r instanceof y.CancelError?"Interrupted":"Failed":"Succeeded");!function(e,t){e.end(n.__assign({resultType:t?f.ResultTypeEnum.Failure:f.ResultTypeEnum.Success,error:t&&t.message,resultCode:t&&t.name},t instanceof y.CancelError?{resultCode:t.message,resultType:f.ResultTypeEnum.ExpectedFailure}:{},t instanceof S.TimeoutError?{resultCode:t.message}:{},t instanceof l.ApiError?{resultCode:t.code,resultType:t.isExpected?f.ResultTypeEnum.ExpectedFailure:f.ResultTypeEnum.Failure}:{},{extraData:n.__assign({},e.data.extraData||{},t instanceof l.ApiError?{correlationId:t.correlationId}:{},t instanceof S.TimeoutError?{timeout:t.timeout}:{})}))}(O,r);M&&M(e);L()}};s.current=_}var D=s.current;return r.createElement(p.LAYOUT_TRACKER_RELAY.Receiver,{values:{"":u.renderChildrenWithProps(e.children,{})}},function(t){var i=t.values;return r.createElement(x,n.__assign({},e,{values:i,onLoadItemEnd:D}))})}))});
define("@ms/items-view/lib/private/models/itemsScope/getCurrentItemKey",["require","exports","../../facets/ScopeFacets","../items/getItemKey","./getItemsScope"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getCurrentItemKey=function(e){var t=i.getItemsScope(e).itemsScopeItemKey,s=e.demandItemFacet(n.currentItemFacet,t);return r.getItemKey(e,{itemKey:s&&s.itemKey})}});
define("@ms/items-view/lib/private/components/itemsEmptyFolder/ItemEmptyFolder",["require","exports","react","./EmptyFolder","../../controls/emptyFolderControl","../withItemCache/WithItemCache","../../facets/SetFacets","../../controls/childItemsControl"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function a(e){var t=e.itemKey;return n.createElement(s.WithItemCache,null,function(e){var s=e.itemCache,a=s.isItemFacetResolved(o.childItemsFacet,t)?s.demandItemFacet(o.childItemsFacet,t):void 0,f=s.demandItemFacet(u.childItemsControl,t),l=u.childItemsControl.evaluate(f)(s,{itemKey:t,itemKeys:a&&a.itemKeys}).itemKeys;if(!(!!l&&0===l.length)||!t)return null;var c=s.demandItemFacet(i.emptyFolderControl,t),h=i.emptyFolderControl.evaluate(c)(s,{itemKey:t,emptyFolderAs:r.EmptyFolderBase}),p=h.emptyFolderIconUrl,d=h.emptyFolderTitle,v=h.getStyles,m=h.emptyFolderAs;return n.createElement(m,{itemKey:t,emptyFolderIconUrl:p,emptyFolderTitle:d,styles:v})})}t.ItemEmptyFolder=a;t.EmptyFolder=a});
define("@ms/items-view/lib/private/components/itemsEmptyFolder/EmptyFolder",["require","exports","tslib","react","../cache/emptyFolder/EmptyFolder.resx","./EmptyFolder.styles","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Styling"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o.classNamesFunction(),f=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.emptyFolderIconUrl,n=e.emptyFolderTitle,s=e.theme,o=e.styles,f=a(o,{theme:s||u.getTheme()});return r.createElement("div",{className:f.root,"data-automationid":"emptyFolderContainer"},r.createElement("div",{className:f.emptyFolderImageContainer},r.createElement("img",{className:f.emptyFolderImage,src:t||"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-react-assets/images/emptyfolder/empty_folder.svg",alt:i.default.emptyFolderDefaultAltText})),r.createElement("div",{className:f.emptyFolderTitle},n||i.default.emptyFolderTitle))};return t}(r.PureComponent);t.EmptyFolderBase=o.styled(f,s.getStyles)});
define("@ms/items-view/lib/private/components/itemsEmptyFolder/EmptyFolder.styles",["require","exports","tslib"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=function(e){var t=e.theme,r=t.fonts,i=t.palette;return{root:{textAlign:"center",paddingTop:"52px",paddingBottom:"174px"},emptyFolderImageContainer:{margin:"0 auto",height:"208px",width:"208px"},emptyFolderImage:{width:"100%",height:"100%"},emptyFolderTitle:n.__assign({padding:"16px 16px 0px 16px"},r.xLarge,{maxWidth:"400px",color:""+i.neutralSecondary,margin:"0 auto"})}}});
define("@ms/items-view/lib/private/controls/emptyFolderControl",["require","exports","../models/controls/ControlFacet","../components/controls/defaultRenderComponentControlOption"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.emptyFolderControl=new n.ControlFacet("emptyFolderControl",{emptyFolderAs:r.defaultRenderComponentOption()})});
define("odsp-next/controls/itemsScope/ItemSetDetailsListControlHandler",["require","exports","@ms/odsp-utilities/lib/resources/Resources","office-ui-fabric-react/lib/DetailsList"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:{},create:function(e){return{instance:function(e,t){return{constrainMode:r.ConstrainMode.unconstrained,listProps:{renderedWindowsAhead:2,renderedWindowsBehind:2}}}}}}})});
define("odsp-next/controls/itemsScope/ItemSetTilesListControlHandler",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@microsoft/load-themed-styles"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=!1;t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:{},create:function(e){return{instance:function(e,t){if(!i){i=!0;r.flush()}return{}}}}}})});
define("@ms/items-view/lib/private/controls/itemSetTilesListControl",["require","exports","../models/controls/ControlFacet","../components/controls/defaultRenderComponentControlOption","../models/controls/graftControlOption"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemSetTilesListTileControl=new n.ControlFacet("itemSetTilesListTileControl");t.itemSetTilesListGroupControl=new n.ControlFacet("itemSetTilesListGroupControl",{tileRenderer:r.defaultRenderComponentOption(),headerRenderer:r.defaultRenderComponentOption(),tileControlHandler:n.childControlOption(t.itemSetTilesListTileControl),grid:i.graftControlOption()});t.itemSetTilesListControl=new n.ControlFacet("itemSetTilesListControl",{groupControlHandler:n.childControlOption(t.itemSetTilesListGroupControl),tileRenderer:r.defaultRenderComponentOption(),tileControlHandler:n.childControlOption(t.itemSetTilesListTileControl),grid:i.graftControlOption()})});
define("odsp-next/controls/itemContent/itemsScope/ItemContentControl",["require","exports","@ms/items-view/lib/private/models/controls/ControlFacet","@ms/items-view/lib/private/components/controls/defaultRenderComponentControlOption"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemContentControl=new n.ControlFacet("itemContent",{headerContentAs:r.defaultRenderComponentOption(),itemsViewContentAs:r.defaultRenderComponentOption(),transclusionContentAs:r.defaultRenderComponentOption()})});
define("odsp-next/controls/itemsScope/CurrentItemsScope",["require","exports","tslib","react","prop-types","@ms/odsp-shared-react/lib/utilities/resources/Resources","@ms/odsp-utilities/lib/resources/Resources","@ms/items-view/lib/private/components/itemsScope/ItemsScope","./ItemsScopeItemKey","../../controls/base/react/WithResources","../../models/itemCache/ItemCacheStore"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t,n){return e.call(this,t,n)||this}t.prototype.getChildContext=function(){return{currentItemsScope:this.context.dependencies.itemsScopeItemKey}};t.prototype.render=function(){var e=r.createElement(f.ResourcesContextProvider,{resources:this.context.dependencies.resources},this.props.children);return this.context.currentItemsScope?e:r.createElement(u.ItemsScope,{store:this.context.dependencies.itemCacheStore,itemsScopeItemKey:this.context.dependencies.itemsScopeItemKey},e)};t.contextTypes=n.__assign({},s.RESOLVED_COMPONENT_CONTEXT_TYPES,{currentItemsScope:i.string});t.childContextTypes={currentItemsScope:i.string};return t}(r.PureComponent);t.CurrentItemsScope=c;t.resourceKey=s.createResolvedComponentTypeResourceKey(e("module").id,c,{itemsScopeItemKey:a.resourceKey,itemCacheStore:l.resourceKey,resources:o.resourceScopeKey})});
define("odsp-next/controls/itemsScope/ItemsScopeItemKey",["require","exports","../../models/itemsScope/ItemsScopeManager.key","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id,factory:{dependencies:{itemsScopeManager:n.resourceKey},create:function(e){return{instance:e.itemsScopeManager.itemsScopeItemKey}}}})});
define("odsp-next/controls/itemContent/itemsScope/ItemContentControlHandlers",["require","exports","tslib","react","@ms/odsp-shared-react/lib/utilities/resources/Resources","@ms/items-view/lib/private/controls/userHoverCardControl","@ms/items-view/lib/private/controls/locationHoverCardControl","@ms/items-view/lib/private/controls/itemHoverCardControl","@ms/items-view/lib/private/controls/itemSetColumnsControl","@ms/items-view/lib/private/controls/itemsContextMenuControl","@ms/items-view-addon-sp/lib/controls/missingMetadataFieldControl","@ms/items-view/lib/private/components/decorators/withControlHandler","../../itemsScope/ActionControlHandlers","../../itemsScope/ContextMenuControlHandler","../../itemsScope/ItemsScopeControlHandlerResourceKeys","../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=v.isFeatureEnabled(v.LocationHoverCard),g=function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t,r)||this;i._controlHandlers=n.__assign({},s.userHoverCardControl.pack(i.context.dependencies.userHoverCardControlHandler),m?o.locationHoverCardControl.pack(i.context.dependencies.locationHoverCardControlHandler):{},u.itemHoverCardControl.pack(i.context.dependencies.itemHoverCardControlHandler),f.itemsContextMenuControl.pack(i.context.dependencies.contextMenuControlHandler),a.itemSetColumnsControl.pack(i.context.dependencies.itemSetColumnsControlHandler),l.missingMetadataFieldControl.pack(i.context.dependencies.missingMetadataFieldControlHandler));return i}t.prototype.render=function(){var e=this.context.dependencies.actionControlHandlers;return r.createElement(e,null,r.createElement(c.ControlHandlerProvider,{controlHandlers:this._controlHandlers},this.props.children))};t.contextTypes=i.RESOLVED_COMPONENT_CONTEXT_TYPES;return t}(r.Component);t.ItemContentControlHandlers=g;t.resourceKey=i.createResolvedComponentTypeResourceKey(e("module").id,g,{actionControlHandlers:h.resourceKey,contextMenuControlHandler:p.resourceKey,userHoverCardControlHandler:d.userHoverCard.optional,locationHoverCardControlHandler:d.locationHoverCard.optional,itemHoverCardControlHandler:d.itemHoverCard.optional,itemSetColumnsControlHandler:d.itemSetColumns.optional,missingMetadataFieldControlHandler:d.missingMetadataField.optional})});
define("@ms/items-view/lib/private/controls/userHoverCardControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.userHoverCardControl=new n.ControlFacet("userHoverCardControl")});
define("@ms/items-view/lib/private/controls/locationHoverCardControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.locationHoverCardControl=new n.ControlFacet("locationHoverCardControl")});
define("@ms/items-view/lib/private/controls/itemsContextMenuControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemsContextMenuControl=new n.ControlFacet("itemsContextMenuControl")});
define("@ms/items-view-addon-sp/lib/controls/missingMetadataFieldControl",["require","exports","@ms/items-view/lib/private/models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.missingMetadataFieldControl=new n.ControlFacet("missingMetadataFieldControl")});
define("odsp-next/controls/itemsScope/ActionControlHandlers",["require","exports","tslib","@ms/items-view/lib/private/components/decorators/withControlHandler","@ms/odsp-shared-react/lib/utilities/resources/Resources","react","./ActionControlHandlers.key"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=r.context.dependencies;r._controlHandlers=i.controlHandlers;return r}t.prototype.render=function(){return s.createElement(r.ControlHandlerProvider,{controlHandlers:this._controlHandlers},this.props.children)};t.contextTypes=i.RESOLVED_COMPONENT_CONTEXT_TYPES;return t}(s.Component);t.ActionControlHandlers=u;t.resourceKey=i.createResolvedComponentTypeResourceKey(e("module").id,u,{controlHandlers:o.resourceKey})});
define("odsp-next/controls/itemsScope/ActionControlHandlers.key",["require","exports","tslib","@ms/items-view-addon-sp/lib/controls/createListItemActionControl","@ms/items-view-addon-sp/lib/controls/itemEditPropsActionControl","@ms/items-view-addon-sp/lib/controls/itemExecuteFlowActionControl","@ms/items-view-addon-sp/lib/controls/openInOfficeOnlineActionControl","@ms/items-view/lib/private/controls/defaultClickActionControl","@ms/items-view/lib/private/controls/downloadItemsActionControl","@ms/items-view/lib/private/controls/followItemActionControl","@ms/items-view/lib/private/controls/itemSyncControl","@ms/items-view/lib/private/controls/openActionControl","@ms/items-view/lib/private/controls/sharedFieldClickActionControl","@ms/items-view/lib/private/controls/switchLayoutActionControl","@ms/items-view/lib/private/controls/uploadItemsActionControl","@ms/odsp-utilities/lib/resources/Resources","@ms/shared-react-item-hover-card/lib/itemsScopeFileHoverCard/controls/hoverCardCommandsControl","@ms/items-view/lib/private/controls/moveCopyActionControl","./AsyncActionControlHandlers.key","@ms/items-view/lib/private/controls/itemEngagementControl","./DownloadItemsActionControlHandler","./FollowActionControlHandler","./ItemsScopeControlHandlerResourceKeys","./OpenActionControlHandler","./OpenInOfficeOnlineActionControlHandler","./ItemEngagementControlHandler"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C={defaultClickActionControlHandler:S.defaultClickHandler,openActionControlHandler:x.resourceKey,downloadItemsActionControlHandler:w.resourceKey,openInOfficeOnlineActionControlHandler:T.resourceKey,itemEngagementControlHandler:N.resourceKey,uploadItemsActionControlHandler:S.uploadItemsAction.optional,sharedFieldClickActionControlHandler:S.sharedFieldClickAction.optional,itemExecuteFlowActionControlHandler:S.itemExecuteFlowAction.optional,itemEditPropsActionControlHandler:S.itemEditPropsAction.optional,followActionControlHandler:E.resourceKey.optional,createListItemActionControlHandler:S.createListItemAction.optional,syncActionControlHandler:y.asyncSyncActionControlHandlerKey,asyncSwitchLayoutActionControlHandler:y.asyncSwitchLayoutActionControlHandlerKey,hoverCardCommandsControlHandler:S.hoverCardCommands.optional,asyncMoveCopyActionControlHandler:y.asyncMoveCopyActionControlHandlerKey.optional};t.resourceKey=new v.ResourceKey({name:e("module").id,factory:{dependencies:C,create:function(e){return{instance:n.__assign({},c.openActionControl.pack(e.openActionControlHandler),u.defaultClickActionControl.pack(e.defaultClickActionControlHandler),a.downloadItemsActionControlFacet.pack(e.downloadItemsActionControlHandler),d.uploadItemsActionControl.pack(e.uploadItemsActionControlHandler),o.openInOfficeOnlineActionControl.pack(e.openInOfficeOnlineActionControlHandler),b.itemEngagementControl.pack(e.itemEngagementControlHandler),h.sharedFieldClickActionControl.pack(e.sharedFieldClickActionControlHandler),s.itemExecuteFlowActionControl.pack(e.itemExecuteFlowActionControlHandler),i.itemEditPropsActionControl.pack(e.itemEditPropsActionControlHandler),f.followItemActionControl.pack(e.followActionControlHandler),r.createListItemActionControl.pack(e.createListItemActionControlHandler),l.itemSyncControl.pack(e.syncActionControlHandler),p.switchLayoutActionControl.pack(e.asyncSwitchLayoutActionControlHandler),m.hoverCardCommandsControl.pack(e.hoverCardCommandsControlHandler),g.moveCopyActionControl.pack(e.asyncMoveCopyActionControlHandler))}}}})});
define("@ms/items-view-addon-sp/lib/controls/createListItemActionControl",["require","exports","@ms/items-view/lib/private/models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createListItemActionControl=new n.ControlFacet("createListItemActionControl")});
define("@ms/items-view-addon-sp/lib/controls/itemEditPropsActionControl",["require","exports","@ms/items-view/lib/private/models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemEditPropsActionControl=new n.ControlFacet("itemEditPropsActionControl")});
define("@ms/items-view-addon-sp/lib/controls/itemExecuteFlowActionControl",["require","exports","@ms/items-view/lib/private/models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemExecuteFlowActionControl=new n.ControlFacet("ItemExecuteFlowActionControl")});
define("@ms/items-view-addon-sp/lib/controls/openInOfficeOnlineActionControl",["require","exports","@ms/items-view/lib/private/models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInOfficeOnlineActionControl=new n.ControlFacet("openInOfficeOnlineActionControl")});
define("@ms/items-view/lib/private/controls/downloadItemsActionControl",["require","exports","../models/controls/ControlFacet","../components/controls/defaultRenderComponentControlOption"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.downloadItemsActionControlFacet=new n.ControlFacet("downloadItemsActionControl",{downloader:r.defaultRenderComponentOption()})});
define("@ms/items-view/lib/private/controls/itemSyncControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemSyncControl=new n.ControlFacet("itemSyncControl")});
define("@ms/items-view/lib/private/controls/switchLayoutActionControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.switchLayoutActionControl=new n.ControlFacet("switchLayoutActionControl")});
define("@ms/shared-react-item-hover-card/lib/itemsScopeFileHoverCard/controls/hoverCardCommandsControl",["require","exports","@ms/items-view/lib/private/models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.hoverCardCommandsControl=new n.ControlFacet("hoverCardCommandsControl")});
define("odsp-next/controls/itemsScope/AsyncActionControlHandlers.key",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","@ms/odsp-shared-react/lib/utilities/resources/Resources","@ms/odsp-utilities/lib/resources/Resources","../../models/itemCache/ItemCacheStore","./ItemsScopeControlHandlerResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createAsyncControlHandlerResourceKey=function(e){return new r.ResourceKey({name:e.name+".async",factory:{dependencies:{resources:i.resourceScopeKey,itemCacheStore:s.resourceKey},create:function(t){var r=t.resources,i=t.itemCacheStore;return{instance:r.isDefined(e)?i.dispatch(n.asAsyncControlHandler(function(){return r.consumeAsync(e)})):void 0}}}}).local};t.asyncSyncActionControlHandlerKey=t.createAsyncControlHandlerResourceKey(o.syncAction);t.asyncSwitchLayoutActionControlHandlerKey=t.createAsyncControlHandlerResourceKey(o.switchLayoutAction);t.asyncMoveCopyActionControlHandlerKey=t.createAsyncControlHandlerResourceKey(o.moveCopyAction)});
define("odsp-next/controls/itemsScope/DownloadItemsActionControlHandler",["require","exports","tslib","react","@ms/odsp-utilities/lib/resources/Resources","../../utilities/browser/WebViewDetector","../../providers/winApp/communication/WinAppCommunicator.key","../../models/winApp/communication/IWinAppCommunicator","@ms/items-view/lib/private/components/controls/defaultRenderComponentControlOption","./DownloaderWithRecents.key","@ms/items-view/lib/private/utilities/components/Async"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";var c=this;Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey({name:e("module").id,factory:{dependencies:{resources:i.resourceScopeKey},create:function(e){var t=function(t){n.__extends(r,t);function r(){return null!==t&&t.apply(this,arguments)||this}r.prototype.render=function(){return null};r.prototype.componentDidMount=function(){return n.__awaiter(this,void 0,void 0,function(){var t,r,i,s;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,3,,4]);return[4,this.props.getDownloadData()];case 1:t=n.sent();return[4,e.resources.consumeAsync(o.resourceKey)];case 2:r=n.sent();i={command:"Download",type:u.WinAppDownloadType.DownloadSingleFile,downloadUrl:t.url,postBody:JSON.stringify({})};"POST"===t.method&&(i.postBody=JSON.stringify({request:t.postData}));r.sendCommand({command:JSON.stringify({DownloadCommand:i})});this.props.resolve();return[3,4];case 3:s=n.sent();this.props.reject(s);return[3,4];case 4:return[2]}})})};return r}(r.PureComponent),i=l.asAsync(function(){return n.__awaiter(c,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,e.resources.consumeAsync(f.resourceKey)];case 1:return[2,t.sent()]}})})});return{instance:function(e,n){return s.isOneDriveWinApp()||s.isMagellan()?{downloader:a.defaultRenderComponentOption().merge(i,t)}:{downloader:i}}}}}})});
define("odsp-next/controls/itemsScope/DownloaderWithRecents.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./DownloaderWithRecents"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/controls/itemsScope/FollowActionControlHandler",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../sharing/share/commands/ShareCommandKeys.key","../../utilities/saveForLater/Utilities"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:{resources:n.resourceScopeKey},create:function(e){var t=e.resources;return{instance:function(e,n){return i.hasNoSavedItemsForLater(e)?{onFollow:function(){return function(e){t.consumeAsync(r.hasFollowedAnItemKey).then(function(e){e(!0)})}}}:{}}}}}})});
define("odsp-next/controls/sharing/share/commands/ShareCommandKeys.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.hasFollowedAnItemKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ShareCommandKeys"],t,n)}).then(function(e){return e.hasFollowedAnItemKey})})})});
define("odsp-next/utilities/saveForLater/Utilities",["require","exports","../../models/itemsScope/facets/OdspNextAppFacets","@ms/items-view-addon-graph/lib/models/keys/SavedForLaterRootItemKeyFacet","@ms/items-view/lib/private/facets/SetFacets"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.hasNoSavedItemsForLater=function(e){var t=e.demandItemFacet(n.defaultGraphEndpointFacet,n.odspNextAppItemKey),s=t&&r.savedForLaterRootItemKeyFacet.serialize({endpoint:t}),o=e.demandItemFacet(i.defaultChildItemSetFacet,s),u=o&&o.itemKey,a=e.demandItemFacet(i.childItemsFacet,u),f=a&&a.itemKeys;return!!f&&0===f.length}});
define("@ms/items-view-addon-graph/lib/models/keys/SavedForLaterRootItemKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.savedForLaterRootItemKeyFacet=new n.KeyFacet("savedForLaterRootItem",{endpoint:n.stringPart()})});
define("odsp-next/controls/itemsScope/OpenActionControlHandler",["require","exports","tslib","@ms/odsp-utilities/lib/resources/Resources","../../models/itemsScope/controls/ItemKeyToStoreKeyControl","../../models/itemsScope/facets/CurrentItemsScopeFacets","../../models/itemsScope/facets/OdspNextAppFacets","@ms/items-view/lib/private/operations/readItems","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../providers/item/ItemProvider.key","../../resources/DataSourceResourceKeys","../../models/itemsScope/ItemsScopeAddonHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h={resourceScope:r.resourceScopeKey,navigation:a.navigation};t.resourceKey=new r.ResourceKey({name:e("module").id,factory:{dependencies:h,create:function(e){return{instance:p(e)}}}});function p(e){var t=this,r=e.resourceScope,a=e.navigation;return function(e,h){var p=h.openItem;return{openItem:function(e){var h=e.currentItemKey,d=e.itemsScopeItemKey;return function(v){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){if((t=v(u.readItems(function(e){var t=e.demandItemFacet(s.currentViewParamsFacet,d),n=e.demandItemFacet(i.itemKeyToStoreKeyControl,o.odspNextAppItemKey);return i.itemKeyToStoreKeyControl.evaluate(n)(e,{itemKey:h,viewParams:t||{}})})).storeKey)&&t.key)r.load({itemProvider:f.resourceKey,urlDataSource:l.url}).then(function(){var e=r.consume(f.resourceKey),n=r.consume(l.url),i=t.viewParams,s=e.getItemSync({parentKey:t.key,ignoreChildren:!0}).item,o=n.getDefaultClickUrl(s.peek(),{viewParams:i});a.navigateTo({url:o})});else if(p){v(c.loadRequiredAddon(e));v(p(e))}return[2]})})}}}}}});
define("odsp-next/controls/itemsScope/OpenInOfficeOnlineActionControlHandler",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../utilities/browser/WebViewDetector","../../utilities/killSwitch/KillSwitch"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:{},create:function(e){return{instance:function(e,t){return!i.default.isActivated("B879845E-BDDE-49F3-B911-820CAF3529CA","6/10/2019","Teams open Office document in same window")&&r.isTeamsWebView()?{forceInSameWindow:!0}:{}}}}}})});
define("odsp-next/controls/itemsScope/ItemEngagementControlHandler",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../resources/DataSourceResourceKeys","../../resources/ProviderResourceKeys","@ms/items-view/lib/private/models/itemsScope/getItemsScope","odsp-next/models/itemsScope/facets/CurrentItemsScopeFacets"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={urlDataSource:r.url.optional,instrumentationProvider:i.instrumentation.optional};t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:u,create:function(e){return{instance:function(t,n){var r=e.instrumentationProvider,i=e.urlDataSource;if(r){return{engagement:{currentPage:r.currentPageName(),previousPage:r.previousPageName()}}}if(i){var u=s.getItemsScope(t).itemsScopeItemKey,a=t.demandItemFacet(o.currentViewParamsFacet,u);return{engagement:{extraData:{queryType:""+i.getQueryType(a||{})}}}}return{}}}}}})});
define("odsp-next/controls/itemsScope/ContextMenuControlHandler",["require","exports","@ms/odsp-utilities/lib/resources/Resources","./ExtendedContextMenuControl"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:{resources:n.resourceScopeKey},create:function(e){return{instance:function(e,t){var n=t.itemKey,i=t.commands,s=i,o=e.demandItemFacet(r.extendedContextMenuControl,r.extendedContextMenuKey),u=r.extendedContextMenuControl.evaluate(o)(e,{itemKey:n}).contextMenuOverride;if(!u)return{commands:s};if(i){var a=void 0,f=void 0,l={};s=[];for(var c=0,h=u;c<h.length;c++){var p=h[c];p.bottomCommand?f=p:p.topCommand&&(a=p);p.command&&(l[p.command.key]=p)}for(var d=0,v=i;d<v.length;d++){var m=v[d],g=l[m.key];if(g&&g.beforeCommands)for(var y=0,b=g.beforeCommands;y<b.length;y++){var w=b[y];s.push(w)}var E=!1;if(g&&m.subMenuProps&&m.subMenuProps.items){g.beforeChildrenCommands&&(m.subMenuProps.items.length>0&&g.beforeChildrenCommands[0].key===m.subMenuProps.items[0].key?E=!0:m.subMenuProps.items=g.beforeChildrenCommands.concat(m.subMenuProps.items));if(!E&&g.followupChildrenCommands){E=!0;for(var S=0,x=g.followupChildrenCommands;S<x.length;S++){var T=x[S];m.subMenuProps.items.push(T)}}}s.push(m);if(g&&g.followupCommands)for(var N=0,C=g.followupCommands;N<C.length;N++){var k=C[N];s.push(k);g.topCommand&&(a=void 0)}if(!E&&g&&g.followupChildrenCommands&&g.followupCommands){var L=g.followupCommands[g.followupCommands.length-1];L.subMenuProps&&L.subMenuProps.items&&(L.subMenuProps.items=g.followupChildrenCommands)}}if(f&&f.followupCommands)for(var A=0,O=f.followupCommands;A<O.length;A++){k=O[A];s.push(k)}a&&a.followupCommands&&(s=a.followupCommands.concat(s))}return{commands:s}}}}}})});
define("odsp-next/controls/itemsScope/ExtendedContextMenuControl",["require","exports","@ms/items-view/lib/private/models/controls/ControlFacet","@ms/items-view/lib/private/models/KeyFacet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.extendedContextMenuKeyFacet=new r.KeyFacet("extendedContextMenu",{});t.extendedContextMenuKey=t.extendedContextMenuKeyFacet.serialize({});t.extendedContextMenuControl=new n.ControlFacet("extendedContextMenu")});
define("odsp-next/controls/itemContent/itemsScope/ItemsScopeItemContent.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ItemsScopeItemContent-breadcrumb.od-ItemContent-breadcrumb{-ms-flex:1 1 auto;flex:1 1 auto}.od-ItemsScopeItemContent-list.od-ItemContent-list{padding-top:0}.od-Files-list-container .od-ItemsScopeItemContent-list.od-ItemContent-list{padding-bottom:60px}.od-ItemsScopeItemContent-header.od-ItemContent-header{padding-bottom:20px}.od-ItemsScopeItemContent-list.od-ItemContent-list.od-ItemContent-list--sticky{padding-bottom:10px}.od-ItemsScopeItemContent-list.od-ItemContent-list.od-ItemContent-list--sticky .ms-DetailsHeader{border-bottom:0}.od-ItemContent-header--sticky.od-header-bottom-sticky-shadow-neutral-theme:after{position:absolute;left:0;right:0;height:7px;content:'';margin:0;padding:0;bottom:0;background:linear-gradient(to bottom,rgba(0,0,0,.08),rgba(255,255,255,0))}.od-ItemContent-header--sticky.od-header-bottom-sticky-shadow-dark-theme:after{position:absolute;left:0;right:0;height:7px;content:'';margin:0;padding:0;bottom:0;background:linear-gradient(to bottom,rgba(255,255,255,.15),rgba(255,255,255,0))}.od-ItemContent-footer--sticky .ms-DetailsRow{border-top-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ItemContent-footer--sticky.od-footer-top-sticky-shadow-neutral-theme:before{position:absolute;left:0;right:0;height:7px;content:'';margin:0;padding:0;bottom:100%;background:linear-gradient(to top,rgba(0,0,0,.08),rgba(255,255,255,0))}.od-ItemContent-footer--sticky.od-footer-top-sticky-shadow-dark-theme:before{position:absolute;left:0;right:0;height:7px;content:'';margin:0;padding:0;bottom:100%;background:linear-gradient(to top,rgba(255,255,255,.15),rgba(255,255,255,0))}"}])});
define("odsp-next/utilities/icons/InitializeIcons",["require","exports","@uifabric/file-type-icons/lib/initializeFileTypeIcons","@uifabric/experiments/lib/components/FolderCover/initializeFolderCovers","@ms/items-view/lib/private/components/brandIcon/brandIconHelper","../features/Features"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.initializeFileTypeIcons(s.isFeatureEnabled(s.UseNewFluentIcons)?"https://spoprod-a.akamaihd.net/files/fabric/assets/item-types-fluent/":void 0,{disableWarnings:!0});r.initializeFolderCovers(s.isFeatureEnabled(s.UseNewFluentIcons)?"https://spoprod-a.akamaihd.net/files/fabric/office-ui-fabric-react-assets/foldericons-fluent":void 0,{disableWarnings:!0});i.initializeBrandTypeIcons(s.isFeatureEnabled(s.UseNewFluentIcons)?"https://spoprod-a.akamaihd.net/files/fabric/assets/brand-icons/product-fluent/":void 0,{disableWarnings:!0})});
define("@uifabric/experiments/lib/components/FolderCover/initializeFolderCovers",["require","exports","react","@uifabric/styling"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-react-assets/foldericons";t.initializeFolderCovers=function(e,t){void 0===e&&(e=i);r.registerIcons({fontFace:{},style:{width:118,height:86,overflow:"hidden"},icons:{folderCoverLargeDefaultFront:n.createElement("img",{src:e+"/folder-large_frontplate_nopreview.svg"}),folderCoverLargeDefaultBack:n.createElement("img",{src:e+"/folder-large_backplate.svg"}),folderCoverLargeMediaFront:n.createElement("img",{src:e+"/folder-large_frontplate_thumbnail.svg"}),folderCoverLargeMediaBack:n.createElement("img",{src:e+"/folder-large_backplate.svg"})}},t);r.registerIcons({fontFace:{},style:{width:78,height:58,overflow:"hidden"},icons:{folderCoverSmallDefaultFront:n.createElement("img",{src:e+"/folder-small_frontplate_thumbnail.svg"}),folderCoverSmallDefaultBack:n.createElement("img",{src:e+"/folder-small_backplate.svg"}),folderCoverSmallMediaFront:n.createElement("img",{src:e+"/folder-small_frontplate_nopreview.svg"}),folderCoverSmallMediaBack:n.createElement("img",{src:e+"/folder-small_backplate.svg"})}},t)}});
define("odsp-next/roots/odc/OneDriveNextWithItemsScopeApp",["require","exports","tslib","@ms/odsp-utilities/lib/resources/Resources","../../resources/DataSourceResourceKeys","../../resources/ControlResourceKeys","knockout","../../models/itemsScope/ItemsScopePrefetcher.key","../../models/itemsScope/ItemsScopePrefetcher","../../models/itemCache/ItemCacheConfiguration.key","../../models/itemCache/od/ItemCacheConfiguration","../../models/itemsScope/ItemsScopeAddon.key","../../models/itemsScope/od/ItemsScopeAddon","../../models/itemsScope/ItemsScopeKeyConverter.key","../../models/itemsScope/od/ItemsScopeKeyConverter","../../dataSources/base/odc/vroom/ItemIdentityProcessor","../../dataSources/graph/odc/GraphDataSource","../../dataSources/identity/odc/IdentityDataSource","../../dataSources/identity/odc/PWAAppIdentityDataSource","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initialize=function(t){var E=this,S=t.consume(b.navigation);t.expose(s.viewParams,o.observable(S.viewParams));w.isOneDriveWinApp()?t.exposeFactory(i.identity,new r.AliasResourceFactory(y.resourceKey)):t.exposeFactory(i.identity,new r.AliasResourceFactory(g.resourceKey));t.exposeFactory(i.graph,new r.AliasResourceFactory(m.resourceKey));t.exposeFactory(i.vroomItemIdentityProcessor,new r.AliasResourceFactory(v.resourceKey));t.exposeFactory(f.resourceKey,new r.AliasResourceFactory(l.resourceKey));t.exposeFactory(c.resourceKey,new r.AliasResourceFactory(h.resourceKey));t.exposeFactory(p.resourceKey,new r.AliasResourceFactory(d.resourceKey));t.exposeFactory(u.resourceKey,new r.AliasResourceFactory(a.resourceKey));t.consume(u.resourceKey).prefetch();n.__awaiter(E,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,new Promise(function(t,n){e(["./OneDriveNextApp"],t,n)})];case 1:(0,n.sent().initialize)(t);return[2]}})})}});
define("odsp-next/models/itemsScope/ItemsScopePrefetcher.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemsScopePrefetcher"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/models/itemsScope/ItemsScopePrefetcher",["require","exports","tslib","../itemCache/ItemCacheStore","../itemsScope/ItemsScopeCurrentItemKey.key","@ms/items-view/lib/private/store/enhancers/NextStoreUpdateEnhancer","@ms/items-view/lib/private/operations/getItems","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/facets/SetFacets","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){this._itemCacheStore=t.itemCacheStore;this._itemsScopeCurrentItemKey=t.itemsScopeCurrentItemKey}e.prototype.prefetch=function(){var e,t,r=this._itemCacheStore.dispatch,i=this._itemsScopeCurrentItemKey.peek();if(i){r(o.getItems({items:(e={},e[i]={demands:n.__assign({},u.pack({},{}),(t={},t[a.displayNameFacet.id]=!0,t[f.childItemsFacet.id]=!0,t))},e)}));r(s.forceStoreUpdate())}};return e}();t.ItemsScopePrefetcher=c;t.resourceKey=l.createResolvedResourceKey(e("module").id,c,{itemCacheStore:r.resourceKey,itemsScopeCurrentItemKey:i.resourceKey})});
define("odsp-next/models/itemCache/od/ItemCacheConfiguration",["require","exports","tslib","@ms/items-view-addon-graph/lib/models/facets/GraphDataSourceConfigurationFacet","@ms/items-view/lib/private/facets/LoggerFacets","../../../resources/DataSourceResourceKeys","../../../resources/LoggingResourceKeys","../../../utilities/logging/itemsScope/Logging","../../../providers/engagement/Engagement","@ms/odsp-utilities/lib/resources/Resources","../ItemCacheConfiguration","@ms/items-view-addon-graph/lib/models/facets/ConfigurationFacets","../../../utilities/killSwitch/KillSwitch","@ms/items-view-addon-graph/lib/models/facets/ConfigurationFacets","../../../dataSources/url/odc/UrlHelpers"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";var v=this;Object.defineProperty(t,"__esModule",{value:!0});var m={resources:f.resourceScopeKey,baseItemCacheConfiguration:l.resourceKey};t.resourceKey=new f.ResourceKey({name:e("module").id,factory:{dependencies:m,create:function(e){var t=e.baseItemCacheConfiguration,f=e.resources,l=d.getVroomBaseUrl();return{instance:n.__assign({},t,i.loggerFacet.pack(n.__assign({},h.default.isActivated("80C3EC2C-9E89-477C-90F5-A6F3BBCDF698","6/18/2019","Disable logging callbacks in ItemsScope")?{logEngagementData:u.getLoggingEngagementData(f.consume(a.resourceKey)),logQoSData:u.logQoS}:{},{reportRUMOnePerfData:!1,logRenderEndTime:function(e,t){var n=f.consume(o.rumOneHelper.optional);n&&n.logRUMOneForItemsScopeListView(e,t)}})),r.graphDataSourceConfigurationFacet.pack({ensureAuthToken:function(e,t){return n.__awaiter(v,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,f.consume(s.identity)];case 1:return[4,e.sent().getSessionToken()];case 2:return[2,e.sent().accessToken]}})})}}),c.loadParentItemOnItemSetRequestConfigurationFacet.pack(!0),p.isConsumerDirectEndpointFacet.pack(function(e){return e.indexOf(l)>-1}))}}}})});
define("@ms/items-view-addon-graph/lib/models/facets/GraphDataSourceConfigurationFacet",["require","exports","@ms/items-view/lib/private/models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphDataSourceConfigurationFacet=new n.Facet("graphDataSourceConfiguration")});
define("odsp-next/utilities/logging/itemsScope/Logging",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getLoggingEngagementData=function(e){return function(t){e.logData(n.__assign({},t,{extraData:n.__assign({},t.extraData||{},{isItemsScope:!0})}))}};t.logQoS=function(e){if(e){var t=new r.default(e);return function(e){t.end(n.__assign({},e,{extraData:n.__assign({},e.extraData||{},{isItemsScope:!0})}))}}}});
define("odsp-next/models/itemCache/ItemCacheConfiguration",["require","exports","tslib","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-utilities/lib/resources/Resources","@ms/items-view/lib/private/store/createStore","@ms/items-view/lib/private/facets/LoggerFacets","@ms/items-view/lib/private/store/createWebStoreNotifier","@ms/items-view/lib/private/facets/ConfigurationFacets","@ms/items-view-addon-graph/lib/models/facets/ConfigurationFacets","@ms/items-view-addon-graph/lib/models/facets/ConfigurationFacets","@ms/items-view/lib/private/components/backgroundTaskRunner/BackgroundTaskRunner","../../utilities/features/Features","../../utilities/killSwitch/KillSwitch"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey({name:e("module").id,factory:{dependencies:{},create:function(e){return{instance:n.__assign({},o.pageLoadConfigurationFacet.pack({enablePageLoadBarrier:!0}),a.backgroundTaskQueueFacet.pack(new c.BackgroundTaskRunner),a.localeFacet.pack({language:r.default.language}),a.enableShimmeredDetailsListConfigurationFacet.pack(!p.default.isActivated("61C96F6C-2188-478E-A68B-DD14394E88E3","11/6/2018","Enable new DetailsList shimmer")),p.default.isActivated("6E1AAB31-1EC4-4431-8561-72B9B0BE086E","2/15/2019","Use batched React notifier for ItemCache store.")?{}:n.__assign({},s.notifierFacet.pack(u.createWebStoreNotifier())),f.enablePromotedFileHandlerConfigurationFacet.pack(h.isFeatureEnabled(h.PromotedFileHandler)),l.loadParentItemOnItemSetRequestConfigurationFacet.pack(!0),a.enableFollowItemConfigurationFacet.pack(h.isFeatureEnabled(h.EnableSavedForLater)),a.enableFluentIconsFacet.pack(h.isFeatureEnabled(h.UseNewFluentIcons)),a.isItemsViewLayoutPersistenceEnableConfigurationFacet.pack(!p.default.isActivated("78d5e3cd-0292-4fc2-bdeb-f2687d9ee54c","2/8/2019","ItemsScope persist layout")),a.enableItemDetailsRowRenderDebounceFacet.pack(!p.default.isActivated("1ABA72F0-7CE8-49C9-B098-34321C40C53D","4/18/2019","Debounce row re-renders")),a.enableDetailsListPreComputePagesFacet.pack(h.isFeatureEnabled(h.PreComputeDetailsListPages)),a.enableDetailsListFieldRenderPageLoadBarrierFacet.pack(!0),a.enableTrendingConfigurationFacet.pack(h.isFeatureEnabled(h.EnableTrendingSignalInItemsScope)),a.enableReadOnlyConfigurationFacet.pack(!p.default.isActivated("03C3F8BF-1C2C-4490-BB63-E443CAF66F8A","4/18/2019","Enable read-only facet for items")),a.enableItemCountInFileSizeColumnFacet.pack(!p.default.isActivated("8E4A9950-7A05-4C78-9349-24FB0639219E","2/24/2019","Show item counts for folder file size column.")),a.enableFileHoverCardConfigurationFacet.pack(!0),a.enableDeleteCancelConfirmationStringsConfigurationFacet.pack(!0))}}}})});
define("@ms/items-view/lib/private/store/createWebStoreNotifier",["require","exports","react-dom","./createStore"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createWebStoreNotifier=function(){var e=r.createDefaultStoreNotifier();return function(t,r){void 0===r&&(r={});return e(function(){return n.unstable_batchedUpdates(t)},r)}}});
define("@ms/items-view-addon-graph/lib/models/facets/ConfigurationFacets",["require","exports","@ms/items-view/lib/private/models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.loadParentItemOnItemSetRequestConfigurationFacet=new n.Facet("loadParentItemOnItemSetRequest");t.isTestMode=new n.Facet("isTestMode");t.enablePromotedFileHandlerConfigurationFacet=new n.Facet("enablePromotedFileHandler");t.processDriveItemFromSharePointFacet=new n.Facet("processDriveItemFromSharePoint");t.recentItemsGroupByFacet=new n.Facet("recentItemGroupByFacet");t.getUserOneDriveEndpointFacet=new n.Facet("getUserOneDriveEndpointFacet");t.isConsumerDirectEndpointFacet=new n.Facet("isConsumerDirectEndpoint");t.useGraphEndpointForSavedForLaterFacet=new n.Facet("useGraphEndpointForSavedForLaterFacet");t.graphEndpointConfigurationFacet=new n.Facet("graphEndpointFacet");t.supportsDriveItemSetRandomAccessFacet=new n.Facet("supportsDriveItemSetRandomAccess");t.driveItemSetPageSizeFacet=new n.Facet("driveItemSetPageSize")});
define("@ms/items-view/lib/private/components/backgroundTaskRunner/BackgroundTaskRunner",["require","exports","tslib","react","react-dom","./BackgroundTaskHost"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){this._backgroundTaskHelper=new s.BackgroundTaskBuffer;this._taskCount=0;this._element=null}e.prototype.enqueue=function(e){this._enqueue(e)};e.prototype.stop=function(){if(this._element){this._taskCount=0;i.unmountComponentAtNode(this._element);this._element.remove()}};e.prototype._enqueue=function(e){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:if(0===this._taskCount){(t=this._element=document.createElement("div")).style.display="none";t.classList.add("ms-ItemsView-backgroundTaskRunner");document.body.appendChild(t);i.render(r.createElement(s.BackgroundTaskHost,{queueRef:this._backgroundTaskHelper.queueRef}),t)}this._taskCount++;this._backgroundTaskHelper.enqueue(e);n.label=1;case 1:n.trys.push([1,,3,4]);return[4,e.promise];case 2:n.sent();return[3,4];case 3:this._taskCount--;if(0===this._taskCount&&this._element){i.unmountComponentAtNode(this._element);this._element.remove()}return[7];case 4:return[2]}})})};return e}();t.BackgroundTaskRunner=o});
define("odsp-next/models/itemsScope/od/ItemsScopeAddon",["require","exports","tslib","@ms/items-view/lib/private/operations/pageLoad","@ms/items-view/lib/private/addons/registerControlHandler","../../../controls/itemsScope/ExtendedContextMenuControl","@ms/odsp-utilities/lib/resources/Resources","@ms/items-view/lib/private/addons/registerOperationHandler","../../../controls/itemsScope/ExtendedCommandBarControl","../facets/OdspNextAppFacets","../../../controls/itemContent/itemsScope/ItemContentControl","../../../controls/itemContent/itemsScope/od/ItemContentControlHandler","../../../models/itemsScope/facets/OneDriveItemFacet","./OneDriveItemControlHandler.key","@ms/items-view-addon-graph/lib/models/keys/DriveItemKeyFacet","@ms/items-view/lib/private/controls/createDocumentActionControl","@ms/items-view-addon-graph/lib/GraphAddon","../../../controls/itemContent/itemsScope/ItemContentBreadcrumbControl","../../../controls/itemContent/itemsScope/odc/ItemContentBreadcrumbControlHandler"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";var b=this;Object.defineProperty(t,"__esModule",{value:!0});var w={itemContentBreadcrumbControlHandler:y.resourceKey,resources:o.resourceScopeKey};t.resourceKey=new o.ResourceKey({name:e("module").id,factory:{dependencies:w,create:function(t){var o=t.itemContentBreadcrumbControlHandler,y=t.resources;return{instance:u.createAddon(function(){return function(t){return n.__awaiter(b,void 0,void 0,function(){var u=this;return n.__generator(this,function(b){t(m.graphAddon);t(i.registerControlHandler(f.odspNextAppKeyFacet,l.itemContentControl)(c.itemContentControlHandler));t(i.registerControlHandler(f.odspNextAppKeyFacet,g.itemContentBreadcrumbControl)(o));t(i.registerControlHandler(f.odspNextAppKeyFacet,h.oneDriveItemControl)(i.createDeferredControlHandler(function(){return n.__awaiter(u,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,t(r.waitForPageLoad())];case 1:e.sent();return[4,y.consumeAsync(p.resourceKey)];case 2:return[2,e.sent()]}})})})));t(i.registerControlHandler(f.odspNextAppKeyFacet,a.extendedCommandBarControl)(i.createDeferredControlHandler(function(){return n.__awaiter(u,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,t(r.waitForPageLoad())];case 1:n.sent();return[4,new Promise(function(t,n){e(["../../../controls/itemsScope/od/ItemsCommandBarController"],t,n)})];case 2:return[2,n.sent().extendedItemsCommandBarControlHandler]}})})})));t(i.registerControlHandler(s.extendedContextMenuKeyFacet,s.extendedContextMenuControl)(i.createDeferredControlHandler(function(){return n.__awaiter(u,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,t(r.waitForPageLoad())];case 1:n.sent();return[4,new Promise(function(t,n){e(["../../../controls/itemsScope/od/ItemsContextMenuController"],t,n)})];case 2:return[2,n.sent().extendedItemsContextMenuControlHandler]}})})})));t(i.registerControlHandler(d.driveItemKeyFacet,v.createDocumentActionControl)(i.createDeferredControlHandler(function(){return n.__awaiter(u,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,t(r.waitForPageLoad())];case 1:n.sent();return[4,new Promise(function(t,n){e(["../../../controls/itemsScope/odc/CreateDocumentActionControlHandler"],t,n)})];case 2:return[2,n.sent().createDocumentActionControlHandler]}})})})));return[2]})})}})}}}})});
define("odsp-next/controls/itemsScope/ExtendedCommandBarControl",["require","exports","@ms/items-view/lib/private/models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.extendedCommandBarControl=new n.ControlFacet("extendedCommandBar")});
define("odsp-next/controls/itemContent/itemsScope/od/ItemContentControlHandler",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","./ItemsViewContent"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemContentControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){return{itemsViewContentAs:r.default}}}})});
define("odsp-next/controls/itemContent/itemsScope/od/ItemsViewContent",["require","exports","tslib","react"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,i=n.__rest(e,["defaultRender"]);return t?r.createElement(t,n.__assign({},i)):null};return t}(r.PureComponent);t.default=i});
define("odsp-next/models/itemsScope/facets/OneDriveItemFacet",["require","exports","tslib","@ms/items-view/lib/private/models/itemCache/ComputedItemFacet","@ms/items-view/lib/private/models/controls/graftControlOption","@ms/items-view/lib/private/models/controls/ControlFacet","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view-addon-graph/lib/models/keys/DriveItemKeyFacet","../../../dataSources/url/QueryType","@ms/utilities-date-time/lib/relativePast","@ms/items-view/lib/private/facets/ConfigurationFacets","../../item/ItemType","@ms/odsp-utilities/lib/icons/IconSelector","../controls/ItemKeyToStoreKeyControl","./OdspNextAppFacets","@ms/items-view/lib/private/facets/GroupFacets","@ms/items-view-addon-sp/lib/dataSource/Facets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.oneDriveItemControl=new s.ControlFacet("oneDriveItemControl",{item:i.graftControlOption()});t.oneDriveItemFacet=new r.ComputedItemFacet("oneDriveItem",function(e,r){var i=r.itemKey,s=e.demandItemFacet(p.itemKeyToStoreKeyControl,d.odspNextAppItemKey),g=p.itemKeyToStoreKeyControl.evaluate(s)(e,{itemKey:i,viewParams:{}}).storeKey;if(void 0!==g){var y=g.key,b=g.id,w=e.demandItemFacet(o.displayNameFacet,i),E=e.demandItemFacet(o.fileNameFacet,i),S=E&&E.name||"",x=E&&E.extension||"",T=e.demandItemFacet(u.driveItemKeyFacet,i),N=e.demandItemFacet(o.fileSizeFacet,i),C=e.demandItemFacet(o.folderFacet,i),k=e.demandItemFacet(o.dateModifiedFacet,i),L=e.demandItemFacet(l.localeFacet,l.configurationItemKey),A=L&&L.language||window.navigator.language,O=e.demandItemFacet(o.openUrlFacet,i),M=C?c.default.Folder:c.default.File,_=h.getIconNameFromItem({type:M,extension:x,textEditorMimeType:void 0}),D=e.demandItemFacet(v.countFacet,i),P=e.demandItemFacet(m.officeAppFacet,i),H=n.__assign({key:y,queryType:a.default.Files,displayType:a.default.Files,external:void 0,id:b},T?{itemId:T.itemId}:{},T?{graph:{itemId:T.itemId,driveId:T.driveId}}:{},{name:S,displayName:w||"",extension:x},void 0!==N?{size:N}:{},{caption:void 0,type:C?c.default.Folder:c.default.File},C?{folder:{}}:{},{childCount:D,photo:void 0,video:void 0,creatorName:void 0,editorName:void 0},void 0===k||isNaN(k)?{}:{dateModifiedTime:new Date(k),dateModified:f.getRelativeDateTimeStringPast(new Date(k),A)},{dateCreatedTime:void 0,dateCreated:void 0,dateSharedTime:void 0,dateShared:void 0,properties:{sharedByUser:void 0,editorName:void 0},iconName:_,audio:void 0,lifeCycleStatus:void 0,appMap:P,urls:{},thumbnail:void 0,officeBundle:void 0,zip:void 0,htmlConversion:void 0,model3d:void 0,itemStatus:void 0,pdfConversion:void 0},O?{openUrl:O}:{},{itemFromServer:void 0,isPlaceholder:!w,parentKey:void 0,state:{},recycleBinProperties:{},reputationProperties:{},statistics:{}}),B=e.demandItemFacet(t.oneDriveItemControl,d.odspNextAppItemKey);return t.oneDriveItemControl.evaluate(B)(e,{itemKey:i,key:y,item:H}).item}})});
define("@ms/items-view-addon-graph/lib/models/keys/DriveItemKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemKeyFacet=new n.KeyFacet("driveItem",{endpoint:n.stringPart(),driveId:n.stringPart({shouldNormalizeToEmpty:!0}),itemId:n.stringPart()})});
define("@ms/items-view-addon-sp/lib/dataSource/Facets",["require","exports","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/facets/ItemFacets"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spDataSourceConfigurationFacet=new n.Facet("spDataSourceConfiguration");t.spHomeDataSourceConfigurationFacet=new n.Facet("spHomeDataSourceConfiguration");t.spFrequentSitesExternalDataConfigurationFacet=new n.Facet("frequentSitesConfiguration");t.spFollowedSitesExternalDataConfigurationFacet=new n.Facet("followedSitesConfiguration");t.spCookieDomainConfigurationFacet=new n.Facet("spCookieDomainConfiguration");t.spCreateDocumentFormDigestFacet=new n.Facet("spCreateDocumentFormDigestFacet");t.spPrefetchDataConfigurationFacet=new n.Facet("prefetchDataConfiguration");t.spFeatureConfigurationFacet=new n.Facet("featureConfiguration");t.spClientSideFrameworkConfigurationFacet=new n.Facet("clientSideFrameworkConfiguration");t.spPageFallbackWebAbsoluteUrlConfigurationFacet=new n.Facet("spPageFallbackWebAbsoluteUrl");t.internalNameFacet=new n.Facet("internalName");t.fieldTypeFacet=new n.Facet("fieldType");t.fieldFieldTypeFacet=new n.Facet("fieldFieldType");t.mappedColumnFieldTypeFacet=new n.Facet("mappedColumnFieldType");t.fieldIdFacet=new n.Facet("columnId");t.isCalculatedFacet=new n.Facet("isCalculated");t.isCountRelatedFacet=new n.Facet("isCountRelated");t.realFieldNameFacet=new n.Facet("realFieldName");t.titleFacet=new n.Facet("title");t.uiVersionFacet=new n.Facet("uiVersion");t.moderationStatusTypeFacet=new n.Facet("moderationStatusType");t.moderationCommentsFacet=new n.Facet("moderationComments");t.folderPathFacet=new n.Facet("folderPath");t.uniqueIdFacet=new n.Facet("uniqueId");t.listItemIdFacet=new n.Facet("listItemId");t.largeFolderFacet=new n.Facet("largeFolder");t.documentSetFacet=new n.Facet("docSet");t.isBFileFacet=new n.Facet("bfile");t.customFormatterFacet=new n.Facet("customFormatter");t.rowDataFacet=new n.Facet("rowData");t.listFacet=new n.Facet("listFacet");t.driveUrlFacet=new n.Facet("driveUrlFacet");t.listFormUrlsFacet=new n.Facet("listFormUrlsFacet");t.permissionsFacet=new n.Facet("permissions");t.defaultGroupedFacet=new n.Facet("defaultGrouped");t.groupValueFacet=new n.Facet("groupValue");t.groupFilterByValueFacet=new n.Facet("groupFilterByValue");t.groupStringFacet=new n.Facet("groupString");t.parentGroupKeyFacet=new n.Facet("parentGroupKeyFacet");t.spGroupFieldFacet=new n.Facet("spGroupField");t.spPageContextFacet=new n.Facet("spPageContext");t.spPageContextForDataRequestorFacet=new n.Facet("spPageContextForDataRequestor");t.filterOptionSetFacet=new n.Facet("filterOptionSet");t.listSchemaFacet=new n.Facet("listSchemaFacet");t.viewFormatterFacet=new n.Facet("viewFormatterFacet");t.fieldDispFormUrlFacet=new n.Facet("fieldDispFormUrl");t.isReadOnlyFacet=new n.Facet("isReadOnly");t.taxonomyTermLabelFacet=new n.Facet("taxonomyTermLabel");t.spItemIdentifierFacet=new n.Facet("spItemIdentifier");t.getFieldFacet=function(e,t){return r.fieldsFacet(e)};t.defaultDocumentLibraryUrlFacet=new n.Facet("defaultDocumentLibraryUrl");t.spListContentTypeFacet=new n.Facet("spListContentType");t.spFolderContentTypeFacet=new n.Facet("spFolderContentType");t.contentTypeKeysFacet=new n.Facet("contentTypeKeys");t.actionFacet=new n.Facet("action");t.serverViewFacet=new n.Facet("serverView");t.currentDerivedViewFacet=new n.Facet("currentDerivedView");t.showViewModifiedIndicatorFacet=new n.Facet("showViewModifiedIndicator");t.officeAppFacet=new n.Facet("officeApp");t.getItemResponseFacet=new n.Facet("getItemResponse");t.getItemResponseJsonStringFacet=new n.Facet("getItemResponseJsonString");t.defaultViewFacet=new n.Facet("defaultViewFacet");t.preferredViewFacet=new n.Facet("preferredViewFacet");t.missingMetadataFieldsFacet=new n.Facet("missingMetadataFields");t.needsAttentionItemFacet=new n.Facet("needsAttentionItem");t.canModifySchemaFacet=new n.Facet("canModifySchema");t.progIdFacet=new n.Facet("progId");t.isRootFolderFacet=new n.Facet("isRootFolder");t.contentTypeIdFacet=new n.Facet("contentTypeId");t.spHomeResourceFacet=new n.Facet("spHomeResourceFacet");t.spHomePayloadHeaderFacet=new n.Facet("spHomePayloadHeaderFacet");t.acronymFacet=new n.Facet("acronymFacet");t.bannerColorFacet=new n.Facet("bannerColorFacet");t.bannerImageUrlFacet=new n.Facet("bannerImageUrlFacet");t.iconFacet=new n.Facet("iconFacet");t.isSiteFacet=new n.Facet("isSiteFacet");t.columnTotalsFacet=new n.Facet("columnTotals");t.friendlyDateModifiedFacet=new n.Facet("friendlyDateModified");t.launchBehaviorFacet=new n.Facet("launchBehavior");t.linkLocationFacet=new n.Facet("linkLocation");t.fieldDataFacet=new n.Facet("fieldDataFacet");t.spTenantAdminFacet=new n.Facet("spTenantAdmin");t.spErrorDataFacet=new n.Facet("spErrorData");t.userLookupFieldFacet=new n.Facet("userLookupField");t.spPeoplePickerDataSourceFacet=new n.Facet("spPeoplePickerDataSource");t.spAggregatesFacet=new n.Facet("spAggregates");t.spFilterableSetFacet=new n.Facet("spFilterableSetFacet");t.newDocumentTemplatesFacet=new n.Facet("newDocumentTemplates");t.newDocumentTemplateFacet=new n.Facet("newDocumentTemplate");t.enableUserAgentConfigurationFacet=new n.Facet("enableUserAgent");t.spLayoutConfigurationFacet=new n.Facet("spLayoutConfiguration");t.gridInitInfoFacet=new n.Facet("gridInitInfo");t.onProcessListItemResponseConfigurationFacet=new n.Facet("onProcessListItemResponseConfigurationFacet");t.enableGroupByInOneDriveFacet=new n.Facet("enableGroupByInOneDrive");t.enableQuickEditFacet=new n.Facet("enableQuickEdit");t.enableModernListSchemasConfigurationFacet=new n.Facet("enableModernListSchemasConfiguration");t.enableModernColumnTotalsSettingsFacet=new n.Facet("enableModernColumnTotalsSettings");t.completeExitingQuickEditSignalFacet=new n.Facet("completeExitingQuickEditSignal");t.enableMapGraphItemsToSharePointFacet=new n.Facet("enableMapGraphItemsToSharePoint");t.enableMediaGroupingConfigurationFacet=new n.Facet("enableMediaGroupingConfiguration");t.enableEditOrViewItemCommandConfigurationFacet=new n.Facet("enableEditOrViewItemCommandConfigurationFacet");t.enableApproveRejectCommandConfigurationFacet=new n.Facet("enableApproveRejectCommandConfiguration");t.enableMalwareDownloadInNewWindowConfigurationFacet=new n.Facet("enableMalwareDownloadInNewWindowConfiguration");t.enableItemDetailsRowStatelessComponentEvaluationConfigurationFacet=new n.Facet("enableItemDetailsRowStatelessComponentEvaluation");t.enableFilesWeightedFrequentSitesConfigurationFacet=new n.Facet("enableFilesWeightedFrequentSitesConfiguration");t.enableSitePinningConfigurationFacet=new n.Facet("enableSitePinningConfiguration");t.enableItemActivityFieldFacet=new n.Facet("enableItemActivityFieldFacet");t.nextHrefFacet=new n.Facet("nextHref");t.prevHrefFacet=new n.Facet("prevHref");t.pinOrderFacet=new n.Facet("pinOrder");t.siteWeightageFacet=new n.Facet("siteWeightage");t.siteIdFacet=new n.Facet("siteId");t.webIdFacet=new n.Facet("webId");t.groupIdFacet=new n.Facet("groupId");t.enableDebugClientSideExtensionsFacet=new n.Facet("enableDebugClientSideExtensions");t.requestOriginalDateFacet=new n.Facet("requestOriginalDateFacet")});
define("odsp-next/models/itemsScope/od/OneDriveItemControlHandler.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return Promise.resolve(new Promise(function(t,n){e(["./OneDriveItemControlHandler"],t,n)})).then(function(e){return e.resourceKey})})})});
define("@ms/items-view/lib/private/controls/createDocumentActionControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createDocumentActionControl=new n.ControlFacet("createDocumentAction")});
define("@ms/items-view-addon-graph/lib/GraphAddon",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","./models/keys/SavedForLaterItemSetKeyFacet","./models/keys/SharedWithMeItemSetKeyFacet","@ms/items-view/lib/private/operations/pageLoad","@ms/items-view/lib/private/addons/registerControlHandler","./handlers/controls/savedForLaterRootItemSetColumns","@ms/items-view/lib/private/controls/itemSetDetailsListControl","@ms/items-view/lib/private/controls/itemSetColumnsControl","./handlers/controls/savedForLaterRootItemSetDetailsList","./handlers/controls/sharedWithMeRootItemSetColumns","./GraphAddonDataOnly","@ms/items-view/lib/private/controls/emptyFolderControl","./handlers/controls/savedForLaterEmptyFolderControl","./handlers/controls/driveItem/itemHoverCardControlHandler","./models/keys/DriveItemKeyFacet","@ms/items-view/lib/private/controls/itemHoverCardControl","@ms/items-view/lib/private/operations/handleError","./handlers/controls/sharedWithMeRootItemCommandBar","@ms/items-view/lib/private/controls/itemsCommandBarControl","./models/keys/SharedWithMeRootItemKeyFacet","@ms/items-view/lib/private/controls/itemsContextMenuControl","./handlers/controls/sharedWithMeRootItemContextMenu","./handlers/controls/recentItemSetColumns","./models/keys/RecentItemSetKeyFacet","./models/keys/DriveItemSetKeyFacet","@ms/items-view/lib/private/controls/itemSetPagingControl","./handlers/controls/driveItemSetPagingControlHandler","@ms/utilities-async/lib/decorators/asModuleLoad"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O){"use strict";var M=this;Object.defineProperty(t,"__esModule",{value:!0});var _=O.asModuleWithRetries(function(){return new Promise(function(t,n){e(["./GraphAddonDeferred"],t,n)})},{chunkName:"graphaddondeferred"});t.graphAddon=r.createAddon(function(){return function(e){return n.__awaiter(M,void 0,void 0,function(){var t,r;return n.__generator(this,function(n){switch(n.label){case 0:e(p.graphAddonDataOnly);e(u.registerControlHandler(i.savedForLaterItemSetKeyFacet,f.itemSetDetailsListControl)(c.savedForLaterRootItemSetDetailsListControlHandler));e(u.registerControlHandler(i.savedForLaterItemSetKeyFacet,l.itemSetColumnsControl)(a.savedForLaterRootItemSetColumnsControlHandler));e(u.registerControlHandler(i.savedForLaterItemSetKeyFacet,d.emptyFolderControl)(v.emptyFolderControlHandler));e(u.registerControlHandler(C.recentItemSetKeyFacet,l.itemSetColumnsControl)(N.recentItemSetColumnsControlHandler));e(u.registerControlHandler(s.sharedWithMeItemSetKeyFacet,l.itemSetColumnsControl)(h.sharedWithMeRootItemSetColumnsControlHandler));e(u.registerControlHandler(S.sharedWithMeRootItemKeyFacet,E.itemsCommandBarControl)(w.sharedWithMeCommandBarControlHandler));e(u.registerControlHandler(S.sharedWithMeRootItemKeyFacet,x.itemsContextMenuControl)(T.sharedWithMeContextMenuControlHandler));e(u.registerControlHandler(g.driveItemKeyFacet,y.itemHoverCardControl)(m.driveItemHoverCardControlHandler));e(u.registerControlHandler(k.driveItemSetKeyFacet,L.itemSetPagingControl)(A.driveItemSetPagingControlHandler));return[4,e(o.waitForPageLoad())];case 1:n.sent();n.label=2;case 2:n.trys.push([2,4,,5]);return[4,_()];case 3:if(!(t=n.sent().graphAddonDeferred))throw new Error("Couldn't load extended Microsoft Graph features.");e(t);return[3,5];case 4:r=n.sent();e(b.handleError({error:r}));return[3,5];case 5:return[2]}})})}})});
define("@ms/items-view-addon-graph/lib/models/keys/SavedForLaterItemSetKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet","./SavedForLaterRootItemKeyFacet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.savedForLaterItemSetKeyFacet=new n.KeyFacet("savedForLaterItemSet",{driveItemKey:n.subKeyPart(r.savedForLaterRootItemKeyFacet),sortBy:n.stringPart(),isAscending:n.booleanPart()})});
define("@ms/items-view-addon-graph/lib/models/keys/SharedWithMeItemSetKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet","./DriveItemKeyFacet","./DriveFilterKeyFacet"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeItemSetKeyFacet=new n.KeyFacet("sharedItemSet",{driveItemKey:n.subKeyPart(r.driveItemKeyFacet),sortBy:n.stringPart(),isAscending:n.booleanPart(),filters:n.arrayPart(n.subKeyPart(i.driveFilterKeyFacet))})});
define("@ms/items-view-addon-graph/lib/models/keys/DriveFilterKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveFilterKeyFacet=new n.KeyFacet("driveFilter",{type:n.stringPart(),values:n.arrayPart(n.stringPart())})});
define("@ms/items-view-addon-graph/lib/handlers/controls/savedForLaterRootItemSetColumns",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","../../components/columns/fileTypeIconColumn","@ms/items-view/lib/private/components/columns/nameAndPath/nameAndPathColumn","@ms/items-view/lib/private/components/columns/dateFollowed/dateFollowedColumn","../../components/columns/itemActivityColumn"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.savedForLaterRootItemSetColumnsControlHandler=n.createControlHandler()(function(){return function(e){return a}});var u=[r.fileTypeIconColumn,i.nameAndPathColumn,s.dateFollowedColumn,o.itemActivityColumn];function a(e,t){return{columns:u}}});
define("@ms/items-view-addon-graph/lib/components/columns/fileTypeIconColumn",["require","exports","tslib","@ms/items-view/lib/private/components/columns/fileTypeIcon/fileTypeIconColumn","./ColumnKeys"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileTypeIconColumn=n.__assign({},r.fileTypeIconColumn,{key:i.FILE_TYPE_ICON_COLUMN_KEY,minWidth:32,maxWidth:32})});
define("@ms/items-view-addon-graph/lib/components/columns/ColumnKeys",["require","exports","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/columns/displayName/displayNameColumn"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;t.ITEM_ACTIVITY_COLUMN_KEY=new n.Facet("itemActivity").id;t.SHARED_BY_COLUMN_KEY=new n.Facet("sharedByColumn").id;t.FILE_TYPE_ICON_COLUMN_KEY=new n.Facet("fileTypeIconColumn").id;t.DATE_SHARED_COLUMN_KEY=new n.Facet("dateSharedColumn").id;t.INTERNAL_NAME_COLUMN_MAPPING=((i={})[r.DISPLAY_NAME_COLUMN_KEY]="LinkFilename",i[t.ITEM_ACTIVITY_COLUMN_KEY]="FileActivity",i[t.DATE_SHARED_COLUMN_KEY]="DateShared",i[t.SHARED_BY_COLUMN_KEY]="SharedBy",i[t.FILE_TYPE_ICON_COLUMN_KEY]="DocIcon",i)});
define("@ms/items-view/lib/private/components/columns/nameAndPath/nameAndPathColumn",["require","exports","tslib","react","../displayName/displayNameColumn","../../../models/Facet","../../fields/nameAndPath/NameAndPathField"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.nameAndPathColumn=n.__assign({},i.displayNameColumn,{key:new s.Facet("nameAndPathColumn").id,data:{},minWidth:445,maxWidth:445,onRender:function(e){return r.createElement(o.NameAndPathField,{itemKey:e.key})}})});
define("@ms/items-view/lib/private/components/fields/nameAndPath/NameAndPathField",["require","exports","tslib","react","../../withItemCache/WithItemCache","../nameHero/NameHeroField","../path/PathField","../../../facets/ItemFacets","../../withAction/WithAction","../../actions/defaultClick/DefaultClickAction"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.itemKey,t=function(){};return r.createElement(i.WithItemCache,null,function(n){var i=n.itemCache,l=i.demandItemFacet(u.parentFolderItemFacet,e),c=l&&i.demandItemFacet(u.openUrlFacet,l.itemKey),h=[];if(c){var p=new URL(c);h.push.apply(h,p.pathname.split("/").slice(1).map(function(e){return decodeURIComponent(e)}))}var d=l&&c&&r.createElement(a.WithAction,{action:r.createElement(f.ItemDefaultClickAction,{itemKey:l.itemKey})},function(e){var t=e.execute,n=e.isAvailable?function(e){t({event:e}).catch(function(){});e.preventDefault();e.stopPropagation()}:void 0;return r.createElement(o.PathField,{displayPathSegments:h,parentLink:c,onClick:n})});return r.createElement(s.NameHeroField,{itemKey:e,onClick:t},d)})};return t}(r.PureComponent);t.NameAndPathField=l});
define("@ms/items-view/lib/private/components/fields/path/PathField",["require","exports","react","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/Link","@uifabric/utilities/lib/css","@ms/utilities-strings/lib/index","./PathField.scss","../FieldStrings.resx"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PathField=function(e){var t=e.displayPathSegments,r=e.parentLink,l=e.target,c=e.onClick,h="",p=[];if(t){var d=t.join(" "+a.default.pathRendererAriaLabelSlash+" ");h=o.format(a.default.pathRendererLinkAriaLabel,d);p=f(t)}return n.createElement(i.Link,{dir:"auto",className:s.css(u.field),"aria-label":h,href:r,target:l,onClick:c,title:a.default.pathRendererLinkTitle},p)};function f(e){var t=[];if(!e.length)return t;var n=e.map(function(e){return e.trim()}),r=n[0],i=n.length>=2?n[1]:"",s=i?r.length+i.length+3+"…".length-60:0,o=n[n.length-1],u=r.length+o.length+2*(3+"…".length)-60;if(r.length>60){var a=r.substr(0,59).trim()+"…";t.push(l(a))}else if(1===e.length||r.length+3+"…".length>60||n.length>2&&r.length+2*(3+"…".length)>60)t.push(l(r));else if(2===n.length&&s>1){t.push(l(r));t.push(c());t.push(l("…"+i.substr(s).trim()))}else if(n.length>2&&u>1){var f=o.substr(u).trim();t.push(l(r));t.push(c());t.push(l("…"));if(f.length>0){t.push(c());t.push(l("…"+f))}}else{var h=0;t.push(l(r));h+=r.length;for(var p=1;p<e.length;++p){t.push(c());var d=n[p];t.push(l(d));h+=3+d.length}if(h>60){n.splice(1,1);t.splice(2,1,l("…"));h-=i.length-"…".length}for(;h>60;){var v=n.splice(1,1)[0];t.splice(3,2);h-=v.length+3}}return t}t.getDisplayPathElements=f;function l(e){return n.createElement("div",{className:s.css(u.pathSection)},e)}t.createDisplayPathElement=l;function c(){return n.createElement(r.Icon,{className:s.css(u.chevron),iconName:"ChevronRightSmall"})}t.createDisplayPathSeparator=c});
define("@ms/items-view/lib/private/components/fields/path/PathField.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".field_619bf667{display:inline-block;-webkit-box-sizing:border-box;box-sizing:border-box;max-width:100%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.pathSection_619bf667{display:inline;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}.chevron_619bf667{font-size:6px;margin:0px 4px;color:"},{theme:"neutralSecondaryAlt",defaultValue:"#767676"},{rawString:"}\n"}]);t.field="field_619bf667";t.pathSection="pathSection_619bf667";t.chevron="chevron_619bf667"});
define("@ms/items-view/lib/private/components/columns/dateFollowed/dateFollowedColumn",["require","exports","../createColumn","../columns.resx","../../../models/Facet","../../fields/date/DateField","../../../facets/ItemFacets","../../../facets/ConfigurationFacets","@ms/utilities-date-time/lib/relativePast"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dateFollowedColumn=n.createColumn({key:new i.Facet("dateFollowedColumn").id,name:r.default.SavedDate,fieldName:"",minWidth:n.ColumnWidth.regularMin,maxWidth:n.ColumnWidth.regularMax,isCollapsable:!0},s.DateField)(function(e,t){var n=e.demandItemFacet(o.dateFollowedFacet,t),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(u.localeFacet,u.configurationItemKey),s=i&&i.language||window.navigator.language;return s?{text:a.getRelativeDateTimeStringPast(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(o.dateFollowedFacet,t)})});
define("@ms/items-view/lib/private/components/fields/date/DateField",["require","exports","react","./DateField.scss","../baseText/BaseTextField"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DateField=function(e){var t=e.text,s=e.dateValue,o=e.indicatorEnabled,u=e.isDisabled,a=e.ariaLabel;a=a||t;var f=!1,l="string"==typeof s?new Date(s):"number"==typeof s?new Date(s):new Date("");!isNaN(l.getTime())&&o&&Math.abs(Date.now()-l.getTime())<=36e5&&(f=!0);t||isNaN(l.getTime())||(t=l.toLocaleString());return t?n.createElement(i.BaseText,{"data-automationid":"FieldRenderer-date",text:"",ariaLabel:a,isDisabled:u,noTextRender:!0},f&&n.createElement("span",{className:""+r.newItem},"✱"),t):null}});
define("@ms/items-view/lib/private/components/fields/date/DateField.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".newItem_fa6324c5{color:"},{theme:"green",defaultValue:"#107c10"},{rawString:";margin-right:3px}\n"}]);t.newItem="newItem_fa6324c5"});
define("@ms/items-view-addon-graph/lib/components/columns/itemActivityColumn",["require","exports","../../fields/itemActivity/ItemActivityField","./Columns.resx","@ms/items-view/lib/private/components/columns/createColumn","./ColumnKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemActivityColumn=i.createColumn({name:r.default.activityColumnHeaderText,fieldName:"itemActivityColumn",key:s.ITEM_ACTIVITY_COLUMN_KEY,minWidth:445,maxWidth:445},n.ItemActivityField)(function(e,t){return{itemKey:t,isCompact:!0,hideDate:!1}})});
define("@ms/items-view-addon-graph/lib/fields/itemActivity/ItemActivityField",["require","exports","tslib","react","../../models/facets/ItemActivityFacet","@ms/items-view/lib/private/facets/ItemFacets","@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/ItemActivity","@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/ItemActivities","@ms/shared-react-item-activity/lib/components/ItemActivities.resx","@ms/items-view/lib/private/components/decorators/connectToItemCache","@ms/items-view/lib/private/components/withAction/WithAction"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c;t.ItemActivity=o.default;function h(e,t){var n=e.activity;if(n){var r,i=(r=n.type,p[r]);return i?new i({activity:n,canOpenItem:function(){return!1},containingItem:{absolutePath:"",isFolder:!1,name:t,graphItemUrl:""},currentUserEmail:"",isSingleLevel:!0,onItemClick:function(){},strings:a.default}):void 0}}var p=((c={})[0]=u.EditItemActivity,c[1]=u.MoveItemActivity,c[2]=u.CommentItemActivity,c[3]=u.CommentResponseItemActivity,c[4]=u.MentionItemActivity,c[5]=u.VersionItemActivity,c[6]=u.RestoreItemActivity,c[9]=u.RenameItemActivity,c[10]=u.DeleteItemActivity,c[11]=u.CreateItemActivity,c[12]=u.ShareItemActivity,c);function d(e,t){var n=t.itemKey,r=e.demandItemFacet(s.activityItemFacet,n),o=r&&r.itemKey;if(!e.demandItemFacet(s.folderFacet,n)){var u=e.demandItemFacet(s.fileNameFacet,n),a=e.demandItemFacet(i.itemActivityFacet,o);return a&&u&&h({activity:a},u.name)}}t.getItemActivity=d;t.ItemActivityField=f.connectToItemCache(function(e,t){var i=t.itemKey,s=n.__rest(t,["itemKey"]),u=d(e,{itemKey:i});return{action:u?r.createElement(o.default,n.__assign({activity:u},s)):null}})(l.ActionSelector)});
define("@ms/items-view-addon-graph/lib/models/facets/ItemActivityFacet",["require","exports","@ms/items-view/lib/private/models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemActivityFacet=new n.Facet("activity")});
define("@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/ItemActivity",["require","exports","tslib","react","office-ui-fabric-react/lib/components/ActivityItem/ActivityItem","office-ui-fabric-react/lib/components/ActivityItem/ActivityItem.styles","office-ui-fabric-react/lib/components/ActivityItem/ActivityItem.classNames","office-ui-fabric-react/lib/Icon","office-ui-fabric-react/lib/FocusZone","@ms/odsp-utilities/lib/dateTime/DateTime","office-ui-fabric-react/lib/Utilities","@ms/odsp-datasources/lib/providers/theming/FluentFeatures","../../../utilities/theme/FluentColors","./ItemActivity.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t,n)||this;i._onRenderIcon=function(){var e=i.props.activity.getIconName();return r.createElement(u.Icon,{iconName:e})};i._onRenderActivityDescription=function(){return r.createElement("div",{className:"od-ItemActivity-item-textContent"},i.props.activity.getTitle({isCompact:i.props.isCompact,hideDate:i.props.hideDate}))};i._onRenderActivityTimeStamp=function(e,t){if(i.props.isCompact){var n=s.getStyles(void 0,void 0),u=o.getClassNames(n,e.className,e.activityPersonas,e.isCompact);return r.createElement("div",{className:l.css(u.timeStamp,"od-ItemActivity-timeStamp")},e.timeStamp)}return t?t(e):null};i._onRenderHiddenTimeStamp=function(e,t){return null};i._onRenderActivityDescription=i._onRenderActivityDescription.bind(i);i._onRenderIcon=i._onRenderIcon.bind(i);return i}t.prototype.render=function(){var e=this.props,t=e.activity,n=e.isCompact,s=e.hideDate,o=e.isInGrid,u=(e.children,this.props.activity.getIconName()),f=c.isFluentActiveOD?{root:{color:h.NeutralColors.gray130},activityTypeIcon:{color:h.SharedColors.cyanBlue10,height:"16px",marginTop:"8px"}}:void 0,p=t.getResponse(),d=t.getContextualMenu();return r.createElement(a.FocusZone,{className:"od-ItemActivity-item-focusZone",direction:a.FocusZoneDirection.horizontal,handleTabKey:a.FocusZoneTabbableElements.all,"data-is-focusable":!0,"aria-label":this._getAriaLabel(),role:o?"row":void 0},r.createElement("div",{role:o?"gridcell":void 0,key:"activity_"+t.getKey(),className:l.css({"od-ItemActivityList-activity-withCommentResponse":!!p},"od-ItemActivityList-activity")},r.createElement(i.ActivityItem,{key:t.getKey(),className:"od-ItemActivity-item",onRenderActivityDescription:this._onRenderActivityDescription,onRenderIcon:u&&this._onRenderIcon||void 0,activityPersonas:[{imageUrl:t.getPersonaIconUrl()}],timeStamp:this._onRenderDate(),onRenderTimeStamp:s?this._onRenderHiddenTimeStamp:this._onRenderActivityTimeStamp,isCompact:n,styles:f})),d,p)};t.prototype._onRenderDate=function(){var e=this.props.activity;return(f.getRelativeDateTimeStringForLists(e.getFriendlyDisplayTime()||"")||f.getFriendlyDateTimeStringPast(e.getDate())).toString()};t.prototype._getAriaLabel=function(){return this.props.activity.getDescription({stringOnly:!0}).join("")+" "+this._onRenderDate()};return t}(r.Component);t.default=p});
define("office-ui-fabric-react/lib/components/ActivityItem/ActivityItem",["require","exports","tslib","react","./ActivityItem.classNames","./ActivityItem.styles","../../Persona"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._onRenderIcon=function(e){return e.activityPersonas?i._onRenderPersonaArray(e):i.props.activityIcon};i._onRenderActivityDescription=function(e){var t=i._getClassNames(e),n=e.activityDescription||e.activityDescriptionText;return n?r.createElement("span",{className:t.activityText},n):null};i._onRenderComments=function(e){var t=i._getClassNames(e),n=e.comments||e.commentText;return!e.isCompact&&n?r.createElement("div",{className:t.commentText},n):null};i._onRenderTimeStamp=function(e){var t=i._getClassNames(e);return!e.isCompact&&e.timeStamp?r.createElement("div",{className:t.timeStamp},e.timeStamp):null};i._onRenderPersonaArray=function(e){var t=i._getClassNames(e),s=null,u=e.activityPersonas;if(u[0].imageUrl||u[0].imageInitials){var a=[],f=u.length>1||e.isCompact,l=e.isCompact?3:4,c=void 0;e.isCompact&&(c={display:"inline-block",width:"10px",minWidth:"10px",overflow:"visible"});u.filter(function(e,t){return t<l}).forEach(function(e,i){a.push(r.createElement(o.PersonaCoin,n.__assign({},e,{key:e.key?e.key:i,className:t.activityPersona,size:f?o.PersonaSize.size16:o.PersonaSize.size32,style:c})))});s=r.createElement("div",{className:t.personaContainer},a)}return s};return i}t.prototype.render=function(){var e=this.props,t=e.onRenderIcon,n=void 0===t?this._onRenderIcon:t,i=e.onRenderActivityDescription,s=void 0===i?this._onRenderActivityDescription:i,o=e.onRenderComments,u=void 0===o?this._onRenderComments:o,a=e.onRenderTimeStamp,f=void 0===a?this._onRenderTimeStamp:a,l=e.animateBeaconSignal,c=e.isCompact,h=this._getClassNames(this.props);return r.createElement("div",{className:h.root,style:this.props.style},(this.props.activityPersonas||this.props.activityIcon||this.props.onRenderIcon)&&r.createElement("div",{className:h.activityTypeIcon},l&&c&&r.createElement("div",{className:h.pulsingBeacon}),n(this.props)),r.createElement("div",{className:h.activityContent},s(this.props,this._onRenderActivityDescription),u(this.props,this._onRenderComments),f(this.props,this._onRenderTimeStamp)))};t.prototype._getClassNames=function(e){return i.getClassNames(s.getStyles(void 0,e.styles,e.animateBeaconSignal,e.beaconColorOne,e.beaconColorTwo,e.isCompact),e.className,e.activityPersonas,e.isCompact)};return t}(r.Component);t.ActivityItem=u});
define("office-ui-fabric-react/lib/components/ActivityItem/ActivityItem.classNames",["require","exports","../../Styling","../../Utilities"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getClassNames=r.memoizeFunction(function(e,t,r,i){return{root:n.mergeStyles("ms-ActivityItem",t,e.root,i&&e.isCompactRoot),pulsingBeacon:n.mergeStyles("ms-ActivityItem-pulsingBeacon",e.pulsingBeacon),personaContainer:n.mergeStyles("ms-ActivityItem-personaContainer",e.personaContainer,i&&e.isCompactPersonaContainer),activityPersona:n.mergeStyles("ms-ActivityItem-activityPersona",e.activityPersona,i&&e.isCompactPersona,!i&&r&&2===r.length&&e.doublePersona),activityTypeIcon:n.mergeStyles("ms-ActivityItem-activityTypeIcon",e.activityTypeIcon,i&&e.isCompactIcon),activityContent:n.mergeStyles("ms-ActivityItem-activityContent",e.activityContent,i&&e.isCompactContent),activityText:n.mergeStyles("ms-ActivityItem-activityText",e.activityText),commentText:n.mergeStyles("ms-ActivityItem-commentText",e.commentText),timeStamp:n.mergeStyles("ms-ActivityItem-timeStamp",e.timeStamp,i&&e.isCompactTimeStamp)}})});
define("office-ui-fabric-react/lib/components/ActivityItem/ActivityItem.styles",["require","exports","../../Styling","../../Utilities"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getStyles=r.memoizeFunction(function(e,t,r,i,s,o){void 0===e&&(e=n.getTheme());var u,a=n.PulsingBeaconAnimationStyles.continuousPulseAnimationSingle(i||e.palette.themePrimary,s||e.palette.themeTertiary,"4px","28px","4px"),f=n.keyframes({from:{opacity:0},to:{opacity:1}}),l={animationName:a,animationIterationCount:"1",animationDuration:".8s",zIndex:1},c={animationName:n.keyframes({from:{transform:"translateX(-10px)"},to:{transform:"translateX(0)"}}),animationIterationCount:"1",animationDuration:".5s"},h={animationName:f,animationIterationCount:"1",animationDuration:".5s"},p={root:[e.fonts.small,{display:"flex",justifyContent:"flex-start",alignItems:"flex-start",boxSizing:"border-box",color:e.palette.neutralSecondary},o&&r&&h],pulsingBeacon:[{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"0px",height:"0px",borderRadius:"225px",borderStyle:"solid",opacity:0},o&&r&&l],isCompactRoot:{alignItems:"center"},personaContainer:{display:"flex",flexWrap:"wrap",minWidth:"32px",width:"32px",height:"32px"},isCompactPersonaContainer:{display:"inline-flex",flexWrap:"nowrap",flexBasis:"auto",height:"16px",width:"auto",minWidth:"0",paddingRight:"6px"},activityTypeIcon:{height:"32px",fontSize:"16px",lineHeight:"16px",marginTop:"3px"},isCompactIcon:{height:"16px",minWidth:"16px",fontSize:"13px",lineHeight:"13px",color:e.palette.themePrimary,marginTop:"1px",position:"relative",display:"flex",justifyContent:"center",alignItems:"center",selectors:{".ms-Persona-imageArea":{margin:"-2px 0 0 -2px",border:"2px solid"+e.palette.white,borderRadius:"50%",selectors:(u={},u[n.HighContrastSelector]={border:"none",margin:"0"},u)}}},activityPersona:{display:"block"},doublePersona:{selectors:{":first-child":{alignSelf:"flex-end"}}},isCompactPersona:{display:"inline-block",width:"8px",minWidth:"8px",overflow:"visible"},activityContent:[{padding:"0 8px"},o&&r&&c],activityText:{display:"inline"},isCompactContent:{flex:"1",padding:"0 4px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflowX:"hidden"},commentText:{color:e.palette.neutralPrimary},timeStamp:[e.fonts.tiny,{fontWeight:400,color:e.palette.neutralSecondary}],isCompactTimeStamp:{display:"inline-block",paddingLeft:"0.3em",fontSize:"1em"}};return n.concatStyleSets(p,t)})});
define("office-ui-fabric-react/lib/Persona",["require","exports","tslib","./components/Persona/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("office-ui-fabric-react/lib/components/Persona/index",["require","exports","tslib","./Persona","./Persona.base","./Persona.types","./PersonaCoin/index","./PersonaConsts","./PersonaInitialsColor"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t);t.getPersonaInitialsColor=a.getPersonaInitialsColor});
define("office-ui-fabric-react/lib/components/Persona/Persona",["require","exports","../../Utilities","./Persona.base","./Persona.styles"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Persona=n.styled(r.PersonaBase,i.getStyles,void 0,{scope:"Persona"})});
define("office-ui-fabric-react/lib/components/Persona/Persona.base",["require","exports","tslib","react","../../Utilities","../../Tooltip","./PersonaCoin/PersonaCoin","./Persona.types"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i.classNamesFunction(),f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._warnDeprecations({primaryText:"text"});return n}t.prototype.render=function(){var e=this._onRenderText(this._getText()),t=this._onRenderText(this.props.secondaryText),s=this._onRenderText(this.props.tertiaryText),f=this._onRenderText(this.props.optionalText),l=this.props,c=l.hidePersonaDetails,h=l.onRenderOptionalText,p=void 0===h?f:h,d=l.onRenderPrimaryText,v=void 0===d?e:d,m=l.onRenderSecondaryText,g=void 0===m?t:m,y=l.onRenderTertiaryText,b=void 0===y?s:y,w=this.props.size,E=this.props,S=E.allowPhoneInitials,x=E.className,T=E.coinProps,N=E.showUnknownPersonaCoin,C=E.coinSize,k=E.styles,L=E.imageAlt,A=E.imageInitials,O=E.imageShouldFadeIn,M=E.imageShouldStartVisible,_=E.imageUrl,D=E.initialsColor,P=E.isOutOfOffice,H=E.onPhotoLoadingStateChange,B=E.onRenderCoin,j=E.onRenderInitials,F=E.presence,I=E.presenceTitle,q=E.showInitialsUntilImageLoads,R=E.showSecondaryText,U=E.theme,z=n.__assign({allowPhoneInitials:S,showUnknownPersonaCoin:N,coinSize:C,imageAlt:L,imageInitials:A,imageShouldFadeIn:O,imageShouldStartVisible:M,imageUrl:_,initialsColor:D,onPhotoLoadingStateChange:H,onRenderCoin:B,onRenderInitials:j,presence:F,presenceTitle:I,showInitialsUntilImageLoads:q,size:w,text:this._getText(),isOutOfOffice:P},T),W=a(k,{theme:U,className:x,showSecondaryText:R,presence:F,size:w}),X=i.getNativeProps(this.props,i.divProperties),V=r.createElement("div",{className:W.details},this._renderElement(W.primaryText,v,e),this._renderElement(W.secondaryText,g,t),this._renderElement(W.tertiaryText,b,s),this._renderElement(W.optionalText,p,f),this.props.children);return r.createElement("div",n.__assign({},X,{className:W.root,style:C?{height:C,minWidth:C}:void 0}),r.createElement(o.PersonaCoin,n.__assign({},z)),(!c||w===u.PersonaSize.size10||w===u.PersonaSize.tiny)&&V)};t.prototype._renderElement=function(e,t,n){return r.createElement("div",{dir:"auto",className:e},t&&t(this.props,n))};t.prototype._getText=function(){return this.props.text||this.props.primaryText||""};t.prototype._onRenderText=function(e){return e?function(){return r.createElement(s.TooltipHost,{content:e,overflowMode:s.TooltipOverflowMode.Parent,directionalHint:s.DirectionalHint.topLeftEdge},e)}:void 0};t.defaultProps={size:u.PersonaSize.size48,presence:u.PersonaPresence.none,imageAlt:""};return t}(i.BaseComponent);t.PersonaBase=f});
define("office-ui-fabric-react/lib/components/Persona/PersonaCoin/PersonaCoin",["require","exports","../../../Utilities","./PersonaCoin.base","./PersonaCoin.styles"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PersonaCoin=n.styled(r.PersonaCoinBase,i.getStyles,void 0,{scope:"PersonaCoin"})});
define("office-ui-fabric-react/lib/components/Persona/PersonaCoin/PersonaCoin.base",["require","exports","tslib","react","../../../Utilities","../../../Styling","../PersonaPresence/index","../../../Icon","../../../Image","../Persona.types","../PersonaInitialsColor","../PersonaConsts"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=i.classNamesFunction(),p=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onRenderCoin=function(e){var t=n.props,i=t.coinSize,s=t.styles,o=t.imageUrl,u=t.imageAlt,f=t.imageShouldFadeIn,l=t.imageShouldStartVisible,p=t.theme,d=t.showUnknownPersonaCoin;if(!o)return null;var v=n.props.size,m=h(s,{theme:p,size:v,showUnknownPersonaCoin:d}),g=i||c.sizeToPixels[v];return r.createElement(a.Image,{className:m.image,imageFit:a.ImageFit.cover,src:o,width:g,height:g,alt:u,shouldFadeIn:f,shouldStartVisible:l,onLoadingStateChange:n._onPhotoLoadingStateChange})};n._onRenderInitials=function(e){var t=e.imageInitials,s=e.allowPhoneInitials;if(e.showUnknownPersonaCoin)return r.createElement(u.Icon,{iconName:"Help"});var o=i.getRTL();return""!==(t=t||i.getInitials(n._getText(),o,s))?r.createElement("span",null,t):r.createElement(u.Icon,{iconName:"Contact"})};n._onPhotoLoadingStateChange=function(e){n.setState({isImageLoaded:e===a.ImageLoadState.loaded,isImageError:e===a.ImageLoadState.error});n.props.onPhotoLoadingStateChange&&n.props.onPhotoLoadingStateChange(e)};n._warnDeprecations({primaryText:"text"});n.state={isImageLoaded:!1,isImageError:!1};return n}t.prototype.componentWillReceiveProps=function(e){e.imageUrl!==this.props.imageUrl&&this.setState({isImageLoaded:!1,isImageError:!1})};t.prototype.render=function(){var e=this.props,t=e.className,a=e.coinProps,c=e.showUnknownPersonaCoin,p=e.coinSize,d=e.styles,v=e.imageUrl,m=e.isOutOfOffice,g=e.onRenderCoin,y=void 0===g?this._onRenderCoin:g,b=e.onRenderInitials,w=void 0===b?this._onRenderInitials:b,E=e.presence,S=e.presenceTitle,x=e.showInitialsUntilImageLoads,T=e.theme,N=this.props.size,C=i.getNativeProps(this.props,i.divProperties),k=i.getNativeProps(a||{},i.divProperties),L=p?{width:p,height:p}:void 0,A=c,O={coinSize:p,isOutOfOffice:m,presence:E,presenceTitle:S,size:N,theme:T},M=h(d,{theme:T,className:a&&a.className?a.className:t,size:N,coinSize:p,showUnknownPersonaCoin:c}),_=Boolean(!this.state.isImageLoaded&&(x&&v||!v||this.state.isImageError||A));return r.createElement("div",n.__assign({},C,{className:M.coin}),N!==f.PersonaSize.size10&&N!==f.PersonaSize.tiny?r.createElement("div",n.__assign({},k,{className:M.imageArea,style:L}),_&&r.createElement("div",{className:s.mergeStyles(M.initials,!c&&{backgroundColor:l.getPersonaInitialsColor(this.props)}),style:L,"aria-hidden":"true"},w(this.props,this._onRenderInitials)),!A&&y(this.props,this._onRenderCoin),r.createElement(o.PersonaPresence,n.__assign({},O))):this.props.presence?r.createElement(o.PersonaPresence,n.__assign({},O)):r.createElement(u.Icon,{iconName:"Contact",className:M.size10WithoutPresenceIcon}),this.props.children)};t.prototype._getText=function(){return this.props.text||this.props.primaryText||""};t.defaultProps={size:f.PersonaSize.size48,presence:f.PersonaPresence.none,imageAlt:""};return t}(i.BaseComponent);t.PersonaCoinBase=p});
define("office-ui-fabric-react/lib/components/Persona/PersonaPresence/index",["require","exports","tslib","./PersonaPresence","./PersonaPresence.base"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("office-ui-fabric-react/lib/components/Persona/PersonaPresence/PersonaPresence",["require","exports","../../../Utilities","./PersonaPresence.base","./PersonaPresence.styles"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PersonaPresence=n.styled(r.PersonaPresenceBase,i.getStyles,void 0,{scope:"PersonaPresence"})});
define("office-ui-fabric-react/lib/components/Persona/PersonaPresence/PersonaPresence.base",["require","exports","tslib","react","../../../Utilities","../../../Icon","../Persona.types","../PersonaConsts"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i.classNamesFunction(),f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onRenderIcon=function(e,t){return r.createElement(s.Icon,{className:e,iconName:l(n.props.presence,n.props.isOutOfOffice),style:t})};return n}t.prototype.render=function(){var e=this.props,t=e.coinSize,n=e.isOutOfOffice,i=e.styles,s=e.presence,f=e.theme,l=e.presenceTitle,c=u.sizeBoolean(this.props.size),h=!(c.isSize10||c.isSize16||c.isSize24||c.isSize28||c.isSize32)&&(!t||t>32),p=t?t/3<40?t/3+"px":"40px":"",d=t?{fontSize:t?t/6<20?t/6+"px":"20px":"",lineHeight:p}:void 0,v=t?{width:p,height:p}:void 0,m=a(i,{theme:f,presence:s,size:this.props.size,isOutOfOffice:n});return s===o.PersonaPresence.none?null:r.createElement("div",{className:m.presence,style:v,title:l},h&&this._onRenderIcon(m.presenceIcon,d))};return t}(i.BaseComponent);t.PersonaPresenceBase=f;function l(e,t){if(e){switch(o.PersonaPresence[e]){case"online":return"SkypeCheck";case"away":return t?"SkypeArrow":"SkypeClock";case"dnd":return"SkypeMinus";case"offline":return t?"SkypeArrow":""}return""}}});
define("office-ui-fabric-react/lib/components/Persona/Persona.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.tiny=0]="tiny";e[e.extraExtraSmall=1]="extraExtraSmall";e[e.extraSmall=2]="extraSmall";e[e.small=3]="small";e[e.regular=4]="regular";e[e.large=5]="large";e[e.extraLarge=6]="extraLarge";e[e.size28=7]="size28";e[e.size16=8]="size16";e[e.size10=9]="size10";e[e.size24=10]="size24";e[e.size32=11]="size32";e[e.size40=12]="size40";e[e.size48=13]="size48";e[e.size72=14]="size72";e[e.size100=15]="size100"}(t.PersonaSize||(t.PersonaSize={}));!function(e){e[e.none=0]="none";e[e.offline=1]="offline";e[e.online=2]="online";e[e.away=3]="away";e[e.dnd=4]="dnd";e[e.blocked=5]="blocked";e[e.busy=6]="busy"}(t.PersonaPresence||(t.PersonaPresence={}));!function(e){e[e.lightBlue=0]="lightBlue";e[e.blue=1]="blue";e[e.darkBlue=2]="darkBlue";e[e.teal=3]="teal";e[e.lightGreen=4]="lightGreen";e[e.green=5]="green";e[e.darkGreen=6]="darkGreen";e[e.lightPink=7]="lightPink";e[e.pink=8]="pink";e[e.magenta=9]="magenta";e[e.purple=10]="purple";e[e.black=11]="black";e[e.orange=12]="orange";e[e.red=13]="red";e[e.darkRed=14]="darkRed";e[e.transparent=15]="transparent";e[e.violet=16]="violet";e[e.lightRed=17]="lightRed";e[e.gold=18]="gold";e[e.burgundy=19]="burgundy";e[e.warmGray=20]="warmGray";e[e.coolGray=21]="coolGray";e[e.gray=22]="gray";e[e.cyan=23]="cyan";e[e.rust=24]="rust"}(t.PersonaInitialsColor||(t.PersonaInitialsColor={}))});
define("office-ui-fabric-react/lib/components/Persona/PersonaConsts",["require","exports","./Persona.types"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;!function(e){e.size10="20px";e.size16="16px";e.size24="24px";e.size28="28px";e.size32="32px";e.size40="40px";e.size48="48px";e.size72="72px";e.size100="100px"}(t.personaSize||(t.personaSize={}));!function(e){e.size6="6px";e.size8="8px";e.size12="12px";e.size20="20px";e.size28="28px";e.border="2px"}(t.personaPresenceSize||(t.personaPresenceSize={}));t.sizeBoolean=function(e){return{isSize10:e===n.PersonaSize.size10||e===n.PersonaSize.tiny,isSize16:e===n.PersonaSize.size16,isSize24:e===n.PersonaSize.size24||e===n.PersonaSize.extraExtraSmall,isSize28:e===n.PersonaSize.size28||e===n.PersonaSize.extraSmall,isSize32:e===n.PersonaSize.size32,isSize40:e===n.PersonaSize.size40||e===n.PersonaSize.small,isSize48:e===n.PersonaSize.size48||e===n.PersonaSize.regular,isSize72:e===n.PersonaSize.size72||e===n.PersonaSize.large,isSize100:e===n.PersonaSize.size100||e===n.PersonaSize.extraLarge}};t.sizeToPixels=((r={})[n.PersonaSize.tiny]=10,r[n.PersonaSize.extraExtraSmall]=24,r[n.PersonaSize.extraSmall]=28,r[n.PersonaSize.small]=40,r[n.PersonaSize.regular]=48,r[n.PersonaSize.large]=72,r[n.PersonaSize.extraLarge]=100,r[n.PersonaSize.size10]=10,r[n.PersonaSize.size16]=16,r[n.PersonaSize.size24]=24,r[n.PersonaSize.size28]=28,r[n.PersonaSize.size32]=32,r[n.PersonaSize.size40]=40,r[n.PersonaSize.size48]=48,r[n.PersonaSize.size72]=72,r[n.PersonaSize.size100]=100,r);t.presenceBoolean=function(e){return{isAvailable:e===n.PersonaPresence.online,isAway:e===n.PersonaPresence.away,isBlocked:e===n.PersonaPresence.blocked,isBusy:e===n.PersonaPresence.busy,isDoNotDisturb:e===n.PersonaPresence.dnd,isOffline:e===n.PersonaPresence.offline}}});
define("office-ui-fabric-react/lib/components/Persona/PersonaPresence/PersonaPresence.styles",["require","exports","../../../Styling","../PersonaConsts"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={presence:"ms-Persona-presence",presenceIcon:"ms-Persona-presenceIcon"};t.getStyles=function(e){var t,f,l,c,h,p,d=e.theme,v=d.semanticColors,m=n.getGlobalClassNames(i,d),g=r.sizeBoolean(e.size),y=r.presenceBoolean(e.presence),b=y.isOffline||e.isOutOfOffice&&(y.isAvailable||y.isBusy||y.isAway||y.isDoNotDisturb),w=g.isSize72||g.isSize100?"2px":"1px";return{presence:[m.presence,{position:"absolute",height:r.personaPresenceSize.size12,width:r.personaPresenceSize.size12,borderRadius:"50%",top:"auto",right:"-2px",bottom:"-2px",border:"2px solid "+v.bodyBackground,textAlign:"center",boxSizing:"content-box",backgroundClip:"content-box",MsHighContrastAdjust:"none",selectors:(t={},t[n.HighContrastSelector]={borderColor:"Window",backgroundColor:"WindowText"},t)},g.isSize10&&{right:"auto",top:"7px",left:0,border:0,selectors:(f={},f[n.HighContrastSelector]={top:"9px",border:"1px solid WindowText"},f)},(g.isSize10||g.isSize24||g.isSize28||g.isSize32)&&u(r.personaPresenceSize.size8),(g.isSize40||g.isSize48)&&u(r.personaPresenceSize.size12),g.isSize16&&{height:r.personaPresenceSize.size6,width:r.personaPresenceSize.size6,borderWidth:"1.5px"},g.isSize72&&u(r.personaPresenceSize.size20),g.isSize100&&u(r.personaPresenceSize.size28),y.isAvailable&&{backgroundColor:"#7FBA00",selectors:(l={},l[n.HighContrastSelector]=a("Highlight"),l)},y.isAway&&a("#FCD116"),y.isBlocked&&[{selectors:(c={":after":g.isSize40||g.isSize48||g.isSize72||g.isSize100?{content:'""',width:"100%",height:w,backgroundColor:"#D93B3B",transform:"translateY(-50%) rotate(-45deg)",position:"absolute",top:"50%",left:0}:void 0},c[n.HighContrastSelector]={selectors:{":after":{width:"calc(100% - 4px)",left:"2px",backgroundColor:"Window"}}},c)}],y.isBusy&&a("#D93B3B"),y.isDoNotDisturb&&a("#E81123"),y.isOffline&&a("#93ABBD"),(b||y.isBlocked)&&[{backgroundColor:v.bodyBackground,selectors:(h={":before":{content:'""',width:"100%",height:"100%",position:"absolute",top:0,left:0,border:w+" solid #D93B3B",borderRadius:"50%",boxSizing:"border-box"}},h[n.HighContrastSelector]={backgroundColor:"WindowText",selectors:{":before":{width:"calc(100% - 2px)",height:"calc(100% - 2px)",top:"1px",left:"1px",borderColor:"Window"}}},h)}],b&&y.isAvailable&&o(w,"#7FBA00"),b&&y.isBusy&&o(w,"#D93B3B"),b&&y.isAway&&o(w,"#B4009E"),b&&y.isDoNotDisturb&&o(w,"#E81123"),b&&y.isOffline&&o(w,"#93ABBD"),b&&y.isOffline&&e.isOutOfOffice&&o(w,"#B4009E")],presenceIcon:[m.presenceIcon,{color:v.bodyBackground,fontSize:"6px",lineHeight:r.personaPresenceSize.size12,verticalAlign:"top",selectors:(p={},p[n.HighContrastSelector]={color:"Window"},p)},g.isSize72&&{fontSize:n.FontSizes.small,lineHeight:r.personaPresenceSize.size20},g.isSize100&&{fontSize:n.FontSizes.medium,lineHeight:r.personaPresenceSize.size28},y.isAway&&{position:"relative",left:b?void 0:"1px"},b&&y.isAvailable&&s("#7FBA00"),b&&y.isBusy&&s("#D93B3B"),b&&y.isAway&&s("#B4009E"),b&&y.isDoNotDisturb&&s("#E81123"),b&&y.isOffline&&s("#93ABBD"),b&&y.isOffline&&e.isOutOfOffice&&s("#B4009E")]}};function s(e){return{color:e,borderColor:e}}function o(e,t){return{selectors:{":before":{border:e+" solid "+t}}}}function u(e){return{height:e,width:e}}function a(e){return{backgroundColor:e}}});
define("office-ui-fabric-react/lib/components/Persona/PersonaInitialsColor",["require","exports","./Persona.types"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=[n.PersonaInitialsColor.lightBlue,n.PersonaInitialsColor.blue,n.PersonaInitialsColor.darkBlue,n.PersonaInitialsColor.teal,n.PersonaInitialsColor.green,n.PersonaInitialsColor.darkGreen,n.PersonaInitialsColor.lightPink,n.PersonaInitialsColor.pink,n.PersonaInitialsColor.magenta,n.PersonaInitialsColor.purple,n.PersonaInitialsColor.orange,n.PersonaInitialsColor.lightRed,n.PersonaInitialsColor.darkRed,n.PersonaInitialsColor.violet,n.PersonaInitialsColor.gold,n.PersonaInitialsColor.burgundy,n.PersonaInitialsColor.warmGray,n.PersonaInitialsColor.cyan,n.PersonaInitialsColor.rust,n.PersonaInitialsColor.coolGray],i=r.length;t.initialsColorPropToColorCode=function(e){return s(e)};function s(e){var t=e.primaryText,s=e.text,o=e.initialsColor;return"string"==typeof o?o:function(e){switch(e){case n.PersonaInitialsColor.lightBlue:return"#4F6BED";case n.PersonaInitialsColor.blue:return"#0078D4";case n.PersonaInitialsColor.darkBlue:return"#004E8C";case n.PersonaInitialsColor.teal:return"#038387";case n.PersonaInitialsColor.lightGreen:case n.PersonaInitialsColor.green:return"#498205";case n.PersonaInitialsColor.darkGreen:return"#0B6A0B";case n.PersonaInitialsColor.lightPink:return"#C239B3";case n.PersonaInitialsColor.pink:return"#E3008C";case n.PersonaInitialsColor.magenta:return"#881798";case n.PersonaInitialsColor.purple:return"#5C2E91";case n.PersonaInitialsColor.orange:return"#CA5010";case n.PersonaInitialsColor.red:return"#EE1111";case n.PersonaInitialsColor.lightRed:return"#D13438";case n.PersonaInitialsColor.darkRed:return"#A4262C";case n.PersonaInitialsColor.transparent:return"transparent";case n.PersonaInitialsColor.violet:return"#8764B8";case n.PersonaInitialsColor.gold:return"#986F0B";case n.PersonaInitialsColor.burgundy:return"#750B1C";case n.PersonaInitialsColor.warmGray:return"#7A7574";case n.PersonaInitialsColor.cyan:return"#005B70";case n.PersonaInitialsColor.rust:return"#8E562E";case n.PersonaInitialsColor.coolGray:return"#69797E";case n.PersonaInitialsColor.black:return"#1D1D1D";case n.PersonaInitialsColor.gray:return"#393939"}}(o=void 0!==o?o:function(e){var t=n.PersonaInitialsColor.blue;if(!e)return t;for(var s=0,o=e.length-1;o>=0;o--){var u=e.charCodeAt(o),a=o%8;s^=(u<<a)+(u>>8-a)}return t=r[s%i]}(s||t))}t.getPersonaInitialsColor=s});
define("office-ui-fabric-react/lib/components/Persona/PersonaCoin/PersonaCoin.styles",["require","exports","../../../Styling","../PersonaConsts"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={coin:"ms-Persona-coin",imageArea:"ms-Persona-imageArea",image:"ms-Persona-image",initials:"ms-Persona-initials",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size72:"ms-Persona--size72",size100:"ms-Persona--size100"};t.getStyles=function(e){var t,s=e.className,o=e.theme,u=e.coinSize,a=o.palette,f=r.sizeBoolean(e.size),l=n.getGlobalClassNames(i,o),c=u||e.size&&r.sizeToPixels[e.size]||48;return{coin:[l.coin,o.fonts.medium,f.isSize10&&l.size10,f.isSize16&&l.size16,f.isSize24&&l.size24,f.isSize28&&l.size28,f.isSize32&&l.size32,f.isSize40&&l.size40,f.isSize48&&l.size48,f.isSize72&&l.size72,f.isSize100&&l.size100,s],size10WithoutPresenceIcon:{fontSize:"10px",position:"absolute",top:"5px",right:"auto",left:0},imageArea:[l.imageArea,{position:"relative",textAlign:"center",flex:"0 0 auto",height:c,width:c},c<=10&&{overflow:"visible",background:"transparent",height:0,width:0}],image:[l.image,{marginRight:"10px",position:"absolute",top:0,left:0,width:"100%",height:"100%",border:0,borderRadius:"50%",perspective:"1px"},c<=10&&{overflow:"visible",background:"transparent",height:0,width:0},c>10&&{height:c,width:c}],initials:[l.initials,{borderRadius:"50%",color:e.showUnknownPersonaCoin?"rgb(168, 0, 0)":a.white,fontSize:n.FontSizes.large,fontWeight:n.FontWeights.regular,lineHeight:48===c?46:c,height:c,selectors:(t={},t[n.HighContrastSelector]={border:"1px solid WindowText",MsHighContrastAdjust:"none",color:"WindowText",boxSizing:"border-box",backgroundColor:"Window !important"},t)},e.showUnknownPersonaCoin&&{backgroundColor:"rgb(234, 234, 234)"},c<32&&{fontSize:n.FontSizes.xSmall},c>=32&&c<48&&{fontSize:n.FontSizes.medium},c>=72&&c<100&&{fontSize:n.FontSizes.xxLarge},c>=100&&{fontSize:n.FontSizes.superLarge}]}}});
define("office-ui-fabric-react/lib/components/Persona/Persona.styles",["require","exports","../../Styling","./PersonaConsts"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={root:"ms-Persona",size10:"ms-Persona--size10",size16:"ms-Persona--size16",size24:"ms-Persona--size24",size28:"ms-Persona--size28",size32:"ms-Persona--size32",size40:"ms-Persona--size40",size48:"ms-Persona--size48",size72:"ms-Persona--size72",size100:"ms-Persona--size100",available:"ms-Persona--online",away:"ms-Persona--away",blocked:"ms-Persona--blocked",busy:"ms-Persona--busy",doNotDisturb:"ms-Persona--donotdisturb",offline:"ms-Persona--offline",details:"ms-Persona-details",primaryText:"ms-Persona-primaryText",secondaryText:"ms-Persona-secondaryText",tertiaryText:"ms-Persona-tertiaryText",optionalText:"ms-Persona-optionalText",textContent:"ms-Persona-textContent"};t.getStyles=function(e){var t=e.className,s=e.showSecondaryText,o=e.theme,u=o.palette,a=n.getGlobalClassNames(i,o),f=r.sizeBoolean(e.size),l=r.presenceBoolean(e.presence),c={color:u.neutralSecondary,fontWeight:n.FontWeights.regular,fontSize:n.FontSizes.small};return{root:[a.root,o.fonts.medium,n.normalize,{color:u.neutralPrimary,fontSize:n.FontSizes.medium,fontWeight:n.FontWeights.regular,position:"relative",height:r.personaSize.size48,minWidth:r.personaSize.size48,display:"flex",alignItems:"center",selectors:{".contextualHost":{display:"none"},":hover":{selectors:{$primaryText:{color:u.neutralDark}}}}},f.isSize10&&[a.size10,{height:r.personaSize.size10,minWidth:r.personaSize.size10}],f.isSize16&&[a.size16,{height:r.personaSize.size16,minWidth:r.personaSize.size16}],f.isSize24&&[a.size24,{height:r.personaSize.size24,minWidth:r.personaSize.size24}],f.isSize24&&s&&{height:"36px"},f.isSize28&&[a.size28,{height:r.personaSize.size28,minWidth:r.personaSize.size28}],f.isSize28&&s&&{height:"32px"},f.isSize32&&[a.size32,{height:r.personaSize.size32,minWidth:r.personaSize.size32}],f.isSize40&&[a.size40,{height:r.personaSize.size40,minWidth:r.personaSize.size40}],f.isSize48&&a.size48,f.isSize72&&[a.size72,{height:r.personaSize.size72,minWidth:r.personaSize.size72}],f.isSize100&&[a.size100,{height:r.personaSize.size100,minWidth:r.personaSize.size100}],l.isAvailable&&a.available,l.isAway&&a.away,l.isBlocked&&a.blocked,l.isBusy&&a.busy,l.isDoNotDisturb&&a.doNotDisturb,l.isOffline&&a.offline,t],details:[a.details,{padding:"0 24px 0 16px",minWidth:0,width:"100%",textAlign:"left",display:"flex",flexDirection:"column",justifyContent:"space-around"},f.isSize10&&{paddingLeft:"17px"},(f.isSize24||f.isSize28)&&{padding:"0 12px"}],primaryText:[a.primaryText,n.noWrap,{color:u.neutralPrimary,fontWeight:n.FontWeights.regular,fontSize:n.FontSizes.large},s&&{height:"16px",lineHeight:"16px",overflowX:"hidden"},f.isSize10&&{fontSize:n.FontSizes.small,lineHeight:r.personaSize.size10},(f.isSize16||f.isSize24||f.isSize28||f.isSize32||f.isSize40)&&{fontSize:n.FontSizes.medium},f.isSize16&&{lineHeight:r.personaSize.size28},(f.isSize24||f.isSize28||f.isSize32||f.isSize40)&&s&&{height:"18px"},f.isSize72&&{fontSize:n.FontSizes.xLarge},f.isSize100&&{fontSize:n.FontSizes.xLarge,fontWeight:n.FontWeights.semilight}],secondaryText:[a.secondaryText,n.noWrap,c,(f.isSize10||f.isSize16||f.isSize24||f.isSize28||f.isSize32)&&{display:"none"},f.isSize24&&s&&{height:"18px"},(f.isSize72||f.isSize100)&&{fontSize:n.FontSizes.medium},s&&{display:"block",height:"16px",lineHeight:"16px",overflowX:"hidden"}],tertiaryText:[a.tertiaryText,n.noWrap,c,{display:"none"},(f.isSize72||f.isSize100)&&{display:"block"}],optionalText:[a.optionalText,n.noWrap,c,{display:"none"},f.isSize100&&{display:"block"}],textContent:[a.textContent,n.noWrap]}}});
define("office-ui-fabric-react/lib/components/Persona/PersonaCoin/index",["require","exports","tslib","./PersonaCoin","./PersonaCoin.base"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("@ms/shared-react-item-activity/lib/utilities/theme/FluentColors",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e.shade30="#004578";e.shade20="#005a9e";e.shade10="#106ebe";e.primary="#0078d4";e.tint10="#2b88d8";e.tint20="#c7e0f4";e.tint30="#deecf9";e.tint40="#eff6fc"}(t.CommunicationColors||(t.CommunicationColors={}));!function(e){e.black="#000000";e.gray220="#11100f";e.gray210="#161514";e.gray200="#1b1a19";e.gray190="#201f1e";e.gray180="#252423";e.gray170="#292827";e.gray160="#323130";e.gray150="#3b3a39";e.gray140="#484644";e.gray130="#605e5c";e.gray120="#797775";e.gray110="#8a8886";e.gray100="#979593";e.gray90="#a19f9d";e.gray80="#b3b0ad";e.gray70="#bebbb8";e.gray60="#c8c6c4";e.gray50="#d2d0ce";e.gray40="#e1dfdd";e.gray30="#edebe9";e.gray20="#f3f2f1";e.gray10="#faf9f8";e.white="#ffffff"}(t.NeutralColors||(t.NeutralColors={}));!function(e){e.pinkRed10="#750b1c";e.red20="#a4262c";e.red10="#d13438";e.redOrange20="#603d30";e.redOrange10="#da3b01";e.orange30="#8e562e";e.orange20="#ca5010";e.orange10="#ffaa44";e.yellow10="#fce100";e.orangeYellow20="#986f0b";e.orangeYellow10="#c19c00";e.yellowGreen10="#8cbd18";e.green20="#0b6a0b";e.green10="#498205";e.greenCyan10="#00ad56";e.cyan40="#005e50";e.cyan30="#005b70";e.cyan20="#038387";e.cyan10="#00b7c3";e.cyanBlue20="#004e8c";e.cyanBlue10="#0078d4";e.blue10="#4f6bed";e.blueMagenta40="#373277";e.blueMagenta30="#5c2e91";e.blueMagenta20="#8764b8";e.blueMagenta10="#8378de";e.magenta20="#881798";e.magenta10="#c239b3";e.magentaPink20="#9b0062";e.magentaPink10="#e3008c";e.gray40="#393939";e.gray30="#7a7574";e.gray20="#69797e";e.gray10="#a0aeb2"}(t.SharedColors||(t.SharedColors={}))});
define("@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/ItemActivity.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".od-ItemActivity-item{max-width:100%}.od-ItemActivity-item-nameText{font-weight:600;color:"},{theme:"bodyText",defaultValue:"#333333"},{rawString:"}.od-ItemActivity-item-linkText{font-weight:600;text-decoration:none}.od-ItemActivity-item-clickableLinkText{max-width:100%;color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";cursor:pointer;font-family:inherit}.isFluent .od-ItemActivity-item-clickableLinkText{font-size:12px}.od-ItemActivity-otherActors{list-style-type:none;margin:0;padding:0}.od-ItemActivity-item-textContent{overflow:hidden;text-overflow:ellipsis;display:inline-block;max-width:100%;vertical-align:middle}.od-ItemActivity-item .ms-ActivityItem-activityContent{width:190px}.od-ItemActivity-timeStamp{display:inline-block;vertical-align:middle}html[dir='ltr'] .od-ItemActivity-timeStamp{padding-left:0}html[dir='rtl'] .od-ItemActivity-timeStamp{padding-right:0}.od-ItemActivity-timeStamp:before{content:'\\00a0\\2219\\00a0'}\n"}])});
define("@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/ItemActivities",["require","exports","tslib","./ItemCommentReplies/ItemActivityCommentComponent","./ItemActivityMenu","react","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/Tooltip","office-ui-fabric-react/lib/Link","@ms/odsp-utilities/lib/dateTime/DateTime","office-ui-fabric-react/lib/Utilities","../../ItemActivities.resx","@ms/odsp-utilities/lib/logging/events/Engagement.event"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function p(e){return e?1:3}var d=function(){function e(e){var t=this;this._onRenderUser=function(e,n){var r=e.user;return t._getUserLabel(r,{stringOnly:!1,isAccusative:e.isAccusative})};this.activity=e.activity;this.currentUserEmail=e.currentUserEmail;this.containingItem=e.containingItem;this.isSingleLevel=e.isSingleLevel;this.canOpenItem=e.canOpenItem;this.onItemClick=e.onItemClick;this.strings=e.strings;this.onRenderUser=e.onRenderUser;this.currentListTitle=e.currentListTitle;this.currentRootTitle=e.currentRootTitle;this.defaultItemTitle=e.defaultItemTitle;this.commentListItem=e.commentListItem;this.isReadonly=e.isReadonly;this.canDeleteActivity=e.canDeleteActivity;this.activityMenuFunctions=e.activityMenuFunctions}e.prototype.getKey=function(){return this.activity.id};e.prototype.getTitle=function(e){void 0===e&&(e={});h.Engagement.logData({name:"ActivityFeed.activityItemData",isIntentional:!0,extraData:{activityType:this.getActivityTypeString(),isGuestUser:0===this.activity.actors.length}});return this.getDescription(e)};e.prototype.getDescription=function(e){void 0===e&&(e={});return[]};e.prototype.getIconName=function(){return"ActivityFeed"};e.prototype.getPersonaIconUrl=function(){};e.prototype.getDate=function(){return this.activity.time};e.prototype.getFriendlyDisplayTime=function(){return this.activity.friendlyDisplayTime};e.prototype.getActivityTypeString=function(){return""};e.prototype.getResponse=function(){};e.prototype.getContextualMenu=function(){};e.prototype._getFilteredActors=function(e){for(var t,n,r=e.actors,i=void 0===r?this.activity.actors||[]:r,s=e.isCompact,o=[],u=0,a=i;u<a.length;u++){var f=a[u];f&&f.self?t=f:o.push(f)}t&&(o=[t].concat(o));var l=p(s);o.length>l&&(n=o.slice(l,o.length));return{youUser:t,additionalUsers:n,sortedUsers:o.length?o:[void 0]}};e.prototype._getAdditionalUsersTooltip=function(e,t){var n=t.stringOnly,r=t.isCompact,i=t.hideDate,a=t.isAccusative,f=void 0!==a&&a,l=r&&i?f?o.getLocalizedCountValue(this.strings.andOtherUsersCountFormShortAccusative,this.strings.otherActorsCountFormShortIntervals,e.length):o.getLocalizedCountValue(this.strings.andOtherActorsCountFormShort,this.strings.otherActorsCountFormIntervals,e.length):f?o.getLocalizedCountValue(this.strings.andOtherUsersCountFormAccusative,this.strings.otherActorsCountFormShortIntervals,e.length):o.getLocalizedCountValue(this.strings.andOtherActorsCountForm,this.strings.otherActorsCountFormIntervals,e.length),c=o.formatToArray(l,e.length);if(n)return c;var h={onRenderContent:function(){var t=e.map(function(e){return s.createElement("li",null,e.displayName)});return s.createElement("ul",{className:"od-ItemActivity-otherActors"},t)}};return s.createElement(u.TooltipHost,{tooltipProps:h},c)};e.prototype.getRenderedUsers=function(e,t){var n=this,r=t.stringOnly,i=t.isAccusative,s=t.isActor;return e&&0!==e.length?e.map(function(e,t){return n.renderUser(e,{stringOnly:r,isAccusative:i,isActor:s},t)||""}):[this.renderUser(void 0)]};e.prototype.renderUser=function(e,t,n){void 0===n&&(n=0);var r=this.onRenderUser,i=void 0===r?this._onRenderUser:r,o=t.stringOnly,u=t.isAccusative,a=t.isActor,f=this._getUserLabel(e,{stringOnly:!0,isAccusative:u});if(!e||o)return f;var l=(a?"_actor":"_")+n;return s.createElement("span",{key:e.email+l,"aria-label":f},i({user:e,isAccusative:u},this._onRenderUser))};e.prototype.renderMainItemLink=function(e,t,n){return this.isSingleLevel?e:o.formatToArray(t,this.renderItemLink({item:this.activity.item,stringOnly:n}))};e.prototype.renderItemLink=function(e){var t=this,n=e.item,r=e.itemLabel,i=e.stringOnly,o=e.keyPrefix,u=void 0===o?"":o,f=r;f||(f=n&&n.isRoot?this._getRootFolderName():void 0);f||(f=n&&n.name?n.name:this._getDefaultItemName());if(f){if(i)return f;var c=void 0;if("string"==typeof f){c=f;var h=void 0,p=void 0;if(-1!==f.indexOf(".")){var d=f.split(".");h=d.slice(0,-1).join();p=d.slice(-1).join()}else{h=f;p=""}h.length>40&&(f=h.slice(0,37).concat("...").concat(p))}var v=f;if(this.canOpenItem&&this.canOpenItem(n)){var m=void 0;m=c?s.createElement("span",{className:"od-ItemActivity-item-textContent}",title:c}," ",f," "):s.createElement("span",{className:"od-ItemActivity-item-textContent}"}," ",f," ");return s.createElement(a.Link,{key:u+"_"+v+"_link",className:l.css("od-ItemActivity-item-linkText","od-ItemActivity-item-clickableLinkText"),onClick:function(){return t.onItemClick(n,t.getActivityTypeString())},href:"javascript:void(0)"},m)}return c?s.createElement("span",{key:u+"_"+v+"_string",className:"od-ItemActivity-item-linkText",title:c},f):s.createElement("span",{key:u+"_"+v+"_string",className:"od-ItemActivity-item-linkText"},f)}};e.prototype._getRootFolderName=function(){return this.currentRootTitle};e.prototype._getDefaultItemName=function(){return(this.currentListTitle?this.currentListTitle:this.defaultItemTitle)||void 0};e.prototype._getUserLabel=function(e,t){var n,r=t.stringOnly,i=t.isAccusative;n=e&&e.self?i?this.strings.you:this.strings.youUpperCase:e&&e.displayName?e.displayName:e&&e.email?e.email:this.strings.someoneUpperCase;return r?n:s.createElement("span",{className:"od-ItemActivity-item-nameText"},n)};return e}();t.BaseItemActivity=d;var v=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t,n=void 0===e?{}:e,r=n.isCompact,i=n.stringOnly,s=n.hideDate,u=this.renderMainItemLink(this.strings.editThisFile,this.strings.editArbitraryFile,i),a=this._getFilteredActors({isCompact:r}),f=a.youUser,l=a.sortedUsers,c=a.additionalUsers,h=p(r);if(l.length>h){var d=r?f?this.strings.youEditedCountFormShort:this.strings.othersEditedCountFormShort:f?this.strings.youEditedCountForm:this.strings.othersEditedCountForm;return o.formatToArray.apply(o,[d,u].concat(this.getRenderedUsers(l.slice(0,h),{stringOnly:i,isActor:!0}),[this._getAdditionalUsersTooltip(c,{stringOnly:i,isCompact:r,hideDate:s})]))}var v=r?f?this.strings.youEditedListFormShort:this.strings.othersEditedListFormShort:f?this.strings.youEditedListForm:this.strings.othersEditedListForm;t=o.getLocalizedCountValue(v,r?this.strings.editedListFormShortIntervals:this.strings.editedListFormIntervals,l.length);return o.formatToArray.apply(o,[t,u].concat(this.getRenderedUsers(l,{stringOnly:i,isActor:!0})))};t.prototype.getIconName=function(){return"Edit"};t.prototype.getActivityTypeString=function(){return"edit"};return t}(d);t.EditItemActivity=v;var m=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t,n=void 0===e?{}:e,r=n.isCompact,i=n.stringOnly,s=this.renderMainItemLink(this.strings.moveThisFile,this.strings.moveArbitraryFile,i),u=this._getFilteredActors({isCompact:r}),a=u.youUser,f=this.renderUser(u.sortedUsers[0],{stringOnly:i,isActor:!0});if(!r&&this.activity.action&&this.activity.action.move){var l=this.activity.action.move;if(l.from&&l.to){var c=this.renderItemLink({item:l.from,stringOnly:i,keyPrefix:"old"}),h=this.renderItemLink({item:l.to,stringOnly:i});t=a?this.strings.youMovedFromFolderToFolder:this.strings.otherMovedFromFolderToFolder;return o.formatToArray(t,s,f,c,h)}if(l.from){c=this.renderItemLink({item:l.from,stringOnly:i,keyPrefix:"old"});t=a?this.strings.youMovedFromFolder:this.strings.otherMovedFromFolder;return o.formatToArray(t,s,f,c)}if(l.to){h=this.renderItemLink({item:l.to,stringOnly:i});t=a?this.strings.youMovedToFolder:this.strings.otherMovedToFolder;return o.formatToArray(t,s,f,void 0,h)}}t=r?a?this.strings.youMovedShort:this.strings.otherMovedShort:a?this.strings.youMoved:this.strings.otherMoved;return o.formatToArray(t,s,f)};t.prototype.getIconName=function(){return"FabricMovetoFolder"};t.prototype.getActivityTypeString=function(){return"move"};return t}(d);t.MoveItemActivity=m;var g=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t,n,r=void 0===e?{}:e,i=r.isCompact,s=r.stringOnly,u=r.hideDate,a=this.renderMainItemLink(this.strings.commentedOnThisFile,this.strings.commentedOnArbitraryFile,s),f=this._getFilteredActors({isCompact:i}),l=f.youUser,c=f.sortedUsers,h=f.additionalUsers,d=p(i);if(this._isOnFileComment()){var v=void 0;if(i)t=l?this.strings.youCommentedListFormShort:this.strings.othersCommentedListFormShort;else{var m=this._getCommentMessage(s);if(this.isSingleLevel&&m){v=m;t=l?this.strings.youCommentedOnThisFile:this.strings.othersCommentedOnThisFile}else{v=a;t=l?this.strings.youCommentedOnFile:this.strings.othersCommentedOnFile}}n=o.formatToArray.apply(o,[t,v].concat(this.getRenderedUsers(c,{stringOnly:s,isActor:!0})))}else if(c.length>d){var g=i?l?this.strings.youCommentedCountFormShort:this.strings.othersCommentedCountFormShort:l?this.strings.youCommentedCountForm:this.strings.othersCommentedCountForm;n=o.formatToArray.apply(o,[g,a].concat(this.getRenderedUsers(c.slice(0,d),{stringOnly:s,isActor:!0}),[this._getAdditionalUsersTooltip(h,{stringOnly:s,isCompact:i,hideDate:u})]))}else{var y=i?l?this.strings.youCommentedListFormShort:this.strings.othersCommentedListFormShort:l?this.strings.youCommentedListForm:this.strings.othersCommentedListForm;t=o.getLocalizedCountValue(y,i?this.strings.commentedListFormShortIntervals:this.strings.commentedListFormIntervals,c.length);n=o.formatToArray.apply(o,[t,a].concat(this.getRenderedUsers(c,{stringOnly:s,isActor:!0})))}return n};t.prototype.getIconName=function(){return this.commentListItem?void 0:"Chat"};t.prototype.getPersonaIconUrl=function(){var e=this._getCommentDetail(),t=this.commentListItem&&e&&e.author.email;return t&&"/_layouts/15/userphoto.aspx?size=s&accountname="+t||void 0};t.prototype.getActivityTypeString=function(){return"comment"};t.prototype.getContextualMenu=function(){var e=this,t=[],n=this.activityMenuFunctions&&this.activityMenuFunctions.delete,r=this.activity&&this.activity.action&&this.activity.action.comment&&this.activity.action.comment.commentId;if(this.canDeleteActivity&&this.canDeleteActivity(this.activity.type)&&n&&this.commentListItem&&r&&!this.isReadonly){var o={key:"od-itemActivity.deleteComment"+r,name:c.default.activityMenuOptionDelete,dialogTitle:c.default.deleteCommentDialogTitle,dialogOnConfirm:function(){return n(e.commentListItem.activityItemWrapper,e.currentUserEmail,{commentItem:e.commentListItem,commentId:r})}};t.push(o)}if(t.length)return s.createElement(i.default,{itemActivityMenuItems:t,activityId:this.activity.id})};t.prototype.getResponse=function(e){void 0===e&&(e=!1);var t=this._getCommentDetail(),n=t&&t.replies&&t.replies.comments&&t.replies.comments.length>0;if(this.commentListItem&&t&&(n||!this.isReadonly))return s.createElement(r.default,{key:this.containingItem.graphItemUrl+"_"+t.id,parentComment:t,commentListItem:this.commentListItem,currentUserEmail:this.currentUserEmail,onRenderUser:this.onRenderUser,isReadonly:this.isReadonly})};t.prototype._getCommentMessage=function(e){void 0===e&&(e=!1);var t=this._getCommentDetail();if(t&&t.text)return e?t.text:s.createElement("div",{className:"od-itemActivity-commentActivity-commentContent",dangerouslySetInnerHTML:{__html:t.text}})};t.prototype._getCommentDetail=function(){var e=this.activity.action;return e&&e.comment&&e.comment.commentDetail};t.prototype._isOnFileComment=function(){var e=this.activity.action&&this.activity.action.comment;return!(!e||!e.commentId)};return t}(d);t.CommentItemActivity=g;var y=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly,i=t.hideDate,s=this.activity.action.commentResponse,u=this._getFilteredActors({isCompact:n}),a=u.youUser,f=u.sortedUsers,l=u.additionalUsers,c=p(n),h=this.renderItemLink({item:this.activity.item,itemLabel:this.strings.commentResponseComment,stringOnly:r});if(s&&s.commentAuthor){var d=s.commentAuthor.self,v=this.renderUser(s.commentAuthor,{stringOnly:r,isAccusative:!0}),m=void 0;if(f.length>c){m=d?n?a?this.strings.youRepliedToYouCountFormShort:this.strings.otherRepliedToYouCountFormShort:a?this.strings.youRepliedToYouCountForm:this.strings.otherRepliedToYouCountForm:n?a?this.strings.youRepliedToOtherCountFormShort:this.strings.otherRepliedToOtherCountFormShort:a?this.strings.youRepliedToOtherCountForm:this.strings.otherRepliedToOtherCountForm;var g=[v].concat(this.getRenderedUsers(f.slice(0,c),{stringOnly:r,isActor:!0}),[this._getAdditionalUsersTooltip(l,{stringOnly:r,isCompact:n,hideDate:i})]);n||g.unshift(h);return o.formatToArray.apply(o,[m].concat(g))}var y=void 0;y=d?n?a?this.strings.youRepliedToYouListFormShort:this.strings.otherRepliedToYouListFormShort:a?this.strings.youRepliedToYouListForm:this.strings.otherRepliedToYouListForm:n?a?this.strings.youRepliedToOtherListFormShort:this.strings.otherRepliedToOtherListFormShort:a?this.strings.youRepliedToOtherListForm:this.strings.otherRepliedToOtherListForm;m=o.getLocalizedCountValue(y,n?this.strings.commentResponseListFormShortIntervals:this.strings.commentResponseListFormIntervals,f.length);g=[v].concat(this.getRenderedUsers(f.slice(0,c),{stringOnly:r,isActor:!0}));n||g.unshift(h);return o.formatToArray.apply(o,[m].concat(g))}m=void 0;if(f.length>c){m=n?a?this.strings.youRepliedToMissingAuthorCountFormShort:this.strings.otherRepliedToMissingAuthorCountFormShort:a?this.strings.youRepliedToMissingAuthorCountForm:this.strings.otherRepliedToMissingAuthorCountForm;return o.formatToArray.apply(o,[m,h].concat(this.getRenderedUsers(f.slice(0,c),{stringOnly:r,isActor:!0}),[this._getAdditionalUsersTooltip(l,{stringOnly:r,isCompact:n,hideDate:i})]))}y=n?a?this.strings.youRepliedToMissingAuthorListFormShort:this.strings.otherRepliedToMissingAuthorListFormShort:a?this.strings.youRepliedToMissingAuthorListForm:this.strings.otherRepliedToMissingAuthorListForm;m=o.getLocalizedCountValue(y,n?this.strings.commentResponseListFormShortIntervals:this.strings.commentResponseListFormIntervals,f.length);return o.formatToArray.apply(o,[m,h].concat(this.getRenderedUsers(f,{stringOnly:r,isActor:!0})))};t.prototype.getIconName=function(){return"Reply"};t.prototype.getActivityTypeString=function(){return"commentResponse"};return t}(d);t.CommentResponseItemActivity=y;var b=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t,n=void 0===e?{}:e,r=n.isCompact,i=n.stringOnly,s=n.hideDate,u=this.renderMainItemLink(this.strings.mentionedThisFile,this.strings.mentionArbitraryFile,i),a=this._getFilteredActors({actors:this.activity.action.mention.mentionees,isCompact:r}),f=this.getRenderedUsers(a.sortedUsers,{stringOnly:i}),l=a.youUser,c=a.additionalUsers,h=this._getFilteredActors({isCompact:r}),d=h.youUser,v=h.sortedUsers,m=p(r);if(f.length>m){var g;g=l?r?d?this.strings.youMentionedOthersCountFormShort:this.strings.othersMentionedYouAndOthersCountFormShort:d?this.strings.youMentionedYouAndOthersCountForm:this.strings.othersMentionedYouAndOthersCountForm:r?d?this.strings.youMentionedOthersCountFormShort:this.strings.othersMentionedOthersCountFormShort:d?this.strings.youMentionedOthersCountForm:this.strings.othersMentionedOthersCountForm;return o.formatToArray.apply(o,[g,u].concat(this.getRenderedUsers(v,{stringOnly:i,isActor:!0}),f.slice(0,m),[this._getAdditionalUsersTooltip(c,{stringOnly:i,isCompact:r,hideDate:s})]))}var y=void 0;y=l?r?d?this.strings.youMentionedYouListFormShort:this.strings.otherMentionedYouListFormShort:d?this.strings.youMentionedYouAndOthersListForm:this.strings.othersMentionedYouAndOthersListForm:r?d?this.strings.youMentionedOthersListFormShort:this.strings.othersMentionedOthersListFormShort:d?this.strings.youMentionedOthersListForm:this.strings.othersMentionedOthersListForm;t=o.getLocalizedCountValue(y,r?this.strings.mentionedListFormShortIntervals:this.strings.mentionedListFormIntervals,f.length);return o.formatToArray.apply(o,[t,u].concat(this.getRenderedUsers(v,{stringOnly:i,isActor:!0}),f.slice(0,m)))};t.prototype.getIconName=function(){return"Accounts"};t.prototype.getActivityTypeString=function(){return"mention"};return t}(d);t.MentionItemActivity=b;var w=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly;if(this.activity.action&&this.activity.action.version&&this.activity.action.version.newVersion){var i=this._getFilteredActors({isCompact:n}),s=i.youUser,u=this.renderUser(i.sortedUsers[0],{stringOnly:r,isActor:!0}),a=n?s?this.strings.youCreatedVersionShort:this.strings.otherCreatedVersionShort:s?this.isSingleLevel?this.strings.youCreatedVersionThisFile:this.strings.youCreatedVersion:this.isSingleLevel?this.strings.otherCreatedVersionThisFile:this.strings.otherCreatedVersion,f=this.renderMainItemLink(this.strings.versionThisFile,this.strings.versionArbitraryFile,r),l=this.activity.action.version.newVersion;return o.formatToArray(a,f,u,l)}return[]};t.prototype.getIconName=function(){return"FabricMovetoFolder"};t.prototype.getActivityTypeString=function(){return"version"};return t}(d);t.VersionItemActivity=w;var E=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=(t.isCompact,t.stringOnly),r=this.renderMainItemLink(this.strings.restoreThisFile,this.strings.restoreArbitraryFile,n),i=this.isSingleLevel?this.strings.thisFileRestored:this.strings.arbitraryFileRestored;return o.formatToArray(i,r)};t.prototype.getIconName=function(){return"Refresh"};t.prototype.getActivityTypeString=function(){return"restore"};return t}(d);t.RestoreItemActivity=E;var S=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t,n=void 0===e?{}:e,r=n.isCompact,i=n.stringOnly,s=this._getFilteredActors({isCompact:r}),u=s.youUser,a=this.renderUser(s.sortedUsers[0],{stringOnly:i,isActor:!0});if(this.activity.action&&this.activity.action.rename&&this.activity.action.rename.oldItem){var f=this.renderItemLink({item:this.activity.action.rename.oldItem,stringOnly:i,keyPrefix:"old"}),l=this.renderItemLink({item:this.activity.item,stringOnly:i});t=r?u?this.strings.youRenamedFileToFileShort:this.strings.otherRenamedFileToFileShort:u?this.strings.youRenamedFileToFile:this.strings.otherRenamedFileToFile;return o.formatToArray(t,a,f,l)}var c=this.renderMainItemLink(this.strings.renameThisFile,this.strings.renameArbitraryFile,i);t=r?u?this.strings.youRenamedFileShort:this.strings.otherRenamedFileShort:u?this.strings.youRenamedFile:this.strings.otherRenamedFile;return o.formatToArray(t,a,c)};t.prototype.getIconName=function(){return"Rename"};t.prototype.getActivityTypeString=function(){return"restore"};return t}(d);t.RenameItemActivity=S;var x=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly,i=this.renderMainItemLink(this.strings.deleteThisFile,this.strings.deleteArbitraryFile,r),s=this._getFilteredActors({isCompact:n}),u=s.youUser,a=this.renderUser(s.sortedUsers[0],{stringOnly:r,isActor:!0}),f=n?u?this.strings.youDeletedShort:this.strings.otherDeletedShort:u?this.strings.youDeleted:this.strings.otherDeleted;if(this.isSingleLevel)return o.formatToArray(f,i,a);var l=this.renderItemLink({item:this.activity.parentItem,stringOnly:r});f=!n&&l?u?this.strings.youDeletedFromFolder:this.strings.otherDeletedFromFolder:f;return l?o.formatToArray(f,i,a,l):o.formatToArray(f,i,a)};t.prototype.getIconName=function(){return"Trash"};t.prototype.getActivityTypeString=function(){return"delete"};return t}(d);t.DeleteItemActivity=x;var T=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly,i=this.renderMainItemLink(this.strings.createThisFile,this.strings.createArbitraryFile,r),s=this._getFilteredActors({isCompact:n}),u=s.youUser,a=this.renderUser(s.sortedUsers[0],{stringOnly:r,isActor:!0}),f=n?u?this.strings.youCreatedShort:this.strings.otherCreatedShort:u?this.strings.youCreated:this.strings.otherCreated;if(this.isSingleLevel)return o.formatToArray(f,i,a);var l=this.renderItemLink({item:this.activity.parentItem,stringOnly:r});f=!n&&l?u?this.strings.youCreatedInLocation:this.strings.otherCreatedInLocation:f;return l?o.formatToArray(f,i,a,l):o.formatToArray(f,i,a)};t.prototype.getIconName=function(){return"Add"};t.prototype.getActivityTypeString=function(){return"create"};return t}(d);t.CreateItemActivity=T;var N=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t,n=void 0===e?{}:e,r=n.isCompact,i=n.stringOnly,s=n.hideDate,u=this.renderMainItemLink(this.strings.shareThisFile,this.strings.shareArbitraryFile,i),a=this._getFilteredActors({isCompact:r}),f=a.youUser,l=this.renderUser(a.sortedUsers[0],{stringOnly:i,isActor:!0}),c=this.activity.action.share.recipients;if(c&&c.length>0){var h=this._getFilteredActors({actors:c,isCompact:r}),d=h.sortedUsers,v=h.youUser,m=h.additionalUsers,g=p(r);if(d.length>g){var y;y=v?r?f?this.strings.youSharedWithYouCountFormShort:this.strings.otherSharedWithYouCountFormShort:f?this.strings.youSharedWithYouCountForm:this.strings.otherSharedWithYouCountForm:r?f?this.strings.youSharedWithOthersCountFormShort:this.strings.otherSharedWithOthersCountFormShort:f?this.strings.youSharedWithOthersCountForm:this.strings.otherSharedWithOthersCountForm;return o.formatToArray.apply(o,[y,u,l].concat(this.getRenderedUsers(d.slice(0,g),{stringOnly:i,isAccusative:!0}),[this._getAdditionalUsersTooltip(m,{stringOnly:i,isCompact:r,hideDate:s,isAccusative:!0})]))}var b=void 0;b=v?r?f?this.strings.youSharedWithYouListFormShort:this.strings.otherSharedWithYouListFormShort:f?this.strings.youSharedWithYouListForm:this.strings.otherSharedWithYouListForm:r?f?this.strings.youSharedWithOthersListFormShort:this.strings.otherSharedWithOthersListFormShort:f?this.strings.youSharedWithOthersListForm:this.strings.otherSharedWithOthersListForm;var w=o.getLocalizedCountValue(b,r?this.strings.sharedWithOthersListFormShortIntervals:this.strings.sharedWithOthersListFormIntervals,d.length);return o.formatToArray.apply(o,[w,u,l].concat(this.getRenderedUsers(d,{stringOnly:i,isAccusative:!0})))}t=r?f?this.strings.youSharedShort:this.strings.otherSharedShort:f?this.strings.youShared:this.strings.otherShared;return o.formatToArray(t,u,l)};t.prototype.getIconName=function(){return"Share"};t.prototype.getActivityTypeString=function(){return"share"};return t}(d);t.ShareItemActivity=N;var C=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly,i=this.renderMainItemLink(this.strings.shareThisFile,this.strings.createArbitraryFile,r),s=this._getFilteredActors({isCompact:n}),u=s.youUser,a=this.renderUser(s.sortedUsers[0],{stringOnly:r,isActor:!0}),l=n?u?this.strings.youRestoredDocumentLibraryShort:this.strings.otherRestoredDocumentLibraryShort:u?this.strings.youRestoredDocumentLibrary:this.strings.otherRestoredDocumentLibrary,c=this.activity.action&&this.activity.action.pointInTimeRestore,h=c&&c.restoreToDateTime;return o.formatToArray(l,a,i,f.getRelativeDateTimeStringPast(h))};t.prototype.getIconName=function(){return"Refresh"};t.prototype.getActivityTypeString=function(){return"pointInTimeRestore"};return t}(d);t.PointInTimeRestoreActivity=C;var k=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getDescription=function(e){var t=void 0===e?{}:e,n=t.isCompact,r=t.stringOnly,i=this.renderMainItemLink(this.strings.restoredVersionThisFile,this.strings.restoredVersionArbitraryFile,r),s=this._getFilteredActors({isCompact:n}),u=s.youUser,a=this.renderUser(s.sortedUsers[0],{stringOnly:r}),f=n?u?this.strings.youRestoredVersionShort:this.strings.otherRestoredVersionShort:u?this.strings.youRestoredVersion:this.strings.otherRestoredVersion,l=this.activity.action&&this.activity.action.restoreVersion,c=l&&l.fromVersion;return o.formatToArray(f,a,i,c)};t.prototype.getIconName=function(){return"Refresh"};t.prototype.getActivityTypeString=function(){return"restoreVesion"};return t}(d);t.RestoreVersionActivity=k});
define("@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/ItemCommentReplies/ItemActivityCommentComponent",["require","exports","tslib","react","prop-types","@ms/odsp-utilities/lib/string/StringHelper","office-ui-fabric-react/lib/FocusZone","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/List","office-ui-fabric-react/lib/Link","../../../AddCommentTextField/AddCommentTextField","../../../ItemActivities.resx","./ItemCommentReply","./ItemActivityCommentComponent.scss"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=2,d=function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t,n)||this;i._onFocus=function(){i._focusZone&&i._focusZone.focus()};i._onRenderCell=function(e,t){var n=i.props.onRenderUser,s=i.state,o=s.currentReplies,u=s.numberOfRepliesDisplayed,a=o.comments.length||0,f=u<=a&&a-u||0,l=new v({reply:e,onRenderUser:n});if(e&&t>=f)return r.createElement(h.default,{key:l.getKey(),reply:l,additionalClass:"od-ItemActivityList-commentReply"})};i._onSend=function(e,t,n){var r=i.props,s=r.parentComment,o=r.commentListItem,u=r.currentUserEmail;i._store&&i._store.addItemCommentReply({itemWrapper:o,currentUserEmail:u},s.id,e).then(function(e){i._store.fetchItemCommentReplies({itemWrapper:o,currentUserEmail:u,startIndex:0},s.id);t&&t()},function(e){var t=e&&e.message&&e.message.value;n&&n(t)})};i._onShowMore=function(){var e=i.props,t=e.onShowMore,n=e.parentComment,r=e.commentListItem,s=e.currentUserEmail,o=i.state.currentReplies,u=i.state.numberOfRepliesDisplayed;if(u<o.comments.length){i.setState({numberOfRepliesDisplayed:10*Math.floor(u/10)+10});o.nextLink&&i._store.fetchItemCommentReplies({itemWrapper:r,currentUserEmail:s},n.id)}t&&t()};i._store=n.itemCommentsStore;i._engagementSource=n.engagementSource||"";var s=t.parentComment,o=t.commentListItem,u=t.currentUserEmail,a=i._store.getItemCommentReplies({itemWrapper:o,currentUserEmail:u},s.id),f=a&&a.comments&&a.comments.length,l=f?p:0;i.state={numberOfRepliesDisplayed:l,currentReplies:a,hasMore:l<f};return i}t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.parentComment.id!==this.props.parentComment.id&&this._addListener()};t.prototype.componentDidMount=function(){this._addListener()};t.prototype.componentWillUnmount=function(){this._store.removeRepliesListener(this._storeListener)};t.prototype.UNSAFE_componentWillUpdate=function(){this._focusElement=void 0};t.prototype.render=function(){var e=this.props,t=e.isReadonly,n=e.parentComment,i=this.state.currentReplies.comments||[],s=i.map(function(e){try{return e.action.comment.commentDetail}catch(e){}});return r.createElement("div",{"data-is-focusable":!0,key:"activityResponse_"+n.id,onFocus:this._onFocus,"aria-label":c.default.activityCommentRepliesList},r.createElement(o.FocusZone,{componentRef:this._resolveRef("_focusZone"),className:"od-ItemActivityList-activity-commentResponse",direction:o.FocusZoneDirection.vertical,isCircularNavigation:!1,handleTabKey:o.FocusZoneTabbableElements.inputOnly,shouldInputLoseFocusOnArrowKey:function(e){return!0},isInnerZoneKeystroke:function(e){return e.which===u.getRTLSafeKeyCode(u.KeyCodes.right)}},this._getShowMoreLink(),i&&i.length>0&&r.createElement(a.List,{componentRef:!this._focusElement&&this._resolveRef("_focusElement"),className:"od-activityItem-replies-list",items:s,onRenderCell:this._onRenderCell}),!t&&r.createElement(l.default,{componentRef:!this._focusElement&&this._resolveRef("_focusElement"),commentItemId:n&&n.id,placeholderText:c.default.replyPlaceholder,sendButtonTitle:"",onSend:this._onSend,engagementSource:this._engagementSource+".AddReply"})))};t.prototype._addListener=function(){var e=this,t=this.props,n=t.parentComment,r=t.commentListItem,i=t.currentUserEmail;this._storeListener=this._store.addRepliesListener(function(){var t=e._store.getItemCommentReplies({itemWrapper:r,currentUserEmail:i},n.id),s=t.comments&&t.comments.length;e.setState({currentReplies:t,numberOfRepliesDisplayed:s>p?e.state.numberOfRepliesDisplayed:s,hasMore:!!t.nextLink||t.comments.length>e.state.numberOfRepliesDisplayed})},{item:r.activityItemWrapper,currentUserEmail:i},n.id)};t.prototype._getShowMoreLink=function(){this.props.parentComment;var e=this.state,t=e.currentReplies;if(e.numberOfRepliesDisplayed<t.comments.length||t.nextLink)return r.createElement("div",{className:"od-ItemActivityList-commentReply od-ItemActivityList-loadMoreReplies"},r.createElement(f.Link,{componentRef:!this._focusElement&&this._resolveRef("_focusElement"),onClick:this._onShowMore,href:"javascript:void(0)"},c.default.commentRepliesGetMore))};t.contextTypes={itemCommentsStore:i.any,engagementSource:i.any};return t}(u.BaseComponent);t.default=d;var v=function(){function e(e){var t=this;this._renderUser=function(e,n){var r=e.user;r||(r=t._getReplyAuthor());return t._renderUserLabel(r,{stringOnly:!1})};this._commentReply=e.reply;this._onRenderUser=e.onRenderUser}e.prototype.getKey=function(){return"Comment"+this._commentReply.parentId+"_Reply"+this._commentReply.id};e.prototype.getPersonaImgUrl=function(){return"/_layouts/15/userphoto.aspx?size=S&accountname="+this._commentReply.author.email};e.prototype.getFriendlyDisplayTime=function(){return this._commentReply.friendlyDisplayTime};e.prototype.getDate=function(){return this._commentReply.createdDate};e.prototype.getDescription=function(e){void 0===e&&(e={stringOnly:!1});var t=e.stringOnly,n=this._commentReply.text,i=this._getReplyAuthor(),o=this.renderUser(i,{stringOnly:t}),u=t?n:r.createElement("div",{className:"od-itemActivity-commentActivity-commentContent",dangerouslySetInnerHTML:{__html:n}});return i.self?s.formatToArray(c.default.youReplied,u):s.formatToArray(c.default.otherReplied,u,o)};e.prototype.renderUser=function(e,t){var n=t.stringOnly,i=this._renderUserLabel(e,{stringOnly:!0});return!e||n?i:r.createElement("span",{"aria-label":i},this._onRenderUser({user:e},this._renderUser))};e.prototype._renderUserLabel=function(e,t){var n,i=t.stringOnly;n=e&&e.self?c.default.youUpperCase:e&&e.displayName?e.displayName:e&&e.email?e.email:c.default.someoneUpperCase;return i?n:r.createElement("span",{className:"od-ItemActivity-item-nameText"},n)};e.prototype._getReplyAuthor=function(){return this._commentReply.author};return e}();t.ItemCommentReplyModel=v});
define("@ms/shared-react-item-activity/lib/components/AddCommentTextField/AddCommentTextField",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","office-ui-fabric-react/lib/Spinner","office-ui-fabric-react/lib/TextField","office-ui-fabric-react/lib/Button","./AddCommentTextField.resx","@ms/odsp-utilities/lib/logging/events/Engagement.event","./AddCommentTextField.scss"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._textField=r.createRef();n._onSend=function(){var e=n.props,t=e.onSend,r=e.engagementSource,i=e.engagementExtraData,s=n.state.text;if(s&&t){n.setState({sending:!0,errorMessage:"",successMessage:""});t(s,function(){n._onClearTextField();n.setState({successMessage:a.default.CommentAdded})},function(e){n.setState({sending:!1,errorMessage:e})});var o=r?r+".":"AddCommentTextField.";f.Engagement.logData({name:o+"Send.Click",isIntentional:!0,extraData:i})}};n._onClearTextField=function(){n.setState(n._getResetState(),function(){n._textField&&n._textField.current&&n._textField.current.focus()})};n._onTextFieldChange=function(e,t){n.setState({text:t||"",enableSendButton:!(!t||!t.trim())})};n._onKeyDown=function(e){e.which===i.KeyCodes.enter&&n.state.enableSendButton&&n._onSend()};n.state=n._getResetState();return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.commentItemId!==this.props.commentItemId&&this.setState(n.__assign({},this._getResetState(),{errorMessage:"",successMessage:""}))};t.prototype.render=function(){var e=this.props,t=e.overrideStyleName;e.engagementSource,e.commentItemId;return r.createElement("div",{className:i.css("od-addCommentTextField",t)},r.createElement(o.TextField,n.__assign({componentRef:this._textField,"data-lpignore":"true"},this._getTextFieldProps())),r.createElement("div",{className:"od-addCommentTextField-screenReaderOnly","aria-live":"assertive",role:"status","aria-label":this.state.successMessage},this.state.successMessage))};t.prototype._getTextFieldProps=function(){var e=this,t=this.props.placeholderText,n=this.state,r=n.sending,i=n.text,s=n.errorMessage;return{className:"od-addCommentTextField-input",placeholder:t,onChange:this._onTextFieldChange,value:i||"",disabled:r,onKeyDown:this._onKeyDown,autoComplete:"off",errorMessage:s,onRenderSuffix:function(t){return e._onRenderSuffix()}}};t.prototype._onRenderSuffix=function(){return r.createElement(r.Fragment,null,r.createElement(u.IconButton,{iconProps:{iconName:"Cancel"},ariaLabel:a.default.cancelLabel,title:a.default.cancelLabel,onClick:this._onClearTextField}),this._getSendButton())};t.prototype._getSendButton=function(){var e=this.props.sendButtonTitle;return this.state.sending?r.createElement("div",{className:"od-addCommentTextField-spinner"},r.createElement(s.Spinner,{size:s.SpinnerSize.small})):r.createElement(u.IconButton,{className:"od-addCommentTextField-sendButton",iconProps:{iconName:"Send"},ariaLabel:a.default.sendLabel||e,title:a.default.sendLabel||e,onClick:this._onSend,disabled:!this.state||!this.state.enableSendButton})};t.prototype._getResetState=function(){return{text:"",enableSendButton:!1,sending:!1}};return t}(i.BaseComponent);t.default=l});
define("@ms/shared-react-item-activity/lib/components/AddCommentTextField/AddCommentTextField.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".od-addCommentTextField{display:-webkit-box;display:-ms-flexbox;display:flex;margin:8px 0}.od-addCommentTextField .ms-TextField-suffix{margin:8px 0;padding:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-addCommentTextField-input{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.od-addCommentTextField-input .ms-TextField-fieldGroup{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-addCommentTextField-sendButton{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background-color:unset}.od-addCommentTextField-spinner{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;margin:4px}.od-addCommentTextField-screenReaderOnly{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}])});
define("@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/ItemCommentReplies/ItemCommentReply",["require","exports","tslib","react","office-ui-fabric-react/lib/components/ActivityItem/ActivityItem","office-ui-fabric-react/lib/FocusZone","@ms/odsp-utilities/lib/dateTime/DateTime","../ItemActivity.scss"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onRenderActivityDescription=function(){return r.createElement("div",{className:"od-ItemActivity-item-textContent"},t.props.reply.getDescription())};t._onRenderActivityTimeStamp=function(e,t){return t?t(e):null};t._onRenderHiddenTimeStamp=function(e,t){return null};return t}t.prototype.render=function(){var e=this.props,t=e.reply,n=e.hideDate,o=e.additionalClass,u=void 0===o?"":o;return r.createElement(s.FocusZone,{direction:s.FocusZoneDirection.horizontal,"data-is-focusable":!0,"aria-label":this._getAriaLabel()},r.createElement(i.ActivityItem,{key:t.getKey(),className:"od-ItemActivity-item "+u,activityPersonas:this._activityPersonas(),onRenderActivityDescription:this._onRenderActivityDescription,timeStamp:this._onRenderDate(),onRenderTimeStamp:n?this._onRenderHiddenTimeStamp:this._onRenderActivityTimeStamp}))};t.prototype._onRenderDate=function(){var e=this.props.reply;return(o.getRelativeDateTimeStringForLists(e.getFriendlyDisplayTime()||"")||o.getFriendlyDateTimeStringPast(e.getDate())).toString()};t.prototype._getAriaLabel=function(){return this.props.reply.getDescription({stringOnly:!0}).join("")+" "+this._onRenderDate()};t.prototype._activityPersonas=function(){return[{imageUrl:this.props.reply.getPersonaImgUrl()}]};return t}(r.Component);t.default=u});
define("@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/ItemCommentReplies/ItemActivityCommentComponent.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".od-activityItem-replies-list .ms-List-cell{min-height:0}\n"}])});
define("@ms/shared-react-item-activity/lib/components/ItemActivityFeed/ItemActivity/ItemActivityMenu",["require","exports","tslib","react","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Dialog","office-ui-fabric-react/lib/common/DirectionalHint","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../ItemActivities.resx"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._onDismissDialog=function(){r.setState({hideDialog:!0})};r.state={dialogTitle:"",onDialogConfirm:void 0,hideDialog:!0};return r}t.prototype.render=function(){var e=this,t=this.state,n=t.dialogTitle,u=t.onDialogConfirm,f=t.hideDialog,l=this._getMenuItems();if(l)return r.createElement(r.Fragment,null,r.createElement(i.IconButton,{className:"od-ItemActivity-contextMenu",role:"button",iconProps:{iconName:"More"},onRenderMenuIcon:function(){},ariaLabel:a.default.activityMenuAriaLabel,menuProps:{directionalHint:o.DirectionalHint.bottomAutoEdge,isBeakVisible:!1,gapSpace:0,shouldFocusOnMount:!0,items:l}}),r.createElement(s.Dialog,{hidden:f,onDismiss:this._onDismissDialog,dialogContentProps:{type:s.DialogType.normal,title:n}},r.createElement(s.DialogFooter,null,r.createElement(i.DefaultButton,{disabled:!1,onClick:function(){u();e._onDismissDialog()},text:a.default.activityMenuDialogConfirm}),r.createElement(i.DefaultButton,{disabled:!1,primary:!0,onClick:this._onDismissDialog,text:a.default.activityMenuDialogCancel}))))};t.prototype._getMenuItems=function(){var e=this,t=this.props,n=t.itemActivityMenuItems,r=t.activityId;return n.map(function(t){return{key:t.key,name:t.name,onClick:function(n,i){var s=t.dialogOnConfirm;t.dialogTitle&&s?e.setState({dialogTitle:t.dialogTitle,onDialogConfirm:s,hideDialog:!1}):t.onClickMenuOption&&t.onClickMenuOption(n,i);u.Engagement.logData({name:"ActivityItemMenu."+t.name+".Click",isIntentional:!0,extraData:{activityId:r}})}}})};return t}(r.Component);t.default=f});
define("@ms/items-view-addon-graph/lib/handlers/controls/savedForLaterRootItemSetDetailsList",["require","exports","tslib","react","../../components/groupItemDetailsHeader/GroupItemDetailsHeader","office-ui-fabric-react/lib/DetailsList","@ms/items-view/lib/private/addons/registerControlHandler","@ms/items-view/lib/private/components/decorators/withControlHandler","@ms/items-view/lib/private/controls/itemLifeCycleSignalsControl","@ms/items-view/lib/private/utilities/arrays","@ms/items-view/lib/private/components/fields/signal/SignalIcon"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.savedForLaterRootItemSetDetailsListControlHandler=o.createControlHandler()(function(){return function(e){return p}});function c(e,t){var n=t.signals;if(n){var r=f.findMatch(n,function(e){return e.key===l.followedSignalKey});if(r&&r.index>-1){var i=r.index;return{signals:n.slice(0,i).concat(n.slice(i+1))}}}return{}}var h=function(e){var t=e.defaultRender,i=n.__assign({},a.itemLifeCycleSignalsControl.pack(c));return t?r.createElement(u.ControlHandlerProvider,{controlHandlers:i},r.createElement(t,n.__assign({},e))):null};function p(){return{groupHeaderRenderer:i.GroupItemDetailsHeader,rowRenderer:h,groupProps:{collapseAllVisibility:s.CollapseAllVisibility.hidden}}}});
define("@ms/items-view-addon-graph/lib/components/groupItemDetailsHeader/GroupItemDetailsHeader",["require","exports","tslib","react","./GroupItemDetailsHeader.scss"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.group?r.createElement("div",{className:i.root},this.props.group.name):null};return t}(r.PureComponent);t.GroupItemDetailsHeader=s});
define("@ms/items-view-addon-graph/lib/components/groupItemDetailsHeader/GroupItemDetailsHeader.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".root_34a05070{margin-top:15px;margin-bottom:15px;font-size:17px}[dir='ltr'] .root_34a05070{margin-left:96px}[dir='rtl'] .root_34a05070{margin-right:96px}\n"}]);t.root="root_34a05070"});
define("@ms/items-view/lib/private/utilities/arrays",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EMPTY_ARRAY=[];function n(e,t){return e.indexOf(t)>-1?e:e.concat([t])}t.add=n;t.remove=function(e,t){return r(e,t)||[]};t.addOrCreate=function(e,t){return e?n(e,t):[t]};function r(e,t){var n=e.indexOf(t);return n>-1?1===e.length?void 0:e.slice(0,n).concat(e.slice(n+1)):e}t.removeOrDelete=r;t.concat=function(e,n){return e.length>0&&n.length>0?e.concat(n):e.length>0?e:n.length>0?n:t.EMPTY_ARRAY};t.findMatch=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(t(r))return{value:r,index:n}}}});
define("@ms/items-view-addon-graph/lib/handlers/controls/sharedWithMeRootItemSetColumns",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","../../components/columns/fileTypeIconColumn","@ms/items-view/lib/private/components/columns/displayName/displayNameColumn","../../components/columns/dateSharedColumn","../../components/columns/sharedByColumn","../../components/columns/itemActivityColumn"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeRootItemSetColumnsControlHandler=n.createControlHandler()(function(){return function(e){return f}});var a=[r.fileTypeIconColumn,i.displayNameColumn,s.dateSharedColumn,o.sharedByColumn,u.itemActivityColumn];function f(e,t){return{columns:a}}});
define("@ms/items-view-addon-graph/lib/components/columns/dateSharedColumn",["require","exports","@ms/odsp-utilities/lib/dateTime/DateTime","./Columns.resx","@ms/items-view/lib/private/components/columns/createColumn","../../models/facets/SharedFacet","@ms/items-view/lib/private/components/fields/date/DateField","@ms/items-view/lib/private/facets/ConfigurationFacets","./ColumnKeys"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dateSharedColumn=i.createColumn({name:r.default.dateSharedColumnHeaderText,key:a.DATE_SHARED_COLUMN_KEY,fieldName:"",minWidth:i.ColumnWidth.regularMin,maxWidth:i.ColumnWidth.regularMax,isCollapsable:!0},o.DateField)(function(e,t){var r=e.demandItemFacet(s.sharedFacet,t),i=r&&new Date(r.sharedDateTime).getTime();if("number"!=typeof i||isNaN(i))return{text:""};var o=e.demandItemFacet(u.localeFacet,u.configurationItemKey);return o&&o.language||window.navigator.language?{text:n.getRelativeDateTimeStringPast(new Date(i),!1)}:{dateValue:i}})});
define("@ms/items-view-addon-graph/lib/models/facets/SharedFacet",["require","exports","@ms/items-view/lib/private/models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedFacet=new n.Facet("shared")});
define("@ms/items-view-addon-graph/lib/components/columns/sharedByColumn",["require","exports","./Columns.resx","@ms/items-view/lib/private/components/columns/createColumn","../../models/facets/SharedFacet","@ms/items-view/lib/private/components/fields/user/UserFieldWithHoverCard","./ColumnKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByColumn=r.createColumn({name:n.default.sharedByColumnHeaderText,key:o.SHARED_BY_COLUMN_KEY,fieldName:"",minWidth:r.ColumnWidth.regularMin,maxWidth:r.ColumnWidth.regularMax,isCollapsable:!0},s.UserFieldWithHoverCard)(function(e,t){var n=e.demandItem({shared:i.sharedFacet},t).shared;if(n&&n.sharedBy&&n.sharedBy.user){var r=n.sharedBy.user;return{users:[{title:r.displayName||"",email:r.email||"",sip:r.email||"",picture:r.thumbnails&&r.thumbnails.id||"",personKey:""}]}}return{users:[]}})});
define("@ms/items-view/lib/private/components/fields/user/UserFieldWithHoverCard",["require","exports","react","office-ui-fabric-react/lib/Utilities","../Field.scss","../baseText/BaseTextField","../../../utilities/components/Fragment"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function u(e,t){var o=e.users[t],u=e.userHoverCard,a=e.isDisabled;return u?n.createElement("div",null,n.createElement(u,{personKey:o.personKey,displayValue:o.displayValue||"",user:o,key:t},n.createElement(s.BaseText,{isDisabled:a,className:r.css(""+i.field,""+i.nofill),text:o.displayValue||o.title}))):n.createElement("div",null,n.createElement(s.BaseText,{key:t,isDisabled:a,className:r.css(""+i.field,""+i.nofill),text:o.displayValue||o.title}))}t.UserFieldWithHoverCard=function(e){var t=e.users;return t&&t.length?1===t.length?u(e,0):n.createElement(o.Fragment,null,t.map(function(t,n){return u(e,n)})):null}});
define("@ms/items-view-addon-graph/lib/GraphAddonDataOnly",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/facets/SetFacets","@ms/items-view/lib/private/facets/ItemFacets","./models/facets/DriveItemFacets","@ms/items-view/lib/private/operations/getItems","./handlers/operations/driveItem/getItemsOperationHandler","./handlers/operations/driveItem/getItemsAnalyticsOperationHandler","./handlers/operations/specialDriveItem/getItemsOperationHandler","./handlers/operations/driveItemPage/getItemsOperationHandler","./handlers/operations/sharedWithMeRootItem/getItemsOperationHandler","./handlers/operations/sharedWithMeItemSet/getItemsOperationHandler","./handlers/operations/sharedByMeRootItem/getItemsOperationHandler","./handlers/operations/sharedByMeItemSet/getItemsOperationHandler","./handlers/operations/recentRootItem/getItemsOperationHandler","./handlers/operations/savedForLaterRootItem/getItemsOperationHandler","./handlers/operations/recentItemSet/getItemsOperationHandler","./handlers/operations/savedForLaterItemSet/getItemsOperationHandler","./handlers/operations/driveFollowItem/getItemsOperationHandler","./handlers/operations/driveActivityItem/getItemsOperationHandler","./handlers/operations/searchItemSet/getItemsOperationHandler","./models/keys/DriveItemKeyFacet","./models/keys/DriveAnalyticsItemKeyFacet","./GraphAddonDriveItemSet","./models/keys/DriveItemPageKeyFacet","./models/keys/SharedWithMeRootItemKeyFacet","./models/keys/SharedWithMeItemSetKeyFacet","./models/keys/SharedByMeRootItemKeyFacet","./models/keys/SharedByMeItemSetKeyFacet","./models/keys/RecentRootItemKeyFacet","./models/keys/RecentItemSetKeyFacet","./models/keys/SpecialDriveItemKeyFacet","./models/keys/SavedForLaterRootItemKeyFacet","./models/keys/SavedForLaterItemSetKeyFacet","./models/keys/SearchItemSetKeyFacet","./models/keys/DriveFollowedItemKeyFacet","./models/keys/DriveActivityItemKeyFacet","./handlers/operations/commands/getItemsOperationHandler","./handlers/controls/openActionControl","@ms/items-view/lib/private/controls/openActionControl","@ms/items-view/lib/private/addons/registerControlHandler","./models/facets/CommandsFacets","@ms/items-view/lib/private/operations/pageLoad","@ms/items-view/lib/private/controls/filteredItemSetControl","./handlers/controls/recentRootItemSetFilteredItemSetControlHandler","@ms/items-view/lib/private/controls/itemsViewControl","./handlers/controls/itemsViewControl","./models/keys/CommandsItemKeyFacet","@ms/items-view/lib/private/operations/handleError","./models/keys/SharesItemKeyFacet","./handlers/operations/sharesItem/getItemsOperationHandler","./GraphFileHandlerAddon","./models/keys/DriveItemVirtualizedPageKeyFacet","./handlers/operations/driveItemVirtualizedPage/getItemsOperationHandler","@ms/utilities-async/lib/decorators/asModuleLoad"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne){"use strict";var re=this;Object.defineProperty(t,"__esModule",{value:!0});var ie=ne.asModuleWithRetries(function(){return new Promise(function(t,n){e(["./GraphAddonDeferred"],t,n)})},{chunkName:"graphaddondeferred"});t.graphAddonDataOnly=r.createAddon(function(){return function(e){return n.__awaiter(re,void 0,void 0,function(){var t,ne;return n.__generator(this,function(n){switch(n.label){case 0:e(u.supportFacets({keyFacet:x.driveItemKeyFacet,facets:[x.driveItemKeyFacet,s.displayNameFacet,s.fileSizeFacet,s.folderFacet,s.openUrlFacet,s.dateModifiedFacet,i.defaultChildItemSetFacet,s.parentFolderItemFacet,s.canonicalUrlFacet,s.eTagFacet,o.systemFilePathFacet]}));e(u.supportFacets({keyFacet:C.driveItemPageKeyFacet,facets:[C.driveItemPageKeyFacet,i.childItemsFacet,i.pageFacet]}));e(u.supportFacets({keyFacet:k.sharedWithMeRootItemKeyFacet,facets:[k.sharedWithMeRootItemKeyFacet,s.displayNameFacet,s.fileSizeFacet,s.folderFacet,s.openUrlFacet,s.canonicalUrlFacet,s.dateModifiedFacet,i.defaultChildItemSetFacet,s.parentFolderItemFacet,o.systemFilePathFacet]}));e(u.supportFacets({keyFacet:L.sharedWithMeItemSetKeyFacet,facets:[L.sharedWithMeItemSetKeyFacet,i.childItemsFacet]}));e(u.supportFacets({keyFacet:A.sharedByMeRootItemKeyFacet,facets:[A.sharedByMeRootItemKeyFacet,s.displayNameFacet,s.fileSizeFacet,s.folderFacet,s.openUrlFacet,s.canonicalUrlFacet,s.dateModifiedFacet,i.defaultChildItemSetFacet,s.parentFolderItemFacet,o.systemFilePathFacet]}));e(u.supportFacets({keyFacet:O.sharedByMeItemSetKeyFacet,facets:[O.sharedByMeItemSetKeyFacet,i.childItemsFacet]}));e(u.supportFacets({keyFacet:M.recentRootItemKeyFacet,facets:[M.recentRootItemKeyFacet,s.displayNameFacet,s.fileSizeFacet,s.folderFacet,s.openUrlFacet,s.dateModifiedFacet,i.defaultChildItemSetFacet,s.parentFolderItemFacet,o.systemFilePathFacet]}));e(u.supportFacets({keyFacet:_.recentItemSetKeyFacet,facets:[_.recentItemSetKeyFacet,i.childItemsFacet]}));e(u.supportFacets({keyFacet:P.savedForLaterRootItemKeyFacet,facets:[P.savedForLaterRootItemKeyFacet,s.displayNameFacet,s.fileSizeFacet,s.folderFacet,s.openUrlFacet,s.dateModifiedFacet,i.defaultChildItemSetFacet,s.parentFolderItemFacet]}));e(u.supportFacets({keyFacet:K.commandsItemKeyFacet,facets:[z.addToOneDriveFacet,z.createFolderFacet,z.createLinkFacet,z.deleteFacet,z.downloadFacet,z.inviteFacet,z.moveFacet,z.officeLensFacet,z.renameFacet,z.uploadFacet]}));e(N.graphAddonDriveItemSet);e(r.registerOperationHandler(x.driveItemKeyFacet,u.getItemsOperation)(a.driveItemGetItemsOperationHandler));e(r.registerOperationHandler(ee.driveItemVirtualizedPageKeyFacet,u.getItemsOperation)(te.driveItemVirtualizedPageGetItemsOperationHandler));e(r.registerOperationHandler(T.driveAnalyticsItemKeyFacet,u.getItemsOperation)(f.driveAnalyticsItemGetItemsOperationHandler));e(r.registerOperationHandler(D.specialDriveItemKeyFacet,u.getItemsOperation)(l.specialDriveItemGetItemsOperationHandler));e(r.registerOperationHandler(G.sharesItemKeyFacet,u.getItemsOperation)(Y.sharesItemGetItemsOperationHandler));e(r.registerOperationHandler(C.driveItemPageKeyFacet,u.getItemsOperation)(c.driveItemPageGetItemsOperationHandler));e(r.registerOperationHandler(k.sharedWithMeRootItemKeyFacet,u.getItemsOperation)(h.sharedWithMeRootItemGetItemsOperationHandler));e(r.registerOperationHandler(L.sharedWithMeItemSetKeyFacet,u.getItemsOperation)(p.sharedWithMeItemSetGetItemsOperationHandler));e(r.registerOperationHandler(A.sharedByMeRootItemKeyFacet,u.getItemsOperation)(d.sharedByMeRootItemGetItemsOperationHandler));e(r.registerOperationHandler(O.sharedByMeItemSetKeyFacet,u.getItemsOperation)(v.sharedByMeItemSetGetItemsOperationHandler));e(r.registerOperationHandler(M.recentRootItemKeyFacet,u.getItemsOperation)(m.recentRootItemGetItemsOperationHandler));e(r.registerOperationHandler(P.savedForLaterRootItemKeyFacet,u.getItemsOperation)(g.savedForLaterRootItemGetItemsOperationHandler));e(r.registerOperationHandler(_.recentItemSetKeyFacet,u.getItemsOperation)(y.recentItemSetGetItemsOperationHandler));e(r.registerOperationHandler(H.savedForLaterItemSetKeyFacet,u.getItemsOperation)(b.savedForLaterItemSetGetItemsOperationHandler));e(r.registerOperationHandler(B.searchItemSetKeyFacet,u.getItemsOperation)(S.searchItemSetGetItemsOperationHandler));e(u.supportFacets({keyFacet:j.driveFollowedItemKeyFacet,facets:[s.isFollowedFacet]}));e(r.registerOperationHandler(j.driveFollowedItemKeyFacet,u.getItemsOperation)(w.driveFollowItemGetItemsOperationHandler));e(r.registerOperationHandler(F.driveActivityItemKeyFacet,u.getItemsOperation)(E.driveActivityItemGetItemsOperationHandler));e(r.registerOperationHandler(K.commandsItemKeyFacet,u.getItemsOperation)(I.commandsGetItemsOperationHandler));e(U.registerControlHandler(x.driveItemKeyFacet,R.openActionControl)(q.openActionControlHandler));e(U.registerControlHandler(_.recentItemSetKeyFacet,X.filteredItemSetControl)(V.recentRootItemSetFilteredItemSetControlHandler));e(U.registerControlHandler(_.recentItemSetKeyFacet,$.itemsViewControl)(J.itemsViewControlHandler));e(Z.graphFileHandlerAddon);return[4,e(W.waitForPageLoad())];case 1:n.sent();n.label=2;case 2:n.trys.push([2,4,,5]);return[4,ie()];case 3:if(!(t=n.sent().graphAddonDeferred))throw new Error("Couldn't load extended Microsoft Graph features.");e(t);return[3,5];case 4:ne=n.sent();e(Q.handleError({error:ne}));return[3,5];case 5:return[2]}})})}})});
define("@ms/items-view-addon-graph/lib/models/facets/DriveItemFacets",["require","exports","@ms/items-view/lib/private/models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.mimeTypeFacet=new n.Facet("mimeType");t.systemFilePathFacet=new n.Facet("systemFilePath")});
define("@ms/items-view-addon-graph/lib/handlers/operations/driveItem/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","../../../models/keys/DriveItemKeyFacet","../../../utilities/Data","../../../utilities/Data","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/operations/getItems","../../../utilities/processLocalOrRemoteDriveItem","../../../models/items/GraphItems.resx","../../../utilities/UrlConstants"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,h=i.driveItemKeyFacet.deserialize(r),p=h.itemId,d=h.endpoint;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,v,m,g,y;return n.__generator(this,function(b){switch(b.label){case 0:p===c.ROOT_ITEM_ID&&e(a.resolveItems({items:(t={},t[r]=n.__assign({},u.displayNameFacet.pack(l.default.files)),t)}));return[4,e(o.getRawDataWithCache({url:s.getDriveItemUrl(h),qosName:"getItem",endpoint:d}))];case 1:v=b.sent();m=f.processLocalOrRemoteDriveItem({driveItemResponse:v,endpoint:d}),g=m.itemResolver,y=m.actualItemKey;g.mapKeys({mappings:(i={},i[y]=r,i)});e(g.execute());return[2]}})})}})});
define("@ms/items-view-addon-graph/lib/utilities/Data",["require","exports","tslib","@ms/items-view/lib/private/store/middleware/RunOnceMiddleware","@ms/odsp-graph/lib/base/dataRequestor/DataRequestor","./Auth","@ms/items-view/lib/private/operations/offlineCache","@ms/items-view/lib/private/operations/telemetry/getTelemetryManager","@ms/odsp-utilities/lib/logging/events/Api.event","@ms/items-view/lib/private/operations/configuration/readConfiguration","../models/facets/GraphDataRequestorConfigurationFacet","../models/facets/ConfigurationFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDataRequestor=r.asOnceOnly(function(e){var t=e(u.getTelemetryManager),n=e(f.readConfiguration({graphDataRequestorConfiguration:l.graphDataRequestorConfigurationFacet})).graphDataRequestorConfiguration,r=n&&n.alwaysSendContentType;return new i.DataRequestor({alwaysSendContentType:r},{apiEvent:a.Api.withManager(t)})});t.getDriveItemUrl=function(e){var t=e.endpoint,n=e.driveId,r=e.itemId,i=void 0===r?"":r;return"me"===n&&"root"===i?t+"/me/drive/root":h(e)+"/items/"+encodeURIComponent(i)};t.getSpecialDriveItemUrl=function(e){var t=e.name;return h(e)+"/special/"+encodeURIComponent(t)};t.getSharesItemUrl=function(e){return e.endpoint+"/shares/u!"+e.shareId+"/driveItem"};t.getCommandsUrlFromDriveItem=function(e){return h(e)+"/commands"};function h(e){var t=e.endpoint,n=e.driveId;return t+"/"+(n?"drives/"+encodeURIComponent(n):"drive")}t.getDriveUrl=h;function p(e){var r=this,i=e.url,o=e.method,u=void 0===o?"GET":o,a=e.body,f=e.qosName,l=e.endpoint,c=e.headers,h=e.timeout,p=e.expectedErrors,d=e.driveUrl,v=e.useAuthorizationHeaders,m=void 0===v||v;return function(e){return n.__awaiter(r,void 0,void 0,function(){var r,o,v;return n.__generator(this,function(n){switch(n.label){case 0:r=e(t.getDataRequestor);o=void 0!==typeof a?JSON.stringify(a):void 0;return[4,e(s.getSessionToken(l,d))];case 1:v=n.sent();return[4,r.send({path:i,requestType:u,apiName:f,accessToken:v,useAuthorizationHeaders:m,postData:o,headers:c,expectedErrors:p,timeout:h})];case 2:return[2,n.sent()]}})})}}t.getRawData=p;t.getRawDataWithCache=function(e){var t=this,r=e.url,i=e.method,s=void 0===i?"GET":i,u=e.body,a=e.qosName,f=e.timeout,l=e.endpoint,c=e.headers,h=e.expectedErrors,d=e.driveUrl,v=e.useAuthorizationHeaders,m=void 0===v||v;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,v,g,y,b;return n.__generator(this,function(n){switch(n.label){case 0:t=void 0!==typeof u?JSON.stringify(u):"";i=function(e,t,n){var r=void 0!==n?n:"";return e+"__"+t+"__"+r}(r,s,t);return[4,e(o.isOffline())];case 1:v=n.sent();g=void 0!==window.navigator.onLine&&!window.navigator.onLine;return[4,e(o.getJSONResponse(i))];case 2:y=n.sent();if(g||v){if(y)return[2,y]}else if(y){e(p({url:r,method:s,body:u,qosName:a,endpoint:l,headers:c,expectedErrors:h,timeout:f,driveUrl:d,useAuthorizationHeaders:m})).then(function(t){e(o.setJSONResponse(i,t))});return[2,y]}return[4,e(p({url:r,method:s,body:u,qosName:a,endpoint:l,headers:c,expectedErrors:h,timeout:f,driveUrl:d,useAuthorizationHeaders:m}))];case 3:b=n.sent();return[4,e(o.setJSONResponse(i,b))];case 4:n.sent();return[2,b]}})})}};t.isConsumerDirectEndpoint=function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(n){return[2,!!(t=r(f.readConfiguration({isODCEndpoint:c.isConsumerDirectEndpointFacet})).isODCEndpoint)&&t(e)]})})}};t.supportsDriveItemSetRandomAccess=function(e,t){return function(n){var r=n(f.readConfiguration({supportsRandomAccess:c.supportsDriveItemSetRandomAccessFacet})).supportsRandomAccess;return!!r&&r(e,t)}}});
define("@ms/items-view-addon-graph/lib/utilities/Auth",["require","exports","tslib","../models/facets/GraphDataSourceConfigurationFacet","@ms/items-view/lib/private/operations/configuration/readConfiguration","@ms/items-view/lib/private/operations/logQoS","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/utilities-error/lib/index"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function a(e,t,a){var f=this;return function(l){return n.__awaiter(f,void 0,void 0,function(){var f,c,h,p,d,v,m,g,y,b=this;return n.__generator(this,function(w){switch(w.label){case 0:f=l(i.readConfiguration({graphDataSourceConfiguration:r.graphDataSourceConfigurationFacet})).graphDataSourceConfiguration;c=f&&f.ensureAuthToken;h=a&&f&&f.ensureAuthTokenWithAction;if(!(d=h?function(){return n.__awaiter(b,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,l(h(e,t,a))];case 1:return[2,n.sent()]}})})}:c?function(){return n.__awaiter(b,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,c(e,t)];case 1:return[2,n.sent()]}})})}:void 0))return[3,4];v=l(s.logQoS({name:"graphDataSource.getAuthToken"}));w.label=1;case 1:w.trys.push([1,3,,4]);return[4,d()];case 2:p=w.sent();l(v({resultType:o.ResultTypeEnum.Success}));return[3,4];case 3:m=w.sent();g=o.ResultTypeEnum.Failure;y=void 0;if(m instanceof u.ApiError){m.isExpected&&(g=o.ResultTypeEnum.ExpectedFailure);y=m.code}else y="UnknownAuthError";l(v({resultType:g,resultCode:y,error:m&&JSON.stringify(m)}));throw m;case 4:return[2,p]}})})}}t.getAuthToken=a;t.getSessionToken=function(e,t){var r=this;return function(i){return n.__awaiter(r,void 0,void 0,function(){var r,s;return n.__generator(this,function(n){switch(n.label){case 0:return[4,i(a(["Files.ReadWrite.All"],e,t))];case 1:(r=n.sent())&&(s={accessToken:r});return[2,s]}})})}}});
define("@ms/items-view/lib/private/operations/offlineCache",["require","exports","tslib","../facets/ConfigurationFacets","./configuration/readConfiguration"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getJSONResponse=function(e){var t=this;return function(s){return n.__awaiter(t,void 0,void 0,function(){var t,o;return n.__generator(this,function(n){switch(n.label){case 0:return(t=s(function(e){var t,n=e(i.readConfiguration({spDataSourceConfiguration:r.offlineCacheFacet})).spDataSourceConfiguration;n&&n.ensureGetJSONResponse&&(t=n.ensureGetJSONResponse);return t}))?[4,t(e)]:[3,2];case 1:o=n.sent();n.label=2;case 2:return[2,o]}})})}};t.setJSONResponse=function(e,t){var s=this;return function(o){return n.__awaiter(s,void 0,void 0,function(){var s,u;return n.__generator(this,function(n){switch(n.label){case 0:return(s=o(function(e){var t,n=e(i.readConfiguration({spDataSourceConfiguration:r.offlineCacheFacet})).spDataSourceConfiguration;n&&n.ensureSetJSONResponse&&(t=n.ensureSetJSONResponse);return t}))?[4,s(e,t)]:[3,2];case 1:u=n.sent();n.label=2;case 2:return[2,u]}})})}};function s(){return function(e){var t=e(function(e){var t,n=e(i.readConfiguration({spDataSourceConfiguration:r.offlineCacheFacet})).spDataSourceConfiguration;n&&n.isOffline&&(t=n.isOffline);return t});return!!t&&t()}}t.isOffline=s;function o(){return function(e){var t=e(i.readConfiguration({spDataSourceConfiguration:r.offlineCacheFacet})).spDataSourceConfiguration;t&&t.clearCache&&t.clearCache()}}t.clearCache=o;t.clearCacheIfNotOffline=function(){var e=this;return function(t){return n.__awaiter(e,void 0,void 0,function(){var e;return n.__generator(this,function(n){switch(n.label){case 0:return[4,t(s())];case 1:(e=!n.sent())&&t(o());return[2,e]}})})}}});
define("@ms/items-view-addon-graph/lib/models/facets/GraphDataRequestorConfigurationFacet",["require","exports","@ms/items-view/lib/private/models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphDataRequestorConfigurationFacet=new n.Facet("graphDataRequestorConfiguration")});
define("@ms/items-view-addon-graph/lib/utilities/processLocalOrRemoteDriveItem",["require","exports","tslib","./getDriveItemFacets","../models/keys/DriveItemKeyFacet","./processDriveItem","./UrlConstants"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.processLocalOrRemoteDriveItem=function(e){var t,u,a=e.driveItemResponse,f=e.endpoint,l=a.parentReference||a.remoteItem&&a.remoteItem.parentReference,c=l&&l.driveId,h="personal"===(l&&l.driveType),p={endpoint:f,driveId:c,itemId:a.remoteItem?a.remoteItem.id:h&&a.root?o.ROOT_ITEM_ID:a.id},d=i.driveItemKeyFacet.serialize(p),v=a.parentReference&&a.parentReference.id?i.driveItemKeyFacet.serialize({endpoint:f,driveId:c,itemId:h&&a.parentReference.path===o.CONSUMER_ROOT_ITEM_PATH?o.ROOT_ITEM_ID:a.parentReference.id}):void 0,m=s.processDriveItem(n.__assign({},e,{itemKey:d,driveItemKey:p,parentFolderItemKey:v})).itemResolver;if(a.remoteItem&&a.remoteItem.parentReference){var g=i.driveItemKeyFacet.serialize({endpoint:f,driveId:a.parentReference&&a.parentReference.driveId,itemId:a.id}),y=i.driveItemKeyFacet.serialize({endpoint:f,driveId:a.remoteItem.parentReference.driveId,itemId:a.remoteItem.id});m.mapKeys({mappings:(t={},t[g]=y,t)});m.resolveItems({items:(u={},u[y]=n.__assign({},r.getDriveItemFacets({driveItem:a.remoteItem,endpoint:f})),u)})}return{itemResolver:m,actualDriveItemKey:p,actualItemKey:d}}});
define("@ms/items-view-addon-graph/lib/utilities/getDriveItemFacets",["require","exports","tslib","@ms/items-view/lib/private/facets/DocumentFacets","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/facets/SetFacets","../models/keys/DriveItemKeyFacet","../models/keys/DriveItemSetKeyFacet","../models/facets/GraphThumbnailSetFacet","../models/facets/DriveItemResponseFacet","../models/keys/DriveAnalyticsItemKeyFacet","../models/facets/SharedFacet","../models/items/GraphItems.resx","@ms/items-view/lib/private/facets/MediaFacets","@ms/items-view/lib/private/facets/GroupFacets","../models/facets/DriveTypeFacet","../models/facets/VaultFacet","../models/facets/DriveItemFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDriveItemFacets=function(e){var t=e.driveItemKey,w=e.driveItem,E=e.endpoint,S=e.parentFolderItemKey,x=e.shouldReturnShareFacets,T=void 0===x||x,N=w.file,C=w.fileSystemInfo,k=w.folder,L=w.name,A=w.parentReference,O=w.remoteItem,M=w.root,_=w.shared,D=w.size,P=w.thumbnails,H=w.image,B=w.eTag,j=w.lastModifiedDateTime,F=void 0===j?C&&C.lastModifiedDateTime:j,I=A&&A.driveId,q=A&&A.driveType,R="personal"===q,U=C&&C.lastAccessedDateTime,z=w.package||O&&O.package,W=P||O&&O.thumbnails,X={itemId:w.id,driveId:I,endpoint:E},V=C&&C.systemPath,$=t||O&&O.parentReference&&{itemId:O.id,driveId:O.parentReference.driveId,endpoint:E}||X,J=w.webDavUrl||O&&O.webDavUrl,K=M?h.default.files:L||O&&O.name||"",Q=Boolean(w.folder||O&&O.folder);return n.__assign({},o.driveItemKeyFacet.pack($),i.displayNameFacet.pack(K),i.fileSizeFacet.pack(D||O&&O.size),C||k||N||O&&O.folder?n.__assign({},i.folderFacet.pack(Q?{}:void 0)):{},i.openUrlFacet.pack(Q?void 0:w.webUrl),V?n.__assign({},g.systemFilePathFacet.pack(V)):{},J?i.canonicalUrlFacet.pack(J):{},i.dateModifiedFacet.pack(F?new Date(F).getTime():void 0),U?n.__assign({},i.dateAccessedFacet.pack(new Date(U).getTime())):{},r.oneNoteFacet.pack(z&&"oneNote"===z.type?{}:void 0),a.graphThumbnailSetFacet.pack(W),f.driveItemResponseFacet.pack(w),B?i.eTagFacet.pack(B):{},H&&H.width&&H.height?p.dimensionsFacet.pack({width:H.width,height:H.height}):{},s.defaultChildItemSetFacet.pack({itemKey:u.driveItemSetKeyFacet.serialize({driveItemKey:$,sortBy:"",isAscending:!0})}),i.analyticsItemFacet.pack({itemKey:l.driveAnalyticsItemKeyFacet.serialize({driveItemKey:$})}),i.parentFolderItemFacet.pack(S?{itemKey:S}:void 0),!R&&J?n.__assign({},i.parentFolderItemNameFacet.pack(y(J))):{},v.driveTypeFacet.pack(q),R?n.__assign({},m.vaultFacet.pack(w.vault)):{},i.fileNameFacet.pack(b(K,Q)),T?n.__assign({},i.isSharedFacet.pack(!!_),c.sharedFacet.pack(_)):{},d.countFacet.pack(w.folder&&w.folder.childCount),g.mimeTypeFacet.pack(N&&N.mimeType))};function y(e){var t=e.split("/");return t.length>2?decodeURI(t[t.length-2]):void 0}t.getParentFolder=y;function b(e,t){var n=e.lastIndexOf(".");return t||n<0?{name:e,extension:""}:{name:e.substring(0,n),extension:e.substring(n)}}t.getFileName=b});
define("@ms/items-view-addon-graph/lib/models/keys/DriveItemSetKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet","./DriveItemKeyFacet","./DriveFilterKeyFacet"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemSetKeyFacet=new n.KeyFacet("driveItemSet",{driveItemKey:n.subKeyPart(r.driveItemKeyFacet),sortBy:n.stringPart(),isAscending:n.booleanPart(),extFilters:n.arrayPart(n.stringPart()),filters:n.arrayPart(n.subKeyPart(i.driveFilterKeyFacet))})});
define("@ms/items-view-addon-graph/lib/models/facets/GraphThumbnailSetFacet",["require","exports","@ms/items-view/lib/private/models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphThumbnailSetFacet=new n.Facet("graphThumbnailSet")});
define("@ms/items-view-addon-graph/lib/models/facets/DriveItemResponseFacet",["require","exports","@ms/items-view/lib/private/models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemResponseFacet=new n.Facet("driveItemResponse")});
define("@ms/items-view-addon-graph/lib/models/keys/DriveAnalyticsItemKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet","./DriveItemKeyFacet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveAnalyticsItemKeyFacet=new n.KeyFacet("driveAnalyticsItem",{driveItemKey:n.subKeyPart(r.driveItemKeyFacet)})});
define("@ms/items-view/lib/private/facets/MediaFacets",["require","exports","../models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.thumbnailFacet=new n.Facet("thumbnail");t.dimensionsFacet=new n.Facet("dimensions");t.photoFacet=new n.Facet("photo");t.videoFacet=new n.Facet("video")});
define("@ms/items-view-addon-graph/lib/models/facets/DriveTypeFacet",["require","exports","@ms/items-view/lib/private/models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveTypeFacet=new n.Facet("driveType")});
define("@ms/items-view-addon-graph/lib/models/facets/VaultFacet",["require","exports","@ms/items-view/lib/private/models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.vaultFacet=new n.Facet("vault")});
define("@ms/items-view-addon-graph/lib/utilities/processDriveItem",["require","exports","tslib","./getDriveItemFacets","@ms/items-view/lib/private/operations/invalidateItems","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/facets/SetFacets","@ms/items-view/lib/private/models/items/ItemResolver","../models/keys/DriveActivityItemKeyFacet"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.processDriveItem=function(e){var t,f=e.itemKey,l=e.driveItemKey,c=e.parentFolderItemKey,h=e.setItemKey,p=e.driveItemResponse,d=e.endpoint,v=e.getDriveItemFacets,m=void 0===v?r.getDriveItemFacets:v,g=new u.ItemResolver,y=a.driveActivityItemKeyFacet.serialize({driveItemKey:l}),b=h?i.getInvalidationFacet().forFacet(s.displayNameFacet).thenInvalidate(h,o.childItemsFacet).forFacet(s.deletedFacet).thenInvalidate(h,o.childItemsFacet).pack():void 0,w=n.__assign({},m({driveItemKey:l,driveItem:p,endpoint:d,parentFolderItemKey:c}),s.activityItemFacet.pack({itemKey:y}),b);g.resolveItems({items:(t={},t[f]=w,t)});return{itemResolver:g}}});
define("@ms/items-view-addon-graph/lib/models/keys/DriveActivityItemKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet","./DriveItemKeyFacet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveActivityItemKeyFacet=new n.KeyFacet("driveActivityItem",{driveItemKey:n.subKeyPart(r.driveItemKeyFacet)})});
define("@ms/items-view-addon-graph/lib/utilities/UrlConstants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ROOT_ITEM_ID="root";t.CONSUMER_ROOT_ITEM_PATH="/drive/root:";t.DEFAULT_PAGE_SIZE=30});
define("@ms/items-view-addon-graph/lib/handlers/operations/driveItem/getItemsAnalyticsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","../../../models/keys/DriveAnalyticsItemKeyFacet","@ms/items-view/lib/private/facets/ItemAnalyticsFacets","@ms/odsp-utilities/lib/features/Features","@ms/odsp-graph/lib/services/itemAnalytics/ItemAnalyticsService","../../../utilities/Data","@ms/items-view/lib/private/models/ItemAnalytics","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/items-view/lib/private/operations/getItems","@ms/items-view/lib/private/utilities/async/all","@ms/shared-react-item-hover-card/lib/FileHoverCardHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d={ODB:1689},v={ODB:1097,OneDrive:!0};t.driveAnalyticsItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,v=i.driveAnalyticsItemKeyFacet.deserialize(r).driveItemKey,y=v.endpoint;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,b,w,E,S,x,T=this;return n.__generator(this,function(N){t={Caller:"hovercard_addon-graph"};i="GetItemAnalytics_addon-graph";b=n.__awaiter(T,void 0,void 0,function(){var f,l,h;return n.__generator(this,function(p){switch(p.label){case 0:return[4,e(a.getRawDataWithCache({url:m(a.getDriveItemUrl(v)),qosName:i+"_GetAnalyticsSections",endpoint:y,timeout:6e3,headers:t,driveUrl:g(a.getDriveUrl(v)),useAuthorizationHeaders:!o.default.isFeatureEnabled(d)}))];case 1:l=p.sent();h=u.parseResponseOfAnalyticsSections(l);e(c.resolveItems({items:(f={},f[r]=n.__assign({},s.viewCountFacet.pack(h.viewCount),s.viewerCountFacet.pack(h.viewerCount),s.isTrendingFacet.pack(h.isTrending),s.activitiesFacet.pack(h.activities),s.likeCountFacet.pack(h.likeCount),s.commentCountFacet.pack(h.commentCount),s.lifeCycleStatusFacet.pack(h.lifeCycleStatus),s.keyPointsFacet.pack(h.keyPointsData),s.incompleteDataFacet.pack(h.incompleteData)),f)}));return[2]}})});w=[b];if(!l.Killswitch.isActivated("c0189bf0-b5ab-40e7-b523-42ca8f2d4b11","6/19/2019","shadow call for recommendedactions and sharewith")){E=n.__awaiter(T,void 0,void 0,function(){var u,f,l;return n.__generator(this,function(h){switch(h.label){case 0:return[4,e(a.getRawDataWithCache({url:(p=a.getDriveItemUrl(v),m=g(p),m+"?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities))"),qosName:i+"_GetRecommendedActions",endpoint:y,timeout:6e3,headers:t,driveUrl:g(a.getDriveUrl(v)),useAuthorizationHeaders:!o.default.isFeatureEnabled(d)}))];case 1:f=h.sent();l=function(e){var t=e.recommendedActionSet,n=t.nonAggregatedRecommendedActions;t.aggregatedEditRecommendedAction&&t.aggregatedEditRecommendedAction.recentEditorCount&&(n=n.concat(t.aggregatedEditRecommendedAction));return n}(f);e(c.resolveItems({items:(u={},u[r]=n.__assign({},s.recommendedActionsFacet.pack(l)),u)}));return[2]}var p,m})});w.push(E);if(p.isLowActivityTidbitEnabled()){S=n.__awaiter(T,void 0,void 0,function(){var o,u;return n.__generator(this,function(f){switch(f.label){case 0:return[4,e(a.getRawDataWithCache({url:(l=a.getDriveItemUrl(v),h=g(l),h+"/recommendations/shareWith/users?$top=2&$filter=userType eq 'Internal'"),qosName:i+"_GetShareWithPeople",endpoint:y,timeout:6e3,headers:t}))];case 1:u=f.sent();e(c.resolveItems({items:(o={},o[r]=n.__assign({},s.recommendedPeopleFacet.pack(u.value)),o)}));return[2]}var l,h})});w.push(S)}}if(!l.Killswitch.isActivated("55386028-b3cf-4b16-a472-2c8d9e9c7fec","7/5/2019","shadow call for conversations")){x=n.__awaiter(T,void 0,void 0,function(){var u,l,h;return n.__generator(this,function(p){switch(p.label){case 0:return[4,e(a.getRawDataWithCache({url:(m=a.getDriveItemUrl(v),b=g(m),b+"?$expand=conversationSet($expand=emailConversations($expand=participants),meetingConversations($expand=participants),teamsConversations($expand=participants))"),qosName:i+"_GetConversations",endpoint:y,timeout:6e3,headers:t,driveUrl:g(a.getDriveUrl(v)),useAuthorizationHeaders:!o.default.isFeatureEnabled(d)}))];case 1:l=p.sent();h=function(e){var t=e.conversationSet,n=t.emailConversations.concat(t.meetingConversations,t.teamsConversations),r={},i=[];n.forEach(function(e){var t=e.teamsMessageThreadId||e.conversationInstance.conversationId;if(!r.hasOwnProperty(t)){r[t]=!0;i.push({activityTimestamp:e.conversationInstance.sharedByTime,context:e.conversationInstance.subject,conversationType:f.ConversationType[e.conversationInstance.referenceType],deepLink:e.conversationInstance.deepLink,referencePreview:e.conversationInstance.referencePreview,isSharedByMe:e.conversationInstance.isSharedByMe,sharedByUserDisplayName:e.sharedByUser.displayName,participants:e.participants})}});return i.sort(function(e,t){return Date.parse(t.activityTimestamp)-Date.parse(e.activityTimestamp)})}(l);e(c.resolveItems({items:(u={},u[r]=n.__assign({},s.conversationsFacet.pack(h)),u)}));return[2]}var m,b})});w.push(x)}return[2,h.waitForAll(w)]})})}});function m(e){var t=g(e),n="";o.default.isFeatureEnabled(v)&&(n=",insights($expand=keyPoints)");var r="$expand=analytics($expand=allTime($expand=activities))",i="$select=*,id,reactions,malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention";return t+"?"+(n?i+"&"+r+n:i+"&"+r)}function g(e){return e.replace("2.0","2.1")}});
define("@ms/odsp-graph/lib/services/itemAnalytics/ItemAnalyticsService",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/features/Features","./IItemAnalytics","@ms/odsp-utilities/lib/logging/events/Qos.event","../../models/error/Error","@ms/odsp-utilities/lib/dateTime/DateTime","./LifecycleStatusHelper","./KeyPointsHelper","@ms/odsp-utilities/lib/killswitch/Killswitch"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h={ODB:1156};t.IMAGE_LINK="/_layouts/15/userphoto.aspx?size=S&accountname=";var p=c.Killswitch.isActivated("1B23F399-20D5-4D78-9FE5-7FAC542E706E","1/30/2018","ItemAnalytics API transfer to vroom 2.1")?"v2.0":"v2.1",d=function(){function e(e,n){this._eTagMap={};this._dataRequestor=n.vroomDataRequestor;var r=n.getProfileImageUrl,i=void 0===r?function(e){return""+t.IMAGE_LINK+e}:r,s=n.caller,o=void 0===s?"hovercard":s,u=n.useSharePointApi,a=void 0!==u&&u;this._getProfileImageUrl=i;this._caller=o;this._useSharePointApi=a}e.prototype.getItemAnalytics=function(e,t){void 0===t&&(t={});var n=t.apiVersion,s=void 0===n?p:n,o=t.skipToken,u=void 0===o?"":o,a=t.headers,f=void 0===a?{Caller:this._caller}:a,l=u?";$skiptoken="+u:"",c="GetItemAnalytics"+s+(e.queryType?"_"+e.queryType:"");i.default.isFeatureEnabled(h)&&(c+="_WithGuestUser");var d=this._getBaseUrl(e);if(!d)return r.default.resolve();var v=d+"/analytics/allTime?$expand=activities"+"($filter=access%20ne%20null)"+l;return this._getAnalytics(c,v,!1,e,f)};e.prototype.getAnalyticsSections=function(e,t){void 0===t&&(t={});if(!this._useSharePointApi){var n=l.isKeyPointsEnabled()||f.isLifeCycleEnabled();if(n){var i=t.headers,s=void 0===i?{Caller:this._caller}:i,o="GetAnalyticsSections",u="",a="",c="",h=this._getBaseUrl(e);if(!h)return r.default.resolve();if(l.isReactionEnabled()){u=",id,reactions";o+="_WithReaction"}if(l.isKeyPointsEnabled()){c="$expand=insights($expand=keyPoints)";o+="_WithKeyPoints"}if(f.isLifeCycleEnabled()){a=",malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention";o+="_WithLifeCycle"}var p="$select=*"+u+a,d=c?p+"&"+c:p,v=this._useSharePointApi?h+"/driveItem?"+d:h+"?"+d;return this._getAnalytics(o,v,n,e,s)}}};e.prototype.getItemAnalyticsSections=function(e,t){void 0===t&&(t={});var n="$expand=analytics($expand=allTime($expand=activities($filter=access%20ne%20null)))",s=this._getBaseUrl(e);if(!s)return r.default.resolve();var o=t.apiVersion,u=void 0===o?p:o,a=t.headers,c=void 0===a?{Caller:this._caller}:a,d=e.queryType?"_"+e.queryType:"";if(this._useSharePointApi){var v="GetItemAnalyticsSharePoint"+u+d,m=s+"/driveItem?"+n;return this._getAnalytics(v,m,!0,e,c)}var g="GetItemAnalyticsSections"+u+d,y="",b="",w="";i.default.isFeatureEnabled(h)&&(g+="_WithGuestUser");if(l.isReactionEnabled()){y=",id,reactions";g+="_WithReaction"}if(l.isKeyPointsEnabled()){w=",insights($expand=keyPoints)";g+="_WithKeyPoints"}if(f.isLifeCycleEnabled()){b=",malware,metadataMissing,awaitingApproval,trending,retentionPolicy,publication,dataLossPrevention";g+="_WithLifeCycle"}var E="$select=*"+y+b,S=s+"?"+(w?E+"&"+n+w:E+"&"+n),x=l.isKeyPointsEnabled()||f.isLifeCycleEnabled();return this._getAnalytics(g,S,x,e,c)};e.prototype.getLastSevenDaysItemAnalytics=function(e){var t=this._getBaseUrl(e),n={Caller:this._caller};if(!t)return r.default.resolve();var i=t+"/analytics/lastSevenDays?$expand=activities($filter=ActivityType%20eq%20%27Access%27)";return this._getAnalytics("GetLastSevenDaysItemAnalytics",i,!1,e,n)};e.prototype.getItemAnalyticsByInterval=function(e,t,n,r){var i=p,s=t.toISOString(),o=n.toISOString(),u=this._getBaseUrl(e),a=this._getAnalyticsByIntervalPath(u,i,s,o,r);return this._getAnalyticsByInterval("GetDailyItemAnalytics",a,e.getAccessToken&&e.getAccessToken(),i)};e.prototype._getAnalytics=function(e,t,n,r,i,s){var o=this;return this._dataRequestor.send({apiName:e,path:t,accessToken:r.getAccessToken&&r.getAccessToken(),headers:i,timeout:6e3,qosExtraData:{Caller:this._caller}}).then(function(e){"string"==typeof e.isTrending&&"True"===e.isTrending||"boolean"==typeof e.isTrending&&!0===e.isTrending?e.isTrending=!0:e.isTrending=!1;e.eTag&&(o._eTagMap[r.itemId]=e.eTag);return n?v(e,o._getProfileImageUrl):m(e,o._getProfileImageUrl)})};e.prototype.updateItemKeyPoints=function(e,t){var n=this,r=this._getBaseUrl(e)+"/insights/keyPoints";return this._dataRequestor.send({path:r,apiName:"UpdateKeyPoints",requestType:"POST",headers:{Caller:this._caller,"if-Match":this._eTagMap[e.itemId]},postData:JSON.stringify({value:t}),accessToken:e.getAccessToken&&e.getAccessToken(),timeout:6e3,qosExtraData:{Caller:this._caller},parseResponse:function(t){n._eTagMap[e.itemId]=t.getResponseHeader("eTag");return JSON.parse(t.responseText)}}).then(function(e){return e.value})};e.prototype._getAnalyticsByInterval=function(e,t,n,r){return this._dataRequestor.send({apiName:e,path:t,accessToken:n,useAuthorizationHeaders:this._useSharePointApi,timeout:6e3,qosExtraData:{Caller:this._caller}}).then(function(e){var t;"v2.1"===r?(e=e)&&e.value&&(t=e.value.map(b)):t=(e=e).Items;return t})};e.prototype._getBaseUrl=function(e){return e&&e.graphItemUrl?""+e.graphItemUrl:null};e.prototype._getAnalyticsByIntervalPath=function(e,t,n,r,i){var s;i=i||"day";var o="v2.1"===t?"oneDrive.getActivitiesByInterval":"getanalyticsbyinterval";s=this._useSharePointApi?"interval='"+i+"',startDateTime='"+n+"',endDateTime='"+r+"'":"v2.1"===t?"startDateTime="+n+"&endDateTime="+r+"&interval="+i:"startDateTime='"+n+"'&endDateTime='"+r+"'&interval='"+i+"'";return this._useSharePointApi?e+"/oneDrive.getActivitiesByInterval("+s+")":e+"/"+o+"?"+s};e.prototype.getFilesAnalytics=function(e,t,n){var i=this;return e&&t?this._dataRequestor.send({apiName:"getFilesAnalytics.byItems",useAuthorizationHeaders:!0,accessToken:n,apiVersion:"v2.1",path:t+"/items?$expand=analytics($expand=lastSevenDays)&$filter=sharepointIds/listItemUniqueId eq '"+e.join("' or sharepointIds/listItemUniqueId eq '")+"'",postProcessQos:this._overrideFilesAnalyticsExpectedFailure}).then(function(e){return i._parseFilesAnalyticsResponse(e)}):r.default.resolve()};e.prototype.getRecommendedActions=function(e){var t=this._getBaseUrl(e)+"?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities))";return this._dataRequestor.send({apiName:"RecommendedActions",path:t,accessToken:e.getAccessToken&&e.getAccessToken(),timeout:6e3,parseResponse:function(e){return JSON.parse(e.responseText).recommendedActionSet},headers:{Caller:this._caller},qosExtraData:{Caller:this._caller}})};e.prototype.getShareWith=function(e){var t=this._getBaseUrl(e)+"/recommendations/shareWith/users?$top=2&$filter=userType eq 'Internal'";return this._dataRequestor.send({apiName:"ShareWith",path:t,accessToken:e.getAccessToken&&e.getAccessToken(),timeout:6e3,parseResponse:function(e){return JSON.parse(e.responseText).value},headers:{Caller:this._caller},qosExtraData:{Caller:this._caller}})};e.prototype.getEditActivities=function(e){var t=this._getBaseUrl(e)+"/analytics/allTime?$expand=activities($filter=edit ne null)";return this._dataRequestor.send({apiName:"EditActivities",path:t,accessToken:e.getAccessToken&&e.getAccessToken(),timeout:6e3,parseResponse:function(e){return y(JSON.parse(e.responseText).activities)},headers:{Caller:this._caller},qosExtraData:{Caller:this._caller}})};e.prototype._overrideFilesAnalyticsExpectedFailure=function(e,t){var r=u.getErrorResolution(t,function(e){switch(e){case"notSupported":return{resultType:o.ResultTypeEnum.ExpectedFailure}}});return n.__assign({},e,r||{})};e.prototype._parseFilesAnalyticsResponse=function(e){var t=this,r=(e.value,n.__rest(e,["value"])),i=e.value.map(function(e){var r=e.analytics,i=n.__rest(e,["analytics"]);return n.__assign({},i,{analytics:{lastSevenDays:g(r.lastSevenDays,t._getProfileImageUrl)}})});return n.__assign({},r,{value:i})};return e}();t.ItemAnalyticsService=d;function v(e,t){var n=e&&e.analytics&&e.analytics.allTime,r=n&&n.access,i=n&&n.endDateTime,o=y(n&&n.activities,t),u=function(e){var t=[];e.malware&&t.push({status:s.AnalyticsLifeCycleStatus.MalwareDetected});e.publication&&e.publication.level.indexOf("checkout")>-1&&t.push({status:s.AnalyticsLifeCycleStatus.ThisFileIsCheckedOut,userCheckedOutThis:e.publication.checkedOutBy&&e.publication.checkedOutBy.user});e.dataLossPrevention&&(e.dataLossPrevention.block?t.push({status:s.AnalyticsLifeCycleStatus.DLPBlocked}):e.dataLossPrevention.notify&&t.push({status:s.AnalyticsLifeCycleStatus.DLPWarning}));e.metadataMissing&&t.push({status:s.AnalyticsLifeCycleStatus.MissingMetaData});e.awaitingApproval&&t.push({status:s.AnalyticsLifeCycleStatus.AwaitingApproval});e.trending&&t.push({status:s.AnalyticsLifeCycleStatus.Trending});if(e.createdDateTime){var n=new Date(e.createdDateTime);f.isItemLifeCycleStatusNew(n)&&t.push({status:s.AnalyticsLifeCycleStatus.New,createdRelativeTime:a.getFriendlyDateTimeStringPast(a.iso8601DateTimeToJsDate(e.createdDateTime)),creator:e.createdBy&&e.createdBy.user})}return t}(e),l=function(e){var t=e&&e.insights,n=t&&t.keyPoints;return t&&{readTime:t.readTime,keyPoints:n}}(e),c=e&&e.reactions;return{activities:o||[],incompleteData:n&&n.incompleteData,startDateTime:n&&n.startDateTime,skipToken:n&&n.skipToken,isTrending:n&&n.isTrending,viewCount:r&&r.actionCount,viewerCount:r&&r.actorCount,commentCount:c&&c.commentCount,likeCount:c&&c.likeCount,lifeCycleStatus:u,keyPointsData:l,lastActivityDateTime:i}}t.parseResponseOfAnalyticsSections=v;function m(e,t){var r=e.activities,i=e.access,s=e.endDateTime,o=n.__rest(e,["activities","access","endDateTime"]);return{activities:y(r,t),incompleteData:o.incompleteData,startDateTime:o.startDateTime,skipToken:o.skipToken,isTrending:o.isTrending,viewCount:i&&i.actionCount,viewerCount:i&&i.actorCount,lastActivityDateTime:s}}t.parseResponseV21=m;function g(e,r){e.activities;var i=n.__rest(e,["activities"]),s=e.activities&&e.activities.map(function(e){var i=n.__rest(e,[]),s=i.actor&&i.actor.user&&i.actor.user.email;i.activityDateTime=a.getFriendlyDateTimeStringPast(a.iso8601DateTimeToJsDate(i.activityDateTime));i.actor.user.image=r&&r(i.actor.user.email)||""+t.IMAGE_LINK+s;return i});return n.__assign({},i,{activities:s})}t.parseResponse=g;function y(e,r){return e&&e.map(function(e){var s,o=n.__rest(e,[]),u=o.actor&&o.actor.user&&o.actor.user.email,f=n.__assign({},o.actor.user,{image:r?r(u):""+t.IMAGE_LINK+u});if(i.default.isFeatureEnabled(h)){f=n.__assign({},f,{userType:o.actor.user.userType});s=o.location}return n.__assign({},o,{activityDateTime:a.getFriendlyDateTimeStringPast(a.iso8601DateTimeToJsDate(o.activityDateTime)),actor:n.__assign({},o.actor,{location:s,user:f}),activityType:o.access?"Access":"Edit"})})}function b(e){return e&&{activity:{},incompleteData:{missingDataBeforeDateTime:e.endDateTime,wasThrottled:e.incompleteData&&e.incompleteData.wasThrottled},interval:void 0,isTrending:e.isTrending,startDateTime:e.startDateTime,viewCount:e.access&&e.access.actionCount,viewerCount:e.access&&e.access.actorCount}}});
define("@ms/odsp-graph/lib/services/itemAnalytics/IItemAnalytics",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.MalwareDetected=0]="MalwareDetected";e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut";e[e.DLPBlocked=2]="DLPBlocked";e[e.MissingMetaData=3]="MissingMetaData";e[e.DLPWarning=4]="DLPWarning";e[e.AwaitingApproval=5]="AwaitingApproval";e[e.Trending=6]="Trending";e[e.New=7]="New"}(t.AnalyticsLifeCycleStatus||(t.AnalyticsLifeCycleStatus={}))});
define("@ms/odsp-graph/lib/services/itemAnalytics/LifecycleStatusHelper",["require","exports","@ms/odsp-utilities/lib/features/Features"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=1728e5,i={ODB:1146};t.isLifeCycleEnabled=function(){return n.default.isFeatureEnabled(i)};t.isItemLifeCycleStatusNew=function(e){var t=(new Date).getTime(),n=e&&e.valueOf();return!isNaN(n)&&t-n<r}});
define("@ms/odsp-graph/lib/services/itemAnalytics/KeyPointsHelper",["require","exports","@ms/odsp-utilities/lib/features/Features"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={ODB:1097,OneDrive:!0},i={ODB:1271,OneDrive:!0};t.isKeyPointsEnabled=function(){return n.default.isFeatureEnabled(r)};t.isReactionEnabled=function(){return n.default.isFeatureEnabled(i)}});
define("@ms/items-view/lib/private/models/ItemAnalytics",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.IMAGE_LINK="/_layouts/15/userphoto.aspx?size=S&accountname=";!function(e){e[e.MalwareDetected=0]="MalwareDetected";e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut";e[e.DLPBlocked=2]="DLPBlocked";e[e.MissingMetaData=3]="MissingMetaData";e[e.DLPWarning=4]="DLPWarning";e[e.AwaitingApproval=5]="AwaitingApproval";e[e.Trending=6]="Trending";e[e.New=7]="New"}(t.AnalyticsLifeCycleStatus||(t.AnalyticsLifeCycleStatus={}));!function(e){e[e.Mail=0]="Mail";e[e.CalendarEvent=1]="CalendarEvent";e[e.Teams=2]="Teams"}(t.ConversationType||(t.ConversationType={}))});
define("@ms/shared-react-item-hover-card/lib/FileHoverCardHelper",["require","exports","@ms/odsp-utilities/lib/features/Features","@ms/odsp-utilities/lib/icons/OfficeFileNameHelper"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={ODB:1418,OneDrive:!0},s={ODB:1588,OneDrive:!0},o={ODB:1622,OneDrive:!0},u={ODB:1656,OneDrive:!0},a=[r.wordType,r.excelType,r.powerpointType,".docx",".xlsx",".pptx",".doc",".xls",".ppt",".pdf"];t.isRecommendedActionsSupported=function(e,t){var n=e||t;return!!n&&a.indexOf(n)>-1};t.isRecommendedActionsEnabled=function(){return n.default.isFeatureEnabled(i)};t.isSaveForLaterOn=function(){return n.default.isFeatureEnabled(s)};t.isConversationsEnabled=function(){return n.default.isFeatureEnabled(o)};t.isLowActivityTidbitEnabled=function(){return n.default.isFeatureEnabled(u)}});
define("@ms/items-view-addon-graph/lib/handlers/operations/specialDriveItem/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","../../../models/keys/SpecialDriveItemKeyFacet","../../../utilities/Data","../../../models/keys/DriveItemKeyFacet","../../../utilities/getDriveItemFacets","@ms/items-view/lib/private/facets/SetFacets","../../../models/keys/DriveItemSetKeyFacet","@ms/items-view/lib/private/models/items/ItemResolver","@ms/items-view/lib/private/facets/OperationFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.specialDriveItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,h=i.specialDriveItemKeyFacet.deserialize(r),p=h.driveId,d=h.endpoint;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,v,m,g,y,b,w,E;return n.__generator(this,function(S){switch(S.label){case 0:return[4,e(s.getRawData({url:s.getSpecialDriveItemUrl(h),qosName:"getItem",endpoint:d}))];case 1:v=S.sent();m=new l.ItemResolver;g=v&&v.parentReference;y=g&&g.driveId;b={endpoint:d,driveId:y||p,itemId:v.id};w=o.driveItemKeyFacet.serialize(b);E=g&&g.id?o.driveItemKeyFacet.serialize({endpoint:d,driveId:y,itemId:g.id}):void 0;m.resolveItems({items:(t={},t[w]=n.__assign({},u.getDriveItemFacets({driveItem:v,endpoint:d,parentFolderItemKey:E}),c.preferredKeyFacetFacet.pack(o.driveItemKeyFacet),a.defaultChildItemSetFacet.pack({itemKey:f.driveItemSetKeyFacet.serialize({driveItemKey:b,sortBy:"",isAscending:!0})})),t)});m.mapKeys({mappings:(i={},i[w]=r,i)});e(m.execute());return[2]}})})}})});
define("@ms/items-view-addon-graph/lib/models/keys/SpecialDriveItemKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.specialDriveItemKeyFacet=new n.KeyFacet("specialDriveItem",{endpoint:n.stringPart(),driveId:n.stringPart({shouldNormalizeToEmpty:!0}),name:n.stringPart()})});
define("@ms/items-view-addon-graph/lib/handlers/operations/driveItemPage/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/facets/SetFacets","@ms/items-view/lib/private/facets/ItemFacets","../../../models/keys/DriveItemPageKeyFacet","../../../utilities/Data","../../../models/keys/DriveItemKeyFacet","../../../utilities/getDriveItemFacets","@ms/items-view/lib/private/operations/invalidateItems","@ms/items-view/lib/private/models/items/ItemResolver","@ms/items-view/lib/private/models/items/PageHelpers","@ms/items-view/lib/private/operations/configuration/readConfiguration","../../../models/facets/ConfigurationFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemPageGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,v=o.driveItemPageKeyFacet.deserialize(r),m=v.setItemKey,g=v.endpoint,y=v.token;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,v,b,w,E,S,x,T,N,C,k,L,A,O,M;return n.__generator(this,function(_){switch(_.label){case 0:return[4,e(u.getRawData({endpoint:g,url:y,qosName:"getChildrenPage"}))];case 1:v=_.sent();b=new c.ItemResolver;w=[];E=0,S=v.value;_.label=2;case 2:if(!(E<S.length))return[3,5];x=S[E];T=x&&(x.parentReference||x.remoteItem&&x.remoteItem.parentReference);N=T&&T.driveId;C=a.driveItemKeyFacet.serialize({itemId:x.id,driveId:N,endpoint:g});k=T?a.driveItemKeyFacet.serialize({itemId:T.id,driveId:N,endpoint:g}):void 0;w.push(C);b.resolveItems({items:(t={},t[C]=n.__assign({},f.getDriveItemFacets({driveItem:x,endpoint:g,parentFolderItemKey:k}),l.getInvalidationFacet().forFacet(s.displayNameFacet).thenInvalidate(r,i.childItemsFacet).forFacet(s.deletedFacet).thenInvalidate(r,i.childItemsFacet).pack()),t)});return(L=e(p.readConfiguration({processDriveItemFromSharePoint:d.processDriveItemFromSharePointFacet})).processDriveItemFromSharePoint)?[4,e(L.process({itemKey:C,driveItem:x}))]:[3,4];case 3:A=_.sent().itemResolver;b.merge(A);_.label=4;case 4:E++;return[3,2];case 5:if(O=v["@odata.nextLink"]){M=o.driveItemPageKeyFacet.serialize({setItemKey:m,endpoint:g,token:O});b.merge(h.resolveNewPage({itemKey:M}).itemResolver);w.push(M)}b.merge(h.resolveExistingPage({itemKey:r,itemSetKey:m,childItemKeys:w}).itemResolver);e(b.execute());return[2]}})})}})});
define("@ms/items-view-addon-graph/lib/models/keys/DriveItemPageKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemPageKeyFacet=new n.KeyFacet("driveItemPage",{endpoint:n.stringPart(),setItemKey:n.stringPart(),token:n.stringPart()})});
define("@ms/items-view/lib/private/models/items/PageHelpers",["require","exports","tslib","./ItemResolver","../../facets/SetFacets","../Facet","../../utilities/Graft"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resolveNewPage=function(e){var t,s,o=e.itemKey,u=new r.ItemResolver;u.resolveItems({items:(t={},t[o]=n.__assign({},i.pageFacet.pack({})),t)});u.invalidateItems({items:(s={},s[o]=[i.childItemsFacet],s)});return{itemResolver:u}};t.resolveExistingPage=function(e){var t,u=e.itemKey,a=e.itemSetKey,f=e.childItemKeys,l=new r.ItemResolver;l.resolveItems({items:(t={},t[u]=n.__assign({},i.pageFacet.pack({}),i.childItemsFacet.pack(void 0)),t[a]=s.pack({childItems:i.childItemsFacet},{childItems:{itemKeys:new o.ArraySpliceMatchPatch(function(e){return e===u},f)}}),t)});return{itemResolver:l}}});
define("@ms/items-view-addon-graph/lib/handlers/operations/sharedWithMeRootItem/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","../../../models/keys/SharedWithMeRootItemKeyFacet","@ms/items-view/lib/private/facets/SetFacets","../../../models/keys/SharedWithMeItemSetKeyFacet","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/models/items/ItemResolver","../../../models/items/GraphItems.resx"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeRootItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,l=i.sharedWithMeRootItemKeyFacet.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i;return n.__generator(this,function(c){(i=new a.ItemResolver).resolveItems({items:(t={},t[r]=n.__assign({},s.defaultChildItemSetFacet.pack({itemKey:o.sharedWithMeItemSetKeyFacet.serialize({driveItemKey:l,sortBy:"",isAscending:!0})}),u.displayNameFacet.pack(f.default.sharedWithMe),u.folderFacet.pack({}),u.parentFolderItemFacet.pack(void 0)),t)});e(i.execute());return[2]})})}})});
define("@ms/items-view-addon-graph/lib/models/keys/SharedWithMeRootItemKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeRootItemKeyFacet=new n.KeyFacet("sharedRootItem",{endpoint:n.stringPart()})});
define("@ms/items-view-addon-graph/lib/handlers/operations/sharedWithMeItemSet/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","../../../models/keys/SharedWithMeItemSetKeyFacet","../../../utilities/getAndProcessDriveItemSetData","../../../models/keys/SharedWithMeRootItemKeyFacet","../../../utilities/Data","../../../utilities/sharedFilterHelper","../../../utilities/sharedSortHelper"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=i.sharedWithMeItemSetKeyFacet.deserialize(e.itemKey),l=r.filters,c=r.sortBy,h=r.isAscending;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,p,d,v;return n.__generator(this,function(m){switch(m.label){case 0:t=i.sharedWithMeItemSetKeyFacet.deserialize(e.itemKey);p=t.driveItemKey.endpoint;return[4,r(u.isConsumerDirectEndpoint(p))];case 1:d=m.sent();return[4,r(s.getAndProcessDriveItemSetData(n.__assign({},e,{qosName:"sharedWithMe",itemSetKeyFacet:i.sharedWithMeItemSetKeyFacet,parentItemKeyFacet:o.sharedWithMeRootItemKeyFacet,getUrl:function(e){return d?p+"/drive/view.sharedWithMe?allowExternal=true":p+"/me/drive/sharedWithMe?expand=formats&allowExternal=true"},filterChildItems:function(e){return!a.filterItem(e,l)},sortChildItems:function(e){return f.sortItems(e,c,h)}})))];case 2:v=m.sent().itemResolver;r(v.execute());return[2]}})})}})});
define("@ms/items-view-addon-graph/lib/utilities/getAndProcessDriveItemSetData",["require","exports","tslib","./Data","./processDriveItemSet"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getAndProcessDriveItemSetData=function(e){var t=this,s=e.itemKey,o=e.itemSetKeyFacet,u=e.getUrl,a=e.sortChildItems,f=e.qosName,l=e.preprocessResponse,c=e.expectedErrors,h=o.deserialize(s),p=h.driveItemKey.endpoint;return function(s){return n.__awaiter(t,void 0,void 0,function(){var t,o,d;return n.__generator(this,function(v){switch(v.label){case 0:return[4,s(r.getRawDataWithCache({url:u(h),qosName:"getChildren"+(f?"."+f:""),endpoint:p,headers:e.additionalHeaders,expectedErrors:c}))];case 1:t=v.sent();o=l?l(t.value):t.value;d=a?a(o):o;return[4,s(i.processDriveItemSet(n.__assign({},e,{childItemsResponse:n.__assign({},t,{value:d})})))];case 2:return[2,{itemResolver:v.sent().itemResolver}]}})})}}});
define("@ms/items-view-addon-graph/lib/utilities/processDriveItemSet",["require","exports","tslib","./processDriveItemSetChildren","@ms/items-view/lib/private/operations/invalidateItems","@ms/items-view/lib/private/facets/SetFacets","./processLocalOrRemoteDriveItem"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.processDriveItemSet=function(e){var t=e.itemKey,u=e.itemSetKeyFacet,a=e.parentItemKeyFacet,f=e.childItemsResponse,l=e.parentItemResponse,c=e.mapItemSetKey,h=u.deserialize(t),p=a.serialize(h.driveItemKey),d=h.driveItemKey.endpoint;return function(u){var a,h=u(r.processDriveItemSetChildren(n.__assign({},e,{response:f,parentItemKey:p}))).itemResolver;if(c){var v=c().itemResolver;h.merge(v)}if(l){var m=o.processLocalOrRemoteDriveItem({setItemKey:t,driveItemResponse:l,endpoint:d}).itemResolver;h.merge(m)}h.resolveItems({items:(a={},a[p]=n.__assign({},i.getInvalidationFacet().forFacet(s.defaultChildItemSetFacet).thenInvalidate(e.itemKey,s.childItemsFacet).pack()),a)});return{itemResolver:h}}}});
define("@ms/items-view-addon-graph/lib/utilities/processDriveItemSetChildren",["require","exports","tslib","@ms/items-view/lib/private/operations/invalidateItems","@ms/items-view/lib/private/facets/SetFacets","../models/keys/DriveItemPageKeyFacet","@ms/items-view/lib/private/models/items/ItemResolver","@ms/items-view/lib/private/models/items/PageHelpers","@ms/items-view/lib/private/operations/offlineCache","@ms/items-view/lib/private/operations/configuration/readConfiguration","../models/facets/ConfigurationFacets","@ms/items-view/lib/private/operations/logQoS","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/items-view-utilities/lib/uri/SimpleUri","./processLocalOrRemoteDriveItem","@ms/items-view/lib/private/operations/readItems"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.processDriveItemSetChildren=function(e){return function(t){var m,g,y,b=e.itemKey,w=e.parentItemKey,E=e.itemSetKeyFacet,S=e.filterChildItems,x=e.onProcessResponse,T=e.groupChildItems,N=e.response,C=e.skip,k=void 0===C?0:C,L=e.enableRandomAccess,A=void 0!==L&&L,O=e.totalChildCount,M=e.getDriveItemFacets,_=E.deserialize(b),D=_.driveItemKey.endpoint,P=new o.ItemResolver,H=t(c.logQoS({name:"remoteItemsMissingParentRef"})),B=N["@odata.nextLink"],j=!!B,F=t(v.readItems(function(e){return{childItemsFacetResolved:e.isItemFacetResolved(i.childItemsFacet,b),prevChildKeys:e.demandItemFacet(i.childItemsFacet,b)}})),I=F.childItemsFacetResolved,q=F.prevChildKeys,R=q&&q.itemKeys;A&&(I&&R?y=R.slice(0):"number"==typeof O&&(y=new Array(O+(j&&O<=N.value.length?1:0))));y||(y=new Array(N.value.length+(j?1:0)));for(var U=k,z=0,W=0,X=N.value;W<X.length;W++){var V=X[W],$=S&&S(V),J=V.remoteItem,K=!(V.remoteItem&&V.remoteItem.parentReference&&V.remoteItem.parentReference.driveId),Q=J&&K;Q&&z++;if(!$&&!Q){var G=V.webDavUrl||V.remoteItem&&V.remoteItem.webDavUrl||V.webUrl,Y=D.indexOf("/_api/v2.0")>-1||D.indexOf("/_api/v2.1")>-1,Z=D.indexOf("beta")>-1;if(G&&(Y||Z)){var ee=G&&decodeURIComponent(G);D=Z?new p.SimpleUri(ee).authority+"/_api/v2.0":""+new p.SimpleUri(ee).authority+new p.SimpleUri(D).path}var te=d.processLocalOrRemoteDriveItem({setItemKey:b,driveItemResponse:V,endpoint:D,getDriveItemFacets:M}),ne=te.itemResolver,re=te.actualItemKey,ie=te.actualDriveItemKey;y[U]=re;P.merge(ne);if(x){var se=x({itemKey:b,driveItemKey:ie,item:V});se&&P.merge(se.itemResolver)}var oe=t(f.readConfiguration({processDriveItemFromSharePoint:l.processDriveItemFromSharePointFacet})).processDriveItemFromSharePoint;if(oe&&(Y||Z)){var ue=t(oe.process({itemKey:re,driveItem:V})).itemResolver;P.merge(ue)}U++}}t(H(n.__assign({resultType:z<1?h.ResultTypeEnum.Success:h.ResultTypeEnum.Failure},z>0?{extraData:{count:z}}:{})));if(j){var ae=s.driveItemPageKeyFacet.serialize({setItemKey:b,endpoint:D,token:B});P.merge(u.resolveNewPage({itemKey:ae}).itemResolver);y[U]=ae}if(T){var fe=T(_);fe&&P.merge(fe.itemResolver)}else P.resolveItems({items:(m={},m[b]=n.__assign({},i.childItemsFacet.pack({itemKeys:y})),m)});P.resolveItems({items:(g={},g[b]=n.__assign({},i.parentItemFacet.pack({itemKey:w}),r.getInvalidationFacet().forFacet(i.childItemsFacet).thenInvalidate(a.clearCacheIfNotOffline).pack()),g)});return{itemResolver:P}}}});
define("@ms/items-view-utilities/lib/uri/SimpleUri",["require","exports","@ms/sp-resource-path"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SimpleUri=n.SPResourcePath;t.UriFormat=n.SPResourcePathFormat;t.default=n.SPResourcePath});
define("@ms/items-view-addon-graph/lib/utilities/sharedFilterHelper",["require","exports","@ms/odsp-graph/lib/models/item/IItemTypeFilter","@ms/odsp-utilities/lib/path/Path","@ms/odsp-utilities/lib/icons/IconSelector","@ms/odsp-graph/lib/utilities/media/MediaUtils"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=new Map([["code",n.ItemTypeFilter.text],["csv",n.ItemTypeFilter.excel],["docx",n.ItemTypeFilter.word],["dotx",n.ItemTypeFilter.word],["one",n.ItemTypeFilter.onenote],["onepkg",n.ItemTypeFilter.onenote],["onetoc",n.ItemTypeFilter.onenote],["pdf",n.ItemTypeFilter.pdf],["photo",n.ItemTypeFilter.media],["potx",n.ItemTypeFilter.powerpoint],["ppsx",n.ItemTypeFilter.powerpoint],["pptx",n.ItemTypeFilter.powerpoint],["rtf",n.ItemTypeFilter.text],["txt",n.ItemTypeFilter.text],["video",n.ItemTypeFilter.media],["xlsx",n.ItemTypeFilter.excel],["xltx",n.ItemTypeFilter.excel],["zip",n.ItemTypeFilter.zip]]);function u(e,t){var n,s,u=(n=e,s=r.getFileExtension(n,!0),i.getIconNameFromExtension(s)),a=o.get(u);return!!a&&t.filters.indexOf(a)>=0}function a(e,t){var n=new Date(e.valueOf());n.setDate(n.getDate()-t);return n}t.filterItem=function(e,t){void 0===t&&(t=[]);return t.every(function(t){return(!("sharedByName"===t.type)||function(e,t){var n=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName;return!!n&&t.indexOf(n)>-1}(e,t.values))&&(!("fileName"===t.type)||function(e,t){return!!e.name&&u(e.name,t)}(e,s.getIItemTypeFilter(t.values)))&&(!("dateShared"===t.type)||function(e,t){var n=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedDateTime||"today";return(n&&new Date(n))>=t}(e,function(e){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case"today":return n;case"yesterday":return a(n,1);case"last7Days":return a(n,7);case"last30Days":return a(n,30);case"last90Days":return a(n,90);default:return new Date(0)}}(t.values[0])))})}});
define("@ms/odsp-graph/lib/models/item/IItemTypeFilter",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.any=0]="any";e[e.file=1]="file";e[e.folder=2]="folder";e[e.media=3]="media";e[e.photo=4]="photo";e[e.video=5]="video";e[e.document=6]="document";e[e.audio=7]="audio";e[e.word=8]="word";e[e.powerpoint=9]="powerpoint";e[e.excel=10]="excel";e[e.onenote=11]="onenote";e[e.zip=12]="zip";e[e.pdf=13]="pdf";e[e.text=14]="text"}(t.ItemTypeFilter||(t.ItemTypeFilter={}))});
define("@ms/odsp-graph/lib/utilities/media/MediaUtils",["require","exports","../../models/item/IItemTypeFilter"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e,t){return t&&t[e].extensions||[]}t.doExtFiltersHaveMediaTypesOnly=function(e){var t=e.extFilters,i=e.allowedMediaTypes,s=e.fileTypeIconMap,o=[],u=[];if(!t||!t.filters||0===t.filters.length||0===i.length)return!1;for(var a=0,f=t.filters;a<f.length;a++){var l=f[a];if("string"!=typeof l){var c=l;switch(c){case n.ItemTypeFilter.folder:u.push("folder");o.push("folder");break;case n.ItemTypeFilter.photo:if(i.indexOf(c)>-1){u.push("photo");o.push("photo");u=u.concat(r("photo",s))}break;case n.ItemTypeFilter.video:if(i.indexOf(c)>-1){u.push("video");o.push("video");u=u.concat(r("video",s))}break;default:return!1}}else{"."===l[0]&&o.push(l.slice(1).toLowerCase())}}u=u.concat(r("vector",s));return 0===(o=o.filter(Boolean)).filter(function(e){return-1===u.indexOf(e)}).length};t.getIItemTypeFilter=function(e){for(var t=[],r=0,i=e;r<i.length;r++){var s=i[r];if("."===s[0])t.push(s);else{var o=n.ItemTypeFilter[s];t.push(o)}}return{filters:t}}});
define("@ms/items-view-addon-graph/lib/utilities/sharedSortHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function n(e,t){return e.slice().sort(t)}t.sortItems=function(e,t,r){return"DateShared"===t?r?function(e){return n(e,function(e,t){var n=e&&e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedDateTime,r=t&&t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedDateTime;return n&&r&&new Date(n).getTime()-new Date(r).getTime()||0})}(e):function(e){return n(e,function(e,t){var n=e&&e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedDateTime,r=t&&t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedDateTime;return n&&r&&new Date(r).getTime()-new Date(n).getTime()||0})}(e):"SharedBy"===t?r?function(e){return n(e,function(e,t){var n=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName,r=t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedBy&&t.remoteItem.shared.sharedBy.user&&t.remoteItem.shared.sharedBy.user.displayName;return n&&r&&n.localeCompare(r)||0})}(e):function(e){return n(e,function(e,t){var n=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName,r=t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedBy&&t.remoteItem.shared.sharedBy.user&&t.remoteItem.shared.sharedBy.user.displayName;return n&&r&&r.localeCompare(n)||0})}(e):"LinkFilename"===t?r?function(e){return n(e,function(e,t){var n=e.name,r=t.name;return n&&r&&n.localeCompare(r)||0})}(e):function(e){return n(e,function(e,t){var n=e.name,r=t.name;return n&&r&&r.localeCompare(n)||0})}(e):"FileActivity"===t?r?function(e){return n(e,function(e,t){var n=e.lastModifiedDateTime,r=t.lastModifiedDateTime;return n&&r&&new Date(n).getTime()-new Date(r).getTime()||0})}(e):function(e){return n(e,function(e,t){var n=e.lastModifiedDateTime,r=t.lastModifiedDateTime;return n&&r&&new Date(r).getTime()-new Date(n).getTime()||0})}(e):e}});
define("@ms/items-view-addon-graph/lib/handlers/operations/sharedByMeRootItem/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","../../../models/keys/SharedByMeRootItemKeyFacet","@ms/items-view/lib/private/facets/SetFacets","../../../models/keys/SharedByMeItemSetKeyFacet","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/models/items/ItemResolver","../../../models/items/GraphItems.resx"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMeRootItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,l=i.sharedByMeRootItemKeyFacet.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i;return n.__generator(this,function(c){(i=new a.ItemResolver).resolveItems({items:(t={},t[r]=n.__assign({},s.defaultChildItemSetFacet.pack({itemKey:o.sharedByMeItemSetKeyFacet.serialize({driveItemKey:l})}),u.displayNameFacet.pack(f.default.sharedByMe),u.folderFacet.pack({}),u.parentFolderItemFacet.pack(void 0)),t)});e(i.execute());return[2]})})}})});
define("@ms/items-view-addon-graph/lib/models/keys/SharedByMeRootItemKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMeRootItemKeyFacet=new n.KeyFacet("sharedByMeRootItem",{endpoint:n.stringPart()})});
define("@ms/items-view-addon-graph/lib/models/keys/SharedByMeItemSetKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet","./DriveItemKeyFacet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMeItemSetKeyFacet=new n.KeyFacet("sharedByMeItemSet",{driveItemKey:n.subKeyPart(r.driveItemKeyFacet)})});
define("@ms/items-view-addon-graph/lib/handlers/operations/sharedByMeItemSet/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","../../../models/keys/SharedByMeItemSetKeyFacet","../../../utilities/getAndProcessDriveItemSetData","../../../models/keys/SharedByMeRootItemKeyFacet"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedByMeItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(u){switch(u.label){case 0:return[4,r(s.getAndProcessDriveItemSetData(n.__assign({},e,{qosName:"sharedByMe",itemSetKeyFacet:i.sharedByMeItemSetKeyFacet,parentItemKeyFacet:o.sharedByMeRootItemKeyFacet,getUrl:function(e){return e.driveItemKey.endpoint+"/drive/shared"}})))];case 1:t=u.sent().itemResolver;r(t.execute());return[2]}})})}})});
define("@ms/items-view-addon-graph/lib/handlers/operations/recentRootItem/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/facets/SetFacets","../../../models/keys/RecentItemSetKeyFacet","../../../models/keys/RecentRootItemKeyFacet","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/models/items/ItemResolver","../../../models/items/GraphItems.resx","../../../models/facets/ConfigurationFacets","@ms/items-view/lib/private/operations/configuration/readConfiguration"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,h=o.recentRootItemKeyFacet.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,o,p;return n.__generator(this,function(d){o=e(c.readConfiguration({groupBy:l.recentItemsGroupByFacet})).groupBy;(p=new a.ItemResolver).resolveItems({items:(t={},t[r]=n.__assign({},i.defaultChildItemSetFacet.pack({itemKey:s.recentItemSetKeyFacet.serialize({driveItemKey:h,sortBy:"",isAscending:!0,groupBy:o||""})}),u.displayNameFacet.pack(f.default.recent),u.folderFacet.pack({}),u.parentFolderItemFacet.pack(void 0)),t)});e(p.execute());return[2]})})}})});
define("@ms/items-view-addon-graph/lib/models/keys/RecentItemSetKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet","./RecentRootItemKeyFacet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentItemSetKeyFacet=new n.KeyFacet("recentItemSet",{driveItemKey:n.subKeyPart(r.recentRootItemKeyFacet),sortBy:n.stringPart(),isAscending:n.booleanPart(),filters:n.arrayPart(n.stringPart()),groupBy:n.stringPart()})});
define("@ms/items-view-addon-graph/lib/models/keys/RecentRootItemKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemKeyFacet=new n.KeyFacet("recentRootItem",{endpoint:n.stringPart()})});
define("@ms/items-view-addon-graph/lib/handlers/operations/savedForLaterRootItem/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/facets/SetFacets","../../../models/keys/SavedForLaterItemSetKeyFacet","../../../models/keys/SavedForLaterRootItemKeyFacet","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/models/items/ItemResolver","../../../models/items/GraphItems.resx"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.savedForLaterRootItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,l=o.savedForLaterRootItemKeyFacet.deserialize(r);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,o;return n.__generator(this,function(c){(o=new a.ItemResolver).resolveItems({items:(t={},t[r]=n.__assign({},i.defaultChildItemSetFacet.pack({itemKey:s.savedForLaterItemSetKeyFacet.serialize({driveItemKey:l,sortBy:"",isAscending:!0})}),u.displayNameFacet.pack(f.default.saved),u.folderFacet.pack({}),u.parentFolderItemFacet.pack(void 0)),t)});e(o.execute());return[2]})})}})});
define("@ms/items-view-addon-graph/lib/handlers/operations/recentItemSet/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","../../../models/keys/RecentItemSetKeyFacet","../../../utilities/getAndProcessDriveItemSetData","../../../models/keys/RecentRootItemKeyFacet","@ms/items-view/lib/private/facets/GroupFacets","@ms/odsp-graph/lib/utilities/media/MediaUtils","@ms/odsp-graph/lib/models/item/IItemTypeFilter","@uifabric/file-type-icons/lib/FileTypeIconMap","@ms/items-view/lib/private/models/items/ItemResolver","../../../models/keys/RecentGroupKeyFacet","../../../utilities/recentDateGroupHelper","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/facets/SetFacets","../../../models/keys/DriveItemKeyFacet","../../../utilities/Data"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filterMediaContent=function(e,t){var n=new RegExp("^"+t+"\\/","i");return e.filter(function(e){return!(!e||!e.file)&&n.test(e.file.mimeType)})};t.recentItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var r=this,y=i.recentItemSetKeyFacet.deserialize(e.itemKey),b=y.filters,w=void 0===b?[]:b,E=y.driveItemKey.endpoint,S=y.groupBy,x=a.doExtFiltersHaveMediaTypesOnly({extFilters:a.getIItemTypeFilter(w),allowedMediaTypes:[f.ItemTypeFilter.photo,f.ItemTypeFilter.video],fileTypeIconMap:l.FileTypeIconMap}),T=a.doExtFiltersHaveMediaTypesOnly({extFilters:a.getIItemTypeFilter(w),allowedMediaTypes:[f.ItemTypeFilter.photo],fileTypeIconMap:l.FileTypeIconMap}),N=a.doExtFiltersHaveMediaTypesOnly({extFilters:a.getIItemTypeFilter(w),allowedMediaTypes:[f.ItemTypeFilter.video],fileTypeIconMap:l.FileTypeIconMap});return function(a){return n.__awaiter(r,void 0,void 0,function(){var r,f,l,y,b,w,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z;return n.__generator(this,function(W){switch(W.label){case 0:f=h.recentGroupKeyFacet.serialize({relativeTime:"today"});l=h.recentGroupKeyFacet.serialize({relativeTime:"yesterday"});y=h.recentGroupKeyFacet.serialize({relativeTime:"thisWeek"});b=h.recentGroupKeyFacet.serialize({relativeTime:"lastWeek"});w=h.recentGroupKeyFacet.serialize({relativeTime:"twoWeeksAgo"});C=h.recentGroupKeyFacet.serialize({relativeTime:"threeWeeksAgo"});k=h.recentGroupKeyFacet.serialize({relativeTime:"lastMonth"});L=h.recentGroupKeyFacet.serialize({relativeTime:"twoMonthsAgo"});A=[];O=[];M=[];_=[];D=[];P=[];H=[];B=[];j="";I=(F="date"===S)?function(e){var t=e.driveItemKey,n=e.item;if(n&&t){var r=n.remoteItem,i=r&&r.fileSystemInfo,s=i&&i.lastAccessedDateTime,o=m.driveItemKeyFacet.serialize(t);if(s){var u=new Date(s);switch(p.getRelativeDateBucketByDate(u)){case p.RelativeDateGroups.today:A.push(o);break;case p.RelativeDateGroups.yesterday:O.push(o);break;case p.RelativeDateGroups.thisWeek:M.push(o);break;case p.RelativeDateGroups.lastWeek:_.push(o);break;case p.RelativeDateGroups.twoWeeksAgo:D.push(o);break;case p.RelativeDateGroups.threeWeeksAgo:P.push(o);break;case p.RelativeDateGroups.lastMonth:H.push(o);break;case p.RelativeDateGroups.twoMonthsAgo:B.push(o);j=p.getMonthString[u.getMonth()]}}}}:void 0;q=F?function(t){var r,i,s=new c.ItemResolver;s.resolveItems({items:(r={},r[f]=n.__assign({},d.displayNameFacet.pack("Today"),u.isGroupFacet.pack(!0),v.childItemsFacet.pack({itemKeys:A})),r[l]=n.__assign({},d.displayNameFacet.pack("Yesterday"),u.isGroupFacet.pack(!0),v.childItemsFacet.pack({itemKeys:O})),r[y]=n.__assign({},d.displayNameFacet.pack("This Week"),u.isGroupFacet.pack(!0),v.childItemsFacet.pack({itemKeys:M})),r[b]=n.__assign({},d.displayNameFacet.pack("Last Week"),u.isGroupFacet.pack(!0),v.childItemsFacet.pack({itemKeys:_})),r[w]=n.__assign({},d.displayNameFacet.pack("Two Weeks Ago"),u.isGroupFacet.pack(!0),v.childItemsFacet.pack({itemKeys:D})),r[C]=n.__assign({},d.displayNameFacet.pack("Three Weeks Ago"),u.isGroupFacet.pack(!0),v.childItemsFacet.pack({itemKeys:P})),r[k]=n.__assign({},d.displayNameFacet.pack("Last Month"),u.isGroupFacet.pack(!0),v.childItemsFacet.pack({itemKeys:H})),r[L]=n.__assign({},d.displayNameFacet.pack(j),u.isGroupFacet.pack(!0),v.childItemsFacet.pack({itemKeys:B})),r)});var o=[];A.length>0&&o.push(f);l.length>0&&o.push(l);M.length>0&&o.push(y);_.length>0&&o.push(b);D.length>0&&o.push(w);P.length>0&&o.push(C);H.length>0&&o.push(k);B.length>0&&o.push(L);s.resolveItems({items:(i={},i[e.itemKey]=n.__assign({},v.childItemsFacet.pack({itemKeys:o})),i)});return{itemResolver:s}}:void 0;return[4,a(g.isConsumerDirectEndpoint(E))];case 1:R=W.sent();U=[{code:"notAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"notAllowed",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"notAllowed",message:"Operation not allowed"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];return[4,a(s.getAndProcessDriveItemSetData(n.__assign({},e,{qosName:"recent",itemSetKeyFacet:i.recentItemSetKeyFacet,parentItemKeyFacet:o.recentRootItemKeyFacet,getUrl:function(e){return R?E+"/drive/view.recent":E+"/me/drive/recent"},expectedErrors:U,preprocessResponse:function(e){var n=e.slice(0);T?n=t.filterMediaContent(n,"image"):N&&(n=t.filterMediaContent(n,"video"));return function(e){if(!e)return e;return e.filter(function(e,t,n){return n.map(function(e){return e.id}).indexOf(e.id)===t})}(n.sort(function(e,t){var n=e.remoteItem&&e.remoteItem.fileSystemInfo&&e.remoteItem.fileSystemInfo.lastAccessedDateTime,r=t.remoteItem&&t.remoteItem.fileSystemInfo&&t.remoteItem.fileSystemInfo.lastAccessedDateTime;return n||r?n?r?n>r?-1:1:-1:1:0}))},additionalHeaders:{Prefer:"ApiVersion=2.1"},onProcessResponse:I,groupChildItems:q})))];case 2:z=W.sent().itemResolver;x&&z.resolveItems({items:(r={},r[e.itemKey]=n.__assign({},u.mediaGroupFacet.pack({})),r)});a(z.execute());return[2]}})})}})});
define("@ms/items-view-addon-graph/lib/models/keys/RecentGroupKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentGroupKeyFacet=new n.KeyFacet("recentGroup",{relativeTime:n.stringPart()})});
define("@ms/items-view-addon-graph/lib/utilities/recentDateGroupHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r=864e5,i=7;!function(e){e.today="Today";e.yesterday="Yesterday";e.thisWeek="This week";e.lastWeek="Last week";e.twoWeeksAgo="Two weeks ago";e.threeWeeksAgo="Three weeks ago";e.thisMonth="This month";e.lastMonth="Last month";e.twoMonthsAgo="Two months ago";e.older="Older"}(n=t.RelativeDateGroups||(t.RelativeDateGroups={}));t.getRelativeDateBucketByDate=function(e){var t=new Date;return function(e,t){return s(t,e)}(e,t)?n.today:function(e,t){return s(new Date(t.getTime()-r),e)}(e,t)?n.yesterday:function(e,t){var n=t.setHours(0,0,0,0)-t.getDay()*r;return e.getTime()>n}(e,t)?n.thisWeek:function(e,t){var n=t.setHours(0,0,0,0)-(t.getDay()+i)*r;return e.getTime()>n}(e,t)?n.lastWeek:function(e,t){var n=t.setHours(0,0,0,0)-2*i*r;return e.getTime()>n}(e,t)?n.twoWeeksAgo:function(e,t){var n=t.setHours(0,0,0,0)-3*i*r;return e.getTime()>n}(e,t)?n.threeWeeksAgo:function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()}(e,t)?n.thisMonth:function(e,t){var n=t.getMonth(),r=e.getMonth();return n-r==11||t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1}(e,t)?n.lastMonth:function(e,t){var n=t.getFullYear(),r=e.getFullYear(),i=t.getMonth(),s=e.getMonth(),o=n-r==1&&i-s==-10;return n===r&&i-s==2||o}(e,t)?n.twoMonthsAgo:""};function s(e,t){return e.toDateString()===t.toDateString()}t.getMonthString=["January","February","March","April","May","June","July","August","September","October","November","December"]});
define("@ms/items-view-addon-graph/lib/handlers/operations/savedForLaterItemSet/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","../../../utilities/getAndProcessDriveItemSetData","../../../models/keys/SavedForLaterItemSetKeyFacet","../../../models/keys/SavedForLaterRootItemKeyFacet","../../../models/keys/DriveItemKeyFacet","../../../models/keys/DriveFollowedItemKeyFacet","@ms/items-view/lib/private/models/items/ItemResolver","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/facets/SetFacets","@ms/items-view/lib/private/operations/invalidateItems","../../../utilities/getDriveItemFacets","@ms/items-view/lib/private/operations/configuration/readConfiguration","@ms/items-view-utilities/lib/uri/SimpleUri","../../../models/items/GraphItems.resx","../../../models/facets/ConfigurationFacets","../../../models/facets/ConfigurationFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.savedForLaterItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,b,w,E,S,x,T,N,C,k,L,A,O;return n.__generator(this,function(M){switch(M.label){case 0:t=r(d.readConfiguration({useGraphEndpointForSavedForLater:y.useGraphEndpointForSavedForLaterFacet,graphEndpoint:g.graphEndpointConfigurationFacet})),b=t.useGraphEndpointForSavedForLater,w=t.graphEndpoint;E=e.itemKey;S=s.savedForLaterItemSetKeyFacet.deserialize(E);x=S.driveItemKey.endpoint;T=r(d.readConfiguration({getUserOneDriveEndpoint:g.getUserOneDriveEndpointFacet})).getUserOneDriveEndpoint;N=new v.SimpleUri(x).authority;if(C=w)return[3,3];if(!(k=T))return[3,2];L=v.SimpleUri.bind;return[4,r(T.getUserOneDriveEndpoint(N))];case 1:k=(new(L.apply(v.SimpleUri,[void 0,M.sent()]))).authority+"/_api/v2.0";M.label=2;case 2:C=k;M.label=3;case 3:x=C||"";A=s.savedForLaterItemSetKeyFacet.serialize({driveItemKey:{endpoint:x},sortBy:"",isAscending:!0});return[4,r(i.getAndProcessDriveItemSetData(n.__assign({},e,{itemKey:A,qosName:"savedForLater",itemSetKeyFacet:s.savedForLaterItemSetKeyFacet,parentItemKeyFacet:o.savedForLaterRootItemKeyFacet,getUrl:function(e){if(b){return x+"/drive/following?top=5000&select="+["followed","name","parentReference","webDavUrl","webUrl","id","size"].join(",")}return x+"/drives/me/followed?top=5000&select=*,webDavUrl"},onProcessResponse:function(e){var t,r,i=e.itemKey,s=e.driveItemKey,o=e.item,p=new f.ItemResolver;if(s&&o){var d=u.driveItemKeyFacet.serialize(s),v=a.driveFollowedItemKeyFacet.serialize({driveItemKey:s}),m=o&&!o.webDavUrl,g=o&&(o.webDavUrl||o.webUrl);p.resolveItems({items:(t={},t[d]=n.__assign({},l.followedItemFacet.pack({itemKey:v}),l.folderFacet.pack(m),l.canonicalUrlFacet.pack(g)),t[v]=n.__assign({},l.isFollowedFacet.pack(!0),h.getInvalidationFacet().forFacet(l.isFollowedFacet).thenInvalidate(i,c.childItemsFacet).pack()),t)});p.invalidateItems({items:(r={},r[i]=[c.childItemsFacet],r)})}return{itemResolver:p}},filterChildItems:function(e){var t,n,r=e.name&&(t=e.name,n=".aspx",t.substr(t.length-n.length)===n),i=e.package||e.remoteItem&&e.remoteItem.package,s=i&&"oneNote"===i.type;return r||s||!1},getDriveItemFacets:function(e){var t=e.driveItem,r=t.root,i=t.remoteItem,s=t.name,o=r?m.default.files:s||i&&i.name||"",u=!t.webDavUrl,a=t.followed&&t.followed.followedDateTime;return n.__assign({},p.getDriveItemFacets(n.__assign({},e,{shouldReturnShareFacets:!1})),l.fileNameFacet.pack(p.getFileName(o,u)),a?l.dateFollowedFacet.pack(new Date(a).getTime()):{})},mapItemSetKey:function(){var t,n=new f.ItemResolver;n.mapKeys({mappings:(t={},t[e.itemKey]=A,t)});return{itemResolver:n}}})))];case 4:O=M.sent().itemResolver;r(O.execute());return[2]}})})}})});
define("@ms/items-view-addon-graph/lib/models/keys/DriveFollowedItemKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet","./DriveItemKeyFacet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveFollowedItemKeyFacet=new n.KeyFacet("driveFollowItem",{driveItemKey:n.subKeyPart(r.driveItemKeyFacet)})});
define("@ms/items-view-addon-graph/lib/handlers/operations/driveFollowItem/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/operations/demandItems","@ms/items-view/lib/private/operations/readItems","@ms/items-view/lib/private/models/items/ItemResolver","../../../models/keys/SavedForLaterItemSetKeyFacet","../../../models/keys/DriveFollowedItemKeyFacet","@ms/items-view/lib/private/facets/SetFacets","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/facets/ConfigurationFacets","@ms/items-view/lib/private/operations/invalidateItems","../../../models/keys/DriveItemKeyFacet"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveFollowItemGetItemsOperationHandler=r.createBatchedItemsOperationHandler()(d);function d(e){var t=this,r=e.items;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A;return n.__generator(this,function(O){switch(O.label){case 0:return[4,e(s.readItems(function(e){return e.demandItemFacet(c.enableFollowItemConfigurationFacet,c.configurationItemKey)}))];case 1:if(!O.sent())return[2];d=Object.keys(r);v=d[0];m=a.driveFollowedItemKeyFacet.deserialize(v);if(!(g=m.driveItemKey.endpoint))throw new Error("No endpoint to determine followed items.");y=u.savedForLaterItemSetKeyFacet.serialize({driveItemKey:{endpoint:g},sortBy:"",isAscending:!0});return[4,e(i.demandItems(function(e){return e.demandItemFacet(f.childItemsFacet,y)}))];case 2:b=O.sent();w=b&&b.itemKeys||[];E=new o.ItemResolver;S={};for(x=0,T=w;x<T.length;x++){L=T[x];S[L]=!0}for(N=0,C=d;N<C.length;N++){k=C[N];L=a.driveFollowedItemKeyFacet.deserialize(k).driveItemKey;A=!!S[p.driveItemKeyFacet.serialize(L)];E.resolveItems({items:(t={},t[k]=n.__assign({},l.isFollowedFacet.pack(A),h.getInvalidationFacet().forFacet(l.isFollowedFacet).thenInvalidate(y,f.childItemsFacet).pack()),t)})}e(E.execute());return[2]}})})}}t.getFollowedItems=d});
define("@ms/items-view/lib/private/operations/demandItems",["require","exports","tslib","./observeItems","../utilities/async/wait"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=6e4;t.demandItems=function(e,t){var o=this;void 0===t&&(t={});var u=t.cancelToken,a=t.timeout,f=void 0===a?s:a;return function(t){return n.__awaiter(o,void 0,void 0,function(){var s,o,a,l,c,h,p,d;return n.__generator(this,function(v){switch(v.label){case 0:l=i.createTimeoutCancelSource(f,u);v.label=1;case 1:v.trys.push([1,,14,15]);v.label=2;case 2:v.trys.push([2,7,8,13]);c=n.__asyncValues(t(r.observeItemsUntilResolved(e,{cancelToken:l.token})));v.label=3;case 3:return[4,c.next()];case 4:if(!(h=v.sent(),!h.done))return[3,6];p=h.value;a={result:p};v.label=5;case 5:return[3,3];case 6:return[3,13];case 7:d=v.sent();s={error:d};return[3,13];case 8:v.trys.push([8,,11,12]);return h&&!h.done&&(o=c.return)?[4,o.call(c)]:[3,10];case 9:v.sent();v.label=10;case 10:return[3,12];case 11:if(s)throw s.error;return[7];case 12:return[7];case 13:return[3,15];case 14:l.dispose();return[7];case 15:if(!a)throw new Error("No result.");return[2,a.result]}})})}}});
define("@ms/items-view/lib/private/operations/observeItems",["require","exports","tslib","./getItems","./pruneItems","../utilities/symbol","../models/itemCache/ItemCacheEvaluator","./readItems","../models/itemCache/excludeResolvedDemands","../models/controls/ControlFacet","../utilities/async/CancelError"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});s.polyfill();t.observeItemsUntilResolved=function(e,t){void 0===t&&(t={});var s=t.cancelToken;return function(t,c){return n.__asyncGenerator(this,arguments,function(){var h,p,d,v;return n.__generator(this,function(m){switch(m.label){case 0:h=t(o.getItemCacheEvaluator);p={};m.label=1;case 1:m.trys.push([1,,6,7]);d=function(){var o,d,v,m,g,y;return n.__generator(this,function(b){switch(b.label){case 0:o=h.evaluate({selector:e,controlHandlers:f.NO_CONTROL_HANDLERS,owner:p,state:c()}),d=o.result,v=o.demands,m=o.dependencies;return[4,n.__await(d)];case 1:return[4,b.sent()];case 2:b.sent();g={items:v};t(i.recordLastItemAccesses({items:m}));if(t(u.readItems(function(e){return a.hasUnresolvedDemands(e,g)})))return[3,4];y={};return[4,n.__await(void 0)];case 3:return[2,(y.value=b.sent(),y)];case 4:t(i.registerItemDemands({owner:p,items:m}));s&&s.throwIfCanceled();return[4,n.__await(l.raceWithCancel(t(r.getItems(g)),s))];case 5:b.sent();return[2]}})};m.label=2;case 2:return[5,d()];case 3:if("object"==typeof(v=m.sent()))return[2,v.value];m.label=4;case 4:return[3,2];case 5:return[3,7];case 6:t(i.removeItemDemands({owner:p}));return[7];case 7:return[2]}})})}}});
define("@ms/items-view/lib/private/utilities/symbol",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.polyfill=function(){var e;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}e.Symbol||(e.Symbol=function(e){return"[["+e+"_"+Math.random().toFixed(8).slice(2)+"]]"});e.Symbol.asyncIterator||(e.Symbol.asyncIterator=e.Symbol.for&&e.Symbol.for("Symbol.asyncIterator")||"__@asyncIterator__")}});
define("@ms/items-view-addon-graph/lib/handlers/operations/driveActivityItem/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/models/items/ItemResolver","../../../models/keys/DriveActivityItemKeyFacet","../../../utilities/Data","@ms/odsp-graph/lib/services/itemActivities/ItemActivitiesResultProcessor","../../../models/facets/ItemActivityFacet","@ms/items-view/lib/private/operations/logEngagement","@ms/items-view/lib/private/operations/invalidateItems","@ms/items-view/lib/private/facets/SetFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveActivityItemGetItemsOperationHandler=r.createBatchedItemsOperationHandler({areSameBatch:function(e,t){var n=s.driveActivityItemKeyFacet.deserialize(e.itemKey).driveItemKey.driveId,r=s.driveActivityItemKeyFacet.deserialize(t.itemKey).driveItemKey.driveId;return!!n&&!!r&&n===r}})(d);function h(e){var t=e[0];return!!t&&1===t.actors.length&&t.actors[0].self&&!t.type||!1}function p(e){var t=e[0],r={};if(t)for(var i=0,s=t.actors;i<s.length;i++){(l=s[i]).id&&(r[l.id]=!0)}for(var o=n.__assign({},t,{actors:(t.actors||[]).slice()}),u=1;u<e.length;u++)for(var a=0,f=e[u].actors;a<f.length;a++){var l;if("string"==typeof(l=f[a]).id&&!r[l.id]){o.actors.push(l);r[l.id]=!0}}return o||t}function d(e){var t=this,r=e.items;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q;return n.__generator(this,function(R){switch(R.label){case 0:d=Object.keys(r);v=d[0];m=s.driveActivityItemKeyFacet.deserialize(v);g=m.driveItemKey,y=g.endpoint,b=g.driveId;if(!y)throw new Error("No endpoint to determine activity items.");w=d.map(function(e){return s.driveActivityItemKeyFacet.deserialize(e).driveItemKey.itemId});E=o.getDriveUrl({endpoint:(U=y,U.replace("2.1","2.0")),driveId:b});S=E+"/ExtendedActivitiesForItems";x={driveItems:w,badgeOnly:!0};return[4,e(o.getRawData({url:S,method:"POST",body:x,qosName:"ItemActivityFieldDataSource.extendedActivitiesForItems",endpoint:y}))];case 1:if((T=R.sent()).value){N=function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n],s=i.driveItemId;if(s){(t[s]||(t[s]=[])).push(i)}}return t}(T.value);C=0;k=0;L=0;A=0;O=new i.ItemResolver;for(M=0,_=d;M<_.length;M++){D=_[M];P=s.driveActivityItemKeyFacet.deserialize(D);C++;H=P.driveItemKey.itemId;if(B=H&&N[H]){j=new u.default;F=j.processResponse({item:{name:H||"",relativePath:"",absolutePath:"",isFolder:!1,graphItemUrl:S},response:{value:B,"@odata.nextLink":""}}).activities;I=h(F);if(q=p(F)){L++;k++;I||A++}O.resolveItems({items:(t={},t[D]=n.__assign({},a.itemActivityFacet.pack(q),l.getInvalidationFacet().forFacet(a.itemActivityFacet).thenInvalidate(D,c.childItemsFacet).pack()),t)})}}e(O.execute());e(f.logEngagement({name:"ItemActivityField.View",extraData:{activityFieldProcessedItemCount:C,activityFieldEligibleItemCount:k,activityFieldActiveItemCount:L,activityFieldBadgedItemCount:A,activityFieldBadgedPercent:C?Math.round(A/C*100):0},isIntentional:!1}))}return[2]}var U})})}}t.getActivityItems=d});
define("@ms/items-view/lib/private/operations/logEngagement",["require","exports","@ms/telemetry-manager/lib/events/Engagement.event","./telemetry/getTelemetryManager"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.logEngagement=function(e){return function(t){var i=t(r.getTelemetryManager);n.Engagement.withManager(i).logData(e)}}});
define("@ms/items-view-addon-graph/lib/handlers/operations/searchItemSet/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","../../../models/keys/SearchItemSetKeyFacet","../../../utilities/getAndProcessDriveItemSetData","../../../utilities/Data","../../../models/keys/SearchItemSetRootItemKeyFacet"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.searchItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a;return n.__generator(this,function(f){switch(f.label){case 0:t=[{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];return[4,r(s.getAndProcessDriveItemSetData(n.__assign({},e,{qosName:"search",itemSetKeyFacet:i.searchItemSetKeyFacet,parentItemKeyFacet:u.searchRootItemKeyFacet,getUrl:function(e){var t,n=e.driveItemKey,r=e.searchTerm;r&&(t=encodeURIComponent(r));return o.getDriveItemUrl(n)+"/search(q='"+t+"')?$expand=thumbnails&select=*,webDavUrl"},expectedErrors:t})))];case 1:a=f.sent().itemResolver;r(a.execute());return[2]}})})}})});
define("@ms/items-view-addon-graph/lib/models/keys/SearchItemSetKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet","./DriveItemKeyFacet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.searchItemSetKeyFacet=new n.KeyFacet("searchItemSet",{driveItemKey:n.subKeyPart(r.driveItemKeyFacet),searchTerm:n.stringPart()})});
define("@ms/items-view-addon-graph/lib/models/keys/SearchItemSetRootItemKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.searchRootItemKeyFacet=new n.KeyFacet("searchRootItem",{endpoint:n.stringPart()})});
define("@ms/items-view-addon-graph/lib/GraphAddonDriveItemSet",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/facets/SetFacets","@ms/items-view/lib/private/operations/getItems","./handlers/operations/driveItemSet/getItemsOperationHandler","./models/keys/DriveItemSetKeyFacet"],function(e,t,n,r,i,s,o,u){"use strict";var a=this;Object.defineProperty(t,"__esModule",{value:!0});t.graphAddonDriveItemSet=r.createAddon(function(){return function(e){return n.__awaiter(a,void 0,void 0,function(){return n.__generator(this,function(t){e(s.supportFacets({keyFacet:u.driveItemSetKeyFacet,facets:[u.driveItemSetKeyFacet,i.childItemsFacet]}));e(r.registerOperationHandler(u.driveItemSetKeyFacet,s.getItemsOperation)(o.driveItemSetGetItemsOperationHandler));return[2]})})}})});
define("@ms/items-view-addon-graph/lib/handlers/operations/driveItemSet/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","../../../utilities/loadAndProcessPagedDriveItemSet","@ms/items-view/lib/private/operations/configuration/readConfiguration","../../../models/facets/ConfigurationFacets","../../../utilities/UrlConstants"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemSetGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,f;return n.__generator(this,function(l){switch(l.label){case 0:t=r(s.readConfiguration({pageSize:o.driveItemSetPageSizeFacet})).pageSize;return[4,r(i.loadAndProcessPagedDriveItemSet(n.__assign({},e,{skip:a,top:t||u.DEFAULT_PAGE_SIZE})))];case 1:f=l.sent();r(f.execute());return[2]}})})}});var a=0});
define("@ms/items-view-addon-graph/lib/utilities/loadAndProcessPagedDriveItemSet",["require","exports","tslib","../models/keys/DriveItemSetKeyFacet","../models/keys/DriveItemKeyFacet","@ms/items-view/lib/private/operations/readItems","./Data","@ms/items-view/lib/private/facets/GroupFacets","./processDriveItemSet","./getFilterParams","../models/facets/DriveTypeFacet"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.loadAndProcessPagedDriveItemSet=function(e){var t=this;return function(c){return n.__awaiter(t,void 0,void 0,function(){var t,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O;return n.__generator(this,function(n){switch(n.label){case 0:t=e.itemKey,h=e.top,p=e.skip;d=r.driveItemSetKeyFacet.deserialize(t);v=d.driveItemKey,m=d.extFilters;g=i.driveItemKeyFacet.serialize(d.driveItemKey);y=d.driveItemKey.endpoint;return[4,c(s.readItems(function(e){return{isParentItemResolved:e.isItemFacetResolved(i.driveItemKeyFacet,g),totalChildCount:e.isItemFacetResolved(u.countFacet,g)?e.demandItemFacet(u.countFacet,g):void 0,driveType:e.isItemFacetResolved(l.driveTypeFacet,g)?e.demandItemFacet(l.driveTypeFacet,g):void 0}}))];case 1:b=n.sent(),w=b.isParentItemResolved,E=b.totalChildCount,S=b.driveType;x=Promise.resolve(void 0);w||(x=c(o.getRawDataWithCache({url:o.getDriveItemUrl(v),qosName:"getItem",endpoint:y})));T=[{code:"notAllowed",message:"You do not have access to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"ItemNotFound"},{code:"503"}];N=c(o.getRawDataWithCache({url:o.getDriveItemUrl(v)+"/children?$top="+h+(p?"&skiptoken="+p+"/"+E+"&skip="+p:"")+"&$expand=thumbnails&select=*,webDavUrl"+f.getExtFiltersParams(m),qosName:"getChildren.folder",endpoint:y,expectedErrors:T}));C=[N,x];return[4,Promise.all(C)];case 2:k=n.sent(),L=k[0];if(A=k[1]){A.folder&&(E=A.folder.childCount);A.parentReference&&A.parentReference.driveType&&(S=A.parentReference.driveType)}O=c(o.supportsDriveItemSetRandomAccess(y,S));return[4,c(a.processDriveItemSet({itemKey:t,itemSetKeyFacet:r.driveItemSetKeyFacet,parentItemKeyFacet:i.driveItemKeyFacet,parentItemResponse:A,childItemsResponse:L,skip:p,enableRandomAccess:O,totalChildCount:E}))];case 3:return[2,n.sent().itemResolver]}})})}}});
define("@ms/items-view-addon-graph/lib/utilities/getFilterParams",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getExtFiltersParams=function(e){if(!e||0===e.length)return"";for(var t="&$filter=",n=0;n<e.length;n++){var r=e[n];t+="folder"===r?(n>0?" or ":"")+"folder ne null":(n>0?" or ":"")+"endsWith(name, '"+r+"')"}return t}});
define("@ms/items-view-addon-graph/lib/handlers/operations/commands/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/models/items/ItemResolver","../../../models/facets/CommandsFacets","../../../models/keys/CommandsItemKeyFacet","../../../utilities/Data"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.commandsGetItemsOperationHandler=r.createSingleItemOperationHandler()(a);function a(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,a,l,c,h,p;return n.__generator(this,function(d){switch(d.label){case 0:a=e.itemKey;l=o.commandsItemKeyFacet.deserialize(a);c=l.endpoint;return[4,r(f({url:u.getCommandsUrlFromDriveItem(l),qosName:"commands",endpoint:c}))];case 1:h=d.sent();(p=new i.ItemResolver).resolveItems({items:(t={},t[a]=n.__assign({},s.addToOneDriveFacet.pack(h.addToOneDrive),s.createFolderFacet.pack(h.createFolder),s.createLinkFacet.pack(h.createLink),s.deleteFacet.pack(h.delete),s.downloadFacet.pack(h.download),s.inviteFacet.pack(h.invite),s.moveFacet.pack(h.move),s.officeLensFacet.pack(h.officeLens),s.renameFacet.pack(h.rename),s.uploadFacet.pack(h.upload)),t)});r(p.execute());return[2]}})})}}t.getCommands=a;function f(e){var t=this;return function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2,{addToOneDrive:{roles:["write"]},createFolder:{roles:["owner","write"]},createLink:{defaultScope:"anonymous",linkTypes:["view","edit"],scopes:["anonymous","application"]},delete:{roles:["owner","write"]},download:{roles:["owner","write","read"]},invite:{roles:["owner","write"]},move:{roles:["owner","write"]},officeLens:{extensions:["jpeg","jpg","jpe"],lensNames:["officeLens"],roles:["owner"]},rename:{roles:["owner","write"]},upload:{roles:["owner","write"]}}]})})}}});
define("@ms/items-view-addon-graph/lib/models/facets/CommandsFacets",["require","exports","@ms/items-view/lib/private/models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addToOneDriveFacet=new n.Facet("addToOneDrive");t.createFolderFacet=new n.Facet("createFolder");t.createLinkFacet=new n.Facet("createLink");t.deleteFacet=new n.Facet("delete");t.downloadFacet=new n.Facet("download");t.inviteFacet=new n.Facet("invite");t.moveFacet=new n.Facet("move");t.officeLensFacet=new n.Facet("officeLens");t.renameFacet=new n.Facet("rename");t.uploadFacet=new n.Facet("upload")});
define("@ms/items-view-addon-graph/lib/models/keys/CommandsItemKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.commandsItemKeyFacet=new n.KeyFacet("commands",{endpoint:n.stringPart(),driveId:n.stringPart({shouldNormalizeToEmpty:!0})})});
define("@ms/items-view-addon-graph/lib/handlers/controls/openActionControl",["require","exports","tslib","@ms/items-view/lib/private/addons/registerControlHandler","@ms/items-view/lib/private/models/itemsScope/getCurrentItemSetKey","@ms/items-view/lib/private/store/actions/createActionCreator","../../models/keys/DriveItemKeyFacet","../../models/keys/DriveItemSetKeyFacet","@ms/items-view/lib/private/facets/SetFacets","@ms/items-view/lib/private/operations/getItems"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openActionControlHandler=r.createControlHandler()(function(){return function(e){return function(e,t){var r=i.getCurrentItemSetKey(e),s=c(e,{folderItemKey:t.itemKey,currentItemSetKey:r}),a=s&&l(e,{parentItemKey:o.driveItemKeyFacet.serialize(s.driveItemKey),stageItem:t.stageItem});return n.__assign({},s?{itemKey:u.driveItemSetKeyFacet.serialize(s)}:{},a?{stageItem:a}:{})}}});function l(e,t){var r=this,i=t.parentItemKey,o=t.stageItem;if(i)return o?s.createAsyncActionCreator(function(e){var t=e.itemsScopeItemKey,s=e.currentItemKey;return function(e){return n.__awaiter(r,void 0,void 0,function(){var r;return n.__generator(this,function(u){switch(u.label){case 0:e(f.resolveItems({items:(r={},r[s]=n.__assign({},a.parentItemFacet.pack({itemKey:i})),r)}));return[4,e(o({currentItemKey:s,itemsScopeItemKey:t}))];case 1:u.sent();return[2]}})})}}):void 0}t.getStageItemOverride=l;function c(e,t){var r=t.folderItemKey,i=t.currentItemSetKey;if(i&&r){var s=e.demandItemFacet(u.driveItemSetKeyFacet,i),a=e.demandItemFacet(o.driveItemKeyFacet,r);if(s&&a){var f=a.endpoint,l=a.driveId,c=a.itemId;return n.__assign({},s,{driveItemKey:{endpoint:f,driveId:l,itemId:c}})}}}t.getOverrideItemSetKeyForFolder=c});
define("@ms/items-view/lib/private/controls/filteredItemSetControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.filteredItemSetControl=new n.ControlFacet("itemSetFilter")});
define("@ms/items-view-addon-graph/lib/handlers/controls/recentRootItemSetFilteredItemSetControlHandler",["require","exports","tslib","../../models/keys/RecentItemSetKeyFacet","@ms/items-view/lib/private/addons/registerControlHandler","@ms/items-view/lib/private/models/itemSets/filters/itemExtensionFilterHandler","@ms/items-view/lib/private/models/itemSets/filters/itemTypeFilterHandler"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemSetFilteredItemSetControlHandler=i.createControlHandler()(function(){return function(e){return u}});function u(e,t){var i=t.handlers,u=t.itemKey,a=e.demandItemFacet(r.recentItemSetKeyFacet,u);if(i&&a){for(var f=[],l=0,c=i;l<c.length;l++){var h=c[l];if(h.key===o.itemPhotoTypeFilterHandler.key)f.push("photo");else if(h.key===o.itemVideoTypeFilterHandler.key)f.push("video");else{var p=s.getExtensionFromFilterHandler(h);p&&f.push(p)}}return{itemKey:r.recentItemSetKeyFacet.serialize(n.__assign({},a,{filters:f}))}}return{}}});
define("@ms/items-view/lib/private/models/itemSets/filters/itemExtensionFilterHandler",["require","exports","../../KeyFacet","../../../facets/ItemFacets"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=new n.KeyFacet("itemSetExtensionFilterHandler",{extension:n.stringPart({shouldNormalizeCasing:!0})});t.getExtensionFromFilterHandler=function(e){if(i.matches(e.key)){return i.deserialize(e.key).extension}};t.getItemExtensionFilterHandler=function(e){return{key:i.serialize({extension:e}),filter:function(t,n){var i=t.demandItemFacet(r.fileNameFacet,n.itemKey);return!!i&&i.extension===e}}}});
define("@ms/items-view/lib/private/models/itemSets/filters/itemTypeFilterHandler",["require","exports","../../AutoKeyFacet","../../../facets/ItemFacets","../../../facets/MediaFacets","../../../facets/DocumentFacets"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=new n.AutoKeyFacet("itemSetTypeFilterHandler");function u(e){return{key:o.serializeNext(),filter:e}}t.createItemTypeFilterHandler=u;t.itemFolderTypeFilterHandler=u(function(e,t){return!!e.demandItemFacet(r.folderFacet,t.itemKey)});t.itemNonFolderTypeFilterHandler=u(function(e,t){return!e.demandItemFacet(r.folderFacet,t.itemKey)});t.itemPhotoTypeFilterHandler=u(function(e,t){return!!e.demandItemFacet(i.photoFacet,t.itemKey)});t.itemVideoTypeFilterHandler=u(function(e,t){return!!e.demandItemFacet(i.videoFacet,t.itemKey)});t.itemNonOneNoteFilterHandler=u(function(e,t){return!e.demandItemFacet(s.oneNoteFacet,t.itemKey)})});
define("@ms/items-view-addon-graph/lib/handlers/controls/itemsViewControl",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","@ms/items-view/lib/private/components/layouts/TilesLayoutTypeFacet","../../models/keys/RecentItemSetKeyFacet","@ms/odsp-graph/lib/utilities/media/MediaUtils","@ms/odsp-graph/lib/models/item/IItemTypeFilter","@uifabric/file-type-icons/lib/FileTypeIconMap"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemsViewControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){var n=t.itemKey;if(n){var a=e.demandItemFacet(i.recentItemSetKeyFacet,n);if(a&&a.filters&&s.doExtFiltersHaveMediaTypesOnly({extFilters:s.getIItemTypeFilter(a.filters),allowedMediaTypes:[o.ItemTypeFilter.photo,o.ItemTypeFilter.video],fileTypeIconMap:u.FileTypeIconMap}))return{defaultLayout:r.tilesLayoutType,isLayoutResolved:!0}}return{}}}})});
define("@ms/items-view-addon-graph/lib/models/keys/SharesItemKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharesItemKeyFacet=new n.KeyFacet("sharesItem",{endpoint:n.stringPart(),shareId:n.stringPart()})});
define("@ms/items-view-addon-graph/lib/handlers/operations/sharesItem/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","../../../models/keys/SharesItemKeyFacet","../../../utilities/Data","../../../models/keys/DriveItemKeyFacet","../../../utilities/getDriveItemFacets","@ms/items-view/lib/private/facets/SetFacets","../../../models/keys/DriveItemSetKeyFacet","@ms/items-view/lib/private/models/items/ItemResolver","@ms/items-view/lib/private/facets/OperationFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharesItemGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,h=i.sharesItemKeyFacet.deserialize(r),p=h.endpoint;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,d,v,m,g,y,b,w;return n.__generator(this,function(E){switch(E.label){case 0:return[4,e(s.getRawData({url:s.getSharesItemUrl(h)+"?$expand=thumbnails&select=*,webDavUrl",qosName:"getSharesItem",endpoint:p,headers:{Prefer:"redeemSharingLinkIfNecessary"}}))];case 1:d=E.sent();v=new l.ItemResolver;m=d&&d.parentReference;g=m&&m.driveId;y={endpoint:p,driveId:g,itemId:d.id};b=o.driveItemKeyFacet.serialize(y);w=m&&m.id?o.driveItemKeyFacet.serialize({endpoint:p,driveId:g,itemId:m.id}):void 0;v.resolveItems({items:(t={},t[b]=n.__assign({},u.getDriveItemFacets({driveItem:d,endpoint:p,parentFolderItemKey:w}),c.preferredKeyFacetFacet.pack(o.driveItemKeyFacet),a.defaultChildItemSetFacet.pack({itemKey:f.driveItemSetKeyFacet.serialize({driveItemKey:y,sortBy:"",isAscending:!0})})),t)});v.mapKeys({mappings:(i={},i[b]=r,i)});e(v.execute());return[2]}})})}})});
define("@ms/items-view-addon-graph/lib/GraphFileHandlerAddon",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/operations/getItems","@ms/items-view/lib/private/operations/pageLoad","./models/keys/FileHandlerKeyFacet","@ms/utilities-async/lib/decorators/asModuleLoad"],function(e,t,n,r,i,s,o,u){"use strict";var a=this;Object.defineProperty(t,"__esModule",{value:!0});var f=u.asModuleWithRetries(function(){return new Promise(function(t,n){e(["./handlers/operations/fileHandler/getItemsOperationHandler"],t,n)})},{chunkName:"addon-graph-deferredoperations"});t.graphFileHandlerAddon=r.createAddon(function(){return function(e){return n.__awaiter(a,void 0,void 0,function(){var t=this;return n.__generator(this,function(u){e(r.registerOperationHandler(o.driveAppsKeyFacet,i.getItemsOperation)(r.createDeferredOperationHandler(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,e(s.waitForPageLoad())];case 1:t.sent();return[4,f()];case 2:return[2,t.sent().fileHandlerGetItemsOperationHandler]}})})})));e(r.registerOperationHandler(o.driveAppsExtensionKeyFacet,i.getItemsOperation)(r.createDeferredOperationHandler(function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,e(s.waitForPageLoad())];case 1:t.sent();return[4,f()];case 2:return[2,t.sent().filehandlerPerExtensionGetItemsOperationHandler]}})})})));return[2]})})}})});
define("@ms/items-view-addon-graph/lib/models/keys/FileHandlerKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveAppsKeyFacet=new n.KeyFacet("driveApps",{endpoint:n.stringPart(),driveId:n.stringPart({shouldNormalizeToEmpty:!0})});t.driveAppsExtensionKeyFacet=new n.KeyFacet("driveAppsExtension",{endpoint:n.stringPart(),extension:n.stringPart(),driveId:n.stringPart({shouldNormalizeToEmpty:!0})});t.fileHandlerKeyFacet=new n.KeyFacet("fileHandlerKey",{id:n.stringPart(),appId:n.stringPart()});t.fileHandlerActionKeyFacet=new n.KeyFacet("fileHandlerActionKey",{handlerId:n.stringPart(),appId:n.stringPart(),id:n.numberPart()});t.fileHandlerActionSetKeyFacet=new n.KeyFacet("fileHandlerActionSetKey",{type:n.stringPart(),extension:n.stringPart()});t.fileHandlerPreferenceKeyFacet=new n.KeyFacet("fileHandlerPreferenceKey",{extension:n.stringPart()})});
define("@ms/utilities-async/lib/decorators/asModuleLoad",["require","exports","tslib","./ILoaderDecorator","@ms/utilities-error/lib/ModuleLoadError","@ms/utilities-error/lib/ApiError","./withRetries"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.asModuleWithRetries=function(e,t){void 0===t&&(t={});return r.composeLoaders(u,o.withRetries)(e,t)};t.forModuleExport=function(e,t){var r=this;return function(i){void 0===i&&(i={});return n.__awaiter(r,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,e(i)];case 1:return[2,n.sent()[t]]}})})}};function u(e,t){var r=this;void 0===t&&(t={});var o=t.chunkName,u=t.allowEmptyModule;return function(t){void 0===t&&(t={});return n.__awaiter(r,void 0,void 0,function(){var r,a;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,e(t)];case 1:r=n.sent();return[3,3];case 2:if((a=n.sent())instanceof s.ApiError)throw a;throw new i.ModuleLoadError({code:"LoadError",innerError:a,chunkName:o});case 3:if(!r&&!u)throw new i.ModuleLoadError({code:"EmptyModule",chunkName:o});return[2,r]}})})}}t.asModule=u});
define("@ms/utilities-async/lib/decorators/ILoaderDecorator",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.composeLoaders=function(e,t){return function(n,r){return e(t(n,r),r)}}});
define("@ms/utilities-async/lib/decorators/withRetries",["require","exports","tslib","../wait/wait","../cancel/CancelError"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.withRetries=function(e,t){var s=this;void 0===t&&(t={});var o=t.retryInterval,u=void 0===o?1e3:o,a=t.retryCount,f=void 0===a?3:a;return function(t){void 0===t&&(t={});return n.__awaiter(s,void 0,void 0,function(){var s,o,a,l,c,h;return n.__generator(this,function(n){switch(n.label){case 0:s=t.cancelToken;a=f;n.label=1;case 1:l=void 0;s&&s.throwIfCanceled();n.label=2;case 2:n.trys.push([2,4,,5]);c={};return[4,e()];case 3:o=(c.value=n.sent(),c);return[3,5];case 4:if((h=n.sent())instanceof i.CancelError)throw h;l=h;return[3,5];case 5:if(o)return[2,o.value];if(a<=0)throw l;return[4,r.wait(u,s)];case 6:n.sent();a--;n.label=7;case 7:return[3,1];case 8:return[2]}})})}}});
define("@ms/items-view-addon-graph/lib/models/keys/DriveItemVirtualizedPageKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemVirtualizedPageKeyFacet=new n.KeyFacet("driveItemVirtualizedPage",{endpoint:n.stringPart(),setItemKey:n.stringPart(),skip:n.numberPart(),top:n.numberPart()})});
define("@ms/items-view-addon-graph/lib/handlers/operations/driveItemVirtualizedPage/getItemsOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","../../../models/keys/DriveItemVirtualizedPageKeyFacet","../../../utilities/loadAndProcessPagedDriveItemSet"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemVirtualizedPageGetItemsOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=this,r=e.itemKey,o=i.driveItemVirtualizedPageKeyFacet.deserialize(r),u=o.setItemKey,a=o.top,f=o.skip;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(i){switch(i.label){case 0:return[4,r(s.loadAndProcessPagedDriveItemSet(n.__assign({},e,{itemKey:u,skip:f,top:a})))];case 1:t=i.sent();r(t.execute());return[2]}})})}})});
define("@ms/items-view-addon-graph/lib/handlers/controls/savedForLaterEmptyFolderControl",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","./GraphControl.resx"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.emptyFolderControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){return{emptyFolderIconUrl:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/empty_state_sfl.svg",emptyFolderTitle:r.default.savedForLaterEmptyStateTitle}}}})});
define("@ms/items-view-addon-graph/lib/handlers/controls/driveItem/itemHoverCardControlHandler",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","@ms/shared-react-item-hover-card/lib/itemsScopeFileHoverCard/HoverZone","../../../models/facets/DriveTypeFacet"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemHoverCardControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){var n=t.itemKey;return"personal"!==e.demandItemFacet(i.driveTypeFacet,n)?{hoverCard:r.FileHoverCardZone}:{}}}})});
define("@ms/shared-react-item-hover-card/lib/itemsScopeFileHoverCard/HoverZone",["require","exports","tslib","react","@ms/items-view/lib/private/components/decorators/afterPageLoad","@ms/items-view/lib/private/utilities/components/Async","./HoverZone.module.scss"],function(e,t,n,r,i,s,o){"use strict";var u=this;Object.defineProperty(t,"__esModule",{value:!0});var a=i.afterPageLoad()(s.asAsync(function(){return n.__awaiter(u,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../itemsScopeFileHoverCard/FileHoverCard"],t,n)})];case 1:return[2,t.sent().FileHoverCard]}})})})),f=i.afterPageLoad()(s.asAsync(function(){return n.__awaiter(u,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../itemsScopeFileHoverCard/FileHoverCard"],t,n)})];case 1:return[2,t.sent().CurrentFileHoverCard]}})})}));function l(){return function(e){var t=e;return function(e){n.__extends(i,e);function i(t){var n=e.call(this,t)||this;n._setTarget=function(e){n.setState({target:e})};n.state={target:null};return n}i.prototype.render=function(){return r.createElement("div",{className:o.target,ref:this._setTarget},this.props.children,this.state.target&&r.createElement("div",{className:o.host},r.createElement(t,n.__assign({target:this.state.target},this.props))))};return i}(r.PureComponent)}}t.FileHoverCardZone=l()(a);t.CurrentFileHoverCardZone=l()(f)});
define("@ms/shared-react-item-hover-card/lib/itemsScopeFileHoverCard/HoverZone.module.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".target_a6dcad92{display:block}.host_a6dcad92{position:absolute;left:0;right:0;bottom:0;top:0;pointer-events:none}\n"}]);t.target="target_a6dcad92";t.host="host_a6dcad92"});
define("@ms/items-view-addon-graph/lib/handlers/controls/sharedWithMeRootItemCommandBar",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","@ms/items-view/lib/private/components/commands/open/openCommand","@ms/items-view/lib/private/components/commands/share/shareCommand"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeCommandBarControlHandler=n.createControlHandler()(function(){return function(e){return o}});t.default=t.sharedWithMeCommandBarControlHandler;var s=[r.openCommand,i.shareCommand,i.copyLinkCommand];function o(e,t){return{commands:s}}});
define("@ms/items-view/lib/private/components/commands/open/openCommand",["require","exports","tslib","react","../../../models/Facet","../../actions/openUrl/OpenUrlAction","../Commands.resx","../../selectionVisibility/SelectionVisibility","../../../facets/CommandFacets"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openCommand={key:new i.Facet("open").id,automationId:"openCommand",name:o.default.Open,action:r.createElement(u.ShowOnlyWithSelection,null,r.createElement(s.OpenUrlAction,null)),iconProps:{iconName:"OpenFile"},facets:n.__assign({},a.isReadonlyFacet.pack(!0))}});
define("@ms/items-view/lib/private/facets/CommandFacets",["require","exports","../models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isReadonlyFacet=new n.Facet("readonly");t.isShareFacet=new n.Facet("share")});
define("@ms/items-view/lib/private/components/commands/share/shareCommand",["require","exports","tslib","react","../../../models/Facet","../../actions/share/ShareAction","../Commands.resx","../../keyboard/KeyboardMap.resx","../../../facets/CommandFacets"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.shareCommand={key:new i.Facet("share").id,automationId:"shareCommand",name:o.default.Share,title:o.default.ShareCommandTooltipV3,action:r.createElement(s.ShareAction,null),iconProps:{iconName:"Share"},shortcutProps:{keySequences:["S"],content:u.default.showShareDesc},facets:n.__assign({},a.isShareFacet.pack(!0))};t.copyLinkCommand={key:new i.Facet("copyLink").id,automationId:"copyLinkCommand",name:o.default.CopyLinkCommandText,title:o.default.CopyLinkCommandTooltipV3,action:r.createElement(s.CopyLinkAction,null),iconProps:{iconName:"Link"},facets:n.__assign({},a.isShareFacet.pack(!0))};t.addPeopleCommand={key:new i.Facet("addPeople").id,automationId:"addPeopleCommand",name:o.default.GrantAccess,title:o.default.GrantAccessCommandLabel,action:r.createElement(s.AddPeopleAction,null),iconProps:{iconName:"PlayerSettings"},facets:n.__assign({},a.isShareFacet.pack(!0))}});
define("@ms/items-view/lib/private/controls/itemsCommandBarControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemsCommandBarControl=new n.ControlFacet("itemsCommandBarControl")});
define("@ms/items-view-addon-graph/lib/handlers/controls/sharedWithMeRootItemContextMenu",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","@ms/items-view/lib/private/components/commands/open/openCommand","@ms/items-view/lib/private/components/commands/share/shareCommand"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedWithMeContextMenuControlHandler=n.createControlHandler()(function(){return function(e){return o}});var s=[r.openCommand,i.shareCommand,i.copyLinkCommand];function o(e,t){return{commands:s}}});
define("@ms/items-view-addon-graph/lib/handlers/controls/recentItemSetColumns",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","../../components/columns/fileTypeIconColumn","../../components/columns/dateAccessedColumn","@ms/items-view/lib/private/components/columns/nameAndPath/nameAndPathColumn"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentItemSetColumnsControlHandler=n.createControlHandler()(function(){return function(e){return u}});var o=[r.fileTypeIconColumn,s.nameAndPathColumn,i.dateAccessedColumn];function u(e,t){return{columns:o}}});
define("@ms/items-view-addon-graph/lib/components/columns/dateAccessedColumn",["require","exports","tslib","@ms/items-view/lib/private/components/columns/dateModified/dateModifiedColumn","@ms/items-view/lib/private/models/Facet","./Columns.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dateAccessedColumn=n.__assign({},r.dateModifiedColumn,{name:s.default.lastAccessedColumnHeaderText,key:new i.Facet("dateAccessedColumn").id,minWidth:200})});
define("@ms/items-view/lib/private/components/columns/dateModified/dateModifiedColumn",["require","exports","../createColumn","../columns.resx","../../../models/Facet","../../fields/date/DateRenderer","../../../facets/ItemFacets"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dateModifiedColumn=n.createColumn({key:new i.Facet("dateModifiedColumn").id,name:r.default.ModifiedDate,fieldName:"",minWidth:n.ColumnWidth.regularMin,maxWidth:n.ColumnWidth.regularMax,isCollapsable:!0},s.DateRenderer)(function(e,t){return function(){return{itemKey:t}}},function(e,t){return""+e.demandItemFacet(o.dateModifiedFacet,t)})});
define("@ms/items-view/lib/private/components/fields/date/DateRenderer",["require","exports","../../decorators/connectToItemCache","./DateField","../../../facets/ItemFacets","../../../facets/ConfigurationFacets","@ms/utilities-date-time/lib/relativePast"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DateRenderer=n.connectToItemCache(function(e,t){var n=e.demandItemFacet(i.dateModifiedFacet,t.itemKey),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var u=e.demandItemFacet(s.localeFacet,s.configurationItemKey),a=u&&u.language||window.navigator.language;return a?{text:o.getRelativeDateTimeStringPast(new Date(r),a)}:{dateValue:r}})(r.DateField)});
define("@ms/items-view-addon-graph/lib/handlers/controls/driveItemSetPagingControlHandler",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","../../models/keys/DriveItemSetKeyFacet","@ms/items-view/lib/private/facets/GroupFacets","../../models/keys/DriveItemVirtualizedPageKeyFacet","../../models/keys/DriveItemKeyFacet","@ms/items-view/lib/private/facets/ConfigurationFacets","../../models/facets/ConfigurationFacets","../../utilities/UrlConstants","../../models/facets/DriveTypeFacet"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemSetPagingControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.setItemKey,c=r.driveItemSetKeyFacet.deserialize(t.setItemKey),h=c.driveItemKey.endpoint,p=o.driveItemKeyFacet.serialize(c.driveItemKey),d=e.demandItemFacet(l.driveTypeFacet,p),v=e.demandItemFacet(a.driveItemSetPageSizeFacet,u.configurationItemKey)||f.DEFAULT_PAGE_SIZE,m=e.demandItemFacet(a.supportsDriveItemSetRandomAccessFacet,u.configurationItemKey);if(m&&m(h,d)){return{totalItemCount:e.demandItemFacet(i.countFacet,p),getPageKeys:function(e,t){var r=[];if(n&&c)for(e=Math.floor(e/v)*v;e<t;e+=v){var i=void 0;(i=0===e?n:s.driveItemVirtualizedPageKeyFacet.serialize({setItemKey:n,endpoint:c.driveItemKey.endpoint,skip:e,top:v}))&&r.push(i)}return r}}}return{}}}})});
define("odsp-next/controls/itemContent/itemsScope/odc/ItemContentBreadcrumbControlHandler",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","@ms/items-view/lib/private/components/decorators/selectors","@ms/odsp-utilities/lib/resources/Resources","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view-addon-graph/lib/models/keys/SharedWithMeRootItemKeyFacet","@ms/items-view-addon-graph/lib/models/keys/DriveItemSetKeyFacet","@ms/items-view/lib/private/models/itemsScope/getItemsScope","../../../../models/itemsScope/facets/CurrentItemsScopeFacets","../../../../dataSources/url/odc/UrlDataSource","../../../../dataSources/url/odc/UrlRouting","@ms/items-view-addon-graph/lib/models/keys/DriveItemKeyFacet"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey({name:e("module").id,factory:{dependencies:{urlDataSource:l.resourceKey},create:function(e){var t=e.urlDataSource,i=function(e,n){var i=e.demandItemFacet(u.driveItemSetKeyFacet,n.itemKey);if(!i)return{};var l=i.driveItemKey.endpoint,p=a.getItemsScope(e).itemsScopeItemKey;return{crumbControlHandler:function(e,n){var i=r.getItemKey(e,n),u=e.demandItemFacet(s.parentFolderItemFacet,i),a=e.demandItemFacet(f.currentViewParamsFacet,p),d=t.isCurrentQuerySharedWithMe(a),v=t.getCidFromResourceId(a),m=a&&a.cid&&v&&v.toLowerCase()!==a.cid.toLowerCase();if(void 0===u){if(m)return{parentItemKey:h.driveItemKeyFacet.serialize({itemId:"root",driveId:c.viewerId,endpoint:l})};if(d)return{parentItemKey:o.sharedWithMeRootItemKeyFacet.serialize({endpoint:l})}}return{}}}};return{instance:n.createControlHandler()(function(){return function(e){return i}})}}}})});
define("odsp-next/models/itemsScope/od/ItemsScopeKeyConverter",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/items-view-addon-graph/lib/models/keys/DriveItemKeyFacet","../../../dataSources/url/odc/UrlHelpers","../../../dataSources/url/odc/UrlDataSource","@ms/items-view-addon-graph/lib/models/keys/DriveItemSetKeyFacet","@ms/items-view-addon-photos/lib/models/keys/PhotosRootItemSetKeyFacet","@ms/items-view-addon-photos/lib/models/interfaces/EAllPhotosGroupBy","../../../dataSources/url/QueryType","../../../dataSources/url/odc/UrlRouting","@ms/items-view-addon-graph/lib/models/keys/RecentRootItemKeyFacet","@ms/items-view-addon-graph/lib/models/keys/SharedWithMeRootItemKeyFacet","@ms/items-view-addon-graph/lib/models/keys/SharedByMeRootItemKeyFacet","../../../dataSources/url/odc/UrlRouting"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=["albums","tags","places"],m=function(){function e(e,t){var n=this;this.itemKeyToStoreKeyControlHandler=function(e,t){var r=n._convertItemsScopeKey(e,{itemKey:t.itemKey,viewParams:t.viewParams}),i=r.key,s=r.viewParams,o=r.id;return"string"==typeof i?{storeKey:{key:i,viewParams:s,id:o}}:{}};this.viewParamsToItemKeyControlHandler=function(e,t){var r=n._getItemsScopeKeyFromViewParams({viewParams:t.viewParams});return r?{itemKey:r}:{}};this._urlDataSource=t.urlDataSource}e.prototype._getItemsScopeKeyFromViewParams=function(e){var t=e.viewParams,n=t?l.getQueryType(t):f.default.Files,r=this._urlDataSource.getKeyParams(this._urlDataSource.getCurrentItemKey(t)),s=r.id,d=r.cid,m=i.getVroomBaseUrl();if(n===f.default.Files){if(s&&d){var g=this._urlDataSource.getCidFromResourceId(t);g=g&&g.toLowerCase();var y=t&&t.cid&&g&&g!==t.cid.toLowerCase();return o.driveItemSetKeyFacet.serialize({driveItemKey:{itemId:s,driveId:y?g:d.toLowerCase(),endpoint:m},isAscending:!0,sortBy:""})}}else{if(n===f.default.Recent)return c.recentRootItemKeyFacet.serialize({endpoint:m});if(n===f.default.SharedWithMe)return h.sharedWithMeRootItemKeyFacet.serialize({endpoint:m});if(n===f.default.SharedByMe)return p.sharedByMeRootItemKeyFacet.serialize({endpoint:m});if(n===f.default.AllMyPhotos){var b=s;-1!==v.indexOf(b)&&(b="root");return u.photosRootItemSetKeyFacet.serialize({photosRootKeyPart:{driveId:d,endpoint:m},groupBy:a.EAllPhotosGroupBy.Date,filter:b})}}};e.prototype._convertItemsScopeKey=function(e,t){var n,i,s,u,a=t.itemKey,l=t.viewParams;if(r.driveItemKeyFacet.matches(a)){var v=r.driveItemKeyFacet.deserialize(a);(m=v.driveId)!==d.viewerId&&(m=d.viewerId);"root"!==(u=v.itemId)&&(u=u.toUpperCase());s=this._urlDataSource.getKey(((n={}).id=u,n.cid=m.toUpperCase(),n))}else if(o.driveItemSetKeyFacet.matches(a)){var m,g=o.driveItemSetKeyFacet.deserialize(a);(m=g.driveItemKey.driveId)!==d.viewerId&&(m=d.viewerId);"root"!==(u=g.driveItemKey.itemId)&&(u=u.toUpperCase());s=this._urlDataSource.getKey(((i={}).id=u,i.cid=m.toUpperCase(),i))}else if(c.recentRootItemKeyFacet.matches(a)){s=this._urlDataSource.getRootItemKey(f.default.Recent);u="root"}else if(h.sharedWithMeRootItemKeyFacet.matches(a)){s=this._urlDataSource.getRootItemKey(f.default.SharedWithMe);u="root"}else if(p.sharedByMeRootItemKeyFacet.matches(a)){s=this._urlDataSource.getRootItemKey(f.default.SharedByMe);u="root"}return{key:s,viewParams:l,id:u}};return e}();t.ItemsScopeKeyConverter=m;t.resourceKey=n.createResolvedResourceKey(e("module").id,m,{urlDataSource:s.resourceKey})});
define("@ms/items-view-addon-photos/lib/models/keys/PhotosRootItemSetKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet","./PhotosRootKeyFacet"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.photosRootItemSetKeyFacet=new n.KeyFacet("allPhotosRootItemSet",{photosRootKeyPart:n.subKeyPart(r.photosRootKeyFacet),groupBy:n.stringPart(),filter:n.stringPart()})});
define("@ms/items-view-addon-photos/lib/models/keys/PhotosRootKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.photosRootKeyFacet=new n.KeyFacet("photosRootKey",{driveId:n.stringPart(),endpoint:n.stringPart()})});
define("@ms/items-view-addon-photos/lib/models/interfaces/EAllPhotosGroupBy",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e.Date="Date"}(t.EAllPhotosGroupBy||(t.EAllPhotosGroupBy={}))});
define("odsp-next/dataSources/base/odc/vroom/ItemIdentityProcessor",["require","exports","../../../item/ItemTaskObserver","@ms/odsp-utilities/lib/resources/Resources","../../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/graft/Graft"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="/root:",u=function(){function e(e,t){var n=t.urlDataSource;this._urlDataSource=n}e.prototype.processIdentity=function(e){var t,r,i,u,a=e.itemFromServer,f=e.observer,l=a.parentReference,c=a.id,h=a.root?"root":c,p=this._urlDataSource.getKey(((t={}).id=h,t));if(l&&l.id){var d=l.id,v=l.path;i=this._urlDataSource.getKey(((r={}).id=(u=v)&&u.lastIndexOf(o)===u.length-o.length?"root":d,r))}f.update([new n.Task(p).succeed({item:{key:p,id:h,parentKey:s.optional(i)}})]);return{key:p}};e.dependencies={urlDataSource:i.url};return e}();t.ItemIdentityProcessor=u;t.resourceKey=r.createResolvedResourceKey(e("module").id,u);t.default=u});
define("odsp-next/dataSources/graph/odc/GraphDataSource",["require","exports","@ms/odsp-datasources/lib/utilities/permissions/Identity","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","../../base/vroom/VroomDataRequestor","cookies","../../../utilities/features/Features","../../url/odc/UrlRouting","../../url/odc/UrlHelpers","../../../resources/DataSourceResourceKeys","@ms/utilities-error/lib/ApiError"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(){function e(e,t){this._identityDataSource=t.identityDataSource;this._navigation=t.navigation;this._urlCache=new Map;this._vroomDataRequestor=t.vroomDataRequestor}e.prototype.getDownloadUrl=function(e,t){void 0===t&&(t={});var n=this._urlCache;if(!t.forceRefresh){var r=n.get(e.key)||{},s=r.url,o=r.time;if(s&&o<Date.now()-27e5)return i.default.wrap(s)}var a=this._getAuthKey(),f=this.getItemUrl(e,t),l={};if(a){var c=u.get("BadgerAuth");c&&(l={Authorization:"Badger "+c})}var p="itemDownloadUrl";t.apiName&&(p=t.apiName+"."+p);return this._vroomDataRequestor.send({apiName:p,path:f+"?select=id,@content.downloadUrl"+(a?"&authkey="+a:""),needsAuthorization:!a,headers:l,qosExtraData:t.qosExtraData}).then(function(t){var r=t["@content.downloadUrl"];if(!r)throw new h.ApiError({code:"NoDownloadUrl",message:"Vroom response did not contain download URL"});n.set(e.key,{url:r,time:Date.now()});return r})};e.prototype.getDownloadUrlSync=function(e,t){var n=this.getItemUrl(e,t),r=this._getAuthKey();return n&&r?n+"/content?authkey="+r:void 0};e.prototype.getAuthenticationParams=function(e){var t,n=this._getAuthKey();return n?i.default.resolve(((t={}).authkey=n,t)):this._identityDataSource.getSessionToken().then(function(e){var t=e.accessToken,n=e.proofToken,r={};t&&(r.access_token=decodeURIComponent(t));n&&(r.prooftoken=decodeURIComponent(n));return r})};e.prototype.getDriveUrl=function(e,t){void 0===t&&(t={});var n=t.useDirectEndpoint,r=void 0!==n&&n,i=this._getGraphFacet(e);return this._getDriveUrl(i,r)};e.prototype.getItemUrl=function(e,t){void 0===t&&(t={});var n=t.useDirectEndpoint,r=void 0!==n&&n,i=t.isPath,s=void 0!==i&&i,o=this._getGraphFacet(e);return this._getDriveUrl(o,r)+"/items/"+encodeURIComponent(o.itemId)+(s?":":"")};e.prototype.getAccessToken=function(e){};e.prototype._getAuthKey=function(){return this._identityDataSource.getIdentity().type===n.IdentityType.anonymous&&this._navigation.viewParams.authkey};e.prototype._getGraphFacet=function(e){var t=e.graph;if(t)return t;var n=f.getKeyParams(e.key);return{itemId:n.id,driveId:n.cid}};e.prototype._getDriveUrl=function(e,t){return(t?l.getVroomBaseUrl():a.isFeatureEnabled(a.UseNewShareDialog)?"https://graph.microsoft.com/beta":"https://graph.microsoft.com/v1.0")+"/drives/"+encodeURIComponent(e.driveId)};e.dependencies={identityDataSource:c.identity,navigation:r.navigation,vroomDataRequestor:o.resourceKey};return e}();t.default=p;t.resourceKey=s.createResolvedResourceKey(e("module").id,p)});
define("odsp-next/controls/itemsScope/od/ItemSetColumnsControlHandler",["require","exports","@ms/odsp-shared-react/lib/utilities/resources/Resources","@ms/items-view/lib/private/components/columns/fileTypeIcon/fileTypeIconColumn","@ms/items-view/lib/private/components/columns/displayName/displayNameColumn","@ms/items-view/lib/private/components/columns/dateModified/dateModifiedColumn","@ms/items-view/lib/private/components/columns/shared/sharedColumn","@ms/items-view/lib/private/components/columns/fileSize/fileSizeColumn"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=[r.fileTypeIconColumn,i.displayNameColumn,s.dateModifiedColumn,o.sharedColumn,u.fileSizeColumn];t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:{},create:function(e){return{instance:function(e,t){return{columns:a}}}}}})});
define("@ms/items-view/lib/private/components/columns/shared/sharedColumn",["require","exports","../../../models/Facet","../columns.resx","../../fields/sharedItem/SharedRenderer","../createColumn"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sharedColumn=s.createColumn({key:new n.Facet("sharedColumn").id,name:r.default.Sharing,fieldName:"",minWidth:s.ColumnWidth.regularMin,maxWidth:s.ColumnWidth.sharedMax,isCollapsable:!0},i.SharedRenderer)(function(e){return function(e){return{itemKey:e.key}}})});
define("@ms/items-view/lib/private/components/fields/sharedItem/SharedRenderer",["require","exports","react","../../fields/sharedItem/SharedField","../../../facets/ItemFacets","../../withAction/WithAction","../FieldHelper","../../actions/manageAccess/ManageAccessAction","../../decorators/connectToItemCache"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SharedRenderer=a.connectToItemCache(function(e,t){var a=t.itemKey,f=e.demandItemFacet(i.isSharedFacet,a),l=s.evaluateAction(e,n.createElement(u.ItemManageAccessAction,{itemKey:a})),c=o.getFieldRenderBarrier(e);return{children:n.createElement(s.WithAction,{action:l},function(e){var t=e.execute,i=e.isAvailable?function(e){t({event:e}).catch(function(){});e.preventDefault();e.stopPropagation()}:void 0;return n.createElement(r.SharedField,{shared:f,onClick:i,pageLoadBarrier:c})})}})(n.Fragment)});
define("@ms/items-view/lib/private/components/fields/sharedItem/SharedField",["require","exports","tslib","react","office-ui-fabric-react/lib/Icon","./SharedField.scss","@uifabric/utilities/lib/css","../FieldStrings.resx","../../../utilities/components/DeferredRender"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SharedField=function(e){var t,f=e.text,l=e.title,c=e.shared,h=e.ariaLabel,p=e.onClick,d=e.iconName,v=e.imageAlt,m=c?u.default.sharedColumnSharedFieldText:void 0===c?"":u.default.sharedColumnPrivateFieldText,g=f||m;l=l||g;h=h||g;v=v||"";var y=!(!(d=d||"People")||!c);return r.createElement("div",{dir:"auto",className:""+s.sharedFieldRender,"data-is-focusable":!!p,title:l,onClick:p,role:p?"button":void 0,"aria-label":h},y?r.createElement(a.DeferredRender,{barrier:e.pageLoadBarrier},r.createElement(i.Icon,n.__assign({iconName:d},{alt:v}))):null,y&&" ",r.createElement("span",{className:o.css((t={},t[s.clickableSharedField]=!!p,t))},g))}});
define("@ms/items-view/lib/private/components/fields/sharedItem/SharedField.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".clickableSharedField_6ebc6df9{cursor:pointer}.clickableSharedField_6ebc6df9:hover{text-decoration:underline}.sharedFieldRender_6ebc6df9{text-decoration:none;text-overflow:ellipsis;overflow:hidden}\n"}]);t.clickableSharedField="clickableSharedField_6ebc6df9";t.sharedFieldRender="sharedFieldRender_6ebc6df9"});
define("@ms/items-view/lib/private/components/columns/fileSize/fileSizeColumn",["require","exports","react","../createColumn","../../../models/Facet","../columns.resx","../../../facets/ItemFacets","../../fields/fileSize/FileSizeField","../../../facets/GroupFacets","../../fields/baseText/BaseTextField","@ms/utilities-strings/lib/index","../../../models/items/ItemStrings.resx","../../../models/configuration/getConfiguration","../../../facets/ConfigurationFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fileSizeColumn=r.createColumn({key:new i.Facet("fileSizeColumn").id,name:s.default.FileSize,fieldName:"",minWidth:r.ColumnWidth.regularMin,maxWidth:r.ColumnWidth.regularMax,isCollapsable:!0},n.Fragment)(function(e,t){var r=e.demandItemFacet(o.fileSizeFacet,t),i=h.getConfiguration(e,{enableItemCountInFileSizeColumn:p.enableItemCountInFileSizeColumnFacet}).enableItemCountInFileSizeColumn;if(void 0===r&&i){if(e.demandItemFacet(o.folderFacet,t)){var s=e.demandItemFacet(a.countFacet,t);if(void 0!==s)return{children:n.createElement(f.BaseText,{text:l.format(l.getLocalizedCountValue(c.default.itemCountFormat,c.default.itemCountIntervals,s)||"",s)})}}}return{children:n.createElement(u.FileSizeField,{size:r})}},function(e,t){return""+e.demandItemFacet(o.fileSizeFacet,t)})});
define("@ms/items-view/lib/private/components/fields/fileSize/FileSizeField",["require","exports","react","@ms/items-view-utilities/lib/string/DriveSpaceHelper","../baseText/BaseTextField"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FileSizeField=function(e){var t=e.size,s=e.isDisabled,o=e.ariaLabel,u=void 0===t?"":r.default.getDisplayString(t,{ignoreZero:!0});o||(o=u);return n.createElement(i.BaseText,{text:u,isDisabled:s,ariaLabel:o})}});