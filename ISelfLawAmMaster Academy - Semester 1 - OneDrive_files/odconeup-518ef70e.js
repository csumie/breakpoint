define("odsp-next/controls/oneUp/OneUp",["require","exports","./OneUpViewModel","../../bindings/component/ControlBinding","./OneUp.html","./OneUp.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"ms-one-up",name:e("module").id,template:e("./OneUp.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/OneUpViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../resources/ControlResourceKeys","../../models/selection/ItemSetSelectionModel","./commandSets/OneUpCommandSet","./commandSets/OneUpCoreCommandSet","./commandSets/SlideshowCommandSet","../../models/command/set/UnionCommandSet","../../bindings/clientRect/ClientRectBinding","../../bindings/focus/ChildFocusBinding","../../bindings/keyboard/KeyboardBinding","../../bindings/throttledClick/ThrottledClickBinding","../../bindings/transclusion/host/TransclusionHostBinding","../../bindings/idle/IdleBinding","../../resources/PagesResourceKeys","../../providers/panel/PanelProvider","../../providers/transclusion/OverlayProvider.key","@ms/odsp-utilities/lib/string/StringHelper","./OneUp.resx","../infoPane/InfoPane.resx","../../utilities/ui/FullScreen","../../models/itemSet/ItemSet","../../models/itemSet/ItemSetContent","@ms/odsp-shared/lib/utilities/object/EqualityComparers","knockout","@ms/odsp-utilities/lib/locale/Locale","../../utilities/browser/ResponsiveUI","../overlays/host/OverlayHost","../dialogHost/DialogHost","../panelHost/PanelHost","./logging/OneUpCarousel.event","../../bindings/component/ControlBinding","../detailsPane/IsDetailsPaneExpanded","../detailsPaneHost/legacy/LegacyDetailsPaneHost.key","./OneUpSlide","./OneUpPriorityOptions","../carousel/Carousel","../transclusion/host/TransclusionHost","../sharing/share/commands/ShareCommandBuilder","../../utilities/features/Features","@ms/odsp-utilities/lib/events/EventGroup","./wrs/AccessibilityMode.key","../../bindings/aria/HideWhenInactiveBinding","../../providers/dialog/DialogProvider","./PaneProvider.key","./ToolbarProvider.key","../commandBar/CommandBar.key","../infoPane/FocusedInfoPaneSection.key","../../models/comments/ItemActivityCommentsFeature.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var G=w.strings,Y=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.overlayHostTagName=A.default.tagName;r.dialogHostTagName=O.default.tagName;r.panelHostTagName=M.default.tagName;r.carouselTagName=F.default.tagName;r.oneUpSlideTagName=B.default.tagName;r.addBindingHandlers({clientRect:l.default,keyboard:h.default,idle:v.default,throttledClick:p.default,control:D.default,childFocus:c.default,hideWhenInactive:W.default,transclusionHost:d.default});r._carouselEvent=new _.OneUpCarousel;r._carouselEventData={initialFileType:"",initialFileExtension:"",initialFileSize:0,pagesViewed:0,totalPages:0,isFolderShownInSession:!1};var o=n.rateLimitExtenders,u=void 0===o?{rateLimit:{timeout:0,method:"notifyWhenChangesStop"}}:o;r._rateLimitExtenders=u;var a=r,f=a.observables,b=a.resources;r.slideLoadState=f.create(0);var w=n.toolbarProvider;r.agentHost={name:I.default.tagName,params:{provider:w}};r.showAgent=f.pureCompute(function(){return w.contexts().length>0});var E=n.paneProvider;r.paneHost={name:I.default.tagName,params:{provider:E,useCustomTemplate:!0}};b.bind(q.shareFocusItemResourceKey);b.bind(q.copyLinkFocusItemResourceKey);b.expose(z.default,f.create(!1));b.bind(y.resourceKey);b.bind(g.resourceKey);b.bind(X.resourceKey);r.isSlideShowModeEnabled=f.create(!1);b.expose(i.slideshowState,r);r.addCaptionLabel=f.create("");r.isRotating=f.create(!1);r.isIdle=f.create(!1);r._actionMap=n.actionMap;r._initializeItem({item:n.focusItem});var S=n.currentItemSet;r._initializeItemSet({itemSet:n.focusItemSet||S});r._parent=f.pureCompute(function(){return r._itemSet().item()});b.block(i.currentSelectionModelGroup);r._selectionModel=b.expose(i.itemsSelection,new(r.managed(s.default))({indexResolver:n.indexResolver}));r.allocationRange=t.requiredRange;r.size=f.create({width:0,height:0});b.expose(m.base.infoPane.hidePreview,f.create(!0));b.bind(P.resourceKey);var x=r.isInfoPaneExpanded=b.consume(P.resourceKey);r._focusedInfoPaneSection=n.focusedInfoPaneSection;r.showPane=f.pureCompute(function(){return x()||E.contexts().length>0});r.isCommandBarVisible=f.create(!0);r.oneUp={currentPriority:f.createCallback(j.oneUpPriorityOptions),isRotating:r.isRotating,isCommandBarVisible:r.isCommandBarVisible,isInfoPaneExpanded:x,enableSlideControls:f.create(!1),size:r.size,slide:f.create(),shareLinkId:t.shareLinkId};var T={deferEvaluation:!0};r.canNavigate=f.pureCompute(r._computeCanNavigate,T);r.caption=f.pureCompute(r._computeCaption,T);r.showEditCaption=f.pureCompute(r._computeIsEditCaptionEnabled,T);r._dataManagerMapper=n.dataManagerMapper;r._areFlippersPermanent=f.pureCompute(function(){return r.items().length>1});r.legend=f.pureCompute(r._computeLegend,T);r._initializeActions();r.commandBarSpecification=D.toSpecification(J.resourceKey,{commandSet:r._getCommandSet(n),isMobile:!1});r._initializeOpenParentWhenEmpty();r.isIdleEnabled=f.pureCompute(r._computeIsIdleEnabled,T);r.isDetailsFocused=f.create(!1);r.isAwake=f.pureCompute(r._computeIsAwake,T);r.isPanningEnabled=f.pureCompute(r._computeIsPanningEnabled,T);var N=L.default.getScrollbarWidth()+"px";r.nextFlipperStyle={};r.nextFlipperStyle[k.default.safeRight]=N;r.previousFlipperStyle={};r.previousFlipperStyle[k.default.safeLeft]=N;r.detailsBarStyle=f.pureCompute(r._computeDetailsBarStyle,T);var C=f.pureCompute(function(){return r.slideLoadState()>=3});r.infoPaneSpecification=D.toSpecification(H.resourceKey,{showSections:C});t.isSlideshow&&f.compute(function(){t.isSlideshow(r.isSlideShowModeEnabled())}).extend({deferred:!0});var R=n.itemActivityFeedCommentsEnabled,U=n.viewParams&&n.viewParams.peek();if(R&&r._shouldShowActivityFeed(U)&&!r.isInfoPaneExpanded.peek()){var V=r._focusedInfoPaneSection;V&&V(9);r._showPropertiesAction.execute(null)}f.backgroundCompute(r._computeSetCaptionLabel);f.backgroundCompute(r._computeClearCaptionFocus);f.backgroundCompute(r._computeSelectItem);f.backgroundCompute(r._computeTriggerClientRectUpdate);f.backgroundCompute(r._computeCommandBarShownOnIdleFullScreen);f.backgroundCompute(r._computeIsFirstSlideOpened);f.backgroundCompute(r._computePagesViewed);return r}t.prototype.executeAction=function(e,t){if(e.isAvailable.peek()){e.execute(t);return!1}return!0};t.prototype.enterSlideshowMode=function(){S.default.enterFullScreen();if(this.isSlideShowModeEnabled.peek()){this._timeOutId=this.async.setTimeout(this._startSlideshow,3e3);return!0}return!1};t.prototype.exitSlideshowMode=function(){S.default.exitFullScreen();this.isSlideShowModeEnabled(!1);if(this._timeOutId){this.async.clearTimeout(this._timeOutId);return!0}return!1};t.prototype.onExitInfoPane=function(e){this.async.setTimeout(function(){C.removeNode(e)},500)};t.prototype.onContentClicked=function(e){var t=this.oneUp.slide,n=t&&t.peek();return!(!n||!n.isPanningEnabled.peek()||this.isSlideShowModeEnabled.peek())};t.prototype.toggleInfoPaneExpanded=function(e){this._showPropertiesAction.execute(e);return!1};t.prototype.editCaption=function(e){if(!this.isInfoPaneExpanded.peek()){var t=this._focusedInfoPaneSection;t&&t(1);this._showPropertiesAction.execute(e)}return!1};t.prototype.dispose=function(){var t=this.peekUnwrapObservable(this._itemSet);if(t){var n=t.content.peek();this._carouselEventData.totalPages=n.items.length}this._carouselEvent.end(this._carouselEventData);S.default.exitFullScreen();e.prototype.dispose.call(this)};t.prototype._startSlideshow=function(){this.isInfoPaneExpanded.peek()&&this.toggleInfoPaneExpanded(null);if(!this.isSlideShowModeEnabled.peek())return!1;this._timeOutId=this.async.setTimeout(this._startSlideshow,3e3);return!(!this.slideLoadState.peek()||this.executeAction(this._openNext,null))||void 0};t.prototype._initializeItemSet=function(e){var t=this,n=e.itemSet;this._sourceItemSet=n;var r,s=this.observables;this.index=s.pureCompute(this._computeIndex);this._isPlaceholderItemSetRequired=s.pureCompute(function(){var e=n();return(!e.content()||e.isPlaceholder)&&-1===t.index()},{deferEvaluation:!0});var o=s.pureCompute(function(){var e;if(t._isPlaceholderItemSetRequired()){(e=new x.default).item=n.peek().item;r&&r.dispose();r=s.compute(function(){var n=new T.default;n.items=[t.item()];e.content(n)})}else e=n();return e});o.equalityComparer=N.objectStrictEquality;var u=s.pureCompute(function(){return o().item()});u.equalityComparer=N.objectStrictEquality;this.resources.expose(i.currentItem,u);this._itemSet=this.resources.expose(i.currentItemSet,o);this.items=s.createArray();s.backgroundCompute(function(){t.items(t._itemSet().content().items)})};t.prototype._initializeItem=function(e){var t=this,n=e.item,r=this.observables,i=this.item=r.create();i.equalityComparer=N.objectStrictEquality;if(n){r.backgroundCompute(function(){i(n())});r.backgroundCompute(function(){if(i()!==n.peek()){var e=t._openCurrent;e.isAvailable.peek()&&e.execute(null).done()}}).extend(this._rateLimitExtenders)}};t.prototype._computeIndex=function(){var e=this.item(),t=this._sourceItemSet().content().items;return e?t.indexOf(e):-1};t.prototype._initializeActions=function(){var e=this,t=this.observables,r=t.pureCompute(function(){return t.unwrap(e.item())}),i=this._actionMap,s=this.managed(i.OpenAction),o={openRelation:2,focusUrl:!0,itemSet:this._itemSet,ignoreHistory:!0};this._openCurrent=new s(n.__assign({},o,{item:r}));this._openPrevious=new s(n.__assign({},o,{item:t.pureCompute(this._computePreviousItem)}));this._openNext=new s(n.__assign({},o,{item:t.pureCompute(this._computeNextItem)}));this.updateCaptionAction=new(this.managed(i.UpdateCaptionAction))({item:r});this._showPropertiesAction=new(this.managed(i.ShowPropertiesAction))({useToggleBehavior:!0})};t.prototype._computePreviousItem=function(){var e=this.index();if(!(e<0))for(var t=this.isSlideShowModeEnabled.peek(),n=this.items(),r=e-1;r>=0;r--){var i=this.unwrapObservable(n[r]);if(!t||i&&!i.video)return i}};t.prototype._computeNextItem=function(){var e=this.index();if(!(e<0)){for(var t=this.isSlideShowModeEnabled.peek(),n=this.items(),r=e+1,i=n.length;r<i;r++){var s=this.unwrapObservable(n[r]);if(!t||s&&!s.video)return s}t&&this.exitSlideshowMode()}};t.prototype._initializeOpenParentWhenEmpty=function(){var e=this,t=new(this.managed(this._actionMap.OpenAction))({openRelation:2,item:this._parent,ignoreHistory:!0}),n=this.observables,r=n.pureCompute(function(){var t=e._itemSet();t.content();return!t.isPlaceholder&&!t.item().isPlaceholder||t.item().error?e.items().length:r.peek()});n.backgroundCompute(function(){0===r()&&t.isAvailable.peek()&&t.execute(null)}).extend(this._rateLimitExtenders)};t.prototype._computeTriggerClientRectUpdate=function(){this.isInfoPaneExpanded();this.isCommandBarVisible();C.computedContext.isInitial()||this.async.setTimeout(function(){U.default.raise(document.body,"resize",void 0,!0)},500)};t.prototype._computeClearCaptionFocus=function(){!this.isInfoPaneExpanded()&&this._focusedInfoPaneSection&&this._focusedInfoPaneSection(null)};t.prototype._computeCommandBarShownOnIdleFullScreen=function(){S.default.isFullScreen()&&this.isCommandBarVisible(!this.isIdle())};t.prototype._computePagesViewed=function(){var e=this.oneUp.slide();if(e){this._carouselEventData.pagesViewed++;e.item&&e.item.peek()&&e.item.peek().folder&&(this._carouselEventData.isFolderShownInSession=!0)}};t.prototype._computeCanNavigate=function(){if(!R.isFeatureEnabled(R.RemoveOneUpSlideNavigation))return!0;var e=this.item.peek();if(!e){this.item();return!1}var t=e.peek();if(!t||t.isPlaceholder){e();return!1}return!!t.photo};t.prototype._computeIsFirstSlideOpened=function(){var e=this.oneUp.slide,t=e.peek();if(t){if(t.item){var n=t.item.peek();if(n){var r=this._carouselEventData;r.initialFileSize=n.size;r.initialFileType=n.iconName&&n.iconName.toLowerCase();r.initialFileExtension=n.extension&&n.extension.toLowerCase()}}t.isFirstSlideOpened(!0)}else e()};t.prototype._getCommandSet=function(e){var t=e.commandSet;return void 0===t?this._createSelectableCommandSet(e):t};t.prototype._createSelectableCommandSet=function(e){var t=this,n=e.oneUpCommandSet,r=void 0===n?new(this.managed(o.default)):n,i=e.slideshowCommandSet,s=void 0===i?new(this.managed(a.default)):i,l=this.observables,c=new(this.managed(u.default))({legend:this.legend,next:this._openNext,previous:this._openPrevious,areFlippersPermanent:this._areFlippersPermanent,canNavigate:this.canNavigate,parent:this._parent}),h=l.pureCompute(function(){var e=t.oneUp.slide();if(t.isSlideShowModeEnabled())return[s,c];var n=e&&e.commandSet();if(n)return[n,c];var i=e&&e.augmentCommandSet();return i?[r,i,c]:[r,c]});return new(this.managed(f.default))({commandSets:h})};t.prototype._computeDetailsBarStyle=function(){var e=this.oneUp.slide(),t=L.default.getScrollbarWidth(),n=e&&e.hasHorizontalScrollbar()?t:0,r=e&&e.hasVerticalScrollbar()?t:0,i={bottom:n+"px"};i[k.default.safeRight]=r+"px";return i};t.prototype._computeSetCaptionLabel=function(){var e=this.item(),t=e&&e.peek(),n=t&&t.photo?E.strings.captionAddCaption:E.strings.captionAddDescription;this.addCaptionLabel(n)};t.prototype._computeLegend=function(){var e=this.index(),t=this._dataManagerMapper,n=t&&t(),r=n?n.itemSet():this._itemSet(),i=n?n.getOriginalItemIndexByMappedIndex(e):e;return i>-1?b.format(G.legendFormat,i+1,r.content().items.length):""};t.prototype._computeCaption=function(){var e=this.unwrapObservable(this.item());return e&&e.caption};t.prototype._computeIsAwake=function(){return this.isDetailsFocused()||!this.isIdle()||!this.isIdleEnabled()};t.prototype._computeIsIdleEnabled=function(){var e=this.oneUp.slide();return!e||e.isIdleEnabled()};t.prototype._computeIsPanningEnabled=function(){if(!this.canNavigate())return!1;var e=this.oneUp.slide();return e&&e.isPanningEnabled()};t.prototype._computeIsEditCaptionEnabled=function(){var e=this.oneUp.slide();return e&&e.isEditCaptionEnabled()&&(this.updateCaptionAction.isAvailable()||!!this.caption())};t.prototype._computeSelectItem=function(){var e=this.item(),t=this._selectionModel;if(t.selection()[0]!==e){var n=t.getItemKey(e);t.setSelectedKeys([n])}};t.prototype._shouldShowActivityFeed=function(e){return e&&(e.commentId||e.Nav&&e.Nav.indexOf("commentId")>=0)};t.dependencies=n.__assign({},r.default.dependencies,{focusItem:i.focusItem.optional,focusItemSet:i.focusItemSet.optional,currentItemSet:i.currentItemSet.optional,indexResolver:i.selectionIndexResolver.optional,paneProvider:V.resourceKey,toolbarProvider:$.resourceKey,actionMap:i.actionMap,focusedInfoPaneSection:K.focusedInfoPaneSectionResourceKey.optional,dataManagerMapper:i.currentDataManagerMapper.optional,viewParams:i.viewParams,commandSet:void 0,oneUpCommandSet:void 0,slideshowCommandSet:void 0,rateLimitExtenders:void 0,itemActivityFeedCommentsEnabled:Q.resourceKey});return t}(r.default);t.default=Y});
define("odsp-next/controls/oneUp/commandSets/OneUpCommandSet",["require","exports","tslib","../../commands/BaseCommandSet","../../commands/Commands.resx","../../commands/PLTCommands.resx","../../commands/Command","../../../resources/ControlResourceKeys","../../../resources/SPOResourceKeys","../../../utilities/features/Features","../../../utilities/icons/Icon","../../../utilities/icons/OfficeFileNameHelper","../../../utilities/selection/SelectionHelper","../../fileHandler/FileHandlerCommands","../../../controls/sharing/share/commands/ShareCommandBuilder","../wrs/AccessibilityMode.key","../../../actions/accessibilityMode/AccessibilityModeAction","../../../controls/FabricIconsDeferred"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=i.strings,y=["S"],b=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._actionMap=n.resources.consume(u.actionMap);n._selection=n.resources.consume(u.itemsSelection);var r=n.resources.consume(a.pageContext.optional),c=n.scope.attach(new(n.resources.consume(p.typeResourceKey.local))({})),h=n.createPureComputed(n._computeOpenInOfficeOnlineText),b=n.createPureComputed(n._computeOpenInOfficeClientText),w=n.createPureComputed(n._computOpenInOfficeSuffixClass),E=n.createPureComputed(n._computeOfficeIcon),S=[new(n.managed(o.CommandViewModel))({text:h,renderLabel:2,icon:E,classSuffix:w,action:new(n.managed(n._actionMap.OpenInOfficeOnlineAction))}),new(n.managed(o.CommandViewModel))({text:b,renderLabel:2,icon:E,classSuffix:w,action:new(n.managed(n._actionMap.OpenInOfficeClientAction))})],x=[new(n.managed(o.CommandViewModel))({text:g.OpenInBrowser,renderLabel:2,icon:new l.default("PDF"),classSuffix:"PDF",action:new(n.managed(n._actionMap.OpenPdfInBrowserAction))}),new(n.managed(o.CommandViewModel))({text:g.OpenInTextEditor,renderLabel:2,icon:new l.default("Edit"),action:new(n.managed(n._actionMap.OpenInTextEditorAction))})],T=n.observables.createArray([]);n.createBackgroundComputed(function(){T.splice.apply(T,[0,T.peek().length].concat(S,c.openWithCommands(),x))});var N=n.createPureComputed(function(){for(var e={},t=0,n=T();t<n.length;t++){var r=n[t];if(r.isVisible()){var i=r.icon(),s=r.iconUrl();if(i&&"Page"!==i.toString()||s){e.icon=i;e.iconUrl=s;return e}}}e.icon=new l.default("Page");return e}),C=n.createPureComputed(function(){return N().icon}),k=n.createPureComputed(function(){return N().iconUrl}),L=r?f.isFeatureEnabled(f.ShareV3)?new(n.managed(d.default))({renderLabel:2,mode:0}).command:new(n.managed(o.CommandViewModel))({text:i.strings.Share,tooltip:i.strings.ShareCommandTooltipV3,renderLabel:2,icon:new l.default("Share"),action:f.isFeatureEnabled(f.UseNewSharingDialog)&&"21"===r.webTemplate?new(n.managed(n._actionMap.ShareByLinkAction))({sharingMethod:2}):new(n.managed(n._actionMap.ShareAction))({activeTab:1}),keys:y}):new(n.managed(o.CommandViewModel))({text:g.Share,renderLabel:2,icon:new l.default("Share"),action:new(n.managed(n._actionMap.ShareByLinkAction)),keys:y}),A=n.resources.consume(v.default);n.commands([new(n.managed(o.CommandViewModel))({text:g.Open,icon:C,iconUrl:k,classSuffix:w,renderLabel:2,requiredChildren:1,collapseSingleChildCommands:!1,location:3,children:T}),L,f.isFeatureEnabled(f.ShareV3)?new(n.managed(d.default))({renderLabel:2,mode:1}).command:new(n.managed(o.CommandViewModel))({text:i.strings.GetLink,renderLabel:2,icon:new l.default("Link"),action:new(n.managed(n._actionMap.GetLinkAction))({useOldSharingDialog:r&&"21"!==r.webTemplate})}),new(n.managed(o.CommandViewModel))({text:g.print,renderLabel:2,icon:new l.default("Print"),keys:["CtrlP"],action:new(n.managed(n._actionMap.PrintPdfAction))}),new(n.managed(o.CommandViewModel))({text:g.addToSharedList,renderLabel:2,icon:new l.default("Add"),action:new(n.managed(n._actionMap.AddToSharedListAction))}),new(n.managed(o.CommandViewModel))({text:g.removeFromSharedList,renderLabel:2,icon:new l.default("Cancel"),action:new(n.managed(n._actionMap.RemoveFromSharedListAction))}),new(n.managed(o.CommandViewModel))({text:g.AddToAlbum,icon:new l.default("Photo2Add"),renderLabel:2,action:new(n.managed(n._actionMap.AddToAlbumAction))({})}),new(n.managed(o.CommandViewModel))({text:g.playSlideshow,icon:new l.default("Play"),renderLabel:2,action:new(n.managed(n._actionMap.PlaySlideShowAction))({})}),new(n.managed(o.CommandViewModel))({text:g.rotate,icon:new l.default("rotate"),renderLabel:2,action:new(n.managed(n._actionMap.RotateAction))({})}),new(n.managed(o.CommandViewModel))({text:g.applyOfficeLens,renderLabel:2,icon:new l.default("LightningBolt"),action:new(n.managed(n._actionMap.ApplyOfficeLensAction))}),new(n.managed(o.CommandViewModel))({text:g.removeOfficeLens,renderLabel:2,icon:new l.default("Undo"),action:new(n.managed(n._actionMap.RemoveOfficeLensAction))}),new(n.managed(o.CommandViewModel))({text:g.Download,icon:new l.default("Download"),renderLabel:2,action:new(n.managed(n._actionMap.DownloadAction))({})}),new(n.managed(o.CommandViewModel))({text:g.DeleteItem,icon:new l.default("Delete"),renderLabel:2,action:new(n.managed(n._actionMap.DeleteAction))({})}),new(n.managed(o.CommandViewModel))({text:g.viewOriginal,icon:new l.default("Picture"),renderLabel:2,action:new(n.managed(n._actionMap.ViewOriginalAction))({})}),new(n.managed(o.CommandViewModel))({text:g.viewInFolder,icon:new l.default("Folder"),action:new(n.managed(n._actionMap.ViewInFolderAction)),renderLabel:2}),new(n.managed(o.CommandViewModel))({text:g.OrderPrints,icon:new l.default("Print"),renderLabel:2,action:new(n.managed(n._actionMap.OrderPrintsAction))({})}),new(n.managed(o.CommandViewModel))({text:g.Embed,icon:new l.default("Embed"),renderLabel:2,action:new(n.managed(n._actionMap.EmbedAction))({})}),new(n.managed(o.CommandViewModel))({text:g.editTags,renderLabel:2,icon:new l.default("Tag"),keys:["T"],action:new(n.managed(n._actionMap.EditTagsAction))}),new(n.managed(o.CommandViewModel))({renderLabel:2,text:n.createPureComputed(function(){return A()?g.ViewMode:g.AccessibilityMode}),icon:n.createPureComputed(function(){return A()?new l.default("Page"):new l.default("EaseOfAccess")}),action:new(n.managed(m.default))({accessibilityMode:A})}),new(n.managed(o.CommandViewModel))({text:g.Copy,renderLabel:2,icon:new l.default("Copy"),automationId:"copy",action:new(n.managed(n._actionMap.LaunchMoveCopyPanelAction))({isMove:!1})}),new(n.managed(o.CommandViewModel))({text:s.strings.ShowVersionHistory,renderLabel:2,icon:new l.default("StackIndicator"),action:new(n.managed(n._actionMap.ShowVersionHistoryAction))})].concat(r&&r.allowInfectedDownload?[new(n.managed(o.CommandViewModel))({text:i.strings.Download,renderLabel:2,icon:new l.default("Download"),action:new(n.managed(n._actionMap.ShowMalwareDetectedAction))({})})]:[],[c.actionsCommand,n.overflowHostCommand,new(n.managed(o.CommandViewModel))({tooltip:g.DetailsPane,icon:new l.default("Info"),location:12,action:new(n.managed(n._actionMap.ShowPropertiesAction))({useToggleBehavior:!0}),renderLabel:0,hasIconOnly:!0,keys:["I"],automationId:"showProperties"})]));return n}t.prototype._computeOpenInOfficeOnlineText=function(){return c.getOfficeOnlineStringMap(h.getSelectedItemApp(this._selection))||i.strings.Open};t.prototype._computeOpenInOfficeClientText=function(){return c.getOfficeStringMap(h.getSelectedItemApp(this._selection))};t.prototype._computOpenInOfficeSuffixClass=function(){return c.getOfficeAppFriendlyName(h.getSelectedItemApp(this._selection))};t.prototype._computeOfficeIcon=function(){var e,t=h.getSelectedItemApp(this._selection);t&&(e=c.getOfficeIconMap(t));return e||new l.default("Page")};return t}(r.default);t.default=b});
define("odsp-next/controls/fileHandler/FileHandlerCommands",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../commands/Command","../../utilities/icons/Icon","../../providers/fileHandler/FileHandlerProvider","../../actions/fileHandler/FileHandlerCreateAction","../../actions/fileHandler/FileHandlerCustomAction","../../actions/fileHandler/FileHandlerOpenAction","../../resources/ControlResourceKeys","../../resources/ProviderResourceKeys","../commands/Commands.resx","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,o=t.sourceEngagementName,u=t.item,a=t.includeLegacyActions;r._sourceEngagementName=o;r._overrideItem=u;var f=r.observables;r._legacyCommandMap=f.create({});r._commandViewModelType=r.managed(i.CommandViewModel);r._actionMap=n.actionMap;r._customActionProvider=n.customActionProvider;r._fileHandlerProvider=n.fileHandlerProvider;r._commonParams={renderLabel:2,location:10};a&&r._loadLegacyCommandMap();r._commandMap=f.pureCompute(r._computeCommandMap);r._fullCommandMap=f.pureCompute(r._computeFullCommandMap);r._flatten=f.pureCompute(r._computeFlatten);r.newFileCommands=f.pureCompute(r._computeNewFileCommands);r.openWithCommands=f.pureCompute(r._computeOpenWithCommands);var l=f.createArray(),c=r.scope.attach(l.filter(function(e){return e.isVisible()}));r.actionsCommand=new r._commandViewModelType({text:h.strings.Actions,icon:f.pureCompute(function(){return c().length>1?new s.default("SetAction"):void 0}),renderLabel:2,requiredChildren:1,collapseSingleChildCommands:!0,children:l});var p=f.pureCompute(r._computeCustomCommands);f.backgroundCompute(function(){l.splice.apply(l,[0,1/0].concat(p()))});return r}t.prototype._computeNewFileCommands=function(){var e=this._fileHandlerProvider;return e?e.data().actions.create.map(this._createNewFileCommand,this):[]};t.prototype._createNewFileCommand=function(e,t){var n=e.handler,r={text:e.handler.fileTypeDisplayName||p.format(h.strings.CreateFileWithExtension,e.availableOn.file.extensions[0]),action:new(this.managed(u.default))({fileHandlerAction:e}),renderLabel:2,engagementName:"FileHandlerCreate",source:this._sourceEngagementName};0===t&&(r.hasLineBreakBefore=!0);var i=this._fileHandlerProvider.getIconUrl(e.icon||n.fileTypeIcon);i?r.iconUrl=i:r.icon=new s.default("Page");return new this._commandViewModelType(r)};t.prototype._computeOpenWithCommands=function(){var e=this._fileHandlerProvider;return e?e.data().actions.open.map(this._createOpenFileCommand,this):[]};t.prototype._createOpenFileCommand=function(e){var t=e.handler,n={fileHandlerAction:e};this._overrideItem&&(n.item=this._overrideItem);var r={text:e.displayName||p.format(h.strings.OpenWithFileHandler,t.displayName),collapsedText:this.createObservable(h.strings.Open),action:new(this.managed(f.default))(n),renderLabel:2,engagementName:"FileHandlerOpen",source:this._sourceEngagementName,iconUrl:this._fileHandlerProvider.getIconUrl(e.icon||t.fileTypeIcon)};return new this._commandViewModelType(r)};t.prototype._computeCommandMap=function(){for(var e=this,t=this._fileHandlerProvider,r=t?t.data().actions.custom:[],i=this._commonParams,s={},o=this.observables,u=function(r){var u=r.handler,l=u.appId,c=s[l]||(s[l]=new f._commandViewModelType(n.__assign({},i,{iconUrl:t.getIconUrl(u.appIcon),text:u.actionMenuDisplayName||u.displayName,requiredChildren:1,collapseSingleChildCommands:!0}))),h=new f._commandViewModelType(n.__assign({},i,{text:o.pureCompute(function(){return!e._flatten()&&r.shortDisplayName||r.displayName}),collapsedText:o.create(r.displayName),iconUrl:t.getIconUrl(r.icon),action:new(f.managed(a.default))({fileHandlerAction:r}),engagementName:"FileHandlerCustom",source:f._sourceEngagementName}));c.children.push(h)},f=this,l=0,c=r;l<c.length;l++){u(c[l])}return s};t.prototype._loadLegacyCommandMap=function(){var e=this,t=this._customActionProvider,r=this._actionMap;t&&r&&t.getCustomActionData().then(function(i){var s={},o=[],u=i.ContextMenu;if(u&&0!==u.length){for(var a=e._commandViewModelType,f=e.managed(r.CustomActionNavigationAction),l=e.observables,c=e._commonParams,p=0,d=u;p<d.length;p++){var v=d[p],m=n.__assign({},c,{text:v.text});if(t.isGroup(v)){var g=v.children.map(function(e){return new a({text:e.text,engagementName:"CustomActionRibbonTab",iconUrl:e.iconUrl,renderLabel:2,action:new f({customAction:e})})});o.push(new a(n.__assign({},m,{tooltip:v.tooltip,requiredChildren:1,children:l.createArray(g)})))}else o.push(new a(n.__assign({},m,{iconUrl:v.iconUrl,engagementName:"CustomActionECB",action:new f({customAction:v})})))}s["Add-ins"]=new a(n.__assign({},c,{text:h.strings.AddIns,children:l.createArray(o),requiredChildren:1}));e._legacyCommandMap(s)}})};t.prototype._computeFullCommandMap=function(){return n.__assign({},this._commandMap&&this._commandMap()||{},this._legacyCommandMap&&this._legacyCommandMap()||{})};t.prototype._computeCustomCommands=function(){var e=this._fullCommandMap(),t=[],n=[],r=this._flatten();for(var i in e){for(var s=e[i],o=s.visibleChildren(),u=0,a=o;u<a.length;u++){var f=a[u];f.parentCommand=r?void 0:s;r&&(f.visibleChildren().length>1?t:n).push(f)}!r&&s.isVisible()&&(o.length>1?t:n).push(s)}return t.concat(n)};t.prototype._computeFlatten=function(){var e=this._fullCommandMap(),t=0,n=0,r=0;for(var i in e){var s=e[i].visibleChildren().length;s>1&&r++;s&&n++;t+=s;if(r>0&&n>1&&t>4)return!1}return!0};t.dependencies=n.__assign({},r.default.dependencies,{actionMap:l.actionMap.optional,customActionProvider:c.customAction.optional,fileHandlerProvider:o.resourceKey.optional});return t}(r.default);t.FileHandlerCommands=v;t.typeResourceKey=new d.ResourceKey({name:e("module").id,factory:new d.ResolvedResourceTypeFactory(v)});t.default=v});
define("odsp-next/actions/fileHandler/FileHandlerCreateAction",["require","exports","tslib","../../base/BaseItemAction","../../providers/item/ItemProvider","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/Promise","../../resources/DataSourceResourceKeys","../../resources/UtilityResourceKeys","../../dataSources/url/QueryType"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="FileHandlerCreate";n._fileHandlerAction=t.fileHandlerAction;n._itemProvider=n.resources.consume(i.resourceKey);n._urlDataSource=n.resources.consume(u.url);return n}t.prototype.onIsAvailable=function(){var e=this._urlDataSource.getKeyParams(this.item().key);return this._urlDataSource.isCurrentQuery(f.default.Files,e)};t.prototype.onExecute=function(e,t){var n=this,r=this._fileHandlerAction,i=r.availableOn.file.extensions[0].replace(".","");r.handler.isPromoted||(window.open("","_blank").opener=null);var u=this.item.peek().key;return this._itemProvider.createCustomDocument(u,i).then(function(e){return e?n.resources.consumeAsync(a.fileHandlerHelper).then(function(t){return t.invokeAction({items:[e],action:r})}):o.default.wrapError()}).then(function(){return o.default.wrap({resultType:s.ResultTypeEnum.Success})},function(e){return o.default.wrap({resultType:o.default.isCanceled(e)?s.ResultTypeEnum.ExpectedFailure:s.ResultTypeEnum.Failure})})};return t}(r.default);t.FileHandlerCreateAction=l;t.default=l});
define("odsp-next/actions/fileHandler/FileHandlerCustomAction",["require","exports","tslib","../../base/BaseAction","../../providers/fileHandler/FileHandlerProvider","@ms/odsp-utilities/lib/logging/events/Qos.event","../base/ItemSelectionHelper","@ms/odsp-utilities/lib/async/Promise","../../resources/UtilityResourceKeys"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="FileHandlerCustom";var r=t.fileHandlerAction;n._fileHandlerAction=r;n._fileHandlerProvider=n.resources.consume(i.resourceKey);var s=r.availableOn;n._itemSelectionHelper=new(n.child(o.typeResourceKey))({overrideItem:t.item,allowMultiSelect:!!s.allowMultiSelect,canFallback:!!s.folder});return n}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.selection();return!!e&&!!e.length&&e.every(this._acceptItemObservable,this)};t.prototype.onExecute=function(e){var t,n=this,r=this._fileHandlerAction;if(!r.handler.isPromoted){if(!(t=window.open("","_blank")))return u.default.reject({resultType:s.ResultTypeEnum.ExpectedFailure,resultCode:"window.open"});t.opener=null}return this._itemSelectionHelper.resolveSelection().then(function(e){n.resources.consumeAsync(a.fileHandlerHelper).then(function(n){return n.invokeAction({items:e,action:r,target:t})})}).then(function(){return u.default.wrap({resultType:s.ResultTypeEnum.Success})},function(e){return u.default.wrap({resultType:u.default.isCanceled(e)?s.ResultTypeEnum.ExpectedFailure:s.ResultTypeEnum.Failure})})};t.prototype._acceptItemObservable=function(e){var t=e.peek(),n=this._fileHandlerAction;return!!t.graph&&(t.folder?!!n.availableOn.folder&&!t.isRootFolder:this._fileHandlerProvider.isActionForExtension(n,t.extension))};return t}(r.default);t.FileHandlerCustomAction=f;t.default=f});
define("odsp-next/actions/fileHandler/FileHandlerOpenAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../base/ItemSelectionHelper","@ms/odsp-utilities/lib/async/Promise","../../providers/fileHandler/FileHandlerProvider","../../resources/UtilityResourceKeys"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="FileHandlerOpen";n._fileHandlerAction=t.fileHandlerAction;n._fileHandlerProvider=n.resources.consume(u.resourceKey);n._itemSelectionHelper=new(n.child(s.typeResourceKey))({overrideItem:t.item,allowMultiSelect:!1,canFallback:!1});return n}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(!e||!e.graph)return!1;var t=e.extension,n=this._fileHandlerProvider,r=this._fileHandlerAction;return r?n.isActionForExtension(r,t):!!n.getDefaultOpenHandler(t)};t.prototype.onExecute=function(e){var t,n=this,r=this._fileHandlerAction;if(!r||!r.handler.isPromoted){if(!(t=window.open("","_blank")))return o.default.reject({resultType:i.ResultTypeEnum.ExpectedFailure,resultCode:"window.open"});t.opener=null}return this._itemSelectionHelper.resolveFirst().then(function(e){return n.resources.consumeAsync(a.fileHandlerHelper).then(function(i){return i.invokeAction({items:[e],action:r||n._fileHandlerProvider.getDefaultOpenHandler(e.extension,!0),target:t})})}).then(function(){return o.default.wrap({resultType:i.ResultTypeEnum.Success})},function(e){return o.default.wrap({resultType:o.default.isCanceled(e)?i.ResultTypeEnum.ExpectedFailure:i.ResultTypeEnum.Failure})})};return t}(r.default);t.FileHandlerOpenAction=f;t.default=f});
define("odsp-next/controls/sharing/share/commands/ShareCommandBuilder",["require","exports","tslib","../../../../controls/commands/Command","../../../../controls/commands/Commands.resx","../../../../resources/ControlResourceKeys","../../../../utilities/features/Features","@ms/odsp-shared/lib/base/BaseModel","../../../../utilities/icons/Icon","../odb/Share.key","../../../../models/store/ItemsStore","../../../../base/ColorVariation","./ShareCommandKeys","@ms/odsp-shared-sharing/lib/interfaces/SharingInterfaces"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.shareFocusItemResourceKey=h.shareFocusItemResourceKey;t.copyLinkFocusItemResourceKey=h.copyLinkFocusItemResourceKey;t.copyFormLinkFocusItemResourceKey=h.copyFormLinkFocusItemResourceKey;t.shareFromDetailPaneFocusItemResourceKey=h.shareFromDetailPaneFocusItemResourceKey;var d=function(e){n.__extends(u,e);function u(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r,u=i.observables,a=i.resources,f=t.renderLabel,c=void 0===f?0:f,h=t.mode,p=t.item,d=t.engagementName;r._mode=h;r._overrideSelectedItem=p&&p.peek();r._overrideEngagementName=d;r._copyLinkShortcut=1===r._mode||3===r._mode;r._hideShareDialogOverflowButton=2===r._mode;r._actionMap=a.consume(s.actionMap);r._itemsStore=a.consume(l.resourceKey);if(o.isFeatureEnabled(o.ShareV3)){r._focusItemResourceKey=r._getShareItemResourceKey();r._itemBeingShared=a.consume(r._focusItemResourceKey);u.backgroundCompute(r._computeIsOpen)}r._renderLabel=c;r._initializeCommand();return r}u.prototype._initializeCommand=function(){var e=this._getCommandProperties();this.command=new(this.managed(r.CommandViewModel))(e)};u.prototype._computeIsOpen=function(){this._itemBeingShared()&&this.command.isOpen(!0)};u.prototype._computeShouldClearItem=function(){this.command.isOpen()||this._itemBeingShared(void 0)};u.prototype._resizeShare=function(){if(!this._registeredClear){this._registeredClear=!0;this.observables.backgroundCompute(this._computeShouldClearItem)}};u.prototype._dismissShare=function(){this._itemBeingShared(void 0)};u.prototype._getPayload=function(){var e=this,t=this.observables,n=this.createPureComputed(this._computeShareParams),r=this.createPureComputed(function(){return!!e._itemBeingShared()}),i=t.create();t.backgroundCompute(function(){r.peek()?e.trackPromise(e.resources.consumeAsync(f.default.local)).done(function(e){i(e)}):r()});return this.createPureComputed(function(){var e=i(),t=n();if(e&&t)return e.toSpecification(t)})};u.prototype._computeShareParams=function(){var e=this._itemBeingShared(),t=e?this._itemsStore.getItem(e.item.key):void 0;if(t)return{item:t,copyLinkShortcut:this._copyLinkShortcut,onDismiss:this._dismissShare.bind(this),onResize:this._resizeShare.bind(this),hideShareDialogOverflowButton:this._hideShareDialogOverflowButton,mode:4===this._mode?p.Mode.addPeople:void 0,scenarioId:e.scenarioId,defaultRecipients:e.defaultRecipients}};u.prototype._getShareItemResourceKey=function(){switch(this._mode){case 0:return t.shareFocusItemResourceKey;case 1:return t.copyLinkFocusItemResourceKey;case 2:return t.shareFromDetailPaneFocusItemResourceKey;case 3:return t.copyFormLinkFocusItemResourceKey;case 4:return h.shareFromGrantAccessItemResourceKey;default:return t.shareFocusItemResourceKey}};u.prototype._getCommandProperties=function(){var e={text:void 0,tooltip:void 0,icon:void 0,keys:void 0,action:void 0,payload:void 0,engagementName:void 0,renderLabel:this._renderLabel,enableRecoverFocusBinding:void 0,beakColor:void 0},t=o.isFeatureEnabled(o.ShareV3);if(4===this._mode){e.text=i.strings.grantAccess;e.icon=new a.default("PlayerSettings");e.tooltip=i.strings.grantAccessCommandLabel}else if(this._copyLinkShortcut){e.text=t?i.strings.CopyLinkCommandText:i.strings.GetLink;e.tooltip=i.strings.CopyLinkCommandTooltipV3;e.icon=new a.default("Link")}else{e.text=i.strings.Share;e.tooltip=i.strings.ShareCommandTooltipV3;e.icon=new a.default("Share");e.keys=["S"]}this._overrideEngagementName?e.engagementName=this._overrideEngagementName:this._copyLinkShortcut?e.engagementName="GetLink":e.engagementName="Share";if(t){e.action=new(this.managed(this._actionMap.ShowShareAction))({focusItemResourceKey:this._focusItemResourceKey,overrideItem:this._overrideSelectedItem});e.payload={control:this._getPayload(),timeout:36e5,announce:!1,autoDismiss:!0,preventDismissOnScroll:!0};e.enableRecoverFocusBinding=!1;e.beakColor=c.default.neutralLighterAlt}else this._copyLinkShortcut?e.action=new(this.managed(this._actionMap.GetLinkAction)):e.action=new(this.managed(this._actionMap.ShareByLinkAction))({sharingMethod:2});return e};return u}(u.default);t.default=d});
define("odsp-next/controls/sharing/share/odb/Share.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./Share"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("odsp-next/controls/sharing/share/commands/ShareCommandKeys",["require","exports","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/object/EqualityComparers","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){return{dependencies:{observablesFactoryType:n.observablesFactoryTypeResourceKey},create:function(t){var n=new(0,t.observablesFactoryType)({}),i=n.create();e&&(i.equalityComparer=r.objectStrictEquality);return{instance:i,disposable:n}}}};t.shareFocusItemResourceKey=new i.ResourceKey({name:e("module").id+".shareFocusItem",factory:s(!0)});t.copyLinkFocusItemResourceKey=new i.ResourceKey({name:e("module").id+".copyLinkFocusItem",factory:s()});t.copyFormLinkFocusItemResourceKey=new i.ResourceKey({name:e("module").id+".copyFormLinkFocusItem",factory:s()});t.shareFromDetailPaneFocusItemResourceKey=new i.ResourceKey({name:e("module").id+".copyLinkFocusItem",factory:s()});t.shareFromGrantAccessItemResourceKey=new i.ResourceKey({name:e("module").id+".shareFromGrantAccess",factory:s()});t.hasFollowedAnItemKey=new i.ResourceKey({name:e("module").id+".hasFollowedAnItemKey",factory:{dependencies:{observablesFactoryType:n.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})});
define("odsp-next/controls/oneUp/wrs/AccessibilityMode.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=new n.ResourceKey({name:e("module").id});t.default=r});
define("odsp-next/actions/accessibilityMode/AccessibilityModeAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../base/BaseAction","../../utilities/icons/OfficeFileNameHelper","../base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="AccessibilityMode";r._accessibilityMode=t.accessibilityMode;r._itemSelectionHelper=new(r.child(u.typeResourceKey))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&!!e.officeBundle&&e.appMap===o.wordType};t.prototype.onExecute=function(e,t){this._accessibilityMode(!this._accessibilityMode.peek());return r.default.resolve({resultType:i.ResultTypeEnum.Success})};return t}(s.default);t.default=a});
define("odsp-next/controls/oneUp/commandSets/OneUpCoreCommandSet",["require","exports","tslib","../../commands/BaseCommandSet","../../commands/Commands.resx","../../commands/Command","../../../resources/ControlResourceKeys","../../../utilities/icons/Icon","knockout","../../operation/commands/OperationCommandBuilder","@ms/odsp-utilities/lib/locale/Locale","../../pdfViewer/PdfViewer.resx","../../../actions/base/wrappers/ConditionalAction"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._legend=t.legend;n._actionMap=n.resources.consume(o.actionMap);var r=n.createPureComputed(function(){return!t.canNavigate()}),p=n.createPureComputed(function(){return t.canNavigate()&&t.areFlippersPermanent()}),d=new(n.managed(h.default))({action:t.previous,condition:t.canNavigate}),v=new(n.managed(h.default))({action:t.next,condition:t.canNavigate});n.commands.push(new(n.managed(f.default))({renderLabel:2}).command,new(n.managed(s.CommandViewModel))({text:c.strings.previousTooltip,icon:new u.default(l.default.isRightToLeft?"ChevronRight":"ChevronLeft"),renderLabel:2,location:12,isPermanent:p,isInvisibleWhenDisabled:!0,automationId:"previousButton",keys:[l.default.isRightToLeft?"Right":"Left"],action:d}),new(n.managed(s.CommandViewModel))({text:n._legend,location:12,automationId:"oneUpPageCount",isDisabled:a.observable(!0),isHidden:r}),new(n.managed(s.CommandViewModel))({text:c.strings.nextTooltip,icon:new u.default(l.default.isRightToLeft?"ChevronLeft":"ChevronRight"),renderLabel:2,location:12,positionIconRight:!0,isPermanent:p,isInvisibleWhenDisabled:!0,automationId:"nextButton",keys:[l.default.isRightToLeft?"Left":"Right"],action:v}),new(n.managed(s.CommandViewModel))({icon:new u.default("Cancel"),text:i.strings.Close,hasIconOnly:!0,renderLabel:0,action:new(n.managed(n._actionMap.OpenAction))({openRelation:2,ignoreHistory:!0,item:t.parent}),keys:["Esc"],location:12}));return n}return t}(r.default);t.default=p});
define("odsp-next/actions/base/wrappers/ConditionalAction",["require","exports","tslib","../../../base/BaseAction"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="Conditional";n.isQosLogged=!1;n._action=t.action;n._condition=t.condition;return n}t.prototype.onExecute=function(e,t){return this._action.execute(e)};t.prototype.onIsAvailable=function(){return this._condition()&&this._action.isAvailable()};return t}(r.default);t.default=i});
define("odsp-next/controls/oneUp/commandSets/SlideshowCommandSet",["require","exports","tslib","../../commands/BaseCommandSet","../../commands/Command","../../../utilities/icons/Icon","../../commands/Commands.resx","../../../resources/ControlResourceKeys","knockout"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=o.strings,l=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._actionMap=n.resources.consume(u.actionMap);n.commands=a.observableArray([new(n.managed(i.CommandViewModel))({text:f.pauseSlideshow,renderLabel:2,icon:new s.default("Pause"),action:new(n.managed(n._actionMap.StopSlideShowAction))({})})]);return n}return t}(r.default);t.default=l});
define("odsp-next/bindings/throttledClick/ThrottledClickBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.valueAccessor();n._callback=r.callback;n._delay=r.delay||500;n.events.on(n.element,"click",n._onClick);return n}t.prototype._onClick=function(e){if(this._timerID){this.async.clearTimeout(this._timerID);this._timerID=void 0}else this._timerID=this.async.setTimeout(this._onClickTimer,this._delay)};t.prototype._onClickTimer=function(){this._timerID=void 0;this._callback&&this._callback()};return t}(r.default);t.default=i});
define("odsp-next/bindings/idle/IdleBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","@ms/odsp-utilities/lib/math/Point","knockout","@uifabric/utilities/lib/dom"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=4e3,a=window.navigator,f=a&&a.pointerEnabled,l=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.valueAccessor();r._isIdle=i.isIdle||s.observable(!1);r._isEnabled=i.isEnabled||s.observable(!0);r._isInIdleZone=s.observable(!1);r._idleZoneElement=i.idleZoneElement||r.element;r._shouldClicksWake=i.shouldClicksWake;r._lastTouchPosition=null;r._lastMousePosition=null;r._lastPointerExitPosition=null;r._pointerCount=0;r._pointers={};r._isMouseDown=!1;r._isSuspended=!1;r._idle=r.createComputed(r._computeIdle).extend({rateLimit:{timeout:u,method:"notifyWhenChangesStop"}});r.createComputed(r._computeAwakenWhenNotEnabled);r.createComputed(r._computeSuspendIdleEvents);r.events.on(r._idleZoneElement,"click",r._onClick);r.events.on(document,"mousedown",r._onMouseDown,!0);r.events.on(document,"mousemove",r._onMouseMove,!0);r.events.on(document,"mouseup",r._onMouseUp,!0);r.events.on(document,"mouseout",r._onMouseOut,!0);r.events.on(document,"mousewheel",r._onMouseWheel,!0);r.events.on(window,"blur",r._onWindowBlur,!0);r.events.on(window,"focus",r._onWindowFocus,!0);if(f){r.events.on(document,"pointerdown",r._onPointerDown,!0);r.events.on(document,"pointermove",r._onPointerMove,!0);r.events.on(document,"pointerup",r._onPointerUp,!0);r.events.on(document,"pointercancel",r._onPointerCancel,!0);r.events.on(document,"lostpointercapture",r._onLostPointerCapture,!0)}else{r.events.on(document,"touchstart",r._onTouchStart,!0);r.events.on(document,"touchmove",r._onTouchMove,!0);r.events.on(document,"touchend",r._onTouchEnd,!0);r.events.on(document,"touchcancel",r._onTouchCancel,!0)}return r}t.prototype._computeIdle=function(){var e=this._isIdle(),t=this._isInIdleZone(),n=this._isEnabled();!e&&t&&n&&this._isIdle(!0)};t.prototype._computeAwakenWhenNotEnabled=function(){this._isEnabled()||this._isIdle(!1)};t.prototype._resetPosition=function(){this._lastMousePosition=null;this._lastTouchPosition=null};t.prototype._onClick=function(e){if(0===e.button){var t=this._lastMousePosition,n=new i.default(e.clientX,e.clientY);this._resetPosition();if(!(t&&n.distance(t)>=10)){this._isInIdleZone(!0);!this._isSuspended&&this._isEnabled.peek()&&(this._shouldClicksWake?this._isIdle(!1):this._isIdle(!this._isIdle.peek()))}}};t.prototype._onMouseDown=function(e){if(0===e.button){this._isMouseDown=!0;var t=new i.default(e.clientX,e.clientY);this._lastMousePosition=t}};t.prototype._onMouseMove=function(e){var t=this._lastTouchPosition,n=this._lastMousePosition,r=new i.default(e.clientX,e.clientY);if(!(t&&r.distance(t)<10)){var s=function(e,t){for(;e;){if(e===t)return!0;e=o.getParent(e)}return!1}(e.target,this._idleZoneElement);this._isInIdleZone(s);if(!this._isMouseDown&&!this._pointerCount&&n&&r.distance(n)>=10){this._resetPosition();!this._isSuspended&&this._isEnabled.peek()&&this._isIdle(!1)}this._lastMousePosition||(this._lastMousePosition=r)}};t.prototype._onMouseUp=function(e){0===e.button&&(this._isMouseDown=!1)};t.prototype._onMouseOut=function(e){if(!this._isMouseDown){var t=this._lastPointerExitPosition,n=new i.default(e.clientX,e.clientY);this._resetPosition();this._lastPointerExitPosition=null;if(!(t&&n.distance(t)<10)&&function(e){var t=e.relatedTarget||e.toElement;return!t||"HTML"===t.nodeName}(e)){var r=this._isInIdleZone.peek();this._isInIdleZone(!0);r&&this._idle()}}};t.prototype._onMouseWheel=function(e){this._isIdle(!1)};t.prototype._onWindowBlur=function(e){this._isIdle(!0)};t.prototype._onWindowFocus=function(e){this._isIdle(!1)};t.prototype._onTouchStart=function(e){this._pointerCount+=e.changedTouches.length;this._trackTouch(e);this._lastMousePosition=this._lastTouchPosition};t.prototype._onTouchMove=function(e){this._trackTouch(e)};t.prototype._onTouchEnd=function(e){this._pointerCount-=e.changedTouches.length;this._trackTouch(e)};t.prototype._onTouchCancel=function(e){this._pointerCount-=e.changedTouches.length};t.prototype._trackTouch=function(e){this._lastTouchPosition=new i.default(e.changedTouches[0].clientX,e.changedTouches[0].clientY)};t.prototype._onPointerDown=function(e){if("mouse"!==e.pointerType&&!this._pointers[e.pointerId]){this._pointerCount++;this._trackPointer(e);this._lastMousePosition=this._lastTouchPosition}};t.prototype._onPointerMove=function(e){"mouse"!==e.pointerType&&this._pointers[e.pointerId]&&this._trackPointer(e)};t.prototype._onPointerUp=function(e){if("mouse"!==e.pointerType){this._trackPointer(e);this._removePointer(e)}};t.prototype._onPointerCancel=function(e){if("mouse"!==e.pointerType){this._trackPointer(e);this._removePointer(e)}};t.prototype._onLostPointerCapture=function(e){"mouse"!==e.pointerType&&this._removePointer(e)};t.prototype._trackPointer=function(e){var t=new i.default(e.clientX,e.clientY);this._pointers[e.pointerId]=t;this._lastTouchPosition=t};t.prototype._removePointer=function(e){if(this._pointers[e.pointerId]){this._lastPointerExitPosition=this._pointers[e.pointerId];delete this._pointers[e.pointerId];this._pointerCount--}};t.prototype._computeSuspendIdleEvents=function(){this._isIdle();this._isSuspended=!0;this.async.clearTimeout(this._suspendIdleEventsTimeoutId);this._suspendIdleEventsTimeoutId=this.async.setTimeout(this._onSuspensionCompleted,500)};t.prototype._onSuspensionCompleted=function(){this._isSuspended=!1};return t}(r.default);t.default=l});
define("odsp-next/utilities/ui/FullScreen",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}e.isFullScreen=function(){var e=window.document;return e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement};e.enterFullScreen=function(){var t=window.document.body;e.isFullScreen()||(t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?t.msRequestFullscreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen&&t.webkitRequestFullscreen())};e.exitFullScreen=function(){var e=window.document;e.exitFullscreen?e.exitFullscreen():e.msExitFullscreen?e.msExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.webkitExitFullscreen&&e.webkitExitFullscreen()};e.isFullScreenAllowed=function(){var e=window.document;return e.fullscreenEnabled||e.webkitFullscreenEnabled||e.mozFullScreenEnabled||e.msFullscreenEnabled};return e}();t.default=n});
define("odsp-next/controls/oneUp/logging/OneUpCarousel.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OneUpCarousel=n.createPairedEvent({eventName:"OneUpCarousel,",shortEventName:"OneUpCarousel"},{initialFileType:1,initialFileExtension:1,initialFileSize:2,pagesViewed:2,totalPages:2,isFolderShownInSession:3});t.default=t.OneUpCarousel});
define("odsp-next/controls/oneUp/OneUpSlide",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./OneUpSlideViewModel","./OneUpSlide.html","./OneUpSlide.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.registerComponent({tagName:"od-one-up-slide",template:e("./OneUpSlide.html"),viewModel:r.default,synchronous:!0});t.default=i});
define("odsp-next/controls/oneUp/OneUpSlideViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../providers/engagement/Engagement","../../bindings/component/ControlBinding","../../utilities/features/Features","./3d/OneUp3d.key","./error/OneUpError","./fileHandler/OneUpFileHandler.key","./html/OneUpHtml","./image360/OneUpImage360.key","./other/OneUpOther","./panorama/OneUpPanorama.key","./photo/OneUpPhoto","./pdf/OneUpPdf.key","./textFile/OneUpTextFile.key","./thumbnail/OneUpThumbnail","./video/OneUpVideo.key","./wac/OneUpWAC.key","./wrs/OneUpWrs.key","./zip/OneUpZip.key","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../../providers/fileHandler/FileHandlerProvider","../../utilities/mime/MimeHelper","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var k={"3d":a.default,Audio:b.default,Error:f.default,FileHandler:l.default,Html:c.default,Other:p.default,Panorama:d.default,Image360:h.default,Pdf:m.default,Photo:v.default,TextFile:g.default,Thumbnail:y.default,Video:b.default,WAC:w.default,Wrs:E.default,Zip:S.default},L=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({control:o.default});r._offset=t.slide.offset;var i=r._oneUp=t.oneUp,s=t.renderOptions,a=r.observables,f=r._loadResult=a.createCallback({defaultValue:void 0,reducer:M});t.loadResult&&r.scope.attach(t.loadResult.register(f));r.slide={loadState:t.slide.loadState,offset:r._getSlideOffset(),item:t.slide.item,isIdleEnabled:a.create(!0),isEditCaptionEnabled:a.create(!1),isPanningEnabled:a.create(!s),hasHorizontalScrollbar:a.create(!1),hasVerticalScrollbar:a.create(!1),isFirstSlideOpened:a.create(!1),commandSet:a.create(),augmentCommandSet:a.create(),loadResult:f,renderOptions:s};var l=r.resources;r._fileHandlerProvider=l.consume(T.resourceKey.optional);var c=l.consume(C.platformDetection);r._enableHTML=u.isFeatureEnabled(u.UseSandboxHtmlViewer)&&("srcdoc"in HTMLIFrameElement.prototype||c.isEdge);r._enablePdf=u.isFeatureEnabled(u.UseWebPdfViewer);r._enableImage360=u.isFeatureEnabled(u.Image360Viewer)&&!c.isMobile;r._enablePriority=u.isFeatureEnabled(u.SlidePriority);var h=r.priority=a.pureCompute(r._computePriority);r.scope.attach(i.currentPriority.register(h));r.name=a.pureCompute(r._computeName);r.name.equalityComparer=x.objectStrictEquality;r.key=a.pureCompute(r._computeKey);r.key.equalityComparer=x.objectStrictEquality;r.component=a.pureCompute(r._computeComponent);r._qos=a.compute(r._computeQos);a.compute(r._computeUpdateOneUpSlide);a.backgroundCompute(r._computeCompleteQos);return r}t.prototype.dispose=function(){e.prototype.dispose.call(this);this._oneUp.slide.peek()===this.slide&&this._oneUp.slide(void 0)};t.prototype._computeComponent=function(){var e=this.key(),t={slide:this.slide,oneUp:this._oneUp};return e&&o.toSpecification(e.bypass,t)};t.prototype._computeName=function(){var e=this.slide.item(),t=this._extension(e),n=(this.slide.renderOptions||{}).viewer;return!e||e.isPlaceholder?void 0:e.error?"Error":3===e.itemStatus||e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected?"Other":n||(e.officeBundle?"Wrs":e.wopiFrameUrl?"WAC":this._hasFileHandler(e,t)?"FileHandler":this._enableHTML&&e.htmlConversion?"Html":this._enablePdf&&(".pdf"===t||".ai"===t||e.pdfConversion)?"Pdf":e.video?"Video":e.audio?"Audio":e.panorama?"Panorama":this._enableImage360&&e.image360?"Image360":e.model3d?"3d":e.zip?"Zip":this._useTextEditor(e)?"TextFile":e.photo?"Photo":e.thumbnail?"Thumbnail":"Other")};t.prototype._computeKey=function(){if(this._enablePriority){if(this.priority()<this._oneUp.currentPriority())return}var e=this.name();return e&&k[e]};t.prototype._computePriority=function(){var e=this.slide,t=e.loadState()>=3,n=e.offset(),r=(n>0?n:n<0?-n:0)+1;return t?r:-r};t.prototype._useTextEditor=function(e){return u.isFeatureEnabled(u.UseOneUpTextEditor)&&N.canOpenItemInMonaco(e)};t.prototype._extension=function(e){return e&&e.extension&&e.extension.toLowerCase()||""};t.prototype._hasFileHandler=function(e,t){var n=this._fileHandlerProvider;return!!n&&(!!e.graph&&!!n.getDefaultPreviewHandler(t))};t.prototype._computeUpdateOneUpSlide=function(){this._offset()?this._oneUp.slide.peek()===this.slide&&this._oneUp.slide(void 0):this._oneUp.slide(this.slide)};t.prototype._getSlideOffset=function(){var e=this,t=this.createPureComputed(function(){var n=t.peek();return void 0!==n&&e._oneUp.isRotating()?n:e._offset()});return t};t.prototype._computeQos=function(){var e=this.slide,t=this._qosValue,r=this.name();if(r){if(t&&t.loaded.data.extraData.viewer===r)return t;if(!e.offset()&&!(e.loadState()>0||e.loadResult())){var s=e.item.peek(),o=s.size,u=e.renderOptions,a=u&&u.qosEvent,f=n.__assign({},a&&a.data.extraData||{},{viewer:r,extension:this._extension(s),fileSize:o,fileSizeRange:A(o)});return this._qosValue={loaded:new i.Qos({name:"LoadSlide",extraData:f}),loaded2:new i.Qos({name:"ItemViewer."+r+".Load",extraData:f}),rendered:new i.Qos({name:"ItemViewer."+r+".Render",extraData:f})}}}};t.prototype._computeCompleteQos=function(){var e=this.slide;if(!e.offset()){var t=this._qos();if(t){var r=t.loaded,o=t.loaded2,u=t.rendered,a=this.name.peek(),f=e.item.peek(),l={extension:this._extension(f),fileSizeRange:A(f.size),viewer:a},c=this.key(),h=e.loadState();c&&h>=1&&u.end({resultType:i.ResultTypeEnum.Success,extraData:n.__assign({},u.data.extraData,l)});var p=this._loadResult();if(c&&p){var d=e.renderOptions,v=d&&d.qosEvent,m=n.__assign({},r.data.extraData,l,p.extraData||{}),g=n.__assign({},p,{extraData:m});r.end(g);o.end(g);v&&v.end(g);if(this._oneUp.shareLinkId){var y={};try{y.previewLoaded=Date.now();y.navigationStart=performance.timing.navigationStart;y.redirectStart=performance.timing.redirectStart;y.redirectEnd=performance.timing.redirectEnd}catch(e){}var b=n.__assign({},p,m,y,{slrid:this._oneUp.shareLinkId});this.resources.consume(s.resourceKey).logData({name:"ShareLinkClicked.PreviewLoaded",extraData:b})}}}}};return t}(r.default);t.default=L;function A(e){if(!e)return"NA";if(e<0)return"Unknown";var t=Math.log(e)/Math.LN2|0;return(1<<t%10)+"-"+(1<<t%10+1)+(t<10?" B":" "+"KMGTPEZY"[t/10-1|0]+"iB")}function O(e){e&&(e=(e=e.replace(/(tempauth|token|authkey)=[^&'"]+/g,"token=*")).replace(/[\w-]+:\/\/\S+/g,"*URI*"));return e}function M(e,t){return t&&n.__assign({},t,{error:O(t.error)})}});
define("odsp-next/controls/oneUp/3d/OneUp3d.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./OneUp3d"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/error/OneUpError",["require","exports","./OneUpErrorViewModel","../../../bindings/component/ControlBinding","./OneUpError.html"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-error",name:e("module").id,template:e("./OneUpError.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/error/OneUpErrorViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Qos.event","../OneUpContentViewModel","../../error/Error","../../../bindings/component/ControlBinding"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({control:o.default});var i=t.slide.item.peek(),u=i&&i.error&&i.error.data,a=t.slide.renderOptions,f=t.showErrorActions,l=void 0===f||f;r.errorComponent={specification:o.toSpecification(s.resourceKey,{error:u,hideAction:!!a||!l}),afterRender:function(){return r._activate()}};return r}t.prototype._activate=function(){var e=this.slide,t=e.item.peek(),n=t&&t.error&&t.error.data,i=this.observables.create({resultType:r.ResultTypeEnum.Failure,resultCode:""+n.errorCode,error:n&&n.errorDetailedText,extraData:{CorrelationId:n&&n.correlationId}});this.scope.attach(e.loadResult.register(i));e.loadState(3)};return t}(i.default);t.default=u});
define("odsp-next/controls/oneUp/OneUpContentViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.loadResultFromError=function(e){if(!e)return{resultCode:"unknown",resultType:i.ResultTypeEnum.Failure};var t=e.correlationId;return{resultCode:e.code||e.name,resultType:e.isExpected?i.ResultTypeEnum.ExpectedFailure:i.ResultTypeEnum.Failure,error:e.message||""+e,extraData:t?{CorrelationId:t}:{}}};var s=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.slide=t.slide;r.oneUp=t.oneUp;return r}return t}(r.default);t.default=s});
define("odsp-next/controls/oneUp/error/OneUpError.html",[],function(){return'<div class=OneUp-error data-bind="control: errorComponent"></div>'});
define("odsp-next/controls/oneUp/fileHandler/OneUpFileHandler.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./OneUpFileHandler"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/html/OneUpHtml",["require","exports","./OneUpHtmlViewModel","../../../bindings/component/ControlBinding","./OneUpHtml.html","./OneUpHtml.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-html",name:e("module").id,template:e("./OneUpHtml.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/html/OneUpHtmlViewModel",["require","exports","tslib","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/navigation/AddressWriter","@ms/odsp-utilities/lib/xhr/XHRPromise","../OneUpContentViewModel","../../../models/item/FileContentHelper","../../../bindings/iframe/IFrameBinding","../../../bindings/component/ControlBinding","../other/OneUpOther","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){n.__extends(t,e);function t(t,i){var s=e.call(this,t,i)||this;s.addBindingHandlers({control:c.default,iframe:l.default});var o=s,u=o.observables,a=o.slide,f=n.__assign({},a,{loadResult:u.createCallback(r.forSingleValue())}),p=i.platformDetection.isIOS;s.className=p?"iOS":"";s.showError=u.create(!1);s.showHtml=u.pureCompute(s._computeShowHtml);s.fallbackControl=c.toSpecification(h.default,{slide:f,oneUp:s.oneUp});s.iframeOptions=u.create();s._downloadDataSource=i.downloadDataSource;s._graphDataSource=i.graphDataSource;var d=s._loadResult=u.create();s.scope.attach(a.loadResult.register(d));s._populateContent(p);return s}t.prototype._computeShowHtml=function(){return!this.slide.offset()&&!!this.iframeOptions()};t.prototype._populateContent=function(e){var t=this,n=this.slide.item.peek();this.showError(!1);this.trackPromise(this._getContents(n).then(function(n){if(n)t.iframeOptions({type:"content",sandbox:v.isFeatureEnabled(v.OneUpHtmlAllowPopups)?"allow-popups":"",content:n,onLoad:function(n){t.slide.loadState(3);t._loadResult({resultType:s.ResultTypeEnum.Success});var r=n.target;if(e&&r){var i=r.clientWidth,o=r.clientHeight;r.style.width=i+"px";r.style.height=o+"px"}}});else{t._loadResult({resultType:s.ResultTypeEnum.ExpectedFailure,resultCode:"NoContent",error:"HTML is empty"});t._showError()}},function(e){t._loadResult({resultType:e&&e.isExpected?s.ResultTypeEnum.ExpectedFailure:s.ResultTypeEnum.Failure,resultCode:e&&(e.code||e.name),error:e&&e.message});t._showError()}))};t.prototype._showError=function(){this.showError(!0);this.slide.loadState(3)};t.prototype._getContents=function(e){var t=e.extension,n=e.htmlConversion,r=t&&t.toLowerCase();if(n&&!(".htm"===r||".html"===r||".svg"===r)){var s=this._graphDataSource,a=n.url||s.getAuthenticationParams(e).then(function(t){return s.getItemUrl(e,{useDirectEndpoint:!0})+"/content?format=html&"+o.serializeQuery(t)});return i.default.resolve(a).then(function(e){return u.default.startAndPostProcess({url:e},function(e,t){return e.responseText})}).catch(function(e){if(e instanceof XMLHttpRequest){var t=new Error("HTTP "+e.status),n=e.getResponseHeader("X-ErrorCode");t.code=""+(n||e.status);t.isExpected=406===e.status;return i.default.reject(t)}return i.default.reject(e)})}return this._downloadDataSource.getItemContents(e).then(function(e){return f.quickParse(e,"text/html")}).then(function(e){return e.text})};t.dependencies=n.__assign({},a.default.dependencies,{downloadDataSource:p.download,graphDataSource:p.graph,platformDetection:d.platformDetection});return t}(a.default);t.default=m});
define("odsp-next/models/item/FileContentHelper",["require","exports","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/async/Promise","@ms/utilities-error/lib/ApiError"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fullParse=function(e,t,n){return r.default.all([o(e),o(e,n)]).then(function(e){var n=e[0],r=e[1],i=r.length>n.length;return{text:i?n:r,mimeType:t,isSafeText:i||s(r)}},function(e){return e.filter(function(e){return!r.default.isCanceled(e)})[0]||e[0]})};t.quickParse=function(e,t){return o(e).then(function(e){return{text:e,mimeType:t,isSafeText:!0}})};function s(e){for(var t=0;t<e.length;t++)if(!(n=e.charCodeAt(t),n<127||u[n]))return!1;var n;return!0}function o(e,t){var r=new n.default,s=new FileReader;s.onload=function(){r.complete(s.result||"")};s.onerror=function(e){var t=s.error;r.error(new i.ApiError({code:t&&(t.name||"Parse."+t.code)||"Parse",isExpected:!1,message:t&&t.message||"Parsing error"}))};s.readAsText(e,t);return r.getPromise()}var u={130:1,132:1,133:1,134:1,135:1,137:1,139:1,145:1,146:1,147:1,148:1,149:1,150:1,151:1,153:1,155:1,160:1,166:1,167:1,169:1,171:1,172:1,173:1,174:1,176:1,177:1,181:1,182:1,183:1,187:1}});
define("odsp-next/bindings/iframe/IFrameBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","knockout","../../actions/NavigateViaPost"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;n.createComputed(n._computeUpdate);return n}t.prototype._computeUpdate=function(){var e=this,t=this.unwrapObservable(this.valueAccessor());if(t){var n,r,o;switch(t.type){case"get":if(t.url){o=!0;r=function(e){e.src=t.url}}break;case"content":o=!0;r=function(n){if("srcdoc"in HTMLIFrameElement.prototype)n.srcdoc=t.content;else{var r=new Blob([t.content],{type:"text/html"}),i=window.URL.createObjectURL(r);e.scope.attach({dispose:function(){window.URL.revokeObjectURL(i)}});n.src=i}};break;case"post":if(t.url){o=!0;n=function(e){s.navigateViaPost({url:t.url,postdata:t.postdata,document:e.contentDocument})}}}var u=o&&(this._iframe||document.createElement("iframe"));!function(e,t){if(e){t.className&&(e.className=t.className);t.title&&(e.title=t.title);t.role&&e.setAttribute("role",t.role);"string"==typeof t.sandbox&&e.setAttribute("sandbox",t.sandbox);e.frameBorder="0"}}(u,t);r&&r(u);if(u&&!this._iframe){this._iframe=u;this.events.on(u,"load",this._onLoad);i.virtualElements.setDomNodeChildren(this.element,[u]);i.utils.domNodeDisposal.addDisposeCallback(u,function(){e.events.off(u,"load",e._onLoad);!function(e){e.src="";e.srcdoc=""}(u)})}n&&n(u);if(u);else{i.virtualElements.emptyNode(this.element);this._iframe=void 0}}else{i.virtualElements.emptyNode(this.element);this._iframe=void 0}};t.prototype._onLoad=function(e){var t=this.peekUnwrapObservable(this.valueAccessor());t.onLoad&&t.onLoad(e)};t.supportsVirtualElements=!0;return t}(r.default);t.IFrameBinding=o;t.default=o});
define("odsp-next/actions/NavigateViaPost",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.navigateViaPost=function(e){var t=e.document;t.body||t.createElement("body");var n=t.createElement("form");n.action=e.url;n.method="POST";n.style.visibility="hidden";n.target="_self";var r=e.postdata;for(var i in r){var s=t.createElement("input");s.type="hidden";s.name=i;s.value=r[i];n.appendChild(s)}t.body.appendChild(n);n.submit()}});
define("odsp-next/controls/oneUp/other/OneUpOther",["require","exports","./OneUpOtherViewModel","../../../bindings/component/ControlBinding","./OneUpOther.html"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-other",name:e("module").id,template:e("./OneUpOther.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/other/OneUpOtherViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/string/StringHelper","../../../bindings/activate/ActivateBinding","../../../bindings/component/ControlBinding","../OneUpContentViewModel","../OneUp.resx","../../fileTypeIcon/FileTypeIcon","./commands/ItemActionBar.key","../../../models/malwareDetection/MalwareDetection.key","../../../utilities/browser/WebViewDetector","../../../dataSources/url/QueryType","../../../models/item/ItemType"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=96,m='<a href="https://go.microsoft.com/fwlink/?linkid=862871" target="_blank">',g="</a>",y=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.strings=a.strings;r.addBindingHandlers({activate:s.default,control:o.default});var u=t.slide.renderOptions,c=t.showActions,p=void 0===c?!u||!u.hideDownload:c;r._isOneDriveWinApp=h.isOneDriveWinApp();r.showActions=r._isOneDriveWinApp?r.showActionInOneDriveWinApp(t.slide.item().queryType,t.slide.item().type):p;r._allowInfectedDownload=n.allowInfectedDownload;r.malwareDetectedSvgUrl=window.require.toUrl("odsp-media/images/atp/malware_icon_208x208.svg");r.malwareDetectedIconAlt=a.strings.malwareDetectedIconAriaLabel;r.itemMalwareDetected=r.createPureComputed(function(){var e=t.slide.item();return e.lifeCycleStatus&&e.lifeCycleStatus.isMalwareDetected},{deferEvaluation:!0});r.fileTypeIconTagName=f.default.tagName;r.fileName=r.createPureComputed(function(){var e=t.slide.item();return e.displayName||e.name},{deferEvaluation:!0});r.fileTypeIconViewModelParams=r.createPureComputed(function(){var e=t.slide.item();return{iconName:e.iconName,iconUrl:e.iconUrl,extension:e.extension,desiredSize:v}},{deferEvaluation:!0});r.actionBarControl=o.toSpecification(l.resourceKey,{forceExternal:!!u,item:t.slide.item,hideOpenCommand:r.itemMalwareDetected});r.message=r.createPureComputed(function(){var e=t.slide.item();return r.itemMalwareDetected()?r._allowInfectedDownload?i.format(a.strings.malwareDetectedAllowDownloadMessage,m,g):i.format(a.strings.malwareDetectedMessage,m,g):3===e.itemStatus?a.strings.blockedByPolicy:a.strings.notPreviewAvaible});return r}t.prototype.activate=function(){var e=this.observables.create({resultType:r.ResultTypeEnum.ExpectedFailure,resultCode:"Fallback",error:"Fallback viewer loaded"}),t=this.slide;this.scope.attach(t.loadResult.register(e));t.loadState(3)};t.prototype.showActionInOneDriveWinApp=function(e,t){return e===p.default.SharedWithMe||t===d.default.Folder||t===d.default.Unknown||t===d.default.OneNote||t===d.default.File||t===d.default.Media};t.dependencies=n.__assign({},u.default.dependencies,{allowInfectedDownload:c.allowInfectedFileDownloadsResourceKey});return t}(u.default);t.default=y});
define("odsp-next/bindings/activate/ActivateBinding",["require","exports","knockout"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.init=function(e,t,r,i,s){var o=n.utils.unwrapObservable(t()),u=o&&o.activate||o;u&&u.call(s.$data,e)};e.supportsVirtualElements=!0;return e}();t.default=r});
define("odsp-next/controls/oneUp/other/commands/ItemActionBar.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemActionBar"],t,n)}).then(function(e){return e.resourceKey.local})})})});
define("odsp-next/models/malwareDetection/MalwareDetection.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.allowInfectedFileDownloadsResourceKey=new n.ResourceKey({name:e("module").id+".allowInfectedFileDownloads",factory:new n.ConstantResourceFactory(!1)})});
define("odsp-next/controls/oneUp/other/OneUpOther.html",[],function(){return'<div class=OneUp-other data-bind="activate: $component.activate.bind($component)"><div class=OneUp-other-content>\x3c!--ko if: itemMalwareDetected()--\x3e<div><img class=OneUp-other-malwareDetectedIcon data-bind="attr: { src: malwareDetectedSvgUrl, alt: malwareDetectedIconAlt }"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: itemMalwareDetected()--\x3e<div class=OneUp-other-fileIcon data-bind="component: { name: fileTypeIconTagName, params: fileTypeIconViewModelParams }"></div>\x3c!--/ko--\x3e<div class=OneUp-other-fileName data-bind="text: fileName"></div><div class=OneUp-other-message data-bind="html: message"></div>\x3c!--ko if: showActions--\x3e<div class=OneUp-other-actions data-bind="control: actionBarControl"></div>\x3c!--/ko--\x3e</div></div>'});
define("odsp-next/controls/oneUp/html/OneUpHtml.html",[],function(){return'\x3c!--ko if: showError--\x3e\x3c!--ko control: fallbackControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: showHtml--\x3e<div class=OneUp-html data-bind="iframe: iframeOptions, class: className" style="-webkit-overflow-scrolling: touch"></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/oneUp/html/OneUpHtml.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".OneUp-html{position:absolute;top:0;left:0;right:0;bottom:0;margin:20px 20px;-webkit-overflow-scrolling:touch}.OneUp-html.iOS{overflow:auto}.OneUp-html iframe{width:100%;height:100%;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border:0;box-shadow:0 0 7px 2px rgba(0,0,0,.15);overflow:auto;-webkit-overflow-scrolling:touch}"}])});
define("odsp-next/controls/oneUp/image360/OneUpImage360.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./OneUpImage360"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/panorama/OneUpPanorama.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./OneUpPanorama"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/photo/OneUpPhoto",["require","exports","./OneUpPhotoViewModel","../../../bindings/component/ControlBinding","./OneUpPhoto.html"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-photo",name:e("module").id,template:e("./OneUpPhoto.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/photo/OneUpPhotoViewModel",["require","exports","tslib","../../../bindings/component/ControlBinding","../../projector/Projector","../thumbnail/OneUpThumbnail","../OneUpContentViewModel","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t,n){var s=e.call(this,t,n)||this;s.addBindingHandlers({control:r.default});s.slide.isEditCaptionEnabled(!0);var o=t.item,u=void 0===o?s.slide.item:o;s._item=u;s._isZoomed=s.createObservable(!1);var a={isEnabled:s.createPureComputed(function(){return!s.slide.offset()&&!s.oneUp.isRotating()}),isZoomed:s._isZoomed};s.projector={name:i.default.tagName,params:a};s.createBackgroundComputed(s._computeChangesOnZoom);return s}t.prototype.getThumbnailControl=function(e){var t=this,n=e.transform,i=e.isGliding,o=this.createPureComputed(function(){return n().scale}),a=this.createPureComputed(function(){var e=t.oneUp.size();return{width:e.width*n().scale,height:e.height*n().scale}});a.equalityComparer=u.deepCompare;var f=this.createPureComputed(function(){return!i()});return r.toSpecification(s.default,{slide:this.slide,oneUp:this.oneUp,size:a,scale:o,fallbackThumbnail:this.createPureComputed(this._computeFallbackThumbnail),allowLoading:f,item:this._item})};t.prototype._computeFallbackThumbnail=function(){var e=this._item().photo;if(e){var t=e.originalUrl,n=e.width,r=e.height;if(t)return{url:t,width:n,height:r}}};t.prototype._computeChangesOnZoom=function(){var e=this._isZoomed();this.slide.isPanningEnabled(!e)};return t}(o.default);t.default=a});
define("odsp-next/controls/projector/Projector",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ProjectorViewModel","./Projector.html","./Projector.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.registerComponent({tagName:"od-projector",template:e("./Projector.html"),viewModel:r.default,synchronous:!0});t.default=i});
define("odsp-next/controls/projector/ProjectorViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../bindings/host/HostBinding","../../bindings/pan/PanBinding","../../bindings/clientRect/ClientRectBinding","@ms/odsp-utilities/lib/math/Transform","@ms/odsp-utilities/lib/math/Rectangle","@ms/odsp-utilities/lib/math/Size","@ms/odsp-utilities/lib/math/Point","@ms/odsp-shared/lib/utilities/knockout/Extenders"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h,p=new a.default(0,0,1,1),d=p.getCenter(),v=.5,m=!0;!function(e){e[e.live=0]="live";e[e.preview=1]="preview"}(h=t.ProjectorMode||(t.ProjectorMode={}));var g=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.addBindingHandlers({host:i.default,pan:s.default,clientRect:o.default});var a=t.isZoomed,f=void 0===a?r.createObservable(!1):a,l=t.isEnabled,p=void 0===l?r.createObservable(!0):l,d=t.mode,v=void 0===d?h.live:d;r.panTransform=r.createObservable(u.default.IDENTITY);r.panTransform.equalityComparer=s.areTransformsEqual;r.contentTransform=r.createObservable(u.default.IDENTITY);r.contentTransform.equalityComparer=s.areTransformsEqual;r.imageTransform=r.createObservable(u.default.IDENTITY);r.imageTransform.equalityComparer=s.areTransformsEqual;r.isPanning=r.createObservable(!1);r.isGliding=r.createObservable(!1);r.isZoomed=f;r.isEnabled=p;r.size=r.createObservable();r._lastZoomTogglePosition=null;r._mode=v;r.mode=h[r._mode];r.createBackgroundComputed(r._computeResetGlide);r.createBackgroundComputed(r._computePreviewTransform);r.createBackgroundComputed(r._computeCommitTransform);var m=r.createBackgroundComputed(r._computeStartGlide);r.createBackgroundComputed(r._computeEndGlide).extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}});var g=r.createBackgroundComputed(r._computeApplyTransformOnZoomed);r.createBackgroundComputed(r._computeResetZoomOnTransformed);r.imageStyle=r.createPureComputed(r._computeImageStyle,{deferEvaluation:!0});if(!n||!n.disableFrameSkip){c.skipAnimationFrame(m,r.async);c.skipAnimationFrame(g,r.async)}r.host={transform:r._mode===h.live?r.panTransform:r.contentTransform,isGliding:r.isGliding};return r}t.prototype.toggleIsZoomed=function(e,t){var n=this.size.peek(),r=n&&new l.default(t.clientX/n.width,t.clientY/n.height)||d;this._lastZoomTogglePosition=r;this.isZoomed(!this.isZoomed())};t.prototype.mayStartPan=function(e,t,n){return this.isEnabled.peek()&&(Math.abs(t)>=10&&n.length>=2||this.isZoomed.peek()&&e.translate.abs()>=10)};t.prototype.constrainPanScale=function(e){return Math.max(1,Math.min(4,e))};t.prototype._computeResetGlide=function(){if(this.isPanning()){this.isGliding(!1);this.isZoomed(!0)}};t.prototype._computePreviewTransform=function(){if(this.isPanning()){var e=this.panTransform();e=y(e,!0);this.imageTransform(this.contentTransform().invert().multiply(e))}};t.prototype._computeCommitTransform=function(){if(!this.isPanning()&&!this.isGliding.peek()){var e=this.panTransform.peek();e=e.scale<u.default.IDENTITY.scale?u.default.IDENTITY:y(e);this._applyTransform(e)}};t.prototype._computeStartGlide=function(){if(!this.isPanning()&&!u.default.areEqual(this.imageTransform(),u.default.IDENTITY)){this.isGliding(!0);this.imageTransform(u.default.IDENTITY)}};t.prototype._computeEndGlide=function(){var e=this.isPanning(),t=this.isGliding();!e&&t&&this.isGliding(!1)};t.prototype._computeApplyTransformOnZoomed=function(){var e=this.isZoomed(),t=this.isEnabled(),n=this.isPanning.peek(),r=this.contentTransform.peek();n||(e&&t?u.default.areEqual(r,u.default.IDENTITY)&&this._applyTransform(u.default.zoom(l.default.ORIGIN,this._lastZoomTogglePosition||d,3)):u.default.areEqual(r,u.default.IDENTITY)||this._applyTransform(u.default.IDENTITY));this._lastZoomTogglePosition=null};t.prototype._computeResetZoomOnTransformed=function(){var e=this.isPanning(),t=this.contentTransform();!e&&u.default.areEqual(t,u.default.IDENTITY)&&this.isZoomed(!1)};t.prototype._computeImageStyle=function(){var e=this.contentTransform(),t=this.imageTransform();if(this._mode===h.live){var n=e.multiply(t);return{left:100*n.translate.x+"%",top:100*n.translate.y+"%",width:100*n.scale+"%",height:100*n.scale+"%"}}var r="translate("+100*t.translate.x+"%, "+100*t.translate.y+"%)";return{left:100*e.translate.x+"%",top:100*e.translate.y+"%",width:100*e.scale+"%",height:100*e.scale+"%","-ms-transform":r,"-webkit-transform":r,transform:r}};t.prototype._applyTransform=function(e){var t=this.contentTransform.peek().multiply(this.imageTransform.peek());this.contentTransform(e);this.imageTransform(e.invert().multiply(t));this.panTransform(e)};return t}(r.default);t.default=g;function y(e,t){void 0===t&&(t=!1);var n=Math.max(u.default.IDENTITY.scale,e.scale),r=new a.default(e.apply(d).subtract(new l.default(n,n).scale(v)),new f.default(n,n)),i=p,s=i.nudge(r),o=i.getCenter().subtract(s.getCenter());t&&m&&(o=o.unit().scale(o.abs()-Math.atan(Math.PI*o.abs())/Math.PI*Math.log(e.scale/u.default.IDENTITY.scale)));return new u.default(o).multiply(e)}});
define("odsp-next/controls/projector/Projector.html",[],function(){return"<div class=od-Projector data-bind=\"class: 'od-Projector--' + mode, css: { 'od-Projector--gliding': isGliding, 'od-Projector--panning': isPanning }, pan: { isActive: isPanning, transform: panTransform, mayStartPan: $component.mayStartPan.bind($component), constrainScale: $component.constrainPanScale.bind($component) }, clientRect: { size: size }, event: { dblclick: $component.toggleIsZoomed.bind($component) }\"><div class=od-Projector-image data-bind=\"style: imageStyle, host: { data: host }\"></div></div>"});
define("odsp-next/controls/projector/Projector.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-Projector{position:absolute;left:0;top:0;width:100%;height:100%;overflow:hidden}.od-Projector-image{position:absolute;left:0;top:0;width:100%;height:100%;-ms-transform-origin:0 0;transform-origin:0 0;-ms-touch-action:none;touch-action:none;will-change:transform;-webkit-backface-visibility:hidden;backface-visibility:hidden;perspective:1000}.od-Projector--gliding.od-Projector--preview .od-Projector-image{transition:transform 267ms cubic-bezier(.1,.9,.2,1)}.od-Projector--gliding.od-Projector--live .od-Projector-image{transition:left 267ms cubic-bezier(.1,.9,.2,1),top 267ms cubic-bezier(.1,.9,.2,1),width 267ms cubic-bezier(.1,.9,.2,1),height 267ms cubic-bezier(.1,.9,.2,1)}"}])});
define("odsp-next/controls/oneUp/thumbnail/OneUpThumbnail",["require","exports","./OneUpThumbnailViewModel","../../../bindings/component/ControlBinding","./OneUpThumbnail.html","../../image/frame/ImageFrame"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-thumbnail",name:e("module").id,template:e("./OneUpThumbnail.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/thumbnail/OneUpThumbnailViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/Rotation","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-shared/lib/models/image/Alignments","@ms/odsp-shared/lib/utilities/knockout/Extenders","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../bindings/component/ControlBinding","../../image/frame/ImageFrame","../other/OneUpOther","../OneUpContentViewModel","@ms/utilities-error/lib/ApiError","../../../utilities/features/Features","@ms/utilities-objects/lib/areShallowEqual"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(e){n.__extends(t,e);function t(t,r){var s=e.call(this,t,r)||this;s.addBindingHandlers({control:a.default});s.thumbnailTagName=f.default.tagName;var u=s,c=u.observables,h=u.slide,v=t.slide.renderOptions,m=t.scale,g=void 0===m?c.create(1):m,y=t.size,b=void 0===y?s.oneUp.size:y,w=t.allowLoading,E=void 0===w?c.create(!0):w,S=t.fallbackThumbnail,x=t.showErrorActions,T=void 0===x?!v||!v.hideDownload:x,N=t.allowError,C=void 0===N||N,k=t.item,L=void 0===k?h.item:k,A=t.isPreview;s._item=L;s._scale=g;s._size=b;s._fallbackThumbnail=S;s._allowError=c.wrap(C);s._isLoaded=c.create(!1);s._isRendered=c.create(!1);c.backgroundCompute(s._updateSlideLoadState);s._image=c.pureCompute(s._computeImage);s._image.equalityComparer=d.areShallowEqual;s._desiredSize=c.pureCompute(s._computeDesiredSize);s._desiredSize.equalityComparer=d.areShallowEqual;s._rotation=c.pureCompute(s._computeRotation);s._markAccess=p.isFeatureEnabled(p.ReportOneUpFileAccess)&&c.pureCompute(function(){return!A&&!h.offset()});s._error=c.create();s._fadeIn=c.pureCompute(function(){return Math.abs(s.slide.offset())<2});s._allowLoading=c.pureCompute(function(){var e=E(),t=s.oneUp.isRotating();return e&&!t});s._coverage=o.withComparer(c.pureCompute(s._computeImageFrameCoverage),d.areShallowEqual);s.hasThumbnail=c.pureCompute(s._computeHasThumbnail);s.thumbnailParams=c.pureCompute(s._computeThumbnailParams);s.hasError=c.pureCompute(s._computeHasError);var O=n.__assign({},t,{showActions:T,slide:n.__assign({},t.slide,{loadResult:c.createCallback(i.forSingleValue())})});s.fallbackControl=a.toSpecification(l.default,O);var M=s._result=c.pureCompute(s._computeResult);s.scope.attach(t.slide.loadResult.register(M));return s}t.prototype._computeImage=function(){var e=this._item(),t=(e.orientedThumbnail||e).thumbnail||this.unwrapObservable(this._fallbackThumbnail),r=this._markAccess;if(r){var i=t&&t.url;if(i&&i.indexOf("provider=spo")>=0){var s=i.replace(/&(width|height)=[^&]*/g,""),o=r()?"Access":"Preview";return n.__assign({},t,{action:o,getAligned:function(e){return{width:e.width,height:e.height,url:s+"&width="+(0|e.width)+"&height="+(0|e.height)+"&action="+o}}})}}return t};t.prototype._computeRotation=function(){var e=this._item().orientedThumbnail;return e?e.rotation:r.default.none};t.prototype._computeImageFrameCoverage=function(){var e,t=this._image(),n=this._size();t.width&&t.height&&(t.width>n.width||t.height>n.height)&&(e=.25);return{minimum:0,maximum:1,fallback:e}};t.prototype._computeHasThumbnail=function(){return!(!this._size().width||!this._image()||!this.slide.loadState()&&this.hasError())};t.prototype._computeResult=function(){var e=this._result.peek();if(e)return e;var t=this._error();if(t){var n=void 0,r=!1;if(t instanceof h.ApiError){n=t.code;r=t.isExpected}return{resultType:r?u.ResultTypeEnum.ExpectedFailure:u.ResultTypeEnum.Failure,resultCode:n||"LoadFailure",error:"Unable to load image"}}return this._isLoaded()?{resultType:u.ResultTypeEnum.Success}:void 0};t.prototype._computeHasError=function(){var e=this.hasError.peek();if(!e){e=this._allowError()&&!!this._error();var t=this._error();if(t&&t instanceof Array)for(var n=0;n<t.length;n++)if(t[n]&&"NeedAccessToken"===t[n].message)return!1}return e};t.prototype._computeDesiredSize=function(){var e=this._size(),t=this._image();if("Preview"!==(t&&t.action))return e;var n=Math.max(e.width,e.height),r=t&&Math.max(t.width,t.height)||0;if(r&&n>r)return m(r);for(var i=0,s=[400,960,1600,2560];i<s.length;i++){var o=s[i];if(r&&o>r)return m(r);if(o>n)return m(o)}return m(2560)};t.prototype._computeThumbnailParams=function(){var e;this.hasThumbnail()&&(e={image:this._image,rotation:this._rotation,desiredSize:this._desiredSize,scale:this._scale,error:this._error,alignment:s.AlignmentType.fit,fadeIn:this._fadeIn,isCurrent:this._isLoaded,isLoaded:this._isRendered,coverage:this._coverage,allowLoading:this._allowLoading});return e};t.prototype._updateSlideLoadState=function(){var e=this.slide.loadState;this._isLoaded()?e(3):this._isRendered()&&e(2)};return t}(c.default);t.default=v;function m(e){return{width:e,height:e}}});
define("odsp-next/controls/oneUp/thumbnail/OneUpThumbnail.html",[],function(){return"\x3c!--ko if: hasError--\x3e\x3c!--ko control: fallbackControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: !hasError() && hasThumbnail()--\x3e\x3c!--ko component: {\r\n name: thumbnailTagName,\r\n params: thumbnailParams\r\n}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e"});
define("odsp-next/controls/oneUp/photo/OneUpPhoto.html",[],function(){return'<div class=OneUp-photo data-bind="component: projector">\x3c!--ko control: getThumbnailControl($host)--\x3e\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/oneUp/pdf/OneUpPdf.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/require/RequireConfigInjector"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});r.default.addConfig({map:{"*":{"../build/pdf.js":"pdfjs-dist/build/pdf"}}});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./OneUpPdf"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/textFile/OneUpTextFile.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./OneUpTextFile"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/video/OneUpVideo.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./OneUpVideo"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/wac/OneUpWAC.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./OneUpWAC"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/wrs/OneUpWrs.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./OneUpWrs"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/zip/OneUpZip.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./OneUpZip"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/OneUpSlide.html",[],function(){return'<div class=OneUp-slide data-bind="control: component" role=presentation></div>'});
define("odsp-next/controls/oneUp/OneUpSlide.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".OneUp-slide{position:absolute;left:0;right:0;top:0;bottom:0}.OneUp-slide:after,.OneUp-slide:before{display:block;position:absolute;width:2%;height:100%;content:''}html[dir=ltr] .OneUp-slide:before{right:100%}html[dir=rtl] .OneUp-slide:before{left:100%}html[dir=ltr] .OneUp-slide:after{left:100%}html[dir=rtl] .OneUp-slide:after{right:100%}.od-OneUpVideo{position:absolute;left:0;right:0;top:0;bottom:0}.OneUp-other{position:absolute;left:50%;top:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.OneUp-other .OneUp-other-content{text-align:center}.OneUp-other .OneUp-other-content .OneUp-other-fileName{font-size:21px}.OneUp-other .OneUp-other-content .OneUp-other-download{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-other .OneUp-other-content .OneUp-other-message{margin-top:15px;margin-bottom:15px}.OneUp-other .OneUp-other-content .OneUp-other-actions .od-ButtonBar-main{float:none}.OneUp-other .OneUp-other-content .OneUp-other-fileIcon .FileTypeIcon{outline:0}.OneUp-other .OneUp-other-content .od-ButtonBarCommand:not(.od-Button--primary){background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.OneUp-photo .od-Projector--live .od-ImageTile-background{transition:max-width 267ms cubic-bezier(.1,.9,.2,1),max-height 267ms cubic-bezier(.1,.9,.2,1)}.OneUp-photo .od-Projector--live.od-Projector--panning .od-ImageTile-background{transition-duration:0s,0s}.OneUp-otherTile{width:240px;height:240px;margin:auto;position:relative}.OneUp-fileHandler,.OneUp-fileHandler-frame{border:0;width:100%;height:100%}.OneUp-other-malwareDetectedIcon{height:208px;width:208px}"}])});
define("odsp-next/controls/oneUp/OneUpPriorityOptions",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.oneUpPriorityOptions={defaultValue:-1/0,reducer:function(e,t){return e>0?t:t>0?e:Math.max(e,t)}}});
define("odsp-next/controls/oneUp/PaneProvider.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../providers/transclusion/TransclusionProvider"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,factory:r.factory})});
define("odsp-next/controls/oneUp/ToolbarProvider.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../providers/transclusion/TransclusionProvider"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,factory:r.factory})});
define("odsp-next/controls/infoPane/FocusedInfoPaneSection.key",["require","exports","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.focusedInfoPaneSectionResourceKey=new r.ResourceKey({name:e("module").id,factory:{dependencies:{observablesFactoryType:n.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create(),disposable:t}}}})});
define("odsp-next/models/comments/ItemActivityCommentsFeature.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../utilities/features/Features","../../models/itemsScope/ItemsScopeFeature.key"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id+".isCommentsInActivityFeedEnabled",factory:{dependencies:{isItemsScopeEnabled:i.isItemsScopeEnabledResourceKey},create:function(e){return{instance:e.isItemsScopeEnabled?r.isFeatureEnabled(r.EnableCommentsWithItemsScope):r.isFeatureEnabled(r.EnableCommentsInActivityFeed)}}}})});
define("odsp-next/controls/oneUp/OneUp.html",[],function(){return'<div class=OneUp data-bind="css: { \'OneUp--hasInfoPane\': showPane, \'OneUp--awake\': isAwake, \'OneUp--panningEnabled\': isPanningEnabled, \'OneUp--hasItems\': items().length, \'OneUp--hasCommandBar\': isCommandBarVisible, \'OneUp--slideShowOn\': isSlideShowModeEnabled }" role=presentation><div class=OneUp-commandBar data-bind="hideWhenInactive, control: commandBarSpecification"></div><div class=OneUp-content data-bind="hideWhenInactive, clientRect: { size: size }" role=presentation><div class=OneUp-carousel data-bind="component: { name: carouselTagName, params: { item: item, items: items, canNavigate: canNavigate, allocationRange: allocationRange, loadState: slideLoadState, isEnabled: isPanningEnabled, isRotating: isRotating } }, idle: { isIdle: isIdle, isEnabled: isIdleEnabled }, throttledClick: { callback: $component.onContentClicked.bind($component)}, automation: \'carousel\'" role=presentation>\x3c!--ko component: {\r\n name: $component.oneUpSlideTagName,\r\n params: {\r\n slide: $host,\r\n oneUp: $component.oneUp\r\n }\r\n }--\x3e\x3c!--/ko--\x3e</div><div class=OneUp-detailsBar data-bind="css: { \'OneUp-detailsBar--hasCaption\': showEditCaption }, style: detailsBarStyle, childFocus: isDetailsFocused" role=presentation>\x3c!--ko if: showEditCaption--\x3e<div class=OneUp-caption-container>\x3c!--ko if: updateCaptionAction.isAvailable--\x3e<button class="OneUp-caption OneUp-caption--editable" data-bind="click: editCaption, css: { \'OneUp-caption--existing\': caption }"><span data-bind="text: caption() || addCaptionLabel"></span></button>\x3c!--/ko--\x3e\x3c!--ko ifnot: updateCaptionAction.isAvailable--\x3e<div class="OneUp-caption OneUp-caption--existing"><span data-bind="text: caption"></span></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if: showAgent--\x3e<div class=OneUp-agent data-bind="component: agentHost"></div>\x3c!--/ko--\x3e</div></div>\x3c!--ko if: showPane--\x3e<div class=OneUp-paneHost data-bind="hideWhenInactive, component: paneHost" role=presentation>\x3c!--ko with: $host.contexts()[0]--\x3e\x3c!--ko transclusionHost: $data--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot: $host.contexts().length--\x3e\x3c!--ko if: $component.isInfoPaneExpanded--\x3e<div class=OneUp-infoPane data-bind="control: infoPaneSpecification"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko component: { name: panelHostTagName }--\x3e\x3c!--/ko--\x3e\x3c!--ko component: { name: dialogHostTagName }--\x3e\x3c!--/ko--\x3e\x3c!--ko component: { name: overlayHostTagName }--\x3e\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/oneUp/OneUp.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".OneUp{position:absolute;left:0;right:0;top:0;bottom:0;overflow:hidden;outline:0;background-color:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.OneUp-detailsBar{visibility:hidden;opacity:0}.OneUp-detailsBar .CommandBarItem{-ms-flex:0 0 auto;flex:0 0 auto}html[dir=ltr] .OneUp-detailsBar .CommandBarItem{margin-right:0}html[dir=rtl] .OneUp-detailsBar .CommandBarItem{margin-left:0}.OneUp-detailsBar .CommandBarItem .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-detailsBar .CommandBarItem.is-toggled,.OneUp-detailsBar .CommandBarItem.is-toggled:hover,.OneUp-detailsBar .CommandBarItem:hover{background-color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.OneUp-toolbarHost{display:-ms-flexbox;display:flex;-ms-flex-flow:column-reverse nowrap;flex-flow:column-reverse nowrap;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}.OneUp-toolbar{background-color:rgba(0,0,0,.7);color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";height:44px;display:-ms-flexbox;display:flex;-ms-flex-align:stretch;align-items:stretch;-ms-flex-pack:center;justify-content:center;-ms-flex-flow:row nowrap;flex-flow:row nowrap}.lg .OneUp-toolbar,.xlg .OneUp-toolbar,.xxlg .OneUp-toolbar,.xxxlg .OneUp-toolbar,.xxxxlg .OneUp-toolbar{height:40px}.OneUp-commandBar{position:absolute;left:0;right:0;top:-44px;z-index:2;visibility:hidden;height:44px;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";transition:visibility 267ms linear,top 267ms linear}.lg .OneUp-commandBar,.xlg .OneUp-commandBar,.xxlg .OneUp-commandBar,.xxxlg .OneUp-commandBar,.xxxxlg .OneUp-commandBar{height:40px;top:-40px}.OneUp-commandBar .CommandBarItem:hover{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Word{background-color:#2b579a;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Word .ms-Icon--WordLogo:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Word .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Excel{background-color:#217346;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Excel .ms-Icon--ExcelLogo:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Excel .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint{background-color:#d24726;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint .ms-Icon--PowerPointLogo:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PDF{background-color:#c90304;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PDF .ms-Icon--PDF:before{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--PDF .od-CommandBarItem-down{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .CommandBarItem.od-Command--Excel.is-toggled,.OneUp-commandBar .CommandBarItem.od-Command--Excel.is-toggled:hover,.OneUp-commandBar .CommandBarItem.od-Command--Excel:hover,.OneUp-commandBar .CommandBarItem.od-Command--PDF.is-toggled,.OneUp-commandBar .CommandBarItem.od-Command--PDF.is-toggled:hover,.OneUp-commandBar .CommandBarItem.od-Command--PDF:hover,.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint.is-toggled,.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint.is-toggled:hover,.OneUp-commandBar .CommandBarItem.od-Command--PowerPoint:hover,.OneUp-commandBar .CommandBarItem.od-Command--Word.is-toggled,.OneUp-commandBar .CommandBarItem.od-Command--Word.is-toggled:hover,.OneUp-commandBar .CommandBarItem.od-Command--Word:hover{background-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.OneUp-commandBar .ms-CommandBar{padding:0}.sm .OneUp-commandBar{top:-44px;height:44px}.CommandBar-center{text-align:center}.OneUp-content{position:absolute;left:0;top:0;bottom:0;right:0;transition:top 267ms linear,left 367ms cubic-bezier(.1,.9,.2,1),right 367ms cubic-bezier(.1,.9,.2,1)}.OneUp-carousel{position:absolute;left:0;right:0;top:0;bottom:0;z-index:1;transition:top 267ms linear}.sm .OneUp--hasCommandBar .OneUp-paneHost{top:44px}.OneUp--hasCommandBar .OneUp-content,.OneUp--hasCommandBar .OneUp-paneHost{top:44px}.lg .OneUp--hasCommandBar .OneUp-content,.lg .OneUp--hasCommandBar .OneUp-paneHost,.xlg .OneUp--hasCommandBar .OneUp-content,.xlg .OneUp--hasCommandBar .OneUp-paneHost,.xxlg .OneUp--hasCommandBar .OneUp-content,.xxlg .OneUp--hasCommandBar .OneUp-paneHost,.xxxlg .OneUp--hasCommandBar .OneUp-content,.xxxlg .OneUp--hasCommandBar .OneUp-paneHost,.xxxxlg .OneUp--hasCommandBar .OneUp-content,.xxxxlg .OneUp--hasCommandBar .OneUp-paneHost{top:40px}.OneUp--hasCommandBar .OneUp-commandBar{visibility:visible;top:0}.OneUp-detailsBar{transition:visibility 0s linear 267ms,opacity 267ms linear,bottom 267ms linear;position:absolute;left:0;right:0;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";z-index:1}[dir=ltr] .lg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .md .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xlg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xxlg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xxxlg .OneUp--hasInfoPane .OneUp-content,[dir=ltr] .xxxxlg .OneUp--hasInfoPane .OneUp-content{right:320px}[dir=rtl] .lg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .md .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xlg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xxlg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xxxlg .OneUp--hasInfoPane .OneUp-content,[dir=rtl] .xxxxlg .OneUp--hasInfoPane .OneUp-content{left:320px}[dir=ltr] .OneUp--hasInfoPane .OneUp-paneHost{right:0}[dir=rtl] .OneUp--hasInfoPane .OneUp-paneHost{left:0}.sm .OneUp--hasInfoPane .OneUp-infoPane,.sm .OneUp--hasInfoPane .OneUp-paneHost{width:100%}.OneUp--slideShowOn .OneUp-commandBar{visibility:hidden}.OneUp--slideShowOn .OneUp-content{top:0}.OneUp--awake .OneUp-detailsBar{visibility:inherit;opacity:1;transition-delay:0s,0s,0s}.OneUp--awake.OneUp--slideShowOn .OneUp-commandBar{visibility:inherit}.OneUp-caption-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;background-color:rgba(255,255,255,.75)}.OneUp-caption{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";-ms-flex:1 1 auto;flex:1 1 auto;height:30px;border:0;padding:0;background:0 0;text-align:center;width:100%;max-width:600px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;vertical-align:middle;font-size:14px;font-weight:400}.OneUp-caption--editable{cursor:pointer}.OneUp-caption-clipper{display:table-cell;max-width:600px;height:30px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;vertical-align:middle;font-size:14px;font-weight:400}.lg .OneUp-caption-clipper{max-width:510px}.md .OneUp-caption-clipper{max-width:345px}.sm .OneUp-caption-clipper{max-width:150px}.OneUp-options{position:absolute;top:0;bottom:0;text-align:right}[dir=ltr] .OneUp-options{right:8px}[dir=rtl] .OneUp-options{left:8px}.OneUp-info{position:absolute;top:0;display:block;padding:20px 8px;height:40px}[dir=ltr] .OneUp-info{right:0}[dir=rtl] .OneUp-info{left:0}.OneUp-paneHost{position:absolute;width:320px;top:0;bottom:0;overflow:hidden;z-index:1}[dir=ltr] .OneUp-paneHost{right:-321px}[dir=rtl] .OneUp-paneHost{left:-321px}.OneUp-infoPane{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:absolute;top:0;bottom:0;right:0;width:320px}.od-userSelect--enabled .OneUp-infoPane{-webkit-touch-callout:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}.OneUp .od-Panel,.OneUp .od-PanelOverlay{top:0}"}])});
define("odsp-next/controls/currentPage/CurrentPage",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./CurrentPageViewModel","./CurrentPage.html","./CurrentPage.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.registerComponent({tagName:"od-current-page-control",template:e("./CurrentPage.html"),viewModel:r.default,synchronous:!0});t.default=i});
define("odsp-next/controls/currentPage/CurrentPageViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/base/ViewModel","./CurrentPage.resx","../pdfViewer/PdfViewer.resx","../../bindings/keyboard/KeyboardBinding","../../bindings/focus/SelectOnFocusBinding"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({keyboard:u.default,selectOnFocus:a.default});n.focused=t.focused;n.pageCount=t.pageCount;var r=n.inputFocused=t.inputFocused;n._currentPage=t.currentPage;var i=n.observables;n.currentPage=i.create("1");n._changePage=t.changePage||function(e){n._currentPage(e)};n.ofPagesLabel=i.pureCompute(n._computeOfPages);n.pageInfoLabel=i.pureCompute(n._computeContainerLabel);var s=i.pureCompute(n._computeInputLabel);i.backgroundCompute(n._updateCurrentPage);n.inputAttrs={"aria-controls":t.controlledId,"aria-label":s,id:t.id,tabindex:i.pureCompute(function(){return r()?0:-1})};return n}t.prototype.onEnter=function(){var e=this._validateInput(this.currentPage.peek());e!==this._currentPage.peek()?this._changePage(e):this.currentPage(this._currentPage.peek().toString())};t.prototype.onEscape=function(){this.focused(!0);this.currentPage(this._currentPage.peek().toString());return!1};t.prototype._computeOfPages=function(){return r.format(o.strings.ofPages,this.pageCount())};t.prototype._computeContainerLabel=function(){return r.format(s.strings.PageInfoAria,this.currentPage(),this.pageCount())};t.prototype._computeInputLabel=function(){return r.format(s.strings.PageInputAria,this.pageCount())};t.prototype._updateCurrentPage=function(){this.currentPage(this._currentPage().toString())};t.prototype._validateInput=function(e){var t=parseInt(e,10);if(isNaN(t))return this._currentPage.peek();var n=this.pageCount.peek();return t>n?n:t<1?1:t};return t}(i.default);t.default=f});
define("odsp-next/controls/currentPage/CurrentPage.html",[],function(){return'<div class=od-CurrentPage role=menuitem data-bind="hasFocus: focused, attr: { \'aria-label\': pageInfoLabel, tabindex: focused() ? 0: -1 }"><div class=od-CurrentPage-inputContainer><input type=text class=od-CurrentPage-pageInput data-bind="selectOnFocus, hasFocus: inputFocused, textInput: currentPage, attr: inputAttrs, keyboard: { allowInputEvents: true, mappings: { Enter: onEnter, Esc: onEscape } }"></div><div class=od-CurrentPage-ofPagesLabel data-bind="text: ofPagesLabel"></div></div>'});
define("odsp-next/controls/currentPage/CurrentPage.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-CurrentPage{display:-ms-flexbox;display:flex;-ms-flex:0 0 auto;flex:0 0 auto;text-align:center}html[dir=ltr] .od-CurrentPage{margin-right:8px}html[dir=rtl] .od-CurrentPage{margin-left:8px}.od-CurrentPage-inputContainer{-ms-flex:1 1 auto;flex:1 1 auto;height:100%;vertical-align:top}.od-CurrentPage-pageInput{width:34px;text-align:center;height:32px;margin-top:4px;outline:0}html[dir=ltr] .od-CurrentPage-pageInput{margin-right:4px}html[dir=rtl] .od-CurrentPage-pageInput{margin-left:4px}.lg .od-CurrentPage-pageInput,.xlg .od-CurrentPage-pageInput,.xxlg .od-CurrentPage-pageInput,.xxxlg .od-CurrentPage-pageInput,.xxxxlg .od-CurrentPage-pageInput{margin-top:2px}.od-CurrentPage-ofPagesLabel{margin-top:10px;-ms-flex:0 0 auto;flex:0 0 auto;font-size:14px}html[dir=ltr] .od-CurrentPage-ofPagesLabel{margin-right:2px}html[dir=rtl] .od-CurrentPage-ofPagesLabel{margin-left:2px}"}])});
define("odsp-next/controls/oneUp/3d/OneUp3d",["require","exports","./OneUp3dViewModel","../../../bindings/component/ControlBinding","./OneUp3d.html","./OneUp3d.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-3d",name:e("module").id,template:e("./OneUp3d.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/3d/OneUp3dViewModel",["require","exports","tslib","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/navigation/AddressWriter","@ms/utilities-error/lib/ApiError","../../../bindings/component/ControlBinding","../../../bindings/element/ElementBinding","../OneUpContentViewModel","../../../resources/DataSourceResourceKeys","../other/OneUpOther","./OneUp3d.resx","babylonjs-viewer"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function m(e,t){return-1===t.search(/^http/)||t.lastIndexOf(":")===t.indexOf(":")&&t.indexOf("/content?format=")<0||t.indexOf(":/content?")>=0?t:(t.indexOf("/content?format=")>=0?""+t:t+":/content?")+u.serializeQuery(e)}var g=function(e){n.__extends(t,e);function t(t,u){var h=e.call(this,t,u)||this,m=h.observables,g=t.slide;h.fallbackControl=f.toSpecification(p.default,n.__assign({},t,{slide:n.__assign({},g,{loadResult:m.createCallback(r.forSingleValue())})}));h.addBindingHandlers({control:f.default,element:l.default});h.isSlideCurrent=m.pureCompute(function(){return!h.slide.offset()},{deferEvaluation:!0}).extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}});h.hasError=m.create(!1);h.container=m.create(null);g.loadState(1);var y=m.create();g.loadResult.register(y);h._graphDataSource=u.graphDataSource;h.showViewer=m.pureCompute(function(){return h.isSlideCurrent()&&!h.hasError()});m.backgroundCompute(function(){var e=h.container();if(e&&h.showViewer()){if(!h._viewer){var t=h._viewer=h.scope.attach(new v.DefaultViewer(e,{extends:"extended",templates:{navBar:{params:{text:{fullscreenButton:d.strings.fullscreenButton,hdButton:d.strings.hdButton,helpButton:d.strings.helpButton,printButton:d.strings.printButton,vrButton:d.strings.vrButton}}},main:{}}})),n=new s.default(function(){t.dispose()});t.onInitDoneObservable.add(function(){n.complete(t)});h.trackPromise(h._viewerPromise=n.getPromise())}var r=h.slide.item.peek();h.trackPromise(h.loadItem(r).then(function(){y({resultType:o.ResultTypeEnum.Success});h.slide.loadState(3)},function(e){if(i.default.isCanceled(e)){e=new a.ApiError({isExpected:!0,code:"Canceled",message:"canceled"});console.log("Model load canceled")}else console.error("Error loading Model: ",e);y(c.loadResultFromError(e));h.slide.loadState(3);h.hasError(!0)}))}else if(e&&h._viewer){h._viewer.dispose();h._viewerPromise.cancel();h._viewer=null;h._viewerPromise=null}});return h}t.prototype.loadItem=function(e){var t=this;return i.default.resolve().then(function(){if(t.scope.isDisposed)throw new a.ApiError({code:"Disposed",message:"Viewer has already been destroyed"});var n=t._graphDataSource,r=e.extension,o=e.model3d;if(!o)throw new a.ApiError({isExpected:!0,code:"UnsupportedFormat",message:"Missing 3D facet on file with extension: "+r});var f=e.properties&&e.properties.FileLeafRef||e.name,l=".gltf"===r.toLowerCase(),c=e.parent,h=f.slice(-r.length)===r?f:""+f+r,p=c?n.getAuthenticationParams(c):void 0,d=l&&c?n.getItemUrl(e.parent,{useDirectEndpoint:!0,isPath:!0})+"/":"",g=l&&c&&p.then(function(e){v.BABYLON.Tools.PreprocessUrl=m.bind(null,e)}),b=i.default.resolve().then(function(){if(o.canRenderNative)return l?h:n.getDownloadUrl(e,{useDirectEndpoint:!0});var t=o.conversionUrl;if(t)return t.indexOf("{.authParams}")>=0?p.then(function(e){return t.replace("{.authParams}",u.serializeQuery(e))}):t;if(o.canConvert)return p.then(function(t){return n.getItemUrl(e,{useDirectEndpoint:!0})+"/content?format=glb&"+u.serializeQuery(t)});throw new a.ApiError({isExpected:!0,code:"UnsupportedFormat",message:"Invalid 3D facet on file with extension: "+r})}),w=new s.default;i.default.all([b,t._viewerPromise,g]).then(function(e){var t=e[0],n=e[1],r={url:t,title:f,root:l?d:void 0,loader:l?".gltf":".glb"},i=n.initModel(r,!0);i.onCompleteObservable.addOnce(function(){w.complete()});i.onLoadErrorObservable.add(function(e){var t=e.exception,n=t&&t.request,r=y(n,"x-errorcode")||y(n,"x-clienterrorcode"),i=n&&n.status,s=t&&t.name||"InvalidData",o=n&&(i>=400&&i<=406||412===i);w.error(new a.ApiError({isExpected:o,code:i||s,message:r||s}))})},function(e){w.error(e)});return w.getPromise()})};t.dependencies=n.__assign({},c.default.dependencies,{graphDataSource:h.graph});return t}(c.default);t.default=g;function y(e,t){if(e)try{return e.getResponseHeader(t)}catch(e){}}});
define("odsp-next/controls/oneUp/3d/OneUp3d.html",[],function(){return'\x3c!--ko if: hasError--\x3e\x3c!--ko control: fallbackControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: showViewer--\x3e<div class=OneUp-3d touch-action=none data-bind="element: container" role=application></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/oneUp/3d/OneUp3d.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".OneUp-3d{position:absolute;top:0;left:0;right:0;bottom:0;-ms-touch-action:none;touch-action:none}"}])});
define("odsp-next/controls/oneUp/image360/OneUpImage360",["require","exports","./OneUpImage360ViewModel","../../../bindings/component/ControlBinding","./OneUpImage360.html","./OneUpImage360.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-image360",name:e("module").id,template:e("./OneUpImage360.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/image360/OneUpImage360ViewModel",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../bindings/component/ControlBinding","../OneUpContentViewModel","../../../bindings/react/ReactBinding","../../../resources/DataSourceResourceKeys","../other/OneUpOther","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-utilities/lib/navigation/AddressWriter","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/logging/events/Qos.event","../../loadingSpinner/LoadingSpinner","../../../utilities/browser/ResponsiveUI","@ms/utilities-error/lib/ApiError"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(t){n.__extends(m,t);function m(u,l){var c=t.call(this,u,l)||this,p=c.observables,v=u.slide;c.fallbackControl=i.toSpecification(a.default,n.__assign({},u,{slide:n.__assign({},v,{loadResult:p.createCallback(f.forSingleValue())})}));c.addBindingHandlers({control:i.default,react:o.default});c.isSlideCurrent=p.pureCompute(function(){return!v.offset()},{deferEvaluation:!0}).extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}});c.viewerIsLoaded=p.create(!1);c.imgIsLoaded=p.create(!1);c.hasError=p.create(!1);c.thumbnails=p.create({});c._graphDataSource=l.graphDataSource;c.show360Viewer=p.pureCompute(function(){return c.isSlideCurrent()&&!c.hasError()});c.loadingComponent=p.pureCompute(c._computeLoadingSpinner);c.loadingContainerStyle={bottom:d.default.getScrollbarWidth()+"px"};var m=p.create();c.scope.attach(v.loadResult.register(m));p.backgroundCompute(function(){var e=v.item();e&&e.thumbnail&&c.show360Viewer()&&c.trackPromise(c._loadImageUrl(e).then(function(){c.viewerIsLoaded(!0);m({resultType:h.ResultTypeEnum.Success});u.slide.loadState(3)},function(e){if(!r.default.isCanceled(e)){m(s.loadResultFromError(e));c.slide.loadState(3);console.log("Error loading thumbnail URLs: ",e);c.hasError(!0)}}))});c.viewer360={componentPath:"odsp-next/controls/image360/react/Image360Viewer",getModule:function(){return new r.default(function(t,n){e(["odsp-next/controls/image360/react/Image360Viewer"],t,n)})},props:p.pureCompute(c._computeImage360ViewerProps)};return c}m.prototype._loadImageUrl=function(e){var t=this;return r.default.resolve().then(function(){var n=t._graphDataSource,r=n.getAuthenticationParams(e).then(function(t){var r=n.getItemUrl(e,{useDirectEndpoint:!0}),i="/content?"+l.serializeQuery(t);return{lowResUrl:r+"/thumbnails/0/c1000x500"+i,highResUrl:r+"/thumbnails/0/c2000x1000"+i,fullResUrl:""+r+i}}),i=new c.default;r.then(function(e){if(e){t.thumbnails(e);i.complete()}else i.error(new v.ApiError({code:"InvalidData",message:"Missing image URL"}))},function(e){i.error(e)});return i.getPromise()})};m.prototype._computeImage360ViewerProps=function(){var e,t,n=this,r=this.slide.item();r&&r.image360&&r.image360.posePitchDegrees&&(e=parseInt(r.image360.posePitchDegrees,10));r&&r.image360&&r.image360.poseRollDegrees&&(t=parseInt(r.image360.poseRollDegrees,10));return{thumbnails:this.thumbnails(),loadedObservable:function(){n.imgIsLoaded(!0)},pitch:e,roll:t}};m.prototype._computeLoadingSpinner=function(){return{name:p.default.tagName,params:{loadingText:this.slide.item().displayName}}};m.dependencies=n.__assign({},s.default.dependencies,{graphDataSource:u.graph});return m}(s.default);t.default=m});
define("odsp-next/controls/oneUp/image360/OneUpImage360.html",[],function(){return'\x3c!--ko if: hasError--\x3e\x3c!--ko control: fallbackControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: show360Viewer--\x3e<div class=OneUp-Image360><div class=OneUp-Image360-content><div class=od-OneUpImage360-container>\x3c!--ko if: viewerIsLoaded()--\x3e<div class=od-OneUpImage360 role=presentation data-bind="react: viewer360"></div>\x3c!--/ko--\x3e\x3c!--ko if: !imgIsLoaded()--\x3e<div class=OneUp-Image360-loadingContainer data-bind="style: loadingContainerStyle"><div class=OneUp-Image360-loading><span class="ms-font-s OneUp-Image360-loadingSpinner" data-bind="component: loadingComponent"></span></div></div>\x3c!--/ko--\x3e</div></div></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/oneUp/image360/OneUpImage360.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".OneUp-Image360-loadingContainer{position:absolute;width:100%}.OneUp-Image360-loadingContainer .OneUp-Image360-loading{width:300px;height:40px;background-color:rgba(0,0,0,.7);position:relative;margin:auto;bottom:0;padding:10px 15px;box-sizing:border-box}.OneUp-Image360-loadingContainer .OneUp-Image360-loading .OneUp-Image360-loadingSpinner{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";margin-top:10px}.OneUp-Image360-loadingContainer .OneUp-Image360-loading .OneUp-Image360-loadingSpinner .od-LoadingSpinner{overflow:hidden;text-overflow:ellipsis}[dir=ltr] .OneUp-Image360-loadingContainer .OneUp-Image360-loading .OneUp-Image360-loadingSpinner .od-LoadingSpinner-loadingGif{margin-right:5px}[dir=rtl] .OneUp-Image360-loadingContainer .OneUp-Image360-loading .OneUp-Image360-loadingSpinner .od-LoadingSpinner-loadingGif{margin-left:5px}.OneUp-Image360-content{position:absolute;top:0;left:0;right:0;bottom:0;-ms-touch-action:none;touch-action:none}.OneUp-Image360-content .od-viewer360{position:absolute;top:0;left:0;right:0;bottom:0;width:100%;height:100%}"}])});
define("odsp-next/controls/oneUp/panorama/OneUpPanorama",["require","exports","./OneUpPanoramaViewModel","../../../bindings/component/ControlBinding","./OneUpPanorama.html","../../panorama/Panorama"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-panorama",name:e("module").id,template:e("./OneUpPanorama.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/panorama/OneUpPanoramaViewModel",["require","exports","tslib","knockout","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../bindings/component/ControlBinding","../OneUpContentViewModel","../thumbnail/OneUpThumbnail","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t,r){var o=e.call(this,t,r)||this;o.addBindingHandlers({control:s.default});var f=o.observables;t.slide.isEditCaptionEnabled(!0);o._isInteractive=f.create(!1);o.showPanorama=f.pureCompute(function(){return!t.slide.offset()});var l=f.create(!1),c=f.pureCompute(function(){return l()?{resultType:i.ResultTypeEnum.Success}:void 0});o.scope.attach(t.slide.loadResult.register(c));f.backgroundCompute(function(){l()&&t.slide.loadState(3)});o.panoramaParams={item:t.slide.item,isLoaded:l,isInteractive:o._isInteractive};o.thumbnailControl=s.toSpecification(u.default,{slide:n.__assign({},t.slide,{loadResult:f.createCallback(a.forSingleValue())}),oneUp:t.oneUp,isPreview:!0});o.createComputed(o._computeChangesOnInteractive);return o}t.prototype._computeChangesOnInteractive=function(){var e=this._isInteractive();if(!r.computedContext.isInitial()){this.oneUp.isInfoPaneExpanded(!1);this.oneUp.isCommandBarVisible(!e);this.slide.isPanningEnabled(!e);this.slide.isEditCaptionEnabled(!e)}};return t}(o.default);t.default=f});
define("odsp-next/controls/oneUp/panorama/OneUpPanorama.html",[],function(){return"\x3c!--ko ifnot: showPanorama--\x3e\x3c!--ko control: thumbnailControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: showPanorama--\x3e<div class=OneUp-panorama data-bind=\"component: { name: 'od-panorama', params: panoramaParams }\"></div>\x3c!--/ko--\x3e"});
define("odsp-next/controls/panorama/Panorama",["require","exports","./PanoramaViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./Panorama.html","./Panorama.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-panorama",template:e("./Panorama.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/panorama/PanoramaViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../resources/DataSourceResourceKeys","../../bindings/immersiveViewer/ImmersiveViewerBinding","./Panorama.resx"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.enterInteractiveModeAria=u.strings.EnterInteractiveModeAria;n.exitInteractiveModeAria=u.strings.ExitInteractiveModeAria;n.addBindingHandlers({immersiveViewer:o.default});n.item=t.item;n._isLoaded=t.isLoaded;n._parentInteractive=t.isInteractive;n.interactiveButtonUrl=window.require.toUrl("odsp-media/images/panorama/interactivemodebuttonrest.png");n.viewer=r.observable(null);n.worldConfiguration=r.observable(null);n.downloadUrl=r.observable(null);n.isInteractive=r.observable(n._parentInteractive());n._boundHandlePanning=n._handlePanning.bind(n);n._isGoingClockwise=!0;n.loadPanorama();n.createComputed(function(){n._onInteractiveChange()});return n}t.prototype.loadPanorama=function(){var e=this,t=this.viewer();if(t){t.dispose();this.viewer(null)}var n=r.utils.unwrapObservable(this.item);n&&this.resources.consumeAsync(s.download).then(function(t){return t.getDownloadUrl(n,{downloadType:2}).then(function(t){e.downloadUrl(t)})});this._isLoaded(!0)};t.prototype.onClickInteractiveButton=function(){this.isInteractive(!0)};t.prototype.onClickBackButton=function(e,t){t.stopPropagation();this.isInteractive(!1);return!0};t.prototype._onInteractiveChange=function(){var e=this.isInteractive(),t=this.viewer();if(e){this._parentInteractive(!0);if(t){this._stopAutoPan();t.setIsInteractive(!0);t.setFocus()}}else{if(t){this._resetView();this._startAutoPan();t.setIsInteractive(!1)}this._parentInteractive(!1)}};t.prototype._resetView=function(){var e=this.viewer(),t=this.worldConfiguration();if(e&&t){var n=t.source;e.setView(n?n.startingPitch:0,n?n.startingHeading:0,Math.PI);this._isGoingClockwise=!0}};t.prototype._startAutoPan=function(){var e=this.viewer();if(e){this._handlePanning();e.viewChangeEndEvent.addEventListener(this._boundHandlePanning)}};t.prototype._stopAutoPan=function(){var e=this.viewer();if(e){e.setView(e.getPitch(),e.getHeading(),e.getVerticalFov());e.viewChangeEndEvent.removeEventListener(this._boundHandlePanning)}};t.prototype._handlePanning=function(){var e=this,t=this.viewer();if(this.isInteractive())this._stopAutoPan();else{var n=t.getBounds(),r=n.right||Math.PI,i=n.left||-Math.PI,s=n.top||Math.PI/2,o=n.bottom||-Math.PI/2,u=r-i,a=u>=s-o,f=t.getHeading(),l=t.getPitch(),c=f,h=l;if(a)if(u===2*Math.PI)if(f===r||f===i){c=0;this._isGoingClockwise=!this._isGoingClockwise}else c=this._isGoingClockwise?r:i;else c=f<r?r:i;else h=l<s?s:o;var p=1e3*(Math.abs(c-f)+Math.abs(h-l))/.05;this.async.setTimeout(function(){e.isInteractive()||t.setView(h,c,t.getVerticalFov(),!0,p)},1e3)}};return t}(i.default);t.default=a});
define("odsp-next/bindings/immersiveViewer/ImmersiveViewerBinding",["require","exports","knockout","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/domUtils/DomUtils","../../controls/panorama/Panorama.resx","office-ui-fabric-react/lib/Styling"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="formats/cubemap/cubemap.json";function f(e,t){return e+"?psid=1&zippath="+t}var l=function(){function t(){}t.init=function(t,l,c,h,p){var d,v,m=l(),g=m.downloadUrl.subscribe(function(t){if(t){var n=f(t,a);v=r.loadModule({path:"siv",getModule:function(){return new i.default(function(t,n){e(["siv"],t,n)})}}).then(function(){var e=new Microsoft.ImmersiveViewer.PhotosynthSivDataSource;d=e;e.createFromJsonUri(n,y,function(){return f(t,"")},!0,!0)})}});function y(e,n){if(e){m.worldConfiguration(e);!function(){m.viewer(new Microsoft.ImmersiveViewer.SharedImmersiveViewer(t,{dataSources:[d],backgroundColor:null,width:t.offsetWidth,height:t.offsetHeight}));var e=document.getElementById("sivZoomInButton");e.textContent="";e.setAttribute("aria-label",o.strings.ZoomIn);s.default.toggleClass(e,u.getIconClassName("Add"),!0);s.default.toggleClass(e,"ms-Icon--m",!0);var n=document.getElementById("sivZoomOutButton");n.setAttribute("aria-label",o.strings.ZoomOut);s.default.toggleClass(n,u.getIconClassName("Remove"),!0);s.default.toggleClass(n,"ms-Icon--m",!0);n.textContent=""}()}}n.utils.domNodeDisposal.addDisposeCallback(t,function(){g.dispose();v&&v.cancel();var e=m.viewer();if(e){e.dispose();m.viewer(null)}m.worldConfiguration(null)})};return t}();t.default=l});
define("odsp-next/controls/panorama/Panorama.html",[],function(){return"<div class=od-Panorama data-bind=\"css: {'od-Panorama--isInteractive': isInteractive}\"><div class=od-Panorama-sivContainer data-bind=\"{ immersiveViewer: { viewer: viewer, downloadUrl: downloadUrl, worldConfiguration: worldConfiguration} }\"></div><button class=od-Panorama-interactiveModeButton data-bind=\"click: onClickInteractiveButton, style: { backgroundImage: 'url(\\'' + interactiveButtonUrl + '\\')' }, attr: {'aria-label': enterInteractiveModeAria }\"></button> <button class=\"od-Panorama-backButton ms-Icon ms-Icon--Cancel ms-Icon--Circle ms-Icon--m\" data-bind=\"icon: true, click: onClickBackButton, attr: {'aria-label': exitInteractiveModeAria }\"></button></div>"});
define("odsp-next/controls/panorama/Panorama.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-Panorama-sivContainer{position:absolute;top:0;left:0;right:0;bottom:0}.od-Panorama-interactiveModeButton{position:absolute;top:50%;width:100px;height:100px;margin-top:-50px;background-repeat:no-repeat;background-color:transparent;border:none;z-index:1}[dir=ltr] .od-Panorama-interactiveModeButton{left:50%}[dir=rtl] .od-Panorama-interactiveModeButton{right:50%}[dir=ltr] .od-Panorama-interactiveModeButton{margin-left:-50px}[dir=rtl] .od-Panorama-interactiveModeButton{margin-right:-50px}.od-Panorama-interactiveModeButton:active,.od-Panorama-interactiveModeButton:hover{background-color:transparent}.od-Panorama--isInteractive .od-Panorama-interactiveModeButton{display:none}.od-Panorama .od-Panorama-backButton{display:none;position:absolute;top:20px;height:40px;width:40px;padding:0;z-index:1;cursor:pointer;background-color:#fff}[dir=ltr] .od-Panorama .od-Panorama-backButton{right:40px}[dir=rtl] .od-Panorama .od-Panorama-backButton{left:40px}.od-Panorama--isInteractive .od-Panorama-backButton{display:block}.od-Panorama .sivZoomInButton,.od-Panorama .sivZoomOutButton{display:none;right:auto;background-color:#fff;width:40px;height:40px;cursor:pointer;padding:0;top:auto}[dir=ltr] .od-Panorama .sivZoomInButton,[dir=ltr] .od-Panorama .sivZoomOutButton{right:50px}[dir=rtl] .od-Panorama .sivZoomInButton,[dir=rtl] .od-Panorama .sivZoomOutButton{left:50px}.od-Panorama--isInteractive .sivZoomInButton,.od-Panorama--isInteractive .sivZoomOutButton{display:block}.od-Panorama .od-Panorama-backButton:hover,.od-Panorama .sivZoomInButton:hover,.od-Panorama .sivZoomOutButton:hover{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.od-Panorama .od-Panorama-backButton:active,.od-Panorama .sivZoomInButton:active,.od-Panorama .sivZoomOutButton:active{background-color:#000;color:#fff}.od-Panorama .sivZoomInButton{bottom:100px}.od-Panorama .sivZoomOutButton{bottom:50px}.od-Panorama .sivHeadingLeftButton,.od-Panorama .sivHeadingRightButton,.od-Panorama .sivPitchDownButton,.od-Panorama .sivPitchUpButton{display:none}"}])});
define("odsp-next/controls/oneUp/other/commands/ItemActionBar",["require","exports","./ItemActionBarViewModel","../../../../bindings/component/ControlBinding","./ItemActionBar.html"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"od-item-action-bar",name:e("module").id,template:e("./ItemActionBar.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/other/commands/ItemActionBarViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../buttonBar/ButtonBar","./OneUpOtherInlineCommandSet"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.component={name:i.default.tagName,params:{commandSet:new(r.child(s.default))({forceExternal:t.forceExternal,item:t.item,hideOpenCommand:t.hideOpenCommand})}};return r}return t}(r.default);t.default=o});
define("odsp-next/controls/oneUp/other/commands/OneUpOtherInlineCommandSet",["require","exports","tslib","../../../commands/Command","../../../commands/Commands.resx","../../../../resources/ControlResourceKeys","../../../commands/BaseCommandSet","../../../../utilities/browser/WebViewDetector","../../../../actions/OpenInDesktopAction","../../../../dataSources/url/QueryType","../../../../models/item/ItemType"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._actionMap=n.resources.consume(s.actionMap);n._isOneDriveWinApp=u.isOneDriveWinApp();var o=n.observables,c=t.forceExternal,h=t.item,p=t.hideOpenCommand;n._isOneDriveWinApp&&h().queryType===f.default.SharedWithMe?n.commands.push(new(n.managed(r.CommandViewModel))({text:i.strings.Open,action:new(n.managed(n._actionMap.OpenInDesktopAction))({item:t.item,openRelation:2,actionType:a.DesktopActionType.DefaultClick})})):n._isOneDriveWinApp&&h().type===l.default.Unknown?n.commands.push(new(n.managed(r.CommandViewModel))({text:i.strings.Open,action:new(n.managed(n._actionMap.DownloadAction))({item:t.item})})):!n._isOneDriveWinApp||h().type!==l.default.OneNote&&h().type!==l.default.File?c||n.commands.push(new(n.managed(r.CommandViewModel))({text:i.strings.Open,action:new(n.managed(n._actionMap.DefaultClickAction))({sourceEngagement:"OneUpOther.Open.Click",userInvokedItem:!0,item:t.item,hideIfDefaultIsDownload:!0}),isHidden:o.pureCompute(function(){return o.unwrap(p)})})):n.commands.push(new(n.managed(r.CommandViewModel))({text:i.strings.Open,action:new(n.managed(n._actionMap.OpenInOfficeOnlineAction))({item:t.item,openLocal:!1,useDefaultAction:!0})}));n.commands.push(new(n.managed(r.CommandViewModel))({text:i.strings.Download,action:new(n.managed(n._actionMap.DownloadAction))({item:t.item})}));return n}return t}(o.default);t.default=c});
define("odsp-next/controls/oneUp/other/commands/ItemActionBar.html",[],function(){return"\x3c!--ko component: component--\x3e\x3c!--/ko--\x3e"});
define("odsp-next/controls/oneUp/textFile/OneUpTextFile",["require","exports","./OneUpTextFileViewModel","../../../bindings/component/ControlBinding","./OneUpTextFile.html","./OneUpTextFile.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-textFile",name:e("module").id,template:e("./OneUpTextFile.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/textFile/OneUpTextFileViewModel",["require","exports","tslib","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../bindings/component/ControlBinding","../../../bindings/monaco/MonacoBindingHelper","../thumbnail/OneUpThumbnail","../other/OneUpOther","../OneUpContentViewModel","../../../controls/textViewer/TextViewer","../../../controls/progressSpinnerFlat/ProgressSpinnerFlat","../../../models/item/FileContentHelper","../../../providers/encoding/EncodingProvider","../../../resources/DataSourceResourceKeys","../../../utilities/browser/ResponsiveUI","../../../utilities/mime/MimeHelper","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=200,b=function(e){n.__extends(t,e);function t(t,i){var f=e.call(this,t,i)||this;f.addBindingHandlers({control:s.default});f._encodingProvider=i.encodingProvider;var h=t.slide,p=f.observables,d=r.forSingleValue();f.thumbnailControl=s.toSpecification(u.default,n.__assign({},t,{slide:n.__assign({},h,{loadState:p.compute({read:function(){return h.loadState()},write:function(e){e>=1&&e>h.loadState.peek()&&h.loadState(1)}}),loadResult:p.createCallback(d)}),allowError:!1,isPreview:!0}));f.fallbackControl=s.toSpecification(a.default,n.__assign({},t,{slide:n.__assign({},h,{loadResult:p.createCallback(d)})}));f.loadingSpinnerTagName=c.default.tagName;f._isSlideCurrent=p.pureCompute(f._computeIsSlideCurrent).extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}});var m=f._loadResult=p.create();f.scope.attach(h.loadResult.register(m));f.loadThumbnail=p.create(!1);f.async.setTimeout(function(){f.loadThumbnail(!0)},y);f.loadTextEditor=f._isSlideCurrent;f.loadTextEditorFailed=p.create(!1);f.hasTextEditorLoaded=p.create(!1);var g=f.hasTextEditorDataLoaded=p.create(!1),b=f._editorState=p.create(o.EditorState.shouldLoad),w=f._isEditorFocused=p.create(!1);f._isFirstSlideOpened=p.pureCompute(f._computeIsFirstSlideOpened);f.editorTitle=p.pureCompute(f._computeEditorTitle);var E=f._itemContent=p.create(),S=i.responsiveUI,x=f.oneUp.size,T=f.isCompact=p.pureCompute(function(){var e=x()&&x().width||0;return S.compareSize(v.default.determineWindowSize(e),"Large")<=0});f.contentControl=s.toSpecification(l.default,{content:E,editorState:b,isCompact:T,isDataLoaded:g,isEditorFocused:w});f.slide.loadState(1);p.backgroundCompute(f._computeOnEditorStateChange);p.backgroundCompute(f._computeIsPanningEnabled);p.backgroundCompute(f._computeUpdateContent);return f}t.prototype._computeUpdateContent=function(){var e=this,t=this.slide.item(),n=m.getMimeTypeForExtension(t.extension),r=this.resources.consumeAsync(d.download).then(function(e){return e.getItemContents(t)});return this.trackPromise(r).then(function(t){if(t){var r=e._encodingProvider.getEncoding();return h.fullParse(t,n,r)}}).then(function(t){e._itemContent(t)}).catch(function(t){if(g.default.isCanceled(t))e._loadResult({resultType:i.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled",error:"Canceled"});else{e._loadResult({resultType:i.ResultTypeEnum.Failure,resultCode:t.code||"ReadFile",error:t&&t.message||""+t});e.slide.loadState(3)}e.loadTextEditorFailed(!0)})};t.prototype._computeEditorTitle=function(){var e=this.slide.item();return e.displayName||e.name};t.prototype._computeIsSlideCurrent=function(){return!this.slide.offset()};t.prototype._computeIsFirstSlideOpened=function(){var e=this.hasTextEditorLoaded();return!this._isSlideCurrent()||this.slide.isFirstSlideOpened()||!e};t.prototype._computeOnEditorStateChange=function(){switch(this._editorState()){case o.EditorState.loaded:this.hasTextEditorLoaded(!0);this._loadResult({resultType:i.ResultTypeEnum.Success});this.slide.loadState(3);break;case o.EditorState.error:this._loadResult({resultType:i.ResultTypeEnum.Failure,resultCode:"MonacoError"});this.loadTextEditorFailed(!0);this.slide.loadState(3)}};t.prototype._computeIsPanningEnabled=function(){var e=this._isEditorFocused(),t=this._isFirstSlideOpened();this.slide.isPanningEnabled(!t&&!e)};t.dependencies=n.__assign({},f.default.dependencies,{encodingProvider:p.resourceKey,responsiveUI:v.resourceKey});return t}(f.default);t.default=b});
define("odsp-next/bindings/monaco/MonacoBindingHelper",["require","exports","knockout","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Async","@ms/odsp-utilities/lib/events/EventGroup","@ms/odsp-utilities/lib/require/RequireConfigInjector"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,f,l=new s.default,c=new o.default(window);!function(e){e[e.shouldLoad=0]="shouldLoad";e[e.loading=1]="loading";e[e.loaded=2]="loaded";e[e.error=3]="error"}(f=t.EditorState||(t.EditorState={}));t.initializeEnvironment=function(e){if(a)e&&e(f.loaded);else{e&&e(f.loading);u.default.addConfig({paths:{vs:"monaco-editor/vs"}});a=r.loadModule({path:"vs/editor/editor.main",getModule:function(){return new i.default(function(e,t){window.require(["vs/editor/editor.main"],e,t)})}}).then(function(){e&&e(f.loaded);var t=monaco.languages.typescript;t.javascriptDefaults.setDiagnosticsOptions({noSemanticValidation:!0,noSyntaxValidation:!1});t.javascriptDefaults.setCompilerOptions({target:t.ScriptTarget.Latest,allowNonTsExtensions:!0})},function(t){e&&e(f.error);a=void 0;return i.default.wrapError(t)})}return a};t.addDispose=function(e,t){n.utils.domNodeDisposal.addDisposeCallback(e,function(){try{t&&t()}catch(e){}})};t.watchForResize=function(e,t){var r=l.throttle(function(){t.layout()},500);c.on(window,"resize",r);n.utils.domNodeDisposal.addDisposeCallback(e,function(){c.off(window,"resize",r)})}});
define("odsp-next/controls/textViewer/TextViewer",["require","exports","./TextViewerViewModel","../../bindings/component/ControlBinding","./TextViewer.html","./TextViewer.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({name:e("module").id,automationName:"ms-text-viewer",template:e("./TextViewer.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/textViewer/TextViewerViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../bindings/monaco/MonacoBinding","../../bindings/keyboard/KeyboardBinding","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({keyboard:o.default,monaco:s.default});var i=r.observables;r._editorLoaded=!1;var u="undefined"==typeof __webpack_public_path__?window.require.toUrl(""):__webpack_public_path__,a=n.workerDataSource.getWorkerUrl(u+"monaco-worker.js")+"#"+u+"monaco-editor/";window.MonacoEnvironment={baseUrl:("undefined"==typeof __webpack_public_path__?window.require.toUrl(""):__webpack_public_path__)+"monaco-editor",getWorkerUrl:function(){return a}};var f=r._editor=i.create();r.editorFocused=t.isEditorFocused||i.create(!1);var l=t.editorState;r._content=t.content;r.keyboardOptions=[{mappings:{Esc:function(){r.editorFocused(!0);return!0}}}];r._isDataLoaded=i.pureCompute(r._computeDataLoaded);t.isDataLoaded&&i.backgroundCompute(function(){return t.isDataLoaded(r._isDataLoaded())});i.compute(r._computeResize);i.compute(r._computeContent);var c=n.platformDetection;r.monacoOptions={editor:f,editorState:l,isCompact:t.isCompact,isMobile:c.isMobile,readOnly:!0};return r}t.prototype.setEditorFocused=function(e){this.editorFocused(e)};t.prototype._computeResize=function(){if(this._isDataLoaded()){var e=this._editor();e&&this.async.setTimeout(function(){e.layout()},0)}};t.prototype._loadEditor=function(e){var t=this;this._editorLoaded=!0;e.onDidFocusEditorWidget(function(){t.editorFocused(!0)});e.onDidBlurEditorWidget(function(){t.editorFocused(!1)})};t.prototype._computeContent=function(){var e=this._editor();if(e){this._editorLoaded||this._loadEditor(e);var t=this._content();if(t&&t.mimeType){var n=e.getModel(),r=this._previousContent;if(n&&r&&r.mimeType===t.mimeType){n.getValue()!==t.text&&n.setValue(t.text)}else{var i=monaco.editor.createModel(t.text,t.mimeType);e.setModel(i);this._disposeModel(n)}this._previousContent=t}}};t.prototype._computeDataLoaded=function(){return!!this._content()};t.prototype._disposeModel=function(e){e&&!e.isDisposed()&&e.dispose()};t.dependencies=n.__assign({},r.default.dependencies,{platformDetection:i.platformDetection,workerDataSource:u.worker});return t}(r.default);t.default=a});
define("odsp-next/bindings/monaco/MonacoBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","./MonacoBindingHelper"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){var r,s,o=e.call(this,t)||this,u=o.valueAccessor(),a=o.element,f=!!u.readOnly,l=function(){var e=a.querySelector("textarea");e.readOnly!==f&&(e.readOnly=f)},c=o.observables,h={readOnly:f,scrollBeyondLastLine:!1,wordWrap:"on"},p={contextmenu:!u.isMobile},d=c.pureCompute(function(){var e=c.unwrap(u.isCompact);return{lineNumbersMinChars:e?3:5,minimap:{enabled:!e}}});c.backgroundCompute(function(){var e=u.editor();if(e){var t=d();e.updateOptions(t);e.layout()}});var v=i.initializeEnvironment(u.editorState).then(function(){r=monaco.editor.create(a,n.__assign({},h,p,d.peek()));i.watchForResize(a,r);s=new MutationObserver(l);l();s.observe(a,{childList:!0,subtree:!0});u.editor(r)},function(e){});i.addDispose(a,function(){v.cancel();s&&s.disconnect();if(r){var e=r.getModel();r.setModel(null);e&&e.dispose();r.dispose();r=null}});return o}return t}(r.default);t.default=s});
define("odsp-next/controls/textViewer/TextViewer.html",[],function(){return'<div class=TextViewer-frame data-bind="attr: { tabindex: editorFocused() ? 0 : -1 }, monaco: monacoOptions, keyboard: keyboardOptions, hasFocus: setEditorFocused"></div>'});
define("odsp-next/controls/textViewer/TextViewer.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".TextViewer-frame{border:none;position:absolute;top:1px;left:1px;right:1px;bottom:1px}.TextViewer-frame:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}"}])});
define("odsp-next/providers/encoding/EncodingProvider",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../resources/DataSourceResourceKeys","../../models/language/FileEncodings"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){this._encodingDataSource=t.encodingDataSource;this._languageDataSource=t.languageDataSource}e.prototype.getEncoding=function(){var e=this._encodingDataSource.getEncoding();if(!e){var t=this._languageDataSource.getCurrentLanguageCode().toLowerCase();e=i.encodingMap[t]}e||(e=i.defaultEncoding);return e};return e}();t.default=s;t.resourceKey=n.createResolvedResourceKey(e("module").id,s,{languageDataSource:r.language,encodingDataSource:r.encoding})});
define("odsp-next/models/language/FileEncodings",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultEncoding="windows-1252";t.encodingMap={ar:"windows-1256","ar-sa":"windows-1256","az-latn-az":"windows-1254",be:"windows-1251","be-by":"windows-1251",bg:"windows-1251","bg-bg":"windows-1251","bs-latn-ba":"windows-1250",cs:"windows-1250","cs-cz":"windows-1250",el:"windows-1253","el-gr":"windows-1253",et:"windows-1257","et-ee":"windows-1257",fa:"windows-1256","fa-ir":"windows-1256",he:"windows-1255","he-il":"windows-1255",hr:"windows-1250","hr-hr":"windows-1250",hu:"windows-1250","hu-hu":"windows-1250",ja:"Shift_JIS","ja-ja":"Shift_JIS","ja-jp":"Shift_JIS","ku-arab":"windows-1256","ku-arab-iq":"windows-1256",ky:"windows-1251","ky-kg":"windows-1251",lt:"windows-1257","lt-lt":"windows-1257",lv:"windows-1257","lv-lv":"windows-1257",mk:"windows-1251","mk-mk":"windows-1251",mn:"windows-1251","mn-mn":"windows-1251","pa-arab":"windows-1256","pa-arab-pk":"windows-1256",pl:"windows-1250","pl-pl":"windows-1250","prs-af":"windows-1256",ro:"windows-1250","ro-ro":"windows-1250",ru:"windows-1251","ru-ru":"windows-1251","sd-arab":"windows-1256","sd-arab-pk":"windows-1256",sk:"windows-1250","sk-sk":"windows-1250",sl:"windows-1250","sl-si":"windows-1250",sq:"windows-1250","sq-al":"windows-1250","sr-cyrl-ba":"windows-1251","sr-cyrl-cs":"windows-1251","sr-cyrl-rs":"windows-1251","sr-latn":"windows-1250","sr-latn-rs":"windows-1250","tg-cyrl":"windows-1251","tg-cyrl-tj":"windows-1251",th:"windows-874","th-th":"windows-874","tk-tm":"windows-1250",tr:"windows-1254","tr-tr":"windows-1254",tt:"windows-1251","tt-ru":"windows-1251","ug-cn":"windows-1256",uk:"windows-1251","uk-ua":"windows-1251",ur:"windows-1256","ur-pk":"windows-1256","uz-latn-uz":"windows-1254",vi:"windows-1258","vi-vn":"windows-1258"}});
define("odsp-next/controls/oneUp/textFile/OneUpTextFile.html",[],function(){return'<div class=od-OneUpTextFile data-bind="css: { \'od-OneUpTextFile-thumbnail--load\': loadThumbnail, \'od-OneUpTextFile--compact\': isCompact, \'od-OneUpTextFile--loaded\': loadTextEditor() && hasTextEditorLoaded() && hasTextEditorDataLoaded() }">\x3c!--ko if: loadTextEditorFailed()--\x3e\x3c!--ko control: fallbackControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: !loadTextEditorFailed()--\x3e\x3c!--ko if: loadTextEditor()--\x3e<div class=od-OneUpTextFile-content><div class=od-OneUpTextFile-title data-bind="text: editorTitle"></div><div class="od-OneUpTextFile-editor od-TextFileEditor-content" data-bind="control: contentControl"></div></div>\x3c!--/ko--\x3e<div class=od-OneUpTextFile-loading data-bind="component: { name: loadingSpinnerTagName, params: {} }"></div><div class=od-OneUpTextFile-thumbnail data-bind="control: thumbnailControl"></div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/oneUp/textFile/OneUpTextFile.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-OneUpTextFile-thumbnail{position:absolute;top:0;left:0;right:0;bottom:0;opacity:0;visibility:hidden}.od-OneUpTextFile-thumbnail--load .od-OneUpTextFile-thumbnail{opacity:1;visibility:inherit;transition:opacity 267ms linear 267ms}.od-OneUpTextFile--loaded .od-OneUpTextFile-thumbnail{opacity:0;visibility:hidden}.od-OneUpTextFile-loading{position:absolute;top:0;left:0;right:0;bottom:0;z-index:1;opacity:1;visibility:inherit}.od-OneUpTextFile--loaded .od-OneUpTextFile-loading{opacity:0;visibility:hidden}.od-OneUpTextFile-content{position:absolute;top:0;left:0;right:0;bottom:0;opacity:0;visibility:hidden;margin:20px;display:-ms-flexbox;display:flex;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-ms-flex-align:stretch;align-items:stretch;-ms-flex-pack:justify;justify-content:space-between;box-shadow:0 0 7px 2px rgba(0,0,0,.15)}.od-OneUpTextFile--compact .od-OneUpTextFile-content{margin:0 0;box-shadow:0}.od-OneUpTextFile--loaded .od-OneUpTextFile-content{opacity:1;visibility:inherit;transition:opacity 267ms linear 267ms}.od-OneUpTextFile-content .od-OneUpTextFile-title{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";-ms-flex:0 0 24px;flex:0 0 24px;font-size:14px;padding:6px 0 0 10px}html[dir=rtl] .od-OneUpTextFile-content .od-OneUpTextFile-title{padding:6px 10px 0 0}.od-OneUpTextFile-content .od-OneUpTextFile-editor{position:relative;-ms-flex:1 1 auto;flex:1 1 auto;width:100%}.od-OneUpTextFile-content .TextEditor{overflow:hidden}.od-OneUpTextFile-content .TextEditor .TextEditor-editorFrame{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";top:0;left:0;right:0;bottom:0}.od-OneUpTextFile-content .monaco-editor-background{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}"}])});
define("odsp-next/controls/oneUp/zip/OneUpZip",["require","exports","./OneUpZipViewModel","../../../bindings/component/ControlBinding","./OneUpZip.html","./OneUpZip.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-zip",name:e("module").id,template:e("./OneUpZip.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/zip/OneUpZipViewModel",["require","exports","tslib","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/browser/PlatformDetection.key","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../bindings/component/ControlBinding","../../../bindings/react/ReactBinding","../OneUpContentViewModel","../other/OneUpOther","./commandSets/DownloadZipContentsCommandSet","./OneUpZip.resx","../../../providers/engagement/Engagement","../../../resources/DataSourceResourceKeys","../../../resources/ControlResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(t){n.__extends(m,t);function m(s,f){var c=t.call(this,s,f)||this;c._engagement=f.engagement;c._countOnSelect=0;c._isRetinaEnabled=f.platformDetection.isRetinaSupported;c.altText=h.strings.zipAltText;c._downloadAction=new(c.managed(f.actionMap.DownloadAction))({item:s.slide.item});var p=c.observables,d=h.strings.downloadUrlTextLink.split("{0}"),v=d[0],m=d[1];c.beforeLinkText=v;c.afterLinkText=m;c.linkText=h.strings.downloadUrlText;c.addBindingHandlers({control:u.default,react:a.default});var g=s.slide;c.fallbackControl=u.toSpecification(l.default,n.__assign({},s,{slide:n.__assign({},g,{loadResult:p.createCallback(r.forSingleValue())})}));var y=p.create();c.scope.attach(g.loadResult.register(y));c.isPartial=p.create(!1);c.showError=p.create(!1);c.totalNum=p.create("");c._selectedZipItems=p.create([]);c._downloadUrl=p.pureCompute(function(){var e=g.item();return e&&e.zip&&e.zip.downloadZipContentsUrl});c.zipName=p.pureCompute(function(){var e=g.item();return e&&e.name});c.svgUrl=window.require.toUrl("odsp-media/images/oneupzip/zipicon.svg");var b=g.item.peek(),w=c._root=p.create({children:[],date:b&&b.dateModified||"",extension:b&&b.extension||"",isFolder:!0,name:b&&b.name||"",childCount:0,parentFolder:void 0,path:"",size:0});c._onNavigate=c._onNavigate.bind(c);c._onSelect=c._onSelect.bind(c);c.zipList={componentPath:"odsp-next/controls/zip/react/ZipContentList",getModule:function(){return new i.default(function(t,n){e(["odsp-next/controls/zip/react/ZipContentList"],t,n)})},props:p.pureCompute(c._computeZipListProps)};c._logZipEvent("ZipPreviewByClick",1);var E=f.zipDataSource;p.backgroundCompute(function(){var e=g.item(),t=e.zip&&e.zip.zipMetaDataUrl;E.getContents(e,t).then(function(e){w(e.root);c.totalNum(e.root.childCount);if(""!==e.error){c._logZipEvent("MoreThan1000Files",1);c.isPartial(!0)}y({resultType:o.ResultTypeEnum.Success});g.loadState(3)},function(e){y({resultType:e.isExpected?o.ResultTypeEnum.ExpectedFailure:o.ResultTypeEnum.Failure,resultCode:e.code||"GetContents",error:e&&e.message||""+e});g.loadState(3);c.showError(!0)})});return c}m.prototype.downloadZipFromPreview=function(e){this._downloadAction.execute(e)};m.prototype._computeZipListProps=function(){return{allowSelection:!this.slide.renderOptions,root:this._root(),name:this.zipName(),onNavigate:this._onNavigate,onSelect:this._onSelect,isRetinaEnabled:this._isRetinaEnabled}};m.prototype._onNavigate=function(e){this.totalNum(e.childCount);this._logZipEvent("ZipFolderNavigation",this._countOnSelect);this._countOnSelect++;this._onSelect([],e)};m.prototype._onSelect=function(e,t){this._selectedZipItems(e.length>0?e:[t]);var n=t===this._root.peek()&&t.childCount===e.length;if(0!==e.length&&!n||t&&t.path){this._zipCommandSet||this._initZipCommandSet();this.slide.commandSet(this._zipCommandSet)}else this.slide.commandSet(void 0)};m.prototype._initZipCommandSet=function(){this._zipCommandSet=new(this.managed(c.default))({actionParams:{item:this.slide.item,selection:this._selectedZipItems,url:this._downloadUrl}})};m.prototype._logZipEvent=function(e,t){0!==t&&this._engagement.logData({name:"OneUpZipPreviewer."+e})};m.dependencies=n.__assign({},f.default.dependencies,{actionMap:v.actionMap,engagement:p.resourceKey,platformDetection:s.platformDetection,zipDataSource:d.zip});return m}(f.default);t.default=m});
define("odsp-next/controls/oneUp/zip/commandSets/DownloadZipContentsCommandSet",["require","exports","tslib","../../../commands/BaseCommandSet","../../../commands/Command","../../../../utilities/icons/Icon","../../../commands/Commands.resx","../../../../resources/ControlResourceKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=n.resources.consume(u.actionMap);n.commands.push(new(n.managed(i.CommandViewModel))({icon:new s.default("Download"),text:o.strings.Download,automationId:"OneUpZipDownload",action:new(n.managed(r.DownloadZipContentsAction))(t.actionParams)}));return n}return t}(r.default);t.default=a});
define("odsp-next/controls/oneUp/zip/OneUpZip.html",[],function(){return'\x3c!--ko if: showError--\x3e\x3c!--ko control: fallbackControl--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko ifnot: showError--\x3e<section class=od-OneUpZip-container><div class=od-OneUpZip-header role=heading><img class=od-OneUpZip-image data-bind="attr: { src: svgUrl, alt: altText }"> <span class=od-OneUpZip-number data-bind="text: totalNum"></span></div><div class=od-OneUpZip role=presentation data-is-scrollable=true data-bind=", react: zipList"></div>\x3c!--ko if: isPartial()--\x3e<div class=od-OneUpZip-partial role=alert><span data-bind="text: beforeLinkText"></span> <a href=javascript:; data-bind="attr: { title: zipName }, click: downloadZipFromPreview, text: linkText"></a> <span data-bind="text: afterLinkText"></span></div>\x3c!--/ko--\x3e</section>\x3c!--/ko--\x3e'});
define("odsp-next/controls/oneUp/zip/OneUpZip.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-OneUpZip-container{margin:auto;margin-top:20px;box-shadow:0 0 7px 2px rgba(0,0,0,.15);display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;max-width:780px;min-width:70%;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";height:95%}.od-OneUpZip-container .ms-Breadcrumb{margin-bottom:20px}.od-OneUpZip-header{background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";height:130px;display:-ms-flexbox;display:flex;min-height:130px;-ms-flex-pack:center;justify-content:center;position:relative}.od-OneUpZip-image{height:130px;width:135px}.od-OneUpZip-number{position:absolute;top:83px;font-size:medium;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";width:113px}html[dir=ltr] .od-OneUpZip-number{text-align:right}html[dir=rtl] .od-OneUpZip-number{text-align:left}.od-OneUpZip{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding:0 20px;overflow:auto}.od-OneUpZip .od-Link{cursor:pointer;text-decoration:none;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-OneUpZip .ms-DetailsRow-cell .ms-Link{font-size:12px}.od-OneUpZip .ms-DetailsRow-cell .ms-Link:hover{text-decoration:underline;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-OneUpZip-partial{height:30px;background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";text-align:center;padding:19px 0 9px;font-size:14px}"}])});
define("odsp-next/dataSources/download/odc/DownloadDataSource",["require","exports","tslib","cookies","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/browser/PlatformDetection.key","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/navigation/AddressParser","../../base/odc/DataRequest","../../../models/item/ItemType","../../../resources/DataSourceResourceKeys","../../../resources/ODCResourceKeys","../../../models/winApp/communication/IWinAppCommunicator","../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this,i=window.FilesConfig;if(i){r._canary=i.canary;r._appId=i.appId}r._callBackIndex=0;r._graphDataSource=n.graphDataSource;r._navigation=n.navigation;r._urlDataSource=n.urlDataSource;r._userInfoDataSource=n.userInfoDataSource;r._platformDetection=n.platformDetection;return r}t.prototype.downloadItems=function(e){var t=e.items[0],n=this._urlDataSource;if(1===e.items.length&&t.type!==h.default.Folder){if(this._platformDetection.isMobile)this._navigation.navigateTo({url:n.getDownloadItemUrl(t,this._canary,!1),frameId:"_self"});else{var r=this._initIframe(n.getDownloadItemUrl(t,this._canary,!1));this.async.setTimeout(function(){window.document.body.removeChild(r)},2e4)}}else this._downloadAsZip(e.items);return u.default.wrap()};t.prototype.getDownloadZipRequest=function(e){for(var t,n=e.items,r=this._urlDataSource.getDownloadAsZipPostUrl(n[0].ownerId,this._appId),i=[],s=0;s<n.length;s++)if(n[s]){t=n[s];i.push(t.id)}if(this._userInfoDataSource.isAuthenticated()){var o={resIds:i.join(";"),canary:this._canary,token:""},a="";a=1===n.length&&n[0].type===h.default.Folder?n[0].displayName+".zip":"OneDrive-"+(new Date).toLocaleDateString().replace(/\//g,"-").replace(/[^ -~]/g,"")+".zip";var f={command:"Download",type:v.WinAppDownloadType.DownloadMultiFile,downloadUrl:r,zipFileName:a,postBody:JSON.stringify({request:o})};return u.default.wrap(JSON.stringify({DownloadCommand:f}))}};t.prototype.getDownloadUrl=function(e,t){if(e.video&&!m.isFeatureEnabled(m.ChangeVideoAuth)){var n=new c.default,r=this._urlDataSource.getDownloadUrl(e);return n.send({apiName:"GetDownloadUrl",url:r,useDefaultHeaders:!0}).then(function(e){return e.DownloadUrl?e.DownloadUrl:u.default.wrapError(e)})}return this._graphDataSource.getDownloadUrl(e,{useDirectEndpoint:!0})};t.prototype.getDownloadRequestParameters=function(e,t){var n=this,i=t||{},s=i.allowHeaders,o=void 0===s||s,a=i.url,f=void 0===a?e.urls&&e.urls.download:a;if(!f)return u.default.reject(new Error("No URL specified"));if("https://"!==f.slice(0,8))return u.default.resolve({url:f});var l=function(){return n._graphDataSource.getDownloadUrl(e,{useDirectEndpoint:!0}).then(function(e){var t=e.indexOf("?"),n=t>=0?e.slice(0,t):e,r=f.indexOf("?");return{url:""+n+(r>=0?f.slice(r):"")}})};return this._graphDataSource.getAuthenticationParams(e).then(function(e){var t,n=e.access_token,i=e.authkey;if(n){return f.length+14+n.length<2e3?{url:f+"&access_token="+encodeURIComponent(n)}:o?{url:f,headers:{Authorization:"Bearer "+n}}:l()}if(!n&&!i)return l();var s=f;if(i){var u=r.get("BadgerAuth");if(u){if(!o)return l();t={Authorization:"Badger "+u}}f.indexOf("authkey")<0&&(s+="&authkey="+encodeURIComponent(i))}return{url:s,headers:t}})};t.prototype.getItemContents=function(e){return m.isFeatureEnabled(m.ChangeTextAuth)?this.getDownloadRequestParameters(e).then(function(e){return(new c.default).send({apiName:"Download",headers:e.headers,url:e.url,returnRawXHR:!0,responseType:"blob"}).then(function(e){return e.response})}):this.getDownloadUrl(e,{downloadType:2}).then(function(e){return(new c.default).send({apiName:"Download",url:e,returnRawXHR:!0,responseType:"blob"}).then(function(e){return e.response})})};t.prototype._initIframe=function(e){var t=document.createElement("iframe");t.src=e;t.style.display="none";window.document.body.appendChild(t);return t};t.prototype._downloadAsZip=function(e){for(var t,r=this,i=0,s={},u=this._urlDataSource.getDownloadAsZipPostUrl(e[0].ownerId,this._appId),a=this._callBackIndex++,f=this._urlDataSource.getDownloadAsZipIframeUrl(this._canary),c=[],h=0;h<e.length;h++)if(e[h]){i+=(t=e[h]).size;s[t.extension]=(+s[t.extension]||0)+1;c.push(t.id)}var p={fileSize:i,itemCount:c.length,extensions:s,authed:"true"};if(!this._userInfoDataSource.isAuthenticated()&&i>2147483648){var d=this._urlDataSource.getForceLoginDownloadUrl(t);this._navigation.navigateTo(d)}else{var v=l.getUrlWithoutQueryString(f),m=o.deserializeQuery(l.getQueryStringFromUrl(f));f=v+"?"+o.serializeQuery(n.__assign({},m,{callbackIndex:a}));var g,y="downloadAsZipIframeReady_"+a;window[y]=function(){p.url=u;p.ids=c.join(":");var e=r._urlDataSource.getAuthKeyParamValue(),t=r._urlDataSource.getTicketParamValue();g.contentWindow.startDownloadAsZip(c.join(";"),r._canary,t,e,u);r.async.setTimeout(function(){window.document.body.removeChild(g);window[y]=null},6e4)};g=this._initIframe(f)}};t.dependencies=n.__assign({},i.default.dependencies,{graphDataSource:p.graph,navigation:s.navigation,platformDetection:a.platformDetection,urlDataSource:d.urlDataSource,userInfoDataSource:p.userInfo});return t}(i.default);t.default=g;t.resourceKey=f.createResolvedResourceKey(e("module").id,g)});
define("odsp-next/models/winApp/communication/IWinAppCommunicator",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.DownloadSingleFile=0]="DownloadSingleFile";e[e.DownloadMultiFile=1]="DownloadMultiFile";e[e.DownloadFileInZip=2]="DownloadFileInZip"}(t.WinAppDownloadType||(t.WinAppDownloadType={}));!function(e){e.Files="files";e.Recent="recent";e.Shared="shared";e.RecycleBin="recyclebin";e.Photos="photos";e.Discover="discover"}(t.NavigationPageName||(t.NavigationPageName={}));!function(e){e.Navigation="NavigationRequest";e.Click="ClickRequest";e.Search="SearchRequest";e.SearchSuggestionClick="SearchSuggestionClickRequest";e.TokenResponse="TokenResponse";e.TokenRequest="OAuthTokenRequest";e.EnableDiscover="EnableDiscoverCommand";e.LokiTokenRequest="LokiTokenRequest";e.SubstrateTokenRequest="SubstrateTokenRequest"}(t.WinAppCommands||(t.WinAppCommands={}))});
define("odsp-next/dataSources/worker/odc/WorkerDataSource",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/uri/SimpleUri"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this._urlCache={};var n=t.window,r=void 0===n?window:n;this._window=r}e.prototype.getWorkerUrl=function(e){var t=new r.default(e),n=this._window,i=n.location.protocol+"//"+n.location.host;if(t.authority!==i){var s=this._urlCache;if(s[e])return s[e];var o=n.URL.createObjectURL(new Blob(["importScripts("+JSON.stringify(e)+");"],{type:"text/javascript"}));s[e]=o;return o}return e};e.prototype.dispose=function(){var e=this._urlCache;for(var t in e)this._window.URL.revokeObjectURL(e[t])};return e}();t.default=i;t.resourceKey=n.createResolvedResourceKey(e("module").id,i,{})});
define("odsp-next/dataSources/zip/odc/ZipDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/navigation/AddressWriter","@ms/odsp-utilities/lib/resources/Resources","../../../resources/DataSourceResourceKeys","../ZipDataSource"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t,n){return e.call(this,t,n)||this}t.prototype.getContents=function(t,n){var i=this;if(n)return this._graphDataSource.getAuthenticationParams(t).then(function(s){var o=n+"?"+r.serializeQuery(s);return e.prototype.getContents.call(i,t,o)})};return t}(o.ZipDataSource);t.default=u;t.resourceKey=i.createResolvedResourceKey(e("module").id,u,{graphDataSource:s.graph,makeXHR:void 0})});
define("odsp-next/dataSources/zip/ZipDataSource",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/xhr/XHRPromise","@ms/utilities-error/lib/ApiError","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){this._graphDataSource=t.graphDataSource;this._makeXHR=t.makeXHR||i.default.start}e.prototype.getContents=function(e,t){return this._makeXHR({url:t}).then(function(t){var r=t.status;if(!(r>=200&&r<300))return n.default.reject(t);try{var i=JSON.parse(t.responseText).metadata,o=i.delimiter,u=i.error,f=i.list,l=void 0===f?[]:f;return{delimiter:o,error:u,root:{children:l,date:e.dateModified,extension:e.extension,isFolder:!0,name:e.name,childCount:l.length,parentFolder:void 0,path:"",size:0}}}catch(e){return n.default.reject(new s.ApiError({code:r+".InvalidResponse",message:e&&e.message,correlationId:a(t)}))}}).catch(function(e){var t,r=!1,i=e&&e.message,o="GetZipContents";if(e instanceof XMLHttpRequest){var u=e&&e.status;r=!!u&&u>=400&&u<500;t=a(e);o=e.getResponseHeader("X-ErrorCode")||"";try{for(var f=JSON.parse(e.responseText),l=f&&f.error;l.innererror;)l=l.innererror;if(l){i=l.message;o=l.code}}catch(e){i="Invalid JSON response"}o=u+"."+o}return n.default.reject(new s.ApiError({code:o,message:i,isExpected:r,correlationId:t}))})};return e}();t.ZipDataSource=u;function a(e){return e.getResponseHeader("X-CorrelationId")||void 0}t.resourceKey=r.createResolvedResourceKey(e("module").id,u,{graphDataSource:o.graph,makeXHR:void 0})});