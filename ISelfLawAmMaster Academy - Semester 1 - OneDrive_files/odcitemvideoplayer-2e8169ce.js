define("odsp-next/controls/oneUp/video/OneUpVideo",["require","exports","./OneUpVideoViewModel","../../../bindings/component/ControlBinding","./OneUpVideo.html","./OneUpVideo.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"od-one-up-video",name:e("module").id,template:e("./OneUpVideo.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/oneUp/video/OneUpVideoViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-utilities/lib/browser/PlatformDetection.key","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../actions/ShowTranscriptAction.key","../../../bindings/component/ControlBinding","../PaneProvider.key","../ToolbarProvider.key","../../video/controls/player/VideoPlayer","../../video/resources/VideoResourceKeys","../OneUpContentViewModel","../other/commands/ItemActionBar.key","../thumbnail/OneUpThumbnail","../../commands/Command","../../../utilities/features/Features","../../../utilities/icons/Icon","../../../resources/DataSourceResourceKeys","../../video/VideoPlayer.resx"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=function(e){n.__extends(t,e);function t(t,r){var s=e.call(this,t,r)||this;s.addBindingHandlers({control:a.default});var f=s.observables,l=s.showFrame=f.pureCompute(function(){var e=s.slide.item();return!(e.video&&(e.video.height||e.video.width)||!e.audio)}),p=g.isFeatureEnabled(g.UseNewFluentIcons)?"itemTypesFluent":"itemTypes";s.watermark=f.pureCompute(function(){var e=l()?"audiowatermark":"videowatermark";return window.require.toUrl("odsp-media/images/"+p.toLowerCase()+"/64/"+e+".svg")});s.watermarkAlt=f.pureCompute(function(){return s.slide.item().displayName});var b=f.pureCompute(function(){var e=s.oneUp.size();return l()?{width:Math.min(200,e.width),height:Math.min(200,e.height)}:e}),E=f.pureCompute(function(){return!l}),S=i.forSingleValue(),x=f.createCallback(S);s.showWatermark=f.pureCompute(function(){return!x()||x().resultType!==o.ResultTypeEnum.Success});var T=s.slide;s.thumbnailControl=a.toSpecification(v.default,{allowError:E,showErrorActions:!1,slide:n.__assign({},T,{loadState:f.create(0),loadResult:x}),oneUp:s.oneUp,size:b,isPreview:!0});s._isMobile=r.platformDetection.isMobile;T.isEditCaptionEnabled(!s._isMobile);var N=s._isPlaying=f.create(!1),C=s._isMaximized=f.create(!1);s.showVideo=f.pureCompute(function(){return!T.offset()});s.showThumbnail=f.pureCompute(function(){return l()||!s.showVideo()});var k=f.createCallback(S);s.scope.attach(T.loadResult.register(k));var L=T.loadState;L(2);var A=T.renderOptions,O=f.createCallback(i.forSingleValue());s.videoPlayer=a.toSpecification(c.default,{actionBar:A?a.toSpecification(d.resourceKey,{forceExternal:!0,item:T.item}):void 0,autoplay:!A||!!A.autofocus,result:k,item:T.item,isLoading:O,isPlaying:N,isMaximized:C});f.backgroundCompute(function(){L()<3&&(!k()||O()||C()||N()||L(3))});var M=s.resources;M.expose(h.playbackPanelProvider,r.toolbarProvider);M.expose(h.transcriptPanelProvider,r.paneProvider);var _=M.expose(h.showTranscript,f.create(!1)),D=s.oneUp.isInfoPaneExpanded;f.backgroundCompute(function(){f.unwrap(D)&&_(!1)}).extend({deferred:!0});g.isFeatureEnabled(g.MediaTranscript)&&!A&&s.trackPromise(M.consumeAsync(u.resourceKey.optional).then(function(e){e&&s.slide.augmentCommandSet({commands:f.createArray([new(s.managed(m.CommandViewModel))({action:s.scope.attach(new e({item:T.item,useToggleBehavior:!0})),engagementName:"ShowTranscript",icon:new y.default("CustomList"),isToggleable:!0,text:w.strings.transcriptCommand})])})}));f.compute(s._computeSetIsIdleEnabledFromIsPlaying);f.compute(s._computeChangesOnMaximized);return s}t.prototype._computeSetIsIdleEnabledFromIsPlaying=function(){this.slide.isIdleEnabled(this._isPlaying())};t.prototype._computeChangesOnMaximized=function(){var e=this._isMaximized();this.oneUp.isCommandBarVisible(!e);this.slide.isEditCaptionEnabled(!this._isMobile&&!e);r.computedContext.isInitial()||this.oneUp.isInfoPaneExpanded(!1)};t.dependencies=n.__assign({},p.default.dependencies,{paneProvider:f.resourceKey,platformDetection:s.platformDetection,toolbarProvider:l.resourceKey,videoItemDataSource:b.videoItem});return t}(p.default);t.default=E});
define("odsp-next/actions/ShowTranscriptAction.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ShowTranscriptAction"],t,n)}).then(function(e){return e.resourceKey.local})})})});
define("odsp-next/controls/video/controls/player/VideoPlayer",["require","exports","./VideoPlayerViewModel","../../../../bindings/component/ControlBinding","./VideoPlayer.html","./VideoPlayer.css","../canvas/VideoCanvas","../playbackPanel/PlaybackPanel","../../../transclusion/content/TransclusionContent"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"ms-item-videoplayer",name:e("module").id,template:e("./VideoPlayer.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/video/controls/player/VideoPlayerViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../../bindings/component/ControlBinding","../../../../providers/engagement/Engagement","../../../../resources/DataSourceResourceKeys","../../resources/VideoResourceKeys","../../VideoContext","../../VideoErrorType","../../../../bindings/fullScreen/FullScreenBinding","../../VideoPlaybackType","../../../../utilities/features/Features","../playbackPanel/PlaybackPanel","../transcriptPane/TranscriptPane","../../../../bindings/react/ReactBinding","@ms/odsp-utilities/lib/logging/events/UsageType","../../../../controls/transclusion/content/TransclusionContent"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=function(e){n.__extends(t,e);function t(t,r){var i=e.call(this,t,r)||this;i.addBindingHandlers({control:s.default,fullScreen:c.default,react:m.default});var o=i,l=o.observables,h=o.resources,b=r.engagement;i.item=t.item;i._isPlaying=t.isPlaying||l.create(!1);var w=t.result;i.actionBar=l.wrap(t.actionBar);var E=t.isLoading,S=i.context=h.expose(a.context,new(i.managed(f.default))({autoplay:t.autoplay,item:i.item}));E&&i.scope.attach(E.register(S.isLoading));i._isMaximized=t.isMaximized;i.playbackPanelHost={name:y.default.tagName,params:{provider:r.playbackPanelProvider}};i.playbackPanel={name:d.default.tagName,params:{}};var x=i.showTranscript=r.showTranscript;i.transcriptHost={name:y.default.tagName,params:{provider:r.transcriptPanelProvider}};i.correlationId=l.pureCompute(function(){var e=S.videoStatus(),t=e&&e.error;return t&&t.correlationId||""});if(p.isFeatureEnabled(p.MediaTranscript)){var T={canEdit:!1,context:S,isResolved:!1,onDismiss:function(){x(!1)}},N=l.create();i.resources.consumeAsync(u.transcript.optional).then(function(e){N(e)});i.transcriptPanel={componentType:v.default,props:l.pureCompute(function(){var e=t.item(),r=e&&e.transcript,i=r&&r.generateUrl,s=N();return s?n.__assign({},T,{canEdit:s.canEdit(e),key:e.key,isProcessing:!(!r||!r.isProcessing),isResolved:!r||r.isResolved,onSaveEntry:function(t){s.updateTranscriptEntry(e,t);b.logData({name:"SaveTranscriptEntry",usageType:g.UsageType[g.UsageType.Click],isIntentional:!0})},onStartTranscription:i?function(){s.startTranscription(e);b.logData({name:"StartTranscription",usageType:g.UsageType[g.UsageType.Click],isIntentional:!0})}:void 0}):T})}}w&&i.scope.attach(w.register(l.pureCompute(i._computeResult)));l.backgroundCompute(i._computeSetIsMaximized);l.backgroundCompute(i._computeUpdateIsPlaying);return i}t.prototype.dispose=function(){this._isPlaying(!1);e.prototype.dispose.call(this)};t.prototype.onStatusClicked=function(e,t){var n=this.context.videoStatus.peek().error;if(!n||n.isRetriable){this.context.isPlaying(!0);t.stopPropagation();t.preventDefault()}return!0};t.prototype.toggleIsMaximized=function(e,t){if(this.context.shouldUseNativeControls)return!0;this.context.isMaximized(!this.context.isMaximized.peek());return!1};t.prototype.getErrorType=function(e){var t=e&&e.type||l.default.unknown;return l.default[t]};t.prototype.getErrorDetails=function(e){return e&&(e.message||l.default[e.type])||""};t.prototype.getCorrelationId=function(e){return e&&e.correlationId||""};t.prototype._computeUpdateIsPlaying=function(){var e=this.context.isPlaying();this._isPlaying(e)};t.prototype._computeSetIsMaximized=function(){this._isMaximized(this.context.isMaximized())};t.prototype._computeResult=function(){var e=this.context;if(e.hasError()){var t=e.videoStatus().error,n=t.type?l.default[t.type]:"",r=t.code,s=t.correlationId;r&&(n+="."+r);var o=s?{CorrelationId:s}:{};return{error:t.message,resultCode:n,resultType:t.isExpected?i.ResultTypeEnum.ExpectedFailure:i.ResultTypeEnum.Failure,extraData:o}}if(e.canPlay()){var u=e.playbackType();return{resultType:i.ResultTypeEnum.Success,resultCode:u&&h.VideoPlaybackType[u]}}};t.dependencies=n.__assign({},r.default.dependencies,{playbackPanelProvider:a.playbackPanelProvider.optional,transcriptPanelProvider:a.transcriptPanelProvider.optional,showTranscript:a.showTranscript,engagement:o.resourceKey});return t}(r.default);t.default=b});
define("odsp-next/controls/video/resources/VideoResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.context=new n.ResourceKey("video.context");t.showTranscript=new n.ResourceKey("video.showTranscript");t.playbackPanelProvider=new n.ResourceKey("video.playbackPanelProvider");t.transcriptPanelProvider=new n.ResourceKey("video.transcriptPanelProvider")});
define("odsp-next/controls/video/VideoContext",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/browser/PlatformDetection","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-shared/lib/models/store/KnockoutDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","@ms/utilities-error/lib/ApiError","./VideoError","./VideoErrorType","./PlaybackMonitor","./VideoPlaybackType","./VideoPlayer.resx","../../utilities/flash/FlashHelper","../../utilities/features/Features","./controls/canvas/VideoCanvasType","../../resources/DataSourceResourceKeys","../../utilities/network/ConnectivityTester"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=[10,0,0],S=!1,x=!1,T=!1,N=!1,C=!1,k=0,L=!1,A=new s.default;!function(){var e=document.createElement("video");if(e&&e.canPlayType){try{e.volume=0;L=!0}catch(e){return}S=_(e,'video/mp4; codecs="avc1.42E01E, mp4a.40.2"');T=_(e,'audio/wav; codecs="1"');x=_(e,'video/webm; codecs="vp9, opus"');N=_(e,"application/vnd.apple.mpegURL")&&(A.isMac||A.isIOS);C=!(!S||!window.MediaSource&&!window.WebKitMediaSource);A.isWindows&&A.isChrome&&A.browserMajor<=34&&(C=!1);A.isSafari&&(C=!1)}}();var O=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.item=t.item;var r=n,i=r.observables,s=r.resources;n._networkTester=s.consume(w.resourceKey);n._videoItemDataSource=s.consume(b.videoItem);n._dataStore=n.addDisposable(new a.default("VideoPlayer",f.default.local));n.itemKey=i.pureCompute(n._computeItemKey);n.shouldAutoPlay=t.autoplay&&!A.isMobile;n.shouldUseNativeControls=n._computeShouldUseNativeControls();n.playbackType=i.create(d.default.htmlDashling);n.url=i.create(null);n.coverImageUrl=i.create("");n.isLoading=i.create(!1);n.canPlay=i.create(!1);n.isPlaying=i.create(n.shouldAutoPlay);n.isAdjustingVolume=i.create(!1);n.position=i.create(0);n.seekPercentage=i.create(0);n.isSeeking=i.create(!1);n.isScrubbing=i.create(!1);n.duration=i.create(0);n.bufferedRanges=i.createArray();n.isMaximized=i.create(!1);n.videoStatus=i.create(null);n.playingQuality=i.create(480);n.maxQuality=i.create(720);n.dashling=i.create();n.useBetaTranscode=i.create(g.isFeatureEnabled(g.UseAltTranscodeForDashManifests));n.disableTranscode=i.create(!1);n._errorsByType=i.create({});n.transcript=i.pureCompute(n._computeTranscript);n.activeTranscriptEntryIndex=i.createCallback(u.forSingleValue(-1));0;g.isFeatureEnabled(g.AllowVideoDiagnostics)&&(n.canShowDiagnostics=!0);n.isMuted=i.create(!1);n._dataStore.persistBoolean(n.isMuted,"isMuted");n.volume=i.create(1);n._dataStore.persistNumber(n.volume,"volume");n.desiredQuality=i.create(480);n._dataStore.persistNumber(n.desiredQuality,"desiredQuality");n.isABREnabled=i.create(!0);n._dataStore.persistBoolean(n.isABREnabled,"isABREnabled");n.isDiagnosticsEnabled=i.create(!1);n._dataStore.persistBoolean(n.isDiagnosticsEnabled,"isDiagnosticsEnabled");n.hasError=i.pureCompute(n._computeHasError);n.canvasType=i.pureCompute(n._computeCanvasType);n.canAdjustQuality=i.pureCompute(n._computeCanAdjustQuality);n.subscribe(n.item,n._onItemChanged);n.subscribe(n.isAdjustingVolume,n._onIsAdjustingVolumeChanged);n.subscribe(n.isPlaying,n._onIsPlayingChanged);i.backgroundCompute(n._evaluateItemPlayability);n._onItemChanged(n.item.peek());new(n.managed(p.default))({context:n});return n}t.prototype.setVideoStatus=function(e){var t,r=e.statusMessage,i=e.error,s=this._errorsByType.peek(),o=this.playbackType.peek(),u=s[o];if(g.isFeatureEnabled(g.VideoModeCascade)&&!u&&function(e){if(!e)return!1;var t=e.type,n=g.isFeatureEnabled(g.VideoModeCascadeTimeout);return t===h.default.htmlElementNetwork||t===h.default.htmlElementSrcNotSupported||t===h.default.htmlElementDecode||(e.isExpected||n&&function(e){var t=e.code;return!!t&&t.indexOf("timeout")>=0}(e))&&(t===h.default.htmlDashlingManifestDownload||t===h.default.htmlDashlingInitSegmentDownload||t===h.default.htmlDashlingMediaSegmentDownload)}(i)){var a=n.__assign({},s,((t={})[o]=e,t));this._errorsByType(a)}else{this.videoStatus({isVisible:!0,statusMessage:r,error:i});this.isLoading(!1);this.isPlaying(!1);this.canPlay(!1);if((!i||i.isRetriable)&&!this.isSeeking.peek()&&this.duration.peek()){var f=this.duration.peek(),l=f?this.position.peek()/f:0;this.seekPercentage(l);this.isSeeking(!0)}}};t.prototype.getRequestParametersAsync=function(e){return this._videoItemDataSource.getRequestParametersAsync(this.item.peek(),e)};t.prototype.testConnectivity=function(e){return r.default.resolve(this._networkTester.testConnectivity(e))};t.prototype.hasVideoQuality=function(e){var t=this.dashling.peek();return t&&t.hasVideoQuality?t.hasVideoQuality(e):e<=this.maxQuality.peek()};t.prototype._cancelGetDownload=function(){if(this._pendingGetDownloadPromise){this._pendingGetDownloadPromise.cancel();this._pendingGetDownloadPromise=null}};t.prototype._onIsPlayingChanged=function(e){var t=this,n=this.videoStatus.peek();if(e&&n.isVisible){var r=this.url.peek(),i=n.error;this.url(null);i&&i.requiresNewUrl?this._getNewDownloadUrl().done(function(e){t._reset(e,!0)}):this._reset(r,!0)}};t.prototype._computeItemKey=function(){var e=this.item();return e?e.key:null};t.prototype._computeHasError=function(){return this.videoStatus().isVisible};t.prototype._computeTranscript=function(){var e=this.item();return e&&e.transcript&&e.transcript.entries};t.prototype._computeCanAdjustQuality=function(){return this.playbackType()===d.default.htmlDashling};t.prototype._computeShouldUseNativeControls=function(){return A.isIOS};t.prototype._computeCanvasType=function(){switch(this.playbackType()){case d.default.flashDash:case d.default.flashMp4:return y.default.flash;default:return y.default.html}};t.prototype._onItemChanged=function(e){if(e&&this._lastItemKey!==e.key){this._lastItemKey=e.key;this._reset(null)}};t.prototype._reset=function(e,t){var n=this.item.peek(),r=n&&n.thumbnail,s=null;r&&(s=i.format(r.url,r.width,r.height));this._cancelGetDownload();this.coverImageUrl(s);this.videoStatus({isVisible:!1,error:void 0});this.isLoading(!0);this.canPlay(!1);if(!t){this.isSeeking(!1);this.seekPercentage(0);this.position(0);this.duration(0)}this.url(e);this.shouldAutoPlay&&this.isPlaying(!0)};t.prototype._onIsAdjustingVolumeChanged=function(e){e&&this.isMuted(!1)};t.prototype._getStreamingType=function(e){if(!this.disableTranscode()&&this._videoItemDataSource.isStreamingSupported(e)){if(C)return d.default.htmlDashling;if(N&&this._videoItemDataSource.isHlsPlaybackSupported())return d.default.htmlHls;if(0===k){this._evaluateFlashSupport();return d.default.flashPending}if(1===k)return d.default.flashPending;if(2===k)return d.default.flashDash}};t.prototype._getPlaybackType=function(e,t){if(!L)return d.default.none;var n=t[d.default.htmlMp4],r=!n&&this._canPlayAsNativeMp4(e),i=this._shouldPreferNative(e),s=t[d.default.htmlDashling]||t[d.default.htmlHls]||t[d.default.flashDash];if(r&&i)return d.default.htmlMp4;var o=this._getStreamingType(e);if(!s&&o)return o;var u=n||t[d.default.htmlFallback];return r?d.default.htmlMp4:u?o&&g.isFeatureEnabled(g.VideoModePreferStreamError)?o:this._getPlaybackType(e,{}):d.default.htmlFallback};t.prototype._evaluateItemPlayability=function(){var e=this,t=this.item(),n=!(!t||t.did||!t.video&&!t.audio),r=d.default.none,i=this.videoStatus(),s=t&&0===t.size,o=i.error,u=!o||o.isRetriable,a=this.useBetaTranscode(),f=this._lastBetaSetting;this._lastBetaSetting=a;var l=this._errorsByType();!s&&n&&(r=this._getPlaybackType(t,l));if(r===this.playbackType.peek()){if(i.isVisible&&!u){this.playbackType(d.default.none);return}if(t.key===this._lastItemKey&&this.url()&&a===f)return}if(s)this.setVideoStatus({statusMessage:v.strings.errorEmptyFile,error:new c.VideoError({code:"FromMetadata",type:h.default.emptyFile,isExpected:!0,isRetriable:!1})});else if(n){if(r!==d.default.flashPending)if(r!==d.default.none){this.playbackType(r);var p=l[r];if(p){this.setVideoStatus(p);return}this._getNewDownloadUrl().done(function(t){e._reset(t)})}else{var m=M()||h.default.unsupportedBrowser;this.setVideoStatus({statusMessage:v.strings.errorUnsupportedBrowser,error:new c.VideoError({code:"",type:m,isExpected:!0,isRetriable:!1})})}}else t&&!t.isPlaceholder&&this.setVideoStatus({statusMessage:v.strings.errorUnsupportedFormat,error:new c.VideoError({code:"NotVideo",type:h.default.unsupportedFormat,isExpected:!0,isRetriable:!1})})};t.prototype._evaluateFlashSupport=function(){var e=this;k=1;m.default.checkFlashSupport(E,function(t){if(!e.isDisposed){k=t?2:3;e._evaluateItemPlayability()}})};t.prototype._shouldPreferNative=function(e){var t=e.video,n=(void 0===t?{}:t).bitrate,r=void 0===n?void 0:n,i=(e.extension||"").toLowerCase();return!(!e.audio||".mp3"!==i)||(!!(r&&r<=3e6)||!r&&".mp4"===e.extension&&e.size<=5242880)};t.prototype._canPlayAsNativeMp4=function(e){if(4===e.itemStatus)return!1;var t=(e.extension||"").toLowerCase();if(e.audio&&".mp3"===t)return!0;if(x&&".webm"===t)return!0;var n=e?e.video:null;return n&&"H264"===n.fourCC&&S&&("PCM"!==n.audioFormat||T)};t.prototype._getNewDownloadUrl=function(){var e=this;if(this._pendingGetDownloadPromise)return this._pendingGetDownloadPromise;var t=this._videoItemDataSource.getDownloadUrl({item:this.item.peek(),playbackType:this.playbackType.peek(),useBetaTranscode:this.useBetaTranscode.peek()});this._pendingGetDownloadPromise=this.trackPromise(t);return this._pendingGetDownloadPromise.then(function(t){e._pendingGetDownloadPromise=null;return t},function(t){e._pendingGetDownloadPromise=null;if(!r.default.isCanceled(t)){var n=t instanceof Error&&t,i={code:t.name,type:h.default.getDownloadUrlFailure,message:n&&n.message,isRetriable:!1,requiresNewUrl:!0};if(n instanceof l.ApiError){i.correlationId=n.correlationId;i.code=n.code||n.name;i.isExpected=n.isExpected}e.setVideoStatus({statusMessage:v.strings.errorLoading,error:new c.VideoError(i)})}return r.default.reject(t)})};return t}(o.default);t.default=O;function M(){return L?S?C?void 0:h.default.mediaSourceUnsupported:h.default.h264Unsupported:h.default.html5VideoUnsupported}t.getMissingCapability=M;function _(e,t){try{var n=e.canPlayType(t);return n&&"no"!==n.toLowerCase()}catch(e){return!1}}});
define("@ms/odsp-shared/lib/models/store/KnockoutDataStore",["require","exports","tslib","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","@ms/odsp-utilities/lib/models/store/BaseDataStore","../../base/BaseModel"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n=r.default.none);var s=e.call(this)||this;s.dataStore=new i.default(t,n);return s}t.prototype.persistBoolean=function(e,t){var n=this,r=this.getValue(t);void 0!==r&&e("true"===r);this.subscribe(e,function(e){return n.setValue(t,String(e))})};t.prototype.persistNumber=function(e,t){var n=this,r=this.getValue(t);void 0!==r&&e(Number(r));this.subscribe(e,function(e){return n.setValue(t,String(e))})};t.prototype.persistString=function(e,t){var n=this,r=this.getValue(t);void 0!==r&&e(r);this.subscribe(e,function(e){return n.setValue(t,e)})};t.prototype.setValue=function(e,t,n){this.dataStore.setValue(e,t,n)};t.prototype.getValue=function(e,t){return this.dataStore.getValue(e,t)};t.prototype.remove=function(e,t){this.dataStore.remove(e,t)};return t}(s.default);t.default=o});
define("odsp-next/controls/video/VideoError",["require","exports","tslib","@ms/utilities-error/lib/ApiError","./VideoErrorType"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.type,s=void 0===r?i.default.unknown:r,o=t.isRetriable,u=void 0===o||o,a=t.requiresNewUrl,f=void 0!==a&&a;n.type=s;n.isRetriable=u;n.requiresNewUrl=f;return n}return t}(r.ApiError);t.VideoError=s});
define("odsp-next/controls/video/VideoErrorType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.none=0]="none";e[e.unknown=1]="unknown";e[e.unsupportedFormat=2]="unsupportedFormat";e[e.unsupportedBrowser=3]="unsupportedBrowser";e[e.getDownloadUrlFailure=4]="getDownloadUrlFailure";e[e.htmlElementDecode=5]="htmlElementDecode";e[e.htmlElementNetwork=6]="htmlElementNetwork";e[e.htmlElementAborted=7]="htmlElementAborted";e[e.htmlElementSrcNotSupported=8]="htmlElementSrcNotSupported";e[e.htmlElementOther=9]="htmlElementOther";e[e.htmlDashlingMediaSourceInit=10]="htmlDashlingMediaSourceInit";e[e.htmlDashlingManifestDownload=11]="htmlDashlingManifestDownload";e[e.htmlDashlingInitSegmentDownload=12]="htmlDashlingInitSegmentDownload";e[e.htmlDashlingMediaSegmentDownload=13]="htmlDashlingMediaSegmentDownload";e[e.htmlDashlingManifestParse=14]="htmlDashlingManifestParse";e[e.htmlDashlingVideoElementError=15]="htmlDashlingVideoElementError";e[e.htmlDashlingSourceBufferInit=16]="htmlDashlingSourceBufferInit";e[e.htmlDashlingSourceBufferAppendException=17]="htmlDashlingSourceBufferAppendException";e[e.htmlDashlingSourceBufferAppendMissing=18]="htmlDashlingSourceBufferAppendMissing";e[e.htmlDashlingOther=19]="htmlDashlingOther";e[e.htmlOther=20]="htmlOther";e[e.flashLoadTimeout=21]="flashLoadTimeout";e[e.flashOther=22]="flashOther";e[e.throttled=23]="throttled";e[e.unsupportedCodec=24]="unsupportedCodec";e[e.emptyFile=25]="emptyFile";e[e.bitRateTooHigh=26]="bitRateTooHigh";e[e.html5VideoUnsupported=27]="html5VideoUnsupported";e[e.h264Unsupported=28]="h264Unsupported";e[e.mediaSourceUnsupported=29]="mediaSourceUnsupported"}(n=t.VideoErrorType||(t.VideoErrorType={}));t.default=n});
define("odsp-next/controls/video/PlaybackMonitor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","./logging/VideoLoad.event","./logging/VideoSession.event","./logging/VideoSessionEndReason"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=0,f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.context;n._context=r;n.createComputed(n._computeResetInstance);n.createBackgroundComputed(n._computeReportLoad).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}});n.createBackgroundComputed(n._computeReportSession).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}});return n}t.prototype.dispose=function(){this._loadEvent&&this._reportLoadEnd({isDisposed:!0});this._sessionEvent&&this._reportSessionEnd({isDisposed:!0});e.prototype.dispose.call(this)};t.prototype._computeResetInstance=function(){this._context.itemKey();this._instanceNumber=++a;this._loadSequenceNumber=0;this._sessionSequenceNumber=0};t.prototype._computeReportLoad=function(){this._loadEvent?this._context.isLoading()||this._reportLoadEnd():this._context.isLoading()&&this._reportLoadStart()};t.prototype._computeReportSession=function(){this._sessionEvent?this._context.isPlaying()||this._reportSessionEnd():this._context.isPlaying()&&this._reportSessionStart()};t.prototype._reportLoadStart=function(){var e=this._context.item.peek(),t=e.audio,r=e.video;this._loadEvent=new s.default(n.__assign({name:"Video.Load",playbackType:this._context.playbackType.peek(),fileExtension:(e.extension||"").toLowerCase(),fileDuration:(r||t).duration},r?{fileBitrate:r.bitrate,width:r.width,height:r.height,audioFormat:r.audioFormat,fourCC:r.fourCC}:{},{instance:this._instanceNumber,sequence:this._loadSequenceNumber}));this._loadSequenceNumber++};t.prototype._reportLoadEnd=function(e){var t,n=(void 0===e?{}:e).isDisposed,r=void 0!==n&&n,s=this._context.videoStatus.peek(),o=s.error,u=o&&o.type,a=o&&o.message,f=o&&o.stack,l=o&&o.data;t=r?i.ResultTypeEnum.ExpectedFailure:s.isVisible?i.ResultTypeEnum.Failure:i.ResultTypeEnum.Success;this._loadEvent.end({resultType:t,errorType:u,errorMessage:a,extraData:{VideoError_stack:f,VideoError_data:l}});this._loadEvent=null};t.prototype._reportSessionStart=function(){var e=this._context.item.peek(),t=e.audio,r=e.video,s=(e.extension||"").toLowerCase();this._sessionEvent=new o.default(n.__assign({name:"Video.Session",playbackType:this._context.playbackType.peek(),fileExtension:s,fileDuration:(r||t).duration},r?{fileBitrate:r.bitrate,cameraMake:r.cameraMake,cameraModel:r.cameraModel,width:r.width,height:r.height,audioFormat:r.audioFormat,fourCC:r.fourCC}:{},{quality:this._context.playingQuality.peek(),maxQuality:this._context.maxQuality.peek(),instance:this._instanceNumber,sequence:this._sessionSequenceNumber}));var u=r?"Video":"Audio";this._sessionQosEvent=new i.Qos({name:"ItemViewer."+u+".Session",extraData:{extension:s}});this._sessionSequenceNumber++};t.prototype._reportSessionEnd=function(e){var t,r,o=(void 0===e?{}:e).isDisposed,a=void 0!==o&&o,f=this._context,l=f.videoStatus.peek(),c=l.error,h=c&&c.code,p=c&&c.correlationId,d=c&&c.isExpected,v=c&&c.message,m=c&&c.type,g=c&&c.stack,y=c&&c.data,b=this._sessionQosEvent,w=b.data.extraData,E=p?n.__assign({},w,{CorrelationId:p}):w,S=m?s.VideoErrorType[m]:"";h&&(S+="."+h);if(a){t=i.ResultTypeEnum.ExpectedFailure;r=u.default.closed}else if(l.isVisible){t=i.ResultTypeEnum.Failure;r=u.default.failed}else{var x=f.position.peek()/f.duration.peek()>.99,T=!f.isPlaying.peek();t=i.ResultTypeEnum.Success;r=x?u.default.ended:T?u.default.paused:u.default.unknown}b.end({resultCode:S||u.default[r],resultType:d?i.ResultTypeEnum.ExpectedFailure:t,error:v,extraData:E});this._sessionEvent.end({resultType:t,errorType:m,endReason:r,errorMessage:v,extraData:{VideoError_stack:g,VideoError_data:y}});this._sessionEvent=null;this._sessionQosEvent=null};return t}(r.default);t.default=f});
define("odsp-next/controls/video/logging/VideoLoad.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase","@ms/odsp-utilities/lib/logging/events/Qos.event","../VideoPlaybackType","../VideoErrorType","@ms/odsp-utilities/lib/logging/events/ResultTypeEnum"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.VideoPlaybackType=i.VideoPlaybackType;t.VideoErrorType=s.VideoErrorType;t.ResultTypeEnum=o.ResultTypeEnum;t.VideoLoad=n.createPairedEvent({eventName:"VideoLoad,Qos,",shortEventName:"VideoLoad"},{playbackType:{typeRef:i.VideoPlaybackType,type:6},errorType:{typeRef:s.VideoErrorType,type:6},errorMessage:1,sequence:2,instance:2,fileExtension:1,fileDuration:2,fileBitrate:2,width:2,height:2,fourCC:1,audioFormat:1},r.Qos);t.default=t.VideoLoad});
define("odsp-next/controls/video/VideoPlaybackType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e.none="none";e.flashDash="flashDash";e.flashMp4="flashMp4";e.flashPending="flashPending";e.htmlMp4="htmlMp4";e.htmlDashling="htmlDashling";e.htmlHls="htmlHls";e.htmlFallback="htmlFallback"}(n=t.VideoPlaybackType||(t.VideoPlaybackType={}));t.default=n});
define("odsp-next/controls/video/logging/VideoSession.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase","@ms/odsp-utilities/lib/logging/events/Qos.event","../VideoPlaybackType","../VideoErrorType","./VideoSessionEndReason","@ms/odsp-utilities/lib/logging/events/ResultTypeEnum"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.VideoPlaybackType=i.VideoPlaybackType;t.VideoErrorType=s.VideoErrorType;t.VideoSessionEndReason=o.VideoSessionEndReason;t.ResultTypeEnum=u.ResultTypeEnum;t.VideoSession=n.createPairedEvent({eventName:"VideoSession,Qos,",shortEventName:"VideoSession"},{playbackType:{typeRef:i.VideoPlaybackType,type:6},errorType:{typeRef:s.VideoErrorType,type:6},errorMessage:1,sequence:2,instance:2,fileExtension:1,fileDuration:2,fileBitrate:2,cameraMake:1,cameraModel:1,quality:2,maxQuality:2,width:2,height:2,fourCC:1,audioFormat:1,endReason:{typeRef:o.VideoSessionEndReason,type:6}},r.Qos);t.default=t.VideoSession});
define("odsp-next/controls/video/logging/VideoSessionEndReason",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.unknown=0]="unknown";e[e.closed=1]="closed";e[e.paused=2]="paused";e[e.ended=3]="ended";e[e.failed=4]="failed"}(n=t.VideoSessionEndReason||(t.VideoSessionEndReason={}));t.default=n});
define("odsp-next/utilities/flash/FlashHelper",["require","exports","@ms/odsp-utilities/lib/domUtils/DomUtils","@ms/odsp-utilities/lib/logging/ErrorHelper"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,s=function(){function e(){}e.checkFlashSupport=function(t,n){i?n(e._isVersionAcceptable(t)):e._evaluateFlash(t,n)};e._evaluateFlash=function(t,s){var o,u=10,a=document.body;if(window.ActiveXObject)try{var f=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");i=f?e._parseVersionString(f.Getletiable("$version")):[]}catch(e){i=[]}finally{l(e._isVersionAcceptable(t))}else{(o=n.default.ce("OBJECT")).style.position="absolute";o.style.left="99999px";o.setAttribute("type","application/x-shockwave-flash");a.appendChild(o);!function n(){var r;try{r=o.GetVariable("$version")}catch(e){}if(r){i=e._parseVersionString(r);l(e._isVersionAcceptable(t))}else if(u>0){u--;setTimeout(n,10)}else{a.removeChild(o);i=[];l(!1)}}()}function l(e){try{s(e)}catch(e){r.default.log(e)}}};e._parseVersionString=function(e){var t=(e||"").split(" "),n=t.length>1?t[1].split(","):"";return n.length>2?[parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10)]:[]};e._isVersionAcceptable=function(e){return!(!e||3!==e.length||3!==i.length||!(i[0]>e[0]||i[0]===e[0]&&i[1]>e[1]||i[0]===e[0]&&i[1]===e[1]&&i[2]>=e[2]))};return e}();t.default=s});
define("odsp-next/controls/video/controls/canvas/VideoCanvasType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}e.flash="flash";e.html="html";return e}();t.default=n});
define("odsp-next/utilities/network/ConnectivityTester",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/utilities-error/lib/ApiError"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this._navigator=t.navigator||window.navigator}e.prototype.testConnectivity=function(e){return!1===this._navigator.onLine?Promise.reject(new r.ApiError({code:"Offline",message:"Device is offline",isExpected:!0})):Promise.resolve()};return e}();t.ConnectivityTester=i;t.resourceKey=n.createResolvedResourceKey(e("module").id,i,{})});
define("odsp-next/bindings/fullScreen/FullScreenBinding",["require","exports","tslib","knockout","@ms/odsp-shared/lib/bindings/base/BaseBinding","../../utilities/ui/FullScreen"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._isMaximized=t.valueAccessor()||r.observable(!1);n.events.on(document,"fullscreenchange, webkitfullscreenchange, mozfullscreenchange, MSFullscreenChange",n._onFullScreenChanged);n.subscribe(n._isMaximized,n._onIsMaximizedChanged);return n}t.prototype._onIsMaximizedChanged=function(e){e?s.default.enterFullScreen():s.default.exitFullScreen()};t.prototype._onFullScreenChanged=function(){this._isMaximized(s.default.isFullScreen())};return t}(i.default);t.default=o});
define("odsp-next/controls/video/controls/playbackPanel/PlaybackPanel",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./PlaybackPanelViewModel","./PlaybackPanel.html","./PlaybackPanel.css","../../../contextualMenu/ContextualMenu"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.registerComponent({tagName:"od-playback-panel",template:e("./PlaybackPanel.html"),viewModel:r.default,synchronous:!0});t.default=i});
define("odsp-next/controls/video/controls/playbackPanel/PlaybackPanelViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","office-ui-fabric-react/lib/Styling","../../../../bindings/keyboard/KeyboardBinding","../../../commands/CommandViewModel","../../../../bindings/contextMenu/ContextMenuAlignment","../../VideoPlayer.resx","../../../../bindings/dismiss/DismissBinding","../../actions/SetVideoQualityAction","../../actions/ToggleVideoABRAction","../../actions/ToggleVideoDiagnosticsAction","@ms/odsp-utilities/lib/string/TimeFormatter","../../resources/VideoResourceKeys","../scrubBar/ScrubBar","../volumeMenu/VolumeMenu","../../../../utilities/features/Features","../../actions/ToggleVideoTranscodeAction","../../actions/ToggleVideoBetaTranscodeAction"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var w=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.context=n.resources.consume(d.context);n.scrubBarComponent={name:v.default.tagName,params:{}};n.volumeMenuComponent={name:m.default.tagName,params:{}};n.addBindingHandlers({dismiss:f.default,keyboard:s.default});var r=n.observables;n.currentTime=r.pureCompute(n._computeCurrentTime);n.totalTime=r.pureCompute(n._computeTotalTime);n.percentVolume=r.pureCompute(n._computePercentVolume);n.showVolumeMenu=n.createObservable(!1);n.showContextMenu=n.createObservable(!1);n.contextualMenuParams=void 0;n.labels={fullScreenLabel:r.pureCompute(n._computeFullSreenLabel),gearLabel:a.strings.qualityMenuHeader,playPauseLabel:r.pureCompute(n._computePlayPauseLabel),volumeLabel:a.strings.volumeLabel};n.showFullScreen=r.pureCompute(n._computeShowFullScreen);n.playState=r.pureCompute(n._computePlayState);n.playStateIcon=r.pureCompute(n._computePlayStateIcon);n.volumeStateIcon=r.pureCompute(n._computeVolumeStateIcon);n.maximizeStateIcon=r.pureCompute(n._computeMaximizeStateIcon);n.showSettings=r.pureCompute(n._computeShowSettings);n._allowBeta=g.isFeatureEnabled(g.UseAltTranscodeForDashManifests);return n}t.prototype.onPlayToggleClicked=function(e,t){this.context.isPlaying(!this.context.isPlaying.peek());return!1};t.prototype.onGearClicked=function(e,t){var n=this;if(!this.contextualMenuParams){var r=this.observables,i=[{value:1080,text:a.strings.qualityMenu1080},{value:720,text:a.strings.qualityMenu720},{value:480,text:a.strings.qualityMenu480},{value:360,text:a.strings.qualityMenu360},{value:240,text:a.strings.qualityMenu240}].map(function(e){return new(n.managed(o.default))({text:e.text,isToggleable:!0,action:new(n.managed(l.default))({quality:e.value})})}).concat([new o.default({text:a.strings.qualityMenuAuto,isToggleable:!0,hasLineBreakBefore:!0,action:new(this.managed(c.default))})]);if(this.context.canShowDiagnostics){i.push(new o.default({text:a.strings.showDiagnostics,isToggleable:!0,action:new(this.managed(h.default))}),new o.default({text:a.strings.forceNativePlayback,isToggleable:!0,action:new(this.managed(y.default))}));this._allowBeta&&i.push(new o.default({text:a.strings.useBetaTranscoding,isToggleable:!0,action:new(this.managed(b.default))}))}this.contextualMenuParams={items:r.createArray(i),alignment:u.default.BottomCenter,allowHorizontalMenuNudging:!0,isOpen:this.showContextMenu,isBeakVisible:r.create(!1),target:t.target,anchorElement:t.target}}this.showContextMenu(!this.showContextMenu.peek());return!1};t.prototype.onVolumeClicked=function(e,t){this.showVolumeMenu(!this.showVolumeMenu.peek());return!1};t.prototype.onMaximizedToggleClicked=function(e,t){this.context.isMaximized(!this.context.isMaximized.peek());return!1};t.prototype.getMuteButtonClass=function(){var e=this.context.volume();return this.context.isMuted()?"VolumeDisabled":0===e?"Volume0":e<=.3?"Volume1":e<=.6?"Volume2":"Volume3"};t.prototype._computeShowSettings=function(){return this.context.canShowDiagnostics||this.context.canAdjustQuality()};t.prototype._computeFullSreenLabel=function(){return this.context.isMaximized()?a.strings.exitFullScreenLabel:a.strings.fullScreenLabel};t.prototype._computePlayPauseLabel=function(){return this.context.isPlaying()?a.strings.pauseLabel:a.strings.playLabel};t.prototype._computeShowFullScreen=function(){return!!this.context.item().video};t.prototype._computeCurrentTime=function(){return p.formatTime(1e3*this.context.position())};t.prototype._computeTotalTime=function(){var e=1e3*this.context.duration();return isNaN(e)?"":p.formatTime(e)};t.prototype._computePercentVolume=function(){return Math.round(100*this.context.volume())+"%"};t.prototype._computePlayState=function(){return this.context.isPlaying()?"Pause":"Play"};t.prototype._computePlayStateIcon=function(){return i.getIconClassName(this.playState())};t.prototype._computeVolumeStateIcon=function(){return i.getIconClassName(this.getMuteButtonClass())};t.prototype._computeMaximizeStateIcon=function(){return i.getIconClassName(this.context.isMaximized()?"BackToWindow":"FullScreen")};return t}(r.default);t.default=w});
define("odsp-next/controls/video/actions/SetVideoQualityAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/VideoResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="SetVideoQuality";n._context=n.resources.consume(o.context);n._quality=t.quality;return n}t.prototype.onExecute=function(e,t){this._context.desiredQuality(this._quality);this._context.isABREnabled(!1);return i.default.wrap({resultType:s.ResultTypeEnum.Success})};t.prototype.onIsAvailable=function(){var e=this._context;if(!e.canAdjustQuality())return!1;e.maxQuality();return e.hasVideoQuality(this._quality)};t.prototype.onIsToggled=function(){var e=this._context;return this.isAvailable()&&this._quality===(e.isABREnabled()?e.playingQuality():e.desiredQuality())};return t}(r.default);t.default=u});
define("odsp-next/controls/video/actions/ToggleVideoABRAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/VideoResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(){var t=e.call(this,{})||this;t.name="ToggleVideoABR";t._context=t.resources.consume(o.context);return t}t.prototype.onExecute=function(e,t){var n=this._context.isABREnabled();n&&this._context.desiredQuality(this._context.playingQuality());this._context.isABREnabled(!n);return i.default.wrap({resultType:s.ResultTypeEnum.Success})};t.prototype.onIsToggled=function(){return this._context.isABREnabled()};return t}(r.default);t.default=u});
define("odsp-next/controls/video/actions/ToggleVideoDiagnosticsAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/VideoResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(){var t=e.call(this,{})||this;t.name="ToggleVideoDiagnostics";t._context=t.resources.consume(o.context);return t}t.prototype.onExecute=function(e,t){this._context.isDiagnosticsEnabled(!this._context.isDiagnosticsEnabled.peek());return i.default.wrap({resultType:s.ResultTypeEnum.Success})};t.prototype.onIsToggled=function(){return this._context.isDiagnosticsEnabled()};return t}(r.default);t.default=u});
define("@ms/odsp-utilities/lib/string/TimeFormatter",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=":",r=1e3,i=60*r,s=60*i;t.formatTime=function(e){var t="",o=!1;if(e>=s){var u=Math.floor(e/s);e%=s;t+=u+n;o=!0}var a=Math.floor(e/i);e%=i;a<10&&o&&(t+="0");t+=a+n;var f=Math.floor(e/r);f<10&&(t+="0");return t+=f}});
define("odsp-next/controls/video/controls/scrubBar/ScrubBar",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ScrubBarViewModel","./ScrubBar.html","./ScrubBar.css","../../../progressSpinnerFlat/ProgressSpinnerFlat"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.registerComponent({tagName:"od-scrub-bar",template:e("./ScrubBar.html"),viewModel:r.default,synchronous:!0});t.default=i});
define("odsp-next/controls/video/controls/scrubBar/ScrubBarViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../bindings/ScrubBinding","@ms/odsp-utilities/lib/string/TimeFormatter","../../../../bindings/keyboard/KeyboardBinding","../../resources/VideoResourceKeys"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.context=n.resources.consume(a.context);n.addBindingHandlers({scrub:s.default,keyboard:u.default});n.percentPlayed=n.createPureComputed(n._computePercentPlayed);n.seekTooltipPercentage=r.observable(0);n.isHovering=r.observable(!1);n.isSeekTooltipVisible=n.createPureComputed(n._computeTooltipVisible);n.seekTooltipTime=n.createPureComputed(n._computeSeekTooltipTime);n.seekTooltipLeft=r.observable(0);return n}t.prototype.onLeftKey=function(){this.context.seekPercentage(Math.max(0,this.context.seekPercentage.peek()-.05));return!1};t.prototype.onRightKey=function(){this.context.seekPercentage(Math.min(1,this.context.seekPercentage.peek()+.05));return!1};t.prototype._computePercentPlayed=function(){return(this.context.isSeeking()||this.context.isScrubbing()?100*this.context.seekPercentage():100*this.context.position()/this.context.duration())+"%"};t.prototype._computeSeekTooltipTime=function(){return o.formatTime(1e3*this.context.duration()*this.seekTooltipPercentage())};t.prototype._computeTooltipVisible=function(){return this.context.duration()&&this.isHovering()};return t}(i.default);t.default=f});
define("odsp-next/controls/video/bindings/ScrubBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.valueAccessor();n._options=r;if(r.value||r.isScrubbing){n.events.on(n.element,"click",n._onMouseClick);n.events.on(n.element,"mousedown",n._onMouseDown);n.events.on(n.element,"touchstart",n._onTouchStart,!0)}(r.isHovering||r.isHovering||r.clientX)&&n.events.on(n.element,"mouseenter",n._onMouseEnter);return n}t.prototype._updateContainerRect=function(){var e=this.element.getBoundingClientRect();this._containerRect={left:e.left,top:e.top,width:e.width,height:e.height}};t.prototype._onTouchStart=function(e){e.touches&&e.touches.length&&this._onMouseDown(e.touches[0])};t.prototype._onTouchMove=function(e){e.touches&&e.touches.length&&this._onMouseMove(e.touches[0])};t.prototype._onMouseEnter=function(e){this._updateContainerRect();this.events.on(this.element,"mouseleave",this._onMouseLeave);this.events.on(window,"mousemove",this._onMouseMove);this.events.on(window,"touchmove",this._onTouchMove);this._onMouseMove(e);this._isHovering=!0};t.prototype._onMouseLeave=function(e){this._isHovering=!1;this.events.off(this.element,"mouseleave");if(!this._isScrubbing){this.events.off(window,"mousemove");this.events.off(window,"touchmove")}};t.prototype._onMouseDown=function(e){this._updateContainerRect();this.events.on(window,"mouseup",this._onMouseUp);this.events.on(window,"touchend",this._onMouseUp,!0);if(!this._isHovering){this.events.on(window,"mousemove",this._onMouseMove);this.events.on(window,"touchmove",this._onTouchMove,!0)}this._isScrubbing=!0;this._onMouseMove(e);return!1};t.prototype._onMouseMove=function(e){var t=e.clientX-this._containerRect.left,n=Math.min(1,Math.max(0,t/this._containerRect.width));this._hoverValue=n;this._clientX=t;this._isScrubbing&&(this._value=n);return!1};t.prototype._onMouseUp=function(){this.events.off(window,"mouseup");this.events.off(window,"touchend");this._isScrubbing=!1;if(!this._isHovering){this.events.off(window,"mousemove");this.events.off(window,"touchmove")}return!1};t.prototype._onMouseClick=function(e){this._onMouseDown(e);this._onMouseUp();return!1};Object.defineProperty(t.prototype,"_value",{set:function(e){this._options.value&&this._options.value(e)},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isScrubbing",{get:function(){return!!this._options.isScrubbing&&this._options.isScrubbing.peek()},set:function(e){this._options.isScrubbing&&this._options.isScrubbing(e)},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_hoverValue",{set:function(e){this._options.hoverValue&&this._options.hoverValue(e)},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_isHovering",{get:function(){return!!this._options.isHovering&&this._options.isHovering.peek()},set:function(e){this._options.isHovering&&this._options.isHovering(e)},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"_clientX",{set:function(e){this._options.clientX&&this._options.clientX(e)},enumerable:!0,configurable:!0});return t}(r.default);t.default=i});
define("odsp-next/controls/video/controls/scrubBar/ScrubBar.html",[],function(){return'<div class=od-ScrubBar data-bind="keyboard: { mappings: { Left: onLeftKey, Right: onRightKey, preventDefault: true } }, css: { \'od-ScrubBar--isLoading\': context.isPlaying() && context.isLoading() }"><div data-bind="component: { name: \'ms-progressSpinnerFlat\' }"></div><div class=od-ScrubBar-bar tabindex=0 data-bind="scrub: { value: context.seekPercentage, hoverValue: seekTooltipPercentage, isScrubbing: context.isScrubbing, isHovering: isHovering, clientX: seekTooltipLeft }"><div class=od-ScrubBar-fill data-bind="foreach: context.bufferedRanges"><div class=od-ScrubBar-buffered data-bind="style: {left: left, width: width}"></div></div><div class=od-ScrubBar-scrubArea><div class=od-ScrubBar-thumb data-bind="style: { width: percentPlayed }"></div></div></div><div class=od-ScrubBar-tooltip data-bind="css: { \'od-ScrubBar-tooltip--isScrubbing\': isSeekTooltipVisible }, text: seekTooltipTime, style: { left: seekTooltipLeft() + \'px\' }"></div></div>'});
define("odsp-next/controls/video/controls/scrubBar/ScrubBar.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ScrubBar{position:relative}.od-ScrubBar .ProgressSpinnerFlat{display:none}.od-ScrubBar--isLoading .ProgressSpinnerFlat{display:block;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:absolute;left:0;right:0;bottom:4px}.od-ScrubBar-content{overflow:hidden;position:relative}.od-ScrubBar-bar{height:26px;position:relative;cursor:pointer}.od-ScrubBar-bar:focus{outline:1px solid transparent;box-shadow:0 0 0 1px #767676 inset}.od-ScrubBar-scrubArea{height:100%;position:relative}.od-ScrubBar-thumb{background-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";height:2px;position:absolute;top:12px;left:0}.od-ScrubBar-thumb::after{content:'';position:absolute;top:-10px;right:-11px;width:18px;height:18px;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";border-radius:50px;border:2px solid "},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:"}.od-ScrubBar-fill{top:12px;width:100%;height:2px;position:absolute;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";box-shadow:0 0 1px rgba(255,255,255,.5);overflow:hidden;-webkit-mask-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAA5JREFUeNpiYGBgAAgwAAAEAAGbA+oJAAAAAElFTkSuQmCC)}.od-ScrubBar-bar:hover .od-ScrubBar-fill::after{content:'';position:absolute;left:0;top:0;height:2px;right:0;background:rgba(255,255,255,.1)}.od-ScrubBar-buffered{position:absolute;left:0;top:0;height:2px;background-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:"}.od-ScrubBar-tooltip{position:absolute;pointer-events:none;min-width:30px;height:25px;line-height:25px;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";color:"},{theme:"black",defaultValue:"#000000"},{rawString:";top:-22px;box-shadow:0 0 10px -3px;border-radius:1px;padding:0 8px;font-size:12px;text-align:center;-ms-transform:translate(-50%,50%);transform:translate(-50%,50%);opacity:0}.od-ScrubBar-tooltip--isScrubbing{transition:transform .2s ease-out,opacity .2s linear;-ms-transform:translate(-50%,0);transform:translate(-50%,0);opacity:1}.od-ScrubBar-tooltip:before{content:'';position:absolute;width:10px;height:10px;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";bottom:-5px;left:50%;margin-left:-5px;-ms-transform:rotate(45deg);transform:rotate(45deg)}"}])});
define("odsp-next/controls/video/controls/volumeMenu/VolumeMenu",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./VolumeMenuViewModel","./VolumeMenu.html","./VolumeMenu.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.registerComponent({tagName:"od-volume-menu",template:e("./VolumeMenu.html"),viewModel:r.default,synchronous:!0});t.default=i});
define("odsp-next/controls/video/controls/volumeMenu/VolumeMenuViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","office-ui-fabric-react/lib/Styling","../../../overlays/Overlay","../../../../bindings/dismiss/DismissBinding","../../bindings/ScrubBinding","../../VideoPlayer.resx","../../../../bindings/keyboard/KeyboardBinding","../../resources/VideoResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.overlayComponent={name:s.default.tagName,params:{alignToParent:!0}};n.context=n.resources.consume(l.context);n.addBindingHandlers({dismiss:o.default,scrub:u.default,keyboard:f.default});n.volume=n.createPureComputed(n._computeVolume);n.percentVolume=n.createPureComputed(n._computePercentVolume);n.volumeLabel=n.createComputed(n._computeVolumeLabel);n.icon=n.createPureComputed(n._computeIcon);return n}t.prototype.onLeftKey=function(){this.context.volume(Math.max(0,this.context.volume.peek()-.01));return!1};t.prototype.onRightKey=function(){this.context.volume(Math.min(1,this.context.volume.peek()+.01));return!1};t.prototype.onMuteToggleClicked=function(e,t){this.context.isMuted(!this.context.isMuted.peek());return!1};t.prototype.getMuteButtonClass=function(){var e=this.context.volume();return this.context.isMuted()?"VolumeDisabled":0===e?"Volume0":e<=.3?"Volume1":e<=.6?"Volume2":"Volume3"};t.prototype._computeVolume=function(){return Math.round(100*this.context.volume())};t.prototype._computePercentVolume=function(){return this.volume()+"%"};t.prototype._computeVolumeLabel=function(){return this.context.isMuted()?a.strings.unmuteTooltip:a.strings.muteTooltip};t.prototype._computeIcon=function(){return i.getIconClassName(this.getMuteButtonClass())};return t}(r.default);t.default=c});
define("odsp-next/controls/video/controls/volumeMenu/VolumeMenu.html",[],function(){return'\x3c!--ko component: overlayComponent--\x3e<div role=slider class=od-VolumeMenu data-bind="keyboard: { mappings: { Left: onLeftKey, Right: onRightKey, preventDefault: true } }"><button class="od-VolumeMenu-button ms-Icon" data-bind="hasFocus: true, attr: { \'aria-label\': volumeLabel, }, class: icon, click: onMuteToggleClicked"></button><div class=od-VolumeMenu-bar tabindex=0 data-bind="scrub: { value: context.volume, isScrubbing: context.isAdjustingVolume }"><div class=od-VolumeMenu-scrubFill></div><div class=od-VolumeMenu-scrubArea><div class=od-VolumeMenu-scrubThumb data-bind="style: { width: percentVolume }"></div></div></div><div class=od-VolumeMenu-volume data-bind="text: volume"></div></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/video/controls/volumeMenu/VolumeMenu.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-VolumeMenu{width:310px;height:56px;position:absolute;top:-56px;border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";opacity:.9}[dir=ltr] .od-VolumeMenu{left:-132px}[dir=rtl] .od-VolumeMenu{right:-132px}.od-VolumeMenu-button{width:40px;height:40px;margin:8px 4px;border:none;vertical-align:top;box-sizing:border-box;font-size:21px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";background-color:transparent;cursor:pointer}.od-VolumeMenu-button:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-VolumeMenu-button:active{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.od-VolumeMenu-volume{display:inline-block;vertical-align:top;line-height:58px;margin:0 8px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";width:26px}.od-VolumeMenu-bar{width:204px;height:30px;margin:13px 8px;display:inline-block;position:relative;cursor:pointer}.od-VolumeMenu-bar:focus{outline:1px solid transparent;box-shadow:0 0 0 1px #767676 inset}.od-VolumeMenu-scrubArea{height:100%;margin-right:10px;position:relative}.od-VolumeMenu-scrubThumb{background-color:"},{theme:"themeDarkAlt",defaultValue:"#106ebe"},{rawString:";height:10px;position:absolute;top:10px;left:0;border-radius:5px 0 0 5px;padding-left:5px}.od-VolumeMenu-scrubThumb::after{content:'';position:absolute;top:0;right:-5px;width:10px;height:10px;background-color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";border-radius:5px}.od-VolumeMenu-scrubFill{top:10px;width:100%;height:10px;position:absolute;background-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";border-radius:5px;box-shadow:0 0 1px rgba(255,255,255,.5);overflow:hidden;-webkit-mask-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAIAAACQd1PeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAA5JREFUeNpiYGBgAAgwAAAEAAGbA+oJAAAAAElFTkSuQmCC)}.od-VolumeMenu-bar:hover .od-VolumeMenu-scrubFill::after{content:'';position:absolute;left:0;top:0;height:10px;right:0;background:rgba(255,255,255,.1);border-radius:5px}"}])});
define("odsp-next/controls/video/actions/ToggleVideoTranscodeAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/VideoResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(){var t=e.call(this,{})||this;t.name="ToggleVideotranscode";t._context=t.resources.consume(o.context);return t}t.prototype.onExecute=function(e,t){var n=this._context.disableTranscode.peek();this._context.disableTranscode(!n);return i.default.wrap({resultType:s.ResultTypeEnum.Success})};t.prototype.onIsToggled=function(){return this._context.disableTranscode()};return t}(r.default);t.default=u});
define("odsp-next/controls/video/actions/ToggleVideoBetaTranscodeAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/VideoResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(){var t=e.call(this,{})||this;t.name="ToggleVideoBetatranscode";t._context=t.resources.consume(o.context);return t}t.prototype.onExecute=function(e,t){var n=this._context.useBetaTranscode.peek();this._context.useBetaTranscode(!n);return i.default.wrap({resultType:s.ResultTypeEnum.Success})};t.prototype.onIsAvailable=function(){return!this._context.disableTranscode()};t.prototype.onIsToggled=function(){return this.isAvailable()&&this._context.useBetaTranscode()};return t}(r.default);t.default=u});
define("odsp-next/controls/video/controls/playbackPanel/PlaybackPanel.html",[],function(){return'<div class=od-PlaybackPanel>\x3c!--ko component: scrubBarComponent--\x3e\x3c!--/ko--\x3e<div class=od-PlaybackPanel-bottom><span class=od-PlaybackPanel-timePlayed data-bind="text: currentTime"></span> <span class=od-PlaybackPanel-buttons><button class="od-PlaybackPanel-button ms-Icon" data-bind="click: onPlayToggleClicked, attr: { \'aria-label\': labels.playPauseLabel, \'data-playstate\': playState }, keyboard: { target: document, mappings: { Space: onPlayToggleClicked } }, class: playStateIcon"></button><div class=od-PlaybackPanel-volume data-bind="dismiss: { isOpen: showVolumeMenu }"><button class="od-PlaybackPanel-button ms-Icon" data-bind="attr: { \'aria-label\': labels.volumeLabel }, class: volumeStateIcon, click: onVolumeClicked"></button>\x3c!--ko if: showVolumeMenu--\x3e<div class=od-PlaybackPanel-volumeMenu data-bind="component: volumeMenuComponent"></div>\x3c!--/ko--\x3e</div>\x3c!--ko if: showFullScreen--\x3e<button class="od-PlaybackPanel-button ms-Icon" data-bind="attr: { \'aria-label\': labels.fullScreenLabel }, click: onMaximizedToggleClicked, keyboard: { target: document, mappings: { AltEnter: onMaximizedToggleClicked } }, class: maximizeStateIcon"></button>\x3c!--/ko--\x3e<div class=od-PlaybackPanel-gear data-bind="dismiss: { isOpen: showContextMenu }"><button class="od-PlaybackPanel-button ms-Icon ms-Icon--Settings" data-bind="icon: true, attr: { \'aria-label\': labels.gearLabel }, visible: showSettings, click: onGearClicked"></button>\x3c!--ko if: showContextMenu--\x3e<div class=od-PlaybackPanel-gearMenu data-bind="component: { name: \'ms-contextual-menu\', params: contextualMenuParams }"></div>\x3c!--/ko--\x3e</div></span> <span class=od-PlaybackPanel-totalTime data-bind="text: totalTime"></span></div></div>'});
define("odsp-next/controls/video/controls/playbackPanel/PlaybackPanel.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-VideoPanel{width:600px;height:400px;background:"},{theme:"black",defaultValue:"#000000"},{rawString:";position:relative}.od-PlaybackPanel{padding:0 28px;white-space:nowrap;background-color:rgba(255,255,255,.75)}.od-PlaybackPanel-bottom{position:relative;height:50px}.od-PlaybackPanel-timePlayed{float:left;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:14px}.od-PlaybackPanel-totalTime{float:right;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";font-size:14px}.od-PlaybackPanel-buttons{position:absolute;left:0;right:0;text-align:center}.od-PlaybackPanel-button{width:40px;height:40px;padding:0;margin:0 4px;border:none;box-sizing:border-box;font-size:21px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";background-color:transparent;cursor:pointer}.od-PlaybackPanel-button:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-PlaybackPanel-button:active{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.od-PlaybackPanel-volume{display:inline-block;position:relative}.od-PlaybackPanel-volumeMenu{position:absolute;top:0}.od-PlaybackPanel-gear{position:relative;display:inline}.od-PlaybackPanel-gearMenu{position:absolute;bottom:100%;margin-bottom:12px}[dir=ltr] .od-PlaybackPanel-gearMenu{left:50%}[dir=rtl] .od-PlaybackPanel-gearMenu{right:50%}.od-PlaybackPanel .ms-ContextualMenu{position:static}.md .od-PlaybackPanel-time,.sm .od-PlaybackPanel-time{width:40px}"}])});
define("odsp-next/controls/video/controls/transcriptPane/TranscriptPane",["require","exports","tslib","react","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Spinner","@ms/item-viewer-addon-video/lib/components/transcriptList/TranscriptList","../../../base/react/WithKnockoutComputed","../../VideoPlayer.resx","../../../panelHost/PanelHost.resx","@uifabric/utilities/lib/KeyCodes","./TranscriptPane.css"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onActivateEntry=function(e,t){var r=n.props.context,i=r.isPlaying;if(t&&!n.state.isEditing){n.setState({willResume:i.peek()});i(!1)}var s=r.transcript.peek(),o=s&&e>=0&&e<s.length&&s[e];if(o){r.isScrubbing(!0);var u=o.start+.01,a=r.duration.peek(),f=Math.min(1,Math.max(0,u/a));r.seekPercentage(f);r.isScrubbing(!1)}n.setState(function(n){return{activeIndex:o?e:n.activeIndex,isEditing:t}})};n._onSaveEntry=function(e){var t=n.props.context.isPlaying;n.props.onSaveEntry&&n.props.onSaveEntry(e);n.setState({isEditing:!1});t.peek()||t(n.state.willResume)};n._onStartTranscription=function(){n.props.onStartTranscription&&n.props.onStartTranscription()};n._onKeyDown=function(e){if(e.which===l.KeyCodes.escape){e.stopPropagation();e.preventDefault();e.nativeEvent.stopImmediatePropagation();n.props.onDismiss();return!1}};n.state={activeIndex:t.activeEntryIndex,isEditing:!1,willResume:!1};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.activeEntryIndex!==this.props.activeEntryIndex&&this.setState({activeIndex:e.activeEntryIndex})};t.prototype.render=function(){var e=this.props,t=window.require.toUrl("odsp-media/images/transcriptions/transcript_start_state_cat.svg");return r.createElement("div",{role:"contentinfo",className:"od-transcriptPane",onKeyDown:this._onKeyDown},r.createElement("h2",{className:"od-transcriptHeader"},a.strings.transcriptHeader),r.createElement(i.IconButton,{iconProps:{iconName:"Cancel"},className:"od-transcriptClose",onClick:e.onDismiss,title:f.strings.closePanelLabel}),r.createElement("div",{className:"od-transcriptList",role:"presentation"},e.isResolved?r.createElement(o.TranscriptList,{disableTranscriptButton:e.isProcessing,canEdit:e.canEdit,isEditing:this.state.isEditing,onActivateEntry:this._onActivateEntry,onSaveEntry:this._onSaveEntry,onStartTranscription:this._onStartTranscription,activeEntryIndex:this.state.activeIndex,transcript:this.props.transcript,imgSrc:t}):r.createElement(s.Spinner,{size:s.SpinnerSize.large})))};return t}(r.PureComponent),h=u.withKnockoutComputed(function(e){var t=e.context;return{canEdit:e.canEdit,context:t,isProcessing:e.isProcessing,isResolved:e.isResolved,onDismiss:e.onDismiss,onSaveEntry:e.onSaveEntry,transcript:t.transcript(),activeEntryIndex:t.activeTranscriptEntryIndex(),onStartTranscription:e.onStartTranscription}})(c);t.default=h});
define("office-ui-fabric-react/lib/Spinner",["require","exports","tslib","./components/Spinner/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("office-ui-fabric-react/lib/components/Spinner/index",["require","exports","tslib","./Spinner","./Spinner.base","./Spinner.types"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t)});
define("office-ui-fabric-react/lib/components/Spinner/Spinner",["require","exports","../../Utilities","./Spinner.base","./Spinner.styles"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Spinner=n.styled(r.SpinnerBase,i.getStyles,void 0,{scope:"Spinner"})});
define("office-ui-fabric-react/lib/components/Spinner/Spinner.base",["require","exports","tslib","react","./Spinner.types","../../Utilities"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s.classNamesFunction(),u=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.type,u=e.size,a=e.ariaLabel,f=e.ariaLive,l=e.styles,c=e.label,h=e.theme,p=e.className,d=e.labelPosition,v=a,m=s.getNativeProps(this.props,s.divProperties,["size"]),g=u;void 0===g&&void 0!==t&&(g=t===i.SpinnerType.large?i.SpinnerSize.large:i.SpinnerSize.medium);var y=o(l,{theme:h,size:g,className:p,labelPosition:d});return r.createElement("div",n.__assign({},m,{className:y.root}),r.createElement("div",{className:y.circle}),c&&r.createElement("div",{className:y.label},c),v&&r.createElement("div",{role:"status","aria-live":f},r.createElement(s.DelayedRender,null,r.createElement("div",{className:y.screenReaderText},v))))};t.defaultProps={size:i.SpinnerSize.medium,ariaLive:"polite",labelPosition:"bottom"};return t}(s.BaseComponent);t.SpinnerBase=u});
define("office-ui-fabric-react/lib/components/Spinner/Spinner.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.xSmall=0]="xSmall";e[e.small=1]="small";e[e.medium=2]="medium";e[e.large=3]="large"}(t.SpinnerSize||(t.SpinnerSize={}));!function(e){e[e.normal=0]="normal";e[e.large=1]="large"}(t.SpinnerType||(t.SpinnerType={}))});
define("office-ui-fabric-react/lib/components/Spinner/Spinner.styles",["require","exports","./Spinner.types","../../Styling"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i={root:"ms-Spinner",circle:"ms-Spinner-circle",label:"ms-Spinner-label"},s=r.keyframes({"0%":{transform:"rotate(0deg)"},"100%":{transform:"rotate(360deg)"}});t.getStyles=function(e){var t,o=e.theme,u=e.size,a=e.className,f=e.labelPosition,l=o.palette,c=r.getGlobalClassNames(i,o);return{root:[c.root,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},"top"===f&&{flexDirection:"column-reverse"},"right"===f&&{flexDirection:"row"},"left"===f&&{flexDirection:"row-reverse"},a],circle:[c.circle,{boxSizing:"border-box",borderRadius:"50%",border:"1.5px solid "+l.themeLight,borderTopColor:l.themePrimary,animationName:s,animationDuration:"1.3s",animationIterationCount:"infinite",animationTimingFunction:"cubic-bezier(.53,.21,.29,.67)",selectors:(t={},t[r.HighContrastSelector]={borderTopColor:"Highlight"},t)},u===n.SpinnerSize.xSmall&&["ms-Spinner--xSmall",{width:12,height:12}],u===n.SpinnerSize.small&&["ms-Spinner--small",{width:16,height:16}],u===n.SpinnerSize.medium&&["ms-Spinner--medium",{width:20,height:20}],u===n.SpinnerSize.large&&["ms-Spinner--large",{width:28,height:28}]],label:[c.label,{color:l.themePrimary,margin:"10px 0 0",textAlign:"center"},"top"===f&&{margin:"0 0 10px"},"right"===f&&{margin:"0 0 0 10px"},"left"===f&&{margin:"0 10px 0 0"}],screenReaderText:r.hiddenContentStyle}}});
define("@ms/item-viewer-addon-video/lib/components/transcriptList/TranscriptList",["require","exports","tslib","react","react","react-dom","office-ui-fabric-react/lib/components/List/index","office-ui-fabric-react/lib/components/ScrollablePane/index","../transcriptEntry/index","../startTranscription/index","../pendingTranscription/index","../illustration/IllustrationContainer","office-ui-fabric-react/lib/FocusZone","../Transcription.resx","office-ui-fabric-react/lib/Utilities"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v={activeEntryIndex:0,isEditing:!1,canEdit:!1,onSaveEntry:function(){console.log("onSaveEntry")},onActivateEntry:function(){console.log("onActivateEntry")},setActiveElement:function(e){console.log("setActiveElement")}};t.TranscriptContext=r.createContext(v);var m=function(e,n){void 0===n&&(n=-1);return e?r.createElement(t.TranscriptContext.Consumer,null,function(t){return r.createElement(a.TranscriptEntry,{id:e.id,text:e.text,language:e.language,start:e.start,index:n,activeEntryIndex:t.activeEntryIndex,onSaveEntry:t.onSaveEntry,onActivateEntry:t.onActivateEntry,isEditing:t.isEditing,canEdit:t.canEdit,setActiveElement:t.setActiveElement})}):null},g=function(e){n.__extends(i,e);function i(t){return e.call(this,t)||this}i.prototype.render=function(){var e={activeEntryIndex:this.props.activeEntryIndex,isEditing:this.props.isEditing,canEdit:this.props.canEdit,onActivateEntry:this.props.onActivateEntry,onSaveEntry:this.props.onSaveEntry,setActiveElement:this.props.setActiveElement};return r.createElement(t.TranscriptContext.Provider,{value:e},this.props.children)};return i}(r.PureComponent);t.TranscriptListProvider=g;var y=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._shouldAutoScroll=function(){var e=n._activeEntry,t=e?e.getBoundingClientRect().top:0;if(n._list){var r=s.findDOMNode(n._list),i=r&&r.offsetTop,o=e&&e.offsetParent.getBoundingClientRect().bottom;return t>i&&t<o}return!0};n._setActiveElement=function(e){n._activeEntry=e};n._isInnerZoneKeystroke=function(e){if(e.which===d.getRTLSafeKeyCode(d.KeyCodes.enter)){var t=e.target,r=t&&t.querySelector(".transcriptEntryRow"),i=r&&Number(r.dataset.itemKey);i>-1&&n.props.onActivateEntry(i,!0);return!0}return!1};n._resolveList=function(e){n._list=e};n._list=void 0;n._activeEntry=null;n._scrollablePane=i.createRef();n.state={scrollPosition:0};return n}t.prototype.componentDidUpdate=function(e,t){var n=this._scrollablePane&&this._scrollablePane.current,r=n&&n.getScrollPosition(),i=this.props,s=i.activeEntryIndex,o=!i.isEditing;if(o){o=!(r!==this.state.scrollPosition)||this._shouldAutoScroll()}if(o&&e.activeEntryIndex!==s){this._list&&this._list.scrollToIndex(s);this.setState({scrollPosition:n&&n.getScrollPosition()||0})}};t.prototype.render=function(){var e=this.props,t=e.transcript,i=e.onStartTranscription,s=e.disableTranscriptButton,a=e.imgSrc,d=!s&&"object"==typeof t,v=t&&t.length>0;return d&&v?r.createElement(g,n.__assign({},n.__assign({},this.props,{setActiveElement:this._setActiveElement})),r.createElement(u.ScrollablePane,{componentRef:this._scrollablePane},r.createElement(h.FocusZone,{direction:h.FocusZoneDirection.vertical,isInnerZoneKeystroke:this._isInnerZoneKeystroke},r.createElement(o.List,{ref:this._resolveList,items:t,onRenderCell:m})))):d&&!v?r.createElement(c.IllustrationContainer,{imgSrc:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/empty_transcript_illustration.svg",description:p.default.notAbleToTranscribe}):i&&!d?r.createElement(f.StartTranscription,{onStartTranscription:i,disableTranscriptButton:s,imgSrc:a}):r.createElement(l.PendingTranscription,{disableTranscriptButton:s})};return t}(r.Component);t.TranscriptList=y});
define("office-ui-fabric-react/lib/components/List/index",["require","exports","tslib","./List","./List.types"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("office-ui-fabric-react/lib/components/List/List",["require","exports","tslib","react","../../Utilities","./List.types"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=16,u=100,a=500,f=200,l=500,c={top:-1,bottom:-1,left:-1,right:-1,width:0,height:0},h=function(e){return e.getBoundingClientRect()},p=h,d=h,v=function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._root=r.createRef();i._surface=r.createRef();i._onRenderPage=function(e,t){for(var s=i.props,o=s.onRenderCell,u=s.role,a=e.page,f=a.items,l=void 0===f?[]:f,c=a.startIndex,h=n.__rest(e,["page"]),p=void 0===u?"listitem":"presentation",d=[],v=0;v<l.length;v++){var m=c+v,g=l[v],y=i.props.getKey?i.props.getKey(g,m):g&&g.key;null==y&&(y=m);d.push(r.createElement("div",{role:p,className:"ms-List-cell",key:y,"data-list-index":m,"data-automationid":"ListCell"},o&&o(g,m,i.state.isScrolling)))}return r.createElement("div",n.__assign({},h),d)};i.state={pages:[],isScrolling:!1};i._estimatedPageHeight=0;i._totalEstimates=0;i._requiredWindowsAhead=0;i._requiredWindowsBehind=0;i._measureVersion=0;i._onAsyncScroll=i._async.debounce(i._onAsyncScroll,u,{leading:!1,maxWait:a});i._onAsyncIdle=i._async.debounce(i._onAsyncIdle,f,{leading:!1});i._onAsyncResize=i._async.debounce(i._onAsyncResize,o,{leading:!1});i._onScrollingDone=i._async.debounce(i._onScrollingDone,l,{leading:!1});i._cachedPageHeights={};i._estimatedPageHeight=0;i._focusedIndex=-1;i._pageCache={};return i}t.prototype.scrollToIndex=function(e,t,n){void 0===n&&(n=s.ScrollToMode.auto);for(var r=this.props.startIndex,i=r+this._getRenderCount(),o=this._allowedRect,u=0,a=1,f=r;f<i;f+=a){var l=this._getPageSpecification(f,o),c=l.height;a=l.itemCount;if(f<=e&&f+a>e){if(t&&this._scrollElement){for(var h=d(this._scrollElement),p={top:this._scrollElement.scrollTop,bottom:this._scrollElement.scrollTop+h.height},v=e-f,m=0;m<v;++m)u+=t(f+m);var g=u+t(e);switch(n){case s.ScrollToMode.top:this._scrollElement.scrollTop=u;return;case s.ScrollToMode.bottom:this._scrollElement.scrollTop=g-h.height;return;case s.ScrollToMode.center:this._scrollElement.scrollTop=(u+g-h.height)/2;return;case s.ScrollToMode.auto:}if(u>=p.top&&g<=p.bottom)return;u<p.top||g>p.bottom&&(u=g-h.height)}this._scrollElement.scrollTop=u;return}u+=c}};t.prototype.getStartItemIndexInView=function(e){for(var t=0,n=this.state.pages||[];t<n.length;t++){var r=n[t];if(!r.isSpacer&&(this._scrollTop||0)>=r.top&&(this._scrollTop||0)<=r.top+r.height){if(!e){var i=Math.floor(r.height/r.itemCount);return r.startIndex+Math.floor((this._scrollTop-r.top)/i)}for(var s=0,o=r.startIndex;o<r.startIndex+r.itemCount;o++){i=e(o);if(r.top+s<=this._scrollTop&&this._scrollTop<r.top+s+i)return o;s+=i}}}return 0};t.prototype.componentDidMount=function(){this._updatePages();this._measureVersion++;this._scrollElement=i.findScrollableParent(this._root.current);this._events.on(window,"resize",this._onAsyncResize);this._root.current&&this._events.on(this._root.current,"focus",this._onFocus,!0);if(this._scrollElement){this._events.on(this._scrollElement,"scroll",this._onScroll);this._events.on(this._scrollElement,"scroll",this._onAsyncScroll)}};t.prototype.componentWillReceiveProps=function(e){if(e.items!==this.props.items||e.renderCount!==this.props.renderCount||e.startIndex!==this.props.startIndex){this._resetRequiredWindows();this._requiredRect=null;this._measureVersion++;this._invalidatePageCache();this._updatePages(e)}};t.prototype.shouldComponentUpdate=function(e,t){var n=this.state.pages,r=t.pages,i=!1;if(!t.isScrolling&&this.state.isScrolling)return!0;if(e.items===this.props.items&&n.length===r.length)for(var s=0;s<n.length;s++){var o=n[s],u=r[s];if(o.key!==u.key||o.itemCount!==u.itemCount){i=!0;break}}else i=!0;return i};t.prototype.forceUpdate=function(){this._invalidatePageCache();this._updateRenderRects(this.props,!0);this._updatePages();this._measureVersion++;e.prototype.forceUpdate.call(this)};t.prototype.getTotalListHeight=function(){return this._surfaceRect.height};t.prototype.render=function(){for(var e=this.props,t=e.className,s=e.role,o=void 0===s?"list":s,u=this.state.pages,a=void 0===u?[]:u,f=[],l=i.getNativeProps(this.props,i.divProperties),c=0,h=a;c<h.length;c++){var p=h[c];f.push(this._renderPage(p))}return r.createElement("div",n.__assign({ref:this._root},l,{role:f.length>0?o:void 0,className:i.css("ms-List",t)}),r.createElement("div",{ref:this._surface,className:"ms-List-surface",role:"presentation"},f))};t.prototype._shouldVirtualize=function(e){void 0===e&&(e=this.props);var t=e.onShouldVirtualize;return!t||t(e)};t.prototype._invalidatePageCache=function(){this._pageCache={}};t.prototype._renderPage=function(e){var t,n=this.props.usePageCache;if(n&&(t=this._pageCache[e.key])&&t.pageElement)return t.pageElement;var r=this._getPageStyle(e),i=this.props.onRenderPage,s=(void 0===i?this._onRenderPage:i)({page:e,className:"ms-List-page",key:e.key,ref:e.key,style:r,role:"presentation"},this._onRenderPage);n&&0===e.startIndex&&(this._pageCache[e.key]={page:e,pageElement:s});return s};t.prototype._getPageStyle=function(e){var t=this.props.getPageStyle;return n.__assign({},t?t(e):{},e.items?{}:{height:e.height})};t.prototype._onFocus=function(e){for(var t=e.target;t!==this._surface.current;){var n=t.getAttribute("data-list-index");if(n){this._focusedIndex=Number(n);break}t=i.getParent(t)}};t.prototype._onScroll=function(){this.state.isScrolling||this.setState({isScrolling:!0});this._resetRequiredWindows();this._onScrollingDone()};t.prototype._resetRequiredWindows=function(){this._requiredWindowsAhead=0;this._requiredWindowsBehind=0};t.prototype._onAsyncScroll=function(){this._updateRenderRects();this._materializedRect&&(e=this._requiredRect,t=this._materializedRect,e.top>=t.top&&e.left>=t.left&&e.bottom<=t.bottom&&e.right<=t.right)||this._updatePages();var e,t};t.prototype._onAsyncIdle=function(){var e=this.props,t=e.renderedWindowsAhead,n=e.renderedWindowsBehind,r=this._requiredWindowsAhead,i=this._requiredWindowsBehind,s=Math.min(t,r+1),o=Math.min(n,i+1);if(s!==r||o!==i){this._requiredWindowsAhead=s;this._requiredWindowsBehind=o;this._updateRenderRects();this._updatePages()}(t>s||n>o)&&this._onAsyncIdle()};t.prototype._onScrollingDone=function(){this.setState({isScrolling:!1})};t.prototype._onAsyncResize=function(){this.forceUpdate()};t.prototype._updatePages=function(e){var t=this;void 0===e&&(e=this.props);this._requiredRect||this._updateRenderRects(e);var n=this._buildPages(e),r=this.state.pages;this._notifyPageChanges(r,n.pages);this.setState(n,function(){if(e.getPageHeight)t._onAsyncIdle();else{if(t._updatePageMeasurements(n.pages)){t._materializedRect=null;if(t._hasCompletedFirstRender)t._onAsyncScroll();else{t._hasCompletedFirstRender=!0;t._updatePages(e)}}else t._onAsyncIdle()}e.onPagesUpdated&&e.onPagesUpdated(t.state.pages)})};t.prototype._notifyPageChanges=function(e,t,n){void 0===n&&(n=this.props);var r=n.onPageAdded,i=n.onPageRemoved;if(r||i){for(var s={},o=0,u=e;o<u.length;o++){(l=u[o]).items&&(s[l.startIndex]=l)}for(var a=0,f=t;a<f.length;a++){var l;(l=f[a]).items&&(s[l.startIndex]?delete s[l.startIndex]:this._onPageAdded(l))}for(var c in s)s.hasOwnProperty(c)&&this._onPageRemoved(s[c])}};t.prototype._updatePageMeasurements=function(e){var t=!1;if(!this._shouldVirtualize())return t;for(var n=0;n<e.length;n++){var r=e[n];r.items&&(t=this._measurePage(r)||t)}return t};t.prototype._measurePage=function(e){var t=!1,n=this.refs[e.key],r=this._cachedPageHeights[e.startIndex];if(n&&this._shouldVirtualize()&&(!r||r.measureVersion!==this._measureVersion)){var i={width:n.clientWidth,height:n.clientHeight};if(i.height||i.width){t=e.height!==i.height;e.height=i.height;this._cachedPageHeights[e.startIndex]={height:i.height,measureVersion:this._measureVersion};this._estimatedPageHeight=Math.round((this._estimatedPageHeight*this._totalEstimates+i.height)/(this._totalEstimates+1));this._totalEstimates++}}return t};t.prototype._onPageAdded=function(e){var t=this.props.onPageAdded;t&&t(e)};t.prototype._onPageRemoved=function(e){var t=this.props.onPageRemoved;t&&t(e)};t.prototype._buildPages=function(e){var t=e.renderCount,r=e.items,s=e.startIndex,o=e.getPageHeight;t=this._getRenderCount(e);for(var u=n.__assign({},c),a=[],f=1,l=0,h=null,p=this._focusedIndex,d=s+t,v=this._shouldVirtualize(e),m=0===this._estimatedPageHeight&&!o,g=this._allowedRect,y=function(e){var t=b._getPageSpecification(e,g),n=t.height,o=t.data,c=t.key;f=t.itemCount;var y=l+n-1,w=i.findIndex(b.state.pages,function(t){return!!t.items&&t.startIndex===e})>-1,E=!g||y>=g.top&&l<=g.bottom,S=!b._requiredRect||y>=b._requiredRect.top&&l<=b._requiredRect.bottom;if(!m&&(S||E&&w)||!v||p>=e&&p<e+f||e===s){if(h){a.push(h);h=null}var x=Math.min(f,d-e),T=b._createPage(c,r.slice(e,e+x),e,void 0,void 0,o);T.top=l;T.height=n;b._visibleRect&&b._visibleRect.bottom&&(T.isVisible=y>=b._visibleRect.top&&l<=b._visibleRect.bottom);a.push(T);S&&b._allowedRect&&function(e,t){e.top=t.top<e.top||-1===e.top?t.top:e.top;e.left=t.left<e.left||-1===e.left?t.left:e.left;e.bottom=t.bottom>e.bottom||-1===e.bottom?t.bottom:e.bottom;e.right=t.right>e.right||-1===e.right?t.right:e.right;e.width=e.right-e.left+1;e.height=e.bottom-e.top+1}(u,{top:l,bottom:y,height:n,left:g.left,right:g.right,width:g.width})}else{h||(h=b._createPage("spacer-"+e,void 0,e,0,void 0,o,!0));h.height=(h.height||0)+(y-l)+1;h.itemCount+=f}l+=y-l+1;if(m&&v)return"break"},b=this,w=s;w<d;w+=f){if("break"===y(w))break}if(h){h.key="spacer-end";a.push(h)}this._materializedRect=u;return{pages:a,measureVersion:this._measureVersion}};t.prototype._getPageSpecification=function(e,t){var n=this.props.getPageSpecification;if(n){var r=n(e,t),i=r.itemCount,s=void 0===i?this._getItemCountForPage(e,t):i,o=r.height;return{itemCount:s,height:void 0===o?this._getPageHeight(e,t,s):o,data:r.data,key:r.key}}return{itemCount:s=this._getItemCountForPage(e,t),height:this._getPageHeight(e,t,s)}};t.prototype._getPageHeight=function(e,t,n){if(this.props.getPageHeight)return this.props.getPageHeight(e,t,n);var r=this._cachedPageHeights[e];return r?r.height:this._estimatedPageHeight||30};t.prototype._getItemCountForPage=function(e,t){var n=this.props.getItemCountForPage?this.props.getItemCountForPage(e,t):10;return n||10};t.prototype._createPage=function(e,t,n,r,i,s,o){void 0===n&&(n=-1);void 0===r&&(r=t?t.length:0);void 0===i&&(i={});e=e||"page-"+n;var u=this._pageCache[e];return u&&u.page?u.page:{key:e,startIndex:n,itemCount:r,items:t,style:i,top:0,height:0,data:s,isSpacer:o||!1}};t.prototype._getRenderCount=function(e){var t=e||this.props,n=t.items,r=t.startIndex,i=t.renderCount;return void 0===i?n?n.length-r:0:i};t.prototype._updateRenderRects=function(e,t){var r=(e=e||this.props).renderedWindowsAhead,i=e.renderedWindowsBehind,s=this.state.pages;if(this._shouldVirtualize(e)){var o=this._surfaceRect||n.__assign({},c),u=this._scrollElement&&this._scrollElement.scrollHeight,a=this._scrollElement?this._scrollElement.scrollTop:0;if(this._surface.current&&(t||!s||!this._surfaceRect||!u||u!==this._scrollHeight||Math.abs(this._scrollTop-a)>this._estimatedPageHeight/3)){o=this._surfaceRect=p(this._surface.current);this._scrollTop=a}!t&&u&&u===this._scrollHeight||this._measureVersion++;this._scrollHeight=u;var f=Math.max(0,-o.top),l={top:f,left:o.left,bottom:f+window.innerHeight,right:o.right,width:o.width,height:window.innerHeight};this._requiredRect=m(l,this._requiredWindowsBehind,this._requiredWindowsAhead);this._allowedRect=m(l,i,r);this._visibleRect=l}};t.defaultProps={startIndex:0,onRenderCell:function(e,t,n){return r.createElement(r.Fragment,null,e&&e.name||"")},renderedWindowsAhead:2,renderedWindowsBehind:2};return t}(i.BaseComponent);t.List=v;function m(e,t,n){var r=e.top-t*e.height,i=e.height+(t+n)*e.height;return{top:r,bottom:r+i,height:i,left:e.left,right:e.right,width:e.width}}});
define("office-ui-fabric-react/lib/components/List/List.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ScrollToMode={auto:0,top:1,bottom:2,center:3}});
define("office-ui-fabric-react/lib/components/ScrollablePane/index",["require","exports","tslib","./ScrollablePane","./ScrollablePane.base","./ScrollablePane.types"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t)});
define("office-ui-fabric-react/lib/components/ScrollablePane/ScrollablePane",["require","exports","../../Utilities","./ScrollablePane.base","./ScrollablePane.styles"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ScrollablePane=n.styled(r.ScrollablePaneBase,i.getStyles,void 0,{scope:"ScrollablePane"})});
define("office-ui-fabric-react/lib/components/ScrollablePane/ScrollablePane.base",["require","exports","tslib","react","prop-types","../../Utilities"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s.classNamesFunction(),u=function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._root=r.createRef();i._stickyAboveRef=r.createRef();i._stickyBelowRef=r.createRef();i._contentContainer=r.createRef();i.subscribe=function(e){i._subscribers.add(e)};i.unsubscribe=function(e){i._subscribers.delete(e)};i.addSticky=function(e){i._stickies.add(e);if(i.contentContainer){e.setDistanceFromTop(i.contentContainer);i.sortSticky(e)}};i.removeSticky=function(e){i._stickies.delete(e);i._removeStickyFromContainers(e);i.notifySubscribers()};i.sortSticky=function(e,t){if(i.stickyAbove&&i.stickyBelow){t&&i._removeStickyFromContainers(e);e.canStickyTop&&e.stickyContentTop&&i._addToStickyContainer(e,i.stickyAbove,e.stickyContentTop);e.canStickyBottom&&e.stickyContentBottom&&i._addToStickyContainer(e,i.stickyBelow,e.stickyContentBottom)}};i.updateStickyRefHeights=function(){var e=i._stickies,t=0,n=0;e.forEach(function(e){var r=e.state,s=r.isStickyTop,o=r.isStickyBottom;if(e.nonStickyContent){s&&(t+=e.nonStickyContent.offsetHeight);o&&(n+=e.nonStickyContent.offsetHeight);i._checkStickyStatus(e)}});i.setState({stickyTopHeight:t,stickyBottomHeight:n})};i.notifySubscribers=function(){i.contentContainer&&i._subscribers.forEach(function(e){e(i.contentContainer,i.stickyBelow)})};i.getScrollPosition=function(){return i.contentContainer?i.contentContainer.scrollTop:0};i.syncScrollSticky=function(e){e&&i.contentContainer&&e.syncScroll(i.contentContainer)};i._addToStickyContainer=function(e,t,n){if(t.children.length){if(!t.contains(n)){var r=[].slice.call(t.children),s=[];i._stickies.forEach(function(n){t===i.stickyAbove&&e.canStickyTop?s.push(n):e.canStickyBottom&&s.push(n)});var o=s.sort(function(e,t){return(e.state.distanceFromTop||0)-(t.state.distanceFromTop||0)}).filter(function(e){var n=t===i.stickyAbove?e.stickyContentTop:e.stickyContentBottom;if(n)return r.indexOf(n)>-1}),u=void 0;for(var a in o)if((o[a].state.distanceFromTop||0)>=(e.state.distanceFromTop||0)){u=o[a];break}var f=null;u&&(f=t===i.stickyAbove?u.stickyContentTop:u.stickyContentBottom);t.insertBefore(n,f)}}else t.appendChild(n)};i._removeStickyFromContainers=function(e){i.stickyAbove&&e.stickyContentTop&&i.stickyAbove.contains(e.stickyContentTop)&&i.stickyAbove.removeChild(e.stickyContentTop);i.stickyBelow&&e.stickyContentBottom&&i.stickyBelow.contains(e.stickyContentBottom)&&i.stickyBelow.removeChild(e.stickyContentBottom)};i._onWindowResize=function(){var e=i._getScrollbarWidth(),t=i._getScrollbarHeight();i.setState({scrollbarWidth:e,scrollbarHeight:t});i.notifySubscribers()};i._getStickyContainerStyle=function(e,t){return n.__assign({height:e},s.getRTL()?{right:"0",left:(i.state.scrollbarWidth||i._getScrollbarWidth()||0)+"px"}:{left:"0",right:(i.state.scrollbarWidth||i._getScrollbarWidth()||0)+"px"},t?{top:"0"}:{bottom:(i.state.scrollbarHeight||i._getScrollbarHeight()||0)+"px"})};i._onScroll=function(){var e=i.contentContainer;e&&i._stickies.forEach(function(t){t.syncScroll(e)});i._notifyThrottled()};i._subscribers=new Set;i._stickies=new Set;i.state={stickyTopHeight:0,stickyBottomHeight:0,scrollbarWidth:0,scrollbarHeight:0};i._notifyThrottled=i._async.throttle(i.notifySubscribers,50);return i}Object.defineProperty(t.prototype,"root",{get:function(){return this._root.current},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"stickyAbove",{get:function(){return this._stickyAboveRef.current},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"stickyBelow",{get:function(){return this._stickyBelowRef.current},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"contentContainer",{get:function(){return this._contentContainer.current},enumerable:!0,configurable:!0});t.prototype.getChildContext=function(){return{scrollablePane:{subscribe:this.subscribe,unsubscribe:this.unsubscribe,addSticky:this.addSticky,removeSticky:this.removeSticky,updateStickyRefHeights:this.updateStickyRefHeights,sortSticky:this.sortSticky,notifySubscribers:this.notifySubscribers,syncScrollSticky:this.syncScrollSticky}}};t.prototype.componentDidMount=function(){var e=this,t=this.props.initialScrollPosition;this._events.on(this.contentContainer,"scroll",this._onScroll);this._events.on(window,"resize",this._onWindowResize);this.contentContainer&&t&&(this.contentContainer.scrollTop=t);this.setStickiesDistanceFromTop();this._stickies.forEach(function(t){e.sortSticky(t)});this.notifySubscribers();if("MutationObserver"in window){this._mutationObserver=new MutationObserver(function(t){var n=e._getScrollbarHeight();n!==e.state.scrollbarHeight&&e.setState({scrollbarHeight:n});e.notifySubscribers();if(t.some(function(e){return null!==this.stickyAbove&&null!==this.stickyBelow&&(this.stickyAbove.contains(e.target)||this.stickyBelow.contains(e.target))}.bind(e)))e.updateStickyRefHeights();else{var r=[];e._stickies.forEach(function(e){e.root&&e.root.contains(t[0].target)&&r.push(e)});r.length&&r.forEach(function(e){e.forceUpdate()})}});this.root&&this._mutationObserver.observe(this.root,{childList:!0,attributes:!0,subtree:!0,characterData:!0})}};t.prototype.componentWillUnmount=function(){this._events.off(this.contentContainer);this._events.off(window);this._mutationObserver&&this._mutationObserver.disconnect()};t.prototype.shouldComponentUpdate=function(e,t){return this.props.children!==e.children||this.props.initialScrollPosition!==e.initialScrollPosition||this.props.className!==e.className||this.state.stickyTopHeight!==t.stickyTopHeight||this.state.stickyBottomHeight!==t.stickyBottomHeight||this.state.scrollbarWidth!==t.scrollbarWidth||this.state.scrollbarHeight!==t.scrollbarHeight};t.prototype.componentDidUpdate=function(e,t){var n=this.props.initialScrollPosition;this.contentContainer&&"number"==typeof n&&e.initialScrollPosition!==n&&(this.contentContainer.scrollTop=n);t.stickyTopHeight===this.state.stickyTopHeight&&t.stickyBottomHeight===this.state.stickyBottomHeight||this.notifySubscribers();this._async.setTimeout(this._onWindowResize,0)};t.prototype.render=function(){var e=this.props,t=e.className,i=e.theme,u=e.styles,a=this.state,f=a.stickyTopHeight,l=a.stickyBottomHeight,c=o(u,{theme:i,className:t,scrollbarVisibility:this.props.scrollbarVisibility});return r.createElement("div",n.__assign({},s.getNativeProps(this.props,s.divProperties),{ref:this._root,className:c.root}),r.createElement("div",{ref:this._contentContainer,className:c.contentContainer,"data-is-scrollable":!0},this.props.children),r.createElement("div",{ref:this._stickyAboveRef,className:c.stickyAbove,style:this._getStickyContainerStyle(f,!0)}),r.createElement("div",{className:c.stickyBelow,style:this._getStickyContainerStyle(l,!1)},r.createElement("div",{ref:this._stickyBelowRef,className:c.stickyBelowItems})))};t.prototype.setStickiesDistanceFromTop=function(){var e=this;this.contentContainer&&this._stickies.forEach(function(t){t.setDistanceFromTop(e.contentContainer)})};t.prototype.forceLayoutUpdate=function(){this._onWindowResize()};t.prototype._checkStickyStatus=function(e){if(this.stickyAbove&&this.stickyBelow&&this.contentContainer&&e.nonStickyContent)if(e.state.isStickyTop||e.state.isStickyBottom){e.state.isStickyTop&&!this.stickyAbove.contains(e.nonStickyContent)&&e.stickyContentTop&&e.addSticky(e.stickyContentTop);e.state.isStickyBottom&&!this.stickyBelow.contains(e.nonStickyContent)&&e.stickyContentBottom&&e.addSticky(e.stickyContentBottom)}else this.contentContainer.contains(e.nonStickyContent)||e.resetSticky()};t.prototype._getScrollbarWidth=function(){var e=this.contentContainer;return e?e.offsetWidth-e.clientWidth:0};t.prototype._getScrollbarHeight=function(){var e=this.contentContainer;return e?e.offsetHeight-e.clientHeight:0};t.childContextTypes={scrollablePane:i.object};return t}(s.BaseComponent);t.ScrollablePaneBase=u});
define("office-ui-fabric-react/lib/components/ScrollablePane/ScrollablePane.styles",["require","exports","../../Styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={root:"ms-ScrollablePane",contentContainer:"ms-ScrollablePane--contentContainer"};t.getStyles=function(e){var t,i,s=e.className,o=e.theme,u=n.getGlobalClassNames(r,o),a={position:"absolute",pointerEvents:"auto"},f={position:"absolute",top:0,right:0,bottom:0,left:0,WebkitOverflowScrolling:"touch"};return{root:[u.root,o.fonts.medium,f,s],contentContainer:[u.contentContainer,{overflowY:"always"===e.scrollbarVisibility?"scroll":"auto"},f],stickyAbove:[{top:0,selectors:(t={},t[n.HighContrastSelector]={borderBottom:"1px solid WindowText"},t)},a],stickyBelow:[{bottom:0,selectors:(i={},i[n.HighContrastSelector]={borderTop:"1px solid WindowText"},i)},a],stickyBelowItems:[{bottom:0},a,{width:"100%"}]}}});
define("office-ui-fabric-react/lib/components/ScrollablePane/ScrollablePane.types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ScrollbarVisibility={auto:"auto",always:"always"}});
define("@ms/item-viewer-addon-video/lib/components/transcriptEntry/index",["require","exports","tslib","./TranscriptEntry","./TranscriptEntry.Props"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("@ms/item-viewer-addon-video/lib/components/transcriptEntry/TranscriptEntry",["require","exports","tslib","./TranscriptEntry.scss","react","office-ui-fabric-react/lib/Icon","@uifabric/utilities/lib/css","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/TextField","../Transcription.resx","office-ui-fabric-react/lib/FocusZone","@ms/utilities-strings/lib/index","office-ui-fabric-react/lib/Utilities"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._getEntryDisplayState=function(e,t){return e<t?2:e===t?1:0};n._handleTileMouseEnter=function(){n.setState({isTileOnHover:!0})};n._handleTileMouseLeave=function(){n.setState({isTileOnHover:!1})};n._updatingEntryText=function(e,t){void 0===t&&(t="");var r=t;return r.trim()?n.setState({saveButtonDisabled:!1,editText:r}):n.setState({saveButtonDisabled:!0,editText:t})};n._handleActivateEntry=function(e){var t=n.props,r=t.id,i=t.activeEntryIndex,s=t.onActivateEntry;i!==r&&s(r,!1)};n._getEntryTextContent=function(){var e=n.props.canEdit,t=n.state,s=t.isEditing,o=t.editText;return e&&s?i.createElement(a.TextField,{value:o,underlined:!0,multiline:!0,autoAdjustHeight:!0,onChange:n._updatingEntryText,className:r.textAreaContainer,inputClassName:r.textAreaInput,ariaLabel:f.default.textAreaLabel,autoFocus:!0}):i.createElement("div",{className:r.entryText,title:o,"data-is-focusable":!0},o)};n._getEntryDisplayClassName=function(e){switch(e){case 2:return r.hasPlayed;case 1:return r.isActive;default:return r.willPlay}};n._formatStartSeconds=function(e){var t=new Date(0);t.setSeconds(e);var n=t.toISOString().substr(11,8),r=n.split(":");return e<=3600?r[1]+":"+r[2]:n};n._editEntry=function(e){e.stopPropagation();n.props.onActivateEntry(n.props.id,!0)};n._saveEntry=function(){var e=n.props,t=e.id,r=e.language,i=e.start,s={id:t,text:n.state.editText,language:r,start:i};n.props.onSaveEntry(s);n.setState({isEditing:!1,isTileOnHover:!1})};n._clearEditMode=function(){var e=n.props.text,t=n.props,r=t.id;(0,t.onActivateEntry)(r,!1);n.setState({isEditing:!1,editText:e,isTileOnHover:!1})};n._getFormattedTimeStamp=function(){var e=n.props.start,t=e||0,r=n._formatStartSeconds(t);return{formattedStartSeconds:r,formattedStartSecondsAriaLabel:c.format(f.default.startSecondAriaLabel,r)}};n._buttonsGroup=function(){var e=n.state,t=e.isEditing,s=e.saveButtonDisabled;return t?i.createElement("div",{className:r.buttonsGroupRow},i.createElement(u.Button,{primary:!0,text:f.default.saveButton,onClick:n._saveEntry,disabled:s,className:r.saveButton}),i.createElement(u.Button,{primary:!1,text:f.default.cancelButton,onClick:n._clearEditMode,className:r.cancelButton})):null};n._onKeyDown=function(e){if(e.which===h.getRTLSafeKeyCode(h.KeyCodes.escape)){n._clearEditMode();e.stopPropagation()}n.state.isEditing&&e.stopPropagation()};n.state={entryDisplayState:n._getEntryDisplayState(n.props.index,n.props.activeEntryIndex),isEditing:!1,editText:n.props.text,saveButtonDisabled:!1,isTileOnHover:!1};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this.props.canEdit,n=this._getEntryDisplayState(e.index,e.activeEntryIndex),r=n!==this.state.entryDisplayState,i=this.state.isEditing&&e.activeEntryIndex!==this.props.index,s=e.isEditing&&!this.state.isEditing&&e.activeEntryIndex===this.props.index,o=this.props.isEditing;t&&i?this.setState({isEditing:!1,entryDisplayState:n,editText:this.props.text}):t&&s?this.setState({isEditing:!0,entryDisplayState:n}):!o&&r&&this.setState({entryDisplayState:n})};t.prototype.render=function(){var e=this,t=this.state,n=t.entryDisplayState,s=t.editText,u=t.isEditing,a=this._getFormattedTimeStamp().formattedStartSeconds,h=c.format(f.default.transcriptEntryBoxAriaLabel,a,s),p=this._getEntryDisplayClassName(n),d=this._getTimeStampOrEditButtonContent(),v=this._getEntryTextContent(),m=this._buttonsGroup(),g=r.row+" "+(u&&r.isEditing)+" "+p;return i.createElement("div",{className:o.css(""+r.videoTranscriptEntry),"data-is-focusable":!0,"aria-label":h},i.createElement(l.FocusZone,{direction:l.FocusZoneDirection.vertical,onKeyDown:this._onKeyDown,ariaDescribedBy:"transcriptEntryAriaInstruction"},i.createElement("div",{className:o.css(""+r.ariaDescription),id:"transcriptEntryAriaInstruction"},f.default.transcriptEntryAriaInstruction),i.createElement("div",{className:o.css(g+" transcriptEntryRow"),onMouseEnter:this._handleTileMouseEnter,onMouseLeave:this._handleTileMouseLeave,ref:function(t){return e.props.activeEntryIndex===e.props.index?e.props.setActiveElement(t):null},onClick:function(t){return e._handleActivateEntry(t)},"data-item-key":this.props.id},i.createElement("div",{className:r.width20},d),i.createElement("div",{className:o.css(r.width80+" "+r.text+" "+p)},v,m))))};t.prototype._getTimeStampOrEditButtonContent=function(){var e=this,t=this.state,n=t.isEditing,u=t.isTileOnHover;if(this.props.canEdit&&!n&&u)return i.createElement("div",{className:o.css(r.editIconContainer),onClick:function(t){return e._editEntry(t)},tabIndex:0},i.createElement(s.Icon,{iconName:"Edit",className:r.editIcon}));var a=this._getFormattedTimeStamp(),f=a.formattedStartSeconds,l=a.formattedStartSecondsAriaLabel;return i.createElement("div",{title:l},f)};return t}(i.PureComponent);t.TranscriptEntry=p});
define("@ms/item-viewer-addon-video/lib/components/transcriptEntry/TranscriptEntry.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".ariaDescription_4f36b12c{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}.videoTranscriptEntry_4f36b12c{font-size:12px;display:-webkit-box;display:-ms-flexbox;display:flex}.videoTranscriptEntry_4f36b12c .row_4f36b12c,.videoTranscriptEntry_4f36b12c .row_4f36b12c:hover{margin:8px;padding-top:8px;padding-bottom:8px;min-height:40px;display:-webkit-box;display:-ms-flexbox;display:flex}[dir='ltr'] .videoTranscriptEntry_4f36b12c .row_4f36b12c,[dir='ltr'] .videoTranscriptEntry_4f36b12c .row_4f36b12c:hover{padding-right:25px}[dir='rtl'] .videoTranscriptEntry_4f36b12c .row_4f36b12c,[dir='rtl'] .videoTranscriptEntry_4f36b12c .row_4f36b12c:hover{padding-left:25px}[dir='ltr'] .videoTranscriptEntry_4f36b12c .row_4f36b12c,[dir='ltr'] .videoTranscriptEntry_4f36b12c .row_4f36b12c:hover{padding-left:8px}[dir='rtl'] .videoTranscriptEntry_4f36b12c .row_4f36b12c,[dir='rtl'] .videoTranscriptEntry_4f36b12c .row_4f36b12c:hover{padding-right:8px}.videoTranscriptEntry_4f36b12c .row_4f36b12c.isEditing_4f36b12c.isActive_4f36b12c,.videoTranscriptEntry_4f36b12c .row_4f36b12c:hover.isEditing_4f36b12c.isActive_4f36b12c{width:100%;outline:1px solid #0078d4}.videoTranscriptEntry_4f36b12c .row_4f36b12c.isActive_4f36b12c,.videoTranscriptEntry_4f36b12c .row_4f36b12c:hover.isActive_4f36b12c{outline:1px solid #0078d4}.videoTranscriptEntry_4f36b12c .row_4f36b12c .width20_4f36b12c,.videoTranscriptEntry_4f36b12c .row_4f36b12c:hover .width20_4f36b12c{-ms-flex-preferred-size:46px;flex-basis:46px;-ms-flex-negative:0;flex-shrink:0;text-align:center;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start}[dir='ltr'] .videoTranscriptEntry_4f36b12c .row_4f36b12c .width20_4f36b12c,[dir='ltr'] .videoTranscriptEntry_4f36b12c .row_4f36b12c:hover .width20_4f36b12c{margin-right:8px}[dir='rtl'] .videoTranscriptEntry_4f36b12c .row_4f36b12c .width20_4f36b12c,[dir='rtl'] .videoTranscriptEntry_4f36b12c .row_4f36b12c:hover .width20_4f36b12c{margin-left:8px}.videoTranscriptEntry_4f36b12c .row_4f36b12c .width80_4f36b12c,.videoTranscriptEntry_4f36b12c .row_4f36b12c:hover .width80_4f36b12c{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}[dir='ltr'] .videoTranscriptEntry_4f36b12c .row_4f36b12c .width80_4f36b12c,[dir='ltr'] .videoTranscriptEntry_4f36b12c .row_4f36b12c:hover .width80_4f36b12c{margin-left:8px}[dir='rtl'] .videoTranscriptEntry_4f36b12c .row_4f36b12c .width80_4f36b12c,[dir='rtl'] .videoTranscriptEntry_4f36b12c .row_4f36b12c:hover .width80_4f36b12c{margin-right:8px}.videoTranscriptEntry_4f36b12c .row_4f36b12c .width80_4f36b12c .entryText_4f36b12c,.videoTranscriptEntry_4f36b12c .row_4f36b12c:hover .width80_4f36b12c .entryText_4f36b12c{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.videoTranscriptEntry_4f36b12c .row_4f36b12c .width80_4f36b12c .entryText_4f36b12c:focus,.videoTranscriptEntry_4f36b12c .row_4f36b12c:hover .width80_4f36b12c .entryText_4f36b12c:focus{outline:none}.videoTranscriptEntry_4f36b12c .row_4f36b12c .text_4f36b12c.hasPlayed_4f36b12c,.videoTranscriptEntry_4f36b12c .row_4f36b12c:hover .text_4f36b12c.hasPlayed_4f36b12c{color:#666}.videoTranscriptEntry_4f36b12c .row_4f36b12c .text_4f36b12c.isActive_4f36b12c,.videoTranscriptEntry_4f36b12c .row_4f36b12c:hover .text_4f36b12c.isActive_4f36b12c{color:#0078d4}.videoTranscriptEntry_4f36b12c .row_4f36b12c .text_4f36b12c.willPlay_4f36b12c,.videoTranscriptEntry_4f36b12c .row_4f36b12c:hover .text_4f36b12c.willPlay_4f36b12c{color:#333}.videoTranscriptEntry_4f36b12c .row_4f36b12c .text_4f36b12c.editEntry_4f36b12c,.videoTranscriptEntry_4f36b12c .row_4f36b12c:hover .text_4f36b12c.editEntry_4f36b12c{border-bottom:1px solid #0078d4}.videoTranscriptEntry_4f36b12c .row_4f36b12c .textAreaContainer_4f36b12c,.videoTranscriptEntry_4f36b12c .row_4f36b12c:hover .textAreaContainer_4f36b12c{border-bottom-color:#0078d4}.videoTranscriptEntry_4f36b12c .row_4f36b12c .textAreaContainer_4f36b12c .textAreaInput_4f36b12c,.videoTranscriptEntry_4f36b12c .row_4f36b12c:hover .textAreaContainer_4f36b12c .textAreaInput_4f36b12c{font-size:12px;padding:0px;resize:none}.videoTranscriptEntry_4f36b12c .row_4f36b12c .buttonsGroupRow_4f36b12c,.videoTranscriptEntry_4f36b12c .row_4f36b12c:hover .buttonsGroupRow_4f36b12c{display:-webkit-box;display:-ms-flexbox;display:flex}.videoTranscriptEntry_4f36b12c .row_4f36b12c .buttonsGroupRow_4f36b12c .saveButton_4f36b12c,.videoTranscriptEntry_4f36b12c .row_4f36b12c .buttonsGroupRow_4f36b12c .cancelButton_4f36b12c,.videoTranscriptEntry_4f36b12c .row_4f36b12c:hover .buttonsGroupRow_4f36b12c .saveButton_4f36b12c,.videoTranscriptEntry_4f36b12c .row_4f36b12c:hover .buttonsGroupRow_4f36b12c .cancelButton_4f36b12c{margin:8px 2.5px;height:28px;font-size:12px;border-radius:2px}.videoTranscriptEntry_4f36b12c .row_4f36b12c .buttonsGroupRow_4f36b12c .cancelButton_4f36b12c,.videoTranscriptEntry_4f36b12c .row_4f36b12c:hover .buttonsGroupRow_4f36b12c .cancelButton_4f36b12c{background-color:#fff;border-color:#000}.videoTranscriptEntry_4f36b12c .row_4f36b12c:hover{-webkit-box-shadow:1px 1px 2px 1.5px #d0d0d0;box-shadow:1px 1px 2px 1.5px #d0d0d0}.videoTranscriptEntry_4f36b12c .row_4f36b12c:hover .editIconContainer_4f36b12c{width:32px;height:32px;border-radius:2px;text-align:center;margin:3px 7px;font-size:16px}.videoTranscriptEntry_4f36b12c .row_4f36b12c:hover .editIconContainer_4f36b12c .editIcon_4f36b12c{color:#0078d4;margin-top:6px}.videoTranscriptEntry_4f36b12c .row_4f36b12c:hover .editIconContainer_4f36b12c:hover{background-color:#d0d0d0;cursor:pointer}\n"}]);t.ariaDescription="ariaDescription_4f36b12c";t.videoTranscriptEntry="videoTranscriptEntry_4f36b12c";t.row="row_4f36b12c";t.isEditing="isEditing_4f36b12c";t.isActive="isActive_4f36b12c";t.width20="width20_4f36b12c";t.width80="width80_4f36b12c";t.entryText="entryText_4f36b12c";t.text="text_4f36b12c";t.hasPlayed="hasPlayed_4f36b12c";t.willPlay="willPlay_4f36b12c";t.editEntry="editEntry_4f36b12c";t.textAreaContainer="textAreaContainer_4f36b12c";t.textAreaInput="textAreaInput_4f36b12c";t.buttonsGroupRow="buttonsGroupRow_4f36b12c";t.saveButton="saveButton_4f36b12c";t.cancelButton="cancelButton_4f36b12c";t.editIconContainer="editIconContainer_4f36b12c";t.editIcon="editIcon_4f36b12c"});
define("@ms/item-viewer-addon-video/lib/components/transcriptEntry/TranscriptEntry.Props",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.HasPlayed=2]="HasPlayed";e[e.IsActive=1]="IsActive";e[e.WillPlay=0]="WillPlay"}(n=t.TranscriptEntryDisplayStatus||(t.TranscriptEntryDisplayStatus={}));t.default=n});
define("@ms/item-viewer-addon-video/lib/components/startTranscription/index",["require","exports","tslib","./StartTranscription"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/item-viewer-addon-video/lib/components/startTranscription/StartTranscription",["require","exports","tslib","../Transcription.scss","react","../Transcription.resx","office-ui-fabric-react/lib/Button","../pendingTranscription/index","../illustration/IllustrationContainer"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onClick=function(){n.props.onStartTranscription();n.setState({clickStartButton:!0})};n.state={clickStartButton:n.props.disableTranscriptButton};return n}t.prototype.render=function(){var e=this.state.clickStartButton,t=this.props,n=t.disableTranscriptButton,f=t.imgSrc,l=void 0===f?"":f;return e?i.createElement(u.PendingTranscription,{disableTranscriptButton:e}):i.createElement(a.IllustrationContainer,{imgSrc:l,description:s.default.startTranscriptionDescription},i.createElement(o.PrimaryButton,{className:r.startButton,onClick:this._onClick,disabled:n,ariaLabel:s.default.startTranscriptionButton,autoFocus:!0},s.default.startTranscriptionButton))};return t}(i.PureComponent);t.StartTranscription=f});
define("@ms/item-viewer-addon-video/lib/components/Transcription.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".container_b237fc89{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.container_b237fc89 .imgContainer_b237fc89{margin-top:40px;margin-bottom:20px}.container_b237fc89 .imgContainer_b237fc89 .iconSrc_b237fc89{width:208px;height:208px}.container_b237fc89 .imgContainer_b237fc89 .loadingSpinner_b237fc89{width:208px;height:208px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.container_b237fc89 .description_b237fc89{text-align:center;color:#333;font-size:14px}.container_b237fc89 .startButton_b237fc89{margin-top:16px}\n"}]);t.container="container_b237fc89";t.imgContainer="imgContainer_b237fc89";t.iconSrc="iconSrc_b237fc89";t.loadingSpinner="loadingSpinner_b237fc89";t.description="description_b237fc89";t.startButton="startButton_b237fc89"});
define("@ms/item-viewer-addon-video/lib/components/pendingTranscription/index",["require","exports","tslib","./PendingTranscription"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/item-viewer-addon-video/lib/components/pendingTranscription/PendingTranscription",["require","exports","../Transcription.scss","react","office-ui-fabric-react/lib/Label","../Transcription.resx","office-ui-fabric-react/lib/Spinner"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PendingTranscription=function(e){return r.createElement("div",{className:n.container},r.createElement("div",{className:n.imgContainer},r.createElement("div",{className:n.loadingSpinner},r.createElement(o.Spinner,{size:o.SpinnerSize.large}))),r.createElement(i.Label,{className:n.description},r.createElement("p",{role:"status",tabIndex:0},s.default.pendingText)))}});
define("@ms/item-viewer-addon-video/lib/components/illustration/IllustrationContainer",["require","exports","react","office-ui-fabric-react/lib/Label","../Transcription.scss","../Transcription.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.IllustrationContainer=function(e){var t=e.imgSrc,o=e.description,u=e.imgAltText,a=void 0===u?s.default.illustrationAltText:u,f=e.children;return n.createElement("div",{className:i.container},n.createElement("div",{className:i.imgContainer},n.createElement("img",{src:t,className:i.iconSrc,alt:a,"aria-labelledby":"illustration-label"})),n.createElement(r.Label,{className:i.description,tabIndex:0,id:"illustration-label"},o),f)}});
define("odsp-next/controls/video/controls/transcriptPane/TranscriptPane.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-transcriptPane{display:-ms-flexbox;display:flex;-ms-flex-flow:column nowrap;flex-flow:column nowrap;position:absolute;top:0;bottom:0;left:0;right:0;padding:0 16px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-transcriptHeader{-ms-flex:0 0 auto;flex:0 0 auto;font-weight:600;font-size:20px;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.od-transcriptList{-ms-flex:1 1 auto;flex:1 1 auto;position:relative}.od-transcriptClose{position:absolute;top:10px}html[dir=ltr] .od-transcriptClose{right:10px}html[dir=rtl] .od-transcriptClose{left:10px}"}])});
define("odsp-next/controls/video/controls/player/VideoPlayer.html",[],function(){return'<div class=od-VideoPlayer data-bind="fullScreen: context.isMaximized, css: { \'od-VideoPlayer--isFullScreen\': context.isMaximized, \'od-VideoPlayer--hasStatus\': context.videoStatus().isVisible }"><div class=od-VideoPlayer-canvas data-bind="event: { dblclick: toggleIsMaximized }, component: { name: \'od-videocanvas\' }"></div><div class=od-VideoPlayer-status data-bind="click: onStatusClicked"><div class=od-VideoPlayer-statusContent>\x3c!--ko if: $component.context.videoStatus().isRetriable--\x3e<button class="od-VideoPlayer-statusButton ms-Icon" data-bind="icon: true, css: { \'ms-Icon--Sync\': context.hasError(), \'ms-Icon--Play\': !context.hasError() && !context.isPlaying(), \'ms-Icon--Pause\': !context.hasError() && context.isPlaying() }"></button>\x3c!--/ko--\x3e\x3c!--ko with: $component.context.videoStatus--\x3e\x3c!--ko if: $data.statusMessage--\x3e<div class=od-VideoPlayer-statusText data-bind="text: $data.statusMessage"></div>\x3c!--/ko--\x3e\x3c!--ko if: $component.correlationId--\x3e<div class=od-VideoPlayer-debugText><span data-bind="text: $component.correlationId"></span></div>\x3c!--/ko--\x3e\x3c!--ko if: $component.context.canShowDiagnostics--\x3e<div class=od-VideoPlayer-debugText><strong data-bind="text: $component.getErrorType($data.error)"></strong> <span data-bind="text: $component.getErrorDetails($data.error)"></span></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: context.hasError()--\x3e\x3c!--ko control: actionBar--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div></div>\x3c!--ko if: !context.shouldUseNativeControls--\x3e\x3c!--ko component: playbackPanelHost--\x3e\x3c!--ko component: playbackPanel--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: showTranscript--\x3e\x3c!--ko component: transcriptHost--\x3e<div data-bind="react: transcriptPanel" data-suppresskeyboardbinding=true role=presentation></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/video/controls/player/VideoPlayer.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-VideoPlayer--isFullScreen{position:fixed;left:0;top:0;width:100%;height:100%;background:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-VideoPlayer-frame{border:none;height:100%;width:100%}.od-VideoPlayer-canvas,.od-VideoPlayer-status{position:absolute;top:0;left:0;right:0;bottom:0}.od-VideoPlayer-status{background-color:rgba(0,0,0,.8);color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";text-align:center;display:none}.od-VideoPlayer-status .od-VideoPlayer-statusContent .od-ButtonBar-main{float:none}.od-VideoPlayer-statusContent{position:absolute;top:50%;left:50%;right:-50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);padding:20px}.od-VideoPlayer--hasStatus .od-VideoPlayer-status{display:block}.od-VideoPlayer-debugText{color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";font-size:11px;padding:20px 0 0 0}.od-VideoPlayer-statusButton{width:100px;height:100px;line-height:100px;vertical-align:middle;padding:0;margin:20px;border:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-radius:50%;box-sizing:border-box;font-size:75px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";background-color:rgba(0,0,0,.5);cursor:pointer}.od-VideoPlayer-statusButton:before{font-size:42px;display:block}.od-VideoPlayer-statusButton:hover{background-color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-VideoPlayer-statusButton:active{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-color:"},{theme:"black",defaultValue:"#000000"},{rawString:";color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-VideoPlayer .od-VideoCanvas-video{position:absolute;left:0;top:0;width:100%;height:100%}"}])});
define("odsp-next/controls/video/controls/canvas/VideoCanvas",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./VideoCanvasViewModel","./VideoCanvas.css","./VideoCanvas.html"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.registerComponent({tagName:"od-videocanvas",template:e("./VideoCanvas.html"),viewModel:r.default,synchronous:!0});t.default=i});
define("odsp-next/controls/video/controls/canvas/VideoCanvasViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","./HtmlVideoContextBinding","./FlashVideoContextBinding","./VideoMonitorBinding","../../resources/VideoResourceKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.context=n.resources.consume(u.context);n.addBindingHandlers({htmlVideoContext:i.default,flashVideoContext:s.default,videoMonitor:o.default});return n}return t}(r.default);t.default=a});
define("odsp-next/controls/video/controls/canvas/HtmlVideoContextBinding",["require","exports","tslib","knockout","@ms/odsp-shared/lib/bindings/base/BaseBinding","../../VideoPlayer.resx","../../VideoError","@ms/dashling/lib/Dashling","@ms/dashling/lib/DashlingEnums","../../VideoPlaybackType","../../VideoErrorType","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/ErrorHelper","../../../../utilities/features/Features","../../../../utilities/killSwitch/KillSwitch"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v,m=100;!function(e){e[e.MEDIA_ERR_ABORTED=1]="MEDIA_ERR_ABORTED";e[e.MEDIA_ERR_NETWORK=2]="MEDIA_ERR_NETWORK";e[e.MEDIA_ERR_DECODE=3]="MEDIA_ERR_DECODE";e[e.MEDIA_ERR_SRC_NOT_SUPPORTED=4]="MEDIA_ERR_SRC_NOT_SUPPORTED"}(v||(v={}));var g=window.VTTCue||window.TextTrackCue,y=0,b=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;var r=n.observables,i=n._context=n.valueAccessor();n._errors={};n.subscribe(i.url,n._onUrlChanged);r.backgroundCompute(n._computeVolume);r.backgroundCompute(n._computeIsMuted);n.subscribe(i.seekPercentage,n.async.debounce(n._onSeekPercentageChanged,m));n.subscribe(i.isScrubbing,n._onIsScrubbingChanged);n.subscribe(i.desiredQuality,n._onDesiredQualityChanged);n.subscribe(i.isABREnabled,n._onIsABREnabledChanged);n.subscribe(i.isPlaying,n._onIsPlayingChanged);n.subscribe(i.transcript,n._onTranscriptChanged);var s=n._activeTranscriptEntryIndex=r.create(-1);n.scope.attach(i.activeTranscriptEntryIndex.register(s));n._onUrlChanged(i.url());n._onIsPlayingChanged(i.isPlaying.peek());return n}t.prototype.dispose=function(){this._disposeVideo();e.prototype.dispose.call(this)};t.prototype._disposeVideo=function(){if(this._dashling){this._context.dashling(null);this._dashling.dispose();this._dashling=null}var e=this._videoElement,t=this._transcriptTrack;if(t){this.events.off(t);this._transcriptTrack=void 0}var n=this._errorTrack;if(n){this.events.off(n);this._errorTrack=void 0}this._errors={};if(e){this.events.off(e);try{e.pause();this.element.removeChild(e)}catch(e){}this._videoElement=void 0}};t.prototype._onTranscriptEntryChange=function(){for(var e=this._transcriptTrack.activeCues,t=e.length,n=-1,r=0;r<t;r++)(e[r].startTime>0||n<0)&&(n=parseInt(e[r].id,10));this._activeTranscriptEntryIndex(n)};t.prototype._onErrorChange=function(){var e=this._errorTrack,t=e&&e.activeCues,n=t&&t[0];if(n){var r=this._errors[n.id];this._context.setVideoStatus(r)}};t.prototype._onTranscriptChanged=function(){var e=this._context.transcript.peek(),t=this._transcriptTrack;if(t&&g){var n=t.cues,r=e?e.length:0;if(e)for(var i=0;i<e.length;i++){var s=e[i],o=0===i?0:s.start,u=Math.max(s.end,i+1<e.length?e[i+1].start:1e10);if(i<n.length){var a=n[i];a.startTime=o;a.endTime=u}else try{var f=new g(o,u,"");f.id=""+i;t.addCue(f)}catch(e){console.warn(e)}}for(;n.length>r;)t.removeCue(n[n.length-1])}};t.prototype._onUrlChanged=function(e){var t=this;this._disposeVideo();if(e){var n=this._videoElement=document.createElement("video");this.events.onAll(n,{loadstart:this._handleLoadStart,canplay:this._handleCanPlay,error:this._handleVideoElementError,ended:this._handleEnded,volumechange:this._handleVolumeChanged,play:this._handlePlay,pause:this._handlePause,waiting:this._handleWaiting,playing:this._handlePlaying,durationchange:this._handleBufferChange,ratechange:this._handleRateChange,timeupdate:this._handleBufferChange,progress:this._handleBufferChange});if("addTextTrack"in n&&g){var r=this._transcriptTrack=n.addTextTrack("metadata","transcript","");this._onTranscriptChanged();this.events.on(r,"cuechange",this._onTranscriptEntryChange);if(p.isFeatureEnabled(p.DeferVideoSegmentErrors)){var i=this._errorTrack=n.addTextTrack("metadata","segmenterror","");this.events.on(i,"cuechange",this._onErrorChange)}}n.className="od-VideoCanvas-video";if(this._context.shouldUseNativeControls){this.events.on(n,"loadedmetadata",this._handleCanPlay);n.setAttribute("controls","");n.setAttribute("poster",this._context.coverImageUrl.peek()||"");n.setAttribute("preload","metadata")}else this._context.shouldAutoPlay&&n.setAttribute("autoplay","autoplay");this._context.playbackType()===f.default.htmlDashling?this.async.setTimeout(function(){t._initializeDashling()},0):n.setAttribute("src",e);this._computeVolume();this._computeIsMuted();this.element.appendChild(n);this._checkPlayState(!0)}};t.prototype._convertDesiredQualityToVideoIndex=function(e){switch(e){case 1080:return 4;case 720:return 3;case 480:return 2;case 360:return 1;default:return 0}};t.prototype._initializeDashling=function(){var e=this._videoElement;if(e){var t=this._context,n={isABREnabled:t.isABREnabled(),targetQuality:{audio:1,video:this._convertDesiredQualityToVideoIndex(t.desiredQuality())}};p.isFeatureEnabled(p.ChangeVideoAuth)&&(n.getRequestParametersAsync=t.getRequestParametersAsync.bind(t));p.isFeatureEnabled(p.VideoBasicConnectivityTest)&&(n.testConnectivity=t.testConnectivity.bind(t));p.isFeatureEnabled(p.VideoEndOfStream)&&(n.missingSegmentThreshold=-2);t.isSeeking()&&t.duration()&&(n.startTime=t.duration()*t.seekPercentage());var r=this._dashling=new u.default(n);this._manifestQualityMap=null;r.load(e,t.url.peek());t.dashling(r)}};t.prototype._onIsPlayingChanged=function(e){this._checkPlayState();if(e)this._updatePlaybackStateId||(this._updatePlaybackStateId=this.async.setInterval(this._updatePlaybackState,100));else{this.async.clearInterval(this._updatePlaybackStateId);this._updatePlaybackStateId=0}};t.prototype._onDesiredQualityChanged=function(e){var t=this._getManifestVideoQualities();if(t){this._dashling.settings.targetQuality.video=t.indexOf(e);this._dashling.settings.isABREnabled=!1;this._dashling.resetStreams()}};t.prototype._onIsABREnabledChanged=function(e){this._dashling&&(this._dashling.settings.isABREnabled=e)};t.prototype._computeVolume=function(){var e=this._context.volume(),t=this._videoElement;t&&(t.volume=e)};t.prototype._computeIsMuted=function(){var e=this._context.isMuted(),t=this._videoElement;t&&(t.muted=e)};t.prototype._onSeekPercentageChanged=function(e){var t=this._videoElement;if(t&&t.duration&&!this._context.videoStatus().isVisible){t.currentTime=e?e*t.duration:0;this._context.isSeeking(!0)}};t.prototype._onIsScrubbingChanged=function(e){this._onSeekPercentageChanged(this._context.seekPercentage());var t=this._videoElement;!e&&t&&this._context.position(t.currentTime)};t.prototype._handleLoadStart=function(e){this._context.isLoading(!0)};t.prototype._handleCanPlay=function(e){this._context.canPlay(!0)};t.prototype._handleVideoElementError=function(){var e,t=s.strings.errorLoading,n="",r=l.default.htmlOther,i=!0,u=!1,c=!1,h=!1,d=this._videoElement,m=this._dashling,g=m&&m.lastCorrelationId,y=function(){var i=m&&m.state,o=i===a.DashlingSessionState.disconnected;if(o||i===a.DashlingSessionState.error){e=m.lastError;var f=m.lastHttpStatus,p=m.lastErrorMessage;p&&(e=p instanceof Error?""+p.message:p);n="number"==typeof f?f+"."+e:"";429===f&&(t=s.strings.throttledErrorMessage);if(406===f){t=s.strings.unsupportedCodecErrorMessage;u=!0}var v=e&&e.toLowerCase();if(v&&v.indexOf("videoprocessing_bitratetoohigh")>-1){t=s.strings.bitRateTooHighErrorMessage;u=!0}if(v&&v.indexOf("fileempty")>-1){r=l.default.emptyFile;t=s.strings.errorEmptyFile;u=!0;return}switch(m.lastErrorType){case"initSegmentDownload":r=l.default.htmlDashlingInitSegmentDownload;break;case"manifestDownload":r=l.default.htmlDashlingManifestDownload;h=!1;break;case"manifestParse":r=l.default.htmlDashlingManifestParse;break;case"mediaSegmentDownload":r=l.default.htmlDashlingMediaSegmentDownload;d.buffered.length&&(t=s.strings.errorSegment);h=!1;break;case"mediaSourceInit":r=l.default.htmlDashlingMediaSourceInit;break;case"sourceBufferAppendException":r=l.default.htmlDashlingSourceBufferAppendException;t=s.strings.errorSegment;break;case"sourceBufferAppendMissing":r=l.default.htmlDashlingSourceBufferAppendMissing;t=s.strings.errorSegment;break;case"sourceBufferInit":r=l.default.htmlDashlingSourceBufferInit;break;case"videoElementError":break;case"networkDisconnected":c=!0;t=s.strings.errorNetwork;break;default:r=l.default.htmlDashlingOther}if(o){c=!0;t=s.strings.errorNetwork}}},b=d&&d.error;n=f.default[this._context.playbackType.peek()];if(b){var w=b.code;"string"==typeof w&&(w=v[w]);e=b.message||"";switch(w){case v.MEDIA_ERR_DECODE:r=l.default.htmlElementDecode;t=s.strings.errorDecode;i=!1;y();break;case v.MEDIA_ERR_NETWORK:r=l.default.htmlElementNetwork;t=s.strings.errorNetwork;m?y():p.isFeatureEnabled(p.VideoBasicConnectivityTest)&&(c=!1===navigator.onLine);break;case v.MEDIA_ERR_SRC_NOT_SUPPORTED:r=l.default.htmlElementSrcNotSupported;t=s.strings.errorUnsupportedBrowser;u=!0;break;case v.MEDIA_ERR_ABORTED:return;default:r=l.default.htmlElementOther}}else y();i=i&&!u;u=u||c;var E=new o.VideoError({code:n,correlationId:g,isExpected:u,isRetriable:i,message:e,requiresNewUrl:h,type:r}),S={statusMessage:t,error:E};this._tryDeferError(S)||this._context.setVideoStatus(S)};t.prototype._tryDeferError=function(e){try{var t=this._errorTrack;if(!t||!g)return!1;switch(e.error.type){case l.default.htmlDashlingMediaSegmentDownload:case l.default.htmlDashlingSourceBufferAppendException:case l.default.htmlDashlingSourceBufferAppendMissing:break;default:return!1}if(this._context.isLoading.peek()&&d.default.isActivated("63B207A3-C1E7-4D7C-BAEB-16FF56B406F1","07/01/2019","Rely on buffer for deferred segment errors"))return!1;for(var n=this._videoElement,r=n.currentTime,i=n.buffered,s=-1,o=0;o<i.length;o++){var u=i.end(o);if(i.start(o)<r){s=u;if(u>r)break}}if(s<=0)return!1;var a=""+ ++y,f=new g(Math.max(0,s-1),1e10,"");f.id=a;t.addCue(f);this._errors[a]=e;return!0}catch(e){h.default.log(e);return!1}};t.prototype._checkPlayState=function(e){var t=this,n=this._videoElement,r=!1,i=this._context;(e=e||!i.canPlay())||(this._stalePlayStateId=0);if(n){if(i.isPlaying()&&!i.isScrubbing()&&n.paused)if(e)r=!0;else{Math.abs(i.position()-i.duration())<.5&&(n.currentTime=0);c.default.resolve(n.play()).then(function(){},function(){i.isPlaying(!1)})}else i.isPlaying()&&!i.isScrubbing()||n.paused||(e?r=!0:n.pause());r&&!this._stalePlayStateId&&(this._stalePlayStateId=this.async.setTimeout(function(){t._stalePlayStateId=0;t._checkPlayState()},300))}};t.prototype._checkEndState=function(e){var t=this._videoElement,n=this._context;e||(this._staleEndStateId=0);if(t&&(!e||n.isPlaying())&&t.duration-t.currentTime<=.4)if(e)this._staleEndStateId||(this._staleEndStateId=this.async.setTimeout(this._checkEndState,400));else{n.position(n.duration());this._handleEnded(null)}};t.prototype._updatePlaybackState=function(){this._videoElement&&this._handleBufferChange()};t.prototype._getManifestVideoQualities=function(){if(!this._manifestQualityMap){var e=this._dashling,t=e&&e.settings,n=t&&t.manifest,r=n&&n.streams&&n.streams.video&&n.streams.video.qualities;r&&(this._manifestQualityMap=r.map(function(e){var t=e.id;return parseInt(/\D*(\d+)p/.exec(void 0===t?"":t)[1],10)}).filter(function(e){return!!e}))}return this._manifestQualityMap};t.prototype._updateDashlingState=function(){var e=this._dashling,t=this._context;e.settings.isABREnabled=t.isABREnabled();var n=this._getManifestVideoQualities();if(n){t.maxQuality(n[e.getMaxQuality("video")]);e.settings.isABREnabled?t.playingQuality(n[e.getPlayingQuality("video")]):t.playingQuality(n[e.getBufferingQuality("video")])}else t.maxQuality(0)};t.prototype._handleEnded=function(e){this._context.isPlaying(!1)};t.prototype._handleVolumeChanged=function(e){var t=this._videoElement;t&&this._context.volume(t.volume)};t.prototype._handlePlay=function(e){this._context.isPlaying(!0)};t.prototype._handlePause=function(e){this._context.isScrubbing()||this._context.isPlaying(!1)};t.prototype._handleWaiting=function(e){this._context.isLoading(!0);this._onErrorChange()};t.prototype._handlePlaying=function(e){this._context.isLoading(!1);this._context.isSeeking(!1)};t.prototype._handleRateChange=function(){var e=this._videoElement.playbackRate;this._context.isLoading(e<.5)};t.prototype._handleBufferChange=function(){var e=this._videoElement,t=e.buffered,n=e.duration,i=this._context.bufferedRanges;this._checkPlayState(!0);this._checkEndState(!0);this._context.position(e.currentTime);this._context.duration(e.duration);if(n&&t){for(;i().length>t.length;)i.pop();for(var s=0;t&&s<t.length;s++){var o=i()[s],u=t.start(s),a=100*u/n+"%",f=100*(t.end(s)-u)/n+"%";if(o){o.left(a);o.width(f)}else i.push({left:r.observable(a),width:r.observable(f)})}}this._dashling&&this._updateDashlingState()};return t}(i.default);t.default=b});
define("@ms/dashling/lib/Dashling",["require","exports","tslib","./Settings","./StreamController","./DashlingEnums","./ManifestParser","@uifabric/utilities/lib/EventGroup"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=0,f=function(){function e(e){this.isDisposed=!1;this.settings=n.__assign({},r.defaultSettings,e||{});this._events=new u.EventGroup(this);this.reset()}e.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;this._events.dispose();this.reset()}};e.prototype.load=function(e,t){this.reset();this._sessionIndex=++a;this.startTime=Date.now();this._setState(s.DashlingSessionState.initializing);this.videoElement=e;this._initializeMediaSource(e);this._initializeManifest(t)};e.prototype.reset=function(){this.timeAtFirstCanPlay=null;this.startTime=null;this.lastError=null;this.streamController&&this.streamController.dispose();this.streamController=null;this._parser&&this._parser.dispose();this._parser=null;if(this.videoElement){this.settings.manifest=null;try{this.videoElement.pause()}catch(e){}}this.videoElement=null;this._mediaSource=null;this._setState(s.DashlingSessionState.idle)};e.prototype.resetStreams=function(){this.streamController&&this.streamController.reset()};e.prototype.getRemainingBuffer=function(){return this.streamController?this.streamController.getRemainingBuffer():0};e.prototype.getBufferRate=function(){return this.streamController?this.streamController.getBufferRate():0};e.prototype.getPlayingQuality=function(e){return this.streamController?this.streamController.getPlayingQuality(e):this.settings.targetQuality[e]};e.prototype.getBufferingQuality=function(e){return this.streamController?this.streamController.getBufferingQuality(e):this.settings.targetQuality[e]};e.prototype.getMaxQuality=function(e){var t=this.settings.manifest?this.settings.manifest.streams[e]:null;return t?t.qualities.length-1:0};e.prototype._setState=function(e,t,n,r,i){if(!this.isDisposed&&this.state!==e){this.state=e;this.lastErrorType=t;this.lastErrorMessage=n;this.lastHttpStatus=r;this.lastCorrelationId=i;this.lastError=t?t+" "+(n?"("+n+")":""):null;e===s.DashlingSessionState.error&&this.streamController&&this.streamController.dispose();this.timeAtFirstCanPlay||e!==s.DashlingSessionState.playing&&e!==s.DashlingSessionState.paused||(this.timeAtFirstCanPlay=Date.now()-this.startTime);this._events.raise("sessionstatechange",{state:e,errorType:t,errorMessage:n,httpStatus:r});if(this.videoElement)switch(e){case s.DashlingSessionState.initializing:case s.DashlingSessionState.buffering:u.EventGroup.raise(this.videoElement,"waiting",null);break;case s.DashlingSessionState.playing:u.EventGroup.raise(this.videoElement,"playing",null);break;case s.DashlingSessionState.error:case s.DashlingSessionState.disconnected:u.EventGroup.raise(this.videoElement,"error",null)}}};e.prototype._initializeMediaSource=function(e){var t=this,n=t._sessionIndex;try{var r=new MediaSource,i=function(){r.removeEventListener("sourceopen",i);if(t._sessionIndex===n){t._mediaSource=r;t._tryStart()}};r.addEventListener("sourceopen",i,!1);e.src=URL.createObjectURL(r)}catch(e){t._setState(s.DashlingSessionState.error,"mediaSourceInit")}};e.prototype._initializeManifest=function(e){var t=this,n=this._sessionIndex,r=function(e){if(t._sessionIndex===n&&t.state!==s.DashlingSessionState.error){t.settings.manifest=e;t._tryStart()}};if(this.settings.manifest)r(this.settings.manifest);else{(this._parser=new o.ManifestParser(this.settings)).parse(e,r,function(e,r,i,o){t._sessionIndex===n&&t._setState("networkDisconnected"===e?s.DashlingSessionState.disconnected:s.DashlingSessionState.error,e,r,i,o)})}};e.prototype._tryStart=function(){var e=this,t=this._mediaSource,n=this.videoElement,r=this.settings;if(!this.isDisposed&&this.state!==s.DashlingSessionState.error&&t&&n&&r.manifest){t.duration=r.manifest.mediaDuration;var o=new i.default(n,t,r);this.streamController=o;this._events.on(o,"sessionstatechange",function(t){e._setState(t.state,t.errorType,t.errorMessage,t.httpStatus,t.correlationId)});o.start()}};return e}();t.default=f});
define("@ms/dashling/lib/Settings",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultSettings={manifest:null,startTime:0,isABREnabled:!0,isRBREnabled:!1,targetQuality:{audio:2,video:2},shouldAutoPlay:!0,logToConsole:!1,safeBufferSeconds:12,maxBufferSeconds:119.5,maxConcurrentRequests:{audio:4,video:6},maxSegmentLeadCount:{audio:1,video:5},defaultBandwidth:520,requestTimeout:3e4,maxRetries:3,delaysBetweenRetries:[200,1500,3e3],requestCacheThreshold:80,baseUrlOverride:null,preprocessRequest:null,getRequestParametersAsync:null,testConnectivity:null,missingSegmentThreshold:0}});
define("@ms/dashling/lib/StreamController",["require","exports","@uifabric/utilities/lib/EventGroup","./Async","./Stream","./MetricSet","./Utilities","./DashlingEnums"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,f=.5;!function(e){e[e.closed=0]="closed";e[e.open=1]="open";e[e.ended=2]="ended"}(a||(a={}));var l=function(){function e(e,t,i){this._events=new n.EventGroup(this);this._async=new r.default(this);this._mediaSource=t;this._settings=i;this._bufferRate=new s.MetricSet(3);this._appendedSeconds=0;this._requestTimerIds=[0,0];this.streams=[];this._appendIndex=0;this._nextRequestTimerId=0;this._seekingTimerId=0;this.stalls=0;this._lastCurrentTime=0;this._lastTimeBeforeSeek=0;this._startTime=0;this._videoElement=e;this._playbackMonitorId=0;this._canPlay=!0;this._timeAtStall=0;this._isDisposed=!1;this._intializeVideoElement();this._initializeStreams(e,t,i);if(this.streams.length&&i&&i.startTime){var o=this.streams[0],u=o.fragments[0].time.lengthSeconds;this._appendIndex=Math.max(0,Math.min(o.fragments.length-1,Math.floor((i.startTime-f)/u)))}}e.prototype.dispose=function(){if(!this._isDisposed){this._isDisposed=!0;this._adjustPlaybackMonitor(!1);this._events.dispose();this._async.dispose();for(var e=0;this.streams&&e<this.streams.length;e++)this.streams[e].dispose();this._videoElement=null;this._mediaSource=null}};e.prototype.start=function(){this._startTime=Date.now();this._setCanPlay(!1);this._loadNextFragment();this._adjustPlaybackMonitor(!0)};e.prototype.getPlayingQuality=function(e){if(!this._isDisposed)for(var t=0,n=this.streams;t<n.length;t++){var r=n[t];if(r.streamType===e){var i=this._videoElement.currentTime,s=Math.min(r.fragments.length-1,Math.floor(i/r.fragments[0].time.lengthSeconds)),o=r.fragments[s].qualityIndex;return o>=0?o:r.qualityIndex}}return 0};e.prototype.getBufferingQuality=function(e){if(!this._isDisposed)for(var t=0,n=this.streams;t<n.length;t++){var r=n[t];if(r.streamType===e)return r.qualityIndex}return 0};e.prototype.getBufferRate=function(){return this._bufferRate.average};e.prototype.getRemainingBuffer=function(e){var t=0;if(!this._isDisposed){var n=(this._settings.startTime||this._videoElement.currentTime)+(e||0),r=this._videoElement.buffered;!n&&r.length>0&&r.start(0)<1&&(n=r.start(0));for(var i=0;i<r.length;i++)if(n>=r.start(i)&&n<=r.end(i)){for(var s=r.end(i);++i<r.length&&r.start(i)-s<.06;)s=r.end(i);t=s-n;break}}return t};e.prototype.getTimeUntilUnderrun=function(e){var t=Number.MAX_VALUE;if(!this._isDisposed){var n=this._settings.startTime||Math.max(.5,this._videoElement.currentTime),r=this._settings.manifest.mediaDuration-n-.5,i=this.getRemainingBuffer(e),s=this.getBufferRate(),o=Math.min(1,Math.max(0,i/this._settings.safeBufferSeconds));if(r>i){(t=i+o*(i*s))>Math.min(r,.5*this._settings.maxBufferSeconds)&&(t=Number.MAX_VALUE)}}return t};e.prototype.reset=function(){this._onThrottledSeek(!0)};e.prototype._intializeVideoElement=function(){var e=this._videoElement;e&&this._events.onAll(e,{seeking:this._onVideoSeeking,error:this._onVideoError,play:this._onPauseStateChange,pause:this._onPauseStateChange,ended:this._onVideoEnded,ratechange:this._onVideoRateChange})};e.prototype._initializeStreams=function(e,t,n){var r=n&&n.manifest&&n.manifest.streams||null,s=[];if(r){r.audio&&s.push(new i.Stream("audio",t,e,n));r.video&&s.push(new i.Stream("video",t,e,n))}this.streams=s;for(var o=this._events,u=function(e){o.raise("sessionstatechange",e)},a=0,f=s;a<f.length;a++){var l=f[a];o.on(l,"sessionstatechange",u);l.initialize()}};e.prototype._loadNextFragment=function(){var e=this;if(!e._isDisposed){for(var t=function(t,n){if(!e._isDisposed){var r=e._requestTimerIds;r[t]&&e._async.clearTimeout(r[t]);r[t]=e._async.setTimeout(function(){r[t]=0;e._loadNextFragment()},n)}},n=e._getDownloadCandidates(),r=0;r<n.downloads.length;r++)for(var i=n.downloads[r],s=e.streams[r],o=0;o<i.length;o++){var a=i[o],f=s.fragments[a-1],l=f&&f.activeRequest,c=l&&l.state===u.DashlingRequestState.downloading?l:null,h=s.getRequestStaggerTime(),p=c?Date.now()-c.startTime:0;if(c&&!(p>=h)){t(r,h-p);break}s.load(a,function(){e._appendNextFragment()})}n.isAtMax&&t(0,300)}};e.prototype._appendNextFragment=function(){var e,t,n=this,r=n.streams;if(!n._isDisposed){var i=n._settings.startTime||n._videoElement.currentTime,s=n._mediaSource;if(r&&r.length&&s&&!c(s.readyState,a.closed)){for(;n._appendIndex<r[0].fragments.length;){var o=!0,f=!0;for(t=0;t<r.length;t++){e=r[t];o=o&&e.canAppend(n._appendIndex);var l=e.fragments[n._appendIndex].state;f=f&&(l===u.DashlingRequestState.appended&&!e.isMissing(n._appendIndex,i)||l===u.DashlingRequestState.endOfStream)}if(o){f=!1;for(t=0;t<r.length;t++){(e=r[t]).append(n._appendIndex,function(){n._appendNextFragment()});l=e.fragments[n._appendIndex].state;f=f&&(l===u.DashlingRequestState.appended||l===u.DashlingRequestState.endOfStream)}}if(!f)break;var h=n.streams[0].fragments[n._appendIndex];if(!h.activeRequest.hasUpdatedBufferRate){h.activeRequest.hasUpdatedBufferRate=!0;n._appendedSeconds+=h.time.lengthSeconds;var p=(Date.now()-n._startTime)/1e3;n._bufferRate.append(n._appendedSeconds/(p||.1))}n._appendIndex++;if(n._settings.startTime)try{n._videoElement.currentTime=n._settings.startTime;n._settings.startTime=0}catch(e){}n._checkCanPlay()}n._appendIndex===r[0].fragments.length&&c(s.readyState,a.open)&&s.endOfStream();n._loadNextFragment()}}};e.prototype._adjustPlaybackMonitor=function(e){var t=this;if(!e&&t._playbackMonitorId){t._async.clearTimeout(t._playbackMonitorId);t._playbackMonitorId=0}else e&&!t._playbackMonitorId&&(t._playbackMonitorId=t._async.setInterval(function(){t._checkCanPlay()},200))};e.prototype._checkCanPlay=function(){var e=this,t=e.getTimeUntilUnderrun(),n=e._videoElement,r=e._lastCurrentTime=n.currentTime;if(e._canPlay&&t<.1&&!e._timeAtStall){e._timeAtStall=e._lastCurrentTime;e._async.setTimeout(function(){var t=e._timeAtStall;e._timeAtStall=0;if(!e._isDisposed&&n.currentTime===t){e.stalls++;e._setCanPlay(!1)}},200)}if(!e._canPlay){if(t>e.streams[0].fragments[0].time.lengthSeconds&&e.getBufferRate()>1||t>e._settings.safeBufferSeconds)e._setCanPlay(!0);else if(e.getTimeUntilUnderrun(.5)>e._settings.safeBufferSeconds){n.currentTime=Math.min(r+.5,n.duration);e._setCanPlay(!0)}}e._events.raise("sessionstatechange",{state:e._canPlay?e._videoElement.paused?u.DashlingSessionState.paused:u.DashlingSessionState.playing:u.DashlingSessionState.buffering})};e.prototype._getDownloadCandidates=function(){var e=this._getCurrentFragmentRange(),t=[],n=0;if(e.start>-1){this._ensureStreamsUpdated(e);var r=this._getMissingFragmentIndex(e);if(r>=0){e.start=Math.max(e.start,r);for(var i=0;i<this.streams.length;i++){var s=this.streams[i],o=this._getDownloadableIndexes(s,e);t.push(o);n+=o.length}}}return{downloads:t,isAtMax:!n&&e.end>=0&&e.end<this.streams[0].fragments.length-1}};e.prototype._getCurrentFragmentRange=function(){var e=this._videoElement,t=this._settings.manifest.mediaDuration;if(t>0){var n=this._settings.startTime||e.currentTime,r=n+.005>=t,i=this.streams[0],s=i.fragments.length,o=i.fragments[0].time.lengthSeconds;if(!r){n>f&&(n-=f);return{start:Math.max(0,Math.min(s-1,Math.floor(n/o))),end:Math.max(0,Math.min(s-1,Math.ceil((n+this._settings.maxBufferSeconds)/o)))}}}return{start:-1,end:-1}};e.prototype._ensureStreamsUpdated=function(e){for(var t=this._videoElement.currentTime,n=0,r=this.streams;n<r.length;n++){var i=r[n];i.assessQuality();for(var s=e.start;s<=e.end;s++)if(i.isMissing(s,t)){var a=i.fragments[s];o.log("Missing fragment reset: stream="+i.streamType+"index="+s+" ["+a.time.startSeconds+"]",this._settings);i.fragments[s].state=u.DashlingRequestState.idle}}};e.prototype._getMissingFragmentIndex=function(e){for(var t=e.start;t<=e.end;t++)for(var n=0,r=this.streams;n<r.length;n++){if(r[n].fragments[t].state<=u.DashlingRequestState.idle)return t}return-1};e.prototype._getDownloadableIndexes=function(e,t){for(var n=[],r=Math.min(t.end,t.start+this._settings.maxSegmentLeadCount[e.streamType]),i=this._settings.maxConcurrentRequests[e.streamType]-e.getActiveRequestCount(),s=t.start;n.length<i&&s<=r;s++)e.fragments[s].state<=u.DashlingRequestState.idle&&n.push(s);return n};e.prototype._setCanPlay=function(e){if(this._canPlay!==e){this._canPlay=e;this._onVideoRateChange()}};e.prototype._onVideoSeeking=function(){this._lastTimeBeforeSeek||(this._lastTimeBeforeSeek=this._lastCurrentTime);this._seekingTimerId&&this._async.clearTimeout(this._seekingTimerId);this._setCanPlay(!1);this._settings.startTime=0;this._seekingTimerId=this._async.setTimeout(this._onThrottledSeek,300)};e.prototype._onThrottledSeek=function(e){if(!this._isDisposed){var t=this._videoElement.currentTime,n=Math.floor(Math.max(0,t-f)/this.streams[0].fragments[0].time.lengthSeconds),r=this._videoElement.buffered,i=1===r.length&&r.start(0)<=Math.max(0,t-2)&&r.end(0)>t;o.log("Throttled seek: "+this._videoElement.currentTime,this._settings);this._seekingTimerId=0;this._lastTimeBeforeSeek=0;this._async.clearTimeout(this._nextRequestTimerId);this._nextRequestTimerId=0;var s=e||this._appendIndex<n,u=e||this._settings.manifest.mediaDuration>this._settings.maxBufferSeconds&&!i;this._appendIndex=n;o.log("Clearing buffer",this._settings);for(var a=0,l=this.streams;a<l.length;a++){var c=l[a];s&&c.abortAll();u&&c.clearBuffer()}this._appendNextFragment()}};e.prototype._onVideoError=function(){this._events.raise("sessionstatechange",{state:u.DashlingSessionState.error,errorType:"videoElementError",errorMessage:o.getVideoError(this._videoElement)})};e.prototype._onPauseStateChange=function(){this._adjustPlaybackMonitor(!this._videoElement.paused);this._checkCanPlay()};e.prototype._onVideoEnded=function(){this._events.raise("sessionstatechange",{state:u.DashlingSessionState.paused})};e.prototype._onVideoRateChange=function(){var e=this._canPlay?1:0,t=this._videoElement;t.playbackRate!==e&&(t.playbackRate=t.defaultPlaybackRate=e)};return e}();t.default=l;function c(e,t){return e===t||e===a[t]}});
define("@ms/dashling/lib/Async",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=window.clearTimeout,r=window.setTimeout,i=window.setInterval,s=function(){function e(e){this._parent=e;this._throttleIds={};this._timeoutIds={}}e.prototype.dispose=function(){if(this._throttleIds){for(var e in this._throttleIds)n(this._throttleIds[e]);this._throttleIds=null}for(var e in this._timeoutIds)n(Number(e));this._timeoutIds=null};e.prototype.setTimeout=function(e,t){return this._setTimer(e,t,r)};e.prototype.setInterval=function(e,t){return this._setTimer(e,t,i)};e.prototype.clearTimeout=function(e){n(e);this._timeoutIds&&delete this._timeoutIds[e]};e.prototype.throttle=function(e,t,n){var i=this,s=this._throttleIds;s&&(s[t]||(s[t]=r(function(){e.apply(i._parent);delete s[t]},n)))};e.prototype._setTimer=function(e,t,n){var r=this;if(this._timeoutIds){var i;(i=n(function(){r._timeoutIds&&delete r._timeoutIds[i];e.apply(r._parent)},t))&&(this._timeoutIds[i]=i);return i}return 0};return e}();t.default=s});
define("@ms/dashling/lib/Stream",["require","exports","./RequestManager","./Request","@uifabric/utilities/lib/EventGroup","./Utilities","./Async","./MetricSet","./Storage","./DashlingEnums"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l="Dashling.Stream.",c=function(){function e(e,t,r,s){var c=s.manifest,h=c.streams[e];this._events=new i.EventGroup(this);this._async=new o.default(this);this._storage=new a.Storage(l);this.streamType=e;this.qualityIndex=Math.max(0,Math.min(h.qualities.length-1,s.targetQuality[e]));this.bufferRate=new u.MetricSet(5);this._startTime=Date.now();this._appendLength=0;this._appendTimeoutId=0;this._initRequestManager=new n.RequestManager(s);this.requestManager=new n.RequestManager(s);this._mediaSource=t;this._videoElement=r;this._settings=s;this._manifest=c;this._streamInfo=h;this._buffer=null;this._hasInitializedBuffer=!1;this._initSegments=[];this._isAppending=!1;this._isDisposed=!1;var p=h.timeline.map(function(e,t){return{state:f.DashlingRequestState.idle,qualityIndex:-1,qualityId:"",requestType:"media",fragmentIndex:t,time:e,activeRequest:null,requests:[]}});this.fragments=p}e.prototype.dispose=function(){if(!this._isDisposed){this._isDisposed=!0;this._events.dispose();this._async.dispose();this.requestManager.dispose();this._initRequestManager.dispose()}};e.prototype.initialize=function(){var e=this._streamInfo.mimeType+";codecs="+this._streamInfo.codecs,t=this._events;if(!this._buffer)try{s.log("Creating "+e+" buffer",this._settings);var n=this._buffer=this._mediaSource.addSourceBuffer(e);t.on(n,"error",function(n){t.raise("sessionstatechange",{state:f.DashlingSessionState.error,errorType:"sourceBufferError",errorMessage:"type="+e+" error="+n})})}catch(n){t.raise("sessionstatechange",{state:f.DashlingSessionState.error,errorType:"sourceBufferInit",errorMessage:"type="+e+" error="+n})}};e.prototype.abortAll=function(){this.requestManager.abortAll()};e.prototype.clearBuffer=function(){this._async.clearTimeout(this._appendTimeoutId);this._isAppending=!1;this.abortAll();try{this._buffer.remove(0,this._videoElement.duration)}catch(e){}for(var e=0,t=this.fragments;e<t.length;e++){var n=t[e];n.state!==f.DashlingRequestState.downloaded&&(n.state=f.DashlingRequestState.idle)}};e.prototype.canAppend=function(e){var t=this.fragments[e],n=t&&this._initSegments[t.qualityIndex],r=this._initSegments[this._streamInfo.qualities.length-1];return!!(t&&t.state===f.DashlingRequestState.downloaded&&n&&n.state>=f.DashlingRequestState.downloaded&&r&&r.state>=f.DashlingRequestState.downloaded)};e.prototype.append=function(e,t){var n=this,r=n.fragments,i=r[e],o=n._streamInfo.qualities.length-1,u=[],a=n._buffer,l=n._settings.missingSegmentThreshold;if(!n._isAppending&&i&&i.state===f.DashlingRequestState.downloaded){n._isAppending=!0;i.state=f.DashlingRequestState.appending;if(!this._hasInitializedBuffer){this._hasInitializedBuffer=!0;o>i.qualityIndex&&u.push(n._initSegments[o])}u.push(n._initSegments[i.qualityIndex]);u.push(i.activeRequest);c()}else i&&i.state===f.DashlingRequestState.endOfStream&&t(i);function c(){if(!n._isDisposed)if(a.updating)n._appendTimeoutId=n._async.setTimeout(c,10);else{var o=u[0];if(u.length){n._events.on(a,"updateend",p);try{h("started",o);a.appendBuffer(o.data)}catch(e){if(e.code===DOMException.QUOTA_EXCEEDED_ERR){s.log("Append failed due to quota exception; trying again momentarily");n._events.off(a);n._appendTimeoutId=setTimeout(c,500)}else d("sourceBufferAppendException",e)}}else n._appendTimeoutId=n._async.setTimeout(function(){if(!n._isDisposed){var s=i.activeRequest&&i.activeRequest.hasStreamEnded;i.state=s?f.DashlingRequestState.endOfStream:f.DashlingRequestState.appended;n._isAppending=!1;var o=e-r.length,u=n.isMissing(e,n._videoElement.currentTime);if(u&&o<l)d("sourceBufferAppendMissing","Buffer missing "+n._streamInfo.mimeType+" fragment at end-relative index "+o);else{u&&(i.state=f.DashlingRequestState.endOfStream);var a=(Date.now()-n._startTime)/1e3;n._appendLength+=i.time.lengthSeconds;n.bufferRate.append(n._appendLength/a);t(i)}}},30)}}function h(e,t){s.log("Append "+e+": "+n.streamType+" "+t.qualityId+" "+t.requestType+" "+(void 0!==t.fragmentIndex?"index "+t.fragmentIndex:""),n._settings)}function p(){if(!n._isDisposed){var e=u[0];n._events.off(a);e.timeAtAppended=Date.now()-e.startTime;e.state=f.DashlingRequestState.appended;e.clearDataAfterAppend&&(e.data=null);h("complete",e);u.shift();c()}}function d(t,r){var o="error="+(r=r||"")+" (quality="+i.qualityId+(void 0!==e?" index="+e:"")+")";i.state=f.DashlingRequestState.error;n._isAppending=!1;s.log("Append exception: "+o);n._events.raise("sessionstatechange",{state:f.DashlingSessionState.error,errorType:t,errorMessage:o})}};e.prototype.getBufferRate=function(){return this.bufferRate.average||0};e.prototype.getActiveRequestCount=function(){return this.requestManager.getActiveRequestCount()};e.prototype.getRequestStaggerTime=function(){return Math.round(1400*this._estimateDownloadSeconds(this.qualityIndex))};e.prototype.isMissing=function(e,t){return this.fragments[e].state===f.DashlingRequestState.appended&&!this.isBuffered(e,t)};e.prototype.isBuffered=function(e,t){var n=this.fragments[e];if(n){var r=this._buffer.buffered,i=n.time,s=i.startSeconds,o=i.lengthSeconds,u=s<.3,a=s+o+.3>=this._manifest.mediaDuration,f=Math.max(t,s+(u?.8:.15)),l=s+o-(a?.8:.15);try{for(var c=0;c<r.length;c++)if(r.start(c)<=f&&r.end(c)>=l)return!0}catch(e){return!0}}return!1};e.prototype.canLoad=function(e){return this.fragments[e].state<=f.DashlingRequestState.idle};e.prototype.load=function(e,t){var n=this,i=n.fragments,o=i[e],u=function(t){for(var n=e+t,r=i.length;n<r;n++)i[n].state=f.DashlingRequestState.endOfStream};if(o&&o.state<=f.DashlingRequestState.idle){o.state=f.DashlingRequestState.downloading;o.qualityIndex=n.qualityIndex;o.qualityId=this._streamInfo.qualities[o.qualityIndex].id;n._loadInitSegment(this.qualityIndex,t);var a=new r.Request({url:n._getUrl(o),fragmentIndex:e,requestType:"media",qualityIndex:o.qualityIndex,qualityId:o.qualityId,clearDataAfterAppend:!0,isArrayBuffer:!0,onSuccess:function(e){if(!n._isDisposed){o.state=f.DashlingRequestState.downloaded;e.hasStreamEnded&&u(1);var r=Math.round(e.timeAtLastByte-e.timeAtFirstByte),i=e.timeAtLastByte-r;s.log("Download complete: "+e.qualityId+" "+e.requestType+" index: "+e.fragmentIndex+" waiting: "+i+"ms receiving: "+r,n._settings);t()}},onError:function(e){if(!n._isDisposed)if(e.state===f.DashlingRequestState.disconnected){o.state=f.DashlingRequestState.idle;o.activeRequest=null;o.requests=[];n._events.raise("sessionstatechange",{state:f.DashlingSessionState.disconnected,errorTYpe:"mediaSegmentDownload",errorMessage:e.statusCode,httpStatus:e.httpStatus,correlationId:e.correlationId})}else if(e.isAborted){o.state=o.state===f.DashlingRequestState.endOfStream?o.state:f.DashlingRequestState.idle;o.activeRequest=null;o.requests=[]}else{o.state=f.DashlingRequestState.error;e.hasStreamEnded?u(0):n._events.raise("sessionstatechange",{state:f.DashlingSessionState.error,errorType:"mediaSegmentDownload",errorMessage:e.statusCode,httpStatus:e.httpStatus,correlationId:e.correlationId})}}},this._settings);o.activeRequest=a;o.requests.push(a);s.log("Download started: "+o.qualityId+" media index="+e+" time="+(Date.now()-n._startTime)+"ms stagger="+n.getRequestStaggerTime()+"ms",n._settings);n.requestManager.start(a)}};e.prototype.assessQuality=function(){var e=this,t=e._settings,n=e.requestManager.bytesPerSeconds.average,r=e._streamInfo,i=r.qualities.length-1;n?"video"===this.streamType&&this._storage.setItem("bytesPerSecond",String(n)):n=parseFloat(this._storage.getItem("bytesPerSecond"));if(t.isABREnabled&&n)if(t.isRBREnabled)e.qualityIndex=Math.round(Math.random()*i);else{for(var o=0,u="Quality check "+e.streamType+": bps="+Math.round(n),a=r.timeline[0].lengthSeconds,f=.4*a,l=0;l<=i;l++){var c=e._estimateDownloadSeconds(l,0);u+=" "+l+"="+c.toFixed(2)+"s";c+f<a&&(o=l)}e._async.throttle(function(){s.log(u,e._settings)},"assess",1e3);e.qualityIndex=o}else e.qualityIndex=Math.min(r.qualities.length-1,t.targetQuality[e.streamType])};e.prototype._estimateDownloadSeconds=function(e,t){var n=this._streamInfo.qualities[e],r=this._streamInfo.timeline[t||0].lengthSeconds,i=n.bandwidth/8*r,s=this.requestManager.bytesPerSeconds.average;s?"video"===this.streamType&&this._storage.setItem("bytesPerSecond",String(s)):s=parseFloat(this._storage.getItem("bytesPerSecond"));return i/(s||this._settings.defaultBandwidth)};e.prototype._loadInitSegment=function(e,t){var n=this,i=n._streamInfo.qualities,o=i.length-1,u=i[e].id;e!==o&&n._loadInitSegment(o,t);if(!n._initSegments[e]){var a=n._initSegments[e]=new r.Request({url:this._getInitUrl(e),requestType:"init",qualityIndex:e,qualityId:u,isArrayBuffer:!0,onSuccess:function(e){if(!n._isDisposed){e.state=f.DashlingRequestState.downloaded;s.log("Download complete: "+n.streamType+" "+e.qualityId+" "+e.requestType,n._settings);t(e)}},onError:function(t){if(!n._isDisposed)if(t.state===f.DashlingRequestState.disconnected){n._initSegments[e]=void 0;n._events.raise("sessionstatechange",{state:f.DashlingSessionState.disconnected,errorTYpe:"mediaSegmentDownload",errorMessage:t.statusCode,httpStatus:t.httpStatus,correlationId:t.correlationId})}else if(t.isAborted)n._initSegments[e]=void 0;else{t.state=f.DashlingRequestState.error;n._events.raise("sessionstatechange",{state:f.DashlingSessionState.error,errorType:"initSegmentDownload",errorMessage:t.statusCode,httpStatus:t.httpStatus,correlationId:t.correlationId})}}},this._settings);s.log("Download started: "+n.streamType+" "+u+" init",n._settings);n._initRequestManager.start(a)}};e.prototype._getInitUrl=function(e){var t=this._streamInfo.initUrlFormat.replace("$RepresentationID$",this._streamInfo.qualities[e].id);return this._manifest.baseUrl+t};e.prototype._getUrl=function(e){var t=this._streamInfo.fragUrlFormat.replace("$RepresentationID$",e.qualityId).replace("$Time$",""+e.time.start);return this._manifest.baseUrl+t};return e}();t.Stream=c});
define("@ms/dashling/lib/RequestManager",["require","exports","./MetricSet","./DashlingEnums"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=0,s=function(){function e(e){this._settings=e;this._activeRequests=Object.create(null);this.waitTimes=new n.MetricSet(20);this.receiveTimes=new n.MetricSet(20);this.bytesPerSeconds=new n.MetricSet(20);this._activeRequestCount=0}e.prototype.dispose=function(){this.abortAll()};e.prototype.getActiveRequestCount=function(){return this._activeRequestCount};e.prototype.abortAll=function(){var e=this._activeRequests;for(var t in e)e[t].dispose();this._activeRequests=Object.create(null)};e.prototype.start=function(e){var t=this;this._activeRequests[i++]=e;this._activeRequestCount++;e.start({onBandwidthUpdate:function(e){t.bytesPerSeconds.append(e)},onComplete:function(e){t._activeRequestCount--;if(e.state===r.DashlingRequestState.downloaded){if(!(e.timeAtLastByte<t._settings.requestCacheThreshold)){t.waitTimes.append(e.timeAtFirstByte);t.receiveTimes.append(e.timeAtLastByte)}}}})};return e}();t.RequestManager=s});
define("@ms/dashling/lib/MetricSet",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.reset();this._max=e}e.prototype.append=function(e){var t=this.average,n=this.metricValues,r=n.push(e),i=(e-t)/r;r>this._max&&(i+=(t+i-n.shift())/(r-1));this.average+=i;this.min=Math.min(e,this.min);this.max=Math.max(e,this.max)};e.prototype.reset=function(){this.metricValues=[];this.average=this.min=this.max=0};return e}();t.MetricSet=n});
define("@ms/dashling/lib/DashlingEnums",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e.sessionStateChange="sessionstatechange"}(t.DashlingEvent||(t.DashlingEvent={}));!function(e){e.mediaSourceInit="mediaSourceInit";e.manifestDownload="manifestDownload";e.initSegmentDownload="initSegmentDownload";e.mediaSegmentDownload="mediaSegmentDownload";e.manifestParse="manifestParse";e.videoElementError="videoElementError";e.sourceBufferInit="sourceBufferInit";e.sourceBufferAppendException="sourceBufferAppendException";e.sourceBufferError="sourceBufferError";e.sourceBufferAppendMissing="sourceBufferAppendMissing";e.networkDisconnected="networkDisconnected"}(t.DashlingError||(t.DashlingError={}));!function(e){e[e.disconnected=-2]="disconnected";e[e.error=-1]="error";e[e.idle=0]="idle";e[e.initializing=1]="initializing";e[e.buffering=2]="buffering";e[e.playing=4]="playing";e[e.paused=5]="paused"}(t.DashlingSessionState||(t.DashlingSessionState={}));!function(e){e[e.disconnected=-2]="disconnected";e[e.error=-1]="error";e[e.idle=0]="idle";e[e.downloading=1]="downloading";e[e.downloaded=2]="downloaded";e[e.endOfStream=3]="endOfStream";e[e.appending=4]="appending";e[e.appended=5]="appended";e[e.aborted=6]="aborted"}(t.DashlingRequestState||(t.DashlingRequestState={}));!function(e){e[e.MEDIA_ERR_ABORTED=1]="MEDIA_ERR_ABORTED";e[e.MEDIA_ERR_NETWORK=2]="MEDIA_ERR_NETWORK";e[e.MEDIA_ERR_DECODE=3]="MEDIA_ERR_DECODE";e[e.MEDIA_ERR_SRC_NOT_SUPPORTED=4]="MEDIA_ERR_SRC_NOT_SUPPORTED";e[e.MS_MEDIA_ERR_ENCRYPTED=5]="MS_MEDIA_ERR_ENCRYPTED"}(t.VideoElementError||(t.VideoElementError={}))});
define("@ms/dashling/lib/Request",["require","exports","./DashlingEnums"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this._options=e;this._settings=t;this.state=n.DashlingRequestState.idle;this.data=null;this.timeAtFirstByte=-1;this.timeAtLastByte=-1;this.statusCode="";this.progressEvents=[];this.bytesLoaded=0;this.bytesPerMillisecond=0;this.correlationId="";this.requestType=e.requestType;this.fragmentIndex=e.fragmentIndex;this.qualityIndex=e.qualityIndex;this.qualityId=e.qualityId;this.clearDataAfterAppend=e.clearDataAfterAppend;this.hasUpdatedBufferRate=!1;this.isAborted=!1;this._requestAttempt=0;this._requestUrl="";this._xhrType=XMLHttpRequest;this._responseHeaders=null}e.prototype.dispose=function(){if(!this._isDisposed){this._isDisposed=!0;if(this._xhr){if(this.state===n.DashlingRequestState.downloading){this.state=n.DashlingRequestState.aborted;this.statusCode="aborted";this.isAborted=!0;this._xhr.abort();this._options.onError&&this._options.onError(this);this._complete()}this._xhr=null}if(this._retryTimeoutId){clearTimeout(this._retryTimeoutId);this._retryTimeoutId=null}this._onBandwidthUpdate=this._onComplete=null}};e.prototype.start=function(e){this._onBandwidthUpdate=e.onBandwidthUpdate;this._onComplete=e.onComplete;var t=this,r=t._options,i=r.url,s=r.isArrayBuffer,o=t._xhr=new t._xhrType;t._responseHeaders=null;var u=t._settings,a=function(e){var r=t.startTime=Date.now(),i=e.url,u=e.headers,a=e.body,f=e.useCredentials;t._requestUrl=i;t._requestAttempt++;o.open(a?"POST":"GET",i,!0);s&&(o.responseType="arraybuffer");if(u)for(var l=0,c=Object.keys(u);l<c.length;l++){var h=c[l];o.setRequestHeader(h,u[h])}f&&(o.withCredentials=!0);o.timeout=t._settings.requestTimeout;o.onreadystatechange=function(){!t._isDisposed&&o.readyState>0&&t.timeAtFirstByte<0&&(t.timeAtFirstByte=Date.now()-r)};o.onprogress=function(e){if(!t._isDisposed){t.progressEvents.push({timeFromStart:Date.now()-r,bytesLoaded:e.lengthComputable?e.loaded:-1});t._postProgress()}};o.onloadend=function(){t._isDisposed||t._processResult()};t.state=n.DashlingRequestState.downloading;o.send(a)};if(u.getRequestParametersAsync)u.getRequestParametersAsync(i).then(a,function(e){t.state=n.DashlingRequestState.error;t.statusCode=e.code||"getRequestParametersAsync";t.httpStatus=0;t.correlationId=e.correlationId;t._options.onError&&t._options.onError(t)});else{u.preprocessRequest&&(i=u.preprocessRequest(i));a({url:i})}};e.prototype._processResult=function(){var e=this._xhr,t=this.progressEvents,r=this._options.isArrayBuffer;this._xhr=null;this.timeAtLastByte=Date.now()-this.startTime;if(e.status>=200&&e.status<=299){this.bytesLoaded=r?e.response.byteLength:e.responseText?e.responseText.length:0;e.onreadystatechange(null);this._postProgress();if(t.length>2){var i=t[t.length-1],s=t[0],o=i.timeFromStart-s.timeFromStart,u=i.bytesLoaded-s.bytesLoaded;this.bytesPerMillisecond=u/o;this.timeAtFirstByte=this.timeAtLastByte-this.bytesLoaded/this.bytesPerMillisecond}this.data=r?new Uint8Array(e.response):e.responseText;this.statusCode=String(e.status);this.state=n.DashlingRequestState.downloaded;var a=this._getResponseHeaders(e);this.correlationId=a["x-correlationid"];var f=a["x-errorcode"]||a["x-clienterrorcode"];f&&f.indexOf("EndOfStream")>-1&&(this.hasStreamEnded=!0);this._complete();this._options.onSuccess&&this._options.onSuccess(this)}else this._processError(e)};e.prototype._processError=function(e){var t=this,r=e.status,i=t._settings,s=!t.isAborted&&(r<400||r>406)&&t._requestAttempt<i.maxRetries,o=i.delaysBetweenRetries;if(s){var u=o[t._requestAttempt-1]||o[o.length-1];t._retryTimeoutId=window.setTimeout(function(){t.start({onBandwidthUpdate:t._onBandwidthUpdate,onComplete:t._onComplete})},u)}else if(i.testConnectivity&&0===r&&!e.responseText){i.testConnectivity(t._requestUrl).then(function(){t._processTerminalError(e)},function(e){!function(e){t.state=n.DashlingRequestState.disconnected;t.statusCode=e||"disconnected";t.httpStatus=0;t._complete();t._options.onError&&t._options.onError(t)}(e.code)})}else t._processTerminalError(e)};e.prototype._processTerminalError=function(e){var t=e.status,r=0===t&&this.timeAtLastByte>=this._settings.requestTimeout-100,i=this._getResponseHeaders(e),s=i["x-errorcode"]||i["x-clienterrorcode"],o=i["x-correlationid"];s&&s.indexOf("EndOfStream")>-1&&(this.hasStreamEnded=!0);this.state=n.DashlingRequestState.error;this.statusCode=this.isAborted?"aborted":r?"timeout":s||String(t);this.httpStatus=t;this.correlationId=o;this._complete();this._options.onError&&this._options.onError(this)};e.prototype._postProgress=function(){if(this._onBandwidthUpdate){var e=this.progressEvents;if(e.length>2){var t=e[e.length-1],n=e[0],r=t.bytesLoaded-n.bytesLoaded;if(r>1e4){var i=t.timeFromStart-n.timeFromStart;i>5&&this._onBandwidthUpdate(1e3*r/i)}}}};e.prototype._complete=function(){this._onComplete&&this._onComplete(this);this._onComplete=null;this._onBandwidthUpdate=null};e.prototype._getResponseHeaders=function(e){var t=this._responseHeaders;if(!t){this._responseHeaders=t={};try{for(var n=0,r=e.getAllResponseHeaders().split("\r\n");n<r.length;n++){var i=r[n],s=i.indexOf(":");s&&(t[i.slice(0,s)]=i.slice(s+1).trim())}}catch(e){}}return t};return e}();t.Request=r});
define("@ms/dashling/lib/Utilities",["require","exports","./DashlingEnums"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.log=function(e,t){t&&!t.logToConsole||console.log(e)};t.getVideoError=function(e){var t=e.error;return t?n.VideoElementError[t.code]||String(t.code):""}});
define("@ms/dashling/lib/Storage",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this._prefix=e||"";this._useSessionStorage=!!t}e.prototype.getItem=function(e,t){e=this._prefix+e;try{return this._useSessionStorage?window.sessionStorage.getItem(e):window.localStorage.getItem(e)}catch(e){}return t};e.prototype.setItem=function(e,t){e=this._prefix+e;try{this._useSessionStorage?window.sessionStorage.setItem(e,t):window.localStorage.setItem(e,t)}catch(e){}};return e}();t.Storage=n});
define("@ms/dashling/lib/ManifestParser",["require","exports","./RequestManager","./Request","./DashlingEnums","./Manifest"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this._parseIndex=0;this._settings=e;this._requestManager=new n.RequestManager(e)}e.prototype.dispose=function(){if(this._requestManager){this._requestManager.dispose();this._requestManager=null}};e.prototype.parse=function(e,t,n){var o=this,u=++this._parseIndex,a=new r.Request({url:e,requestType:"manifest",onSuccess:function(e){if(o._parseIndex===u)try{var r=s.fromRequest(e,o._settings);t(r)}catch(t){"object"==typeof t&&(t.data=""+e.data);n("manifestParse",t,e.httpStatus,e.correlationId)}},onError:function(e){o._parseIndex===u&&n(e.state===i.DashlingRequestState.disconnected?"networkDisconnected":"manifestDownload",e.statusCode,e.httpStatus,e.correlationId)}},this._settings);this._requestManager.start(a)};return e}();t.ManifestParser=o});
define("@ms/dashling/lib/Manifest",["require","exports","tslib"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function r(e,t){for(var n=(new DOMParser).parseFromString(e,"text/xml"),r=t.baseUrlOverride||function(e,t,n){var r=e.getElementsByTagName(t)[0],i=r&&r.childNodes[0];return i?i.nodeValue:n}(n,"BaseURL",""),s=function(e){var t=0,n=e.slice(2),r=n.indexOf("H");if(r>-1){t+=60*Number(n.slice(0,r))*60;n=n.slice(r+1)}if((r=n.indexOf("M"))>-1){t+=60*Number(n.slice(0,r));n=n.slice(r+1)}(r=n.indexOf("S"))>-1&&(t+=Number(n.slice(0,r)));return t}(i(n.documentElement,"mediaPresentationDuration")),o={},u=n.querySelectorAll("AdaptationSet"),a=0;a<u.length;a++){var f=u[a];if(f){var l=f.querySelectorAll("S");if(!l||!l.length)throw"Missing timeline";for(var c=i(f,"contentType"),h=f.querySelectorAll("Representation"),p=f.querySelector("SegmentTemplate"),d=Number(i(p,"timescale")),v=[],m=[],g=0;g<h.length;g++){var y=h[g],b=i(y,"height"),w={id:i(y,"id"),bandwidth:Number(i(y,"bandwidth")),width:b&&Number(i(y,"width"))||0,height:b&&Number(b)||0};v.push(w)}for(var E=0,S=0;S<l.length;S++)for(var x=l[S],T=Number(i(x,"r"))||0,N=Number(i(x,"d")),C=0;C<=T;C++){m.push({start:E,startSeconds:E/d,length:N,lengthSeconds:N/d});E+=N}o[c]={streamType:c,mimeType:i(f,"mimeType"),codecs:i(f,"codecs"),initUrlFormat:i(p,"initialization"),fragUrlFormat:i(p,"media"),qualities:v,timeline:m}}}return{baseUrl:r,mediaDuration:s,streams:o}}t.fromText=r;t.fromRequest=function(e,t){return n.__assign({},r(e.data,t),{request:e})};function i(e,t){return e.getAttribute(t)}});
define("odsp-next/controls/video/controls/canvas/FlashVideoContextBinding",["require","exports","tslib","knockout","@ms/odsp-shared/lib/bindings/base/BaseBinding","@ms/odsp-utilities/lib/browser/PlatformDetection","../../VideoPlayer.resx","../../VideoError","../../VideoErrorType","../../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=0,c=new s.default,h={},p=function(t){n.__extends(i,t);function i(e){var n=t.call(this,e)||this;n.controlsDescendantBindings=!0;n._context=n.valueAccessor();n._isPlayerReady=r.observable(!1);n.subscribe(n._context.url,n._onUrlChanged);n.createBackgroundComputed(n._computeVolume);n.createBackgroundComputed(n._computeIsMuted);n.subscribe(n._context.seekPercentage,n.async.debounce(n._onSeekPercentageChanged,100));n.subscribe(n._context.isScrubbing,n._onIsScrubbingChanged);n.subscribe(n._context.isPlaying,n._onIsPlayingChanged);n._onUrlChanged();return n}i.prototype.dispose=function(){this._removeFlashPlayer();t.prototype.dispose.call(this)};i.prototype.handlePlaybackEvent=function(e,t){var n=this._playerElement;n||(n=this._playerElement=document.getElementById(this._playerId));this._isPlayerReady(!0);if(n)switch(e){case"onJavaScriptBridgeCreated":break;case"loadstart":this._context.isLoading(!0);this._loadTimeoutId=this.async.setTimeout(this._onLoadTimeout,1e4);break;case"error":this._context.setVideoStatus({statusMessage:o.strings.errorLoading,error:new u.VideoError({code:"unspecified",type:a.default.flashOther})});break;case"emptied":this._context.canPlay(!0);break;case"durationchange":case"play":case"pause":break;case"loadedmetadata":this._loadTimeoutId&&this.async.clearTimeout(this._loadTimeoutId);this._context.canPlay(!0);break;case"seeking":this._context.isSeeking(!0);break;case"seeked":this._context.isSeeking(!1);this._context.isLoading(!1);break;case"timeupdate":this._loadTimeoutId&&this.async.clearTimeout(this._loadTimeoutId);this._context.position(t.currentTime);this._context.duration(t.duration);break;case"progress":var i=this._context.bufferedRanges,s=this._context.duration();if(s&&i){for(;i().length>t.buffered.length;)i.pop();for(var f=0;t.buffered&&f<t.buffered.length;f++){var l=i()[f],c=t.buffered._start[f],h=100*c/s+"%",p=100*(t.buffered._end[f]-c)/s+"%";if(l){l.left(h);l.width(p)}else i.push({left:r.observable(h),width:r.observable(p)})}}break;case"volumechange":break;case"complete":this._context.position(this._context.duration.peek());this._context.isPlaying(!1)}};i.prototype._onUrlChanged=function(){this._removeFlashPlayer();this._createFlashPlayer()};i.prototype._computeVolume=function(){var e=this._context.volume();if(this._isPlayerReady()&&this._playerElement)try{this._playerElement.setVolume(e)}catch(e){}};i.prototype._computeIsMuted=function(){var e=this._context.isMuted();if(this._isPlayerReady()&&this._playerElement)try{this._playerElement.setMuted(e)}catch(e){}};i.prototype._onSeekPercentageChanged=function(e){var t=this._context.duration();if(this._isPlayerReady()&&this._playerElement&&t&&!this._context.videoStatus().isVisible){try{this._playerElement.seek(e*t)}catch(e){}this._context.isSeeking(!0)}};i.prototype._onIsScrubbingChanged=function(e){this._onSeekPercentageChanged(this._context.seekPercentage())};i.prototype._onIsPlayingChanged=function(e){if(this._isPlayerReady()&&this._playerElement)try{e?this._playerElement.play2():this._playerElement.pause()}catch(e){}};i.prototype._createFlashPlayer=function(){if(this._context.url.peek()){var t,n;if("undefined"==typeof __webpack_public_path__){t="undefined"==typeof __webpack_public_path__?e.toUrl("odsp-media/flash/osmf.swf"):e("file-loader!odsp-media/flash/osmf.swf");n="undefined"==typeof __webpack_public_path__?e.toUrl("odsp-media/flash/strobe.swf"):e("file-loader!odsp-media/flash/strobe.swf")}else{t=e("file-loader!odsp-media/flash/osmf.swf");n=e("file-loader!odsp-media/flash/strobe.swf")}if(!f.isFeatureEnabled(f.UseFlashVideoPlayerFromManifest)){var r=window.FilesConfig.imgBaseUrl||"";if(r){t=r+"flash/v1/osmf.swf";n=r+"flash/v1/strobe.swf"}}var i="",s=this._context;this._playerId="player-"+ ++l;var o=this._playerId;h[o]=this;var u="javascriptCallbackFunction=flashVideoCallback&autoPlay="+!!this._context.shouldAutoPlay+"&loop=false&controlBarMode=none&enableStageVideo=true&controlBarAutoHide=false&playButtonOverlay=false&id="+o+"&useHTML5=false&bufferingOverlay=false&src="+encodeURIComponent(s.url())+"&plugin_AdaptiveStreamingPlugin="+encodeURIComponent(t);i=c.isIE&&c.browserMajor<9?'<object id="'+o+'" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"><param name="movie" value="'+n+'" />':'<object id="'+o+'" name="'+o+'" type="application/x-shockwave-flash" data="'+n+'">';i+='<param name="allowfullscreen" value="false" /><param name="wmode" value="transparent" /><param name="bgcolor" value="000000"/><param name="allowscriptaccess" value="always"/><param name="flashvars" value="'+u+'" /></object>';this.element.innerHTML=i;this._playerElement=document.getElementById(o)}};i.prototype._removeFlashPlayer=function(){if(this._playerId){delete h[this._playerId];delete this._playerId;this._isPlayerReady(!1);var e=this._playerElement;this._playerElement=null;if(e)if(c.isIE){e.style.display="none";4===e.readyState?this._removeFlashPlayerIE(e):this.events.on(e,"readystatechange",this._onIEFlashPlayerReadyStateChange)}else try{e.parentNode&&e.parentNode.removeChild(e)}catch(e){}}};i.prototype._removeFlashPlayerIE=function(e){for(var t in e)"function"==typeof e[t]&&(e[t]=null);e.parentNode&&e.parentNode.removeChild(e)};i.prototype._onIEFlashPlayerReadyStateChange=function(e){var t=e.target;if(4===t.readyState){this._removeFlashPlayerIE(t);this.events.off(t,"readystatechange",this._onIEFlashPlayerReadyStateChange)}};i.prototype._onLoadTimeout=function(){this._context.setVideoStatus({statusMessage:o.strings.errorLoading,error:new u.VideoError({code:"timeout",type:a.default.flashLoadTimeout})})};return i}(i.default);t.default=p;window.flashVideoCallback=function(e,t,n){h[e]&&h[e].handlePlaybackEvent(t,n)}});
define("odsp-next/controls/video/controls/canvas/VideoMonitorBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","@ms/dashling/lib/DashlingMonitor","./DashlingMonitor.css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;n._videoContext=n.valueAccessor();n.createBackgroundComputed(n._computeDashlingMonitor);return n}t.prototype.dispose=function(){e.prototype.dispose.call(this);this._disposeMonitor()};t.prototype._disposeMonitor=function(){if(this._dashlingMonitor){this._dashlingMonitor.dispose();this._dashlingMonitor=null;this.element.innerHTML=""}};t.prototype._computeDashlingMonitor=function(){var e=this._videoContext.dashling();this._disposeMonitor();if(e){this._dashlingMonitor=new i.default;this._dashlingMonitor.attachTo(this.element);this._dashlingMonitor.observe(e,e.videoElement)}};return t}(r.default);t.default=s});
define("@ms/dashling/lib/DashlingMonitor",["require","exports","./DashlingEnums","@uifabric/utilities/lib/EventGroup"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=0,s=function(){function e(){var e=this;this._updateSeekBar=function(){var t=e,n=t._videoElement,r=t.subElements;if(n&&r){var i=100*n.currentTime/n.duration+"%";r.audioSeekBar.style.left=i;r.videoSeekBar.style.left=i}};this.id="DashMonitorView-"+i++;this.isActive=!1;this.isVisible=!0;this._dataContext=null;this._videoElement=null;this._interval=0;this._events=new r.EventGroup(this);this._dashling=null;this.element=null;this.subElements=null;this.reset()}e.prototype.dispose=function(){if(this._interval){clearInterval(this._interval);this._interval=0}this._events&&this._events.dispose();this._videoElement&&(this._videoElement=null);this._dashling&&(this._dashling=null)};e.prototype.attachTo=function(e){var t=u("div");t.innerHTML=this.renderHtml();this.element?e.replaceChild(t.firstChild,this.element):e.appendChild(t.firstChild);this.activate()};e.prototype.observe=function(e,t){this.dispose();if(t){this._videoElement=t;this._events.onAll(t,{timeupdate:this._updateSeekBar,seeking:this._updateSeekBar})}if(e){this._dashling=e;this._events.on(e,"sessionstatechange",this._onSessionChanged);this._onSessionChanged()}};e.prototype.reset=function(){this._dataContext=this._createContext();this.element&&this.attachTo(this.element.parentElement)};e.prototype.setVisibility=function(e){if(e!==this.isVisible){this.isVisible=e;this.isActive&&this._update()}};e.prototype.setDataContext=function(e){this._dataContext=e;this._update()};e.prototype.renderHtml=function(){return'<div id="'+this.id+'" class="c-DashMonitor"><ul class="streamMetrics"></ul><div class="audio streamData"><span class="streamTitle">Audio</span><ul class="streamMetrics"></ul><div class="traffic"><div class="qualities"></div><div class="seekContainer"><div class="seekBar"></div></div></div></div><div class="video streamData"><span class="streamTitle">Video</span><ul class="streamMetrics"></ul><div class="traffic"><div class="qualities"></div><div class="seekContainer"><div class="seekBar"></div></div></div></div><div class="key"><div class="keyItem"><div class="keyBox waiting"></div><span>Waiting for response</span></div><div class="keyItem"><div class="keyBox downloading"></div><span>Receiving bytes</span></div><div class="keyItem"><div class="keyBox downloaded"></div><span>Downloaded</span></div><div class="keyItem"><div class="keyBox appending"></div><span>Appending</span></div><div class="keyItem"><div class="keyBox appended"></div><span>Appended</span></div><div class="keyItem"><div class="keyBox error"></div><span>Error</span></div></div>'};e.prototype.activate=function(){var e=this.element=o("#"+this.id);this.subElements={metrics:o(".streamMetrics",e),audioElement:o(".audio"),audioMetrics:o(".audio .streamMetrics",e),audioQualities:o(".audio .qualities",e),audioSeekBar:o(".audio .seekBar",e),videoElement:o(".video"),videoMetrics:o(".video .streamMetrics",e),videoQualities:o(".video .qualities",e),videoSeekBar:o(".video .seekBar",e),key:o(".key")};this.isActive=!0;this._update()};e.prototype.deactivate=function(){this.subElements=null;this.isActive=!1};e.prototype._onSessionChanged=function(){var e=this,t=e._dashling,r=t.state;if(r===n.DashlingSessionState.error||r===n.DashlingSessionState.idle){clearInterval(e._interval);e._interval=0;e.setDataContext(e._getStats(t))}else t.state>n.DashlingSessionState.idle&&!e._interval&&(e._interval=setInterval(function(){e.isVisible&&e.setDataContext(e._getStats(t))},100))};e.prototype._update=function(){var e=this._dataContext,t=void 0!==e.state&&!!this._dashling&&e.state!==n.DashlingSessionState.idle;if(this.isActive){var r=this.subElements;l(this.element,"isVisible",t&&this.isVisible);this._updateMetrics(r.metrics,e.metrics);var i=e&&e.streams,s=i&&i.audio||{},o=i&&i.video||{};l(r.audioElement,"isVisible",!(!s.metrics&&!s.qualities));l(r.videoElement,"isVisible",!(!o.metrics&&!o.qualities));l(r.key,"isVisible",!(!s.qualities&&!o.qualities));this._updateMetrics(r.audioMetrics,s.metrics);this._updateQualities(r.audioQualities,s.qualities);this._updateMetrics(r.videoMetrics,o.metrics);this._updateQualities(r.videoQualities,o.qualities)}};e.prototype._updateMetrics=function(e,t){l(e,"isVisible",!!t);if(t)for(var n=e._metricLookup=e._metricLookup||{},r=0;r<t.length;r++){var i=t[r],s=n[i.title];if(!s){(s=u("li")).innerHTML='<span class="metricTitle">'+i.title+'</span><span class="metricValue"></span>';o(".metricTitle",s).textContent=i.title;e.appendChild(s);s=n[i.title]=o(".metricValue",s)}s.parentElement.className=i?"hasValue":"";s.textContent=i.value}};e.prototype._updateQualities=function(e,t){l(e,"isVisible",!!t);if(t)for(var n=e._qualityRowLookup=e._qualityRowLookup||{},r=0;r<t.length;r++){var i=t[r];if(i){var s=n[r];if(!s){s=n[r]=u("div","row");u("div","rowHeader",i.title,s);u("div","rowFragments",null,s);s.qualityIndex=i.index;for(var a=e.firstElementChild;a;){if(i.index>Number(a.qualityIndex)){e.insertBefore(s,a);break}a=a.nextElementSibling}s.parentNode||e.appendChild(s)}this._updateFragments(o(".rowFragments",s),i.fragments)}}};e.prototype._updateFragments=function(e,t){l(e,"isVisible",!!t);if(t){for(var n=e._fragmentListLookup=e._fragmentListLookup||{},r={},i=this._dataContext.duration,s=0;s<t.length;s++){var o=t[s],a=n[o.index];if(a)delete n[o.index];else{(a=u("div","rowRequest",null,e)).style.left=100*o.start/i+"%";a.style.width=100*o.length/i+"%"}r[o.index]=a;a.className="rowRequest "+o.state}e._fragmentListLookup=r;for(var f in n)n[f]&&e.removeChild(n[f])}};e.prototype._createContext=function(){return{state:n.DashlingSessionState.idle,metrics:[],streams:{audio:null,video:null},duration:0}};e.prototype._getStats=function(e){var t=this._createContext(),r=e.streamController,i=e.settings.manifest;t.state=e.state;t.metrics.push({title:"State",value:n.DashlingSessionState[e.state]},{title:"Last error",value:e.lastError},{title:"Load",value:(e.timeAtFirstCanPlay||Date.now()-(e.startTime||0))+" ms"});if(i&&r){t.duration=i.mediaDuration;var s=r?r.getTimeUntilUnderrun():0;t.metrics.push({title:"Manifest",value:i&&i.request&&i.request.timeAtLastByte?i.request.timeAtLastByte+" ms":""},{title:"Stalls",value:String(r.stalls)||""},{title:"Recovery time",value:""},{title:"Stall chance",value:""},{title:"Buffer rate",value:a(e.getBufferRate(),2,2)+" s/s"},{title:"Buffer left",value:a(e.getRemainingBuffer(),2,2)+" s"},{title:"Time until stall",value:s<Number.MAX_VALUE?a(s,2,2)+" s":""});for(var o=0,u=r.streams;o<u.length;o++){var l=u[o],c=[],h=[];c.push({title:"Quality",value:String(l.qualityIndex)});var p=l.requestManager.waitTimes.average;c.push({title:"Avg wait",value:p?a(p,2)+" ms":null});p=l.requestManager.receiveTimes.average;c.push({title:"Avg receive",value:p?a(p,2)+" ms":null});p=l.requestManager.bytesPerSeconds.average;c.push({title:"Avg bandwidth",value:p?f(p):null});for(var d=0;d<l.fragments.length;d++){var v=l.fragments[d];if(v.activeRequest){var m=v.qualityIndex,g=h[m];g||(g=h[m]={title:v.qualityId,index:m,fragments:[]});var y=v.state===n.DashlingRequestState.downloading&&-1===v.activeRequest.timeAtFirstByte?"waiting":n.DashlingRequestState[v.state]||"";g.fragments.push({index:d,state:y,start:v.time.startSeconds,length:v.time.lengthSeconds})}}t.streams[l.streamType]={metrics:c,qualities:h}}}return t};return e}();t.default=s;function o(e,t){return(t||document).querySelector(e)}function u(e,t,n,r){var i=document.createElement(e);t&&(i.className=t);n&&(i.textContent=n);r&&r.appendChild(i);return i}function a(e,t,n){var r=String(parseFloat(e.toFixed(t)));if(n){r.indexOf(".")<0&&(r+=".");for(;r.indexOf(".")!==r.length-3;)r+="0"}return r}function f(e){var t=8*e;return t<1e3?t+" bps":t<1e6?a(t/1e3,2,2)+" kbps":a(t/1e6,2,2)+" mbps"}function l(e,t,n){if(e){var r=e.classList;void 0===n?r.toggle(t):n?r.add(t):r.remove(t)}}});
define("odsp-next/controls/video/controls/canvas/DashlingMonitor.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".c-DashMonitor{background:rgba(44,44,44,.7);position:absolute;top:-10px;left:0;right:0;min-height:15px;display:block;opacity:0;color:#AAA}.c-DashMonitor.isVisible{transition:opacity .2s linear,top .25s ease-out;top:0;opacity:1}.c-DashMonitor .key,.c-DashMonitor .streamData{display:none}.c-DashMonitor .isVisible{display:block}.c-DashMonitor .streamMetrics{list-style-type:none;padding:5px 5px 0 5px;margin:0}.c-DashMonitor .streamMetrics li{margin-right:5px;margin-bottom:5px;border:1px solid rgba(255,255,255,.5);background:#313131;overflow:hidden;vertical-align:top;font-size:11px;display:none}.c-DashMonitor .streamMetrics li.hasValue{display:inline-block}.c-DashMonitor .streamTitle{font-size:15px;display:inline-block;width:80px;text-align:right;float:left;margin-right:5px;line-height:30px}.c-DashMonitor .metricTitle{padding:3px 5px;display:inline-block;font-weight:700}.c-DashMonitor .metricValue{display:inline-block;padding:3px 5px;white-space:nowrap;background:#5f5f5f;color:#fff}.c-DashMonitor .row{line-height:15px;height:15px;padding-bottom:1px;position:relative;border-top:1px solid rgba(255,255,255,.1);border-bottom:1px solid rgba(255,255,255,.1);margin-top:-1px;font-weight:700;font-size:9px;background:#222}.c-DashMonitor .traffic{position:relative}.c-DashMonitor .seekContainer{margin-left:3px}.c-DashMonitor .seekBar{position:absolute;top:0;left:0;width:2px;margin-left:-2px;background:rgba(255,255,255,.7);height:100%}.c-DashMonitor .rowHeader{position:absolute;width:80px;text-align:right}.c-DashMonitor .rowFragments,.c-DashMonitor .seekContainer{position:absolute;top:0;left:85px;right:0;bottom:0}.c-DashMonitor .rowRequest{position:absolute;top:2px;bottom:2px;border-radius:4px;box-shadow:inset -4px 0 7px 0 rgba(0,0,0,.6);min-width:5px}.c-DashMonitor .key{box-shadow:inset 0 8px 15px -10px rgba(0,0,0,.2);font-size:11px;padding:10px}.c-DashMonitor .keyItem{display:inline-block;margin-right:10px}.c-DashMonitor .keyBox{display:inline-block;position:relative;top:-1px;width:10px;height:10px;margin:0 5px;border:1px solid #888;vertical-align:middle}.c-DashMonitor .waiting{background:#adadad url(data:image/gif;base64,R0lGODlhBAAEAIAAANLS0paWliH/C05FVFNDQVBFMi4wAwEAAAAh+QQEBQAAACwAAAAABAAEAAACBkwAl2h5BQAh+QQEBQAAACwAAAAABAAEAAACBURiaLBZACH5BAQFAAAALAAAAAAEAAQAAAIGBBKXaHkFACH5BAQFAAAALAAAAAAEAAQAAAIFDGBosVkAOw==)}.c-DashMonitor .downloading{background:#727272 url(data:image/gif;base64,R0lGODlhBAAEAIAAADZn96m++yH/C05FVFNDQVBFMi4wAwEAAAAh+QQEBQAAACwAAAAABAAEAAACBgQSl2h5BQAh+QQEBQAAACwAAAAABAAEAAACBQxgaLFZACH5BAQFAAAALAAAAAAEAAQAAAIGTACXaHkFACH5BAQFAAAALAAAAAAEAAQAAAIFRGJosFkAOw==)}.c-DashMonitor .downloaded{background:#3747ff}.c-DashMonitor .appending{background:#85b98f}.c-DashMonitor .appended{background:#00bd24}.c-DashMonitor .error{background:#df4242}"}])});
define("odsp-next/controls/video/controls/canvas/VideoCanvas.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-VideoCanvas object,.od_videoCanvas video{position:absolute;left:0;top:0;width:100%;height:100%}"}])});
define("odsp-next/controls/video/controls/canvas/VideoCanvas.html",[],function(){return'<div class=od-VideoCanvas>\x3c!--ko if: context.canvasType() === \'html\'--\x3e<div data-bind="htmlVideoContext: context"></div>\x3c!--/ko--\x3e\x3c!--ko if: context.canvasType() === \'flash\'--\x3e<div data-bind="flashVideoContext: context"></div>\x3c!--/ko--\x3e\x3c!--ko if: context.isDiagnosticsEnabled--\x3e<div data-bind="videoMonitor: context"></div>\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/oneUp/video/OneUpVideo.html",[],function(){return'\x3c!--ko if: showThumbnail--\x3e<div class=od-OneUpVideo-thumbnail data-bind="control: thumbnailControl, css: { \'od-OneUpVideo-thumbnail--framed\': showFrame }"></div>\x3c!--ko if: showWatermark--\x3e<img class=od-OneUpVideo-watermark data-bind="attr: { src: watermark, alt: watermarkAlt }">\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--ko if: showVideo--\x3e<div class=od-OneUpVideo data-bind="control: videoPlayer"></div>\x3c!--/ko--\x3e'});
define("odsp-next/controls/oneUp/video/OneUpVideo.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-OneUpVideo-thumbnail--framed{display:block;width:200px;height:200px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";z-index:0;box-shadow:0 2px 6px 2px rgba(1,1,0,.05);position:absolute;left:50%;top:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.od-OneUpVideo-thumbnail--framed:after{content:'';display:block;position:absolute;top:0;left:0;bottom:0;right:0;border:2px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-OneUpVideo-watermark{display:block;width:108px;height:108px;position:absolute;left:50%;top:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}"}])});
define("odsp-next/dataSources/videoItem/odc/VideoItemDataSource",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/browser/PlatformDetection.key","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/auth/DomainAuthenticator","../../../controls/video/VideoPlaybackType","../../../resources/DataSourceResourceKeys","../../../utilities/features/Features","../../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){this._downloadDataSource=t.downloadDataSource;this._graphDataSource=t.graphDataSource;var n=t.platformDetection;this._redirectToHttp=n.isAndroid&&n.browserMajor<4;this.isOneDriveWinApp=f.isOneDriveWinApp()}e.prototype.isStreamingSupported=function(e){return!0};e.prototype.isHlsPlaybackSupported=function(){return!0};e.prototype.getDownloadUrl=function(e){var t,r=this,i=e.item;if(a.isFeatureEnabled(a.ChangeVideoAuth)){var s=i&&i.urls,o=s&&s.download;t=o?n.default.resolve(o.replace(/\?.+/g,"")):this._graphDataSource.getDownloadUrl(i,{useDirectEndpoint:!0})}else t=this._downloadDataSource.getDownloadUrl(i,{downloadType:2});return t.then(function(t){return r._buildVideoUrl(t,e.playbackType)})};e.prototype.getRequestParametersAsync=function(e,t){return this._downloadDataSource.getDownloadRequestParameters(e,{allowHeaders:!1,url:t.replace(/&access_token=[^&]+/g,"")})};e.prototype._buildVideoUrl=function(e,t){this._redirectToHttp&&0===e.toLowerCase().indexOf("https:")&&(e="http"+e.substr(5));e+="?";if(t===o.default.htmlDashling||t===o.default.flashDash){e+="&videoformat=dash&part=index";0}if(t===o.default.htmlDashling){e+="&pretranscode=0";e+="&transcodeahead=0"}else if(t===o.default.flashDash){e+="&pretranscode=0";e+="&.ism/manifest(format=mpd-time-csf)"}else if(t===o.default.htmlHls){e+="&videoformat=hls&part=index";0}else if(!this.isOneDriveWinApp)return s.default.authenticate(e).then(function(){return e});return e};return e}();t.default=l;t.resourceKey=i.createResolvedResourceKey(e("module").id,l,{downloadDataSource:u.download,graphDataSource:u.graph,platformDetection:r.platformDetection})});