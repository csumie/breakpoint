define("odsp-next/roots/odc/OneDriveNext",["require","exports","tslib","@ms/odc-core/lib/Init","../../roots/odc/OneDrivePrefetch","../../utilities/features/Features","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-shared/lib/utilities/navigation/Navigation"],function(e,t,n,r,i,s,o,u){"use strict";var a=this;Object.defineProperty(t,"__esModule",{value:!0});r.default();var f=i.default.resources,l=new u.default;f.expose(o.navigation,l);n.__awaiter(a,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return s.isFeatureEnabled(s.UseItemsScopeInOneDrive)?[4,new Promise(function(t,n){e(["./OneDriveNextWithItemsScopeApp"],t,n)})]:[3,2];case 1:(0,t.sent().initialize)(f);return[3,4];case 2:return[4,new Promise(function(t,n){e(["./OneDriveNextApp"],t,n)})];case 3:(0,t.sent().initialize)(f);t.label=4;case 4:return[2]}})})});
define("@ms/odc-core/lib/Init",["require","exports","@ms/odsp-utilities/lib/logging/Manager","@ms/odsp-utilities/lib/logging/PageInit","@ms/odsp-utilities/lib/aria/AriaLogger","./AriaContext","./Tenants","@ms/odsp-utilities/lib/logging/ManagerExtended","@ms/odsp-utilities/lib/logging/UnhandledErrorHandler","@ms/odsp-utilities/lib/logging/RequireJSErrorHandler","@ms/odsp-utilities/lib/logging/PromiseErrorHandler","@ms/odsp-utilities/lib/logging/ErrorUI","@ms/odsp-utilities/lib/logging/QOEHelper"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=2048,a=/authkey=[!a-zA-Z0-9%]*/gi,f=/authkey/gi;0;function l(e,t){if(!f.test(t)){if(e){(e+="").length>u&&(e=e.substring(0,u));e=e.replace(a,"")}return e}}n.Manager.cleanString=l;Object.getPrototypeOf(n.Manager).cleanString=l;r.default.init();var c=s.getAriaInfo(),h=c.ariaEnvironment,p=c.ariaContext;i.default.Init("prod"===h?o.ODCTenantTokens.prod:o.ODCTenantTokens.ppe,p);t.default=function(){}});
define("@ms/odsp-utilities/lib/logging/PageInit",["require","exports","./events/PageInit.event","./ManagerExtended"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,i=function(){function e(){}e.init=function(){r||(r=n.PageInit.logData({screenWidth:window.screen.width,screenHeight:window.screen.availHeight,availableScreenWidth:window.screen.availWidth,availableScreenHeight:window.screen.availHeight,renderWidth:window.innerWidth,renderHeight:window.innerHeight,browserWidth:window.outerWidth,browserHeight:window.outerHeight,devicePixelRatio:window.devicePixelRatio?window.devicePixelRatio:0}));return r};return e}();t.default=i});
define("@ms/odsp-utilities/lib/logging/events/PageInit.event",["require","exports","../SingleEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PageInit=n.createSingleEvent({eventName:"PageInit,",shortEventName:"PageInit",requiresParent:!1},{screenWidth:2,screenHeight:2,availableScreenWidth:2,availableScreenHeight:2,renderWidth:2,renderHeight:2,browserWidth:2,browserHeight:2,devicePixelRatio:2,referrer:1});t.default=t.PageInit});
define("@ms/odsp-utilities/lib/logging/ManagerExtended",["require","exports","@ms/telemetry-manager/lib/Manager","../features/Features","@ms/telemetry-manager/lib/ManagerExtended"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.Manager.addFeatureEnabler(function(e){return r.default.isFeatureEnabled(e)})});
define("@ms/telemetry-manager/lib/ManagerExtended",["require","exports","./Manager","./EventBase","./events/ValidationError.event"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.Manager.addValidationErrorLogger(function(e,t){var s=r.ValidationErrorType[t];i.ValidationError.enabled()&&i.ValidationError.logData({message:"Validation error for "+e.shortEventName+" of type "+s,validatedEventName:e.shortEventName,validatedFullEventName:e.eventName,validationType:s,stack:n.Manager.getStack()||""},e)})});
define("@ms/telemetry-manager/lib/events/ValidationError.event",["require","exports","../SingleEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ValidationError=n.createSingleEvent({eventName:"ValidationError,",shortEventName:"ValidationError",samplingFeature:{ODB:-1,ODC:"ValidationErrorSampling",Fallback:!1},critical:!0,requiresParent:!1},{message:1,validationType:1,validatedEventName:1,validatedFullEventName:1,stack:1})});
define("@ms/odsp-utilities/lib/aria/AriaLogger",["require","exports","../features/Features","./AriaLoggerCore"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function i(){return new Promise(function(e,t){window.require(["aria"],e,t)})}var s=function(){function e(){}e.Init=function(e,t,s){void 0===s&&(s=i);(t.forceEnabled||n.default.isFeatureEnabled(this.EnableAriaLogging))&&s().then(function(n){r.default.Init(e,t,n)},function(e){})};Object.defineProperty(e,"logStartEvents",{get:function(){return r.default.logStartEvents},set:function(e){r.default.logStartEvents=e},enumerable:!0,configurable:!0});e.getAriaTimeZone=function(e){var t=Math.abs(e),n=t%60,r=Math.floor(t/60);return(e>0?"-":"+")+(r>=10?r:"0"+r)+":"+(n>=10?n:"0"+n)};e.EnableAriaLogging={ODB:588,ODC:"EnableAriaLogging",Fallback:!1};return e}();t.default=s});
define("@ms/odsp-utilities/lib/aria/AriaLoggerCore",["require","exports","../logging/EventBase","../logging/Manager","../logging/events/Beacon.event","../logging/ErrorHelper","../browser/PlatformDetection","../logging/DataCompletenessInfo","../uri/SimpleUri","@ms/telemetry-addon-aria/lib/AriaTelemetryHandler","../async/Promise"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c,h="AriaBeacon",p=!1,d={logStartEvents:!1,Init:function(e,t,v,m){void 0===m&&(m={});var g,y=m.platformDetection,b=void 0===y?new o.default:y;try{c=v;d.logStartEvents=!0;var w={AccountType:n.AccountType[t.accountType],BrowserIsMobile:b.isMobile,BrowserMajVer:b.browserMajor,BrowserMinVer:b.browserMinor,BrowserName:b.browserName,BrowserUserAgent:b.userAgent,Environment:t.environment,FarmLabel:t.farmLabel,IsAuthenticated:t.isAuthenticated?1:0,Market:t.market,Manifest:t.manifest,OSName:b.osName,OSVersion:b.osVersion,Session:t.session,SiteSubscriptionId:t.siteSubscriptionId||"",UserId:t.userId,Version:t.version,Workload:t.workload,SiteId:t.siteId,WebId:t.webId,WebTemplateId:t.webTemplateId};t.farmLabel&&(w.FarmLabel=t.farmLabel);var E=new a.SimpleUri(t.completenessCallbackEndpoint),S={telemetryTenantToken:e,appVersion:t.version,environment:t.environment,workload:t.workload,farmLabel:t.farmLabel,callbackEndpoint:E},x=new f.AriaTelemetryHandler({ariaLoader:function(){return l.default.resolve(c)},context:w,tenantToken:e,disableCookies:t.disableCookies,logStartEvents:d.logStartEvents,ariaQos:{isQosEvent:function(e){return i.Beacon.isTypeOf(e)&&!!e.data&&e.data.name===h},reportQos:function(e){var t=e.result,n=e.statusCode,r=e.events;new i.Beacon({name:h,retryCount:0,totalRetries:0,eventCount:r?r.length:0}).end({success:0===t,status:n+""});0;""!==E.authority&&new u.DataCompletenessInfo(S,t,n,(new Date).getTime(),r).send()}}}).attach(r.Manager);p=!0;g=function(){x();p=!1}}catch(e){e instanceof c.Exception&&(e=new Error("Aria error: "+e.toString()));s.default.log(e)}return g},isInitialized:function(e){return p}};t.default=d});
define("@ms/odsp-utilities/lib/logging/events/Beacon.event",["require","exports","../PairedEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Beacon=n.createPairedEvent({eventName:"Beacon,",shortEventName:"Beacon",requiresParent:!1},{name:1,status:1,success:3,retryCount:2,totalRetries:2,eventCount:2});t.default=t.Beacon});
define("@ms/odsp-utilities/lib/logging/DataCompletenessInfo",["require","exports","../xhr/XHR","./ErrorHelper"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,n,r,i){this._endpointUrl=e.callbackEndpoint.authority+e.callbackEndpoint.path;var s={};if(i)for(var o=0;o<i.length;++o)s[i[o].EventType]=s[i[o].EventType]+1||1;var u={TelemetryTenantId:e.telemetryTenantToken.substring(0,32),AppVersion:e.appVersion,EventType:t,StatusCode:n,EventCount:i?i.length:0,Timestamp:r,Environment:e.environment||"",DatapointSchemaVersion:"1.0",TelemetrySource:"Aria",EventSummary:s,Workload:e.workload||"",FarmLabel:e.farmLabel||""};this._dataCompletenessJson=JSON.stringify(u)}Object.defineProperty(e.prototype,"endpointUrl",{get:function(){return this._endpointUrl},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"dataCompletenessJson",{get:function(){return this._dataCompletenessJson},enumerable:!0,configurable:!0});e.prototype.send=function(){new n.default({method:"POST",url:this._endpointUrl,json:this._dataCompletenessJson,requestTimeoutInMS:1e3}).start(function(e,t){},function(e,t,n){0})};return e}();t.DataCompletenessInfo=i});
define("@ms/odsp-utilities/lib/xhr/XHR",["require","exports","../async/Async","../logging/ErrorHelper","../object/ObjectUtil"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.blocked=0]="blocked";e[e.exception=-1]="exception";e[e.timeout=-2]="timeout";e[e.abort=-3]="abort"}(t.XHRStatus||(t.XHRStatus={}));var s=function(){function e(t){this._async=new n.default(this);var r=t.url,i=t.requestTimeoutInMS,s=void 0===i?e.DEFAULT_TIMEOUT_MS:i,o=t.json,u=t.responseType,a=void 0===u?"":u,f=t.headers,l=void 0===f?{}:f,c=t.withCredentials,h=void 0!==c&&c,p=t.needsCors,d=void 0!==p&&p,v=t.onProgress,m=t.onUploadProgress,g=t.method,y=void 0===g?o?"POST":"GET":g;this._url=r;this._requestTimeoutInMS=s;this._postData=o;this._headers=l;this._method=y;this._withCredentials=h;this._needsCors=d;this._responseType=a;this._progressCallback=v;this._uploadProgressCallback=m}e.prototype.abort=function(e){this._abortRequest()&&!e&&this._callFailureCallback(this._request,-3,!1)};e.prototype.start=function(e,t){var n=this;this._successCallback=e;this._failureCallback=t;var s=this._method,o=this._headers;try{this._request=this._getRequest();var u=this._progressCallback,a=this._uploadProgressCallback,f=this._request,l=this._responseType;u&&(f.onprogress=function(e){try{u(e)}catch(e){r.default.logError(e)}});a&&(f.upload.onprogress=function(e){try{a(e)}catch(e){r.default.logError(e)}});this._async.setTimeout(function(){n._completed||n._timeoutCallback()},this._requestTimeoutInMS);f.onreadystatechange=function(){if(!n._completed){var e=4;try{e=f.DONE||4}catch(e){}f.readyState===e&&n._requestEndCallback()}};f.open(s,this._url,!0);"withCredentials"in f&&(f.withCredentials=this._withCredentials);f.responseType=l;for(var c in o)f.setRequestHeader(c,o[c]);f.send(this._postData)}catch(e){r.default.logError(e,{origin:location?location.origin:"unknown",withCredentials:this._withCredentials,requestUrl:this._url,headers:i.safeSerialize(o),method:s});this._abortRequest();this._callFailureCallback(this._request,-1,!1)}};e.prototype._getRequest=function(){var e=this;if(!this._needsCors||!window.XDomainRequest)return new XMLHttpRequest;var t=new XDomainRequest;t.setRequestHeader=function(){};t.onprogress=function(){};t.ontimeout=function(){};t.onload=function(){e._requestEndCallback()};return t};e.prototype._abortRequest=function(){var e=!1;if(!this._completed){this._completed=!0;this._async.dispose();try{this._request&&this._request.abort()}catch(e){}e=!0}return e};e.prototype._timeoutCallback=function(){if(!this._completed){this._abortRequest();this._callFailureCallback(this._request,-2,!0)}};e.prototype._callSuccessCallback=function(e,t){try{this._successCallback&&this._successCallback(e,t)}catch(e){r.default.log(e)}};e.prototype._callFailureCallback=function(e,t,n){try{this._failureCallback&&this._failureCallback(e,t,n)}catch(e){r.default.log(e)}};e.prototype._requestEndCallback=function(){if(!this._completed){this._completed=!0;var e=-1;try{this._async.dispose();try{e=this._request.status}catch(e){}}catch(t){e=-1;r.default.log(t)}e<400&&e>0?this._callSuccessCallback(this._request,e):this._callFailureCallback(this._request,e,!1)}};e.DEFAULT_TIMEOUT_MS=3e4;return e}();t.default=s});
define("@ms/odsp-utilities/lib/uri/SimpleUri",["require","exports","@ms/sp-resource-path"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SimpleUri=n.SPResourcePath;t.UriFormat=n.SPResourcePathFormat;t.default=n.SPResourcePath});
define("@ms/sp-resource-path",["./sp-resource-path/lib/index"],function(e){return e});
define("@ms/sp-resource-path/lib/index",["require","exports","./SPResourcePath"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SPResourcePath=n.SPResourcePath;t.SPResourcePathFormat=n.SPResourcePathFormat});
define("@ms/sp-resource-path/lib/SPResourcePath",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.absolute=0]="absolute";e[e.relative=1]="relative";e[e.serverRelative=2]="serverRelative"}(n=t.SPResourcePathFormat||(t.SPResourcePathFormat={}));var r=function(e){void 0===e&&(e="");var t=e.indexOf("//"),r=e.indexOf("/"),i=t>-1&&t<=r?t+"//".length:-1,s=function(e,t){if(t>-1){var n=e.indexOf("/",t);return n>-1?e.slice(0,n):e}return""}(e,i),o=s&&s.slice(i),u=e.slice(s.length),a=s?n.absolute:"/"===u[0]?n.serverRelative:n.relative,f=u.split("/");this.authority=s;this.domain=o;this.format=a;this.path=u;this.segments=f;this.value=e};t.SPResourcePath=r});
define("@ms/telemetry-addon-aria/lib/AriaTelemetryHandler",["require","exports","tslib","@ms/telemetry-manager/lib/EventBase","./AriaEventBuilder","@ms/telemetry-manager/lib/ErrorHelper","@ms/utilities-strings/lib/index"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e){var t=e.logStartEvents,n=void 0===t||t,r=e.context,i=void 0===r?{}:r;this._ariaLoader=e.ariaLoader;this._logStartEvents=n;this._disableCookies=e.disableCookies;this._tenantToken=e.tenantToken;this._ariaQosParams=e.ariaQos;this._ariaOfflineCacheParams=e.offlineCache;this._context=i;this._logConfiguration=e.ariaLogConfiguration}e.prototype.attach=function(e){var t,n=this,r=!1;this._getAria().then(function(i){if(!r){t=n._createLogHandler(i);e.addLogHandler(t).forEach(t)}});return function(){r=!0;t&&e.removeLogHandler(t)}};e.prototype._getAria=function(){var e=this,t=this._ariaLoader().then(function(t){e._initializeLogManager(t);return t});this._getAria=function(){return t};return t};e.prototype._createLogHandler=function(e){var t=this,n=this._createLogger(e),o=this._ariaQosParams;return function(u){try{if(u.enabled&&(u.eventType!==r.ClonedEventType.Start||t._logStartEvents)&&(!o||!o.isQosEvent(u))){var a=i.buildAriaEvent(e,u);n.logEvent(a)}}catch(t){var f=void 0;t instanceof e.Exception&&(f=new Error("Aria error: "+t.toString()));t&&t.handled||s.log(f||t)}}};e.prototype._initializeLogManager=function(e){var t=this,r=this._ariaOfflineCacheParams;if(!e.LogManager.isInitialized()){e.LogManager.initialize(this._tenantToken,n.__assign({disableCookies:this._disableCookies},r?{browserOverrides:{onGetData:r.getData,onSaveData:r.saveData}}:{},this._logConfiguration||{}));"undefined"!=typeof window&&"function"==typeof window.addEventListener&&window.addEventListener("beforeunload",function(t){e.LogManager.flush()})}var i=this._ariaQosParams;i&&e.LogManager.addCallbackListener(function(e,n,r,s){r===t._tenantToken&&i.reportQos({result:e,statusCode:n,events:s})})};e.prototype._createLogger=function(e){var t=new e.Logger(this._tenantToken),r=this._context,i=r.Session,s=r.Version,u=r.OSName,a=r.OSVersion,f=r.Market,l=r.UserId,c=r.Manifest,h=n.__rest(r,["Session","Version","OSName","OSVersion","Market","UserId","Manifest"]),p=t.getSemanticContext();i&&t.setContext("AppInfo.Session",i);c&&t.setContext("AppInfo.Manifest",c);s&&p.setAppVersion(s);p.setUserLanguage(f||"");l&&p.setUserId(l);u&&p.setDeviceOsName(u);a&&p.setDeviceOsVersion(a);for(var d in h)if(Object.prototype.hasOwnProperty.call(h,d)){var v=h[d];if(null==v)continue;var m=o.capitalize(d);t.setContext(m,h[d])}return t};return e}();t.AriaTelemetryHandler=u});
define("@ms/telemetry-addon-aria/lib/AriaEventBuilder",["require","exports","@ms/telemetry-manager/lib/EventBase","@ms/utilities-strings/lib/index","@ms/telemetry-manager/lib/ErrorHelper"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e){var t={CorrelationVector:e.vector.toString(),ValidationErrors:e.validationErrors,WebLog_FullName:e.eventName,WebLog_EventType:n.ClonedEventType[e.eventType]};e.eventType===n.ClonedEventType.End&&(t.Duration=e.endTime-e.startTime);for(var i=e.eventName.split(","),s=0,o=i;s<o.length;s++){var u=o[s];u&&(t["WebLog_Type_"+u]=1)}var a=e.data,f=e.context;if(f)for(var l in f)if(Object.prototype.hasOwnProperty.call(f,l)){if(null==(h=f[l]))continue;t[d=r.capitalize(l)]=h}if(a)for(var c in a)if(Object.prototype.hasOwnProperty.call(a,c)){var h;if(null==(h=a[c]))continue;var p=e.metadata[c];if(p){var d=p.isPrefixingDisabled?r.capitalize(c):r.capitalize(p.definedInName)+"_"+c,v=p.type;if(4===v){for(var m in h)if(Object.prototype.hasOwnProperty.call(h,m)){var g=h[m];null!=g&&""!==g&&(t[d+"_"+m.replace(".","_")]=g)}}else t[d]=6===v?p.typeRef[h]:h}}return{name:e.isEventTypePrefixingDisabled?i[i.length-2]:"ev_"+i[i.length-2],values:t}}t.getAriaEventInfo=s;t.buildAriaEvent=function(e,t){var n=s(t),r=n.name,o=n.values,u=new e.EventProperties;u.name=r;!function(e,t,n){var r;try{for(var s in n)if(Object.prototype.hasOwnProperty.call(n,s)){r=s;t.setProperty(s,n[s])}}catch(t){var o=void 0,u=void 0;if(t instanceof e.Exception){o=t.ErrorCode();u=new Error("Aria error: "+t.toString())}if(u){t.handled=!0;i.logError(u,{errorCode:o,propertyKey:r})}throw t}}(e,u,o);return u}});
define("@ms/odc-core/lib/AriaContext",["require","exports","@ms/odsp-utilities/lib/logging/EventBase","./PageConfig"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=!!window.Flight.UserGroup&&window.Flight.UserGroup.toLowerCase(),s="dev"!==window.Flight.version&&("df"===i||"prod"===i),o=window.Flight.version,u=window.Flight.manifest,a="ODC_"+window.Flight.UserGroup,f=s?"prod":"ppe",l={isAuthenticated:r.default.isAuthenticated(),market:r.default.getMarket(),session:window.Flight.session,version:o,manifest:u,userId:r.default.isAuthenticated()&&"0"!==window.Flight.cid?window.Flight.cid:window.Flight.xid,accountType:r.default.isAuthenticated()?n.AccountType.Consumer:n.AccountType.ConsumerAnonymous,environment:a,workload:"ODC",disableCookies:!r.default.isAuthenticated()};t.getAriaInfo=function(){return{version:o,manifest:u,appEnvironment:a,ariaEnvironment:f,ariaContext:l}}});
define("@ms/odc-core/lib/PageConfig",["require","exports","cookies"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.getAnid=function(){var t=n.get(e.ANON_ID_COOKIE_KEY),r="";if(t)for(var i=t.split("&"),s=0;s<i.length;s++){var o=i[s];0===o.indexOf("A=")&&o.length>2&&(r=o.substr(2,o.length))}return r};e.getMarket=function(){return $Config.mkt};e.getLanguage=function(){return $Config.lang};e.isNewUser=function(){return 0===FilesConfig.freRenderIndex};e.isAuthenticated=function(){return $Config.isAuthenticated||window.FilesConfig&&!FilesConfig.si};e.ANON_ID_COOKIE_KEY="ANON";return e}();t.default=r});
define("@ms/odc-core/lib/Tenants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ODCTenantTokens={ppe:"3d697adc11914fa4991f1c3870255788-1afd84c4-bb01-494a-bfb0-0216ab2771c6-6977",prod:"a23e4f242c9c4097a968f28c62633e19-62d0d830-5afd-4df3-8e40-351c8711cf5c-7157"}});
define("@ms/odsp-utilities/lib/logging/UnhandledErrorHandler",["require","exports","./events/UnhandledError.event"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=10,i=50;t.MAXERRORS=100;var s=0;function o(e){var t;if(e){var n=e&&e.toString?e.toString():"InvalidMethod()",r=8===n.indexOf(" ")?9:0,s=n.indexOf(")")+1;if(0===(t=n.substring(r,s)).indexOf("function")||t.indexOf("(")<3){var o=s+i;t=function(e,t){e&&e.length>t&&(e=e.substr(0,t-3)+"...");return e}(n=n.replace(/\s\s*/g," "),o)+(o<n.length?"}":"")}}return t}function u(e,i,a,f,l){try{window.parent&&window.parent.opener&&"LogOnError"in window.parent.opener&&Function.prototype.apply.call(window.parent.opener.LogOnError,window.parent.opener,[e,i,a,f,l])}catch(e){}var c=l&&l.stack,h=function e(){var t,n=[];try{t=arguments.callee;for(;t===u||t===e;)t=t?t.caller:t}catch(e){t=null}var i=0;try{for(;t&&i<r;){n.push(o(t));t=t.caller;i++}}catch(e){}return n}().join("\n"),p={message:e,url:i,line:a,col:f,stack:c=c?c.replace(/[ \t]{2,}/g," "):"",builtStack:h=h.replace(/[ \t]{2,}/g," ")};s<t.MAXERRORS?n.UnhandledError.logData(p):s===t.MAXERRORS&&n.UnhandledError.logData({message:"Hit max error limit of "+t.MAXERRORS,url:"NA",line:0,col:0,stack:"",builtStack:""});s++}t.handleOnError=u;window.onerror=u});
define("@ms/odsp-utilities/lib/logging/events/UnhandledError.event",["require","exports","../SingleEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UnhandledError=n.createSingleEvent({eventName:"UnhandledError,",shortEventName:"UnhandledError",critical:!0,requiresParent:!1},{message:1,stack:1,builtStack:1,line:2,col:2,url:1});t.default=t.UnhandledError});
define("@ms/odsp-utilities/lib/logging/PromiseErrorHandler",["require","exports","./ErrorHelper","../async/Async","../async/Promise","../events/EventGroup","../object/ObjectUtil","../logging/events/UnhandledPromise.event"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=new(function(){function e(){this._outstandingPromiseErrors={};this._async=new r.default}e.prototype.log=function(e){var t=this,r=e.id;if(e.parent)e.handler&&delete this._outstandingPromiseErrors[r];else{this._outstandingPromiseErrors[r]=e;1===Object.keys(this._outstandingPromiseErrors).length&&this._async.setTimeout(function(){var e=t._outstandingPromiseErrors;t._outstandingPromiseErrors={};Object.keys(e).forEach(function(t){var r=e[t],s=r.exception?r.exception:r.error;s instanceof Error||s&&s.stack?i.default.isCanceled(r)||n.default.log(s):u.UnhandledPromise.logData({message:"Promise with no error callback",extraData:o.safeSerialize(s)});if(window.console&&console.log){var a="Promise with no error callback:"+r.id;console.warn?console.warn(a):console.log(a);console.log(r);s&&s.stack&&console.log(s.stack)}})},0)}};return e}());new s.default(a).on(i.default,"error",a.log)});
define("@ms/odsp-utilities/lib/logging/events/UnhandledPromise.event",["require","exports","../SingleEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UnhandledPromise=n.createSingleEvent({eventName:"UnhandledPromise,",shortEventName:"UnhandledPromise",samplingFeature:{ODB:!0,ODC:"UnhandledPromiseLogging",Fallback:!1},requiresParent:!1},{message:1,extraData:1});t.default=t.UnhandledPromise});
define("@ms/odsp-utilities/lib/logging/ErrorUI",["require","exports","./Manager","./events/UnhandledError.event","./events/CaughtError.event","./events/QosError.event","./events/RequireJSError.event","./events/ValidationError.event","./EventBase"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});0});
define("@ms/odsp-utilities/lib/logging/events/CaughtError.event",["require","exports","tslib","@ms/telemetry-manager/lib/events/CaughtError.event","@ms/telemetry-manager/lib/events/CaughtError.event"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.CaughtError});
define("@ms/odsp-utilities/lib/logging/events/QosError.event",["require","exports","tslib","@ms/telemetry-manager/lib/events/QosError.event","@ms/telemetry-manager/lib/events/QosError.event"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.QosError});
define("@ms/odsp-utilities/lib/logging/events/ValidationError.event",["require","exports","tslib","@ms/telemetry-manager/lib/events/ValidationError.event","@ms/telemetry-manager/lib/events/ValidationError.event"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.ValidationError});
define("@ms/odsp-utilities/lib/logging/QOEHelper",["require","exports","./events/Qoe.event","./Manager","./events/Qos.event","./events/CaughtError.event","./events/RequireJSError.event","./events/UnhandledError.event","./events/PLT.event","./ErrorHelper"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l;!function(e){e[e.AppLoad=0]="AppLoad";e[e.PLT=1]="PLT";e[e.SessionError=2]="SessionError"}(l=t.Stages||(t.Stages={}));var c=!1,h=!1,p=-1;function d(){p===l.SessionError-1&&y.markStage(l.SessionError)}function v(e){if(i.Qos.isTypeOf(e)){if(e.data.resultType===i.ResultTypeEnum.Failure){h=!0;d();c=!0}}else if(s.default.isTypeOf(e)||o.default.isTypeOf(e)||u.default.isTypeOf(e)){h=!0;d();c=!0}else if(a.default.isTypeOf(e)){y.markStage(l.PLT);c&&d()}}for(var m=0,g=r.Manager.addLogHandler(v);m<g.length;m++){v(g[m])}var y=function(){function e(){}e.markStage=function(e){if(e-1===p||e===l.AppLoad){n.default.logData({stage:l[e],errorBeforeStage:c,errorDuringStage:h});h=!1;p=e}else try{throw new Error("Stage "+l[e]+" - "+e+" came out of order - previous stage "+l[p]+" - "+p)}catch(e){f.default.log(e)}};e.reset=function(){p=-1;c=!1;h=!1};return e}();t.default=y;y.markStage(l.AppLoad)});
define("@ms/odsp-utilities/lib/logging/events/Qoe.event",["require","exports","../SingleEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Qoe=n.createSingleEvent({eventName:"Qoe,",shortEventName:"Qoe",requiresParent:!1},{stage:{isKey:!0,type:1},errorBeforeStage:3,errorDuringStage:3});t.default=t.Qoe});
define("@ms/odsp-shared/lib/utilities/navigation/Navigation",["require","exports","tslib","@ms/odsp-utilities/lib/beforeUnload/BeforeUnload","@ms/odsp-utilities/lib/events/EventGroup","@ms/odsp-utilities/lib/logging/events/Nav.event","./NavigationHelper","@ms/odsp-utilities/lib/scope/Scope"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=window.history,f=window.applicationCache,l=a&&!!a.pushState&&(!f||f.status===f.UNCACHED),c=function(){function e(e){void 0===e&&(e={});this._viewParamsString="";this._dontBlockNextNav=!1;var t=e.disableHashConversion,n=void 0!==t&&t;this._performHashConversion=!n;this.viewParams={};this._scope=new u.default;this.beforeUnload=new r.default;this._scope.attach(this.beforeUnload);this._events=new i.default(this);this._events.declare("change");this._events.on(window,"hashchange",this._updateUrlState);this._events.on(window,"popstate",this._updateUrlState);this._updateUrlState(null)}e.prototype.dispose=function(){this._scope.dispose()};e.prototype.navigateTo=function(e){var t=this;if(this.beforeUnload.allowHashNav(function(){return t.navigateTo(e)},null)){var n="string"==typeof e?{url:e}:e,r=n.url,i=e.hasOwnProperty("viewParams")?e.viewParams:null,s=e.hasOwnProperty("directOpen")?e.directOpen:null,o=void 0,u=void 0;if(i&&"#"===i[0]){o=i.substr(1);u=r}else{o="#"===r[0]?r.substr(1):null;u=null}if(o)n.ignoreHistory?this._replaceState(o,!1,u):this._pushState(o,u);else{var a=void 0,f=!1;if(n&&n.frameId&&"_self"!==n.frameId)try{a=window.open(s?r:"",n.frameId);"_blank"===n.frameId&&(a.opener=null);s||(a.location.href=r);f=!0}catch(e){}if(!a&&!f)try{window.location.href=r}catch(e){}}}};e.prototype.updateViewParams=function(e,t){void 0===t&&(t={});var r="string"==typeof e?o.deserializeQuery(e):e,i=n.__assign({},t.clearOtherParams?{}:this.viewParams,r);t.ignoreHistory?this._replaceState(i,t.clearPath):this._pushState(i)};e.prototype.reload=function(){window.location.reload()};e.prototype._updateUrlState=function(e){var t=this,n=!1,r=window.document.location,i=!1;if(this._dontBlockNextNav||this.beforeUnload.allowHashNav(function(){return t._updateUrlState(e)},function(){return t._resetBeforeNavBlock()})){this._dontBlockNextNav=!1;var u="";if(r.href.indexOf("#")>-1){u=r.hash.substr(1);i=!0}else r.search.length&&(u=r.search.substr(1));var a=this._tryGetViewParamsBasedOnState(e),f=o.deserializeQuery(u),c=o.deserializeQuery(a),h=c,p=a;for(var d in f)if(c[d]!==f[d]){h=f;p=u;break}if(p!==this._viewParamsString){this._viewParamsString=p||"";this.viewParams=h;n=!0}i&&this._performHashConversion&&l&&this._replaceState(p);if(n){s.Nav.logData({url:r.href,viewParams:this.viewParams});this._events.raise("change")}this._prevHash=r.hash}else{n=!1;e&&e.preventDefault()}return n};e.prototype._tryGetViewParamsBasedOnState=function(e){var t=null;if(e&&"popstate"===e.type&&e.state){var n=e.state,r=n.useViewParamsFromState,i=n.viewParams;r&&i&&(t=this._getViewParamsString(i))}return t};e.prototype._resetBeforeNavBlock=function(){this._dontBlockNextNav=!0;if(l)try{history.forward()}catch(e){this._hashNav(this._prevHash)}else this._hashNav(this._prevHash)};e.prototype._pushState=function(e,t){var n=this._getViewParamsString(e);if(l)try{history.pushState({},null,this._getStateUrl(n))}catch(e){this._hashNav(n)}else this._hashNav(n);this._updateUrlState(null);t&&this._setMaskUrl(t)};e.prototype._replaceState=function(e,t,n){var r=this._getViewParamsString(e);if(l)try{history.replaceState({},null,this._getStateUrl(r,t))}catch(e){this._hashNav(r)}else this._hashNav(r);this._updateUrlState(null);n&&this._setMaskUrl(n)};e.prototype._setMaskUrl=function(e){if(e&&l){var t={useViewParamsFromState:!0,viewParams:this.viewParams};history.replaceState(t,null,e)}};e.prototype._getViewParamsString=function(e){return"string"==typeof e?e:o.serializeQuery(e)};e.prototype._getStateUrl=function(e,t){return(t?"/":document.location.pathname)+(e.length>0?"?":"")+e};e.prototype._hashNav=function(e){document.location.hash=e};return e}();t.Navigation=c;t.default=c});
define("@ms/odsp-utilities/lib/beforeUnload/BeforeUnload",["require","exports","../logging/ErrorHelper","../async/Async"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){this._localHandlers=[]}e.init=function(){var e=this;if(!this._initialized){this._initialized=!0;this._originalBeforeUnload=window.onbeforeunload;window.onbeforeunload=window.__onbeforeunload=function(t){return e._handleBeforeUnload(t)}}};e.registerHandler=function(e){this._handlers.push(e)};e.unRegisterHandler=function(e){for(var t=0;t<this._handlers.length;t++)if(this._handlers[t]===e){this._handlers.splice(t,1);break}};e.dispose=function(){this._originalBeforeUnload?window.onbeforeunload=this._originalBeforeUnload:window.onbeforeunload=null};e._handleBeforeUnload=function(e){var t=void 0;if(!this._allowNavs){for(var r=0;r<this._handlers.length;r++)try{if(t=this._handlers[r](!0))break}catch(e){n.default.log(e)}if(!t&&this._originalBeforeUnload)try{t=this._originalBeforeUnload(e)}catch(e){n.default.log(e)}}return t||void 0};e.prototype.registerHashNavDialogCallback=function(e){this._hashNavDialogCallback=e};e.prototype.allowHashNav=function(t,r){var i=void 0;if(!e._isDialogOpen&&!e._allowNavs){for(var s=0;s<e._handlers.length;s++)try{if(i=e._handlers[s](!1))break}catch(e){n.default.log(e)}if(i){e._isDialogOpen=!0;this._hashNavDialogCallback(i).then(function(){e._isDialogOpen=!1;e._allowNavs=!0;e._blockNavsAgainId||(e._blockNavsAgainId=e._async.setImmediate(function(){e._allowNavs=!1;e._blockNavsAgainId=null}));t&&t()},function(){e._isDialogOpen=!1;r&&r()})}}return!i&&!e._isDialogOpen};e.prototype.registerHandler=function(t){this._localHandlers.push(t);e.registerHandler(t)};e.prototype.unRegisterHandler=function(t){for(var n=0;n<this._localHandlers.length;n++)if(this._localHandlers[n]===t){this._localHandlers.splice(n,1);break}e.unRegisterHandler(t)};e.prototype.dispose=function(){for(var t=0,n=this._localHandlers;t<n.length;t++){var r=n[t];e.unRegisterHandler(r)}};e._handlers=[];e._async=new r.default;e._initialized=!1;return e}();t.default=i;i.init()});
define("@ms/odsp-utilities/lib/logging/events/Nav.event",["require","exports","../SingleEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Nav=n.createSingleEvent({eventName:"Nav,",shortEventName:"Nav"},{viewParams:4,url:1});t.default=t.Nav});
define("odsp-next/bindings/css/VisibilityBinding",["require","exports","knockout"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.update=function(e,t){var r=n.unwrap(t());e.style.visibility=r?"inherit":"hidden"};return e}();t.default=r});
define("odsp-next/roots/odc/OneDriveNextApp",["require","exports","@ms/odsp-utilities/lib/auth/DomainAuthenticator","knockout","@ms/odsp-utilities/lib/resources/Resources","../../resources/ModelResourceKeys","../../resources/DataSourceResourceKeys","../../resources/ODCResourceKeys","../../resources/LoggingResourceKeys","../../resources/ProviderResourceKeys","../../models/store/UserSettingsStore","../../models/store/UserInfoStore","../../dataSources/settings/odc/SettingsDataSource","../../dataSources/item/odc/ItemDataSource","../../dataSources/ransomwareDetection/odc/RansomwareDetectionDataSource.key","../../dataSources/restore/odc/RestoreOperationDataSource.key","../../dataSources/restoreActivities/odc/RestoreActivitiesDataSource.key","../../dataSources/search/odc/SearchDataSource.key","../../dataSources/item/odc/RecycleBinDataSource","../../dataSources/language/odc/LanguageDataSource","../../dataSources/languagePicker/odc/LanguagePickerDataSource","../../dataSources/leftNav/odc/LeftNavDataSource","../../dataSources/peoplePicker/odc/PeoplePickerDataSource","../../dataSources/sharing/odc/SharingDataSource","../../dataSources/sharing/odc/SharingDataDataSource","../../dataSources/suiteNav/odc/SuiteNavDataSource","../../utilities/logging/odc/Beacon","../../dataSources/mobileAppPath/odc/IOSMobilePathDataSource","../../dataSources/url/odc/UrlDataSource","../../resources/UtilityResourceKeys","../../dataSources/download/odc/DownloadDataSource.key","../../dataSources/identity/odc/IdentityDataSource","../../dataSources/identity/odc/PWAAppIdentityDataSource","../../dataSources/userInfo/odc/UserInfoDataSource","../../dataSources/versionControl/VersionControlDataSource","../../dataSources/versionHistory/odc/VersionHistoryDataSource","../../dataSources/vault/odc/VaultDataSource.key","../../controls/vaultTeachingBubble/react/odc/VaultTeachingBubble.key","../../dataSources/album/odc/AlbumDataSource","../../dataSources/tag/odc/TagDataSource","../../dataSources/photo/odc/PhotoDataSource","../../resources/ControlResourceKeys","../../providers/instrumentation/InstrumentationProvider","@ms/odsp-utilities/lib/logging/events/Nav.event","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../dataSources/feedback/odc/FeedbackDataSource","../../dataSources/sendFeedback/odc/SendFeedbackDataSource","../../dataSources/userActivity/odc/UserActivityDataSource","../../providers/userActivity/UserActivityProvider","../../providers/feedback/FeedbackProvider","../../providers/embed/EmbedProvider","../../dataSources/embed/odc/EmbedDataSource","../../providers/userInfo/UserInfoProvider","../../providers/teachingBubble/TeachingBubbleProvider","../../providers/ransomwareDetection/RansomwareDetectionProvider","../../providers/tag/TagProvider","../../providers/photo/PhotoProvider","../../providers/storageInfo/StorageInfoProvider","../../providers/storageOptions/StorageOptionsProvider","../../providers/notification/NotificationProvider","../../dataSources/application/odc/ApplicationDataSource","../../dataSources/storageInfo/odc/StorageInfoDataSource","../../providers/ticketRedeemer/TicketRedeemerProvider","../../dataSources/storageOptions/odc/StorageOptionsDataSource","../../providers/subscriptions/SubscriptionsProvider","../../dataSources/subscriptions/vroom/SubscriptionsDataSource","../../providers/thumbnail/ThumbnailProvider","../../dataSources/instrumentation/odc/InstrumentationDataSource","../../dataSources/encoding/odc/EncodingDataSource","../../dataSources/videoItem/odc/VideoItemDataSource.key","../../dataSources/item/odc/MoveCopyDataSource","../../dataSources/upsell/odc/UpsellDataSource","../../providers/upsell/UpsellProvider","../../utilities/features/Features","../../actions/odc/ActionMap","../../dataSources/itemCommand/odc/ItemCommandDataSource","../../dataSources/processFilters/odc/ProcessFiltersDataSource","../../providers/processFilters/ProcessFiltersProvider","../../utilities/purchaseLogging/AwaHelper","../../controls/oneDriveApp/OneDriveApp","../../utilities/experiment/ExperimentHelper","../../utilities/attribution/AttributionHelper","../../utilities/educationAndUpsells/EducationAndUpsells","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../dataSources/teachingBubble/odc/TeachingBubbleDataSource","../../dataSources/recycleBin/odc/RecycleBinDataSource","../../providers/recycleBin/RecycleBinProvider","../../providers/dragAndDropRobot/DragAndDropRobotProvider","../../dataSources/winApp/wip/odc/WIPDataSource","../../controls/list/columns/ListColumns","../../dataSources/pushChannel/odc/PushChannelDataSource.key","../../providers/pushChannel/PushChannelProvider.key","../../dataSources/rootItems/odc/RootItems.key","../../dataSources/itemAutoRefresh/odc/ItemAutoRefreshDataSource.key","../../providers/itemAutoRefresh/ItemAutoRefreshProvider.key","../../dataSources/inAppMessaging/odc/InAppMessagingDataSource.key","../../utilities/browser/WebViewDetector","../../dataSources/floodgate/FloodgateDataSource.key","../../dataSources/mruRecent/odc/MruRecentDataSource.key","../../dataSources/itemActivityFeed/helper/odc/ItemActivityFeedHelper.key","../../providers/winApp/communication/WinAppCommunicator.key","../../dataSources/winApp/communication/odc/WinAppCommunicatorDataSource.key","../../providers/winApp/keyboardHelper/WinAppKeyboardHelper.key","../../providers/quota/WinAppQuotaProvider.key","../../providers/profilechangehandler/ProfileChangeHandler.key","../../resources/FloodgateResourceKeys","../../dataSources/infoPane/InfoPaneManager.key","../../dataSources/infoPane/odc/InfoPaneManager.key","../../dataSources/item/ItemCacheToKOStoreDataSource.key","../../dataSources/item/od/ItemCacheToKOStoreDataSource.key","../../controls/itemsScope/odc/DefaultClickActionControlHandler.key","../../dataSources/itemInvalidator/odc/ItemInvalidator.key","../../controls/itemsScope/ItemsScopeControlHandlerResourceKeys","../../controls/itemsScope/od/ItemsScopeControlHandlerResourceKeys","../../models/itemCache/ItemCacheConfiguration.key","../../models/itemCache/od/ItemCacheConfiguration.key","../../models/itemsScope/ItemsScopeAddon.key","../../models/itemsScope/od/ItemsScopeAddon.key","../../models/itemsScope/ItemsScopeKeyConverter.key","../../models/itemsScope/od/ItemsScopeKeyConverter.key","@ms/odsp-shared/lib/utilities/knockout/ResourceComponentLoader","@ms/odsp-shared/lib/utilities/knockout/LocalBindingProvider","../../controls/shim/base/Base.css","../../controls/FabricIconsDeferred","../../utilities/TestHooks"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue,ae,fe,le,ce,he,pe,de,ve,me,ge,ye,be,we,Ee,Se,xe,Te,Ne,Ce,ke,Le,Ae,Oe,Me,_e,De,Pe,He,Be,je,Fe,Ie,qe,Re,Ue,ze,We,Xe,Ve,$e,Je,Ke,Qe,Ge,Ye,Ze,et,tt,nt,rt,it,st,ot,ut,at,ft,lt,ct){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!window.$Config||$Config.aadClientId&&"live.com"===$Config.domain||"UnAuth"===$Config.cid||n.default.initializeAuthenticators([/^https?:\/\/(?:[A-Za-z0-9]*[.])*livefilestore(?:-int)?[.]com\//i,/^https?:\/\/(?:[A-Za-z0-9\-]*[.])*1drv(?:-int)?[.]com\//i],window.cookieToss);t.initialize=function(t){t.expose(s.userSettingsStore,new l.default({defaultRootItemId:"root",viewerId:L.default.viewerId}));t.expose(s.userInfoStore,new c.default);var n=new(t.injected(D.default));t.expose(o.userInfo,n);t.expose(f.userInfo,new(t.injected(Y.default)));t.expose(A.experimentHelper,new(t.injected(Ce.default)));t.expose(ke.resourceKey,new(t.injected(ke.default)));var ht=new(t.injected(L.default)),pt=t.consume(Ae.navigation);z.Nav.logData({url:location.href,viewParams:pt.viewParams});pt.viewParams&&"1"===pt.viewParams.su?W.Engagement.logData({name:"SignUpCompletedODC"}):pt.viewParams&&"1"===pt.viewParams.gologin&&W.Engagement.logData({name:"SignInCompletedODC"});"/photos"===location.pathname&&pt.updateViewParams({v:"photos"},{ignoreHistory:!0,clearPath:!0});t.expose(o.url,ht);t.expose(u.urlDataSource,ht);be.isFeatureEnabled(be.EnableNewActivityFeed)&&t.exposeFactory(o.itemActivityFeedHelper,new i.AliasResourceFactory(Xe.resourceKey));if(Ue.isOneDriveWinApp()){t.exposeFactory(o.winAppCommunicator,new i.AliasResourceFactory($e.resourceKey));t.consumeAsync(Ve.resourceKey.bypass);be.isFeatureEnabled(be.UseItemsScopeInOneDrive)||t.exposeFactory(o.identity,new i.AliasResourceFactory(_.resourceKey));t.consumeAsync(Je.resourceKey);t.consumeAsync(Ke.resourceKey)}else be.isFeatureEnabled(be.UseItemsScopeInOneDrive)||t.exposeFactory(o.identity,new i.AliasResourceFactory(M.resourceKey));t.exposeFactory(o.wip,new i.AliasResourceFactory(Pe.resourceKey));var dt=t.consume(f.bundleLoader);dt.waitForPLT().then(function(){return Te.default.init()});t.exposeFactory(o.subscriptions,new i.AliasResourceFactory(ce.resourceKey));t.expose(f.subscriptions,new(t.injected(le.default)));var vt=new(t.injected(p.default));t.expose(o.getItem,vt);t.expose(o.items,vt);t.expose(o.deleteRestore,vt);t.expose(o.schema,vt);t.expose(u.itemDataSource,vt);t.expose(o.storageInfo,new(t.injected(ue.default)));t.expose(f.storageInfo,new(t.injected(re.default)));t.expose(o.storageOptions,new(t.injected(fe.default)));t.expose(f.storageOptions,new(t.injected(ie.default)));t.expose(u.recycleBinDataSource,new(t.injected(y.default)));t.expose(R.useMobileList,!1);t.exposeFactory(o.search,new i.AliasResourceFactory(g.resourceKey));t.exposeFactory(o.ransomwareDetection,new i.AliasResourceFactory(d.resourceKey));t.exposeFactory(o.restore,new i.AliasResourceFactory(v.resourceKey));t.exposeFactory(o.restoreActivities,new i.AliasResourceFactory(m.resourceKey));t.exposeFactory(o.language,new i.AliasResourceFactory(b.resourceKey));t.exposeFactory(o.languagePicker,new i.AliasResourceFactory(w.resourceKey));t.expose(a.rumOneScenarioPrefix,"ODC");t.expose(o.settings,new h.default);t.expose(Le.resourceKey,new(t.injected(Le.default)));t.expose(R.isGuidedTourVisible,r.observable(!1));t.expose(R.hasSeenPositioningThisSession,r.observable(!1));t.expose(R.mobileUpsellDismissedThisSession,r.observable(!1));function mt(e){return e.resourceKey}t.exposeAsync(o.graphUrl,new i.AliasResourceLoader(function(){return new Promise(function(t,n){e(["../../dataSources/graphUrl/GraphUrlDataSource"],t,n)}).then(mt)}));t.exposeAsync(f.graphToken,new i.AliasResourceLoader(function(){return new Promise(function(t,n){e(["../../providers/graphToken/GraphTokenProvider"],t,n)}).then(mt)}));t.exposeAsync(o.peopleService,new i.AliasResourceLoader(function(){return new Promise(function(t,n){e(["../../dataSources/people/graph/PeopleDataSource"],t,n)}).then(mt)}));t.exposeFactory(o.rootItems,new i.AliasResourceFactory(Fe.resourceKey));t.expose(o.people,new(t.injected(S.default)));t.expose(o.suiteNav,new(t.injected(N.default))({}));t.expose(o.application,new(t.injected(oe.default)));t.expose(a.beacon,new C.default);t.expose(o.album,new(t.injected(F.default)));t.expose(o.tag,new(t.injected(I.default)));t.expose(o.iosMobileAppPath,new(t.injected(k.default)));t.exposeFactory(o.download,new i.AliasResourceFactory(O.resourceKey));t.expose(o.versionControl,new(t.injected(P.default)));t.expose(o.versionHistory,new(t.injected(H.default)));t.exposeFactory(o.vault,new i.AliasResourceFactory(B.resourceKey));t.exposeFactory(R.vaultTeachingBubble,new i.AliasResourceFactory(j.resourceKey));t.expose(o.instrumentation,new(t.injected(pe.default)));t.expose(f.instrumentation,new(t.injected(U.default)));t.expose(o.sharing,new(t.injected(x.default)));t.expose(o.sharingData,new(t.injected(T.default)));t.expose(R.isDebugWindowVisible,r.observable(!0));t.expose(R.isItemSetRendered,r.observable(!1));t.expose(o.feedback,new(t.injected(X.default)));t.expose(f.feedback,new(t.injected(K.default)));t.expose(o.sendFeedback,new(t.injected(V.default)));t.expose(o.embed,new(t.injected(G.default)));t.expose(f.embed,new(t.injected(Q.default)));t.expose(o.userActivity,new(t.injected($.default)));t.expose(f.userActivity,new(t.injected(J.default)));be.isFeatureEnabled(be.UseItemsScopeInOneDrive)||t.expose(R.viewParams,r.observable({}));t.expose(o.copy,new(t.injected(me.default)));t.expose(o.teachingBubble,new(t.injected(Oe.default)));t.exposeFactory(f.teachingBubble,new i.AliasResourceFactory(Z.resourceKey));t.exposeFactory(f.ransomwareDetection,new i.AliasResourceFactory(ee.resourceKey));t.expose(o.photo,new(t.injected(q.default)));t.expose(f.photo,new(t.injected(ne.default)));t.expose(o.processFilters,new(t.injected(Se.default)));t.expose(f.processFilters,new(t.injected(xe.default)));t.expose(f.tag,new(t.injected(te.default)));t.expose(f.notification,new(t.injected(se.default)));t.expose(f.thumbnail,new(t.injected(he.default)));t.expose(f.ticketRedeemer,new(t.injected(ae.default)));t.expose(o.encoding,new(t.injected(de.default)));t.exposeFactory(o.videoItem,new i.AliasResourceFactory(ve.resourceKey));t.expose(o.upsell,new(t.injected(ge.default))({}));t.expose(f.upsell,new(t.injected(ye.default))({}));t.expose(R.actionMap,new(t.injected(we.default)));t.expose(o.itemCommand,new(t.injected(Ee.default)));t.expose(o.leftNav,new(t.injected(E.default)));t.expose(o.recycleBin,new(t.injected(Me.default)));t.expose(f.recycleBin,new(t.injected(_e.default)));t.expose(f.dragAndDropRobot,new(t.injected(De.default)));t.expose(R.didUserUploadOrCreateFile,r.observable(!1));t.expose(R.didUserEnterPasswordForFile,r.observable(!1));t.exposeAsync(He.columnMenuHelperTypeResourceKey,new i.AliasResourceLoader(function(){return new Promise(function(t,n){e(["../../controls/columnsHeader/SortColumnCommandHelper"],t,n)}).then(function(e){return e.typeResourceKey.local})}));t.exposeAsync(o.batchUploaderType,new i.AliasResourceLoader(function(){return new Promise(function(t,n){e(["../../dataSources/upload/odc/BatchUploader"],t,n)}).then(function(e){return e.typeResourceKey})}));t.exposeAsync(o.vroomItemIdentityProcessor,new i.AliasResourceLoader(function(){return new Promise(function(t,n){e(["../../dataSources/base/odc/vroom/ItemIdentityProcessor"],t,n)}).then(mt)}));t.exposeAsync(o.graph,new i.AliasResourceLoader(function(){return new Promise(function(t,n){e(["../../dataSources/graph/odc/GraphDataSource"],t,n)}).then(mt)}));t.exposeAsync(o.zip,new i.AliasResourceLoader(function(){return new Promise(function(t,n){e(["../../dataSources/zip/odc/ZipDataSource"],t,n)}).then(mt)}));t.exposeAsync(o.worker,new i.AliasResourceLoader(function(){return new Promise(function(t,n){e(["../../dataSources/worker/odc/WorkerDataSource"],t,n)}).then(mt)}));if(be.isFeatureEnabled(be.UseItemsScopeInAllPhotos)&&!be.isFeatureEnabled(be.UseItemsScopeInOneDrive)){t.exposeFactory(ot.resourceKey,new i.AliasResourceFactory(ut.resourceKey));t.exposeFactory(at.resourceKey,new i.AliasResourceFactory(ft.resourceKey));t.exposeFactory(lt.resourceKey,new i.AliasResourceFactory(ct.resourceKey))}if(be.isFeatureEnabled(be.EnableFloodgate)){t.expose(Ge.floodgateAppId,2160);t.exposeFactory(o.floodgate,new i.AliasResourceFactory(ze.resourceKey));var gt=pt.viewParams;dt.waitForPLT().then(function(){t.consume(f.instrumentation).userExecuteAction({name:"NewSession"});t.consumeAsync(ze.resourceKey).then(function(e){e.processViewParams(gt)})})}if(be.isFeatureEnabled(be.QuotaBundleEnabled)){var yt=dt.createDeferredContext(3);yt.expose(o.quota,function(){return new Promise(function(t,n){e(["odsp-next/dataSources/quota/odc/QuotaDataSource"],t,n)})});yt.expose(f.quota,function(){return new Promise(function(t,n){e(["odsp-next/providers/quota/UserStateProvider"],t,n)})})}be.isFeatureEnabled(be.LanguageProfileChange)&&dt.waitForPLT().then(function(){t.consumeAsync(Qe.resourceKey)});var bt=dt.createDeferredContext(5);bt.expose(o.firstRunExperience,function(){return new Promise(function(t,n){e(["odsp-next/dataSources/firstRunExperience/odc/FirstRunExperienceDataSource"],t,n)})});bt.expose(f.firstRunExperience,function(){return new Promise(function(t,n){e(["odsp-next/providers/firstRunExperience/FirstRunExperienceProvider"],t,n)})});bt.expose(o.guidedTour,function(){return new Promise(function(t,n){e(["odsp-next/dataSources/guidedTour/odc/GuidedTourDataSource"],t,n)})});bt.expose(f.guidedTour,function(){return new Promise(function(t,n){e(["odsp-next/providers/guidedTour/GuidedTourProvider"],t,n)})});dt.createDeferredContext(1);if(be.isFeatureEnabled(be.EnablePushChannel)){t.exposeFactory(o.pushChannel,new i.AliasResourceFactory(Be.resourceKey));t.exposeFactory(o.itemAutoRefresh,new i.AliasResourceFactory(Ie.resourceKey));t.consumeAsync(be.isFeatureEnabled(be.EnablePushChannelAutoRefresh)?qe.resourceKey:je.resourceKey)}t.exposeFactory(o.inAppMessaging,new i.AliasResourceFactory(Re.resourceKey));var wt=dt.createDeferredContext(2);wt.expose(o.notifications,function(){return new Promise(function(t,n){e(["odsp-next/dataSources/notifications/odc/NotificationsDataSource"],t,n)})});wt.expose(f.notificationManager,function(){return new Promise(function(t,n){e(["odsp-next/providers/notificationManager/NotificationManager"],t,n)})});t.exposeFactory(o.mruRecent,new i.AliasResourceFactory(We.resourceKey));t.exposeFactory(et.resourceKey,new i.AliasResourceFactory(tt.resourceKey));t.exposeFactory(it.defaultClickHandler,new i.AliasResourceFactory(nt.resourceKey));t.exposeFactory(it.itemSetColumns,new i.AliasResourceFactory(st.itemSetColumns));t.exposeFactory(o.itemInvalidator,new i.AliasResourceFactory(rt.resourceKey));t.exposeFactory(Ye.typeResourceKey,new i.AliasResourceFactory(Ze.typeResourceKey));var Et=document.createElement("div");document.body.appendChild(Et);r.applyBindingsToNode(Et,{component:{name:Ne.default.tagName,params:{resources:t}}});window.__ko=r}});
define("@ms/odsp-utilities/lib/auth/DomainAuthenticator",["require","exports","../async/Promise","../async/Signal"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=[],s=function(){function e(e,t,n){this.complete=!1;this.pending=!1;this.eventName="cookieToss";this._lastAttempt=0;this.domainRegex=e;this.iframeSrc=t;this.complete=n}e.initializeAuthenticators=function(t,n){if(n)if(window.$Config.aadClientId&&"live.com"===window.$Config.domain);else{for(var r=n.s,s=n.r,o=0;r&&o<r.length;o++)i.push(new e(t[o],r[o],!s[o]));n.c=function(e){i[e].onAuthComplete()};e.authenticate("https://livefilestore.com/");e.authenticate("https://1drv.com/")}};e.authenticate=function(e){for(var t,r=0;r<i.length;r++){var s=i[r];if(s.requiresAuth(e)){t=s.authenticate(e);break}}for(var o=[t||n.default.wrap(!0)],u=0,a=this._cookieCheckers;u<a.length;u++){var f=a[u];f.isApplicable(e)&&o.push(f.check(e))}return n.default.all(o).then(function(e){return e.reduce(function(e,t){return e&&t})})};e.registerCookieChecker=function(e){this._cookieCheckers.push(e)};e.prototype.requiresAuth=function(e){return this.domainRegex.test(e)};e.prototype.authenticate=function(e){var t=(new Date).getTime();if(t-this._lastAttempt>6e5){this._authPromise=null;this._lastAttempt=t}if(!this._authPromise){this._authPromise=new r.default;var n=document.createElement("IFRAME");n.src=this.iframeSrc;n.style.display="none";document.body.appendChild(n)}return this._authPromise.getPromise()};e.prototype.onAuthComplete=function(){this._authPromise.complete(!0)};e._cookieCheckers=[];return e}();t.default=s});
define("odsp-next/resources/ModelResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dataStore=new n.ResourceKey("dataStore");t.userSettingsStore=new n.ResourceKey("userSettingsStore");t.userInfoStore=new n.ResourceKey("userInfoStore");t.smartFiltersStore=new n.ResourceKey("smartFiltersStore")});
define("odsp-next/resources/LoggingResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.beacon=new n.ResourceKey("beacon");t.rumOneScenarioPrefix=new n.ResourceKey("RUMOneScenarioPrefix");t.rumOneHelper=new n.ResourceKey("rumOneHelper");t.rumOneEmbedVideoHelper=new n.ResourceKey("rumOneEmbedVideoHelper")});
define("odsp-next/models/store/UserSettingsStore",["require","exports","tslib","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){var n=e.call(this,"UserSettingsStore",i.default.local)||this;n._defaultRootItemId=t&&t.defaultRootItemId||"";n._viewerId=t&&t.viewerId||"";return n}t.prototype.setAllPhotosUserSettings=function(e){this.setValue(this._getLocalStorageKey(),e)};t.prototype.getAllPhotosUserSettings=function(){var e=this.getValue(this._getLocalStorageKey());if(!e){e={isAscending:!1,rootId:this._defaultRootItemId};this.setAllPhotosUserSettings(e);e=this.getValue(this._getLocalStorageKey())}return e};t.prototype._getLocalStorageKey=function(){return"allPhotosUserSettings&viewerId="+this._viewerId};return t}(r.default);t.default=s});
define("odsp-next/models/store/UserInfoStore",["require","exports","tslib","knockout","@ms/odsp-utilities/lib/models/store/BaseDataStore"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(){return e.call(this,"UserInfoStore")||this}t.prototype.getUserInfo=function(){var e=this.getValue("userInfo");if(!e){e=r.observable(null);this.setValue("userInfo",e)}return e};return t}(i.default);t.default=s});
define("odsp-next/dataSources/settings/odc/SettingsDataSource",["require","exports","@ms/odsp-utilities/lib/require/RequireConfigInjector"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){var e=window.Flight,t=e&&e.Config,r=t&&t.odsp_media,i=r?"odsp-media/"+r+"/media":"odsp-media";n.default.addPaths({"@ms/odsp-media/lib":i});this.mediaBaseUrl=i};t.default=r});
define("@ms/odsp-utilities/lib/require/RequireConfigInjector",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}e.addConfig=function(e){window.require.config(e)};e.addPaths=function(e){window.require.config({paths:e})};e.addShims=function(e){window.require.config({shim:e})};return e}();t.default=n});
define("odsp-next/dataSources/item/odc/ItemDataSource",["require","exports","tslib","./SkyApiItemDataSource","@ms/odsp-utilities/lib/async/Promise","../../url/QueryType","@ms/odsp-utilities/lib/modules/Modules"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(t){n.__extends(r,t);function r(){return null!==t&&t.apply(this,arguments)||this}r.prototype.getItem=function(e){var n,r=this._urlDataSource.getKeyParams(e.parentKey),i=this._urlDataSource.getQueryType(r);e.qosName=e.qosName||"Odc."+s.default[i]+".ItemDataSource.getItem";switch(i){case s.default.SharedWithMe:n=this._getSharedDataSource().then(function(t){return t.getItem(e)});break;case s.default.Recent:n=this._getRecentDataSource().then(function(t){return t.getItem(e)});break;case s.default.RecycleBin:n=this._getRecycleBinDataSource().then(function(t){return t.getItem(e)});break;case s.default.Search:n=this._getSearchDataSource().then(function(t){return t.getItem(e)});break;default:n=t.prototype.getItem.call(this,e)}return n};r.prototype._getRecentDataSource=function(){var t=this,n=i.default.resolve(new Promise(function(t,n){e(["./RecentDataSource"],t,n)})).then(o.getDefaultExport).then(function(e){return new(t.managed(e))});this._getRecentDataSource=function(){return n};return n};r.prototype._getSearchDataSource=function(){var t=this,n=i.default.resolve(new Promise(function(t,n){e(["./SearchDataSource"],t,n)})).then(o.getDefaultExport).then(function(e){return new(t.managed(e))});this._getSearchDataSource=function(){return n};return n};r.prototype._getRecycleBinDataSource=function(){var t=this,n=i.default.resolve(new Promise(function(t,n){e(["./RecycleBinDataSource"],t,n)})).then(o.getDefaultExport).then(function(e){return new(t.managed(e))});this._getRecycleBinDataSource=function(){return n};return n};r.prototype._getSharedDataSource=function(){var t=this,n=i.default.resolve(new Promise(function(t,n){e(["./SharedDataSource"],t,n)})).then(o.getDefaultExport).then(function(e){return new(t.managed(e))});this._getSharedDataSource=function(){return n};return n};return r}(r.default);t.default=u});
define("odsp-next/dataSources/item/odc/SkyApiItemDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/xhr/XHRPromise","../../../controls/leftPane/LeftPane.resx","../../item/odc/ODCDataSource.resx","../../base/odc/BatchRequest","../../base/odc/DataRequest","../../base/odc/ItemResultProcessor","knockout","../DeletionType","@ms/odsp-datasources/lib/interfaces/list/DocumentType","../../../models/item/ItemType","../../../dataSources/url/QueryType","../../../resources/ODCResourceKeys","../../../resources/DataSourceResourceKeys","./ColumnsHelper","../../../models/store/ItemsStore","./SortDirectionMap","./SortFieldMap","../../url/odc/UrlDataSource","../../base/odc/ItemErrorProcessor","./ItemDataSourceHelper","../../../roots/odc/OneDrivePrefetch","@ms/odsp-utilities/lib/performance/PerformanceCollection","./MoveCopyDataSource","@ms/odsp-utilities/lib/async/Semaphore","../../base/odc/Config","../ItemTaskObserver","../../item/odc/SkyApiErrorHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=0,D=function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._itemDataSourceHelper=new(t.managed(T.default));t.isLargeRecycleBin=c.observable(!1);t._pendingGetItemRequests={};t._itemsStore=t.resources.consume(b.resourceKey);t._urlDataSource=t.resources.consume(m.urlDataSource);t._identity=t.resources.consume(g.identity);t._itemResultProcessor=new(t.managed(l.default))({getRootItemTitle:t.getRootItemTitle.bind(t),getItemKeyExtension:t._getItemKeyExtension.bind(t)});t._itemErrorProcessor=new(t.managed(x.default));t._rotationSemaphore=new L.default;return t}t.getServerDocumentType=function(e){var t;switch(e){case p.DocumentType.Word:t="w";break;case p.DocumentType.Excel:t="x";break;case p.DocumentType.PowerPoint:t="p";break;case p.DocumentType.OneNote:t="n";break;case p.DocumentType.ExcelSurvey:t="f"}return t};t.prototype.getItem=function(e){var t=this._itemDataSourceHelper.getRequestVersion(e),n=this._itemDataSourceHelper.getFetchUrl(e,t,this.isLargeRecycleBin.peek());return this._getItem(n,t,e)};t.prototype.getSpecifiedItems=function(e){return null};t.prototype.getColumns=function(e,t){void 0===t&&(t=this._getDefaultSortInformation(e.itemFromServer));return y.getColumns(e,this.resources,t)};t.prototype.deleteItems=function(e){var t=this,n=this._urlDataSource.getKeyParams(e.parentKey),r=e.items;r&&r[0].key&&!r[0].id&&(r=r.map(function(e){return t._itemsStore.getItem(e.key).peek()}));return a.default.start({apiName:"DeleteItems",url:this._getDeleteItemsUrl(),batchSize:100,items:r,getPostData:function(t){return{deletionType:e.deletionType?e.deletionType:h.default.Recycle,targetId:n.id,cid:S.default.viewerId,group:0,overrideLock:!!e.overrideLock,items:t.map(function(e){return e.id})}},isErrorExpectedCallback:function(e){switch(e.errorCode){case 3e3:case 9001:return!0;default:return!1}},onBatchComplete:function(e){for(var t=0,n=e;t<n.length;t++){n[t].eTag=""}}})};t.prototype.renameItem=function(e){var t=this,n=this._getUpdateItemsUrl(),r=e.item.name,s=e.newName+e.item.extension;if(e.nameHasExtension){var o=e.newName.lastIndexOf(".");if(o>0){var u=e.newName.substr(o+1);Array.isArray(A.Files.createTextDocumentExts)&&A.Files.createTextDocumentExts.indexOf(u)>=0&&(s=e.newName)}}var a=new f.default,l=this._urlDataSource.getKeyParams(e.parentKey),c=JSON.stringify({id:e.item.properties.ghostId||e.item.id,name:s,lid:l.id,rset:S.default.scenarioName,ownerId:e.ownerId});return a.send({apiName:"UpdateItem",url:n,requestType:"POST",postData:c,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return i.default.wrapError(t._itemErrorProcessor.getError(e,r).errorTitle)})};t.prototype.getOpenInClientDetails=function(e){var t=this._getOpenInClientDetailsUrl()+"?id="+e.id;return(new f.default).send({apiName:"GetOpenInClientDetails",url:t})};t.prototype.saveSortOrder=function(e){var t=this._getUpdateItemsUrl(),n=new f.default,r=JSON.stringify({id:e.item.id,sortOrder:e.sortOrder,sortDirection:e.sortDirection,cid:S.default.viewerId});return n.sendPost("UpdateItem",t,r)};t.prototype.reportAbuse=function(e){var t=this,n=this._getReportAbuseUrl(),r=new f.default,s=JSON.stringify({rao:e.rao,id:e.item.id,ownerName:e.item.ownerName,ownerCid:e.item.ownerId,itemName:e.item.name,urls:e.item.urls,cid:S.default.viewerId,group:0,desc:e.desc,ref:window.location.href});return r.send({apiName:"ReportAbuse",url:n,requestType:"POST",postData:s,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return i.default.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})};t.prototype.requestReview=function(e){var t=this,n=this._getRequestReviewUrl(),r=window.$Config,s=new f.default,o=JSON.stringify({email:r.email,ids:e.items.map(function(e){return e.id})});return s.send({apiName:"OwnerRequestReview",url:n,requestType:"POST",postData:o,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return i.default.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})};t.prototype.updateBundle=function(e){var t=this,n=this._getUpdateBundleUrl(),r=new f.default,s=JSON.stringify({bundleId:e.item.id,bundleAction:e.bundleAction,items:e.items});return r.send({apiName:"UpdateBundle",url:n,requestType:"POST",postData:s,isErrorExpectedCallback:this._isErrorExpected}).then(null,function(e){return i.default.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})};t.prototype.removeFromSharedList=function(e){var t=this._getRemoveFromSharedListUrl(),n=new f.default,r=JSON.stringify({items:e.items.map(function(e){return e.id}),markAsSpam:e.markAsSpam});return n.sendPost("AbdicatePermissions",t,r)};t.prototype.addCoverPhotos=function(e){var t=this._getAddCoverPhotoUrl(),n=new f.default,r=e.items.map(function(e){return e.id}),i=JSON.stringify({items:r,targetId:e.target.id,cid:S.default.viewerId,group:e.target.isGroup?1:0});return n.sendPost("AddFavorites",t,i)};t.prototype.removeCoverPhotos=function(e){var t=this._getRemoveCoverPhotoUrl(),n=new f.default,r=e.items.map(function(e){return e.id}),i=JSON.stringify({items:r,targetId:e.target.id,cid:S.default.viewerId,group:e.target.isGroup?1:0});return n.sendPost("RemoveFavorites",t,i)};t.prototype.changeFolderType=function(e){var t=this._getUpdateItemsUrl(),n=new f.default,r=JSON.stringify({id:e.item.id,category:e.category,cid:S.default.viewerId});return n.sendPost("UpdateItem",t,r)};t.prototype.updateItemProperty=function(e){var t=this._getUpdateItemsUrl(),n=new f.default,r={id:e.item.id,lid:e.item.parent.id,overrideLock:(!!e.overrideLock).toString(),rset:S.default.scenarioName};r[e.propertyName]=e.propertyValue||"";return n.sendPost("UpdateItem",t,JSON.stringify(r))};t.prototype.createFolder=function(e){var t=this,n=this._getCreateFolderUrl(),r=this._urlDataSource.getKeyParams(e.parent.key),s=new f.default,o=[];if(e.selectedPeople&&e.selectedPeople.length>0)for(var u=0,a=e.selectedPeople;u<a.length;u++){var l=a[u];o.push({role:2,type:0,email:l.email})}var c={ownerCid:this._identity.getIdentity().id,message:e.sharingNote,requireSignIn:!0,entities:o},h=JSON.stringify({parentId:r.id,cid:r.cid,group:0,name:e.folderName,permissionsInfo:e.selectedPeople&&e.selectedPeople.length>0?c:null,doNotRollbackOnPartialPermissionsError:!0,sendShareNotification:!0});return s.send({apiName:"AddFolder",url:n,requestType:"POST",postData:h,isErrorExpectedCallback:this._isErrorExpected}).then(function(n){n=n.items||n.item;var r=new(t.resources.consume(O.resourceKey)),i=t._getItemResult({requestKey:e.parent.key,itemFromServer:n,queryType:v.default.Files,keyAlias:e.keyAlias,isPrimaryRequestedItem:!0,observer:r});r.flush();return i?r.getItem({key:i.item.key}):null},function(e){return i.default.wrapError(t._itemErrorProcessor.getError(e).errorTitle)})};t.prototype.createDocument=function(e,n,r){var s=this;if(n===p.DocumentType.Text)return i.default.wrap(this._createTextDocument(e));var o=this._getCreateDocumentUrl(),u=t.getServerDocumentType(n),a=new f.default,l=this._urlDataSource.getKeyParams(e),c=JSON.stringify({parentId:l.id,nameConflict:r?0:2,overrideLock:!1,cid:l.cid,group:0,name:r,docType:u});return a.send({apiName:"CreateDocument",url:o,requestType:"POST",postData:c,isErrorExpectedCallback:this._isErrorExpected}).then(function(t){var r="";if((t=t.items||t.item)&&t.length>0){var i=new(s.resources.consume(O.resourceKey)),o=s._getItemResult({requestKey:e,itemFromServer:t[0],queryType:v.default.Files,isPrimaryRequestedItem:!0,observer:i});i.flush();r=(r=i.getItem({key:o.item.key}).openUrl.replace("redir.aspx","edit.aspx")).replace("&page=view","");n===p.DocumentType.OneNote&&(r+="&nd=1")}return r},function(e){return i.default.wrapError(s._itemErrorProcessor.getError(e).errorTitle)})};t.prototype.createCustomDocument=function(e,t,n){return null};t.prototype.createShortcut=function(e,t,n){return null};t.prototype._createTextDocument=function(e){var t=this._urlDataSource.getKeyParams(e);return this.resources.consume(m.urlDataSource).getCreateTextDocumentUrl(t.id,t.cid)};t.prototype.createDocumentInTab=function(e,n,r){var i,s=t.getServerDocumentType(e);if(e===p.DocumentType.Text)i=this._createTextDocument(n.key);else{i=this.resources.consume(m.urlDataSource).getCreateDocumentInTabUrl(n,s,r)}return i};t.prototype.getFilterData=function(e,t,n){return null};t.prototype.restoreItems=function(e){var t=this._urlDataSource.getKeyParams(e.parentKey);return a.default.start({apiName:"RestoreItems",url:this._getRestoreItemsUrl(),batchSize:100,items:e.items,isErrorExpectedCallback:function(e){switch(e.errorCode){case 1e3:case 2001:return!0;default:return!1}},getPostData:function(n){var r={targetId:t.id,cid:S.default.viewerId,group:0,items:n.map(function(e){return e.id}),recycleBinItems:n.map(function(e){return{deletedFromLocation:e.location===u.strings.ProductName?"":e.location,id:e.id,name:e.extension?e.name+e.extension:e.name}}),retainAcls:e.retainAcls||!1};e.nameConflict&&(r.nameConflict=e.nameConflict);return r}})};t.prototype.restoreAll=function(e){var t=this._getRestoreAllUrl(),n=new f.default;return new i.default(function(e,r){n.sendPost("RestoreAll",t,"").then(function(){e(!0)},r)})};t.prototype.copyItems=function(e){return this._handleMoveCopyApiRequest("CopyItems",e,this._getCopyItemsUrl())};t.prototype.moveItems=function(e){return this._handleMoveCopyApiRequest("MoveItems",e,this._getMoveItemsUrl())};t.prototype.removeFromRecent=function(e){for(var t,n=this._getRemoveFromRecentUrl(),r=new f.default,i=[],s=0;s<e.items.length;s++)i.push(e.items[s].id);t=JSON.stringify({items:i});return r.sendPost("RemoveFromMRU",n,t)};t.prototype.removeMountPoint=function(e){var t,n=this._getRemoveMountPointUrl(),r=new f.default;t=JSON.stringify({id:e.item.properties.ghostId||e.item.id});return r.sendPost("RemoveMountPoint",n,t)};t.prototype.createMountPoint=function(e){var t,n=this,r=this._getCreateMountPointUrl(),s=new f.default,o=this._urlDataSource.getAuthKeyParamValue();t=JSON.stringify({isMountPoint:1,sourceResourceId:e.item.id,nameConflict:1,authKey:o});return s.sendPost("MountFolder",r,t).then(function(e){var t=new(n.resources.consume(O.resourceKey)),r=e?n._getItemResult({requestKey:"",itemFromServer:e.item,queryType:v.default.Files,isPrimaryRequestedItem:!0,observer:t}).item:null;t.flush();return r?t.getItem({key:r.key}):null},function(e){return i.default.wrapError(e)})};t.prototype.getWorkProgress=function(e){var t=this._getWorkProgressUrl(e),n=new f.default;return e.workItemIds?n.sendPost("GetWorkProgress",t,JSON.stringify({workItemIds:e.workItemIds})):n.send({apiName:"GetWorkProgress",url:t})};t.prototype.cancelWork=function(e){var t=this._getCancelWorkUrl();(new f.default).sendPost("CancelWork",t,JSON.stringify(e));return i.default.wrap(!0)};t.prototype.getItemOcrTextContent=function(e){var t=new f.default,n=JSON.stringify({ids:[e.id],streamName:"TextContent"});return t.sendPost("Download",S.default.skyApiBaseUrl+"GetDownloadUrl",n).then(function(e){var t=e.DownloadUrl||e.items&&e.items[0]&&e.items[0].downloadUrl;return s.default.start({url:t,json:null}).then(function(e){var t=window.DOMParser,n=(t&&(new t).parseFromString(e.responseText,"text/xml")).querySelector("c");return n&&n.textContent})})};t.prototype.updateItemOcrInfo=function(e,t,n){var r=this._getUpdateItemsUrl(),i=new f.default,s=JSON.stringify({eTag:e.eTag,id:e.id,textContent:t||"",entityTags:n,lid:e.parent.id,rset:S.default.scenarioName});return i.sendPost("UpdateItem",r,s)};t.prototype.processReferral=function(e,t){var n=this._getProcessReferralUrl(),r=new f.default,i={inviterId:e};t&&""!==t&&(i.inviteSrc=t);return r.sendPost("ProcessReferral",n,JSON.stringify(i))};t.prototype.rotateItems=function(e){for(var t=this,r=new(this.resources.consume(O.resourceKey)),s=this._getRotateItemUrl(),o=[],u=function(u){var l=a.peekUnwrapObservable(a._itemsStore.getItem(u.key)),c=++_;if(l.thumbnail){var h=l.orientedThumbnail;h=h?n.__assign({},h,{rotation:h.rotation+e.rotation,version:c}):{rotation:e.rotation,thumbnail:n.__assign({},l.thumbnail),version:c};r.update([new O.Task(u.key).succeed({item:{key:u.key,orientedThumbnail:O.Graft.replace(h)}})])}var p=new f.default,d=JSON.stringify({targetId:u.id,numberOfClockwiseRotations:-e.rotation,cid:S.default.viewerId});o.push(a._rotationSemaphore.enqueue(function(){return p.sendPost("ChangeImageOrientation",s,d).then(function(e){var n=t.peekUnwrapObservable(t._itemsStore.getItem(u.key)),i=n.itemFromServer&&n.itemFromServer.commands;e.item.commands=i||e.item.commands;t._itemResultProcessor.processItemResult({observer:r,itemFromServer:e.item,isPrimaryRequestedItem:!0,skipSettingChildren:!0,requestKey:u.key});var s=n.orientedThumbnail;s&&s.version===c&&r.update([new O.Task(u.key).succeed({item:{key:u.key,orientedThumbnail:O.Graft.remove()}})]);return n},function(n){var s=t.peekUnwrapObservable(t._itemsStore.getItem(u.key)).orientedThumbnail;if(s){s=s.version===c?O.Graft.remove():{rotation:s.rotation-e.rotation};r.update([new O.Task(u.key).succeed({item:{key:u.key,orientedThumbnail:s}})])}var o=new Error(n.data.message);o.data={key:u.key,error:n.data};return i.default.wrapError(o)})}))},a=this,l=0,c=e.items;l<c.length;l++){u(c[l])}r.flush();return i.default.all(o).then(function(e){r.flush();return e.map(function(e){var n=t.peekUnwrapObservable(t._itemsStore.getItem(e.key));n&&n.parent&&t._itemDataSourceHelper.removeBrowserCacheResultVersion(n.ownerId,n.parent.key);return n})},function(e){r.flush();var t=new Error;t.data=Object.keys(e).map(function(t){return e[t].data});return i.default.wrapError(t)})};t.prototype.redeemPermissionToken=function(e){var t=this._urlDataSource.getAuthKeyParamValue(),n=this._getRedeemPermissionTokenUrl(),r=new f.default,i={id:e.item.id,authKey:t};return r.sendPost("RedeemPermissionToken",n,JSON.stringify(i))};t.prototype.updateViewCount=function(e){var t=e.items.filter(function(e){return e.ownerId!==S.default.viewerId});return 0===t.length?i.default.wrap(null):a.default.start({apiName:"UpdateViewCount",url:this._getUpdateViewCountUrl(),batchSize:100,items:t,getPostData:function(e){return{cid:S.default.viewerId,ids:e.map(function(e){return e.id})}}})};t.prototype.getRootItemTitle=function(e){return o.strings.Files};t.prototype._getRootFileId=function(){return"root"};t.prototype._getParentItemId=function(){return""};t.prototype._getItemKeyExtension=function(e,t){var n,r=this._urlDataSource.getKeyParams(t);return r.id===e.id?r:e.folder?((n={}).ft=r.ft,n.ext=r.ext,n):{}};t.prototype._handleMoveCopyApiRequest=function(e,t,r){for(var s,o=new f.default,u=t.items.map(function(e){return e.id}),a=k.convertMoveCopyContextToPostData(t),l=[],c=new L.default,h=function(){var i=u.splice(0,100);a.items=i;var f=JSON.stringify(a);!1!==t.ackMoveIfShared&&(s={prefer:"Block-Move-Into-Vault-If-Shared"});var h=c.enqueue(function(){return o.send({apiName:e,url:r,requestType:"POST",headers:s,postData:f,isErrorExpectedCallback:function(e){switch(e.errorCode){case 1e3:case 1007:case 1012:case 2028:case 2029:return!0;case 3e3:case 3e3:case 9001:return!0}}}).then(function(e){return e},function(e){return e.data&&e.data.items?e.data:{items:[n.__assign({},e,{error:e.data})]}})});l.push(h)};u.length;)h();return i.default.all(l).then(function(e){var t=e.map(function(e){return e.items});return{items:[].concat.apply([],t)}})};t.prototype._getItem=function(e,t,r){var s,o=this,u=String(Math.random()),a=((s={})["X-SkyApiOriginId"]=u,s),l=this._pendingGetItemRequests[e];if(!l){var c=N.default.prefetchDataRequest[e];if(c){u=N.default.prefetchDataRequestOrigin;delete N.default.prefetchDataRequest[e]}var h=!r.skipCache&&c||(new f.default).send({apiName:"GetItems",qosName:r.qosName,url:e,headers:a,isErrorExpectedCallback:M.isExpectedSkyApiError}),p=!1;l=h.then(function(i){p=!0;C.default.mark("ItemsDataSource.GetItems.Normalizing");var s,a=i.originId,f=i.items||i.item&&[i.item]||[];if(f&&f.length>0){for(var l=new(o.resources.consume(O.resourceKey)),c=void 0,h=f.length-1;h>=0;h--){var v=0===h;if(!f[0].isBundle||v){var m=h>0,g=o._getItemResult({observer:l,requestKey:r.parentKey,itemFromServer:f[h],queryType:r.queryType,requestMetadata:{tokenNeedsRedeeming:i.tokenNeedsRedeeming,tokenType:i.tokenType,restoreAllWorkItemCount:i.restoreAllWorkItemCount||0,deleteAllWorkItemCount:i.deleteAllWorkItemCount||0},setItemKey:!m,skipSettingChildren:m,isPrimaryRequestedItem:v});v&&(c=g)}}l.flush();if(c&&c.item){var b=l.getItem({key:c.item.key}),w=f[0],E=o._getDefaultSortInformation(w);if(r.sortField){var S=E&&E.defaultSortField;E={sortField:r.sortField,defaultSortField:S,isAscending:r.isAscending,isSortEnabled:!o.isLargeRecycleBin.peek()}}var x=void 0;E&&(x=E.isAscending);var T=a!==u;T||b.type!==d.default.Folder||o._itemDataSourceHelper.persistResultVersion(r,t);var N=y.getColumns(b,o.resources,E),k=void 0;if(N&&E)for(var L=0,A=N;L<A.length;L++){var M=A[L];if(M.internalName===E.sortField){k=M.key;break}}s=n.__assign({},c,{schema:N,startIndex:w.folder?w.folder.startIndex:r.startIndex,isFromBrowserCache:T,sortField:k,isAscending:x})}}delete o._pendingGetItemRequests[e];return s},function(t){delete o._pendingGetItemRequests[e];var n=new(o.resources.consume(O.resourceKey)),s=o._itemErrorProcessor.processError({requestKey:r.parentKey,error:t,observer:n}).error;n.flush();return i.default.wrapError(s)});p||(this._pendingGetItemRequests[e]=l)}return l};t.prototype._isErrorExpected=function(e){switch(e.errorCode){case 209:case 509:case 1e3:case 1006:case 2006:case 3e3:case 9001:case 9006:case 3403:return!0;default:return!1}};t.prototype._getDefaultSortInformation=function(e){var t;e&&e.folder&&e.folder.defaultSort&&e.folder.defaultSortDirection&&Object.keys(E.default).length/2>e.folder.defaultSort&&(t={sortField:E.default[e.folder.defaultSort],defaultSortField:E.default[e.folder.defaultSort],isAscending:e.folder.defaultSortDirection.toString()===w.default.ascending.toString(),isSortEnabled:!0});return t};t.prototype._getItemResult=function(e){return this._itemResultProcessor.processItemResult(e)};t.prototype._getCreateDocumentUrl=function(){return S.default.skyApiBaseUrl+"CreateDocument"};t.prototype._getCreateFolderUrl=function(){return S.default.skyApiBaseUrl+"AddFolder?lct=1"};t.prototype._getDeleteItemsUrl=function(){return S.default.skyApiBaseUrl+"DeleteItems"};t.prototype._getUpdateViewCountUrl=function(){return S.default.skyApiBaseUrl+"UpdateViewCount"};t.prototype._getRestoreItemsUrl=function(){return S.default.skyApiBaseUrl+"RestoreItems"};t.prototype._getOpenInClientDetailsUrl=function(){return S.default.skyApiBaseUrl+"GetOpenInClientDetails"};t.prototype._getRequestReviewUrl=function(){return S.default.skyApiBaseUrl+"OwnerRequestReview"};t.prototype._getReportAbuseUrl=function(){return S.default.skyApiBaseUrl+"ReportAbuse"};t.prototype._getRemoveFromSharedListUrl=function(){return S.default.skyApiBaseUrl+"AbdicatePermissions"};t.prototype._getAddCoverPhotoUrl=function(){return S.default.skyApiBaseUrl+"AddFavorites"};t.prototype._getRemoveCoverPhotoUrl=function(){return S.default.skyApiBaseUrl+"RemoveFavorites"};t.prototype._getUpdateItemsUrl=function(){return S.default.skyApiBaseUrl+"UpdateItem?lct=1"};t.prototype._getUpdateBundleUrl=function(){return S.default.skyApiBaseUrl+"UpdateBundle"};t.prototype._getCopyItemsUrl=function(){return S.default.skyApiBaseUrl+"CopyItemsAsync"};t.prototype._getMoveItemsUrl=function(){return S.default.skyApiBaseUrl+"MoveItems"};t.prototype._getRemoveFromRecentUrl=function(){return S.default.skyApiBaseUrl+"RemoveFromMRU"};t.prototype._getRemoveMountPointUrl=function(){return S.default.skyApiBaseUrl+"RemoveMountPoint"};t.prototype._getCreateMountPointUrl=function(){return S.default.skyApiBaseUrl+"AddFolder"};t.prototype._getRestoreAllUrl=function(){return S.default.skyApiBaseUrl+"RestoreAll"};t.prototype._getWorkProgressUrl=function(e){return S.default.skyApiBaseUrl+"GetWorkProgress?type="+e.type};t.prototype._getRotateItemUrl=function(){return S.default.skyApiBaseUrl+"ChangeImageOrientation"};t.prototype._getCancelWorkUrl=function(){return S.default.skyApiBaseUrl+"CancelWork"};t.prototype._getProcessReferralUrl=function(){return S.default.skyApiBaseUrl+"ProcessReferral"};t.prototype._getRedeemPermissionTokenUrl=function(){return S.default.skyApiBaseUrl+"RedeemPermissionToken"};return t}(r.default);t.default=D});
define("@ms/odsp-utilities/lib/xhr/XHRPromise",["require","exports","./XHR","../async/Promise"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.start=function(e){var t=new n.default(e);return new r.default(function(e,n){t.start(e,n)},function(){t.abort(!0)})};e.startAndPostProcess=function(e,t){var i=new n.default(e);return new r.default(function(e,n){i.start(function(n,r){e(t(n,r))},n)},function(){i.abort(!0)})};return e}();t.default=i});
define("odsp-next/dataSources/base/odc/BatchRequest",["require","exports","@ms/odsp-utilities/lib/async/Signal","./DataRequest"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.start=function(e){var t=new n.default(function(){for(var e=0,t=o;e<t.length;e++){t[e].cancel()}}),i=e.items.slice(),s=e.parallelRequests||1,o=[];function u(e){var t=o.indexOf(e);t>=0&&o.splice(1,t)}function a(){var n=new r.default,s=i.splice(0,e.batchSize),f=JSON.stringify(e.getPostData(s)),l=n.send({apiName:e.apiName,url:e.url,requestType:"POST",postData:f,isErrorExpectedCallback:e.isErrorExpectedCallback}).then(function(){u(l);e.onBatchComplete&&e.onBatchComplete(s);i.length?a():t.complete()},function(e){u(l);!function(e){t.error(e)}(e)});o.push(l)}for(var f=0;i.length>0&&f<s;f++)a();return t.getPromise()};return e}();t.default=i});
define("odsp-next/dataSources/base/odc/ItemResultProcessor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../models/item/VirtualItemType","../../../models/item/ItemType","../../../models/item/SharingType","@ms/odsp-datasources/lib/interfaces/item/UrlType","../../../controls/photos/Photos.resx","../../item/ItemDataSource.resx","../../item/odc/ODCDataSource.resx","../../../controls/leftPane/LeftPane.resx","../../url/QueryType","../../url/odc/UrlDataSource","../../item/odc/SkyApiCommands","@ms/odsp-utilities/lib/string/StringHelper","../../../utilities/icons/OfficeFileNameHelper","@ms/odsp-utilities/lib/icons/IconSelector","@ms/odsp-utilities/lib/locale/Locale","./ThumbnailProcessor","../../../utilities/features/Features","../../../resources/ODCResourceKeys","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/dateTime/DateTime","../../album/odc/AlbumDataSource","../../../utilities/array/ArrayHelper","../../item/ItemTaskObserver","../../../utilities/mime/MimeHelper","@ms/odsp-microservice/lib/microService/helpers/BabylonSupport"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var A={0:0,1:2,2:1,3:3,4:4,5:5},O=f.strings;function M(e){if("number"==typeof e)return x.getDateFromDotNetTicks(e)}var _=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.getRootItemTitle,i=void 0===r?n._getRootItemTitle:r,s=t.getItemKeyExtension,o=void 0===s?n._getItemKeyExtension:s;n._getRootItemTitle=i;n._getItemKeyExtension=o;n._urlDataSource=n.resources.consume(E.urlDataSource);n._identityDataSource=n.resources.consume(S.identity);n._thumbnailProcessor=new(n.managed(b.default));return n}t.prototype.processItemResult=function(e){var t=this,r=e.requestKey,o=e.itemFromServer,f=e.requestMetadata,c=e.setItemKey,b=e.skipSettingChildren,E=e.isPrimaryRequestedItem,S=e.isPlaceholder,T=e.observer,k=this._urlDataSource.getKeyParams(r),O=e.queryType,_=void 0===O?this._urlDataSource.getQueryType(k):O;if(o){var P=this.getItemKey({requestKey:r,itemFromServer:o}),H={key:P},B=o.itemStatus;H.itemStatus=B;var j="";o.locatedIn?j=o.locatedIn:o.deletedFromLocation?j="/"===o.deletedFromLocation[0]?o.deletedFromLocation.substr(1):o.deletedFromLocation:o.ownerCid&&o.ownerCid===p.default.viewerId?j=l.strings.ProductName:o.ownerName&&(j=v.format(l.strings.UsersOneDrive,o.ownerName));var F=o.internalPath;F&&(H.internalPath=F);var I=this._identityDataSource.getIdentity(),q=o.ownerCid||I.id,R=this._getNormalizedId(o);H.id=R;var U="root"===o.id?o.rootResourceId||"root":R,z=o.resourcePartitionCid||q;H.itemId=U;void 0!==o.mruId&&(H.mruState={mruId:o.mruId,app:o.mruApp,type:o.mruType});H.graph={itemId:U,driveId:z,driveType:"personal"};H.statistics={views:o.visitorViews};H.eTag=o.eTag;H.isSharerFolder=o.isSharerFolder;H.parentKey=this._getParentKey(o,{requestKeyParams:k});var W=this._getVirtualItemType(o);H.virtualItemType=W;var X=this._isPhotosRoot(o,{requestKeyParams:k}),V=this._isPhotosSubRoot(o,{requestKeyParams:k,isPhotosRoot:X}),$=this._getIsRootFolder(o,{isPhotosSubRoot:V});H.isRootFolder=$;var J=o.name,K="";H.comments={count:o.commentCount||0};E||(H.isStub=o.isPlaceholder);var Q=o.iconType?m.OfficeIconFileTypeMap[o.iconType.toLowerCase()]:"";H.appMap=Q;var G=this._getItemType(o,Q),Y=o.extension||"";H.extension=Y;H.size=Number(o.size);var Z,ee=o.sharingLevelValue;H.sharingType=ee;H.isBundle=!!o.isBundle;H.locations=o.locations;H.creatorName=o.creatorName;H.caption=o.caption||"";H.itemFromServer=o;(o.photo||o.video||o.isAlbum)&&(Z=o.tags||[]);H.tags=Z;H.ocr=o.ocr;H.urls=o.urls;var te=o.userRole in A?A[o.userRole]:5;if("MountPoint"===o.groupFolderType){te=2;H.mountPoint={}}H.vault=o.vault;H.defaultSubText=this._getDefaultSubText(te,ee,o.sharingLevel);H.location=j;H.ownerId=q;H.ownerName=o.ownerName||"";H.uploadOwnerId=z;H.specialFolderCanonicalName=o.specialFolderCanonicalName||"";H.isSpecialFolder=!!o.isSpecialFolder;var ne={};if($){if(H.ownerId!==p.default.viewerId)J=l.strings.SharedRoot;else{J=this._getRootItemTitle(P);te=0}f&&(H.taskStatus={restoreAllCount:f.restoreAllWorkItemCount,deleteAllCount:f.deleteAllWorkItemCount})}if(f){H.tokenNeedsRedeeming=f.tokenNeedsRedeeming;H.tokenType=f.tokenType}if(o.settings){ne.allPhotosFolderId=o.settings.allPhotosFolderId;ne.allPhotosSortAscending=o.settings.allPhotosSortAscending}o.displayQuotaExceeded&&(ne.quota={display:{exceeded:o.displayQuotaExceeded,remaining:o.displayQuotaRemaining,total:o.displayQuotaTotal,used:o.displayQuotaUsed,size:o.displaySize},exceeded:o.quotaExceeded,remaining:o.quotaRemaining,status:o.quotaStatus,total:o.quotaTotal});ne.ghostId=o.ghostId;if(o.thumbnailSet){H.thumbnail=this._thumbnailProcessor.processThumbnailSet(o.thumbnailSet,o);var re=this._thumbnailProcessor.getProcessFiltersUrl(o.thumbnailSet,o);re&&(H.processFilters={thumbnailUrl:re})}var ie=o.folder;if(ie){var se=[];H.folder={childCount:ie.childCount,documentCount:ie.documentCount,folderCount:ie.folderCount,photoCount:ie.photoCount,totalCount:ie.totalCount,covers:se};var oe=ie.covers;if(oe)for(var ue=0,ae=oe;ue<ae.length;ue++){var fe=ae[ue],le=this._thumbnailProcessor.processThumbnailSet(fe,o);le&&se.push(le)}}var ce,he=o.photo;he&&(ce={width:he.width,height:he.height,cameraMake:he.cameraMake,cameraModel:he.cameraModel,exposureNumerator:he.exposureNumerator,exposureDenominator:he.exposureDenominator,focalLength:he.focalLength,focalRatio:he.focalRatio,iso:he.iso,originalUrl:o.urls[u.default[u.default.open]],displayDateTaken:he.displayDateTaken,dateTaken:he.dateTaken,quality:C.Graft.optional(he.quality?{isBad:he.quality.isBad}:void 0)});H.photo=ce;H.video=o.video;H.audio=o.audio;H.panorama=o.panorama;H.geoLocation=o.location;var pe=o.textEditorMimeType;H.textEditorMimeType=pe;var de=!!o.isAlbum;H.isAlbum=de;var ve,me=o.photo||o.video,ge=M(o.dateModifiedOnClient),ye=M(o.creationDate),be=M(o.lastAccess),we=M(o.dateShared),Ee=M(o.dateDeleted),Se=M(o.dateExpires),xe=me&&M(me.dateTaken),Te=o.displayModifiedDate,Ne=o.displayCreationDate,Ce=o.displayLastAccess,ke=o.displayDateShared,Le=o.displayDateDeleted,Ae=o.displayExpiryDate,Oe=w.isFeatureEnabled(w.EnableUpdatedFilesListView);try{ge&&(Te=Oe?x.getFriendlyDateTimeStringPast(ge):x.getShortDisplayDate(ge));ye&&(Ne=x.getShortDisplayDate(ye));be&&(Ce=x.getShortDisplayDate(be));we&&(ke=x.getShortDisplayDate(we));Ee&&(Le=x.getShortDisplayDate(Ee));Se&&(Ae=x.getShortDisplayDate(Se));xe&&(ve=Oe?x.getFriendlyDateTimeStringPast(xe,!1,!1,!0):x.getShortDisplayDate(xe,!0))}catch(e){}H.dateModifiedValue=o.dateModifiedOnClient;H.dateModifiedTime=H.vault&&H.vault.root?"":ge;H.dateCreatedTime=ye;H.dateAccessedTime=be;H.dateSharedTime=we;H.dateDeletedTime=Ee;H.dateExpiresTime=Se;H.dateModified=H.vault&&H.vault.root?H.vault.isLocked?" ":"Unlocked":Te;H.dateCreated=Ne;H.dateAccessed=Ce;H.dateShared=ke;H.dateDeleted=Le;H.dateExpires=Ae;if(me){H.dateTakenTime=xe;H.dateTaken=ve}H.itemFromServer=o;H.lifeCycleStatus=C.Graft.optional(this._getItemLifeCycleStatus(H));var Me={},_e={};if(o.isAlbumRoot){_e[d.download]=!0;_e[d.share]=!0;_e[d.rename]=!0}if(o.commands)for(var De=o.commands.split(","),Pe=0;Pe<De.length;Pe+=2){De[Pe]in _e||(Me[De[Pe]]=De[Pe+1])}else"root"===H.id&&_===h.default.Search&&(Me[d.defaultClick]="1");if(o.audio){delete Me[d.playAudio];Me[d.defaultClick]="1"}var He,Be,je,Fe=!!Me[d.requestReview];H.isViolation=Fe;H.queryType=_;H.displayType=!ie||1!==ie.category||_===h.default.Files&&$?_:h.default.Photos;H.queryType===h.default.Recent&&$&&(Me[d.defaultClick]="1");if(G===s.default.Folder&&!H.isStub)switch(te){case 0:case 4:case 2:je=H.queryType===h.default.Files||H.queryType===h.default.SharedWithMe&&!$;break;default:je=!1}H.sharingRole=te;H.isDropEnabled=je;H.iconName=g.getIconNameFromItem({type:G,extension:Y,sharingType:ee,textEditorMimeType:pe});H.documentFormat=o.docFormat||0;W===i.default.AlbumRoot&&(J=a.strings.albumsNavLink);F&&(K=y.default.isRightToLeft?F.slice(0).reverse().join(" < "):F.join(" > "));S||(H.isPlaceholder=!1);H.isDraggable=H.queryType===h.default.Files&&!H.mountPoint;if(ie){H.childCount=o.estimatedResultCount||ie.totalCount;H.category=ie.category;He=[];ie.itemGroupings&&(Be=ie.itemGroupings.map(function(e){var r=e.itemGroups,i=n.__rest(e,["itemGroups"]);return n.__assign({},i,{itemGroups:r.map(function(e){return n.__assign({},e,{state:t.observables.create({isCollapsed:!1})})})})}));var Ie={};if(ie.children&&!b)for(var qe=0,Re=ie.children;qe<Re.length;qe++){var Ue=Re[qe],ze=this.processItemResult({observer:T,requestKey:r,itemFromServer:Ue,queryType:_,requestMetadata:f,skipSettingChildren:!1,isPrimaryRequestedItem:!1}).item;He.push(ze);Ie[ze.key]={newTag:this.getNewTagIfExists(Ue),autoAlbumTag:this.getAutoAlbumTagIfExists(Ue)}}if(W===i.default.AlbumRoot){for(var We={groupingId:"newAutoAlbums",count:0,state:this.observables.create({isCollapsed:!0})},Xe=[],Ve=0,$e=[],Je=Math.max(3,10-He.length),Ke=0,Qe=He;Ke<Qe.length;Ke++){var Ge=Qe[Ke],Ye=Ie[Ge.key];if(Ye&&Ye.newTag&&Ye.autoAlbumTag)if(++Ve>Je){Xe.push(Ge);We.count++}else $e.push(Ge);else $e.push(Ge)}We.startIndex=$e.length;He=$e.concat(Xe);var Ze={name:"newAutoAlbumsGrouping",itemGroups:[We]};Be.push(Ze)}}else o.urls&&(o.urls.oneNoteWeb?H.openUrl=o.urls.oneNoteWeb:H.openUrl=o.urls.viewInBrowser);var et=Y&&Y.toLowerCase(),tt=et&&et.slice(1);if(".pdf"===et||".ai"===et&&Me[d.download]){Me[d.defaultClick]="1";H.openUrl=this._urlDataSource.getDownloadItemUrl({key:P,id:U,ownerId:q,extension:Y},FilesConfig.canary,!0);w.isFeatureEnabled(w.UseWebPdfViewer)&&(G=s.default.Media)}var nt,rt,it=p.default.getVroomBaseUrl()+"/drives/"+z+"/items/"+U;if(w.isFeatureEnabled(w.EnableZipFilePreviewing)&&(".zip"===et||".rar"===et)){Me[d.defaultClick]="1";G=s.default.Media;H.zip=C.Graft.optional((nt=tt,(rt=it)?{downloadZipContentsUrl:D("zipcontent",nt,rt),zipMetaDataUrl:D("zipmetadata",nt,rt)}:void 0))}var st=function(e,t){var n=L.canConvert(e),r=L.canRenderNative(e);if(!n&&!r)return;return{canConvert:n,canRenderNative:r,conversionUrl:n&&t?D("glb",e,t)+"&{.authParams}":void 0}}(tt,it);if(st){G=s.default.Media;H.model3d=st;Me[d.defaultClick]="1"}H.type=G;H.thumbnail&&"4"===Me[d.defaultClick]&&(Me[d.defaultClick]="1");!E&&o.isPlaceholder&&(Me[d.defaultClick]="1");if("allmyphotos"===k.qt&&H.id===k.id){Me[d.defaultClick]="1";J=""}var ot=ie?ie.childCount:0;H.name=J;H.displayName=K||""+J+Y;o.estimatedResultCount&&(ot=He.length+(o.folder&&o.folder.startIndex||0));if(o.isRecycled&&o.folder&&!ot){ot=He.length;H.childCount=ot}ne.newTag=this.getNewTagIfExists({tags:Z});ne.autoAlbumTag=this.getAutoAlbumTagIfExists({isAlbum:de,tags:Z});var ut=[P];c&&r&&ut.push(r);e.keyAlias&&ut.push(e.keyAlias);var at=!0;"allmyphotos"===k.qt&&H.id===k.id&&(at=!1);ne.commandsSupported=C.Graft.replace(Me);H.properties=ne;for(var ft=0,lt=N.removeDuplicates(ut);ft<lt.length;ft++){var ct=lt[ft];T.update([new C.Task(ct).succeed({item:at?H:{key:P}})])}var ht=o.hasMoreResults?""+o.estimatedResultCount:"";o.isRecycled&&o.folder&&o.folder.hasMoreRecycledItems&&(ht=o.folder.pagingToken);return{item:{key:P},children:He,groupings:Be,totalChildren:ot,nextRequestToken:ht}}};t.prototype.getAutoAlbumTagIfExists=function(e){var t=null;if(!e.isAlbum)return t;var n=e.tags;if(n)for(var r=0,i=n;r<i.length;r++){var s=i[r];if(s.tag===T.AUTO_ALBUM_TAG){t=s;break}}return t};t.prototype.getNewTagIfExists=function(e){var t=e.tags,n=null;if(t)for(var r=0,i=t;r<i.length;r++){var s=i[r];if(s.tag===T.NEW_ALBUM_TAG){n=s;break}}return n};t.prototype.getItemKey=function(e){var t,r,i,s,o=e.itemFromServer,u=e.requestKey,a=this._urlDataSource.getKeyParams(u);if(o.isAlbumRoot)s=this._urlDataSource.getKey(((t={}).id="albums",t.tagFilter=a.tagFilter,t));else if(o.isTagsRoot)s=this._urlDataSource.getKey(((r={}).id="tags",r));else{var f=this._getItemKeyExtension(o,u),l=o.ownerCid,c=o.internalPath,p=void 0===c?[]:c,d=this._getNormalizedId(o);if(this._urlDataSource.isCurrentQuery(h.default.SharedWithMe,a)&&"1209427492"===o.ownerDCid&&"0000000048166624"===o.ownerCid){d="1209427492";l="0000000048166624"}s=this._urlDataSource.getKey(n.__assign({},f,((i={}).id=d,i.cid=l,i.internalPath=p.join(","),i)))}return s};t.prototype._getDefaultSubText=function(e,t,n){var r;switch(e){case 0:r=t===o.default.Private?"":O.Owner;break;case 1:r=O.CanView;break;case 2:case 4:r=O.CanEdit;break;default:r=""}return r};t.prototype._getItemType=function(e,t){return e.isPlaceholder?s.default.Folder:17===e.itemType?s.default.OneNote:e.folder?s.default.Folder:e.video||e.photo||e.audio?s.default.Media:t?s.default.File:this._isTextEditorFile(e)?s.default.File:e.thumbnailSet?s.default.Media:s.default.File};t.prototype._isTextEditorFile=function(e){return k.canOpenInMonaco(e.extension||"")};t.prototype._getItemKeyExtension=function(e,t){var n,r=this._urlDataSource.getKeyParams(t);return r.id===e.id?r:e.folder?((n={}).ft=r.ft,n.ext=r.ext,n):{}};t.prototype._getRootItemTitle=function(e){return c.strings.Files};t.prototype._getNormalizedId=function(e){return e.id&&e.id.indexOf("!")>=0?e.id.toUpperCase():e.id};t.prototype._getParentKey=function(e,t){var n,r,i=t.requestKeyParams;e.isRecycled&&"root"!==e.id?r=this._urlDataSource.getRootItemKey(h.default.RecycleBin):e.isSharerFolder?r=this._urlDataSource.getRootItemKey(h.default.SharedWithMe):e.isAlbumRoot?r=void 0:e.parentId&&(r=this._urlDataSource.getKey(((n={}).id=e.parentId,n.cid=e.ownerCid,n.ft=i.ft,n.ext=i.ext,n)));return r};t.prototype._getVirtualItemType=function(e){var t;e.isAlbumRoot?t=i.default.AlbumRoot:e.isAlbum?t=i.default.Album:e.isTagsRoot&&(t=i.default.TagsRoot);return t};t.prototype._getIsRootFolder=function(e,t){var n=t.isPhotosSubRoot;return("root"===e.id||e.isAlbumRoot)&&!n};t.prototype._isPhotosRoot=function(e,t){var n=t.requestKeyParams;return"allmyphotos"===n.qt&&e.id===n.id};t.prototype._isPhotosSubRoot=function(e,t){var n=t.requestKeyParams;return t.isPhotosRoot&&(!!n.tagFilter||!!n.locationFilter)};t.prototype._getItemLifeCycleStatus=function(e){var t={};this._isItemLifeCycleStatusNew(e.dateCreatedTime)&&(t.isNew=!0);return t};t.prototype._isItemLifeCycleStatusNew=function(e){var t=(new Date).getTime(),n=e&&e.valueOf();return!isNaN(n)&&t-n<1728e5};return t}(r.default);t.default=_;function D(e,t,n){return"https://southcentralus1-media"+(window.FilesConfig&&window.FilesConfig.df?"s":"p")+".svc.ms/transform/"+e+"?provider=odc&cs=V2VifE9EQw==&inputFormat="+t+"&docid="+encodeURIComponent(n)}});
define("odsp-next/models/item/SharingType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.Public=0]="Public";e[e.PublicUnlisted=2]="PublicUnlisted";e[e.Shared=3]="Shared";e[e.Private=4]="Private";e[e.Unknown=5]="Unknown"}(n||(n={}));t.default=n});
define("@ms/odsp-datasources/lib/interfaces/item/UrlType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.download=0]="download";e[e.open=1]="open";e[e.textContent=2]="textContent";e[e.viewInBrowser=3]="viewInBrowser";e[e.bingClickInstrumentation=4]="bingClickInstrumentation";e[e.original=5]="original";e[e.shortcutTarget=6]="shortcutTarget";e[e.video=7]="video";e[e.downloadAsZip=8]="downloadAsZip";e[e.itemUrl=9]="itemUrl"}(n=t.UrlType||(t.UrlType={}));t.default=n});
define("odsp-next/dataSources/item/odc/SkyApiCommands",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.abdicatePermissions="ab";t.addCoverPhoto="acp";t.applyOfficeLens="aol";t.addTag="at";t.addToAlbum="ata";t.addToSharedList="ats";t.changeExpiration="ce";t.comment="cm";t.copy="cp";t.createExcel="cxls";t.createExcelSurvey="cxlsf";t.createFolder="cf";t.createMountPoint="cmp";t.createOneNote="con";t.createPowerPoint="cppt";t.createWord="cdoc";t.defaultClick="defc";t.deleteCommand="de";t.download="dl";t.editSurvey="ef";t.embed="em";t.emptyRecycleBin="erb";t.modifyCaption="mc";t.move="mv";t.openInOffice="oo";t.openInTextEditor="openInTextEditor";t.openPdfInBrowser="openPdfInBrowser";t.playAudio="pl";t.rearrange="ar";t.removeCoverPhoto="rcp";t.removeFromAlbum="rfa";t.removeFromRecent="rmru";t.removeMountPoint="rmp";t.rename="rn";t.removeOfficeLens="rol";t.reportAbuse="ra";t.requestReview="orr";t.restore="rst";t.restoreAll="rai";t.rotate="rot";t.share="sh";t.shareSurvey="sf";t.upload="up";t.viewInBrowser="vb";t.viewOriginal="vo";t.viewSurvey="pf";t.viewVersions="vv"});
define("odsp-next/dataSources/base/odc/ThumbnailProcessor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","./ISkyApiItem","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-datasources/lib/interfaces/item/UrlType"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=i.SkyApiThumbnailType[i.SkyApiThumbnailType.unRes],a=i.SkyApiThumbnailType[i.SkyApiThumbnailType.doc],f=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});return e.call(this,t)||this}t.prototype.processThumbnailSet=function(e,t){for(var r={},i={},s=0,o=e.thumbnails;s<o.length;s++){var f=o[s];r[f.name]=f;if(0===f.name.indexOf("scaled")){i[f.name.substring("scaled".length).toLowerCase()]=f}}var l,c={thumbnailSet:e,thumbnailsByType:r,thumbnailsBySize:i,item:t},h=r[u],p=r[a];h?l=this._isOriginalThumbnailRequired(t)?this._getOriginalThumbnail(h,c):this._getUnResThumbnail(h,c):p?l=t.video&&t.video.width&&t.video.height?this._getUnResThumbnail(n.__assign({},p,{width:t.video.width,height:t.video.height}),c):t.photo&&t.photo.width&&t.photo.height?this._getUnResThumbnail(n.__assign({},p,{width:t.photo.width,height:t.photo.height}),c):this._getDocThumbnail(p,c):Object.keys(i).length&&(l=this._getScaledThumbnail(c));return l};t.prototype.getProcessFiltersUrl=function(e,t){for(var n,r=0,i=e.thumbnails;r<i.length;r++){var s=i[r];"custom"===s.name&&(n=s)}return n?this._createSizedUrl(e.baseUrl,n.url,{width:n.width,height:n.height}):""};t.prototype._getOriginalThumbnail=function(e,t){var n=t.item.photo.originalUrl||t.item.urls&&t.item.urls[o.default[o.default.download]];return n?{width:t.item.photo.width,height:t.item.photo.height,url:this._createUrlPattern(t.thumbnailSet.baseUrl,e.url),getAligned:function(e,r){return{width:t.item.photo.width,height:t.item.photo.height,url:n}}}:this._getUnResThumbnail(e,t)};t.prototype._getUnResThumbnail=function(e,t){var n=this;return{width:e.width,height:e.height,url:this._createUrlPattern(t.thumbnailSet.baseUrl,e.url),getAligned:function(r,i){return{width:e.width,height:e.height,url:n._createSizedUrl(t.thumbnailSet.baseUrl,e.url,r)}}}};t.prototype._getDocThumbnail=function(e,t){var n=this;return{width:0,height:0,url:this._createUrlPattern(t.thumbnailSet.baseUrl,e.url),getAligned:function(r,i){return{width:0,height:0,url:n._createSizedUrl(t.thumbnailSet.baseUrl,e.url,{width:r.width,height:Math.max(r.height,2048)})}}}};t.prototype._getScaledThumbnail=function(e){var t,n=this,r=[];for(var i in e.thumbnailsBySize){var s=e.thumbnailsBySize[i];switch(i){case"largest":t=s;break;default:r.push(s)}}r.sort(function(e,t){return e.width*e.height-t.width*t.height});t=t||r[r.length-1];var o=e.item.photo||t;return{url:this._createUrl(e.thumbnailSet.baseUrl,t.url),width:o.width,height:o.height,getAligned:function(i,s){for(var u,a=i.width*i.height,f=0,l=r;f<l.length;f++){var c=l[f];if(c.width*c.height>.9*a){u=c.url;break}}return{width:o.width,height:o.height,url:n._createUrl(e.thumbnailSet.baseUrl,u||t.url)}}}};t.prototype._createSizedUrl=function(e,t,n){var r={width:Math.ceil(n.width),height:Math.ceil(n.height)};n.width===n.height&&(r.cropMode="center");return this._createUrl(e,t,r)};t.prototype._createUrlPattern=function(e,t){return this._createUrl(e,t,{width:{uriValue:"{0}"},height:{uriValue:"{1}"},cropMode:"center"})};t.prototype._createUrl=function(e,t,n){void 0===n&&(n={});var r=""+e+t,i=s.serializeQuery(n)?r.indexOf("?")>-1?"&":"?":"";return""+r+i+s.serializeQuery(n)};t.prototype._isOriginalThumbnailRequired=function(e){var t=e.extension,n=void 0===t?"":t,r=e.photo;return".gif"===n.toLowerCase()&&!!r};return t}(r.default);t.default=f});
define("odsp-next/dataSources/base/odc/ISkyApiItem",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.unRes=0]="unRes";e[e.doc=1]="doc"}(t.SkyApiThumbnailType||(t.SkyApiThumbnailType={}))});
define("@ms/odsp-utilities/lib/dateTime/DateTime",["require","exports","tslib","@ms/utilities-date-time/lib/DateTime.resx","./DateTime.resx","../locale/Locale","../string/StringHelper","../features/Features","@ms/utilities-date-time/lib/index","@ms/utilities-date-time/lib/index"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(f,t);var l,c,h,p,d,v,m,g,y,b,w=void 0,E={ODB:1469,ODC:"ChromiumDateFix"};t.getRelativeDateTimeStringPast=function(e,t){void 0===t&&(t=!1);return a.getRelativeDateTimeStringPast(e,x(s.default.language),t)};t.getFriendlyDateTimeStringPast=function(e,t,n,o,u){void 0===t&&(t=!1);void 0===n&&(n=!1);void 0===o&&(o=!1);var f=Date.now()-e.getTime(),l=function(){var e=new Date;e.setHours(0,0,0,0);return e}(),c=k(l,-1),h=k(l,-6),p=u||{},d=p.displayMinutesToOneHour,v=void 0===d||d,m=p.displayHoursToOneDay,g=void 0===m||m,y=p.displayHoursInDates,b=void 0===y||y,w=p.displayShortenedWeekday,E=void 0===w||w,S=x(s.default.language);if(v&&f<-5*a.ONE_MINUTE)return e.toLocaleDateString(S,A({month:"short",day:"numeric"},o));if(f<a.TWO_MINUTES)return n?i.default.FriendlyDateTime_JustNow_withinSentence:i.default.FriendlyDateTime_JustNow_asSentence;if(v&&f<a.ONE_HOUR)return L(f,i.default.FriendlyDateTime_minutesShort,a.ONE_MINUTE);if(a.isSameDay(l,e))return g?L(f,i.default.FriendlyDateTime_hoursShort,a.ONE_HOUR):a.getRelativeDateTimeResx("Today",n);if(e>=c)return t||!b?a.getRelativeDateTimeResx("Yesterday",n):a.getRelativeDateTimeResx("YesterdayAndTime",n).replace("{0}",e.toLocaleTimeString(S,A({hour:"numeric",minute:"2-digit"},o)));if(e>=h){var T=e.toLocaleDateString(S,A({weekday:"short"},o));return t?T:E||b?r.default.RelativeDateTime_DayAndTime.replace("{0}",T).replace("{1}",e.toLocaleTimeString(S,A({hour:"numeric",minute:"2-digit"},o))):e.toLocaleDateString(S,A({weekday:"long"},o))}return a.isSameYear(l,e)?S.match(/(^ja$)|(^ja-{1})/i)?e.toLocaleDateString(S,A({month:"long",day:"numeric"},o)):e.toLocaleDateString(S,A({month:"short",day:"numeric"},o)):e.toLocaleDateString(S,A({month:"short",day:"numeric",year:"numeric"},o))};t.getRelativeDateTimeStringPastWithHourMinute=function(e){return a.getRelativeDateTimeStringPastWithHourMinute(e,x(s.default.language))};function S(){var e=l(),t=T();if(window.Intl&&window.Intl.DateTimeFormat){var n={},r={hour:"2-digit",minute:"2-digit"};h=new Intl.DateTimeFormat(e,n);p=new Intl.DateTimeFormat(e,r);if(t){n.timeZone="UTC";r.timeZone="UTC"}d=new Intl.DateTimeFormat(e,n);v=new Intl.DateTimeFormat(e,r);m=h.format;g=p.format;y=d.format;b=v.format}else{m=y=function(t){return t.toLocaleDateString(e)};g=b=function(t){return t.toLocaleTimeString(e)}}}t.getShortDisplayDate=function(e,t){if(!e)return"";m||S();var n=a.isSameDay(new Date,e);return(t?n?b:y:n?g:m)(e)};t.getFileSafeShortDate=function(e,t){if(!e)return"";m||S();return(t?y:m)(e).replace(/[:\/\\]/g,"-")};t.getFullDisplayDate=function(e,t){m||S();var n=t?y(e):m(e),r=t?b(e):g(e);return o.format(i.default.DateAndTime,n,r)};t.toLocaleDateString=function(e,t){return a.toLocaleDateString(e,x(s.default.language),t)};t.toLocaleTimeString=function(e,t){return a.toLocaleTimeString(e,x(s.default.language),t)};function x(e){if(void 0===w)try{w=u.default.isFeatureEnabled(E)}catch(e){w=!1}return w&&function(e){void 0===C&&function(){C={};var e=new Date(1900,0,1);try{for(var t={month:"long"},n=0,r=N;n<r.length;n++){var i=r[n];e.toLocaleDateString(i,t).match("M[0-9][0-9]")&&(C[i]=!0)}}catch(e){}}();if(e){e=e.toLowerCase();return C[e]}return}(e)?"en":e}t.getBrowserSafeLocale=x;l=function(){for(var e,t=0,n=[window.$Config&&window.$Config.mkt,s.default.language,navigator.language,"en"].filter(function(e){return!!e});t<n.length;t++){var r=n[t];try{(new Date).toLocaleDateString(r);e=r;break}catch(e){}}e=x(e);l=function(){return e};return e};function T(){if(void 0===c)try{var e=l();(new Date).toLocaleDateString(e,{timeZone:"UTC"});c=!0}catch(e){c=!1}return c}var N=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","ha-latn-ng","hy-am","ig-ng","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","si-lk","sq-al","ur-pk","uz-latn-uz","yo-ng","zu-za","pa-arab-pk","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","ky","mk","mn","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku","be","rw","ti"],C=void 0;function k(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function L(e,t,n){var r=Math.round(e/n);return t.replace("{0}",String(r))}function A(e,t){return T()&&t&&e?n.__assign({},e,{timeZone:"UTC"}):e}});
define("@ms/utilities-date-time/lib/index",["require","exports","tslib","./dotNet","./relativePast","./helpers","./iso","./sharePoint"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t)});
define("@ms/utilities-date-time/lib/dotNet",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=621355968e5;t.getDateFromDotNetTicks=function(e){return new Date(e/1e4-n)}});
define("@ms/utilities-date-time/lib/relativePast",["require","exports","@ms/utilities-strings/lib/index","./helpers","./DateTime.resx"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function s(e,t,n){void 0===n&&(n=!1);var i=Date.now()-e.getTime();if(i<-5*r.ONE_MINUTE)return f(e,t);if(i<r.ONE_MINUTE)return o("LessThanAMinute",n);if(i<r.TWO_MINUTES)return o("AboutAMinute",n);if(i<r.ONE_HOUR){return u(Math.floor(i/r.ONE_MINUTE),"XMinutes")}if(i<r.TWO_HOURS)return o("AboutAnHour",n);if(i<r.ONE_DAY){return u(Math.floor(i/r.ONE_HOUR),"XHours")}if(i<r.TWO_DAYS){var s=e.toLocaleTimeString(t);return o("YesterdayAndTime",n).replace("{0}",s)}if(i<r.ONE_MONTH){return u(Math.floor(i/r.ONE_DAY),"XDays")}return f(e,t)}t.getRelativeDateTimeStringPast=s;t.getRelativeDateTimeStringPastWithHourMinute=function(e,t){var o=Date.now()-e.getTime(),u=e.toLocaleDateString(t),a=e.toLocaleTimeString(t,{hour:"numeric",minute:"2-digit"});return o<r.ONE_DAY?s(e,t):o<r.TWO_DAYS?n.format(i.default.RelativeDateTime_YesterdayAndTime,a):n.format(i.default.DateTime_DateAndTime,u,a)};function o(e,t,n,r){return i.default[["RelativeDateTime_",e,n?"Future":"",r?"Intervals":"",t?"_StartWithLowerCase":""].join("")]}t.getRelativeDateTimeResx=o;function u(e,t,r,i){var s=o(t,!!i&&r,i),u=o(t,!1,i,!0);return(n.getLocalizedCountValue(s,u,e)||"").replace("{0}",e+"")}t.getRelativeDateTimeIntervalString=u;var a={};function f(e,t){if("undefined"!=typeof Intl&&Intl.DateTimeFormat){a[t]||(a[t]=new Intl.DateTimeFormat(t));return a[t].format(e)}return e.toLocaleDateString(t)}});
define("@ms/utilities-date-time/lib/helpers",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ONE_SECOND=1e3;t.ONE_MINUTE=60*t.ONE_SECOND;t.TWO_MINUTES=2*t.ONE_MINUTE;t.ONE_HOUR=60*t.ONE_MINUTE;t.TWO_HOURS=2*t.ONE_HOUR;t.ONE_DAY=24*t.ONE_HOUR;t.TWO_DAYS=2*t.ONE_DAY;t.ONE_WEEK=7*t.ONE_DAY;t.ONE_MONTH=32*t.ONE_DAY;t.isSameDay=function(e,n){return e.getDate()===n.getDate()&&Math.abs(n.getTime()-e.getTime())<t.ONE_DAY};t.isSameMonth=function(e,t){return e.getFullYear()===t.getFullYear()&&t.getMonth()===e.getMonth()};t.isSameYear=function(e,t){return e.getFullYear()===t.getFullYear()};t.isThisWeek=function(e,n){n=n||new Date;var r=new Date(n.getTime()-n.getDay()*t.ONE_DAY),i=new Date(r.getTime()+t.ONE_WEEK-t.ONE_DAY);return r.getTime()<=e.getTime()&&e.getTime()<=i.getTime()};t.isLastWeek=function(e,n){n=n||new Date;var r=new Date(n.getTime()-n.getDay()*t.ONE_DAY-t.ONE_WEEK),i=new Date(r.getTime()+t.ONE_WEEK-t.ONE_DAY);return r.getTime()<=e.getTime()&&e.getTime()<=i.getTime()};t.getLastDayOfMonth=function(e){var t=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),1,0,0,0,0));t.setUTCMonth(t.getUTCMonth()+1);t.setUTCDate(t.getUTCDate()-1);t.setUTCHours(23,59,59,999);return t};t.toLocaleDateString=function(e,t,n){if(e)try{return e.toLocaleDateString(t,n)}catch(t){return e.toLocaleDateString([],n)}};t.toLocaleTimeString=function(e,t,n){if(e)try{return e.toLocaleTimeString(t,n)}catch(t){return e.toLocaleTimeString([],n)}}});
define("@ms/utilities-date-time/lib/iso",["require","exports","@ms/utilities-strings/lib/index"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.iso8601DateTimeToJsDate=function(e){return new Date(e)};t.convertDateToISOString=function(e,t){void 0===t&&(t=!1);var r=new Date(e),i=r.getTimezoneOffset()<0,s=r.getFullYear()+"",o=n.leftPad(r.getMonth()+1+"",2),u=n.leftPad(r.getDate()+"",2),a=n.leftPad(r.getHours()+"",2),f=n.leftPad(r.getMinutes()+"",2),l=n.leftPad(r.getSeconds()+"",2),c=(i?"+":"-")+n.leftPad(i?(Math.ceil(r.getTimezoneOffset()/60)+"").replace("-",""):Math.floor(r.getTimezoneOffset()/60)+"",2)+n.leftPad((r.getTimezoneOffset()%60).toString().replace("-",""),2);return t?s+"-"+o+"-"+u+"T"+a+":"+f+":"+l+c:s+o+u+"T"+a+f+l+c}});
define("@ms/utilities-date-time/lib/sharePoint",["require","exports","@ms/utilities-strings/lib/index","./relativePast","./DateTime.resx"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getRelativeDateTimeStringForLists=function(e,t){void 0===t&&(t=!1);var s=e.split("|");if("0"===s[0])return e.substring(2);var o="1"===s[1],u=s[2],a=s[3]||"",f=s[4]||"";switch(u){case"1":return r.getRelativeDateTimeResx("AFewSeconds",t,o);case"2":return r.getRelativeDateTimeResx("AboutAMinute",t,o);case"3":return r.getRelativeDateTimeIntervalString(Number(a),"XMinutes",t,o);case"4":return r.getRelativeDateTimeResx("AboutAnHour",t,o);case"5":return a?n.format(r.getRelativeDateTimeResx(o?"TomorrowAndTime":"YesterdayAndTime",t),a):r.getRelativeDateTimeResx(o?"Tomorrow":"Yesterday",t);case"6":return r.getRelativeDateTimeIntervalString(Number(a),"XHours",t,o);case"7":return f?n.format(i.default.RelativeDateTime_DayAndTime,a,f):a;case"8":return r.getRelativeDateTimeIntervalString(Number(a),"XDays",t,o);case"9":return r.getRelativeDateTimeResx("Today",t)}return null}});
define("odsp-next/dataSources/album/odc/AlbumDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../../resources/ODCResourceKeys","../../base/odc/DataRequest","../../url/odc/UrlDataSource","../../base/odc/BatchRequest","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-datasources/lib/dataSources/upload/Upload","../../base/odc/ISkyApiErrorCodes","../../item/odc/SkyApiErrorHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NEW_ALBUM_TAG="__New";t.AUTO_ALBUM_TAG="__Auto";t.WEEKEND_RECAP_ALBUM_TAG="__WeekendRecap";t.EVENT_RECAP_ALBUM_TAG="__EventRecap";var p=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(s.urlDataSource);return n}t.prototype.addToAlbum=function(e,n){var r={id:e.id,name:null,items:this._getIdsFromKeyArray(n),action:t.ADD_TO_ALBUM_ACTION};return this._handleRequest(n,r)};t.prototype.removeFromAlbum=function(e,n){var r={id:e.id,name:null,items:this._getIdsFromKeyArray(n),action:t.REMOVE_FROM_ALBUM_ACTION};return this._handleRequest(n,r)};t.prototype.createAlbum=function(e,n){var r=this,s=this._getIdsFromKeyArray(n),u=s.slice(0,20),a={id:null,name:e,items:u,action:t.CREATE_ALBUM_ACTION};return(new o.default).send({requestType:"POST",postData:JSON.stringify(a),apiName:t.MODIFY_ALBUM_API_NAME+"."+a.action,url:this._getModifyAlbumUrl(),isErrorExpectedCallback:h.isExpectedSkyApiError}).then(function(e){if(!n||n&&n.length<20)return e;u=s.slice(20);var o={id:e.id,items:u,action:t.ADD_TO_ALBUM_ACTION,name:null};return r._handleRequest(u,o).then(function(t){return e},function(e){var t={errorType:l.UploadErrorType.other,error:new Error(e.data.message)};return i.default.wrapError(t)})},function(e){var t=l.UploadErrorType.other;e.data.code===c.ISkyApiErrorCodes.nameCollision&&(t=l.UploadErrorType.conflict);var n={errorType:t,error:new Error(e.data.message)};return i.default.wrapError(n)})};t.prototype.getWalgreensLandingPageUrl=function(e){var t=this._urlDataSource.getPublishToWalgreensUrl();return(new o.default).sendPostUrlEncoded("PublishToWalgreens",t,JSON.stringify({ids:e}))};t.prototype.createAlbumFromFolder=function(e){var n=this._getModifyAlbumUrl(),r=new o.default,i={id:null,name:e.folder.name,items:[e.folder.id],action:t.CREATE_ALBUM_WITH_RENAME_ACTION};return r.send({apiName:t.MODIFY_ALBUM_API_NAME+"."+i.action,url:n,requestType:"POST",postData:JSON.stringify(i),isErrorExpectedCallback:h.isExpectedSkyApiError})};t.prototype.getAlbumsParentKey=function(e){void 0===e&&(e={});var n,r=((n={}).id=t.ALBUMS_ID,n.cid=this._urlDataSource.getOwnerId(),n.tagFilter=e.tagFilter,n);return f.serializeQuery(r,void 0,!0)};t.prototype.setCoverPhoto=function(e,n){var r=this._getModifyAlbumUrl(),s=new o.default,u={id:e.id,items:[n.id],action:t.SET_COVER_PHOTO_ACTION,name:null};return s.send({apiName:t.MODIFY_ALBUM_API_NAME+"."+u.action,url:r,requestType:"POST",postData:JSON.stringify(u),isErrorExpectedCallback:h.isExpectedSkyApiError}).then(null,function(e){var t=e&&e.data&&e.data.message||"";return i.default.wrapError(t)})};t.prototype._handleRequest=function(e,n){var r=this._getModifyAlbumUrl();return a.default.start({apiName:t.MODIFY_ALBUM_API_NAME+"."+n.action,url:r,batchSize:20,items:e,isErrorExpectedCallback:h.isExpectedSkyApiError,getPostData:function(e){return{id:n.id,name:n.name,items:e,action:n.action}}})};t.prototype._getModifyAlbumUrl=function(){return u.default.skyApiBaseUrl+t.MODIFY_ALBUM_API_NAME};t.prototype._getIdsFromKeyArray=function(e){return e.map(function(e){return f.deserializeQuery(e).id})};t.ADD_TO_ALBUM_ACTION="Add";t.CREATE_ALBUM_ACTION="Create";t.CREATE_ALBUM_WITH_RENAME_ACTION="CreateWithRename";t.REMOVE_FROM_ALBUM_ACTION="Remove";t.SET_COVER_PHOTO_ACTION="SetCoverPhoto";t.MODIFY_ALBUM_API_NAME="ModifyAlbum";t.ALBUMS_ID="albums";return t}(r.default);t.default=p});
define("@ms/odsp-datasources/lib/dataSources/upload/Upload",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.queued=0]="queued";e[e.started=1]="started";e[e.completed=2]="completed";e[e.aborted=3]="aborted";e[e.failed=4]="failed";e[e.none=5]="none"}(t.UploadState||(t.UploadState={}));!function(e){e[e.none=0]="none";e[e.other=1]="other";e[e.general=2]="general";e[e.conflict=3]="conflict";e[e.invalidName=4]="invalidName";e[e.fileSize=5]="fileSize";e[e.emptyFileOrFolder=6]="emptyFileOrFolder";e[e.emptyFileOrFolderForDocLib=7]="emptyFileOrFolderForDocLib";e[e.overQuota=8]="overQuota";e[e.accessDenied=9]="accessDenied";e[e.lockMismatch=10]="lockMismatch";e[e.overQuotaSharedFolder=11]="overQuotaSharedFolder";e[e.folderUploadNotSupported=12]="folderUploadNotSupported";e[e.versionMismatch=13]="versionMismatch";e[e.authFailure=14]="authFailure";e[e.targetFolderMissing=15]="targetFolderMissing";e[e.itemNotFound=16]="itemNotFound";e[e.malwareDetected=17]="malwareDetected";e[e.throttled=18]="throttled";e[e.pathTooLong=19]="pathTooLong";e[e.disconnected=20]="disconnected";e[e.unlockRequired=21]="unlockRequired";e[e.insufficientVaultQuota=22]="insufficientVaultQuota"}(t.UploadErrorType||(t.UploadErrorType={}))});
define("odsp-next/dataSources/base/odc/ISkyApiErrorCodes",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ISkyApiErrorCodes={nameCollision:1e3,fileSizeLimit:2e3,moveIntoMounted:2028,moveIntoOwn:2029}});
define("odsp-next/utilities/array/ArrayHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeDuplicates=function(e){var t;t={};for(var n=[],r=0,i=e;r<i.length;r++){var s=i[r],o=""+s;if(!t[o]){t[o]=!0;n.push(s)}}return n};t.findMatch=function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(t(r))return{value:r,index:n}}}});
define("odsp-next/dataSources/item/ItemTaskObserver",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../models/task/Task","../../models/item/OneDriveItem","../../models/store/ItemsStore","@ms/odsp-utilities/lib/graft/Graft","@ms/odsp-utilities/lib/graft/Graft","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Task=i.default;t.Graft=a;var l=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=n.itemsStore,s=void 0===i?r.resources.consume(o.resourceKey):i;r._itemsStore=s;r._itemUpdatesByKey={};return r}t.prototype.update=function(e,t){void 0===t&&(t=!1);for(var n=0,r=e;n<r.length;n++){var i=r[n];this._processTask(i)}};t.prototype.flush=function(){var e;e={};for(var t=this._itemUpdatesByKey,r=Object.keys(t).filter(function(e){return!!t[e].item}),i=0,o=r;i<o.length;i++){var a=o[i],f=t[a],l=new s.default(a),c=this._getStoreItem(a);if(c){c.parent;var h=n.__rest(c,["parent"]);u.default(l,h)}u.default(l,{revision:0});for(var p=0,d=f.item;p<d.length;p++){var v=d[p];u.default(l,v)}e[a]=l}for(var m=0,g=r;m<g.length;m++){var y=(l=e[a=g[m]]).parentKey;if(y){var b=e[y]||this._getStoreItem(y)||new s.default(y);e[y]=b;l.parent=b}else delete l.parent}this._pushItemsToStore(e);for(var w=0,E=r;w<E.length;w++){a=E[w];delete(f=t[a]).item}};t.prototype.reset=function(){this._itemUpdatesByKey={}};t.prototype.getItem=function(e){var t=e.key;return this._getStoreItem(t)};t.prototype.getChildren=function(e){var t,n,r,i=e.parentKey,s=e.startIndex,o=e.endIndex,u=[],a=this._itemUpdatesByKey[i];if(a){var f=a.set;if(f)if(f.childrenByIndex){s=void 0===(n=(t={startIndex:s,endIndex:o}).startIndex)?f.startIndex:n,o=void 0===(r=t.endIndex)?f.endIndex:r;for(var l=s;l<o;l++){var c=f.childrenByIndex[l],h=this._getStoreItem(c);u.push(h)}}else if(f.childrenBySibling)for(var p={},d="";d=f.childrenBySibling[d];){if(p[d])throw new Error("Circular reference encountered enumerating the children of '"+i+"'.");p[d]=!0;h=this._getStoreItem(d);u.push(h)}}return u};t.prototype._processTask=function(e){var t=e.key,n=e.output,r=n.item,i=n.set,s=this._itemUpdatesByKey,o=s[t];o||(o=s[t]={});if(r){o.item||(o.item=[]);o.item.push(r)}if(i){var u=s[i.parent.key];u||(u=s[i.parent.key]={});u.set||(u.set={});var a=u.set;if(void 0!==i.index){a.childrenByIndex||(a.childrenByIndex=[]);void 0===a.startIndex?a.startIndex=i.index:a.startIndex=Math.min(a.startIndex,i.index);var f=a.childrenByIndex.length;a.childrenByIndex[i.index]=t;void 0===a.endIndex?a.endIndex=i.index+1:a.endIndex>i.index+1?a.endIndex+=a.childrenByIndex.length-f:a.endIndex=Math.max(a.endIndex,i.index+1)}else if(i.after){a.childrenBySibling||(a.childrenBySibling={});a.childrenBySibling[i.after.key]=t}}};t.prototype._getStoreItem=function(e){var t=this._itemsStore.getItem(e);return this.peekUnwrapObservable(t)};t.prototype._pushItemsToStore=function(e){var t={};for(var n in e){(s=t[i=e[(a=e[n]).parentKey]&&a.parentKey||""]||(t[i]=[])).push(n)}for(var r=[""];r.length;){var i,s;if(s=t[i=r.shift()]){for(var o=0,u=s;o<u.length;o++){var a;if(!(a=e[n=u[o]]))throw new Error("Attempted to update the same item multiple times.");this._itemsStore.setItem(a,n)}r.push.apply(r,s)}}};t.dependencies=n.__assign({},r.default.dependencies,{itemsStore:o.resourceKey});return t}(r.default);t.ItemTaskObserver=l;t.resourceKey=new f.ResourceKey({name:e("module").id,factory:new f.ResolvedResourceTypeFactory(l)});t.default=l});
define("odsp-next/models/task/Task",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){if(function(e){return!!e&&"object"==typeof e}(e)){this.key=e.key;this.input=e.input;this.output=e.output;this.status=e.status;this.error=e.error}else{this.key=e;this.input=t;this.status=0}}e.prototype.succeed=function(t){var n=new e(this);n.output=t;n.status=1;delete n.error;return n};e.prototype.fail=function(t){var n=new e(this);n.error=t;n.status=2;return n};e.prototype.cancel=function(){var t=new e(this);delete t.error;t.status=3;return t};e.prototype.restart=function(){return new e(this.key,this.input)};e.prototype.changeInput=function(t){var n=t(this.input),r=new e(this.key,n);r.output=this.output;r.status=this.status;r.error=this.error;return r};e.prototype.changeOutput=function(t){var n=t(this.output),r=new e(this.key,this.input);r.output=n;r.status=this.status;r.error=this.error;return r};e.prototype.compare=function(e){return!e||this.input!==e.input||this.output!==e.output||this.error!==e.error||this.status!==e.status?{previous:e,current:this}:null};return e}();t.default=n});
define("odsp-next/models/item/OneDriveItem",["require","exports","../../dataSources/url/QueryType"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){void 0===e&&(e="");this.isDropEnabled=!1;this.permissions={High:0,Low:0};this.key=e;this.revision=0;this.queryType=n.default.Files;this.displayType=n.default.Files;this.isPlaceholder=!0;this.properties={};this.recycleBinProperties={};this.reputationProperties={};this.statistics={views:0,viewsUnique:0,viewsLast2Weeks:0,viewsLast2WeeksUnique:0,viewsLastWeek:0,viewsLastWeekUnique:0,viewsLastMonth:0,viewsLastMonthUnique:0};this.urls={};this.state={upload:{status:5},removing:!1}};t.default=r});
define("odsp-next/models/store/ItemsStore",["require","exports","tslib","../item/OneDriveItem","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../item/ItemType","../../utilities/array/ArrayHelper","@ms/odsp-utilities/lib/graft/Graft","../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=h.isFeatureEnabled(h.ReadOnlyItemsStore);function d(e){return e&&e.item&&e.item.peek().key}function v(e){e.isExpired=!0;var t=e.content,n=t.peek();n.groupings=null;n.items=[];t.valueHasMutated()}var m=function(e){n.__extends(t,e);function t(){var t=e.call(this,"ItemsStore")||this;t._itemSetsKeys={};t._observables=new s.default({owner:t});t._vaultItemsToPurge=[];window.odstore=t;return t}t.prototype.dispose=function(){this._observables.dispose()};t.prototype.setItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this._handleSetItem.apply(this,[e].concat(t))};t.prototype.getItem=function(e){return this.getValue("item="+e)};t.prototype.setItemSet=function(e,t){var n="result="+e;this.setValue(n,t);this._itemSetsKeys[n]=1};t.prototype.getItemSetFromItemKey=function(e){var t;for(var n in this._itemSetsKeys){var r=(t=this.getValue(n)).content&&t.content.peek(),i=r&&r.items;if(i)for(var s=0,o=i;s<o.length;s++){var u=o[s];if(u&&u.peek().parentKey===e)return t}}};t.prototype.getItemSet=function(e){return this.getValue("result="+e)};t.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice("result=".length));return e};t.prototype.setNextRequestToken=function(e,t,n){var r="token="+t;n?this.setValue(r,n):this.remove(r)};t.prototype.getNextRequestToken=function(e){return this.getValue("token="+e)};t.prototype.invalidateItem=function(e,t){var n=(void 0===t?{}:t).purgeCache,r=void 0!==n&&n;return this._handleItemInvalidation(e,this.getItem(e),r)};t.prototype.invalidateItemSet=function(e){var t=this.getValue("result="+e);t&&v(t)};t.prototype.emptyAllOtherSets=function(e){var t;for(var n in this._itemSetsKeys)(t=this.getValue(n)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&v(t)};t.prototype.invalidateLocation=function(e){var t;for(var n in this._itemSetsKeys){var r=d(t=this.getValue(n));if(r){var i=u.deserializeQuery(r),s=i&&i.locationFilter;s&&s.indexOf(e)>=0&&(t.isExpired=!0)}}};t.prototype.invalidateTag=function(e){var t;for(var n in this._itemSetsKeys){var r=d(t=this.getValue(n));if(r){var i=u.deserializeQuery(r);i&&i.tagFilter===e&&(t.isExpired=!0)}}};t.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var n=(e=this.getValue(t)).item&&e.item.peek();if(n&&n.key&&n.key.indexOf("allmyphotos")>=0){e.isExpired=!0;this._invalidateItem(n)}}};t.prototype.invalidateAllVault=function(){for(var e=0,t=this._vaultItemsToPurge;e<t.length;e++){var n=t[e];if(n.vault){n.vault.isLocked=!0;this._purgeItem(n)}}this._vaultItemsToPurge=[]};t.prototype._handleItemInvalidation=function(e,t,n){if(t){var r=t.peek(),i=!1,s=[];if(r){s.push(r);switch(r.type){case f.default.Folder:case f.default.Media:i=!0}}for(var o in this._itemSetsKeys){var u=this.getValue(o),a=u.item&&u.item.peek(),l=a&&a.key;if(l&&(l===e||i&&l.indexOf("allmyphotos")>-1)){l===e?this.setNextRequestToken(e,u.key,""):s.push(a);u.isExpired=!0}}s.forEach(n?this._purgeItem:this._invalidateItem,this)}};t.prototype._purgeItem=function(e){var t=new r.default(e.key);this.setItem(t)};t.prototype._invalidateItem=function(e){var t=new r.default(e.key);c.default(t,e);c.default(t,{revision:e.revision+1});this.setItem(t)};t.prototype._handleSetItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=[];p&&!Object.isFrozen(e)&&Object.freeze(e);e.vault&&!e.vault.root&&this._vaultItemsToPurge.push(e);for(var i=function(t){var n="item="+t,i=p?"item_write="+t:n,o=s.getValue(n),u=s.getValue(i);if(u)u(e);else{(u=s._observables.create(e)).equalityComparer=a.objectStrictEquality;s.setValue(i,u);o=p?s._observables.pureCompute(function(){return u()}):u;s.setValue(n,o)}r.push(o)},s=this,o=0,u=l.removeDuplicates([e.key].concat(t));o<u.length;o++){var f=u[o];i(f)}return r[0]};return t}(i.default);t.ItemsStore=m;t.resourceKey=new o.ResourceKey({name:e("module").id,factory:new o.SimpleResourceFactory(m)});t.default=m});
define("@ms/odsp-utilities/lib/graft/Graft",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.none=0]="none";e[e.replace=1]="replace";e[e.optional=2]="optional";e[e.remove=3]="remove";e[e.backup=4]="backup"}(t.GraftOperationType||(t.GraftOperationType={}));t.remove=function(){return{graftOperationType:3}};t.optional=function(e){return{graftOperationType:2,value:e}};t.backup=function(e){return{graftOperationType:4,value:e}};t.replace=function(e){return{graftOperationType:1,value:e}};t.default=function e(t,f){if(!n(t))throw new Error("Value for 'base' passed to 'graft' is not an object.");if(!n(f))throw new Error("Value for 'extension' passed to 'graft' is not an object");if(f===t)return t;for(var l=0,c=Object.keys(f);l<c.length;l++){var h=c[l],p=f[h],d=t[h];if(p!==d){var v=p;if(s(v))if(1===v.graftOperationType){d=void 0;p=m=v.value}else if(o(v)){var m=v.value;if(void 0!==t[h])continue;p=m}else{if(!a(v)){if(u(v)){delete t[h];continue}throw new Error("Unknown patch specified for grafting. Only use exported functions from Graft to create patches.")}if(void 0===(m=v.value))continue;p=m}var g=void 0;if(r(p))g=new Date(p.getTime());else if(i(p)){var y=d;i(y)||(y=[]);y.splice.apply(y,[0,y.length].concat(p));g=y}else if(n(p)){var b=d;n(b)||(b={});e(b,p);g=b}else g=p;t[h]=g}}return t};function n(e){return"object"==typeof e&&!!e}function r(e){return e instanceof Date}function i(e){return Array.isArray(e)}function s(e){return n(e)&&!!e.graftOperationType}function o(e){return 4===e.graftOperationType}function u(e){return 3===e.graftOperationType}function a(e){return 2===e.graftOperationType}});
define("@ms/odsp-microservice/lib/microService/helpers/BabylonSupport",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["glb","gltf"],r=["cool","fbx","obj","ply","stl","3mf"];function i(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}t.canConvert=function(e){return i(r,e)};t.canRenderNative=function(e){return i(n,e)}});
define("odsp-next/dataSources/item/DeletionType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.Recycle=2]="Recycle";e[e.PermanantDelete=3]="PermanantDelete";e[e.MoveToSecondStage=4]="MoveToSecondStage"}(n||(n={}));t.default=n});
define("@ms/odsp-datasources/lib/interfaces/list/DocumentType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.Word=1]="Word";e[e.Excel=2]="Excel";e[e.PowerPoint=3]="PowerPoint";e[e.OneNote=4]="OneNote";e[e.ExcelSurvey=5]="ExcelSurvey";e[e.Text=6]="Text";e[e.ExcelForm=7]="ExcelForm";e[e.Visio=8]="Visio";e[e.Bohemia=9]="Bohemia";e[e.Prague=10]="Prague"}(n=t.DocumentType||(t.DocumentType={}));t.default=n});
define("odsp-next/dataSources/item/odc/ColumnsHelper",["require","exports","tslib","knockout","../../../models/item/ItemType","@ms/odsp-datasources/lib/interfaces/list/ColumnFieldType","../../../dataSources/url/QueryType","./ODCDataSource.resx","../../../controls/infoPane/InfoPane.resx","@ms/odsp-utilities/lib/locale/Locale","../../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getColumns=function(e,t,r){void 0===r&&(r={});var f;if(r){var h=function(e,t){var r,i=t.consume(c.platformDetection).isMobile&&!!t.consume(l.useMobileList.optional),f=n.__assign({},d("type","","FileTypeIcon",!1),{minWidth:i?48:16,width:i?48:16,isIcon:!0,fieldType:s.ColumnFieldType.FileIcon}),h=m(!0),E=b(!0),S=g(),x=v(!0),T=n.__assign({},d("_shareHeroCommand","","_shareHeroCommand",!1),{isIcon:!0,minWidth:16,width:16,fieldType:s.ColumnFieldType.ShareCommand}),N=m(!1),C=b(!1),k=v(!1),L=i?p(f,[[h],[E,x,S]],[h,E,x,S]):("userArranged"===e?[y()]:[]).concat([f,h],w()?[T]:[],[E,S,x]),A=n.__assign({},d("dateTaken",a.strings.informationDateTaken,"dateTaken",!0),{fieldType:s.ColumnFieldType.DateTime}),O=i?p(f,[[h],[E,x,S]],[h,E,A,x,S]):("userArranged"===e?[y()]:[]).concat([f,h],w()?[T]:[],[E,A,S,x]),M=n.__assign({},d("dateAccessed",u.strings.SchemaColumnLastOpened,"dateAccessed",!0),{fieldType:s.ColumnFieldType.DateTime}),_=n.__assign({},d("location",u.strings.SchemaColumnLocation,"",!1),{showTooltip:!0}),D=i?p(f,[[h],[M,x,S]],[h,M,x,S]):[f,h,M,E,_,x],P=g(),H=[f,h,P,x],B=[f,h,P,x],j=i?p(f,[[N],[C,k,S]],[N,C,k,S]):[f,N,S,C,_,k],F=n.__assign({},d("location",u.strings.SchemaColumnOriginalLocation,"location",!0),{width:300,showTooltip:!0}),I=n.__assign({},d("dateDeleted",u.strings.SchemaColumnDateDeleted,"dateDeleted",!0),{fieldType:s.ColumnFieldType.DateTime}),q=i?p(f,[[h],[x,I,F]],[h,I,x,F]):[f,h,F,I,x];return(r={})[o.default.Files]=L,r[o.default.Photos]=O,r[o.default.Recent]=D,r[o.default.SharedWithMe]=H,r[o.default.DocsInCommon]=B,r[o.default.Search]=j,r[o.default.RecycleBin]=q,r}(r.defaultSortField,t);e.type===i.default.Folder&&(f=h[e.displayType]||h[o.default.Files]);f&&(f=f.map(function(e){return n.__assign({},e,r.isSortEnabled?(e.internalName||e.key)===r.sortField?{isSorted:!0,isAscending:r.isAscending}:{isSorted:!1}:{sortable:!1})}))}return f};function p(e,t,r){for(var i=[],s=0;s<t.length;s++)for(var o=0,u=t[s];o<u.length;o++){var a=u[o];i.push(n.__assign({},a,{customRowNumber:s}))}for(var f=[e,n.__assign({},d("","","",!1),{width:900,customFields:i})],l=0,c=r;l<c.length;l++){var h=c[l];f.push(n.__assign({},h,{isVisible:!1,isVisibleMobile:!1}))}return f}function d(e,t,n,i,o){return{key:e,name:t,internalName:n,minWidth:90,width:130,isVisible:!0,isVisibleMobile:!0,isCollapsable:!0,sortable:i,isSorted:!1,isIcon:!1,isHtml:!1,isAscending:!0,fieldType:s.ColumnFieldType.Text,filterable:!1,isFocused:r.observable(!1)}}function v(e){return n.__assign({},d("size",u.strings.SchemaColumnSize,"size",e),{isHtml:!0,fieldType:s.ColumnFieldType.FileSize,sortable:e})}function m(e){return n.__assign({},d("displayName",u.strings.SchemaColumnName,"displayName",e),{isCollapsable:!1,minWidth:220,width:440,fieldType:s.ColumnFieldType.Name,sortable:e,hasListItemMenu:!0})}function g(){return n.__assign({},d("defaultSubText",u.strings.SchemaColumnSharing,"",!1),{fieldType:s.ColumnFieldType.Shared})}function y(){return n.__assign({},d("",u.strings.SchemaColumnUserArranged,"userArranged",!0),{isVisible:!1,isVisibleMobile:!1})}function b(e){var t=w()?u.strings.SchemaColumnModified:u.strings.SchemaColumnDateModified;return n.__assign({},d("dateModified",t,"dateModified",e),{sortable:e,sortDescFirst:e,fieldType:s.ColumnFieldType.DateTime},"ml"===(""+f.default.language).toLowerCase()?{width:150}:{})}function w(){return h.isFeatureEnabled(h.EnableUpdatedFilesListView)}});
define("@ms/odsp-datasources/lib/interfaces/list/ColumnFieldType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.Text=0]="Text";e[e.Hyperlink=1]="Hyperlink";e[e.Image=2]="Image";e[e.User=3]="User";e[e.Boolean=4]="Boolean";e[e.DateTime=5]="DateTime";e[e.Currency=6]="Currency";e[e.Counter=7]="Counter";e[e.Number=8]="Number";e[e.Note=9]="Note";e[e.Computed=10]="Computed";e[e.Name=11]="Name";e[e.FileSize=12]="FileSize";e[e.Shared=13]="Shared";e[e.SharedWith=14]="SharedWith";e[e.FileIcon=15]="FileIcon";e[e.DotDotDot=16]="DotDotDot";e[e.Tag=17]="Tag";e[e.Lookup=18]="Lookup";e[e.Taxonomy=19]="Taxonomy";e[e.Hashtag=20]="Hashtag";e[e.Attachments=21]="Attachments";e[e.AverageRating=22]="AverageRating";e[e.Title=23]="Title";e[e.WorkflowStatus=24]="WorkflowStatus";e[e.ProgressBar=25]="ProgressBar";e[e.RatedBy=26]="RatedBy";e[e.Ratings=27]="Ratings";e[e.LikedBy=28]="LikedBy";e[e.Likes=29]="Likes";e[e.ComplianceRecordFlag=30]="ComplianceRecordFlag";e[e.Custom=31]="Custom";e[e.Activity=32]="Activity";e[e.Choice=33]="Choice";e[e.ClientSideCustom=34]="ClientSideCustom";e[e.FileActivity=35]="FileActivity";e[e.MruName=36]="MruName";e[e.ShareCommand=37]="ShareCommand";e[e.PinCommand=38]="PinCommand";e[e.Thumbnail=39]="Thumbnail";e[e.ImageSize=40]="ImageSize";e[e.Location=41]="Location";e[e.Geolocation=42]="Geolocation"}(n=t.ColumnFieldType||(t.ColumnFieldType={}));t.default=n});
define("odsp-next/dataSources/base/odc/ItemErrorProcessor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../models/item/ItemType","../../item/ItemDataSource.resx","@ms/odsp-utilities/lib/string/StringHelper","../../item/ItemTaskObserver"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.processError=function(e){var t,n=e.requestKey,r=e.error,s=e.itemName,o=e.observer;switch(r&&r.data&&r.data.code||0){case 101:case 102:case 103:case 152:t=1;break;case 161:t=7;break;case 162:t=8;break;case 200:t=4;break;case 201:t=5;break;case 202:t=3;break;case 3e3:case 10009:t=2;break;case 3403:t=6;break;case 9017:break;default:t=0}var a=this.getError(r,s);o.update([new u.Task(n).succeed({item:{key:n,type:i.default.Error,error:{type:t,data:a},isPlaceholder:!1,properties:{commandsSupported:{defc:"1"}}}})]);return{error:a,key:n}};t.prototype.getError=function(e,t){var n,r,i,u=e&&e.data&&e.data.code||0;switch(u){case 209:n=s.strings.ThrottledItemTitle;r=s.strings.ThrottledItemSubText;break;case 509:n=s.strings.StorageBandwidthLimitViewTitle;break;case 1e3:n=s.strings.DuplicateName;break;case 1006:n=s.strings.InvalidChar;break;case 2005:case 2006:n=s.strings.LengthExceeded;break;case 3e3:n=s.strings.ItemNotFoundTitle;r=s.strings.ItemNotFoundSubText;break;case 9001:n=o.format(s.strings.ItemInUse,t);break;case 9006:n=s.strings.SharingBlockedVisitorViewTitle;break;default:n=s.strings.DefaultTitle;r=s.strings.DefaultSubText}161===u&&(i=e&&e.data&&e.data.exceptionData&&e.data.exceptionData.fixItUrl||null);return{errorCode:u,errorTitle:n,errorDetailedText:r,actionUrl:i}};return t}(r.default);t.default=a});
define("odsp-next/dataSources/item/odc/MoveCopyDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/odc/DataRequest","../../url/odc/UrlDataSource"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getCapabilities=function(){this._capabilities||(this._capabilities={supportsMoveCopy:!0,supportsMoveCopyOnShared:!0,supportsMoveCopyFilterParams:!1,supportsCopyCrossSite:!1,supportsMoveCrossSite:!1,supportsThrottling:!1,supportsProgressCaching:!1});return this._capabilities};t.prototype.copyItemsAsync=function(e){return this._handleMoveCopyAsyncApiRequest(e,this._getCopyItemsAsyncUrl())};t.prototype.hasMatchingId=function(e,t){return!0};t.prototype._handleMoveCopyAsyncApiRequest=function(e,t){var n=new i.default,r=u(e);return n.send({apiName:"CopyItemsAsync",url:t,requestType:"POST",postData:JSON.stringify(r),isErrorExpectedCallback:function(e){switch(e.errorCode){case 2001:return!0;default:return!1}}})};t.prototype._getCopyItemsAsyncUrl=function(){return s.default.skyApiBaseUrl+"CopyItemsAsync"};return t}(r.default);t.default=o;function u(e){return{items:e.items.map(function(e){return e.id}),targetId:e.targetId,cid:e.cid,group:e.group,nameConflict:e.nameConflict,deleteSource:e.deleteSource,overrideLock:e.overrideLock}}t.convertMoveCopyContextToPostData=u});
define("@ms/odsp-utilities/lib/async/Semaphore",["require","exports","./Promise","./Signal"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){this.concurrency=e||1;this._running=0;this._queue=[];this._promiseComplete=this._promiseComplete.bind(this)}e.prototype.enqueue=function(e){var t;if(this._running<this.concurrency){this._running++;(t=e()).then(this._promiseComplete,this._promiseComplete)}else{var i={callback:e,signal:null,canceled:!1,result:null};i.signal=new r.default(function(){i.canceled=!0;n.default.is(i.result)&&i.result.cancel()});this._queue.push(i);t=i.signal.getPromise()}return n.default.resolve(t)};e.prototype._promiseComplete=function(){var e=this;this._running--;if(this._running<this.concurrency&&this._queue.length){for(var t=this._queue.shift();t&&t.canceled;)t=this._queue.length?this._queue.shift():null;if(t){this._running++;t.result=t.callback();t.result.then(function(n){t.signal.complete(n);e._promiseComplete()},function(n){t.signal.error(n);e._promiseComplete()})}}};return e}();t.default=i});
define("odsp-next/dataSources/ransomwareDetection/odc/RansomwareDetectionDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./RansomwareDetectionDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/restore/odc/RestoreOperationDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./RestoreOperationDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/restoreActivities/odc/RestoreActivitiesDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./RestoreActivitiesDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/search/odc/SearchDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./SearchDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/item/odc/RecycleBinDataSource",["require","exports","tslib","../../../controls/leftPane/LeftPane.resx","./SkyApiItemDataSource","../../../models/item/ItemType","../../url/odc/UrlDataSource","../../url/QueryType","../DeletionType","@ms/odsp-utilities/lib/async/Promise","../../base/odc/DataRequest","../ItemTaskObserver"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=u.default[u.default.RecycleBin].toLowerCase(),p=function(e){n.__extends(t,e);function t(){var t=e.call(this)||this,n=t._urlDataSource.getRootItemKey(u.default.RecycleBin),r=t.getRootItemTitle(n),i=new(t.resources.consume(c.resourceKey));i.update([new c.Task(n).succeed({item:{key:n,type:s.default.Folder,id:t._getRootFileId(),queryType:u.default.RecycleBin,displayType:u.default.RecycleBin,name:r,displayName:r}})]);i.flush();return t}t.prototype.getItem=function(t){var n=this;return e.prototype.getItem.call(this,t).then(function(e){return f.default.wrap(e)},function(r){if(9017===r.errorCode){n.isLargeRecycleBin(!0);return e.prototype.getItem.call(n,t)}return f.default.wrapError(r)})};t.prototype.emptyRecycleBin=function(e,t){t&&this.isLargeRecycleBin(!0);return this._deleteNextBatch(e,t)};t.prototype.emptyRecycleBinAsync=function(){return this._deleteAll()};t.prototype.getRootItemTitle=function(e){return r.strings.RecycleBin};t.prototype._getItemKeyExtension=function(t,n){var r;return t.id!==this._getRootFileId()?((r={}).u=h,r):e.prototype._getItemKeyExtension.call(this,t,n)};t.prototype._deleteAll=function(){var e=o.default.skyApiBaseUrl+"DeleteAll";return(new l.default).sendPost("DeleteAll",e,"")};t.prototype._deleteNextBatch=function(t,n){var r=this,i=this._urlDataSource.getRootItemKey(u.default.RecycleBin);return e.prototype.getItem.call(this,{parentKey:i,startIndex:0,pageSize:100}).then(function(s){if(s.children&&s.children.length)return e.prototype.deleteItems.call(r,{parentKey:i,deletionType:a.default.PermanantDelete,items:s.children}).then(function(){if(s.nextRequestToken||n){t(t()+s.children.length);return r._deleteNextBatch(t,n)}})})};return t}(i.default);t.default=p});
define("odsp-next/dataSources/language/odc/LanguageDataSource",["require","exports","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(){}e.prototype.getCurrentLanguage=function(){return n.default.language||$Config.lang};e.prototype.getCurrentLanguageCode=function(){return $Config.mkt};return e}();t.default=i;t.resourceKey=r.createResolvedResourceKey(e("module").id,i,{})});
define("odsp-next/dataSources/languagePicker/odc/LanguagePickerDataSource",["require","exports","@ms/odsp-utilities/lib/xhr/XHRPromise","@ms/odsp-utilities/lib/resources/Resources","../../language/odc/LanguageDataSource"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){this._languageDataSource=t.languageDataSource;this._startXHR=t.startXHR||n.default.startAndPostProcess}e.prototype.getLanguages=function(){var e=this;return this._startXHR({url:"/GetLanguageList"},function(t,n){var r=JSON.parse(t.responseText),i=r.Canary,s=r.LanguageInfoList,o=[];for(var u in s)s.hasOwnProperty(u)&&o.push(s[u]);var a=e._languageDataSource.getCurrentLanguage();return{languageList:o,canary:i,currentLanguage:a=a&&a.toLowerCase()}})};e.prototype.saveLanguage=function(e,t){var n="canary="+encodeURIComponent(t)+"&lang="+e;return this._startXHR({url:"/handlers/languagesave.mvc?"+n,json:n},function(e,t){return e.responseText})};return e}();t.default=s;t.resourceKey=r.createResolvedResourceKey(e("module").id,s,{languageDataSource:i.resourceKey})});
define("odsp-next/dataSources/leftNav/odc/LeftNavDataSource",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","../../../utilities/features/Features","@ms/odsp-utilities/lib/logging/ErrorHelper","@ms/odsp-datasources/lib/Permissions","../../url/PageType","../../url/QueryType","../../../resources/ODCResourceKeys","../../../controls/leftNav/LeftNav.resx","./ODCLeftNavDataSource.resx","../../../dataSources/base/odc/DataRequest","../../../controls/leftPane/LeftPane.resx","../../../resources/DataSourceResourceKeys","../../../resources/ProviderResourceKeys","./NotificationLinks","../../../utilities/attribution/AttributionHelper","../../../controls/fluentStyling/FluentStyling.key","../../../utilities/icons/Icon"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=h.strings,S=function(e){n.__extends(t,e);function t(){var t,n=e.call(this)||this;n.mapPageToLeftNavSections=((t={})[a.default.StorageInfo]=[4,3],t[a.default.StorageOptions]=[4,3],t[a.default.PhotoPreferences]=[4,3],t[a.default.ManageVault]=[4,3],t[a.default.Restore]=[4,3],t[a.default.AppData]=[4,3],t[a.default.Files]=[0,1,2],t[a.default.Photos]=[0,1,2],t[a.default.TextFileEditor]=[0,1,2],t);n._urlDataSource=n.resources.consume(l.urlDataSource);n._identity=n.resources.consume(v.identity).getIdentity();n._attributionHelper=n.resources.consume(y.resourceKey);n._userInfoProvider=n.resources.consume(m.userInfo);n._linkGroups=r.observableArray([]);n._notificationLinks=new(n.managed(g.default));n.needsBottomPadding=n._notificationLinks.needsBottomPadding;n._isFluentEnabled=n.resources.consume(b.resourceKey);n._isVaultHidden=r.observable(!0);return n}t.prototype.getLinkGroups=function(e){var t=this._urlDataSource.getPageType();if(!(t===this._previousPage||this._previousPage!==a.default.Files&&this._previousPage!==a.default.Photos||t!==a.default.Files&&t!==a.default.Photos)){this._previousPage=t;return this._linkGroups}this._previousPage=t;this._linkGroups.removeAll();if(this._isPartApplicable(0)){this._getNavLinks(e);this._linkGroups.push(this._navLinks)}this._isPartApplicable(1)&&this._identity.type===u.IdentityType.msa&&this._getDevices();if(this._isPartApplicable(3)){this._checkIsVaultEnabled();this._getOptions(e);this._linkGroups.push(this._optionsLinks)}return this._linkGroups};t.prototype.getNotificationLinks=function(){var e=this._notificationLinks.items;this._isPartApplicable(2)?this._notificationLinks.populateItems():this._notificationLinks.clearItems();return e};t.prototype._isPartApplicable=function(e){var t=this._urlDataSource.getPageType(),n=this.mapPageToLeftNavSections[t];return n&&-1!==n.indexOf(e)};t.prototype._getNavLinks=function(e){var t=this,n={text:"OneDrive",url:this._urlDataSource.getFilesQueryUrl(),isExpanded:r.observable(!0),isActive:this.createPureComputed(function(){e();return t._urlDataSource.isCurrentQueryFiles()}),isFocused:r.observable(!1),automationId:"LeftNav-OneDriveGrouping",links:r.observableArray([{text:d.strings.Files,automationId:"FilesPageLink",url:this._urlDataSource.getFilesQueryUrl(),isActive:this.createPureComputed(function(){e();return t._urlDataSource.isCurrentQueryFiles()}),isFocused:r.observable(!1),altText:c.strings.filesAlt,engagementName:"Files",icon:this._isFluentEnabled?new w.default("FabricFolder"):void 0},{text:d.strings.Recent,url:this._urlDataSource.getRecentQueryUrl(),isActive:this.createPureComputed(function(){e();return t._urlDataSource.isCurrentQueryRecent()}),isFocused:r.observable(!1),altText:c.strings.recentAlt,engagementName:"Recent",icon:this._isFluentEnabled?new w.default("History"):void 0},{text:d.strings.Photos,automationId:"PhotosPageLink",url:this._urlDataSource.getAllMyPhotosQueryUrl(),isActive:this.createPureComputed(function(){e();return t._urlDataSource.isCurrentQuery(f.default.Photos)}),isFocused:r.observable(!1),altText:c.strings.photosAlt,engagementName:"Photos",icon:this._isFluentEnabled?new w.default("Photo2"):void 0},{text:d.strings.Shared,url:this._urlDataSource.getSharedByQueryUrl(),isActive:this.createPureComputed(function(){e();return t._urlDataSource.isCurrentQuerySharedByMe()||t._urlDataSource.isCurrentQuerySharedWithMe()}),isFocused:r.observable(!1),altText:c.strings.sharedAltOdc,engagementName:"Shared",icon:this._isFluentEnabled?new w.default("People"):void 0},{text:d.strings.RecycleBin,url:this._urlDataSource.getRecycleBinQueryUrl(),isActive:this.createPureComputed(function(){e();return t._urlDataSource.isCurrentQueryRecycleBin()}),isFocused:r.observable(!1),altText:c.strings.recycleBinAlt,engagementName:"RecycleBin",icon:this._isFluentEnabled?new w.default("RecycleBin"):void 0}])};this._navLinks=n};t.prototype._getOptions=function(e){var t=this,n=this._attributionHelper.getPurchaseAttribution({source:"LeftNavPageList",cta:"UpgradePage"});this._optionsLinks={text:E.Options,url:this._urlDataSource.getNewManageStorageUrl(),isExpanded:r.observable(!0),isActive:this.createPureComputed(function(){e();return t._urlDataSource.getPageType()===a.default.StorageInfo}),isFocused:r.observable(!1),automationId:"LeftNav-OptionsGrouping",links:r.observableArray([{text:d.strings.NewManageStorage,url:this._urlDataSource.getNewManageStorageUrl(),isActive:this.createPureComputed(function(){e();return t._urlDataSource.getPageType()===a.default.StorageInfo}),isFocused:r.observable(!1),altText:d.strings.NewManageStorage},{text:d.strings.PlansAndUpgrades,url:this._urlDataSource.getUpgradeOptionsUrl(n),isActive:this.createPureComputed(function(){e();return t._urlDataSource.getPageType()===a.default.StorageOptions}),isFocused:r.observable(!1),altText:d.strings.PlansAndUpgrades},{text:E.OfficeFileFormats,url:this._urlDataSource.getOfficeFileOptionsUrl(),isActive:this.createPureComputed(function(){e();return!1}),isFocused:r.observable(!1),altText:E.OfficeFileFormats},{text:E.Vault,url:this._urlDataSource.getManageVaultUrl(),isActive:this.createPureComputed(function(){return t._urlDataSource.getPageType(e())===a.default.ManageVault}),isFocused:r.observable(!1),isHidden:this._isVaultHidden,altText:E.Vault},{text:E.Photos,url:this._urlDataSource.getPhotoPreferencesUrl(),isActive:this.createPureComputed(function(){return t._urlDataSource.getPageType(e())===a.default.PhotoPreferences}),isFocused:r.observable(!1),altText:E.Photos},{text:E.Tagging,url:this._urlDataSource.getPhotosOptionsUrl(),isActive:this.createPureComputed(function(){e();return!1}),isFocused:r.observable(!1),altText:E.Tagging},{text:E.Notifications,url:this._urlDataSource.getNotificationOptionsUrl(),isActive:this.createPureComputed(function(){e();return!1}),isFocused:r.observable(!1),altText:E.Notifications},{text:E.DeviceBackups,url:this._urlDataSource.getDeviceBackupsOptionsUrl(),isActive:this.createPureComputed(function(){e();return!1}),isFocused:r.observable(!1),altText:E.DeviceBackups},{text:E.Restore,url:this._urlDataSource.getNewRestoreOptionsUrl("PROD_OneDrive-Web_LeftNav_AppDataLink"),isActive:this.createPureComputed(function(){e();return t._urlDataSource.getPageType()===a.default.Restore}),isFocused:r.observable(!1),altText:E.Restore},{text:E.AppData,url:this._urlDataSource.getNewAppDataOptionsUrl("PROD_OneDrive-Web_LeftNav_AppDataLink"),isActive:this.createPureComputed(function(){e();return t._urlDataSource.getPageType()===a.default.AppData}),isFocused:r.observable(!1),isHidden:r.observable(!s.isFeatureEnabled(s.EnableManageAppDataPage)),altText:E.AppData},{text:E.Search,url:this._urlDataSource.getSearchOptionsUrl(),isActive:this.createPureComputed(function(){e();return!1}),isFocused:r.observable(!1),altText:E.Search}])}};t.prototype._checkIsVaultEnabled=function(){var e=this;this._userInfoProvider.getUserFact(46).then(function(t){t&&e._isVaultHidden(!1)})};t.prototype._getDevices=function(){var e=this,t=this._urlDataSource.getDevicesApiUrl();(new p.default).send({apiName:"GetDevices",url:t}).then(function(t){var n=t.devices;n&&e._isPartApplicable(1)&&n[0]&&e._navLinks.links.push({text:d.strings.Devices,url:e._urlDataSource.getDevicesPageUrl(),isActive:r.observable(!1),isFocused:r.observable(!1),openInNewTab:r.observable(!0)})},function(e){o.default.log(e,"GetDevices")})};return t}(i.default);t.default=S});
define("odsp-next/dataSources/leftNav/odc/NotificationLinks",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","../../../utilities/features/Features","../../../models/quota/QuotaStatus","../../../models/quota/QuotaEventSource","../../../actions/NavigationAction","../../../resources/ODCResourceKeys","../../../controls/leftPane/LeftPane.resx","../../../resources/ControlResourceKeys","../../../models/quota/QuotaEventDestination","../../../resources/ProviderResourceKeys","./ODCLeftNavDataSource.resx","../../../controls/leftNav/leftNavSublink/templates/Button.html"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._urlDataSource=t.resources.consume(f.urlDataSource);t._bundleLoader=t.resources.consume(p.bundleLoader);t._viewParams=t.resources.consume(c.viewParams);t._appsLink=t._getAppsLink();t._confidentialText=t._getConfidentialText();t.items=r.observableArray([]);t.needsBottomPadding=t.createObservable(!1);t._populate=t.createObservable(!1);t._isSearchPassThrough=t.createPureComputed(t._computeIsSearchPassThrough);t._quotaLoaded=t.createPureComputed(t._computeQuotaLoaded);t._items=t.createPureComputed(t._computeItems);t.createBackgroundComputed(t._updateItems);t._showUpsellBanner=t.createObservable(!1);t._userInfoProvider=t.resources.consume(p.userInfo.optional);t._storageOptionsProvider=t.resources.consume(p.storageOptions);t._isPremiumEligible=t.createPureComputed(t._computeIsPremiumEligible);return t}t.prototype.populateItems=function(){this._populate(!0)};t.prototype.clearItems=function(){this._populate(!1)};t.prototype._computeIsPremiumEligible=function(){return this._storageOptionsProvider.isReady()?this._storageOptionsProvider.isEligibleForPremium():null};t.prototype._computeQuotaLoaded=function(){if(this._bundleLoader.getBundleInfo(3).isLoaded()){if(!this._userStateProvider){this._userStateProvider=this.resources.consume(p.quota);this._quotaBarComponent=this._getQuotaBarComponent();this._overQuotaWarning=this._getOverQuotaWarning();this._premiumUpsellComponent=this._getPremiumUpsellComponent()}return!0}return!1};t.prototype._computeIsSearchPassThrough=function(){return this._urlDataSource.isSearchPassThrough(this._viewParams())};t.prototype._computeItems=function(){var e=this._computeBaseItems();window.FilesConfig&&(FilesConfig.df||FilesConfig.int)&&e.push(this._confidentialText);this._showUpsellBanner()&&this._quotaLoaded()&&e.indexOf(this._appsLink)>=0&&e.unshift(this._getAppUpsellComponent());return e};t.prototype._computeBaseItems=function(){if(!this._populate()){this.needsBottomPadding(!1);return[]}if(!this._quotaLoaded()){this.needsBottomPadding(!0);return[this._appsLink]}var e=this._userStateProvider.status(),t=this._userStateProvider.canUpgrade(),n=1===this._userStateProvider.accountState(),r=this._isSearchPassThrough(),i=e!==o.default.unknown&&e<o.default.critical&&(!t||this._isPremiumEligible()),u=s.isFeatureEnabled(s.EnableQuotaUxChanges),a=!1,f=!1,l=!1;if(u){f=this._userStateProvider.isSoftLocked();a=this._userStateProvider.isGoingToBeLockedSoon();l=this._userStateProvider.isTemporararilyUnfrozen()}var c=[],h=!1;if((n||f)&&(!r||u)){c.push(this._quotaBarComponent);h=!0}var p=l||a||f,d=!p&&(!r||u)&&e>=o.default.overQuota;if(n&&d){this.needsBottomPadding(!1);c.push(this._overQuotaWarning);h=!0}else this.needsBottomPadding(!0);if(!p&&t&&!i&&!d){var v=this._getUpgradeLink();(r||e===o.default.normal)&&(v.renderAs=this._appsLink.renderAs);c.push(v)}var m=e>=o.default.full||!t&&e===o.default.critical;p||r||!n||d||!m||c.push(this._getCleanUpLink());i&&c.push(this._premiumUpsellComponent);e<o.default.critical&&c.push(this._appsLink);h&&s.isFeatureEnabled(s.QuotaExpLogging)&&this._userStateProvider.recordExposureToQuotaUx();return c};t.prototype._updateItems=function(){var e,t=this._items(),n=this.items.peek();t.length?(e=this.items).splice.apply(e,[0,n.length].concat(t)):this.items.removeAll()};t.prototype._getOverQuotaWarning=function(){return{isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:10,component:{name:"od-over-quota",params:{}}}};t.prototype._getQuotaBarComponent=function(){return{isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:10,component:{name:"od-quota-bar",params:{}}}};t.prototype._getPremiumUpsellComponent=function(){return{isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:10,component:{name:"od-premium-upsell-banner",params:{}}}};t.prototype._getUpgradeLink=function(){var e=this,t=this._userStateProvider.getNavigationUrl(u.default.leftNav,h.default.upgrade);return{text:l.strings.Upgrade,url:t,isActive:this.createObservable(!1),isFocused:this.createObservable(!1),action:new(this.managed(a.default))({beforeNavigation:function(){e._userStateProvider.logEvent(u.default.leftNav,h.default.upgrade)},url:t}),renderAs:6}};t.prototype._getAppUpsellComponent=function(){var e=this;return{isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:10,component:{name:"od-app-upsell",params:{message:d.strings.AppUpsellMessage,buttonText:d.strings.AppUpsellButtonText,action:new(this.managed(a.default))({url:"https://aka.ms/xhkpi9"}),onDismiss:function(){e._showUpsellBanner(!1);e._userInfoProvider.setUserInfo(7,3,null,"26C6F29F-016D-4309-8FA2-1C9B8151AFC9")}}}}};t.prototype._getAppsLink=function(){var e=this._urlDataSource.getOneDriveAppsUrl();return{text:l.strings.GetOneDriveApps,url:e,action:new(this.managed(a.default))({url:e,target:"_blank"}),isActive:this.createObservable(!1),isFocused:this.createObservable(!1),openInNewTab:this.createObservable(!0),renderAs:6,engagementName:"GetOneDriveApps"}};t.prototype._getCleanUpLink=function(){var e=this,t=this._userStateProvider.getNavigationUrl(u.default.leftNav,h.default.cleanUpFiles);return{text:l.strings.cleanUpFiles,url:t,action:new(this.managed(a.default))({beforeNavigation:function(){e._userStateProvider.logEvent(u.default.leftNav,h.default.cleanUpFiles)},url:t}),isActive:this.createObservable(!1),isFocused:this.createObservable(!1),openInNewTab:this.createObservable(!1),renderAs:6}};t.prototype._getConfidentialText=function(){return{isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:2,text:"Microsoft Confidential"}};return t}(i.default);t.default=v});
define("odsp-next/models/quota/QuotaStatus",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.unknown=-1]="unknown";e[e.normal=0]="normal";e[e.critical=1]="critical";e[e.full=2]="full";e[e.outOfSpace=3]="outOfSpace";e[e.overQuota=4]="overQuota"}(n||(n={}));t.default=n});
define("odsp-next/models/quota/QuotaEventSource",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.update=0]="update";e[e.leftNav=1]="leftNav";e[e.quotaBlock=2]="quotaBlock";e[e.frozenBlock=3]="frozenBlock";e[e.manageStorage=4]="manageStorage";e[e.lockedBlock=5]="lockedBlock";e[e.dragAndDrop=6]="dragAndDrop";e[e.premiumLeftNav=7]="premiumLeftNav";e[e.quotaBanner=8]="quotaBanner"}(n||(n={}));t.default=n});
define("odsp-next/actions/NavigationAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../resources/ControlResourceKeys","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="Navigation";var i=t.url,s=t.viewParams,a=t.target,f=void 0===a?"_top":a,l=t.forceNavigation,c=void 0!==l&&l,h=t.ignoreHistory,p=t.beforeNavigation,d=t.afterNavigation,v=t.postProcessUrl,m=n.navigation,g=void 0===m?r.resources.consume(o.navigation):m,y=n.viewParamsObservable,b=void 0===y?r.resources.consume(u.viewParams):y;r._navigation=g;r._viewParams=b;r._url=r.wrapObservable(i);r._inputViewParams=r.wrapObservable(s);r._target=r.wrapObservable(f);r._forceNavigation=c;r._ignoreHistory=h;r._beforeNavigation=p;r._afterNavigation=d;r._postProcessUrl=v;return r}t.prototype.onExecute=function(e,t){var n=this._url.peek(),r=this._inputViewParams.peek(),o=this._beforeNavigation;o&&o(this._navigation);var u=this._postProcessUrl?this._postProcessUrl(n):n;(this._forceNavigation||n)&&this._navigation.navigateTo({url:u,viewParams:r,frameId:this._target.peek(),ignoreHistory:this._ignoreHistory});this._afterNavigation&&this._afterNavigation(this._navigation);return i.default.wrap({resultType:s.ResultTypeEnum.Success})};t.prototype.onIsAvailable=function(){var e=this._url();if(!e)return!1;if(this._forceNavigation)return!0;var t=this._inputViewParams(),n=this._viewParams(),r="#"+a.serializeQuery(n),i=t&&0===t.indexOf("#")?t.substring(1):"",s=i+(i?"&":"")+(0===e.indexOf("#")?e.substring(1):"");if(s){var o=a.deserializeQuery(s);return!f.deepCompare(n,o)}return e!==r};t.dependencies={resources:l.resourceScopeKey,navigation:o.navigation,viewParamsObservable:u.viewParams};return t}(r.default);t.default=c;t.typeResourceKey=l.createResolvedTypeResourceKey(e("module").id,c)});
define("odsp-next/base/BaseAction",["require","exports","tslib","@ms/odsp-shared/lib/utilities/logging/events/Action.event","@ms/odsp-utilities/lib/logging/events/UsageType","@ms/odsp-shared/lib/base/BaseModel","../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/ErrorHelper","../dataSources/url/PageType","../dataSources/url/QueryType","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ProviderResourceKeys","../providers/engagement/Engagement","@ms/utilities-error/lib/ApiError"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="BaseAction";var i=r,s=i.resources,u=i.observables,a=n.urlDataSource,f=void 0===a?s.consume(o.url.optional):a,l=n.instrumentationProvider,c=void 0===l?s.consume(h.instrumentation.optional):l;r._BaseAction_urlDataSource=f;r._BaseAction_instrumentationProvider=c;r.isQosLogged=!0;r.logStartEnd=!1;r._executingInstanceCount=u.create(0);var p={deferEvaluation:!0};r.isAvailable=u.pureCompute(r._computeIsAvailable,p);r.isToggled=u.pureCompute(r._computeIsToggled,p);r.isExecuting=u.pureCompute(r._computeIsExecuting,p);return r}t.prototype.execute=function(e){var t,n,r=this,i=this.isQosLogged?this.onCreateQosEvent(e):void 0;try{if(!(t=this.onExecute(e,i)))throw new Error("Action did not return a promise")}catch(e){a.default.log(e);n=e}if(t){this._executingInstanceCount(this._executingInstanceCount.peek()+1);t.then(function(e){r._executingInstanceCount(r._executingInstanceCount.peek()-1);if(i){r._logEngagementEvent(i.data.extraData);r.trackUserAction(r.name);i.end(e)}},function(t){r._executingInstanceCount(r._executingInstanceCount.peek()-1);t&&!u.default.isCanceled(t)&&a.default.log(t);if(i){r._logEngagementEvent(i.data.extraData);i.end(r.onCreateErrorEventArg(e,t,!1))}})}else{i&&i.end(this.onCreateErrorEventArg(e,n,!0));t=u.default.reject(n)}return t};t.prototype.onCreateQosEvent=function(e){var t=this._BaseAction_urlDataSource;return new r.Action({name:this.name,pageType:t&&f.default[t.getPageType()]||"",queryType:t&&l.default[t.getQueryType()]||"",logStartEnd:this.logStartEnd})};t.prototype.onCreateErrorEventArg=function(e,t,n){return t&&u.default.isCanceled(t)?{resultType:c.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"}:t instanceof d.ApiError?{resultType:t.isExpected?c.ResultTypeEnum.ExpectedFailure:c.ResultTypeEnum.Failure,resultCode:t.code,error:t.message,extraData:{CorrelationId:t.correlationId}}:{resultType:c.ResultTypeEnum.Failure,resultCode:n?"NoPromiseReturned":"PromiseFailed",error:t?""+(t.message||""):void 0}};t.prototype.onExecute=function(e,t){var n={resultType:c.ResultTypeEnum.Failure};return u.default.resolve(n)};t.prototype.onIsAvailable=function(){return!0};t.prototype.onIsToggled=function(){return!1};t.prototype.getEngagement=function(){return this.resources.consume(p.resourceKey)};t.prototype.trackUserAction=function(e){var t=this._BaseAction_instrumentationProvider;if(t){var n=this.getEngagement();t.userExecuteAction({name:e,engagement:n})}};t.prototype._computeIsAvailable=function(){return!!this.onIsAvailable()};t.prototype._computeIsToggled=function(){return!!this.onIsToggled()};t.prototype._computeIsExecuting=function(){return this._executingInstanceCount()>0};t.prototype._logEngagementEvent=function(e){if(this.isQosLogged){var t=this._BaseAction_instrumentationProvider;this.getEngagement().logData({name:this.name,isIntentional:this.isExecutionIntentional,location:"NA",usageType:i.UsageType[i.UsageType.Click],currentPage:t&&t.currentPageName()||"NA",previousPage:t&&t.previousPageName()||"NA",extraData:n.__assign({},e||{},t&&t.getEngagementData()||{})})}};t.dependencies=n.__assign({},s.default.dependencies,{urlDataSource:o.url,instrumentationProvider:h.instrumentation.optional});return t}(s.default);t.default=v});
define("@ms/odsp-shared/lib/utilities/logging/events/Action.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/logging/events/ResultTypeEnum"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ResultTypeEnum=i.ResultTypeEnum;t.Action=n.createPairedEvent({eventName:"Action,Qos,",shortEventName:"Action",samplingFeature:{ODB:!0,ODC:"ActionEventLogging",Fallback:!1}},{pageType:1,queryType:1,logStartEnd:3},r.Qos);t.default=t.Action});
define("@ms/odsp-utilities/lib/logging/events/UsageType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Click=1]="Click";e[e.Tap=2]="Tap";e[e.Keyboard=3]="Keyboard";e[e.Drop=4]="Drop"}(t.UsageType||(t.UsageType={}))});
define("@ms/utilities-error/lib/ApiError",["require","exports","tslib","./CustomError"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(n){var r=e.call(this,n)||this,i=n.innerError,s=i instanceof t?{correlationId:i.correlationId,isExpected:i.isExpected,code:i.code}:{},o=n.correlationId,u=void 0===o?s.correlationId:o,a=n.isExpected,f=void 0===a?s.isExpected:a,l=n.code,c=void 0===l?s.code:l;r.correlationId=u;r.isExpected=!!f;r.code=c||"ApiError";return r}return t}(r.CustomError);t.ApiError=i});
define("@ms/utilities-error/lib/CustomError",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){void 0===e&&(e={});var t=new Error(e.message||e.innerError&&e.innerError.message);this.message=t.message;this.innerError=e.innerError;for(var n in this)Object.prototype.hasOwnProperty.call(this,n)&&(t[n]=this[n]);var r=Object.getPrototypeOf(this);Error.captureStackTrace&&Error.captureStackTrace(t,r);if(Object.setPrototypeOf){Object.setPrototypeOf(t,r);return t}};t.CustomError=n;if(Object.setPrototypeOf){n.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}});Object.setPrototypeOf(n,Error)}});
define("odsp-next/models/quota/QuotaEventDestination",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.unknown=0]="unknown";e[e.none=1]="none";e[e.learnMore=2]="learnMore";e[e.upgrade=3]="upgrade";e[e.cleanUpFiles=4]="cleanUpFiles";e[e.manageStorage=5]="manageStorage";e[e.wac=6]="wac";e[e.officePlans=7]="officePlans"}(n||(n={}));t.default=n});
define("odsp-next/controls/leftNav/leftNavSublink/templates/Button.html",[],function(){return'<button class="LeftNav-Button od-Button" role=menuitem data-bind="attr: { tabindex: $component.isLeftNavVisible() ? 0: -1, \'aria-label\': text }, automation: $data.automationId, click: $component.onClick.bind($component)"><span class=od-Button-label data-bind="text: text"></span></button>'});
define("odsp-next/utilities/attribution/AttributionHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../resources/ProviderResourceKeys","../../models/quota/QuotaStatus","@ms/odsp-utilities/lib/uri/Uri","@ms/odsp-utilities/lib/resources/Resources","../../utilities/purchaseLogging/AwaHelper"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new a.ResourceKey("attributionHelper");var l=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._navigation=n.resources.consume(i.navigation);n._viewParams=n._navigation.viewParams;return n}t.prototype.appendPurchaseAttributionAndLogAction=function(e,t){return this.appendPurchaseAttribution(e,t)};t.prototype.appendPurchaseAttribution=function(e,t){var n=new u.default(t),r=this._viewParams.ocid||this._viewParams["WT.mc_id"];r||(r=this.getPurchaseAttribution(e));n.setQueryParameter("ocid",r);return n.toString()};t.prototype.getPurchaseAttribution=function(e){var t=this._viewParams.ocid||this._viewParams["WT.mc_id"];if(t)return t;var n=this._getUserState();return"PROD_OneDrive-"+(e.attributionEndpoint||"Web")+"_"+e.source+"_"+n+"_"+e.cta};t.prototype.logAttributionViaAWA=function(e){void 0===e&&(e={});f.default.logPagePurchaseAction(n.__assign({},e))};t.prototype._convertStatus=function(e){switch(e){case o.default.normal:return"Normal";case o.default.critical:return"Critical";case o.default.full:return"Full";case o.default.overQuota:case o.default.outOfSpace:return"OverLimit";default:case o.default.unknown:return"Unknown"}};t.prototype._getUserState=function(){return this._isUserStateProviderAvailable()&&this._userStateProvider.status?this._convertStatus(this._userStateProvider.status.peek()):"Unknown"};t.prototype._isUserStateProviderAvailable=function(){this._userStateProvider=this.resources.consume(s.quota.optional);this._bundleLoader=this.resources.consume(s.bundleLoader.optional);if(this._bundleLoader){return this._bundleLoader.getBundleInfo(3).isLoaded()}return!1};return t}(r.default);t.default=l});
define("odsp-next/utilities/purchaseLogging/AwaHelper",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/modules/ModuleLoader","@ms/odsp-utilities/lib/require/RequireConfigInjector","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=2048,a=/authkey=[!a-zA-Z0-9%]*/gi,f=/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi;function l(e){if(e){(e=decodeURIComponent(e+"")).length>u&&(e=e.substring(0,u));e=e.replace(a,"").replace(f,"")}return e}var c=window.$Config&&window.$Config.mkt,h=function(){function e(){}e.init=function(){var t,n=new o.Qos({name:"LoadAwaLibrary"});s.default.addPaths(((t={}).AWALIB="https://az725175.vo.msecnd.net/scripts/jsll-4",t));return i.loadModule({path:"AWALIB",getModule:function(){return new r.default(function(e,t){window.require(["AWALIB"],e,t)})}}).then(function(){var t={autoCapture:{onLoad:!1,onUnload:!1,click:!1,addIn:!1,jsError:!1,perf:!1,eventTooLong:!1},coreData:{appId:"OneDrive",market:c,referrerUri:l(document.referrer),requestUri:l(document.location.href),uri:l(document.location.href),title:"OneDrive"},cookiesToCollect:["_mkto_trk"],syncMuid:!0,ix:{a:!0,g:!0}};window.awa.init(t);e.hasBeenInitialized=!0;n.end({resultType:o.ResultTypeEnum.Success})},function(e){n.end({resultType:o.ResultTypeEnum.Failure})})};e.logPagePurchaseAction=function(e){var t=n.__assign({},e,{behavior:awa.behavior.ADDTOCART});this.logEvent(t,function(e){awa.ct.captureContentPageAction(e)})};e.logPageViewed=function(e){this.logEvent(e,function(e){awa.ct.capturePageView(e)})};e.logEvent=function(t,r){var i=n.__assign({},t,{uri:this._getFullCleanUrl(t.uri||document.location.href),referrerUri:this._getFullCleanUrl(t.referrerUri||document.referrer)});e.hasBeenInitialized?r(i):e.init().done(function(){r(i)})};e._getFullCleanUrl=function(e){void 0===e&&(e="");var t=e;"#"===t.charAt(0)&&(t=e.replace("#",document.location.origin+"?"));return l(t)};e.hasBeenInitialized=!1;return e}();t.default=h});
define("odsp-next/dataSources/peoplePicker/odc/PeoplePickerDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/string/EmailAddressParser","../../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getCapabilities=function(){return{supportsMruCaching:!1}};t.prototype.search=function(e,t){return this.resources.consumeAsync(o.peopleService).then(function(t){return t.getContacts(e)}).then(function(e){return e.map(function(e){var t="",n=e.emailAddresses;if(n&&n.length>0)for(var r=0,i=n;r<i.length;r++){var s=i[r];if(s&&s.address&&s.address.length>0){t=s.address;break}}return{userId:e.displayName,name:e.displayName,email:t}})})};t.prototype.resolve=function(e,t){var n,r=this,s=function(){if(n){n.cancel();n=void 0}};return new i.default(function(o,u){var a=function(e){s();o(e)};n=i.default.timeout(2e3).then(function(){a(r._getPersonFromQuery(e))});r.search(e,t).then(function(t){0===t.length?a(r._getPersonFromQuery(e)):a(t[0])},function(t){a(r._getPersonFromQuery(e))})},s)};t.prototype.getPersonaDetails=function(e){return null};t.prototype.subscribePresence=function(e,t){return{dispose:function(){}}};t.prototype.getPickerEntityInformation=function(e){return null};t.prototype._getPersonFromQuery=function(e){var t=new s.default(e),n={};if(t.getEmail()){n.name=t.getName()||"";n.image="";n.sharingInfo={type:0};n.isResolved=!0}n.email=t.getEmail()||e;return n};return t}(r.default);t.default=u});
define("@ms/odsp-utilities/lib/string/EmailAddressParser",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(t){var n;this._raw=t;if(t){t=(t=t.replace(/\u200e|\u200f/g,"")).trim();for(var r,i,s=new RegExp(e.EmailRegexPattern,"gi"),o=e.EmailMatchTypes.None,u=e.EmailMatchTypes.None;null!=(i=s.exec(t));){var a=i[0],f=a.charAt(0),l=a.charAt(a.length-1);if((u="<"===f&&">"===l?e.EmailMatchTypes.Bracketed:'"'===f&&'"'===l?e.EmailMatchTypes.Quoted:e.EmailMatchTypes.Bare)>o){r=i;o=u;if(u===e.EmailMatchTypes.Bracketed)break}}var c=t;if(r){n=r[0];var h=r.index,p=h+n.length,d=h>0?t.substr(0,h).trim():"",v=p<t.length?t.substr(p):"";if("'"===(n=e.StripBracketsAndQuotesRegex.exec(n)[1]).charAt(0)&&v&&"'"===v.charAt(0)){n=n.slice(1);v=v.slice(1).trim()}c=""===d?v:d;this._email=n.trim()}(c=c.replace(/^\s*"\s*/,"").trim()).length>1&&"/"!==c.charAt(c.length-2)&&(c=c.replace(/\s*"$/,""));""!==(c=c.replace(/\//g,""))&&c!==n&&(this._name=c)}}e.isValidEmailSyntax=function(t,n){return!!t&&!!(n?e.ValidEmailRegex:e.EmailRegex).exec(t.trim())};e.parse=function(t){if(!t)return[];for(var n=e._splitAddresses(t),r=[],i=0,s=n.length;i<s;i++)r.push(new e(n[i]));return r};e.endsWithDelimiter=function(t){if(t){var n=t.split(e.DelimiterRegex);return!n[n.length-1].trim()}return!1};e._splitAddresses=function(t){for(var n=t.split(e.DelimiterRegex),r=n.length-1;r>=0;r--){n[r]=n[r].trim();0===n[r].length&&n.splice(r,1)}return n};e.prototype.getEmail=function(){return this._email};e.prototype.getName=function(){return this._name};e.prototype.getRaw=function(){return this._raw};e.EmailRegexPattern="(?:[<\"]\\s*)?[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9\\u0080-\\uFFFF!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?\\.)+[a-z0-9\\u0080-\\uFFFF](?:[a-z0-9\\u0080-\\uFFFF-]*[a-z0-9\\u0080-\\uFFFF])?(?:\\s*[>\"])?";e.EmailRegex=new RegExp(e.EmailRegexPattern,"i");e.ValidEmailRegexPattern="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@((?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)";e.ValidEmailRegex=new RegExp(e.ValidEmailRegexPattern,"i");e.StripBracketsAndQuotesRegex=/^[<"]?([^<>"]*)[>"]?$/;e.DelimiterRegex=/[,;](?=(?:[^"]*"[^"]*")*(?![^"]*"))/;e.EmailMatchTypes={None:0,Quoted:1,Bare:2,Bracketed:3};return e}();t.default=n});
define("odsp-next/dataSources/sharing/odc/SharingDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/dateTime/DateTime","../SharingDataSource.resx","../../../models/item/ItemHelper","../../base/odc/DataRequest","../../base/odc/requestHandlers/SkyApiRequestHandler","@ms/odsp-utilities/lib/string/StringHelper","../../../resources/ODCResourceKeys","./SharingDataHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._sharingDataHelper=new(t.managed(h.default));t._urlDataSource=t.resources.consume(c.urlDataSource);return t}t.prototype.manageSharingLinks=function(e,t){var n=this,r=t.name||t.link&&t.link.name,s=t.id||t.link&&t.link.id,o=t.link&&t.link.entityType||3,u=t.expiration,a=t.password,f=[t.person||{userId:s,name:void 0,email:void 0,sharingInfo:{item:e[0].item,role:t.role,type:o,userId:s}}],l={items:e.map(function(e){return e.item}),sendEmail:t.create,roleValue:this._sharingDataHelper.convertToSharingRole(t.create?t.role:5)},c={modifyPermissions:!t.create,link:{linkType:t.type,linkName:r}};u&&(c.link.expirationDateTime=u);void 0!==a&&(c.link.password=a);return this._setPermissions(f,l,c).then(function(e){return n._sharingDataHelper.getSharingLinks(e,{})},function(e){return e.people?n._sharingDataHelper.getSharingLinks([e],{}):i.default.wrapError(e)})};t.prototype.share=function(e,t){return this._setPermissions(e,t,{modifyPermissions:!1}).then(function(e){return{statusCode:0,errorMessage:"",people:e[0].people,itemId:e[0].item.id}},function(e){return e.people?e:i.default.wrapError(e)})};t.prototype.unshare=function(e){return this.updatePermissions(null,e,5)};t.prototype.updatePermissions=function(e,t,n,r){var s={items:[t],roleValue:this._sharingDataHelper.convertToSharingRole(n),sendEmail:!1,expiration:r};return this._setPermissions(e,s,{modifyPermissions:!0}).then(function(t){return{statusCode:0,errorMessage:"",people:5===n?e.map(function(e){e.sharingInfo.role=5;return e}):t[0].people}},function(e){return e.people?e:i.default.wrapError(e)})};t.prototype._setPermissions=function(e,n,r){var s=this,o={message:n.message,requireSignIn:n.requireSignIn,suppressNotification:!n.sendEmail,userAction:r.modifyPermissions?1:0,entities:[]},u=n.items;u&&u.length||(u=[]);if(u.length>1){var f=u.map(function(e){return s._urlDataSource.getKeyParams(e.key).id});o.ids=f;o.bundleName=this._getBundleName(u)}else{var l=u[0],c=this._urlDataSource.getKeyParams(l.key);o.id=c.id}for(var h=0;h<e.length;h++){var p=e[h],d={role:n.roleValue,type:0,email:p.email};p.sharingInfo&&(d.id=p.sharingInfo.userId);n.expiration&&(d.expirationDateTime=n.expiration);n.password&&(d.password=n.password);if(r.link){d.type=p.sharingInfo&&p.sharingInfo.type||3;d.linkType=r.link.linkType;d.linkName=r.link.linkName;d.expirationDateTime=r.link.expirationDateTime;d.password=r.link.password;p.sharingInfo&&(d.id=p.sharingInfo.userId)}else if(!p.email&&p.sharingInfo){d.id=p.userId;d.type=p.sharingInfo.type}else p.sharingInfo&&p.sharingInfo.type&&(d.type=p.sharingInfo.type);if(3===p.entityType){d.clientId=p.userId;if(r.link){d.type=3;d.linkType=4}else{d.type=7;d.expiry=1}delete d.email}o.entities.push(d)}var v=JSON.stringify(o);return(new a.default).send({apiName:"SetPermissions",url:t._ShareUrl,requestType:"POST",postData:v,isErrorExpectedCallback:function(e){switch(e.errorCode){case 1007:return!0;case 3006:case 3007:case 3009:case 3012:case 3033:case 3034:case 3035:case 3036:case 3037:return!0;default:return!1}}}).then(function(e){if(e.permissions&&e.permissions.permissionScopes)return e.permissions.permissionScopes.map(function(e){return s._sharingDataHelper.getSharingScope(u,e)});if(e.primaryError&&e.primaryError.code){var t=e.errorResult.entity;return i.default.wrapError({statusCode:e.primaryError.code,errorMessage:e.primaryError.message,people:[s._sharingDataHelper.transformEntity(t,{statusCode:0,role:s._sharingDataHelper.parseEntityRole(t),type:void 0,userId:t.id||t.clientId})]})}return i.default.wrapError(e)},function(e){return e.data?i.default.wrapError(e.data):i.default.wrapError(e)})};t.prototype._getBundleName=function(e){var t="";if(e&&e.length){for(var n,r=e[0].parent,i=o.strings.BundleNameShared,a=s.getFileSafeShortDate(new Date),f=!0,c=!0,h=0,p=e;h<p.length;h++){var d=p[h];if(d.photo&&!d.video)c=!1;else{if(!u.isOfficeDoc(d.extension)){c=f=!1;break}f=!1}}n=f?"Photos":c?"Documents":"Items";r&&!r.isRootFolder&&!r.isSpecialFolder&&r.name&&(i=l.format(o.strings.BundleNameFolderName,r.name,"{0}","{1}"));t=l.format(i,o.strings["BundleNameType"+n],a)}return t};t._ShareUrl=f.SKY_API_DOMAIN+"/API/2/SetPermissions";return t}(r.default);t.default=p});
define("odsp-next/models/item/ItemHelper",["require","exports","../../models/item/ItemType","./Item.resx","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-datasources/lib/interfaces/list/DocumentType"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r.strings,u=["docx","doc","docm","dotm","dotx","xlsx","xlsb","xls","xlsm","pptx","ppsx","ppt","pps","pptm","potm","ppam","potx","ppsm","pdf"],a="Doc",f="One",l="Ppt",c="Xls",h="Vsd",p="Lib",d={WinDocuments:p,WinLibrary:p,WinMusic:p,WinPictures:p,WinPodcastLibrary:p,WinVideos:p,WinDrive:"Drive",CDDrive:"CDDrive",GenericDrive:"Drive",UsbDrive:"USBDrive",ExternalDrive:"ExtDrive",NetworkStorage:"NetDrive",Accdb:"Mdb",Doc:a,Docm:a,Docx:a,Dot:a,Dotm:a,Dotx:a,Exe:"Exe",Html:"Html",Mdb:"Mdb",Mpp:"Mpp",Mpt:"Mpp",Odp:l,Ods:c,Odt:a,One:f,Onepkg:f,Onetoc2:f,Notebook:"OneNotebook",Pot:l,Potm:l,Potx:l,Ppa:l,Ppam:l,Pps:l,Ppsm:l,Ppsx:l,Ppt:l,Pptm:l,Pptx:l,Pub:"Pub",Rtf:"Rtf",Txt:"Txt",Vdw:h,Vsd:h,Vsdm:h,Vsdx:h,Vsl:h,Vss:h,Vssm:h,Vssx:h,Vst:h,Vstm:h,Vstx:h,Xaml:"Xaml",Xla:c,Xlam:c,Xll:c,Xls:c,Xlsb:c,Xlsm:c,Xlsx:c,Xlt:c,Xltm:c,Xltx:c,Xml:"Xml",Xps:"Xps",Xsn:"Xsn",Zip:"Zip"};t.getFriendlyItemType=function(e,t,r){var s=e.extension,u=s&&s.slice("."===s[0]?1:0),a=u&&u.toUpperCase(),f=v(e.itemFromServer&&e.itemFromServer.iconType||u);return e.isDocSet?o.fileTypeDocSet:f||e.type!==n.default.Folder?r||(e.panorama?o.fileTypePanorama:e.photo&&!e.video?i.format(o.fileTypeImage,a||"").trim():f?o["fileType"+f]:a?i.format(o.fileTypeUnknown,a):t?o.listItemType:o.fileTypeNoExtension):o.fileTypeFolder};t.getShortcutFileType=function(e){var t=e.slice(e.lastIndexOf(".")+1);return i.format(o.shortcutFileTypeFormat,t.length!==e.length?this.getShortcutFileTypeFromExtension(t):o.fileTypeNoExtension)};t.getShortcutFileTypeFromExtension=function(e){var t=o.fileTypeNoExtension;if(!e)return t;var n=v(i.capitalize(e));if(n)return o["fileType"+n];var r=e.toUpperCase();return r?i.format(o.fileTypeUnknown,r):t};function v(e){return d[e]}t.getNormalizedExtension=v;t.isOfficeDoc=function(e){return e&&-1!==u.indexOf(e)};t.getItemRoot=function(e){for(var t=e;t&&!t.isRootFolder;)t=t.parent;return t};t.isAutoAlbum=function(e){return this.hasAutoAlbumTag(e)&&!!e.properties.newTag};t.hasAutoAlbumTag=function(e){return!!e.properties&&!!e.properties.autoAlbumTag};t.GetDocumentTypeFromExtension=function(e){if(!e)return s.DocumentType.Word;var t=v(i.capitalize(e.split(".").pop()));return t===f?s.DocumentType.OneNote:t===l?s.DocumentType.PowerPoint:t===c?s.DocumentType.Excel:t===h?s.DocumentType.Visio:s.DocumentType.Word}});
define("odsp-next/dataSources/sharing/odc/SharingDataHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../url/odc/UrlDataSource","../../../resources/ODCResourceKeys","../../base/odc/ItemResultProcessor","../../item/ItemTaskObserver","../../../providers/item/ItemProvider"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f={0:1,1:2},l={"-1":0,0:5,1:1,2:2,3:3,4:4,5:0},c=function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._urlDataSource=t.resources.consume(s.urlDataSource);t._itemResultProcessor=new(t.managed(o.default))({getRootItemTitle:function(){return""},getItemKeyExtension:function(e,t){return{}}});t._itemProvider=t.resources.consume(a.resourceKey);return t}t.prototype.getSharingLinks=function(e,t){for(var r=[],i=0,s=e;i<s.length;i++){var o=s[i];if(!t.filterScope||t.filterScope(o))for(var u=0,a=o.people;u<a.length;u++){var f=a[u].sharingInfo;if(3===f.type){var l=n.__assign({},f.link,{item:o.item});r.push(l)}}}return r};t.prototype.getSharingScope=function(e,t){var n=this,r=this._getShareItem(e,t),s=t.entities.map(function(e){var t=n.transformEntity(e,{statusCode:e.status,errorMessage:e.errorMessage,role:n.parseEntityRole(e),isChangeable:e.isChangeable,type:e.type,userId:e.id||e.clientId,link:n._getLinkFromEntity(r,e),email:e.email,name:e.name,expiration:e.expirationDateTime,hasPassword:e.hasPassword});1===t.sharingInfo.type&&(t.image=i.default.getProfileImage(t.userId||t.sharingInfo.userId));return t});return{id:t.id,refId:t.refId,canChange:t.canChange,item:r,people:s,hasPendingAccessRequests:!1}};t.prototype.parseEntityRole=function(e){var t=e.role,n=2===e.type;return this._parseRole(t,n)};t.prototype.convertToSharingRole=function(e){return l[e]};t.prototype.transformEntity=function(e,t){return{name:e.name,email:e.email,userId:e.id,sharingInfo:t}};t.prototype._getShareItem=function(e,t){var n,r=e.length>1,i=this._urlDataSource.getOwnerId(),s=t.id,o=this._urlDataSource.getKey(((n={}).id=s,n.cid=i,n)),a=!r&&this._findItem(e[0],s,o);if(!a){var f=new(this.resources.consume(u.resourceKey));this._itemResultProcessor.processItemResult({requestKey:o,isPlaceholder:!0,isPrimaryRequestedItem:!0,itemFromServer:{id:t.id,name:t.name,ownerCid:i,isBundle:r,commands:"sh,1"},observer:f});f.flush();a=f.getItem({key:o})}return a};t.prototype._parseRole=function(e,t){return(t?f[e]:l[e])||5};t.prototype._getLinkFromEntity=function(e,t){return t.link?{url:t.link,type:t.linkType,name:t.linkName,role:this.parseEntityRole(t),id:t.id||t.clientId,isActive:!0,item:e,entityType:t.type,expiration:t.expirationDateTime||"",supportsExpiration:!0,hasPassword:t.hasPassword}:null};t.prototype._findItem=function(e,t,n){for(var r=null;e;){if(e.id===t){r=e;break}e=e.parent}if(!r){var i=this._itemProvider.getItemSync({parentKey:n}).item.peek();i&&i.isBundle&&(r=i)}return r};return t}(r.default);t.default=c});
define("odsp-next/providers/item/ItemProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../operation/OperationProvider","../../models/item/OneDriveItem","../../models/store/ItemsStore","@ms/odsp-utilities/lib/async/Promise","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../resources/ModelResourceKeys","../../models/operation/OperationState","../../models/operation/OperationBatch","../../models/operation/OperationType","../../models/operation/OperationError","../../models/itemSet/ItemSet","../ProviderHelpers","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-utilities/lib/resources/Resources","../../models/task/Task","@ms/odsp-utilities/lib/async/Signal","../quota/UserStateProvider.key","./ItemSetGrouper","../../utilities/browser/ServiceWorkerAgent","../../utilities/features/Features","@ms/odsp-utilities/lib/killswitch/Killswitch","@ms/odsp-shared/lib/utilities/knockout/Projections"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._registeredProjections={};r._pendingGetItemRequests={};r._store=n.itemsStore;r._operationProvider=n.operationProvider;r._schemaDataSource=n.schemaDataSource;r._updateQuota=n.updateQuota;T.isFeatureEnabled(T.GroupThrottleSupport)&&(r._groupThrottle=n.groupThrottle);r._smartFiltersStore=n.smartFiltersStore;r._serviceWorkerAgent=n.serviceWorkerAgent;return r}t.prototype.getItem=function(e){return this._getItem(e)};t.prototype.getItemSetKey=function(e,t){var n="";n+="parentKey="+e.parentKey;function r(e,t){t&&(n+="&"+e+"="+t)}r("ownerId",e.ownerId);r("groupingType",e.groupingType);n+="&sortField="+(e.sortField||"");n+="&isAscending="+("boolean"==typeof e.isAscending?e.isAscending:"");var i=e.filters;if(i)for(var s in i)n+="&"+s+"="+i[s];r("groupBy",e.groupBy);r("viewId",e.baseViewId);r("viewXml",e.viewXml);r("additionalFiltersXml",e.additionalFiltersXml);var o=!t&&e.itemSetProjections;if(o){var u="";for(var a in o)u+=a+"_"+o[a];n+="&projection="+u}e.supportsNestedGroups&&(n+="&ng=1");return n};t.prototype.getSpecifiedItems=function(e){e&&e.needToClearParentSmartFiltersInfo&&e.parentKey&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(e.parentKey);return this._getItemDataSource().then(function(t){return t.getSpecifiedItems(e)})};t.prototype.getItemSync=function(e){var t=this.getItemSetKey(e),n=e.parentKey,r=this._store.getItem(n),i=this._getItemSet(t,e);if(!r){var o=new s.default(n),u=e.queryType,a=void 0===u?o.queryType:u;o.queryType=a;this._store.setItem(o);r=this._store.getItem(n)}if(!i){var f=r.peek(),l=f&&f.folder,c=l&&l.childCount||0;(i=new v.default(t,e,c)).item=r;var h=e.needSchema;if(void 0===h||h){var p=this._schemaDataSource,d=p&&p.getColumns(f);d&&d.length>0&&i.schema(d)}this._store.setItemSet(t,i)}return i};t.prototype.invalidateItem=function(e,t){var r=void 0===t?{}:t,i=r.triggerFetch,s=void 0!==i&&i,o=r.emptyAllOtherSets,u=void 0!==o&&o,a=r.refreshSchema,f=void 0!==a&&a,l=r.updateGrouping,c=void 0!==l&&l,h=r.purgeCache,p=void 0!==h&&h;u&&this._store.emptyAllOtherSets([e]);if(f){(v=this._store.getItemSetFromItemKey(e))&&v.schema([])}c||this._store.invalidateItem(e,{purgeCache:p});this._smartFiltersStore&&this._smartFiltersStore.invalidate(e);var d=this._serviceWorkerAgent;d&&d.isServiceWorkerActive()&&d.invalidateFileMetadataCache();if(s){var v=this._store.getItemSetFromItemKey(e);this._getItem(n.__assign({parentKey:e},v&&v.context||{},{skipCache:!0,updateGrouping:c}))}};t.prototype.removeFromRecent=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromRecent(e)}).then(function(n){n&&t.invalidateItem(e.parentKey);return n})};t.prototype.removeMountPoint=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeMountPoint(e)}).then(function(n){n&&t.invalidateItem(e.parentKey);return n})};t.prototype.createMountPoint=function(e){return this._getItemDataSource().then(function(t){return t.createMountPoint(e)}).then(function(e){return e},function(e){return u.default.wrapError(e)})};t.prototype.createDocument=function(e,t,n,r,i){var s=this;return this._getItemDataSource().then(function(o){return o.createDocument(e,t,n,r).then(function(t){if(T.isFeatureEnabled(T.NewDocumentTemplates)&&i&&o.updateContentType){var n=t.match(/{(.*)}/),r=n&&n[1];return r?o.updateContentType(e,r,i).then(function(){s.invalidateItem(e);s._updateQuota(!0);return t}):t}s.invalidateItem(e);s._updateQuota(!0);return t})})};t.prototype.createCustomDocument=function(e,t,n){var r=this;return this._getItemDataSource().then(function(r){return r.createCustomDocument(e,t,n)}).then(function(t){if(!t)return u.default.wrapError();r.invalidateItem(e);r._updateQuota(!0);return r.getItem({parentKey:e}).then(function(e){return r.peekUnwrapObservable(r._store.getItem(t))})})};t.prototype.updateBundle=function(e,t){var n=this,r=[new b.default(e.item.key,e.item)];t.update(r);return this._getItemDataSource().then(function(t){return t.updateBundle(e)}).then(function(){n.invalidateItem(e.item.parent?e.item.parent.key:e.item.key);r=r.map(function(e){return e.succeed()});t.update(r)},function(i){n.invalidateItem(e.item.parent?e.item.parent.key:e.item.key);var s=new Error(i);r=r.map(function(e){return e.fail(s)});t.update(r);return u.default.wrapError(s)})};t.prototype.removeFromSharedList=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromSharedList(e)}).then(function(n){t.invalidateItem(e.parentKey);return n})};t.prototype.updateViewCount=function(e){return this._getItemDataSource().then(function(t){return t.updateViewCount(e)})};t.prototype.reportAbuse=function(e){var t=new h.default,n=this._operationProvider.register({name:e.item.name||"",type:p.default.reportAbuse,payloads:{reportAbuse:{item:e.item}},iconName:e.item.iconName,batch:t}),r=this._getItemDataSource().then(function(t){return t.reportAbuse(e)});n.state(c.default.started);n.progress.maximum(1);return r.then(function(e){n.state(c.default.completed);n.progress.current(1);return e},function(e){n.state(c.default.failed);n.error(new d.default({message:e}));return u.default.wrapError(e)})};t.prototype.requestReview=function(e){for(var t=this,n=new h.default,r=e.items.map(function(e){var r=t._operationProvider.register({name:e.name||"",type:p.default.requestReview,payloads:{requestReview:{item:e}},iconName:e.iconName,batch:n});r.progress.maximum(1);r.progress.current(0);return r}),i=this._getItemDataSource().then(function(t){return t.requestReview(e)}),s=0,o=r;s<o.length;s++){o[s].state(c.default.started)}return i.then(function(n){for(var i=0,s=r;i<s.length;i++){var o=s[i];o.progress.current(1);o.state(c.default.completed)}var u=e.items[0].parent;u&&t.invalidateItem(u.key);return n},function(e){for(var t=0,n=r;t<n.length;t++){var i=n[t];i.error(new d.default({message:e}));i.state(c.default.failed)}return u.default.wrapError(e)})};t.prototype.saveSortOrder=function(e){return this._getItemDataSource().then(function(t){return t.saveSortOrder(e)}).then(function(e){return e},function(e){})};t.prototype.addCoverPhotos=function(e){return this._updateCoverPhotos(e,p.default.addCoverPhotos,this._addCoverPhotos)};t.prototype.removeCoverPhotos=function(e){return this._updateCoverPhotos(e,p.default.removeCoverPhotos,this._removeCoverPhotos)};t.prototype.changeFolderType=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.changeFolderType(e)}).then(function(n){t.invalidateItem(e.item.key,{triggerFetch:!0});return n})};t.prototype.updateItemProperty=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.updateItemProperty(e)}).then(function(n){t.invalidateItem(e.item.key,{triggerFetch:!0});return n})};t.prototype.getOpenInClientDetails=function(e){return this._getItemDataSource().then(function(t){return t.getOpenInClientDetails(e)}).then(function(e){return e},function(e){})};t.prototype.getWorkProgress=function(e){return this._getItemDataSource().then(function(t){return t.getWorkProgress(e)})};t.prototype.processReferral=function(e,t){return this._getItemDataSource().then(function(n){return n.processReferral(e,t)})};t.prototype.getItemOcrTextContent=function(e){return this._getItemDataSource().then(function(t){return t.getItemOcrTextContent(e)})};t.prototype.updateItemOcrInfo=function(e,t,n){var r=this;return this._getItemDataSource().then(function(r){return r.updateItemOcrInfo(e,t,n)}).then(function(t){r.invalidateItem(e.key,{triggerFetch:!0});return t},function(e){return e})};t.prototype.rotateItems=function(e,t){var n=this,r={},i=e.items.map(function(e){return r[e.key]=new b.default(e.key,e)});t.update(i);return this._getItemDataSource().then(function(t){return t.rotateItems(e)}).then(function(){i=i.map(function(e){return e.succeed()});t.update(i)},function(e){var s=e.data||[];i=[];for(var o=0,u=s;o<u.length;o++){var a=u[o],f=r[a.key];n._store.setItem(f.input);delete r[a.key];i.push(f.fail(a.error))}for(var l in r){f=r[l];delete r[l];i.push(f.succeed())}t.update(i)})};t.prototype.registerProjection=function(e,t){this._registeredProjections[e]=t};t.prototype.computeProjectedItemSet=function(e,t,n,r){var i=n.itemSetProjections,s=r?null:this._store.getItemSet(e),o=!s||s.isPlaceholder||s.isExpired||s.version!==t.version;if(!s||o){if(!s){(s=new v.default(e,n)).item=t.item;s.isTokenBasedApi=t.isTokenBasedApi;s.isPlaceholder=t.isPlaceholder;s.isExpired=t.isExpired;s.version=t.version}for(var u in i){var a=this._registeredProjections[u];a&&a.projectItemSet(s,t,i[u])}r||this._store.setItemSet(e,s)}return s};t.prototype.redeemPermissionToken=function(e){return this._getItemDataSource().then(function(t){return t.redeemPermissionToken(e)})};t.prototype._getItem=function(e){var r,i=this,s=g.deepCopy(e),o=this._store;if(e.keyAlias){r=this.getItemSync({parentKey:e.keyAlias}).item;e.parentKey=r.peek().key}else r=this.getItemSync(e).item;var a=e.skipCache,l=void 0!==a&&a,c=this.getItemSetKey(e),h=e.itemSetProjections?this.getItemSetKey(e,!0):c,p=this._getItemSet(c,e),d=p&&p.content.peek().items,y=e.isTokenBasedApi||!!p&&!!p.isTokenBasedApi,b=!l&&r&&!r.peek().revision&&p&&!p.isExpired&&!p.isPlaceholder&&(!e.requestAllChildren||m.resultSetHasData(d,{start:0,end:d.length})),E=e.startIndex,x=void 0===E?0:E,C=e.pageSize,k=void 0===C?100:C,L=e.endIndex||x+k;L=d&&d.length>0&&!y?Math.min(d.length,L):L;x=Math.max(0,Math.min(L,x));var A=N.Killswitch.isActivated("9E4109B7-74A1-4E6D-8EDF-29C13B0224E9","04/25/2019","only use next request token from stroe when context does not set it")||void 0===e.requestToken?o.getNextRequestToken(h):e.requestToken;e.requestToken="end"===A?"":A;var O=new S.default(e,o,y,t.TOKEN_BASED_API_EXTRA_ITEMS);O.initialize(p,x);var M=!1,_=p&&p.content.peek();if(T.isFeatureEnabled(T.RenderLargeListPartialResult)&&_&&(1===_.partialResultStatus||2===_.partialResultStatus)){M=!0;1===_.partialResultStatus&&p.content({items:_.items,groupings:_.groupings,partialResultRequestCount:0,partialResultStatus:2})}if(b&&!M&&O.isResultSetValid(d,{start:x,end:L}))return u.default.wrap(p);if(r&&r.peek().isStub){var D=e.startKey;if(D){if(o.getItem(D)){p.content.peek().items=[o.getItem(D)];p.isPlaceholder=!0;p.isExpired=!1;var P=this._schemaDataSource,H=P&&P.getColumns(r.peek());H&&H.length>0&&p.schema(H);p.content.valueHasMutated&&p.content.valueHasMutated()}}return u.default.wrap(p)}var B=p&&!p.isExpired&&p.content.peek().groupings;B&&B.length>0&&(e.isGrouped=!0);this._normalizeContext(e,d,x,L,!b);var j=this._getRequestKey(e),F=this._pendingGetItemRequests[j];if(F)return e.itemSetProjections?F.getPromise().then(function(t){return i.computeProjectedItemSet(c,t,e)}):F.getPromise();y&&!A&&(e.startIndex=0);this._pendingGetItemRequests[j]=F=new w.default;this.resources.consumeAsync(f.getItem.bypass).then(function(t){return t.getItem(n.__assign({},e,{itemSetKey:c}))}).then(function(t){if(s.updateContextBasedOnResult&&e.updateContextBasedOnResult){s.updateContextBasedOnResult(s,t);e.updateContextBasedOnResult(e,t);c=i.getItemSetKey(s)}var n=e.itemSetProjections?i.getItemSetKey(e,!0):c;r=o.getItem(e.parentKey);var u=o.getItemSet(n);b=!(!r||!u);var a=O.computeNewChildren(t,e,u,n,!!b),f=a.allChildren,l=a.hasNextRequestToken;l&&(y=l);if(t.item&&!e.ignoreChildren&&!e.skipStoreResults){if(!b){(u=new v.default(n,e)).item=o.getItem(e.parentKey);u.isTokenBasedApi=y;o.setItemSet(n,u)}var h=!!u.isExpired;u.sortField=t.sortField;u.isAscending=t.isAscending;u.isPlaceholder=!1;u.isExpired=!1;var p=e.needSchema;if(void 0===p||p){var d=t.schema;u.schema(d&&d.length>0&&d||[]);t.customViewRenderer?u.customViewRenderer=i.observables.create(t.customViewRenderer):u.customViewRenderer=i.observables.create(void 0)}var w=t.groupings;y&&e.mergeGroupings&&(w=O.computeNewGroupings(u.content.peek().groupings,t.groupings,f,e,h));t.contentTypes&&u.contentTypes&&u.contentTypes(t.contentTypes);var E=u.content.peek(),S=E.partialResultStatus,x=E.partialResultRequestCount,N=void 0===x?0:x,C=w&&w.length&&!!w[0];if(T.isFeatureEnabled(T.RenderLargeListPartialResult)&&!C){if(l&&(t.children&&t.children.length<30||!t.children)){var k=N+1;k<=5?N=k:S=1}else void 0===S||0===S||l?2===S&&t.children&&30===t.children.length&&(S=0):S=3}u.content({items:f,groupings:w,partialResultRequestCount:N,partialResultStatus:S});var L=u.version,A=void 0===L?0:L;u.version=A+1}delete i._pendingGetItemRequests[j];if(e.requestAllChildren&&!m.resultSetHasData(f,{start:0,end:t.totalChildren})){var M=g.deepCopy(e),_=M.startIndex,D=void 0===_?0:_;M.startIndex=D+100;return i._getItem(M)}if(t.isFromBrowserCache){s.skipCache=!0;return i._getItem(s)}e.itemSetProjections&&(u=i.computeProjectedItemSet(c,u,e));return u},function(e){delete i._pendingGetItemRequests[j];return u.default.wrapError(e)}).then(function(e){F.complete(e)},function(t){i._groupThrottle&&!i._groupThrottle()&&t&&t.errorCode===Number(-2147024860)&&!e.noGroupReplace?i._groupThrottle(!0):F.error(t)});return F.getPromise()};t.prototype._normalizeContext=function(e,t,n,r,i){var s=e.pageSize||100;if(!e.avoidSeamSnapping){if(!i&&!(n-n%s==r-r%s)&&t)for(;n<r&&t[n];)n++;e.startIndex=n-n%s}"number"!=typeof e.pageSize&&(e.pageSize=100);for(var o=e.startIndex,u=void 0===o?0:o;r-u>e.pageSize;)e.pageSize+=100};t.prototype._getRequestKey=function(e){var t=this.getItemSetKey(e,!0);e.requestToken?t+=e.requestToken:t+="&startIndex="+e.startIndex;return t+="&pageSize="+e.pageSize};t.prototype._getItemSet=function(e,t){var n=this._store,r=n.getItemSet(e);if(t.itemSetProjections){var i=this.getItemSetKey(t,!0),s=n.getItemSet(i);s&&(r=this.computeProjectedItemSet(e,s,t))}return r};t.prototype._updateCoverPhotos=function(e,t,n){for(var r=this,i=new h.default,s=e.target,o=e.items.map(function(e){var n=r._operationProvider.register({name:e.name||"",type:t,payloads:{coverPhotos:{parent:s,item:e}},iconName:e.iconName,batch:i});n.progress.maximum(1);n.progress.current(0);return n}),u=n.call(this,e),a=0,f=o;a<f.length;a++){f[a].state(c.default.started)}return u.then(function(e){r.invalidateItem(s.key);for(var t=0,n=o;t<n.length;t++){var i=n[t];i.progress.current(1);i.state(c.default.completed)}return e},function(){for(var e=0,t=o;e<t.length;e++){t[e].state(c.default.failed)}})};t.prototype._addCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.addCoverPhotos(e)})};t.prototype._removeCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.removeCoverPhotos(e)})};t.prototype._getItemDataSource=function(){return this.resources.consumeAsync(f.items)};t.dependencies=n.__assign({},r.default.dependencies,{groupThrottle:a.groupThrottle.optional,schemaDataSource:f.schema.optional,itemsStore:o.resourceKey,operationProvider:i.resourceKey,smartFiltersStore:l.smartFiltersStore.optional,updateQuota:E.resourceKey,serviceWorkerAgent:x.resourceKey.optional});t.TOKEN_BASED_API_EXTRA_ITEMS=T.isFeatureEnabled(T.RenderLargeListPartialResult)?2:5;return t}(r.default);t.default=C;t.resourceKey=y.createResolvedResourceKey(e("module").id,C)});
define("odsp-next/models/operation/OperationError",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){this.errorType=e.errorType||0;this.message=e.message;this.payloads=e.payloads||{}};t.OperationError=n;t.default=n});
define("odsp-next/models/itemSet/ItemSet",["require","exports","./ItemSetContent","knockout","@ms/odsp-shared/lib/utilities/object/EqualityComparers"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e,t,s){this.key=e||"";this.content=r.observable(new n.default(s));this.content.equalityComparer=i.objectStrictEquality;this.schema=r.observableArray([]);this.schema.equalityComparer=i.arrayStrictEquality;this.context=r.utils.extend({},t);this.contentTypes=r.observableArray([]);this.isPlaceholder=!0;this.version=0};t.default=s});
define("odsp-next/models/itemSet/ItemSetContent",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){this.items=new Array(e||0);this.groupings=null;this.partialResultRequestCount=0;this.partialResultStatus=0};t.default=n});
define("odsp-next/providers/ProviderHelpers",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resultSetHasData=function(e,t){for(var n=t.start,r=Math.min(t.end,e.length),i=n;i<r;i++)if(!e[i])return!1;return!0}});
define("odsp-next/providers/quota/UserStateProvider.key",["require","exports","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id+".updateQuota",factory:{dependencies:{observablesFactoryType:n.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})});
define("odsp-next/providers/item/ItemSetGrouper",["require","exports","knockout","../ProviderHelpers"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,n,r){this._context=e;this._store=t;this._isTokenBaseApi=n;this._tokenBasedExtraItemCount=r}e.prototype.initialize=function(e,t){this._skipDataFetch=!1;if(!this._context.group&&this._context.noIndexBasedDataFetch){var n=e&&e.content.peek().groupings,r=n&&n.length&&n[0].itemGroups;this._context.group=this._getGroupStartingOnIndex(t,r)}e&&e.isExpired&&(this._context.group=null);this._isExpandingGroup=this._context.noIndexBasedDataFetch&&this._context.group&&"__next__"!==this._context.group.groupingId&&!this._context.groupReplace;this._isFetchingNextGroup=this._context.group&&this._isTokenBaseApi&&"__next__"===this._context.group.groupingId;var i=e&&e.content.peek().groupings;this._isAllCollapsedQuery=i&&i.length>0&&i[0].isAllCollapsed&&i[0].isAllCollapsed.peek()&&!this._isExpandingGroup};e.prototype.isResultSetValid=function(e,t){var n=this._skipDataFetch;n||(n=this._isAllCollapsedQuery?!this._isExpandingGroup&&!this._context.requestToken:(this._isTokenBaseApi||!this._context.skipInMemoryCache)&&r.resultSetHasData(e,t)&&!(this._isFetchingNextGroup&&this._context.endIndex>e.length));return n};e.prototype.computeNewChildren=function(e,t,n,r,i){var s,o=!1;this._context.groupReplace&&(this._isFetchingNextGroup=!!e.nextRequestToken);s=i&&!n.isExpired?n.content.peek().items:[];if(e.nextRequestToken){!t.requestToken&&s.length>e.totalChildren&&(s[e.totalChildren]=null);e.totalChildren+=this._tokenBasedExtraItemCount;this._store.setNextRequestToken(t.parentKey,r,e.nextRequestToken);o=!0;n&&(n.isTokenBasedApi=o)}else this._store.setNextRequestToken(t.parentKey,r,"end");if(t.requestToken){t.startIndex=s.length-this._tokenBasedExtraItemCount;e.totalChildren+=s.length-this._tokenBasedExtraItemCount}if(this._isFetchingNextGroup||this._isAllCollapsedQuery){var u=e.children.length,a=e.startIndex+u;e.nextRequestToken&&(a+=this._tokenBasedExtraItemCount);e.totalChildren=Math.max(e.totalChildren,Math.max(s.length,a))}if(e.item&&e.totalChildren>=0){this._isExpandingGroup||(s.length>0&&0===e.totalChildren?s=[]:s.length=e.totalChildren);var f=void 0;f=t.groupReplace?t.startIndex:void 0!==e.startIndex?e.startIndex:this._isExpandingGroup?t.group.startIndex:t.startIndex;for(var l=0,c=0;l<s.length;l++)if(l>=f&&c<e.children.length){s[l]=this._store.getItem(e.children[c].key);c++}}return{allChildren:s,hasNextRequestToken:o}};e.prototype.computeNewGroupings=function(e,t,r,i,s){var o=this._isExpandingGroup?i.group:null,u=i.itemsPerGroup,a=e&&e.length>0?e[0].itemGroups:null,f=null;a&&a.length>0&&a[a.length-1].isPlaceholder&&(f=a.pop());var l=this._mergeGroupings(e,t,s,r);if(o&&l){l[0].isAllCollapsed(!1);o.state({isCollapsed:!1})}if(r&&r.length>0&&!r[r.length-1]&&(a=l&&l.length>0?l[0].itemGroups:null)&&a.length>0){var c=a[a.length-1];this._context.groupReplace&&this._isFetchingNextGroup&&(c.hasMoreData=!0);var h=r[c.startIndex+(-1!==u?Math.min(c.count,u):c.count)-1]&&!(this._context.groupReplace&&c.count<u),p=l[0].isAllCollapsed.peek();if(h||this._isFetchingNextGroup||p){var d=c.startIndex+c.count;f?f.startIndex=d:f={groupingId:"__next__",startIndex:d,count:1,isPlaceholder:!0,state:n.observable({isCollapsed:!1})};r.length<d&&(r.length=d+1);a.push(f)}}return l};e.prototype._mergeGroupings=function(e,t,n,r){var i=e;if(i&&i.length>0){if(t&&t.length>0)for(var s=0;s<t.length;s++){var o=i[s].isAllCollapsed.peek();i[s].itemGroups=n?this._retainItemGroupState(i[s].itemGroups,t[s].itemGroups):this._mergeItemGroups(i[s].itemGroups,t[s].itemGroups,o,null,r)}}else i=t;return i};e.prototype._mergeItemGroups=function(e,t,n,r,i){var s=e;if(e&&e.length>0){if(t&&t.length>0)for(var o=function(e){var t=!1;n&&e.state({isCollapsed:!0});for(var o=function(i){var o=s[i];if(e.groupingId===o.groupingId){if(u._context.noIndexBasedDataFetch||!u._context.isTokenBasedApi){if(u._context.groupReplace){o.count+=e.count;o.hasMoreData&&i<s.length-1&&(o.hasMoreData=!1)}else o.count=e.count;o.children=u._mergeItemGroups(o.children,e.children,n,o);if(0===i)o.startIndex=r?r.startIndex:0;else{var a=s[i-1],f=a.startIndex+a.count-o.startIndex;o.startIndex+=f;o.children&&o.children.forEach(function(e){e.startIndex+=f})}}else{var l=e.startIndex+u._context.startIndex,c=e.startIndex+u._context.startIndex+e.count;o.startIndex=Math.min(o.startIndex,l);o.count=Math.max(c,o.startIndex+o.count)-o.startIndex}t=!0;return"break"}},a=0;a<s.length;a++){if("break"===o(a))break}if(!t){var f=s[s.length-1],l=f.startIndex+f.count-e.startIndex;e.startIndex+=l;e.children&&e.children.forEach(function(e){e.startIndex+=l});var c=Math.min(e.count,30),h=0;if(i)for(var p=e.startIndex;p<e.startIndex+c;p++)i[p]||h++;h&&(e.emptyItemCount=h);s.push(e)}},u=this,a=0,f=t;a<f.length;a++){o(f[a])}}else s=t;return s};e.prototype._retainItemGroupState=function(e,t,n){var r=t;if(t&&t.length>0&&e&&e.length>0){for(var i={},s=0,o=e;s<o.length;s++){var u=o[s];i[u.groupingId]=u}for(var a=0,f=r;a<f.length;a++){var l=f[a],c=i[l.groupingId];if(c){l.state(c.state.peek());l.children=this._retainItemGroupState(c.children,l.children,c)}}}return r};e.prototype._getGroupStartingOnIndex=function(e,t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var r=t[n];if(!(r&&r.startIndex<=e))break;var i=r.startIndex+r.count-1;if(r.children){if(i>=e)return this._getGroupStartingOnIndex(e,r.children)}else{if(r.startIndex===e)return r.state.peek().isCollapsed?null:r;if(i>=e){var s=n<t.length-1?t[n+1]:null;if(s&&!s.state.peek().isCollapsed){this._skipDataFetch=!0;return null}}}}return null};return e}();t.default=i});
define("odsp-next/utilities/browser/ServiceWorkerAgent",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../utilities/features/Features","@ms/odsp-utilities/lib/logging/ABExperiment"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s;!function(){try{"serviceWorker"in navigator&&navigator.serviceWorker.getRegistration().then(function(e){e&&e.navigationPreload.getState().then(function(e){s=e.enabled})})}catch(e){}}();var o=function(){function e(){this._isOneDriveWinApp=-1!==navigator.userAgent.indexOf("OneDriveWinApp")}e.prototype.isServiceWorkerActive=function(){var e="serviceWorker"in navigator&&!!navigator.serviceWorker.controller&&"activated"===navigator.serviceWorker.controller.state;this.isServiceWorkerActive=function(){return e};return e};e.prototype.getServiceWorkerInfo=function(){return{isServiceWorkerRegistered:localStorage&&!!localStorage.getItem("isServiceWorkerRegisteredKey")||!1,isServiceWorkerFlightEnabled:this._isOneDriveWinApp?!r.isFeatureEnabled(r.DisableServiceWorkerPWA):r.isFeatureEnabled(r.EnableODBServiceWorker),isSWExperimentationFlightEnabled:r.isFeatureEnabled(r.EnableOdbServiceWorkerExperiment),isServiceWorkerExperimentOn:!!r.isFeatureEnabled(r.EnableOdbServiceWorkerExperiment)&&this._isOdbServiceWorkerExperimentOn(),isDocLibServiceWorkerFlightEnabled:r.isFeatureEnabled(r.EnableCommonServiceWorker),isDocLibSWExperimentationFlightEnabled:r.isFeatureEnabled(r.EnableDocLibServiceWorkerExperiment),isDocLibServiceWorkerExperimentOn:!!r.isFeatureEnabled(r.EnableDocLibServiceWorkerExperiment)&&this._isDocLibServiceWorkerExperimentOn(),isNavigationPreloadEnabled:s||void 0,swNavigationInfo:this.getSWNavigationInfo()||void 0}};e.prototype.getServiceWorkerStatus=function(){var e="unknown";try{e="serviceWorker"in navigator?navigator.serviceWorker.controller?navigator.serviceWorker.controller.state:"unavailable":"unsupported"}catch(e){console.error(e)}return e};e.prototype.invalidateFileMetadataCache=function(){this._invalidateCache("FileMetadata")};e.prototype._invalidateCache=function(e){var t=navigator.serviceWorker.controller;t&&t.postMessage(JSON.stringify({operation:"invalidate",cacheName:e}))};e.prototype._isOdbServiceWorkerExperimentOn=function(){this._odbServiceWorkerExperiment||(this._odbServiceWorkerExperiment=new i.ABExperiment({name:"ODBServiceWorkerExperimentV2",startDate:"7/01/2019",targetType:i.TargetType.user,version:i.ABExpHash.v2}));return this._odbServiceWorkerExperiment.IsExperimentOn()};e.prototype._isDocLibServiceWorkerExperimentOn=function(){this._docLibServiceWorkerExperiment||(this._docLibServiceWorkerExperiment=new i.ABExperiment({name:"CommonServiceWorkerExperiment",startDate:"8/19/2019"}));return this._docLibServiceWorkerExperiment.IsExperimentOn()};e.prototype.getSWNavigationInfo=function(){var e=performance&&performance.getEntriesByType("navigation");if(e&&e.length>0){var t=e[0];return{workerStart:t.workerStart,fetchStart:t.fetchStart,requestStart:t.requestStart}}};return e}();t.default=o;t.resourceKey=new n.ResourceKey({name:e("module").id,factory:new n.SimpleResourceFactory(o)})});
define("odsp-next/dataSources/sharing/odc/SharingDataDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../SharingDataSource.resx","../../url/odc/UrlDataSource","../../base/odc/DataRequest","../../../resources/ODCResourceKeys","../../../utilities/features/Features","./SharingDataHelper"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._sharingDataHelper=new(t.managed(l.default));t._urlDataSource=t.resources.consume(a.urlDataSource);return t}t.prototype.getSettings=function(e){var t=this,n=e.item;return e.getPermissions().then(function(e){var r={itemId:n.id,itemName:n.name,pickerProperties:{AllowEmailAddresses:!0},canManagePermissions:!0,canManageLinks:!0,canSendLink:!0,canSendEmail:!0,anonymousLinksEnabled:!0,organizationLinksEnabled:!1,networkLinksEnabled:!0,showAdvanced:!1,advancedUrl:"",itemUrl:"",supportsSharingPropagation:!1,showAdditionalExternalWarning:!1,sharedWithMany:!1,sharingRoles:t._getSharingRolesForItem(n),requiredAnonymousLinkExpirationInDays:0,mailSettings:{defaultCharacterLimit:4e3},contactInviteLimit:20};r.sharedWith=e.length?e[0].people:null;return i.default.wrap(r)})};t.prototype.getPermissions=function(e){var t=this,n=e.item,r=this._urlDataSource.getPermissionsUrl(n);return(new u.default).send({apiName:"GetPermissions",url:r}).then(function(e){var r=[];if(0!==n.sharingRole){var i={item:n,canChange:!1,people:[{userId:e.ownerCid,name:e.ownerName,email:"",image:o.default.getProfileImage(e.ownerCid),sharingInfo:{type:1,item:n,role:0,isChangeable:!1}}],hasPendingAccessRequests:!1,canUnshare:!1};r.push(i)}for(var s=0,u=e.permissionScopes;s<u.length;s++){var a=u[s];r.push(t._sharingDataHelper.getSharingScope([n],a))}return r})};t.prototype.getBestSharingLink=function(e){var t=e.item;return e.getLinks().then(function(e){if(e){for(var n=null,r=0,s=e;r<s.length;r++){var o=s[r];if(t.id===o.item.id){if(6===o.type){n=o;break}5===o.type&&(n=o)}}return i.default.wrap(n)}return i.default.wrap(null)},function(e){return i.default.wrap(null)})};t.prototype.getLinks=function(e){var t=this;return e.getPermissions().then(function(e){return t._sharingDataHelper.getSharingLinks(e,{})})};t.prototype.doSharingScopesContainLinks=function(){return!0};t.prototype.getRawResponse=function(e){return i.default.wrap({})};t.prototype._getSharingRolesForItem=function(e){var t={name:s.strings.CanEdit,value:this._sharingDataHelper.convertToSharingRole(2)},n={name:s.strings.CanView,value:this._sharingDataHelper.convertToSharingRole(1)};return e.isAlbum&&!f.isFeatureEnabled(f.CollaborativeAlbumsEnabled)?[n]:[t,n]};return t}(r.default);t.default=c});
define("odsp-next/dataSources/suiteNav/odc/SuiteNavDataSource",["require","exports","tslib","../../../resources/ODCResourceKeys","./ODCSuiteNav.resx","../../../models/suiteNav/SuiteNavData","../../../models/suiteNav/SuiteNavClientData","../../../models/suiteNav/SuiteNavLinkIds","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-utilities/lib/require/RequireConfigInjector","../../url/odc/UrlDataSource","@ms/odsp-datasources/lib/Permissions","../../../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../utilities/attribution/AttributionHelper","@ms/odsp-shared/lib/base/BaseModel","../../../actions/feedback/odc/FeedbackAction","../../../actions/odc/SignOutAction","../../../actions/NavigationAction","../../../actions/userActivity/odc/UserActivityAction","../../../actions/LanguagePickerAction","../../../actions/ToggleDebugWindowAction","@ms/odsp-utilities/lib/xhr/XHRPromise","@ms/odsp-utilities/lib/logging/ErrorHelper","../../../dataSources/footer/odc/Footer.resx","../../../utilities/features/Features","../../../pages/accountChooser/odc/sections/disambiguateEmail/DisambiguateEmail.resx","../../../providers/suiteNav/O365ShellWrapper","../../../providers/engagement/Engagement"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var O=FilesConfig&&FilesConfig.SuiteNavConfig,M="https://go.microsoft.com/fwlink/p/?LinkId=822563",_="SuiteNav",D=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._fillConsumerData=function(e,t,r,s){void 0===s&&(s=!1);var o=C.isFeatureEnabled(C.EnableSkypeOnSuiteNavHeader),a=new L.default;t.HasEXOLicense=C.isFeatureEnabled(C.EnableExchangeOnSuiteNavHeader);t.NewFlexPane=C.isFeatureEnabled(C.EnableNewFlexPaneOnSuiteNavHeader);t.MeFlexPaneEnabled=C.isFeatureEnabled(C.EnableMeFlexPaneOnSuiteNavHeader);t.LyncIntegrationDisabled=!o;t.IsRTL=f.default.isRightToLeft;e.CurrentWorkloadSettingsSubLinks=n._getSettingsLinks(n._urlDataSource,!1);e.CurrentWorkloadHelpSubLinks=[{Id:u.default.CUSTOM_SETTINGS_3,TargetWindow:"_blank",Text:i.strings.Help,Url:M}];e.CurrentWorkloadHelpSubLinks=n._getHelpLinks();e.SignOutLink={Id:u.default.SIGN_OUT,Text:i.strings.SignOut,Url:"#"};e.ActionsMap={};e.ActionsMap[u.default.DIAGNOSTICS]=function(e){s&&a.FlexPane.CloseFlexPaneForProvider("Settings");var t=new(e.injected(S.default))({});t.execute(null);t.dispose();return!1};e.ActionsMap[u.default.FEEDBACK]=function(e){s?a.FlexPane.CloseFlexPaneForProvider("Help"):a.FlexPane.CloseFlexPaneForProvider("NFD");n._engagement.logData({name:_+".EmailOneDriveSupport.Click"});var t=new(e.injected(g.default))({});t.execute(null).done(function(){t.dispose()});return!1};e.ActionsMap[u.default.USER_ACTIVITY]=function(e){var t=new(e.injected(w.default))({});t.execute(null);t.dispose();return!1};e.ActionsMap[u.default.SIGN_OUT]=function(e){var t=new(e.injected(y.default))({url:O.Urls.SignOut});t.execute(null);t.dispose();return!1};e.ActionsMap[u.default.ONEDRIVE]=function(e){var t=new(e.injected(b.default))({url:n._urlDataSource.getFilesQueryUrl(),forceNavigation:!0});t.execute(null);t.dispose();return!1};e.ActionsMap[u.default.LANGUAGE]=function(e){s&&a.FlexPane.CloseFlexPaneForProvider("Settings");n._engagement.logData({name:_+".Language.Click",isIntentional:!0});if(C.isFeatureEnabled(C.LanguageRedirect)){var t=new(e.injected(b.default))({url:n._urlDataSource.getLanguageWithAuthenRedirectUrl(),forceNavigation:!0,target:n._urlDataSource.getAuthKeyParamValue()?"_blank":null});t.execute(null);t.dispose()}else{var r=new(e.injected(E.default))({});r.execute(null).done(function(){r.dispose()})}return!1};if(r){e.CurrentWorkloadUserSubLinks=[];e.SignOutLink.Text=k.strings.title}return t};O&&(n._model={data:null,cssUrl:O.CssPath,requireConfig:n._getRequireConfig()});n._identity=n.resources.consume(p.identity).getIdentity();n._urlDataSource=n.resources.consume(r.urlDataSource);n._navigation=n.resources.consume(d.navigation);n._attributionHelper=n.resources.consume(v.resourceKey);n._engagement=n.resources.consume(A.resourceKey);n._isReactShell=C.isFeatureEnabled(C.UseReactConsumerShell);return n}t.prototype.getCapabilities=function(){var e=!!(window.Flight&&window.Flight.Ramps&&window.Flight.Ramps.SuiteNavHeader),t=window.location.search.indexOf("suitenav=1")>-1,n=this._identity.type===h.IdentityType.aad;return{supportsCaching:!1,supportsRealSuiteNav:!("syncpremiumupsell"===this._navigation.viewParams.v)&&O&&O.JsPaths&&(e||t||n),showO365Text:!1}};t.prototype.getUserTileUrl=function(){return O&&O.UserTileUrl};t.prototype.getUserName=function(){return O&&O.UserDisplayName};t.prototype.getUserEmail=function(){return this._identity.email};t.prototype.getRenderSetting=function(e){var t=this;return this._isReactShell?{isThinHeader:!0,top:e,initialRenderData:{Culture:$Config.mkt,IsConsumer:!0,UPN:this.getUserEmail(),UserDisplayName:$Config.UserDisplayName,WorkloadId:"ShellDocuments",UserID:$Config.upsellUserId,ShellBootHost:"",AppBrandTheme:{Primary:"#0078D4"},IsRtl:f.default.isRightToLeft},shellDataOverrides:{SignOutLink:{Id:u.default.SIGN_OUT,Text:i.strings.SignOut,Url:"#",Action:function(){var e=new(t.resources.injected(y.default))({url:O.Urls.SignOut});e.execute(null);e.dispose();return!1}},SignInLink:{Id:"ShellSignIn",Text:i.strings.SignIn,Url:FilesConfig.si}},disableShellPlus:!1,collapseO365Settings:!1,mePhotoSource:FilesConfig.SuiteNavConfig.UserTileUrl,UserID:$Config.upsellUserId,workloadSettingsSubLinks:this._getSettingsLinks(this._urlDataSource,!1,!0),workloadSettingsSubLinksTitle:i.strings.OneDriveSettings,workloadHelpSubLinks:this._getHelpLinks(),layout:"Mouse",AppHeaderLinkText:i.strings.OneDrive,AppHeaderLinkUrl:""}:null};t.prototype.loadData=function(e){var t=this;if(!e&&this._dataPromise)return this._dataPromise;this._model.requireConfig=this._getRequireConfig();this._dataPromise=new a.default(function(e,n){if(O){var r=function(n,r){t._model.data=new s.default(n,r);e(t._model)};if(t._identity.type===h.IdentityType.aad)x.default.start({url:t._urlDataSource.getSuiteNavConfigUrl()}).then(function(n){try{var s=JSON.parse(n.responseText);s.navBarData.HelpLink.Url=M;s.navBarData.CurrentWorkloadSettingsSubLinks=[{Id:u.default.CUSTOM_SETTINGS_1,Text:i.strings.Options,Url:t._urlDataSource.getOptionsUrl(),TargetWindow:"_top"}];t._model={data:s.navBarData,requireConfig:{paths:{shellcore:s.jsUrl.replace(/\.js$/,"")},shim:{shellcore:{exports:"O365"}}},cssUrl:s.cssUrl};t._model.data.ActionsMap={};t._model.data.ActionsMap[u.default.SIGN_OUT]=function(){new(t.managed(y.default))({url:O.Urls.SignOut}).execute(null);return!1};e(t._model)}catch(e){T.default.log(e);var o=t._getSuiteNavFallbackData();r(o.data,o.clientData)}},function(e){T.default.log(e);var n=t._getSuiteNavFallbackData();r(n.data,n.clientData)});else if(t.getCapabilities().supportsRealSuiteNav){l.default.addConfig(t._getRequireConfig());var a=t._identity.type===h.IdentityType.anonymous;t._isReactShell?window.require(["shellcore"],function(){var e=new o.default,n=new s.default(null,e);e=t._fillConsumerData(n,e,a,t._isReactShell);r(n,e)}):window.require(["shellconsumerdata"],function(){var e=ConsumerShellDataGenerator.GetConsumerData({UPN:a?"":t._identity.email,UserHexCID:$Config.hcid,UID:$Config.upsellUserId,Culture:$Config.mkt,WorkloadId:"ShellDocuments",Resources:{shelldefaultthemecss:O.JsPaths.shelldefaultthemecss,shellg2coreminthemecss:O.JsPaths.shellg2coreminthemecss,shellg2corecss:O.JsPaths.shellg2corecss,shellcoreprimeg2m:O.JsPaths.shellcoreprimeg2m+".js",shellg2pluscss:O.JsPaths.shellg2pluscss,shellplusg2m:O.JsPaths.shellplusg2m+".js",shellarialogger:O.JsPaths.shellarialogger+".js"}});e.UserDisplayName=O.UserDisplayName;var n=new o.default(e.ClientData);n=t._fillConsumerData(e,n,a);r(e,n)})}else{var f=t._getSuiteNavFallbackData();r(f.data,f.clientData)}}else e(null)});return this._dataPromise};t.prototype._getSuiteNavFallbackData=function(){var e=this,t=this._identity.type===h.IdentityType.aad,n=O.Urls,r=i.strings,s=new o.default;s.IsFallbackShell=!0;s.IsRTL=f.default.isRightToLeft;var a={WorkloadLinks:[{Id:u.default.ONEDRIVE,Text:r.OneDrive,Url:"https://onedrive.live.com"}],CurrentWorkloadSettingsSubLinks:this._getSettingsLinks(this._urlDataSource,!t),CurrentWorkloadHelpSubLinks:this._getHelpLinks(),CurrentWorkloadUserSubLinks:t?[]:[{Id:u.default.ABOUT_ME,Text:r.EditProfile,Url:n.Profile},{Id:u.default.SETTINGS,Text:r.AccountSettings,Url:n.Account}],IsAuthenticated:O.IsAuthenticated,SignOutLink:{Id:u.default.SIGN_OUT,Text:r.SignOut,Url:n.SignOut},UserDisplayName:O.UserDisplayName,ActionsMap:{}};a.ActionsMap[u.default.SIGN_OUT]=function(){new(e.managed(y.default))({url:O.Urls.SignOut}).execute(null);return!1};return{data:a,clientData:s}};t.prototype._getHelpLinks=function(){var e=[{Id:u.default.HELP,TargetWindow:"_blank",Text:i.strings.Help,Url:M},{Id:u.default.FEEDBACK,Text:i.strings.Support,Url:O.Urls.Feedback},{Id:u.default.LEGAL,TargetWindow:"_blank",Text:N.strings.Terms,Url:c.default.getTermsUrl()},{Id:u.default.PRIVACY,TargetWindow:"_blank",Text:N.strings.Privacy,Url:c.default.getPrivacyUrl()},{Id:u.default.DEVELOPERS,TargetWindow:"_blank",Text:N.strings.Developers,Url:"https://g.live.com/8seskydrive/dev"},{Id:u.default.ABUSE,TargetWindow:"_blank",Text:N.strings.ReportAbuse,Url:"https://go.microsoft.com/fwlink/?LinkID=85433"}],n=c.default.getImpressumUrl();n&&e.push({Id:u.default.IMPRESSUM,TargetWindow:"_blank",Text:t.impressumText,Url:n});f.default.language&&"en"===f.default.language.toLowerCase()&&e.splice(2,0,{Id:u.default.USERVOICE,TargetWindow:"_blank",Text:i.strings.SuggestFeature,Url:"https://onedrive.uservoice.com"});return e};t.prototype._getSettingsLinks=function(e,t,n){var r=this;void 0===n&&(n=!1);var s=O.Urls,o=i.strings,a=[],l=this.getCapabilities().supportsRealSuiteNav?new L.default:null;a.push({Id:u.default.CUSTOM_SETTINGS_1,Text:o.Options,Url:e.getOptionsUrl(),TargetWindow:"_top",Action:function(){n&&l&&l.FlexPane.CloseFlexPaneForProvider("Settings")}});var c=this._attributionHelper.getPurchaseAttribution({source:"SuiteNav",cta:"UpgradePage"});a.push({Id:u.default.CUSTOM_SETTINGS_2,Text:o.Upgrade,Url:e.getUpgradeOptionsUrl(c,!0),TargetWindow:"_top",Action:function(){n&&l&&l.FlexPane.CloseFlexPaneForProvider("Settings");r._engagement.logData({name:_+".UpgradeOption.Click"})}});l&&n&&l.Extensibility.AddOrUpdateCustomHeaderButton({iconFontFamily:"FabricMDL2Icons-5",iconFontName:"",isStateless:!0,onShow:function(){r._engagement.logData({name:_+".Diamond.Click"});var t=r._attributionHelper.getPurchaseAttribution({source:"SuiteNav",cta:"HeaderDiamond"}),n=new(r.resources.injected(b.default))({url:e.getUpgradeOptionsUrl(t,!0),forceNavigation:!0});n.execute(null);n.dispose();return!1},onHide:function(){},id:"PROD_OneDrive-Web_SuiteNav_Unknown_HeaderDiamond",ariaLabel:o.ClickToLearnMore,affordanceMenuItemText:o.ClickToLearnMore});t&&a.push({Id:u.default.CUSTOM_SETTINGS_3,TargetWindow:"_blank",Text:o.Help,Url:M});FilesConfig&&FilesConfig.df&&a.push({Id:u.default.DIAGNOSTICS,Text:o.Diagnostics,Url:s.Diagnostics});FilesConfig&&FilesConfig.df&&C.isFeatureEnabled(C.UserActivity)&&a.push({Id:u.default.USER_ACTIVITY,Text:"Activity",Url:s.Diagnostics});this._identity.type===h.IdentityType.anonymous&&C.isFeatureEnabled(C.HideLanguagePickerForAnonymous)||a.push({Id:u.default.LANGUAGE,Text:N.strings["langname_"+f.default.language],Url:"#"});return a};t.prototype._getRequireConfig=function(){return this._isReactShell?this._getReactRequireConfig():this._getG2RequireConfig()};t.prototype._getG2RequireConfig=function(){if(O&&O.JsPaths){var e=O.JsPaths;e.shellcore=e.shellcoreming2m;delete e.shellcoreg2m;return{paths:e,shim:{msajax:{exports:"Type"},shellg2strings:{deps:["msajax"],exports:"_s1"},shellcore:{deps:["msajax","shellg2strings"],exports:"O365"},shellconsumerdata:{deps:["msajax","shellg2strings","shellcore"],exports:"ConsumerShellDataGenerator"}}}}return null};t.prototype._getReactRequireConfig=function(){return{paths:{shellcore:"https://shellprod.msocdn.com/api/shellbootstrapper/consumer/oneshell?noext"},shim:{shellcore:{exports:"O365Shell"}}}};t.impressumText="Impressum";return t}(m.default);t.default=D});
define("odsp-next/models/suiteNav/SuiteNavData",["require","exports","./SuiteNavLinkIds"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){for(var r in e)this[r]=e[r];this.ClientData=t.toString();void 0===this.CurrentMainLinkElementID&&(this.CurrentMainLinkElementID=n.default.ONEDRIVE)};t.default=r});
define("odsp-next/models/suiteNav/SuiteNavLinkIds",["require","exports","@ms/odsp-datasources/lib/dataSources/suiteNav/ISuiteNavLink"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=n.SUITE_NAV_LINK_IDS});
define("@ms/odsp-datasources/lib/dataSources/suiteNav/ISuiteNavLink",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SUITE_NAV_LINK_IDS={CUSTOM_SETTINGS_1:"WorkloadSettingsSubLinks1",CUSTOM_SETTINGS_2:"WorkloadSettingsSubLinks2",CUSTOM_SETTINGS_3:"WorkloadSettingsSubLinks3",FEEDBACK:"ShellFeedback",DIAGNOSTICS:"Diagnostics",O365_SETTINGS:"ShellO365Settings",ADD_APP:"SuiteMenu_zz5_MenuItemCreate",SITE_CONTENTS:"SuiteMenu_zz6_MenuItem_ViewAllSiteContents",SITE_SETTINGS:"SuiteMenu_zz7_MenuItem_Settings",SITE_INFORMATION:"SuiteMenu_MenuItem_SiteInformation",SITE_PERMISSIONS:"SuiteMenu_MenuItem_SitePermissions",SITE_DESIGNS:"SuiteMenu_MenuItem_SiteDesigns",HUB_SETTINGS:"SuiteMenu_MenuItem_HubSettings",USER_ACTIVITY:"UserActivity",LIBRARY_SETTINGS:"SuiteMenu_LibrarySettings",LANGUAGE:"SuiteMenu_Language",CHANGE_THE_LOOK:"Change_The_Look",ABOUT_ME:"ShellAboutMe",SETTINGS:"ShellSettings",MY_SETTINGS:"SuiteMenu_zz2_ID_PersonalInformation",SIGN_OUT:"ShellSignout",HELP:"HelpLink",COMMUNITY:"ShellCommunity",PRIVACY:"ShellPrivacy",LEGAL:"ShellLegal",USERVOICE:"UserVoice",FIRSTRUN:"FirstRun",DEVELOPERS:"Developers",ABUSE:"ReportAbuse",IMPRESSUM:"Impressum",MAIL:"ShellMail",CALENDAR:"ShellCalendar",PEOPLE:"ShellPeople",ONEDRIVE:"ShellDocuments",WORD:"ShellWordOnline",EXCEL:"ShellExcelOnline",POWERPOINT:"ShellPowerPointOnline",ONENOTE:"ShellOneNoteOnline",SITES:"ShellSites",YAMMER:"ShellYammer",TASKS:"ShellTasks",POWER_BI:"ShellPowerBI",DELVE:"ShellOfficeGraph",VIDEO:"ShellVideo",ALCHEMY:"ShellAlchemy",SMILE:"ShellSendASmile",SHAREPOINT:"Sharepoint"};t.SuiteNavLinkIds=t.SUITE_NAV_LINK_IDS});
define("odsp-next/models/suiteNav/SuiteNavClientData",["require","exports","knockout"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.IsRTL=!1;this.IsFallbackShell=!1;this.LyncIntegrationDisabled=!1;this.NewFlexPane=!1;this.MeFlexPaneEnabled=!1;this.LogUrl="";this.LogLevelSwitches=[!1,!1,!1,!1];e&&n.utils.extend(this,JSON.parse(e))}e.prototype.toString=function(){return JSON.stringify(this)};return e}();t.default=r});
define("odsp-next/actions/feedback/odc/FeedbackAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","../../base/ExecutorLoader"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){n.__extends(r,t);function r(n){void 0===n&&(n={});var r=t.call(this,n)||this;r.name="Feedback";r._executorLoader=new(r.managed(s.default))({path:"odsp-next/actions/feedback/odc/FeedbackExecutor",getModule:function(){return new i.default(function(t,n){e(["odsp-next/actions/feedback/odc/FeedbackExecutor"],t,n)})},getExecutorParams:function(){return{}}});return r}r.prototype.onIsAvailable=function(){return!0};r.prototype.onExecute=function(e){return this._executorLoader.execute(e)};return r}(r.default);t.default=o});
define("odsp-next/actions/base/ExecutorLoader",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../resources/ProviderResourceKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._getModule=t.getModule;n._path=t.path;n._getExecutorParams=t.getExecutorParams;n._bundleLoader=n.resources.consume(s.bundleLoader);n._bundleLoader.queueLoad(n._path,n._getModule).done();return n}t.prototype.execute=function(e,t){var n=this;return this._path?this._loadExecutorType().then(function(i){return"function"!=typeof i?r.default.wrapError(new Error("Cannot create action from "+i+": "+n._path)):r.default.as(n._getExecutorParams()).then(function(s){var o=new(n.resources.injected(i))(s);return r.default.as(o.execute(e,t))})}):r.default.wrapError(new Error("Cannot create action from nothing: "+this._path))};t.prototype._loadExecutorType=function(){var e=this._bundleLoader.loadNow(this._path,this._getModule);this._loadExecutorType=function(){return e};return e};return t}(i.default);t.default=o});
define("odsp-next/actions/odc/SignOutAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../dataSources/identity/odc/IdentityDataSource","@ms/odsp-shared/lib/utilities/navigation/Navigation.key"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="SignOut";n.url=t.url;n.target=t.target||"_top";n._navigation=n.resources.consume(u.navigation);n._sessionProvider=n.resources.consume(o.resourceKey);return n}t.prototype.onExecute=function(e,t){this._sessionProvider.signOut();try{delete localStorage["onedrive.autoredirect"]}catch(e){}this.url&&"#"!==this.url&&this._navigation.navigateTo({url:this.url,frameId:this.target});return i.default.wrap({resultType:s.ResultTypeEnum.Success})};t.prototype.onIsAvailable=function(){return!0};return t}(r.default);t.default=a});
define("odsp-next/dataSources/identity/odc/IdentityDataSource",["require","exports","@ms/odsp-datasources/lib/utilities/permissions/Identity","@ms/odsp-utilities/lib/encoding/UriEncoding","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/resources/Resources","../IIdentityCache","../../../utilities/features/Features","../../base/odc/DataRequest","@ms/odsp-utilities/lib/events/EventGroup","@ms/odsp-utilities/lib/scope/Scope","@ms/odsp-utilities/lib/async/Async","cookies"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=6e4;t.enableCooldownAfterAuthFlowResourceKey=new a.ResourceKey({name:e("module").id+".enableCooldownAfterAuthFlow",factory:new a.ConstantResourceFactory(l.isFeatureEnabled(l.EnableCooldownAfterAuthFlow))});t.enableTokenCacheResourceKey=new a.ResourceKey({name:e("module").id+".enableTokenCache",factory:new a.ConstantResourceFactory(l.isFeatureEnabled(l.UseTokenCacheForOAuth))});var g=function(){function e(e,t){var r=this;this._navigation=t.navigation;this._enableCooldownAfterAuthFlow=t.enableCooldownAfterAuthFlow;t.enableTokenCache&&(this._tokenCache=new f.IdentityCache);this._pendingSignals={"msa_auth:":void 0,"graph_auth:":void 0,"msa_strong_auth:":void 0};this._authFrameAttempts={"msa_auth:":0,"graph_auth:":0,"msa_strong_auth:":0};this._tokenRefreshCooldowns={"msa_auth:":void 0,"graph_auth:":void 0,"msa_strong_auth:":void 0};this._scope=new p.default;this._async=this._scope.attach(new d.default);if(this.getIdentity().type===n.IdentityType.msa){var i=this._scope.attach(new h.default(this));this._silentAuthOrigin=document.location.protocol+"//"+document.location.hostname;i.on(window,"message",this._onMessageReceived);this._sessionId=$Config.authSessionId||"0";if(l.isFeatureEnabled(l.CanaryRefresh)){this._lastCanaryRefreshTime=Date.now();i.on(window,"focus",function(){if(Date.now()-r._lastCanaryRefreshTime>m){r._lastCanaryRefreshTime=Date.now();r._refreshCanary()}})}}}e.prototype.dispose=function(){this._scope.dispose()};e.prototype.getIdentity=function(){var e=n.IdentityType.anonymous,t="";if("UnAuth"!==$Config.unid){t=$Config.unid;e=$Config.aadClientId&&"live.com"===$Config.domain?n.IdentityType.aad:n.IdentityType.msa}return{email:$Config.email,id:t,loginName:"",type:e,sessionState:""}};e.prototype.getSignInUrl=function(){return FilesConfig.si};e.prototype.signOut=function(){this._expireAuthCookie("msa_auth:");this._expireAuthCookie("graph_auth:")};e.prototype.getSessionToken=function(e,t){void 0===e&&(e=!1);void 0===t&&(t=!1);return this._getToken(t?"msa_strong_auth:":"msa_auth:",e)};e.prototype.getGraphToken=function(e){void 0===e&&(e=!1);return this._getToken("graph_auth:",e)};e.prototype.getAuthUrl=function(e,t){if(this.getIdentity().type===n.IdentityType.msa){var r="sa.html";t?r="saroot.html":"soak2"===FilesConfig.env?r="sasoak2.html":"soak3"===FilesConfig.env?r="sasoak3.html":"dev"===FilesConfig.env&&(r="sadev.html");var i=encodeURIComponent("https://p.sfx.ms/"+r),s=t||"msa_strong_auth:"===e?"":"&display=none",o=void 0;switch(e){case"msa_auth:":case"msa_strong_auth:":o="dev"===FilesConfig.env?"onedrive-devbox.access":"msa_strong_auth:"===e?"onedrive_implicit_forceSA.access":"onedrive_implicit.access";break;case"graph_auth:":o=l.isFeatureEnabled(l.UseNewShareDialog)?"contacts.read Files.ReadWrite":"contacts.read"}return"https://login.live.com/oauth20_authorize.srf?client_id=00000000481710A4&scope="+o+"&res=success&resuictx=selection&response_type=token&redirect_uri="+i+s}return $Config.silentAuth};e.prototype.refreshAuthTicket=function(){this._silentAuthRpsIframe&&document.body.removeChild(this._silentAuthRpsIframe);this._rpsIFrameQosEvent=new u.Qos({name:"IdentityDataSource.refreshAuthTicket"});this._silentAuthRpsIframe=document.createElement("iframe");var e=$Config.silentAuth;this._silentAuthRpsIframe.src=e.replace(r.default.encodeURIComponent("{{RU}}"),r.default.encodeURIComponent("https://onedrive.live.com/sa?msaCallback=1"));document.body.appendChild(this._silentAuthRpsIframe)};e.prototype._refreshCanary=function(){(new c.default).send({apiName:"getPageContext",url:"/getpagecontext"}).then(function(e){e.canary&&FilesConfig.canary!==e.canary&&(FilesConfig.canary=e.canary)})};e.prototype._getToken=function(e,t){if(this.getIdentity().type===n.IdentityType.aad)return s.default.reject("Unable to get a token for a business account");var r;switch(e){case"graph_auth:":r="Graph";break;case"msa_strong_auth:":r="MSAStrong";break;default:r="MSA"}var i=new u.Qos({name:"IdentityDataSource.get"+r+"Token"}),a=this._getTokenFromCache(e),f=a.token,l=a.shouldRefresh,c=a.hadCookie;if(t){f=void 0;var h=this._tokenRefreshCooldowns[e];h&&h.complete()}if((l||!f)&&!this._pendingSignals[e]){this._pendingSignals[e]=new o.default;this._setupSilentAuthIframe(e)}if(f){i.end({resultType:u.ResultTypeEnum.Success,resultCode:l?"withinExpiration":"cached",error:c?void 0:"noCookie"});return s.default.resolve({accessToken:f})}return this._pendingSignals[e].getPromise().then(function(e){i.end({resultType:u.ResultTypeEnum.Success,resultCode:"fullRefresh"});return e},function(e){i.end({resultType:u.ResultTypeEnum.Failure,error:e&&e.message});return s.default.reject(e)})};e.prototype._writeTokenToCache=function(e,t,n){this._writeAuthCookie(e,t,n);var r=Date.now()+1e3*n;if(this._tokenCache){var i=this._getTokenCacheKey(e);this._tokenCache.setValue(i,new f.IdentityCacheData(t,r))}};e.prototype._getTokenFromCache=function(e){var t=this._getTokenFromCookie(e);if(this._tokenCache){var n=Date.now(),r=this._getTokenCacheKey(e),i=this._tokenCache.getValue(r,n);if(i)return{token:i.value,shouldRefresh:n+m>i.expiration,hadCookie:!!t}}return{token:t,shouldRefresh:!t,hadCookie:!!t}};e.prototype._writeAuthCookie=function(e,t,n){var r=this._getTokenCacheKey(e),i=Date.now()+1e3*n;v.set(r,t,{path:"/",secure:!0,expires:new Date(i).toUTCString()})};e.prototype._getTokenFromCookie=function(e){var t=this._getTokenCacheKey(e);return v.get(t)};e.prototype._expireAuthCookie=function(e){var t=this._getTokenCacheKey(e);v.expire(t,{secure:!0,path:"/"})};e.prototype._getTokenCacheKey=function(e){return e+this.getIdentity().id+this._sessionId};e.prototype._onMessageReceived=function(e){if(this._silentAuthRpsIframe&&e.source===this._silentAuthRpsIframe.contentWindow&&e.origin===window.location.origin&&e.data){var t=this._rpsIFrameQosEvent;if("MSA_AuthenticationSuccess"===e.data){this._refreshCanary();t.end({resultType:u.ResultTypeEnum.Success})}else"MSA_AuthenticationError"===e.data&&t.end({resultType:u.ResultTypeEnum.Failure,resultCode:"error"})}else if(this._silentAuthIframe&&e.source===this._silentAuthIframe.contentWindow&&e.origin===this._silentAuthOrigin&&void 0!==this._silentAuthIframeTokenType){t=this._currentIFrameQosEvent;var n="",r=0;if(e.data&&"object"==typeof e.data&&"ODSA"===e.data.source){n=e.data.token;r=parseInt(e.data.expiresIn,10)}else{if("string"!=typeof e.data)return;var i=e.data.split(" ");if(2===i.length){n=i[0];r=parseInt(i[1],10)}else if(1===i.length){var s=i[0].split("&");t.end({resultType:u.ResultTypeEnum.Failure,resultCode:"error"});if(0===s[0].indexOf("error=access_denied")){var o=v.get("ANON");l.isFeatureEnabled(l.EnableMsaOauthErrorRedirect)&&o&&this._navigation.navigateTo({url:this.getAuthUrl(this._silentAuthIframeTokenType,!0)})}return}}if(!!n&&r>0){this._writeTokenToCache(this._silentAuthIframeTokenType,n,r);t.end({resultType:u.ResultTypeEnum.Success});var a=this._pendingSignals[this._silentAuthIframeTokenType];a&&a.complete({accessToken:n})}else t.end({resultType:u.ResultTypeEnum.Failure,resultCode:"invalidToken"});this._removeSilentAuthIframe(this._silentAuthIframeTokenType,!0)}};e.prototype._setupSilentAuthIframe=function(e){var t=this;if(!this._silentAuthIframe){this._authFrameAttempts[e]++;this._silentAuthIframeTokenType=e;var n=this._tokenRefreshCooldowns[e];s.default.resolve(n&&n.getPromise()).then(function(){var n=t._currentIFrameQosEvent=new u.Qos({name:"IdentityDataSource.getTokenViaIFrame",extraData:{authTokenType:e,attemptCount:t._authFrameAttempts[e]}});t._silentAuthIframe=document.createElement("iframe");t._silentAuthIframe.style.display="none";t._silentAuthIframe.src=t.getAuthUrl(e);document.body.appendChild(t._silentAuthIframe);t._silentAuthIframeTimeoutId=t._async.setTimeout(function(){t._silentAuthIframeTimeoutId=void 0;n.end({resultType:u.ResultTypeEnum.Failure,resultCode:"timeout"});if(t._authFrameAttempts[e]<5){t._removeSilentAuthIframe(e,!1);t._setupSilentAuthIframe(e)}else t._removeSilentAuthIframe(e,!0)},3e4)})}};e.prototype._removeSilentAuthIframe=function(e,t){this._silentAuthIframeTokenType=void 0;if(this._silentAuthIframe){document.body.removeChild(this._silentAuthIframe);this._silentAuthIframe=void 0}if(void 0!==this._silentAuthIframeTimeoutId){this._async.clearTimeout(this._silentAuthIframeTimeoutId);this._silentAuthIframeTimeoutId=void 0}if(this._enableCooldownAfterAuthFlow){var n=this._tokenRefreshCooldowns[e]=new o.default;this._async.setTimeout(function(){n.complete()},3e4)}if(t){var r=this._pendingSignals[e];r&&r.error(new Error("Timed out acquiring OAuth token."));this._pendingSignals[e]=void 0;this._authFrameAttempts[e]=0;this._pendingSignals["msa_auth:"]?this._setupSilentAuthIframe("msa_auth:"):this._pendingSignals["msa_strong_auth:"]?this._setupSilentAuthIframe("msa_strong_auth:"):this._pendingSignals["graph_auth:"]&&this._setupSilentAuthIframe("graph_auth:")}};e.dependencies={navigation:i.navigation,enableCooldownAfterAuthFlow:t.enableCooldownAfterAuthFlowResourceKey,enableTokenCache:t.enableTokenCacheResourceKey};return e}();t.default=g;t.resourceKey=a.createResolvedResourceKey(e("module").id,g)});
define("odsp-next/dataSources/identity/IIdentityCache",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this._value=e;this._expiration=t}Object.defineProperty(e.prototype,"expiration",{get:function(){return this._expiration},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0});return e}();t.IdentityCacheData=n;var r=function(){function e(){this._state={}}e.prototype.getValue=function(e,t){var n=this._state[e];if(n&&t<n.expiration)return n};e.prototype.setValue=function(e,t){this._state[e]=t};return e}();t.IdentityCache=r});
define("odsp-next/actions/userActivity/odc/UserActivityAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","../../base/ExecutorLoader"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){n.__extends(r,t);function r(n){void 0===n&&(n={});var r=t.call(this,n)||this;r.name="UserActivity";r._executorLoader=new(r.managed(s.default))({path:"odsp-next/actions/userActivity/odc/UserActivityExecutor",getModule:function(){return new i.default(function(t,n){e(["odsp-next/actions/userActivity/odc/UserActivityExecutor"],t,n)})},getExecutorParams:function(){return{}}});return r}r.prototype.onIsAvailable=function(){return!0};r.prototype.onExecute=function(e){return this._executorLoader.execute(e)};return r}(r.default);t.default=o});
define("odsp-next/actions/LanguagePickerAction",["require","exports","tslib","../base/BaseAction","../resources/DataSourceResourceKeys","../controls/languagePicker/LanguagePicker","../controls/languagePicker/LanguagePicker.resx","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../utilities/icons/Icon","../providers/dialog/DialogProvider"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="LanguagePicker";n._languagePickerDataSource=n.resources.consume(i.languagePicker);n._navigation=n.resources.consume(f.navigation);n._dialogProvider=n.resources.consume(c.resourceKey);n._lang=n.observables.create("");n._canary=n.observables.create("");return n}t.prototype.onExecute=function(e,t){var n=this;return this._dialogProvider.requestDialog({title:o.strings.language,automationId:"languagePicker",component:{name:s.default.tagName,params:{selectedLanguage:this._lang,canary:this._canary}},actions:[{name:o.strings.save,execute:function(){return n.onDialogExecute()},isAvailable:this.observables.create(!0),icon:new l.default("Save"),isDefault:!0}]}).wait().then(function(){return{resultType:a.ResultTypeEnum.Success}})};t.prototype.onIsAvailable=function(){return!0};t.prototype.onDialogExecute=function(){var e=this;return this._languagePickerDataSource.saveLanguage(this._lang(),this._canary()).then(function(t){e._navigation.navigateTo(u.replaceQuery(window.location.href,"mkt",t));return 2})};return t}(r.default);t.default=h});
define("odsp-next/controls/languagePicker/LanguagePicker",["require","exports","./LanguagePickerViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./LanguagePicker.html","./LanguagePicker.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-language-picker",template:e("./LanguagePicker.html"),viewModel:n.default});t.default=i});
define("odsp-next/controls/languagePicker/LanguagePickerViewModel",["require","exports","tslib","../../resources/DataSourceResourceKeys","./LanguagePicker.resx","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.canary=t.canary;n.selectedLanguage=t.selectedLanguage;n.loadingText=i.strings.loading;var o=n.observables;n.isLoading=o.create(!0);n.languages=o.createArray([]);n.currentLanguage=o.create("");var u=n.resources.consume(r.languagePicker.optional);u&&u.getLanguages().then(function(e){n.canary(e.canary);n.currentLanguage(e.currentLanguage);for(var t=e.languageList,r=0,i=t;r<i.length;r++){var o=i[r];o.displayText=(s.default.isRightToLeft?"&rlm;":"&lrm;")+o.nativeName+" - "+o.name}n.languages(t);n.isLoading(!1)});return n}return t}(o.default);t.default=u});
define("odsp-next/controls/languagePicker/LanguagePicker.html",[],function(){return'<form class=LanguagePicker>\x3c!--ko if: $data.isLoading--\x3e<div data-bind="text: loadingText"></div>\x3c!--/ko--\x3e\x3c!--ko ifnot: $data.isLoading--\x3e<select name=language data-bind="value: selectedLanguage, foreach: languages, automation: \'dropDown\'"><option data-bind="attr: {selected: isoValue === $parent.currentLanguage()}, value: isoValue, html: displayText"></option></select>\x3c!--/ko--\x3e</form>'});
define("odsp-next/controls/languagePicker/LanguagePicker.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".LanguagePicker select{width:100%}"}])});
define("odsp-next/actions/ToggleDebugWindowAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/Promise","../controls/debugWindow/DebugWindowInit","../resources/ControlResourceKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.name="ToggleDebugWindow";return t}t.prototype.onIsAvailable=function(){return!0};t.prototype.onExecute=function(e,t){if(o.default.isInitialized()){var n=this.resources.consume(u.isDebugWindowVisible);n(!n())}else o.default.init(this.resources);return s.default.wrap({resultType:i.ResultTypeEnum.Success})};return t}(r.default);t.default=a});
define("odsp-next/providers/suiteNav/O365ShellWrapper",["require","exports","tslib","@ms/odsp-datasources/lib/providers/suiteNav/O365ShellWrapper","./FlexPaneWrapper","./NavigationWrapper"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._flexPane=new i.FlexPaneWrapper;t._navigation=new s.NavigationWrapper;return t}Object.defineProperty(t.prototype,"FlexPane",{get:function(){return this._flexPane},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"Navigation",{get:function(){return this._navigation},enumerable:!0,configurable:!0});return t}(r.O365ShellWrapper);t.O365ShellWrapper=o;t.default=o});
define("@ms/odsp-datasources/lib/providers/suiteNav/O365ShellWrapper",["require","exports","@ms/odsp-utilities/lib/async/Signal"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._PostRenderSignal=new n.default}Object.defineProperty(e.prototype,"FlexPane",{get:function(){return O365Shell.FlexPane},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Header",{get:function(){return O365Shell.Header},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Navigation",{get:function(){return O365Shell.Navigation},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Settings",{get:function(){return O365Shell.Settings},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Theme",{get:function(){return O365Shell.Theme},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Search",{get:function(){return O365Shell.Search},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"NFD",{get:function(){return O365Shell.NFD},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"Extensibility",{get:function(){return O365Shell.Extensibility},enumerable:!0,configurable:!0});e.prototype.SetData=function(e){O365Shell.SetData(e)};e.prototype.Render=function(e,t){var n=this;O365Shell.Render(e,function(){return n._signalAction(t)})};e.prototype.RenderAsync=function(e,t,n){var r=this;O365Shell.RenderAsync(e,function(){return r._signalAction(t)},function(){return r._signalAction(n)})};e.prototype.GetResourceLoader=function(){return O365Shell.GetResourceLoader()};e.prototype.OnDataChanged=function(e){return O365Shell.OnDataChanged(e)};e.prototype.OnSuiteAPILoaded=function(e){return O365Shell.OnSuiteAPILoaded(e)};e.prototype.LoadShellPlus=function(){O365Shell.LoadShellPlus()};e.prototype.Exists=function(){return"undefined"!=typeof O365Shell};e.prototype.HasMember=function(e){return this.Exists()&&!!O365Shell[e]};e.prototype.OnHasMember=function(e,t){var n=this;this.HasMember(e)?t():this._PostRenderSignal.getPromise().done(function(){return n.OnHasMember(e,t)})};e.prototype._signalAction=function(e){e();var t=this._PostRenderSignal;this._PostRenderSignal=new n.default;t.complete()};return e}();t.O365ShellWrapper=r});
define("odsp-next/providers/suiteNav/FlexPaneWrapper",["require","exports","@ms/odsp-utilities/lib/logging/ErrorHelper"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.prototype.OnFlexPaneVisibilityChanged=function(e){try{return O365Shell.FlexPane.OnFlexPaneVisibilityChanged(e)}catch(e){n.default.log(e,"FlexPaneWrapper","OnFlexPaneVisibilityChanged")}};e.prototype.OpenFlexPaneForProvider=function(e){try{O365Shell.FlexPane.OpenFlexPaneForProvider(e)}catch(e){n.default.log(e,"FlexPaneWrapper","OpenFlexPaneForProvider")}};e.prototype.CloseFlexPaneForProvider=function(e){try{O365Shell.FlexPane.CloseFlexPaneForProvider(e)}catch(e){n.default.log(e,"FlexPaneWrapper","CloseFlexPaneForProvider")}};e.prototype.RemoveOnFlexPaneVisibilityChanged=function(e){try{O365Shell.FlexPane.RemoveOnFlexPaneVisibilityChanged(e)}catch(e){n.default.log(e,"FlexPaneWrapper","RemoveOnFlexPaneVisibilityChanged")}};return e}();t.FlexPaneWrapper=r});
define("odsp-next/providers/suiteNav/NavigationWrapper",["require","exports","@ms/odsp-utilities/lib/logging/ErrorHelper"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.prototype.OnLinkClick=function(e){try{O365Shell.Navigation.OnLinkClick(e)}catch(e){n.default.log(e,"NavigationWrapper","OnLinkClick")}};e.prototype.OnHamburgerButtonClick=function(e){try{O365Shell.Navigation.OnHamburgerButtonClick(e)}catch(e){n.default.log(e,"NavigationWrapper","OnHamburgerButtonClick")}};e.prototype.RemoveOnLinkClick=function(e){try{O365Shell.Navigation.OnLinkClick(e)}catch(e){n.default.log(e,"NavigationWrapper","RemoveOnLinkClick")}};e.prototype.EnterAccessibilityLoopInShell=function(){try{O365Shell.Navigation.EnterAccessibilityLoopInShell()}catch(e){n.default.log(e,"NavigationWrapper","EnterAccessibilityLoopInShell")}};e.prototype.ReverseEnterAccessibilityLoopInShell=function(){try{O365Shell.Navigation.ReverseEnterAccessibilityLoopInShell()}catch(e){n.default.log(e,"NavigationWrapper","ReverseEnterAccessibilityLoopInShell")}};e.prototype.SetForwardAccessibilityLoopOutsideHeaderElementId=function(e){try{O365Shell.Navigation.SetForwardAccessibilityLoopOutsideHeaderElementId(e)}catch(e){n.default.log(e,"NavigationWrapper","SetForwardAccessibilityLoopOutsideHeaderElementId")}};e.prototype.SetReverseAccessibilityLoopOutsideHeaderElementId=function(e){try{O365Shell.Navigation.SetReverseAccessibilityLoopOutsideHeaderElementId(e)}catch(e){n.default.log(e,"NavigationWrapper","SetReverseAccessibilityLoopOutsideHeaderElementId")}};return e}();t.NavigationWrapper=r});
define("odsp-next/utilities/logging/odc/Beacon",["require","exports","tslib","@ms/odsp-utilities/lib/logging/BeaconBase","@ms/odsp-utilities/lib/logging/Manager","@ms/odsp-utilities/lib/logging/EventBase","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=1e4,a=3e4,f=100,l=1e4,c=function(e){n.__extends(t,e);function t(){return e.call(this,"/log",f,[u,u,u,a],!1,l)||this}t.prototype._createBeaconRequest=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],u=r.endTime,a=r.startTime;r.eventType===s.ClonedEventType.Single?u=r.startTime-2:r.eventType===s.ClonedEventType.Start&&(u=r.startTime-1);t.push({id:r.id,data:r.data,endTime:u,startTime:a,parent:r.parentId,name:r.eventName})}var f=o.safeSerialize({experienceId:window.Flight&&window.Flight.xid||null,cid:window.Flight&&window.Flight.cid||0,sessionId:window.Flight&&window.Flight.session,name:window.Flight&&window.Flight.name,version:window.Flight&&window.Flight.version,manifest:window.Flight&&window.Flight.manifest,startTime:i.Manager.startDate.getTime(),data:t});window.Flight&&window.Flight.Ramps&&window.Flight.Ramps.EnableODCLogging&&this.sendBeacon(f,{},1e4)};t.prototype._onNewEvent=function(e){};return t}(r.default);t.default=c});
define("@ms/odsp-utilities/lib/logging/BeaconBase",["require","exports","../logging/Manager","./EventBatchCache","../xhr/XHR","./events/Beacon.event"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(t,n,i,s,o,u,a,f){var l=this;this._lastSendBeacon=0;this._endPointUrl=t;this._maxCriticalFlushInterval=o;this._totalRetries=void 0===u?e.DEFAULT_TOTAL_RETRIES:u;this._totalRetriesStartValue=this._totalRetries;this._resetTotalRetriesAfter=void 0===a?e.DEFAULT_RESET_TOTAL_RETRIES_AFTER:a;this._ignorePreviousEvents=void 0!==f&&f;this._eventBatchCache=new r.default(n,i,function(e){l._onNewEvent&&l._onNewEvent(e)},function(e){l._createBeaconRequest(e)},s);this.init()}e.prototype.sendBeacon=function(e,t,n){this._sendBeacon(e,t,n,0)};e.prototype.flush=function(){this._eventBatchCache&&this._eventBatchCache.flush()};e.prototype._sendBeacon=function(e,t,r,o){var u=this;0===o&&(this._lastSendBeacon=n.Manager.getTime());var a=new i.default({url:this._endPointUrl,json:e,headers:t,requestTimeoutInMS:r}),f=new s.Beacon({retryCount:o,totalRetries:this._totalRetries});a.start(function(e,t){f.end({status:t+"",success:!0});if(++u._successfulLogRequests>=u._resetTotalRetriesAfter){u._successfulLogRequests=u._resetTotalRetriesAfter;u._totalRetries=u._totalRetriesStartValue}},function(n,i,s){u._successfulLogRequests=0;f.end({status:i+"",success:!1});if(-2===i&&u._totalRetries>0){u._totalRetries--;u._sendBeacon(e,t,r,o+1)}})};e.prototype.init=function(){var e=this,t=n.Manager.addLogHandler(function(t){e.addEvent(t)});if(!this._ignorePreviousEvents)for(var r=0;r<t.length;r++)this.addEvent(t[r])};e.prototype.addEvent=function(e){if(e.enabled){this._eventBatchCache.addEvent(e);e.critical&&(!this._lastSendBeacon||n.Manager.getTime()-this._lastSendBeacon>this._maxCriticalFlushInterval)&&this._eventBatchCache.flush()}};e.DEFAULT_TOTAL_RETRIES=3;e.DEFAULT_RESET_TOTAL_RETRIES_AFTER=3;return e}();t.default=o});
define("@ms/odsp-utilities/lib/logging/EventBatchCache",["require","exports","./events/Beacon.event","../logging/ErrorHelper"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,n,r,i){this._events=[];this._flushCount=0;this._maxSize=e;this._newEventHandler=n;this._flushHandler=r;this._maxFlushTimes=t;this._useSlidingWindow=i}e.prototype.addEvent=function(e){this._events.push(e);if(this._newEventHandler)try{this._newEventHandler(e)}catch(e){r.default.log(e)}n.Beacon.isTypeOf(e)||(this._events.length>=this._maxSize?this.flush():this._setFlushTimeout(!1))};e.prototype.flush=function(){this._setFlushTimeout(!0)};e.prototype._handleFlush=function(){this._clearFlushTimeout();if(this._events.length){this._flushHandler(this._events);this._events=[]}};e.prototype._clearFlushTimeout=function(){if(this._flushTimeoutId){window.clearTimeout(this._flushTimeoutId);this._flushTimeoutId=null}if(this._immediateflushTimeoutId){window.clearTimeout(this._immediateflushTimeoutId);this._immediateflushTimeoutId=null}};e.prototype._setFlushTimeout=function(e){var t=this;if(!this._immediateflushTimeoutId)if(this._useSlidingWindow){this._clearFlushTimeout();e?this._immediateflushTimeoutId=window.setTimeout(function(){t._handleFlush()},0):this._flushTimeoutId=window.setTimeout(function(){t._handleFlush()},this._getFlushTime())}else e?this._immediateflushTimeoutId||(this._immediateflushTimeoutId=window.setTimeout(function(){t._handleFlush()},0)):this._flushTimeoutId||(this._flushTimeoutId=window.setTimeout(function(){t._handleFlush()},this._getFlushTime()))};e.prototype._getFlushTime=function(){if(this._flushCount<this._maxFlushTimes.length){var e=this._flushCount;this._flushCount++;return this._maxFlushTimes[e]}return this._maxFlushTimes[this._maxFlushTimes.length-1]};return e}();t.default=i});
define("odsp-next/dataSources/mobileAppPath/odc/IOSMobilePathDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/string/StringHelper","../../../resources/ODCResourceKeys","./ViewQueryEnum","../BaseIOSMobilePathDataSource","../../url/ExternalAliasEnum","@ms/odsp-shared/lib/utilities/navigation/Navigation.key"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.PARAM_EQUALS_FORMAT="{0}={1}";n._queryParamDictionary={id:"resId",cid:"ownerCid",authkey:"authKey",accountId:"accountId",ticket:"ticket"};n._navigation=n.resources.consume(a.navigation);n._urlDataSource=n.resources.consume(i.urlDataSource);return n}t.prototype.getPath=function(){var e=this.getQueryStringParams(),t=this.getView(),n=r.format(o.default.APP_PATH_PRE_FIX+this.FIRST_PARM_FORMAT,t||"",e||"");e&&(n+="&");return n+=o.default.APP_PATH_POST_FIX};t.prototype.getStorePath=function(){return this._urlDataSource.getExternalUrl(u.default.iosappstore)};t.prototype.getView=function(){var e,t=this._navigation.viewParams.qt;if(t&&t.length>0){t=t.toLowerCase();switch(s.default[t]){case s.default.mru:e="recent";break;case s.default.shared:case s.default.sharedby:e="shared";break;case s.default.folders:e="files";break;default:e=t}}else e="files";return e};t.prototype.getQueryStringParams=function(){var e;for(var t in this._queryParamDictionary)if(this._queryParamDictionary.hasOwnProperty(t)){var n=this._navigation.viewParams[t];if("accountId"===t&&!n){var i=window.$Config;n=i&&i.hcid}if(n){if("root"===n)continue;e?e+="&":e="";e+=r.format(this.PARAM_EQUALS_FORMAT,this._queryParamDictionary[t],n)}}return e};return t}(o.default);t.default=f});
define("odsp-next/dataSources/mobileAppPath/odc/ViewQueryEnum",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.folders=0]="folders";e[e.shared=1]="shared";e[e.mru=2]="mru";e[e.search=3]="search";e[e.photos=4]="photos";e[e.recyclebin=5]="recyclebin";e[e.allmyphotos=6]="allmyphotos";e[e.sharedby=7]="sharedby"}(n||(n={}));t.default=n});
define("odsp-next/dataSources/mobileAppPath/BaseIOSMobilePathDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.FIRST_PARM_FORMAT="{0}?{1}";return t}t.prototype.getPath=function(){return r.format(this.FIRST_PARM_FORMAT,t.APP_PATH_PRE_FIX,t.APP_PATH_POST_FIX)};t.prototype.getStorePath=function(){return"https://itunes.apple.com/us/app/onedrive/id477537958?mt=8"};t.APP_PATH_PRE_FIX="ms-onedrive://";t.APP_PATH_POST_FIX="from=web";return t}(i.default);t.default=s});
define("odsp-next/resources/UtilityResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.idle=new n.ResourceKey("idle");t.beforeUnload=new n.ResourceKey("beforeUnload");t.syncActiveXClient=new n.ResourceKey("syncActiveXClient");t.experimentHelper=new n.ResourceKey("experimentHelper");t.attributionHelper=new n.ResourceKey("attributionHelper");t.educationAndUpsells=new n.ResourceKey("educationAndUpsells");t.fileHandlerHelper=new n.ResourceKey("fileHandlerHelper");t.clientSideExtensionHelper=new n.ResourceKey("clientSideExtensionHelper");t.needsAttentionViewHelper=new n.ResourceKey("needsAttentionViewHelper");t.shyConductor=new n.ResourceKey("shyConductor")});
define("odsp-next/dataSources/download/odc/DownloadDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./DownloadDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/identity/odc/PWAAppIdentityDataSource",["require","exports","tslib","@ms/odsp-datasources/lib/Permissions","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/resources/Resources","../../../utilities/features/Features","../IIdentityCache","../../../providers/winApp/communication/WinAppCommunicator.key"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h;t.appEnableTokenCacheResourceKey=new a.ResourceKey({name:e("module").id+".enableTokenCache",factory:new a.ConstantResourceFactory(f.isFeatureEnabled(f.UseTokenCacheForOAuth))});!function(e){e.MSA="MSA";e.Graph="Graph"}(h||(h={}));var p=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._tokenCache=new l.IdentityCache;r._pendingSignals={"msa_auth:":void 0,"graph_auth:":void 0,"msa_strong_auth:":void 0};r._silentTokenAttempts={"msa_auth:":0,"graph_auth:":0,"msa_strong_auth:":0};r._silentAuthTokenTimeoutId={"msa_auth:":void 0,"graph_auth:":void 0,"msa_strong_auth:":void 0};r._tokenExpiryInSeconds={"msa_auth:":void 0,"graph_auth:":void 0,"msa_strong_auth:":void 0};return r}t.prototype.getIdentity=function(){var e=r.IdentityType.anonymous,t="";if("UnAuth"!==$Config.unid){t=$Config.unid;e=$Config.aadClientId&&"live.com"===$Config.domain?r.IdentityType.aad:r.IdentityType.msa}return{email:$Config.email,id:t,loginName:"",type:e,sessionState:""}};t.prototype.getSignInUrl=function(){return FilesConfig.si};t.prototype.signOut=function(){};t.prototype.getSessionToken=function(){return this._getToken("msa_auth:")};t.prototype.getGraphToken=function(){return this._getToken("graph_auth:")};t.prototype.receiveTokenFromWinApp=function(e,t,n,r){var i=this._mapWAMStringToAuthType(t),s=this._pendingSignals[i];if(null!==r&&""!==r.trim()){s.error(i+": "+r);this._resetTokenFetchState(i);return!1}this._writeTokenToCache(i,e,n);this._silentAuthTokenTimeoutId[i]&&this.async.clearTimeout(this._silentAuthTokenTimeoutId[i]);this._silentAuthTokenTimeoutId[i]=void 0;this._tokenExpiryInSeconds[i]=n;s&&s.complete({accessToken:void 0,wlidToken:e});this._resetTokenFetchState(i);return!0};t.prototype._mapWAMStringToAuthType=function(e){return e===h.MSA?"msa_auth:":"graph_auth:"};t.prototype._getToken=function(e){if(this.getIdentity().type===r.IdentityType.aad)return o.default.reject("Unable to get a token for a business account");var t=this._getTokenFromCache(e),n=t.token;if((t.shouldRefresh||!n)&&!this._pendingSignals[e]){this._pendingSignals[e]=new u.default;this._initiateTokenFetching(e)}return n?o.default.resolve({accessToken:void 0,wlidToken:n}):this._pendingSignals[e].getPromise().then(function(e){return e},function(e){return o.default.reject(e)})};t.prototype._initiateTokenFetching=function(e){var t=this;this._silentTokenAttempts[e]++;this.resources.consumeAsync(c.resourceKey).then(function(e){var t={authType:h.MSA,notification:"TokenRequestEvent"};e.sendNotification(t)});this._silentAuthTokenTimeoutId[e]=this.async.setTimeout(function(){t._silentAuthTokenTimeoutId[e]=void 0;if(t._silentTokenAttempts[e]<5)t._initiateTokenFetching(e);else{t._pendingSignals[e].error("Token retries completed");t._resetTokenFetchState(e)}},3e3)};t.prototype._resetTokenFetchState=function(e){this._silentTokenAttempts[e]=0;this._pendingSignals[e]=void 0};t.prototype._writeTokenToCache=function(e,t,n){var r=Date.now()+1e3*n;this._tokenCache&&this._tokenCache.setValue(e,new l.IdentityCacheData(t,r))};t.prototype._getTokenFromCache=function(e){if(this._tokenCache){var t=Date.now(),n=this._tokenCache.getValue(e,t);if(n)return{token:n.value,shouldRefresh:t+6e4>n.expiration}}return{token:null,shouldRefresh:!0}};t.dependencies=n.__assign({},i.default.dependencies,{navigation:s.navigation});return t}(i.default);t.default=p;t.resourceKey=a.createResolvedResourceKey(e("module").id,p)});
define("odsp-next/providers/winApp/communication/WinAppCommunicator.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./WinAppCommunicator"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/userInfo/odc/UserInfoDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../resources/ODCResourceKeys","@ms/odsp-utilities/lib/async/Promise","../../base/odc/DataRequest","@ms/odc-core/lib/PageConfig","../../../models/upsell/AvailableUpsells","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../../models/upsell/AvailableUpsells","../../../models/upsell/Upsells","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../GuidedTourDataHelper","../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=window.$Config&&window.$Config.isINT,m=1;d.isFeatureEnabled(d.EnableSecurityMomentLightbox)&&(m=2);var g=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._pendingRequests={};n._urlDataSource=n.resources.consume(i.urlDataSource);n._currentParamUpsells={};n._experimentMap={};n._wasInOriginalGuidedTourExperiment=!1;n._guidedTourDataHelper=new p.default;n._navigation=n.resources.consume(h.navigation);return n}t.pruneInactiveExperiments=function(e,t){if(t){var n={};for(var r in e)t.indexOf(Number(r))>-1&&(n[r]=e[r]);return n}return e};t.getExperimentMapFromUserInfo=function(e){var t={};try{if(e.param){var n=JSON.parse(e.param);for(var r in n)t[r]=n[r]}if(e.data){var i=JSON.parse(e.data);for(var r in i)t[r]=i[r]}}catch(e){}return t};t.prototype.canPersistUserInfo=function(){return!0};t.prototype.getCurrentParamUpsells=function(){return this._currentParamUpsells};t.prototype.setCurrentParamUpsells=function(e){this._currentParamUpsells=e};t.prototype.getAnid=function(){return u.default.getAnid()};t.prototype.getMarket=function(){return u.default.getMarket()};t.prototype.getLanguage=function(){return u.default.getLanguage()};t.prototype.isNewUser=function(){return u.default.isNewUser()};t.prototype.isAuthenticated=function(){return u.default.isAuthenticated()};t.prototype.getUserInfo=function(e){var n=this,r=this._urlDataSource.getUserInfoApiUrl(),i=e?r+"?v="+Math.random():r,u=new o.default;if(this._pendingRequests[r])return this._pendingRequests[r];if(!this.isAuthenticated()||!e&&this._cachedUserInfo)return s.default.wrap(this._cachedUserInfo);var a=u.send({apiName:"GetUserInfo",url:i}).then(function(e){delete n._pendingRequests[r];n._cachedUserInfo=e;if(e&&e.notifications)for(var i=0,s=e.notifications;i<s.length;i++){var o=s[i];7===o.type&&o.param&&(n._currentParamUpsells=JSON.parse(o.param))}if(e&&e.info)for(var u=0,a=e.info;u<a.length;u++){var f=a[u];if(32===f.type&&f.param){var l=new Date(2017,4,3);Date.parse(f.createdDate)<l.getTime()&&(n._wasInOriginalGuidedTourExperiment=!0);n._guidedTourDataHelper.setGuidedTourData(JSON.parse(f.param))}else 24===f.type?n._positioningData=f:40===f.type&&(d.isFeatureEnabled(d.ExpFactCleanup)?n._experimentMap=t.getExperimentMapFromUserInfo(f):f.param&&(n._experimentMap=JSON.parse(f.param)))}return e},function(e){delete n._pendingRequests[r];return s.default.wrapError(e)});this._pendingRequests[r]=a;return a};t.prototype.setUserInfo=function(e){var t=this._urlDataSource.setUserInfoApiUrl();return(new o.default).sendPostUrlEncoded("SetUserInfo",t,JSON.stringify(e)).then(function(e){return!(!e||e.error)})};t.prototype.setUserInfoWithUserFacts=function(e,t,n,r,i){var s={type:e,action:t};n&&(s.param=n);i&&(s.data=i);r&&(s.id=r);n&&7===e&&(this._currentParamUpsells=JSON.parse(n));return this.setUserInfo(s)};t.prototype.sendShowUpsell=function(e,t,n){return this._sendUpsell(e,t,n,"SHOWED")};t.prototype.sendCloseUpsell=function(e,t,n){return this._sendUpsell(e,t,n,"CLOSE")};t.prototype.resetUpsellUserFact=function(){return this.setUserInfoWithUserFacts(7,3,JSON.stringify({}))};t.prototype.handleUpdateUpsellData=function(e,t,n){var r=this.getUpsellVariationIfApplicable(e),i=this._currentParamUpsells[r.id];if(i){t&&(i.d=1);n&&i.v++}else this._currentParamUpsells[r.id]={d:t?1:0,v:n?1:0}};t.prototype.updateUpsellData=function(e,t,n){this.handleUpdateUpsellData(e,t,n);return this.setUserInfoWithUserFacts(7,3,JSON.stringify(this._currentParamUpsells))};t.prototype.hasUserFact=function(e){var t=this;return this.getUserInfo(!1).then(function(n){var r=!1;if(!t._cachedUserInfo)throw new Error("CachedUserInfo is not defined when trying to access user fact");(r=t._cachedUserInfo.info.some(function(t){return t.type===e&&t.isSet}))||(r=t._cachedUserInfo.rewards.some(function(t){return t.type===e&&t.isSet}));return r})};t.prototype.getUserFact=function(e){return this.getUserInfo(!1).then(function(t){if(t&&t.info)for(var n=t.info,r=0;r<n.length;r++)if(n[r].type===e)return n[r];return null})};t.prototype.getIsPremium=function(e){return this.getUserInfo(e).then(function(e){if(e&&e.info)for(var t=e.info,n=0;n<t.length;n++)if(35===t[n].type)return!0;return!1})};t.prototype.getUpsellToShow=function(e){var t=this._checkForParamOverrides();return null!==t?s.default.wrap(t):this.checkThrottle(l.default[c.default.OneRmO365Upsell]).then(function(e){return e?l.default[c.default.OneRmO365Upsell]:null})};t.prototype.getUpsellViewCount=function(e){var t=this,n=this.getUpsellVariationIfApplicable(e);return this.getUserInfo(!1).then(function(e){var r=0;t._currentParamUpsells[n.id]&&(r=t._currentParamUpsells[n.id].v);return r},function(e){return null})};t.prototype.getUpsellDismissed=function(e){var t=this,n=this.getUpsellVariationIfApplicable(e);return this.getUserInfo(!1).then(function(e){var r=!1;t._currentParamUpsells[n.id]&&(r=!!t._currentParamUpsells[n.id].d);return r},function(e){return null})};t.prototype.checkThrottle=function(e){var t=this._navigation.viewParams,n=this.getUpsellDismissed(e),r=this.getUpsellViewCount(e);return s.default.all({didUserDismiss:n,viewCount:r}).then(function(n){var r=n.didUserDismiss,i=n.viewCount;return null!==r&&null!==i&&e.checkThrottle({viewCount:i,didUserDismiss:r,viewParams:t,market:$Config.mkt})})};t.prototype.getUpsellIframeSrc=function(e,t){var n=this;return this.getUserInfo(!1).then(function(r){if(e.getUpsellIframeUrl)return n.getIsPremium(!1).then(function(r){return e.getUpsellIframeUrl({anid:n.getAnid(),market:$Config.mkt,override:0,isNewUser:n.isNewUser(),upsellUserId:$Config.upsellUserId,variationId:e.id,availableUpsells:l.default,isO365:r,bytesAvailable:n._getTotalQuotaInBytes(t),bytesUsed:n._getQuotaUsedInBytes(t)})})})};t.prototype.getUpsellVariationIfApplicable=function(e){return e.variation?l.default[e.variation]:e};t.prototype.getUpsellDismissedById=function(e,t){return s.default.wrap(void 0)};t.prototype.getUpsellViewCountById=function(e,t){return s.default.wrap(void 0)};t.prototype.markUpsellAsSeen=function(e){return s.default.wrap(void 0)};t.prototype.markUpsellAsDismissed=function(e){return s.default.wrap(void 0)};t.prototype.getFirstRunExperienceDismissed=function(){var e=this;return this.getUserInfo(!1).then(function(t){var n=!1;e._currentParamUpsells[c.default.FirstRunExperienceDialog]&&(n=!!e._currentParamUpsells[c.default.FirstRunExperienceDialog].d);return n},function(e){return!0})};t.prototype.getFirstRunExperienceViewCount=function(){var e=this;return this.getUserInfo(!1).then(function(t){var n=0,r=e._currentParamUpsells[c.default.FirstRunExperienceDialog];r&&(n=r.v);return n})};t.prototype.updateFirstRunExperienceData=function(e,t){this.handleUpdateFirstRunExperienceData(e,t);return this.setUserInfoWithUserFacts(7,3,JSON.stringify(this._currentParamUpsells))};t.prototype.handleUpdateFirstRunExperienceData=function(e,t){var n=this._currentParamUpsells[c.default.FirstRunExperienceDialog];if(n){e&&(n.d=1);t&&n.v++}else this._currentParamUpsells[c.default.FirstRunExperienceDialog]={d:e?1:0,v:t?1:0}};t.prototype.hasPositioningBeenViewed=function(){var e=this;return this.getUserInfo(!1).then(function(){return!!e._positioningData},function(e){return!0})};t.prototype.datePositioningViewed=function(){var e=this;return this.getUserInfo(!1).then(function(){var t=e._positioningData;if(t)return new Date(t.createdDate+"z")})};t.prototype.getPremiumUpsellsViewed=function(){return s.default.all({hasPositioningViewed:this.hasPositioningBeenViewed(),hasNewFeaturesViewed:this.getMostRecentNewFeaturesUpsellViewed()})};t.prototype.getMostRecentNewFeaturesUpsellViewed=function(){var e=this;return this.getUserInfo(!1).then(function(){var t=e._positioningData;if(t){if(t.param){return JSON.parse(t.param).v>=m}return!1}return!0},function(e){return!0})};t.prototype.setPositioningUserFactWithParams=function(e){var t={v:0};this._positioningData&&this._positioningData.param&&(t=JSON.parse(this._positioningData.param));e&&(t.v=m);return this.setUserInfoWithUserFacts(24,3,JSON.stringify(t),"78f745e2-e4f9-4734-8a08-454e12832a22")};t.prototype.getGuidedTourCompleted=function(){var e=this;return this.getUserInfo(!1).then(function(){var t=e._navigation.viewParams;return!(!e._wasInOriginalGuidedTourExperiment||t.ignoreGTUserFactCreationDate)||e._guidedTourDataHelper.getGuidedTourCompleted()},function(e){return!0})};t.prototype.getGuidedTourViewCount=function(){var e=this;return this.getUserInfo(!1).then(function(){return e._guidedTourDataHelper.getGuidedTourViewCount()})};t.prototype.updateGuidedTourData=function(e,t){this._guidedTourDataHelper.updateGuidedTourData(e,t);return this.setUserInfoWithUserFacts(32,3,JSON.stringify(this._guidedTourDataHelper.getGuidedTourData()))};t.prototype.completeGuidedTourAction=function(e){this._guidedTourDataHelper.completeGuidedTourAction(e);return this.setUserInfoWithUserFacts(32,3,JSON.stringify(this._guidedTourDataHelper.getGuidedTourData()))};t.prototype.getCompletedGuidedTourActions=function(){var e=this;return this.getUserInfo(!1).then(function(){return e._guidedTourDataHelper.getCompletedGuidedTourActions()})};t.prototype.resetGuidedTourUserFact=function(){var e=this;return this.getUserInfo(!1).then(function(t){e._guidedTourDataHelper.resetGuidedTourUserFact();return e.setUserInfoWithUserFacts(32,3,JSON.stringify(e._guidedTourDataHelper.getGuidedTourData()))})};t.prototype.getExpiringSharingLinksSeen=function(){var e=this;return this.getUserInfo(!1).then(function(t){var n=e._currentParamUpsells[c.default.ExpiringSharingLinks];return n&&!!n.d},function(e){return!0})};t.prototype.setExpiringSharingLinksSeen=function(){var e=this._currentParamUpsells[c.default.ExpiringSharingLinks];e?e.d=1:this._currentParamUpsells[c.default.ExpiringSharingLinks]={d:1,v:1};this.setUserInfoWithUserFacts(7,3,JSON.stringify(this._currentParamUpsells))};t.prototype.getEXPExperimentVariation=function(e){return this._getExperimentVariation(e)};t.prototype.setEXPExperimentVariation=function(e,t,n){return this._setExperimentVariation(e,t,n)};t.prototype._getExperimentVariation=function(e){var t=this;return this.getUserInfo(!0).then(function(){return t._experimentMap&&t._experimentMap[e]?t._experimentMap[e]:0},function(e){return s.default.wrap(0)})};t.prototype._setExperimentVariation=function(e,n,r){var i=this;return this.getUserInfo(!0).then(function(){i._experimentMap[e]=n;if(d.isFeatureEnabled(d.ExpFactCleanup)){i._experimentMap=t.pruneInactiveExperiments(i._experimentMap,r);return i.setUserInfoWithUserFacts(40,3,void 0,void 0,JSON.stringify(i._experimentMap))}return i.setUserInfoWithUserFacts(40,3,JSON.stringify(i._experimentMap))},function(e){return s.default.wrap(!1)})};t.prototype._checkForParamOverrides=function(){var e=this._navigation.viewParams,t=e.upsell;if(t)return l.default[t];e.resetUpsells?this.resetUpsellUserFact():e.resetGuidedTour&&this.resetGuidedTourUserFact();return null};t.prototype._getTotalQuotaInBytes=function(e){return e&&e.properties&&e.properties.quota&&e.properties.quota.total};t.prototype._getQuotaUsedInBytes=function(e){var t=this._getTotalQuotaInBytes(e);return t?t-e.properties.quota.remaining:null};t.prototype._sendUpsell=function(e,t,n,r){var i=new o.default,s=v?a.intBaseUrl:a.baseUrl,u={CampaignId:e.CampaignID,ContentId:e.MessageID,Id:t,Locale:n,Source:"OneDriveWebBanner",TransactionID:e.TransactionID,Type:0,UserAction:r},l=s+"api/v1/messaging/web/useraction?"+f.serializeQuery(u);return i.sendPost("OneRM",l,"").then(function(e){return!0},function(e){return!1})};return t}(r.default);t.default=g});
define("odsp-next/models/upsell/AvailableUpsells",["require","exports","./UpsellTypes","./Upsells","../../utilities/features/Features"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,o=window.$Config&&window.$Config.isINT;t.intBaseUrl="https://messaging-int.msonerm.com/";t.baseUrl="https://dynmsg.modpim.com/";var u=((s={})[r.default.NewBrandFRE]={id:r.default.NewBrandFRE,type:n.default.FRE,checkThrottle:function(e){return e.viewCount<=2&&!e.didUserDismiss},getUpsellIframeUrl:function(e){return(o?t.intBaseUrl:t.baseUrl)+"api/v1/messaging/web/message?puid="+e.upsellUserId+"&locale="+e.market+"&Source=OneDriveFRE"},shouldSendMessageOnClose:!0,renderType:0},s[r.default.OneRmO365Upsell]={id:r.default.OneRmO365Upsell,type:n.default.ONEUNIT,ramp:i.OneRmO365UpsellEnabled,checkThrottle:function(e){return i.isFeatureEnabled(i.OneRmO365UpsellEnabled)},getUpsellIframeUrl:function(e){return(o?t.intBaseUrl:t.baseUrl)+"api/v1/messaging/web/message?puid="+e.upsellUserId+"&locale="+e.market+"&data="+encodeURIComponent(JSON.stringify({isO365:e.isO365,bytesUsed:e.bytesUsed,bytesAvailable:e.bytesAvailable}))+"&Source=OneDriveWebBanner"},shouldSendMessageOnClose:!0,renderType:1},s);t.default=u});
define("odsp-next/models/upsell/UpsellTypes",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.FRE=0]="FRE";e[e.ONEUNIT=1]="ONEUNIT"}(n||(n={}));t.default=n});
define("odsp-next/models/upsell/Upsells",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.None=0]="None";e[e.NewBrandFRE=1]="NewBrandFRE";e[e.MusicFolderCreationOld=2]="MusicFolderCreationOld";e[e.MusicFolderCreation=3]="MusicFolderCreation";e[e.OneUnitUpsell=4]="OneUnitUpsell";e[e.OneDriveBusinessUpsell=5]="OneDriveBusinessUpsell";e[e.TenGigMaxFileSize=6]="TenGigMaxFileSize";e[e.PreviewTagsView=7]="PreviewTagsView";e[e.XboxMusic=8]="XboxMusic";e[e.O365Upsell1=9]="O365Upsell1";e[e.O365Upsell2=10]="O365Upsell2";e[e.O365Upsell3=11]="O365Upsell3";e[e.O365Upsell4=12]="O365Upsell4";e[e.OneRmO365Upsell=13]="OneRmO365Upsell";e[e.FirstRunExperienceDialog=14]="FirstRunExperienceDialog";e[e.ExpiringSharingLinks=15]="ExpiringSharingLinks";e[e.MobileUpsell=16]="MobileUpsell";e[e.WrsIntroduction=17]="WrsIntroduction"}(n||(n={}));t.default=n});
define("odsp-next/dataSources/userInfo/GuidedTourDataHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.resetGuidedTourUserFact()}e.prototype.getGuidedTourData=function(){return this._guidedTourData};e.prototype.setGuidedTourData=function(e){this._guidedTourData=e};e.prototype.getGuidedTourCompleted=function(){var e=this._guidedTourData;return!(!e||!e.c)};e.prototype.getGuidedTourViewCount=function(){var e=this._guidedTourData.v;return void 0===e?0:e};e.prototype.updateGuidedTourData=function(e,t){var n=this._guidedTourData;e&&(n.c=!0);t&&(n.v=(n.v||0)+1)};e.prototype.completeGuidedTourAction=function(e){var t=this._guidedTourData;switch(e){case 0:t.u=!0;break;case 1:t.m=!0;break;case 2:t.s=!0;break;case 3:t.sh=!0;break;case 4:t.f=!0;break;default:return}};e.prototype.getCompletedGuidedTourActions=function(){var e=this._guidedTourData,t=[];e.u&&t.push(0);e.m&&t.push(1);e.s&&t.push(2);e.sh&&t.push(3);e.f&&t.push(4);return t};e.prototype.resetGuidedTourUserFact=function(){this._guidedTourData={c:!1,v:0,u:!1,m:!1,s:!1,sh:!1,f:!1}};return e}();t.GuidedTourDataHelper=n;t.default=n});
define("odsp-next/dataSources/versionControl/VersionControlDataSource",["require","exports","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}e.prototype.checkOutItem=function(e){return n.default.wrap()};e.prototype.undoCheckOutItem=function(e){return n.default.wrap()};e.prototype.checkInItem=function(e){return n.default.wrap()};e.prototype.getVersionHistoryUrl=function(e){return""};e.prototype.supportsDocSetVersioning=function(){return!1};return e}();t.default=r});
define("odsp-next/dataSources/versionHistory/odc/VersionHistoryDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/path/Path","../../base/vroom/VroomDataRequestor","../../../providers/sessionManagement/SessionManagementProvider","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/uri/Uri","@ms/odsp-utilities/lib/xhr/XHRPromise"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._sessionManagementProvider=n.resources.consume(u.resourceKey);n._urlDataSource=n.resources.consume(a.url);return n}t.prototype.getVersionHistoryInfo=function(e){var t=this;return this._sessionManagementProvider.getToken().then(function(n){return t._getVersionHistory(s.encodePath(e.id)).then(function(r){var i=t._parseVersionHistory(r,e,n);i[0].isCurrentVersion=!0;return i})})};t.prototype.restoreVersionByLabel=function(e,t){var n=this;return this._sessionManagementProvider.getToken().then(function(r){var i="/drive/items/"+s.encodePath(e.id)+"/versions/"+s.encodePath(t)+"/action.restoreVersion",o=n._getUrl(i,r),u={Accept:"application/json","Content-Type":"application/json","Content-Length":"0"};return l.default.start({url:o,headers:u,method:"POST"}).then(function(e){return e.status>=200&&e.status<=299})})};t.prototype.deleteVersionByLabel=function(e,t){return i.default.wrap()};t.prototype.canRestoreVersions=function(){return!0};t.prototype.canDeleteVersions=function(){return!1};t.prototype.showVersionLabel=function(){return!1};t.prototype._parseVersionHistory=function(e,t,n){var r=this;return e.value.map(function(e,i){var o="/drive/items/"+s.encodePath(t.id)+"/versions/"+s.encodePath(e.id)+"/content",u=r._getUrl(o,n);return{created:e.lastModifiedDateTime,id:null,isCurrentVersion:0===i,size:e.size,url:u,versionLabel:e.id,appMap:t.appMap,createdBy:{Id:e.lastModifiedBy.user.id,Title:e.lastModifiedBy.user.displayName}}})};t.prototype._getVersionHistory=function(e){return this._getRequestor().send({apiName:"versions",path:"/drive/items/"+e+"/versions"})};t.prototype._getRequestor=function(){var e=this.resources.consume(o.resourceKey);this._getRequestor=function(){return e};return e};t.prototype._getUrl=function(e,t){var n,r=this._urlDataSource.getApiBaseUrl();t&&t.tokenUrl&&0===e.indexOf("/drive/")?n=new f.default(t.tokenUrl+"/"+e.substring(7)):(n=new f.default(e)).getScheme()||(n=new f.default(r+e));t&&t.accessToken&&n.setQueryParameter("access_token",t.accessToken);return n.toString()};return t}(r.default);t.default=c});
define("@ms/odsp-utilities/lib/path/Path",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.splitFileName=function(e){var t=n(e);return{name:t?e.substring(0,e.length-t.length):e,extension:t}};function n(e,t){void 0===t&&(t=!1);var n="";if(e){var r=e.lastIndexOf(".");r>=0&&(n=t?e.substr(r+1):e.substr(r))}return n}t.getFileExtension=n;t.encodePath=function(e,t){void 0===t&&(t=!0);e=encodeURI(e);t&&e&&(e=e.replace(/#/g,"%23"));return e}});
define("odsp-next/dataSources/base/vroom/VroomDataRequestor",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../../resources/DataSourceResourceKeys","../../../providers/sessionManagement/SessionManagementProvider","@ms/odsp-graph/lib/Base"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=new n.ResourceKey({name:"cookieOrigin",factory:new n.ConstantResourceFactory(window.location.origin)});t.resourceKey=n.createResolvedResourceKey(e("module").id,s.DataRequestor,{sessionManagementProvider:i.resourceKey,urlDataSource:r.url,cookieOrigin:o})});
define("odsp-next/providers/sessionManagement/SessionManagementProvider",["require","exports","@ms/odsp-datasources/lib/Permissions","@ms/odsp-utilities/lib/async/Promise","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/resources/Resources","@ms/utilities-error/lib/ApiError","../../utilities/features/Features","@ms/odsp-utilities/lib/uri/SimpleUri"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(){function e(e,t){this._identityDataSource=t.identityDataSource;this._microServiceDataSource=t.microServiceDataSource}e.prototype.getToken=function(e,t){var i=this._identityDataSource.getIdentity().type;if(i===n.IdentityType.aad){var s=new a.default(t).authority,f=t&&t.indexOf("$expand=notificationPreferences")>0;if(u.isFeatureEnabled(u.UseIdentityDataSourceAuthToken)&&s&&f)return this._identityDataSource.getSharePointToken(s);if(this._microServiceDataSource)return this._microServiceDataSource.getAuthData().then(function(t){if(t)return e&&"v2.1"===e?{accessToken:t.authTokenV21,proofToken:t.proofTokenV21,tokenUrl:t.tokenUrlV21}:{accessToken:t.authToken,proofToken:t.proofToken,tokenUrl:t.tokenUrl}},function(e){return r.default.resolve()})}else if(i===n.IdentityType.msa)return this._identityDataSource.getSessionToken();return r.default.reject(new o.ApiError({code:"unauthUser",isExpected:!0,message:"Cannot request a token for an unauthenticated user."}))};e.prototype.getFormDigest=function(e){return this._identityDataSource.getFormDigest(e)};e.dependencies={identityDataSource:i.identity,microServiceDataSource:i.microService.optional};return e}();t.default=f;t.resourceKey=s.createResolvedResourceKey(e("module").id,f)});
define("@ms/odsp-graph/lib/Base",["require","exports","tslib","./base/dataRequestor/DataRequestor","./base/urlHelper/UrlHelper"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("@ms/odsp-graph/lib/base/dataRequestor/DataRequestor",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/xhr/XHRPromise","@ms/odsp-utilities/lib/logging/events/Api.event","@ms/odsp-utilities/lib/uri/Uri","@ms/odsp-utilities/lib/logging/RequestDurationLoggingHelper","../../models/error/Error","@ms/odsp-utilities/lib/guid/Guid"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=window&&window.performance,c={activityLimitReached:!0,malwareDetected:!0,nameAlreadyExists:!0,resourceModified:!0,resyncRequired:!0,quotaLimitReached:!0,accessRestricted:!0,childItemCountExceeded:!0,entityTagDoesNotMatch:!0,fragmentOutOfOrder:!0,fragmentOverlap:!0,hipCheckRequired:!0,insufficientVaultQuota:!0,lockMismatch:!0,lockNotFoundOrAlreadyExpired:!0,lockOwnerMismatch:!0,maxDocumentCountExceeded:!0,maxFileSizeExceeded:!0,maxFolderCountExceeded:!0,maxItemCountExceeded:!0,nameContainsInvalidCharacters:!0,pathIsTooLong:!0,pathTooDeep:!0,pathIsTooDeep:!0,propertyNotUpdateable:!0,resyncApplyDifferences:!0,resyncUploadDifferences:!0,serviceReadOnly:!0,throttledRequest:!0,unlockRequired:!0,versionNumberDoesNotMatch:!0,virusSuspicious:!0,authFailure:!1},h=function(){function e(e,t){var n=e.alwaysSendContentType,r=void 0!==n&&n,i=t.sessionManagementProvider,o=t.urlDataSource,u=t.apiEvent,a=void 0===u?s.Api:u,f=t.cookieOrigin,l=t.isOffline;this._sessionManagementProvider=i;this._alwaysSendContentType=r;this._apiEvent=a;this._apiName=o&&"function"==typeof o.getApiName?o.getApiName():"Vroom";this._apiBaseUrl=o?"function"==typeof o.getApiBaseUrl?o.getApiBaseUrl():o.getVroomApiBaseUrl():void 0;this._cookieOrigin=f;this._isOffline=l}e.prototype.send=function(e){var t=this,h=e.headers,p=void 0===h?{}:h,d=e.path,v=e.apiName,m=e.disableLogging,g=void 0!==m&&m,y=e.timeout,b=e.onProgress,w=e.onUploadProgress,E=e.qosExtraData,S=e.apiVersion,x=void 0===S?"v2.0":S,T=e.needsAuthorization,N=void 0===T||T,C=e.useAuthorizationHeaders,k=void 0!==C&&C,L=e.accessToken,A=e.postProcessQos,O=e.breakCache,M=e.allowCookies,_=e.hasContentType,D=void 0===_||_,P=e.useMultiPart,H=void 0!==P&&P,B=e.getErrorAsMessage,j=void 0!==B&&B,F=e.expectedErrors,I=n.__assign({},c,e.expectedErrorCodes||{}),q=e.requestType,R=void 0===q?"GET":q,U=this._apiBaseUrl,z=this._cookieOrigin,W=M&&z&&N&&!L&&new o.default("/"===d[0]?U:d).getLeftPart(o.UriPartial.authority)===z,X=this._sessionManagementProvider,V=N&&!W&&(L||X&&X.getToken(x,d).catch(function(e){return r.default.reject(new a.GraphError(e,{status:0,response:{error:{code:"authFailure"}}}))}))||void 0,$=W?X.getFormDigest():void 0;return r.default.resolve($).then(function(c){return r.default.resolve(V).then(function(h){var m,S="",x={};x=H?{"Content-Type":"multipart/form-data;boundary="+(S=f.default.generate())}:n.__assign({Accept:"application/json"},(e.postData||t._alwaysSendContentType)&&D?{"Content-Type":"application/json"}:{},W&&c?{"x-requestdigest":c}:{},p);j&&(x=n.__assign({prefer:"rich-error-as-message"},x));if(h&&h.tokenUrl&&0===d.indexOf("/drive/"))m=new o.default(h.tokenUrl+"/"+d.substring(7));else{m=new o.default(d);U&&!m.getScheme()&&(m=new o.default(U+d))}if(H){m.setQueryParameter("ump","1");"POST"!==R&&(p["X-HTTP-Method-Override"]=R);R="POST"}var T,N=m.toString();if(!H&&h){var C=h.accessToken,L=h.proofToken,M=h.wlidToken,_=h.isBadger;if(M)x=n.__assign({},x,{Authorization:"wlid1.1 "+M});else if(k){C&&(x=_?n.__assign({},x,{Authorization:"badger "+C}):n.__assign({},x,{Authorization:"bearer "+C}));L&&(x=n.__assign({},x,{"X-PROOF_TOKEN":L}))}else{C&&m.setQueryParameter("access_token",C);L&&m.setQueryParameter("prooftoken",L)}}if(H){var P="";P+="--"+S+"\r\n";P+="Content-Disposition: form-data;name=data\r\n";if(p)for(var B=0,q=Object.keys(p);B<q.length;B++){var z=q[B];P+=z+": "+p[z]+"\r\n"}P+="Content-Type: application/json\r\n";P+="Authorization: bearer "+h.accessToken+"\r\n";P+="\r\n";P+=(void 0!==e.postData?e.postData:"")+"\r\n";P+="--"+S+"--"}O&&m.setQueryParameter("r",Math.random().toFixed(8));if(!g){var X={url:N=(N=N.replace(/(?:(?:access_|proof)token|tempauth|authkey)=[^&]+/gi,"")).replace(/(?:eyJ[A-Za-z0-9_-]+(?:\.|%2E|%252E)){2}(?:[A-Za-z0-9_-]+)/gi,"$REDACTED$"),name:t._apiName+"DataRequest."+v,extraData:E};T=new t._apiEvent(X)}var V=m.toString(),$=l&&l.now();return i.default.start({url:V,headers:x,method:R,json:P||e.postData||"",requestTimeoutInMS:y,withCredentials:W,onProgress:b,onUploadProgress:w}).then(function(t){var n=u.getRequestEntryDurationMetrics(V,$);if(T){var r={resultType:s.ResultTypeEnum.Success,extraData:{rawRequestDuration:n.duration,performanceEntry:JSON.stringify(n),requestId:t.getResponseHeader("request-id")||t.getResponseHeader("sprequestguid"),MSCorrelationVector:t.getResponseHeader("MS-CV")}};T.end(r)}return e.parseResponse?e.parseResponse(t):0===t.responseText.length?null:JSON.parse(t.responseText)},function(e){var i,o=function(e,t){A&&(e=A(e,t));T&&T.end(e);return r.default.reject(t)},f=u.getRequestEntryDurationMetrics(V,$);if(e instanceof Error){var l=r.default.isCanceled(e),c=l?s.ResultTypeEnum.ExpectedFailure:s.ResultTypeEnum.Failure,p={error:e.message,resultCode:l?"Canceled":"",resultType:c,extraData:{rawRequestDuration:f.duration,performanceEntry:JSON.stringify(f)}};return o(p,e)}if(e.responseText)try{i=JSON.parse(e.responseText)}catch(e){}if(j)try{var d=JSON.parse(atob(i.error.message));i={error:d}}catch(e){}var v=e.status,g=e.statusText,y=(i||{}).error,b=void 0===y?{}:y,w=b.message,S=void 0===w?"":w,x=b.innerError,N=void 0===x?{}:x,C=N.stackTrace,k=void 0===C?"":C,L=N.debugMessage,O=void 0===L?"":L;return(v||!t._isOffline?r.default.resolve(!1):t._isOffline()).then(function(t){var r=t?"Offline":"",u=e.getResponseHeader("request-id")||e.getResponseHeader("sprequestguid"),l=!!a.getErrorResolutionFromResponse(i,v,function(e){return I[e]}),c=new a.GraphError(new Error(S||r),{response:i,status:v,request:e,correlationId:u,isExpected:l});F&&function(e,t,n){for(var r=!1,i=0,s=e;i<s.length;i++){var o=s[i];o.code&&o.message?r=o.code===t&&o.message===n:o.code?r=o.code===t:o.message&&(r=o.message===n);if(r)break}return r}(F,c.code,S)&&(l=!0);var p={resultType:l?s.ResultTypeEnum.ExpectedFailure:s.ResultTypeEnum.Failure,error:S,resultCode:c.code,extraData:n.__assign({},E||{},a.getQosExtraDataFromError(c),{stack:k,httpStatus:v,httpStatusText:g,requestId:u,MSCorrelationVector:e.getResponseHeader("MS-CV"),debugMessage:O,accessTokenLength:h&&h.accessToken?h.accessToken.length:-1,urlLength:m.toString().length,useCookies:!!W,isOffline:t,rawRequestDuration:f.duration,performanceEntry:JSON.stringify(f)})};return o(p,c)})})})})};return e}();t.DataRequestor=h;t.default=h});
define("@ms/odsp-utilities/lib/logging/RequestDurationLoggingHelper",["require","exports","../uri/SimpleUri"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getRequestEntryDurationMetrics=function(e,t){if(!(window&&window.performance&&e&&t))return{duration:-1};try{var r=performance.getEntriesByType("resource");if(!new n.SimpleUri(e).authority){e=(window.location&&new n.SimpleUri(window.location.href).authority)+e}for(var i=void 0,s=r.length-1;s>=0;s--){var o=r[s];if(o.startTime<t)break;decodeURIComponent(o.name)===decodeURIComponent(e)&&(i=o)}if(i){return a=(u=i).connectEnd,f=u.connectStart,l=u.decodedBodySize,c=u.domainLookupend,h=u.domainLookupStart,p=u.duration,{connectEnd:a,connectStart:f,decodedBodySize:l,domainLookupend:c,domainLookupStart:h,duration:void 0===p?-1:p,encodedBodySize:u.encodedBodySize,fetchStart:u.fetchStart,nextHopProtocol:u.nextHopProtocol,redirectEnd:u.redirectEnd,redirectStart:u.redirectStart,requestStart:u.requestStart,responseEnd:u.responseEnd,responseStart:u.responseStart,secureConnectionStart:u.secureConnectionStart,startTime:u.startTime,transferSize:u.transferSize,workerStart:u.workerStart}}return{duration:-1}}catch(e){return{duration:-1}}var u,a,f,l,c,h,p}});
define("@ms/odsp-graph/lib/models/error/Error",["require","exports","tslib","@ms/utilities-error/lib/ApiError"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(t,r){var i=this,s=r.response,o=(void 0===s?{}:s).error,u=(void 0===o?{}:o).innerError,a=(void 0===u?{}:u).stackTrace,f=void 0===a?"":a,l=r.response,c=r.request,h=r.status,p=r.code,d=void 0===p?v(l,h,function(e){return""+e})||"unhandled":p,m=n.__assign({innerError:t,code:d},r);(i=e.call(this,m)||this).name="GraphError";i.response=l;i.status=h;i.serverStack=f;i.request=c;i.error=t;return i}return t}(r.ApiError);t.GraphError=i;var s="errorMessage",o="vroomStatus",u="vroomErrorCode",a="vroomErrorMessage",f="vroomErrorInnerCode",l="vroomErrorInnerMessage",c="vroomErrorInnerDebugMessage",h="vroomErrorInnerStack";t.getQosExtraDataFromError=function(e){var t={};t[s]=e.message;if(p(e)){t[o]=e.status;var n=e.response;if(n&&n.error){var r=n.error;t[u]=r.code;t[a]=r.message;var i=r.innerError||r.innererror;if(i){t[f]=i.code;t[l]=i.message;t[c]=i.debugMessage;t[h]=i.stackTrace}}}return t};function p(e){return e instanceof i}t.isGraphError=p;function d(e,t){if(p(e)){return v(e.response,e.status,function(n){return t(n,e)})}}t.getErrorResolution=d;t.getResultCodeFromError=function(e){return d(e,function(e){return""+e})||"unhandled"};function v(e,t,n){if(e){for(var r=[],i=e.error;i;){r.push(i);i=i.innerError||i.innererror}for(;i=r.pop();)if(void 0!==i.code){var s=n(i.code);if(void 0!==s)return s}}return n(t)}t.getErrorResolutionFromResponse=v});
define("@ms/odsp-graph/lib/base/urlHelper/UrlHelper",["require","exports","@ms/odsp-utilities/lib/uri/SimpleUri"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this._url=e}Object.defineProperty(e.prototype,"endpoint",{get:function(){return this._getEndpoint()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"driveId",{get:function(){return this._getDriveId()},enumerable:!0,configurable:!0});Object.defineProperty(e.prototype,"itemId",{get:function(){return this._getItemId()},enumerable:!0,configurable:!0});e.prototype._getEndpoint=function(){var e,t=this._url.indexOf("/drives");t>-1&&0===(e=this._url.substring(0,t)).indexOf("https:")&&(e=e.replace(":443/","/"));this._getEndpoint=function(){return e};return e};e.prototype._getDriveId=function(){var e,t=this._getIndexOfDrivesSegment();if(t>-1){var n=this._getPathSegments();e=n[t+1]}this._getDriveId=function(){return e};return e};e.prototype._getItemId=function(){var e,t=this._getIndexOfItemsSegment();if(t>-1){var n=this._getPathSegments(),r=(e=n[t+1])?e.indexOf("?"):-1;-1!==r&&(e=e.substring(0,r))}else e="root";this._getItemId=function(){return e};return e};e.prototype._getPathSegments=function(){var e,t=this._url;e=t?new n.default(t).segments:[];this._getPathSegments=function(){return e};return e};e.prototype._getIndexOfDrivesSegment=function(){var e=this._getPathSegments().indexOf("drives");this._getIndexOfDrivesSegment=function(){return e};return e};e.prototype._getIndexOfItemsSegment=function(){var e=this._getPathSegments().indexOf("items");this._getIndexOfItemsSegment=function(){return e};return e};return e}();t.getUrlParts=function(e){return new r(e)}});
define("odsp-next/dataSources/vault/odc/VaultDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./VaultDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/controls/vaultTeachingBubble/react/odc/VaultTeachingBubble.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./VaultTeachingBubble"],t,n)}).then(function(e){return e.typeResourceKey})})})});
define("odsp-next/dataSources/tag/odc/TagDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/odc/DataRequest","@ms/odsp-utilities/lib/async/Promise","../../../models/tag/TagType","../../url/odc/UrlDataSource","../../base/odc/BatchRequest","../../../resources/ODCResourceKeys"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(f.urlDataSource);return n}t.prototype.updateTags=function(e){return a.default.start({apiName:"UpdateTags",url:this._getUpdateTagUrl(),batchSize:200,items:e.items,getPostData:function(t){return{tagsToDelete:e.tagsToDelete,tagsToAdd:e.tagsToAdd,ids:t.map(function(e){return e.id})}}})};t.prototype.getAllTags=function(e){var t;switch(e){case o.default.allTags:t=this._getAllTagsUrl();break;case o.default.allPlaces:t=this._getAllGeolocationTagsUrl();break;default:return s.default.wrap(null)}return(new i.default).send({apiName:"GetAllTags",url:t})};t.prototype.getParentKeyForTagType=function(e){var t,n;e===o.default.allTags?n="tags":e===o.default.allPlaces&&(n="places");return this._urlDataSource.getKey(((t={}).id=n,t))};t.prototype._getUpdateTagUrl=function(){return u.default.skyApiBaseUrl+"UpdateTags"};t.prototype._getAllTagsUrl=function(){return u.default.skyApiBaseUrl+"AllTags"};t.prototype._getAllGeolocationTagsUrl=function(){return u.default.skyApiBaseUrl+"AllTags?qt=Geolocation"};return t}(r.default);t.default=l});
define("odsp-next/models/tag/TagType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.allTags=0]="allTags";e[e.allPlaces=1]="allPlaces";e[e.singleTag=2]="singleTag";e[e.singlePlace=3]="singlePlace"}(n||(n={}));t.default=n});
define("odsp-next/dataSources/photo/odc/PhotoDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../url/odc/UrlDataSource","../../base/odc/DataRequest","../../../models/store/ItemsStore","../../../resources/ModelResourceKeys","../../../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","./ISkyApiAllPhotosResponse","../../base/odc/ItemErrorProcessor","@ms/odsp-datasources/lib/Permissions","../../../models/item/ItemType","../../url/QueryType","../../../resources/ODCResourceKeys","../../../utilities/tag/GroupPacker","../../base/odc/ThumbnailProcessor","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../item/ItemTaskObserver","../../../models/task/Task","../../item/odc/SkyApiErrorHelper","knockout","../../../controls/photos/Photos.resx","../../../dataSources/base/vroom/VroomDataRequestor"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C,k,L=((C={})[c.GroupType[c.GroupType.Event]]=0,C[c.GroupType[c.GroupType.AlbumSuggestion]]=1,C[c.GroupType[c.GroupType.Highlights]]=2,C[c.GroupType[c.GroupType.Burst]]=3,C),A=["facesFolder","albumFolder","ascending","minRating","maxRating","favorites","highlights","etrmin","bmtsec","bhash","artmin","amtsec","ahashd","abadt","abadu","aminph","atagsout","aexpbph","wtrmin","wmtsec","whashd","wbadt","wbadu","wminph","wtagsout","wexpbph","wtaglist","wtagsother","wtagsnone","wphcount"];!function(e){e[e.ObjectDetectors=0]="ObjectDetectors";e[e.SystemDefined=1]="SystemDefined";e[e.OCR=2]="OCR";e[e.UserDefined=3]="UserDefined";e[e.LocationAndEventsApi=4]="LocationAndEventsApi"}(k=t.TagSource||(t.TagSource={}));var O=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._itemsStore=n.resources.consume(u.resourceKey);n._itemDataSource=n.resources.consume(f.getItem);n._urlDataSource=n.resources.consume(m.urlDataSource);n._itemErrorProcessor=new(n.managed(h.default));n._identityDataSource=n.resources.consume(f.identity);n._navigation=n.resources.consume(b.navigation);n._userSettingsStore=n.resources.consume(a.userSettingsStore);n._allPhotosUserSettings=x.observable(n._userSettingsStore&&n._userSettingsStore.getAllPhotosUserSettings());n._pendingRequests={};n._thumbnailProcessor=new(n.managed(y.default));n._requestor=n.resources.consume(N.resourceKey);return n}t.prototype.getAllPhotos=function(e){var t,n=this,r=new o.default,s={pagingToken:e.pagingToken,ascending:e.ascending?1:0,pageSize:e.pageSize,rootItemId:e.rootItemId||"root",tagFilter:e.tagFilter,locationFilter:e.locationFilter,startDate:e.startDate,endDate:e.endDate,highlights:e.highlights,verbose:2};0;var u=this._urlDataSource.getKey(((t={}).id=e.rootItemId,t.qt="allmyphotos",t.locationFilter=e.locationFilter,t.tagFilter=e.tagFilter,t)),a=this._getAllPhotosUrl()+"?"+l.serializeQuery(s,null,!0),f=this._pendingRequests[a];f||(f=this._pendingRequests[a]=r.send({apiName:"AllPhotos",url:a,isErrorExpectedCallback:S.isExpectedSkyApiError}).then(function(e){delete n._pendingRequests[a];var t=new(n.resources.consume(w.resourceKey));t.update([new E.default(u).succeed({item:{key:u,isPlaceholder:!1,queryType:v.default.AllMyPhotos,type:d.default.Folder,name:T.strings.allPhotosNavLink,properties:{commandsSupported:{defc:"1"}},revision:0}})]);var r=n._processAllPhotosResponse(e,t);t.flush();return r},function(e){delete n._pendingRequests[a];var t=new(n.resources.consume(w.resourceKey));n._processError({requestKey:u,error:e,observer:t});t.flush();return i.default.wrapError(e)}));return f};t.prototype.setAllPhotosSettings=function(e){var t=this,n=new o.default,r=s.default.skyApiBaseUrl+"UpdateItem?lct=1",u=this._pendingRequests[r];u||(u=this._pendingRequests[r]=n.sendPost("UpdateItem",r,JSON.stringify(e)).then(function(e){delete t._pendingRequests[r];return e},function(e){delete t._pendingRequests[r];return i.default.wrapError(e)}));return u};t.prototype.getPhotoSetKey=function(e){var t=e.ascending,n=void 0!==t&&t,r=e.rootItemId,i=void 0===r?"root":r;return l.serializeQuery({parentKey:this.getItemKey(e),rootItemId:i,isAscending:n,startDate:e.startDate,endDate:e.endDate,highlights:e.highlights},null,!0)};t.prototype.getItemKey=function(e){var t;return this._urlDataSource.getKey(((t={}).id=e.rootItemId,t.qt="allmyphotos",t.tagFilter=e.tagFilter,t.locationFilter=e.locationFilter,t.onThisDay=e.onThisDay,t.u=e.uniqueName,t))};t.prototype.getAllPhotosSettings=function(e){var t,n=this,r=this._allPhotosUserSettings.peek(),i={parentKey:this._urlDataSource.getKey((t={},t.id="root",t.u="allphotossettings",t)),skipCache:!0,skipInMemoryCache:!!e,pageSize:0,itemSetKey:""},s="",o=!1;this._itemDataSource.getItem(i).then(function(e){if(e){var t=n.peekUnwrapObservable(n._itemsStore.getItem(e.item.key));if(t&&t.properties){s=r.rootId=t.properties.allPhotosFolderId;o=r.isAscending=t.properties.allPhotosSortAscending;return n._requestor.send({apiName:"Items",path:"/drive/items/"+s+"?$select=specialFolder",requestType:"GET",useAuthorizationHeaders:!0})}}}).done(function(e){var t={rootId:s,isAscending:o,folderName:e.specialFolder?e.specialFolder.name:"root"};n._userSettingsStore.setAllPhotosUserSettings(t);n._allPhotosUserSettings(t)},function(e){});return this._allPhotosUserSettings};t.prototype.getMetadataContext=function(e){var t,n=this._urlDataSource.getKey(((t={}).id=e.rootItemId,t.qt="allmyphotos",t.tagFilter=e.tagFilter,t.locationFilter=e.locationFilter,t)),r=this._urlDataSource.getKeyParams(n);return{avoidSeamSnapping:!0,parentKey:n,ownerId:this._urlDataSource.getOwnerId(),pageSize:0,filters:{tagFilter:r.tagFilter,locationFilter:r.locationFilter}}};t.prototype._processAllPhotosResponse=function(e,t){for(var n=[],r=[],i=0,s=e.items;i<s.length;i++){var o=s[i];n.push(this._processItem(o,t))}for(var u=0,a=e.itemGroupings;u<a.length;u++){var f=a[u],l=this._processGrouping(f);r.push(l)}return{futurePagingToken:e.futurePagingToken,pastPagingToken:e.pastPagingToken,items:n,itemGroupings:r}};t.prototype._processItem=function(e,t){var n,r=this._urlDataSource.getKey(((n={}).id=e.resId,n)),i={key:r,queryType:v.default.AllMyPhotos,name:e.name,displayName:e.name,extension:e.extension},o=e.thumbnailBaseUrl?this._createThumbnail(e):void 0;if(e.isVideo){i.video={height:e.height,width:e.width};i.iconName="video"}else{i.photo={height:e.height,width:e.width,quality:{isBad:e.isBad}};i.iconName="photo"}var u=e.resId,a=s.default.viewerId;i.id=u;i.itemId=u;i.ownerId=a;i.graph={itemId:u,driveId:a,driveType:"personal"};i.dateTaken=e.dateTaken&&e.dateTaken.date;i.properties={commandsSupported:{at:"1",ata:"1",de:"3",defc:"1",dl:"3",em:"3",mc:"1",rn:"1",sh:"1",vo:"1"}};e.extension&&this._isPhotoExtensionSupportedForRotate(e.extension)&&i.properties.commandsSupported&&(i.properties.commandsSupported.rot="1");i.sharingRole=0;i.type=d.default.Media;var f=[];e.tags&&(f=e.tags.filter(function(e){return!e.source||e.source.toLowerCase()!==k[k.OCR].toLowerCase()&&e.source.toLowerCase()!==k[k.LocationAndEventsApi].toLowerCase()}));if(e.location){i.geoLocation=x.utils.extend({},e.location);i.geoLocation.displayString=g.makePlaceName(i.geoLocation)}i.tags=f;i.isPlaceholder=!1;i.thumbnail=o;t.update([new E.default(r).succeed({item:i})]);return i};t.prototype._processGrouping=function(e){for(var t={},n={},r=[],i=0,s=e.groups;i<s.length;i++){var o=s[i],u=this._processGroup(o);t[u.id]=u;for(var a=0,f=u.keys;a<f.length;a++){n[f[a]]=u.id}r.push(u)}return{name:void 0,itemGroups:void 0,groupType:this._getGroupType(e.groupType),groups:r,groupMap:t,itemToGroupMap:n}};t.prototype._processGroup=function(e){for(var t,n=[],r=0,i=e.resIds;r<i.length;r++){var s=i[r],o=this._urlDataSource.getKey(((t={}).id=s,t));n.push(o)}var u=x.utils.extend({year:this._extractUTCFullYearFromIsoDate(e.earliestPhotoTime.isoDate)},e.earliestPhotoTime),a=x.utils.extend({year:this._extractUTCFullYearFromIsoDate(e.latestPhotoTime.isoDate)},e.latestPhotoTime);return{closedFuture:e.closedFuture,closedPast:e.closedPast,earliestPhotoTime:u,id:e.id,latestPhotoTime:a,location:e.location,keys:n,featuredKey:e.featuredResIds&&e.featuredResIds[0]}};t.prototype._extractUTCFullYearFromIsoDate=function(e){return new Date(e).getUTCFullYear().toString()};t.prototype._processError=function(e){var t=e.requestKey,n=e.error,r=e.observer;2===(n&&n.data&&n.data.code)&&this._identityDataSource.getIdentity().type===p.IdentityType.anonymous&&(n.data.code=152);this._itemErrorProcessor.processError({requestKey:t,error:n,observer:r})};t.prototype._getAllPhotosUrl=function(){return s.default.skyApiBaseUrl+"AllPhotos"};t.prototype._createThumbnail=function(e){return this._thumbnailProcessor.processThumbnailSet({baseUrl:"",thumbnails:[{name:"unRes",url:e.thumbnailBaseUrl+"?"+l.serializeQuery({psid:2}),width:e.width,height:e.height}]},{id:e.resId,ownerCid:s.default.viewerId,photo:{width:e.width,height:e.height}})};t.prototype._getGroupType=function(e){return L[e]||0};t.prototype._addDebugParamsToRequest=function(e){for(var t=this._navigation.viewParams,n=0,r=A;n<r.length;n++){var i=r[n];i in t&&(e[i]=t[i])}};t.prototype._isPhotoExtensionSupportedForRotate=function(e){switch(e.toLowerCase()){case".jfif":case".jfif-tbnl":case".jpe":case".jpg":case".jpeg":return!0}return!1};return t}(r.default);t.default=O});
define("odsp-next/dataSources/photo/odc/ISkyApiAllPhotosResponse",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Event=0]="Event";e[e.AlbumSuggestion=1]="AlbumSuggestion";e[e.Highlights=2]="Highlights";e[e.Burst=3]="Burst"}(t.GroupType||(t.GroupType={}))});
define("odsp-next/utilities/tag/GroupPacker",["require","exports","knockout","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/string/StringHelper","../../models/item/OneDriveItem","../../dataSources/url/odc/UrlDataSource","../../models/item/ItemType","../../models/tag/TagType","../../dataSources/url/QueryType","../../dataSources/album/odc/AlbumDataSource","../../controls/allTagsHeader/AllTagsHeader.resx"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h={"pokémon":!0},p=11,d={animal:!0,building:!0,dog:!0,drink:!0,fire:!0,fireworks:!0,food:!0,outdoor:!0,people:!0,pizza:!0,screenshot:!0,selfie:!0,sky:!0,text:!0,whiteboard:!0},v=[l.NEW_ALBUM_TAG,l.AUTO_ALBUM_TAG,l.WEEKEND_RECAP_ALBUM_TAG,l.EVENT_RECAP_ALBUM_TAG];t.ALLPLACES_GEOLOCATION_DELIMITER=String.fromCharCode(9);t.ALLPLACES_GEOLOCATION_HARDCODED="%09";t.HEADER_GROUPINGID="tagHeader";var m=0;t.packAllTags=function(e,r,s,o,u){var f=e.length,l=0,m=[];if(1!==r){for(var y=0,b=e;y<b.length;y++){L=b[y];if(h[L.tag.toLowerCase()]||l<p&&d[L.tag.toLowerCase()]&&-1===v.indexOf(L.tag)){s.push(n.observable(g(a.default.allTags,L,null,u)));l++}}if(l>0){var w={groupingId:t.HEADER_GROUPINGID,startIndex:0,count:l,tagHeader:{title:c.strings.topTagsTitleText,countSubtitle:""}};m.push(w)}e.sort(function(e,t){var n=e.localizedTag||e.tag,r=t.localizedTag||t.tag;return n.localeCompare(r)});for(var E=0,S=e;E<S.length;E++){L=S[E];-1===v.indexOf(L.tag)?s.push(n.observable(g(a.default.allTags,L,null,u))):f--}if(f>0){var x=i.pluralSelect(f,c.strings.numberTagsSingularSubtitleText,i.format(c.strings.numberTagsPluralSubtitleText,f)),T={groupingId:t.HEADER_GROUPINGID,startIndex:l,count:f,tagHeader:{title:c.strings.allTagsTitleText,countSubtitle:x}};m.push(T)}var N={name:"tagGrouping",itemGroups:m};o.push(N)}else for(var C=0,k=e;C<k.length;C++){var L=k[C];-1===v.indexOf(L.tag)&&s.push(n.observable(g(a.default.allTags,L,null,u)))}};t.packAllPlaces=function(e,r,i,s,o,u){for(var f={},l=0,h=r;l<h.length;l++){var p=h[l];f[p.hierarchyIndex]=!0}e=e.filter(function(e){return f[e]});for(var d=[],v=[],m={name:c.strings.otherRegionsTitleText,places:[],totalPlaces:0},y=0,T=r;y<T.length;y++){var N=T[y],C=N.country;if(""===C){m.places.push(N);m.totalPlaces++}else if(v.indexOf(C)<0){d.push(b(C,N));v.push(C)}else w(C,N,d)}d.sort(function(e,t){return t.totalPlaces-e.totalPlaces});m.totalPlaces>0&&d.push(m);for(var k={},L=e.length,A=[],O=L,M=0,_=d;M<_.length;M++){var D=_[M],P=D.places;E(P);P.sort(function(e,t){return e.displayString.localeCompare(t.displayString)});for(var H=P.length,B=void 0,j=0,F=P;j<F.length;j++){var I=F[j];B=g(a.default.allPlaces,null,I,o);i.push(n.observable(B));e.indexOf(I.hierarchyIndex)>-1&&(k[I.hierarchyIndex]=x(B))}A.push(S(O,H,D.name,u(D.name)));O+=H}var q=r.length;if(L>0&&q>=L){for(var R=L-1;R>-1;R--)i.unshift(n.observable(k[e[R]]));var U={groupingId:t.HEADER_GROUPINGID,startIndex:0,count:L,tagHeader:{title:c.strings.recentPlacesTitleText,countSubtitle:""}};A.unshift(U)}var z={name:"tagGrouping",itemGroups:A};s.push(z)};function g(e,t,n,r){var i,l=((i={}).qt="allmyphotos",i.v="photos",i.id=r.rootItemId,i);switch(e){case a.default.allTags:var c=void 0;c=t.localizedTag&&t.localizedTag!==t.tag?t.localizedTag+";"+t.tag:t.tag;l.tagFilter=c;break;case a.default.allPlaces:l.locationFilter=n.hierarchyIndex}l.u=""+m++;var h=o.default.getKey(l),p=new s.default(h);p.type=u.default.Folder;p.queryType=f.default.AllMyPhotos;var d={tagType:e};p.tagInfo=d;p.folder={photoCount:0,covers:[]};switch(e){case a.default.allTags:p.name="#"+(t.localizedTag||t.tag);p.id=t.tag;p.folder.childCount=t.count;p.childCount=t.count;break;case a.default.allPlaces:p.name=n.displayString;p.id=n.hierarchyIndex;p.folder.childCount=n.count;p.childCount=n.count;break;default:return null}p.properties.commandsSupported={defc:"1"};p.isDraggable=!1;return p}t.createNewTagItem=g;function y(e){var t="";e.city&&(t+=e.city+", ");e.state&&(t+=e.state+", ");return 0===t.length?e.country||"":t.slice(0,-2)}t.makePlaceName=y;function b(e,t){var n=[];n.push(t);return{name:e,places:n,totalPlaces:1}}function w(e,t,n){for(var r,i=n.length,s=0;s<i;s++)if(e===(r=n[s]).name){r.places.push(t);r.totalPlaces++;break}}function E(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];r.displayString=y(r)}}function S(e,n,r,s){var o=i.pluralSelect(n,c.strings.numberPlacesSingularSubtitleText,i.format(c.strings.numberPlacesPluralSubtitleText,n));return{groupingId:t.HEADER_GROUPINGID,startIndex:e,count:n,tagHeader:{title:r,countSubtitle:o,regionUrl:s}}}function x(e){var t=r.deserializeQuery(e.key);t.u=m++;var n=o.default.getKey(t),i=new s.default(n);i.type=e.type;i.queryType=e.queryType;var u={tagType:e.tagInfo.tagType};i.tagInfo=u;i.name=e.name;i.id=e.id;var a={photoCount:0,childCount:e.folder.childCount,covers:e.folder.covers.slice()};i.folder=a;i.properties.commandsSupported={defc:"1"};i.isDraggable=!1;return i}});
define("odsp-next/providers/instrumentation/InstrumentationProvider",["require","exports","tslib","@ms/odsp-utilities/lib/component/Component","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","@ms/odsp-datasources/lib/interfaces/item/UrlType","@ms/odsp-utilities/lib/logging/events/UsageType","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/images/ImagePromise","../../resources/DataSourceResourceKeys","../engagement/Engagement","./Page.event","../../dataSources/url/QueryType","../../models/search/SearchSession.key","../../resources/ProviderResourceKeys","../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y={".doc":!0,".docx":!0,".ppt":!0,".pptx":!0},b=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.searchSessionStarted=!1;n._dataStore=new i.default("",s.default.session);n._instrumentationDataSource=n.resources.consume(c.instrumentation.optional);n._pageEvent=void 0;n._engagement=n.resources.consume(h.resourceKey);n._searchSession=n.resources.consume(v.resourceKey.optional);return n}t.prototype.logStartSearchOnSubmit=function(){if(!this.searchSessionStarted){var e={name:"StartSearchSession",location:"NA",usageType:u.UsageType[u.UsageType.Click],currentPage:this.currentPageName()||"NA",previousPage:this.previousPageName()||"NA",extraData:{searchSessionId:this._searchSession}};this._startSearchSession();this._engagement.logData(e)}};t.prototype.currentPageName=function(){return this._pageEvent&&this._pageEvent.data&&this._pageEvent.data.currentName};t.prototype.previousPageName=function(){return this._pageEvent&&this._pageEvent.data&&this._pageEvent.data.previousName};t.prototype.userViewPage=function(e){var t=e.name,n="(none)";if(this._pageEvent){n=this._pageEvent.data.currentName;this._pageEvent.end()}this._pageEvent=new p.Page({currentName:t,previousName:n});this._engagement.logData({name:"Page.View",location:"NA",usageType:u.UsageType[u.UsageType.Click],currentPage:t,previousPage:n,extraData:this._getExtraData(t)});g.isFeatureEnabled(g.WriteMruSignalWhenMediaViewedOneUp)&&(!e.item||"photo"!==e.item.iconName&&"video"!==e.item.iconName||this.resources.consumeAsync(m.mruRecent.optional).then(function(t){t&&t.recordDocumentView(e.item)}))};t.prototype.userSeeItem=function(e){this._instrumentationDataSource&&this._instrumentationDataSource.userSeeItem(e)};t.prototype.userExecuteAction=function(e){this._instrumentationDataSource&&this._instrumentationDataSource.userExecuteAction(e)};t.prototype.userClickItem=function(e){var t=o.default[o.default.bingClickInstrumentation];if(e.queryType===d.default.Search&&e.urls&&e.urls[t]){var n=new a.Qos({name:"SearchResultClickItem"});l.request(e.urls[t]).done(function(){n.end({resultType:f.ResultTypeEnum.Success})},function(){n.end({resultType:f.ResultTypeEnum.Failure,extraData:{url:e.urls[t]}})})}this._logOfficeDocAge(e)};t.prototype.userClickSuggestion=function(e){if(e){var t=new a.Qos({name:"SearchSuggestionClickItem"});l.request(e).done(function(){t.end({resultType:f.ResultTypeEnum.Success})},function(){t.end({resultType:f.ResultTypeEnum.Failure,extraData:{url:e}})})}};t.prototype.getEngagementData=function(){return this._getExtraData()};t.prototype._getExtraData=function(e){return this._instrumentationDataSource?this._instrumentationDataSource.getEngagementData(e||this.currentPageName()):null};t.prototype._startSearchSession=function(){this.searchSessionStarted=!0};t.prototype._logOfficeDocAge=function(e){if(e&&e.dateModifiedValue)try{var t=e&&e.extension&&e.extension.toLowerCase();if(t){var n=this._engagement;n.logData({name:"File.Clicked",currentPage:this.currentPageName()||"NA",previousPage:this.previousPageName()||"NA",extraData:{extension:t,size:e.size}});"ms-word"===e.appMap||"ms-powerpoint"===e.appMap?this._dataStore.setValue("OfficeDocClickTime",new Date):this._dataStore.setValue("OfficeDocClickTime","");if(y[t]){var r=new Date(e.dateModifiedValue),i=Math.ceil(((new Date).getTime()-r.getTime())/1e3);i>0&&n.logData({name:"OfficeDocument.Clicked",extraData:{extension:t,age:i,dateModified:e.dateModifiedValue}})}}}catch(e){}};return t}(r.default);t.default=b});
define("@ms/odsp-utilities/lib/images/ImagePromise",["require","exports","../async/Signal"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.request=function(e){var t=new n.default,r=document.createElement("img");r.onload=function(){t.complete()};r.onerror=function(){t.error()};r.src=e;return t.getPromise()}});
define("odsp-next/providers/instrumentation/Page.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Page=n.createPairedEvent({eventName:"Page,",shortEventName:"Page"},{previousName:1,currentName:1});t.default=t.Page});
define("odsp-next/models/search/SearchSession.key",["require","exports","@ms/odsp-utilities/lib/guid/Guid","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id,factory:new r.ConstantResourceFactory(n.default.generate())})});
define("odsp-next/dataSources/feedback/odc/FeedbackDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/odc/DataRequest","@ms/odsp-utilities/lib/locale/Locale","@ms/odsp-utilities/lib/async/Promise","../../../resources/ODCResourceKeys","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._urlDataSource=t.resources.consume(u.urlDataSource);return t}t.prototype.getFeedbackUrl=function(){var e=new i.default,t=this._urlDataSource.getFeedbackUrl();return e.send({apiName:"GetFeedbackUrl",url:t}).then(function(e){var t=window.Flight&&window.Flight.version,n=$Config.isINT,r=window.FilesConfig&&window.FilesConfig.df,i="https://"+(n?"onedrive.live-int.com":"onedrive.live.com")+("/handlers/clientstring.mvc?mkt="+$Config.mkt+"&group=Parature"),o={v:"dev"===t?$Config.build+"-DF":t+(r?"-DF":""),isRtl:s.default.isRightToLeft?1:0,localeUrl:i,isDf:r?1:0,curUrl:window.location.href.replace(/authkey=![^&]*/i,"authkey=!!!")},u=n?"&ACSIdx=4":"",f=a.serializeQuery(o);return e.feedbackUrl+encodeURIComponent(encodeURIComponent("&"+f))+u},function(e){return o.default.wrapError(e)})};t.prototype.getFeedbackEndpoints=function(){return["https://onedrive-feedback.ts.parature.com","https://onedrivesmoketest.azurewebsites.net"]};return t}(r.default);t.default=f});
define("odsp-next/dataSources/sendFeedback/odc/SendFeedbackDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/odc/DataRequest","@ms/odsp-utilities/lib/async/Promise","../../url/odc/UrlDataSource","../../../resources/ODCResourceKeys","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/guid/Guid","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._platform=t.resources.consume(l.platformDetection);t._urlDataSource=t.resources.consume(u.urlDataSource);return t}t.prototype.sendFeedback=function(e){var t=FilesConfig.SuiteNavConfig.UserDisplayName,n=$Config.email,r="\r\n",u=this._getBoundaryString(),f=window.FilesConfig&&window.FilesConfig.df,l=this._platform.osName+" "+this._platform.osVersion,c=$Config.pageContextInfo.pageType,h=a.format(o.default.feedbackBaseUrl,o.default.viewerId)+"/SendFeedback?mkt="+$Config.mkt,p=this._platform.browserName,d=this._platform.browserMajor,v=new i.default,m={};m["Content-Type"]="multipart/related; boundary="+u;var g="\r\n--"+u+r+"Content-ID: <Feedback>"+r+"Content-Type: application/json"+r+r+JSON.stringify({device:{platform:"Web",platformVersion:l,deviceModel:p,deviceVersion:d},appVersion:Flight.version,feedbackType:"Bug",app:"OneDrive",isDogfoodBuild:f?1:0,comment:e,backendVersion:c,user:{email:n,firstName:t,isBusiness:!1,authType:"MSA",authEnvironment:"Prod"},extraData:[{id:"360018226372",value:Flight.session}]})+r+r+"--"+u+r;return v.send({headers:m,apiName:"SendFeedback",url:h,requestType:"POST",postData:g,returnRawXHR:!0,useDefaultHeaders:!0}).then(function(e){return s.default.wrap(e.statusText)},function(e){return s.default.wrapError(e)})};t.prototype._getBoundaryString=function(){return f.default.generate()};return t}(r.default);t.default=c});
define("odsp-next/dataSources/userActivity/odc/UserActivityDataSource",["require","exports","tslib","../../base/odc/DataRequest","../../../models/item/ItemType","../../url/odc/UrlDataSource","@ms/odsp-shared/lib/base/BaseModel","../../../resources/ODCResourceKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="system",f="anonymous";function l(e){return e.userId!==a&&e.userId!==f}var c=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(u.urlDataSource);return n}t.prototype.getActivities=function(){var e=this,t=this._getActivityUrl();return(new r.default).send({apiName:"GetActivites",url:t,requestType:"GET"}).then(function(t){for(var n,r=[],s=0,o=t.activities;s<o.length;s++){for(var u=o[s],a=[],f=0,c=u.actors;f<c.length;f++){var h=c[f],p=e._getActorImageUrl(h);a.push({userId:h.id,name:h.displayName,email:"",image:p})}var d=void 0;switch(u.object.it){case 3:d=i.default.File;break;case 6:case 5:case 4:d=i.default.Media;break;case 2:d=i.default.Folder;break;default:d=i.default.Unknown}var v=u.object.rid,m=1===a.length&&l(a[0])?a[0]:void 0;r.push({actors:a,item:{id:v,name:u.object.n,itemType:d},message:u.messageText,timestamp:new Date(u.timestamp),key:e._urlDataSource.getKey((n={},n.id=v,n.cid=m?m.userId:void 0,n))})}return{activities:r}})};t.prototype._getActivityUrl=function(){return s.default.activityApiBaseUrl+"Activities?$take=20"};t.prototype._getActorImageUrl=function(e){return e.id===a?"https://p.sfx.ms/Activity/v1/od_icon_96x96_square.png":e.id===f?null:s.default.getProfileImage(e.id)};return t}(o.default);t.default=c});
define("odsp-next/providers/userActivity/UserActivityProvider",["require","exports","../../resources/DataSourceResourceKeys"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._dataSource=this.resources.consume(n.userActivity)}e.prototype.getActivities=function(){return this._dataSource.getActivities()};return e}();t.default=r});
define("odsp-next/providers/feedback/FeedbackProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._feedbackDataSource=n.resources.consume(s.feedback);return n}t.prototype.getFeedbackUrl=function(){return this._feedbackDataSource.getFeedbackUrl().then(function(e){return e},function(e){return i.default.wrapError(e)})};t.prototype.getFeedbackEndpoints=function(){return this._feedbackDataSource.getFeedbackEndpoints()};return t}(r.default);t.default=o});
define("odsp-next/providers/embed/EmbedProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._embedDataSource=n.resources.consume(i.embed);return n}t.prototype.getEmbedInfo=function(e){return this._embedDataSource.getEmbedInfo(e)};return t}(r.default);t.default=s});
define("odsp-next/dataSources/embed/odc/EmbedDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/odc/DataRequest","@ms/odsp-utilities/lib/async/Promise","../../../resources/ODCResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._urlDataSource=t.resources.consume(o.urlDataSource);return t}t.prototype.getEmbedInfo=function(e){var t=this,n=new i.default,r=this._urlDataSource.getEmbedInfoUrl(e);return n.send({apiName:"GetEmbedInfo",url:r,useDefaultHeaders:!0,isErrorExpectedCallback:this._isExpected}).then(function(e){return{embedCode:e.embedCode,embedUrl:e.embedUrl,configuratorUrl:e.embedConfiguratorUrl}},function(e){return t._isExpected(e)?null:s.default.wrapError(e)})};t.prototype._isExpected=function(e){return e&&e.data&&3017===e.data.code};return t}(r.default);t.default=u});
define("odsp-next/providers/userInfo/UserInfoProvider",["require","exports","tslib","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../models/upsell/AvailableUpsells"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.dataSource=n.resources.consume(r.userInfo);n.canPersistUserInfo=n.dataSource.canPersistUserInfo();return n}t.prototype.getAnid=function(){return this.dataSource.getAnid()};t.prototype.isAuthenticated=function(){return this.dataSource.isAuthenticated()};t.prototype.getUserInfo=function(e){var t=this;return e||!this._cachedUserInfo?this.isAuthenticated()?this.dataSource.getUserInfo(e).then(function(e){t._cachedUserInfo=e;return e},function(e){return i.default.wrapError(null)}):i.default.wrap(null):i.default.wrap(this._cachedUserInfo)};t.prototype.setUserInfo=function(e,t,n,r,i){return this.dataSource.setUserInfoWithUserFacts(e,t,n,r,i)};t.prototype.resetUpsellUserFact=function(){return this.dataSource.resetUpsellUserFact()};t.prototype.getBubbleUserFact=function(e,t){var n=this;return this.dataSource.getBubbleUserFact?this.dataSource.getBubbleUserFact(e,t):this.getUserInfo(t).then(function(t){if(t&&t.info)for(var r=0,i=t.info;r<i.length;r++){var s=i[r],o=n.peekUnwrapObservable(e),u=n.peekUnwrapObservable(o.campaignGuid);if(s.id&&s.id.toLowerCase()===u.toLowerCase())return JSON.parse(s.data)}return{d:!1,v:0}},function(e){return i.default.wrapError(null)})};t.prototype.setBubbleUserFact=function(e,t){return this.dataSource.setBubbleUserFact?this.dataSource.setBubbleUserFact(e,t):this.setUserInfo(17,3,null,e.campaignGuid,JSON.stringify(t))};t.prototype.getSurveyStatusUserFact=function(e,t){return this.getUserInfo(t).then(function(t){if(t&&t.info)for(var n=0,r=t.info;n<r.length;n++){var i=r[n];if(i.id&&i.id.toLowerCase()===e.toLowerCase())return{activated:JSON.parse(i.data).a,dateLastModified:new Date(i.modifiedDate)}}return{activated:!1,dateLastModified:new Date}})};t.prototype.setSurveyStatusUserFact=function(e,t){return this.setUserInfo(47,3,null,e,JSON.stringify(t))};t.prototype.getUpsellDismissedById=function(e,t){return this.dataSource.getUpsellDismissedById(e,t)};t.prototype.getUpsellViewCountById=function(e,t){return this.dataSource.getUpsellViewCountById(e,t)};t.prototype.markUpsellAsSeen=function(e){return this.dataSource.markUpsellAsSeen(e)};t.prototype.markUpsellAsDismissed=function(e){return this.dataSource.markUpsellAsDismissed(e)};t.prototype.updateUpsellData=function(e,t,n){return this.dataSource.updateUpsellData(e,t,n)};t.prototype.hasUserFact=function(e){return this.dataSource.hasUserFact(e)};t.prototype.getUserFact=function(e){return this.dataSource.getUserFact(e)};t.prototype.getIsPremium=function(e){return this.dataSource.getIsPremium(e)};t.prototype.getUpsellToShow=function(e){return this.dataSource.getUpsellToShow(e)};t.prototype.getUpsellViewCount=function(e){return this.dataSource.getUpsellViewCount(e)};t.prototype.getUpsellDismissed=function(e){return this.dataSource.getUpsellDismissed(e)};t.prototype.getUpsellIframeSrc=function(e,t){return this.dataSource.getUpsellIframeSrc(e,t)};t.prototype.getUpsellVariationIfApplicable=function(e){return e.variation?o.default[e.variation]:e};t.prototype.sendShowUpsell=function(e,t,n){return this.dataSource.sendShowUpsell(e,t,n)};t.prototype.sendCloseUpsell=function(e,t,n){return this.dataSource.sendCloseUpsell(e,t,n)};t.prototype.getMarket=function(){return this.dataSource.getMarket()};t.prototype.getFirstRunExperienceDismissed=function(){return this.dataSource.getFirstRunExperienceDismissed()};t.prototype.getFirstRunExperienceViewCount=function(){return this.dataSource.getFirstRunExperienceViewCount()};t.prototype.updateFirstRunExperienceData=function(e,t){return this.dataSource.updateFirstRunExperienceData(e,t)};t.prototype.hasPositioningBeenViewed=function(){return this.dataSource.hasPositioningBeenViewed()};t.prototype.datePositioningViewed=function(){return this.dataSource.datePositioningViewed()};t.prototype.getPremiumUpsellsViewed=function(){return this.dataSource.getPremiumUpsellsViewed()};t.prototype.getMostRecentNewFeaturesUpsellViewed=function(){return this.dataSource.getMostRecentNewFeaturesUpsellViewed()};t.prototype.setPositioningUserFactWithParams=function(e){return this.dataSource.setPositioningUserFactWithParams(e)};t.prototype.getGuidedTourCompleted=function(){return this.dataSource.getGuidedTourCompleted()};t.prototype.getGuidedTourViewCount=function(){return this.dataSource.getGuidedTourViewCount()};t.prototype.updateGuidedTourData=function(e,t){return this.dataSource.updateGuidedTourData(e,t)};t.prototype.completeGuidedTourAction=function(e){return this.dataSource.completeGuidedTourAction(e)};t.prototype.getCompletedGuidedTourActions=function(){return this.dataSource.getCompletedGuidedTourActions()};t.prototype.getExpiringSharingLinksSeen=function(){return this.dataSource.getExpiringSharingLinksSeen()};t.prototype.setExpiringSharingLinksSeen=function(){return this.dataSource.setExpiringSharingLinksSeen()};t.prototype.getEXPExperimentVariation=function(e){return this.dataSource.getEXPExperimentVariation(e)};t.prototype.setEXPExperimentVariation=function(e,t,n){return this.dataSource.setEXPExperimentVariation(e,t,n)};t.prototype.getFluentLightBoxUserFact=function(){return this.dataSource.getFluentLightBoxUserFact()};t.prototype.setFluentLightBoxUserFact=function(e,t){return this.dataSource.setFluentLightBoxUserFact(e,t)};return t}(s.default);t.default=u});
define("odsp-next/providers/ransomwareDetection/RansomwareDetectionProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../resources/ProviderResourceKeys","../../resources/DataSourceResourceKeys","../../resources/ControlResourceKeys","../../dataSources/url/PageType"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.pageType=n.pageType;r._urlDataSource=n.urlDataSource;r._navigation=n.navigation;r._ransomwareDetectionDataSource=n.ransomwareDataSource;r.activeAnomaly=r.observables.create();r.createBackgroundComputed(function(){var e=r.activeAnomaly.peek()||r.activeAnomaly();r._redirectByAnomalyState(e&&e.state)});return r}t.prototype.checkActiveAnomalies=function(){var e=this;return this._ransomwareDetectionDataSource.getActiveAnomaly().then(function(t){e.activeAnomaly(t);return t})};t.prototype.getAnomalyDetectedDate=function(){var e=this;return this._ransomwareDetectionDataSource.getActiveAnomaly(!0).then(function(t){if(t&&t.detectedDateTime){var n=e.activeAnomaly.peek();n.detectedDateTime=t.detectedDateTime;n.id=t.id;e.activeAnomaly(n)}return t&&t.detectedDateTime})};t.prototype.updateActiveAnomalyState=function(e){var t=this.activeAnomaly();return t?this._ransomwareDetectionDataSource.updateAnomalyState(t.id,e):Promise.resolve(null)};t.prototype._redirectByAnomalyState=function(e){switch(e){case 0:case 1:this.pageType()!==f.default.RansomwareDetection&&this._navigation.updateViewParams({v:"RansomwareDetection"},{ignoreHistory:!0});break;case 2:this.pageType()!==f.default.Restore&&this._navigation.updateViewParams({v:"restore"},{ignoreHistory:!0});break;case 4:case 3:case 5:this.pageType()===f.default.RansomwareDetection&&this._navigation.navigateTo({url:this._urlDataSource.getCurrentPageBaseUrl()});break;default:return}};t.dependencies=n.__assign({},r.default.dependencies,{bundleLoaderProvider:o.bundleLoader,pageType:a.currentPage,urlDataSource:u.url,navigation:s.navigation,ransomwareDataSource:u.ransomwareDetection});return t}(r.default);t.default=l;t.resourceKey=i.createResolvedResourceKey(e("module").id,l)});
define("odsp-next/providers/tag/TagProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../utilities/tag/GroupPacker","@ms/odsp-utilities/lib/async/Promise","../../resources/DataSourceResourceKeys","../../resources/ProviderResourceKeys","../../models/itemSet/ItemSet","../item/ItemProvider","../../dataSources/item/ItemTaskObserver","../../models/photo/AllPhotosSet","../../models/store/ItemsStore","../../models/item/OneDriveItem","../../models/tag/TagType","../../dataSources/url/QueryType","../../utilities/regex/Regex","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-datasources/lib/Permissions","../../dataSources/base/odc/ItemErrorProcessor","../../models/item/ItemType","../../models/item/VirtualItemType","@ms/odsp-utilities/lib/async/Semaphore","knockout"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._store=n.resources.consume(h.resourceKey);n._tagDataSource=n.resources.consume(o.tag);n._photoProvider=n.resources.consume(u.photo);n._identityDataSource=n.resources.consume(o.identity);n._urlDataSource=n.resources.consume(o.url);n._itemErrorProcessor=new(n.managed(b.default));return n}t.prototype.getAllTags=function(e){var t=this,n=this.getAllTagsSync(e,d.default.allTags);return n.isPlaceholder||n.isExpired?this._tagDataSource.getAllTags(d.default.allTags).then(function(r){t._clearPlaceholder(n.item.peek());var s=[],o=[];i.packAllTags(t._normalizeTags(r.tags),e.skipGrouping?1:0,s,o,e);n.isExpired=!1;n.isPlaceholder=!1;n.content({items:s,groupings:o});return n},function(e){t._processError(n.item.peek().key,e);return s.default.wrapError(e)}):n.content.peek().items.length>0?this._getThumbnails(n,e,d.default.allTags):s.default.wrap(n)};t.prototype.ensureHasThumbnails=function(e,t,n){for(var r=e.content.peek().items,i=0;i<r.length;i++)!r[i].peek().folder.covers.length&&i>=t.start&&i<=t.end&&this._fetchThumbnails(r[i],d.default.allTags,n)};t.prototype.getAllTagsForQuery=function(e,t){var n=this._photoProvider.getAllPhotosSettings().peek();return this.getAllTags({parentKey:null,startIndex:0,skipGrouping:!0,rootItemId:n.rootId}).then(function(n){for(var r=[],i=n.content.peek().items,s="#"===e[0]?e.substring(1):e,o=new RegExp("(^|\\s|/)"+m.default.escapeUserInput(s),"i"),u=new a.default,f="",l={},c=0,h=t;c<h.length;c++){l[h[c].toLocaleLowerCase()]=!0}for(var p=0,d=i;p<d.length;p++){var v=d[p];f=v.peek().name;e&&!o.test(f.substring(1))||l[f.toLocaleLowerCase()]||r.push(v)}u.item=n.item;u.content.peek().items=r;return u})};t.prototype.getAllPlaces=function(e){var t=this,n=this.getAllTagsSync(e,d.default.allPlaces);if(n.isPlaceholder||n.isExpired){var r=[],o=[],u=[];r.push(this._fetchRecentPlaces(o));r.push(this._fetchPlaceTags(n.item.peek().key,u));return s.default.all(r).then(function(){var r=[],s=[],a=t._urlDataSource.getAllPhotosForPlaceUrl.bind(t._urlDataSource);i.packAllPlaces(o,u,r,s,e,a);n.isPlaceholder=!1;t._clearPlaceholder(n.item.peek());n.content({items:r,groupings:s});return n},function(e){return s.default.wrapError(e)})}return this._getThumbnails(n,e,d.default.allPlaces)};t.prototype.getAllTagsSync=function(e,t){var n=this._getAllTagsSetKey(t,e),r=this._store.getItemSet(n);if(!r){var i=this._tagDataSource.getParentKeyForTagType(t),s=this._store.getItem(i);if(!s){var o=new p.default(i);o.type=w.default.Folder;o.virtualItemType=E.default.TagsRoot;o.queryType=v.default.AllMyPhotos;o.isRootFolder=!0;this._store.setItem(o);s=this._store.getItem(i)}(r=new c.default(n,e)).item=s;this._store.setItemSet(n,r)}return r};t.prototype.updateTags=function(e){var t=this,n=this.resources.consume(f.resourceKey);return this._tagDataSource.updateTags(e).then(function(r){for(var i,s=e.skipInvalidate,u=0,a=e.items.length;u<a;u++)if((i=e.items[u]).parent)if(s){var f={parentKey:i.key,ownerId:t._urlDataSource.getOwnerId(),skipCache:!0};n.getItem(f)}else n.invalidateItem(i.parent.key);if(e.parentKey&&!s){n.invalidateItem(e.parentKey);t.resources.consumeAsync(o.itemInvalidator).then(function(e){e.invalidateAllPhotosRootItem()})}t.invalidateAllTags("root");for(var l=0,c=[].concat(e.tagsToAdd).concat(e.tagsToDelete);l<c.length;l++){var h=c[l];h&&h.tag&&t._store.invalidateTag(h.tag)}return r},function(e){return s.default.wrapError(e)})};t.prototype.invalidateAllTags=function(e){var t={parentKey:null,skipGrouping:!1};this._store.invalidateItemSet(this._getAllTagsSetKey(d.default.allTags,t));t.skipGrouping=!0;this._store.invalidateItemSet(this._getAllTagsSetKey(d.default.allTags,t))};t.prototype._getThumbnails=function(e,t,n){for(var r=this,i=e.content.peek().items,o=[],u=Math.min(i.length,t.endIndex),a=new S.default(4),f=function(e,t,n){return function(){return r._fetchThumbnails(e,t,n)}},l=t.startIndex;l<u;l++){var c=i[l].peek();c&&!c.folder.covers.length&&o.push(a.enqueue(f(i[l],n,t)))}return s.default.all(o).then(function(){return e},function(e){return s.default.wrapError(e)})};t.prototype._fetchThumbnails=function(e,t,n){var r=this,i={parentKey:n.parentKey,rootItemId:n&&n.rootItemId,ascending:n&&n.ascending,pageSize:5,startIndex:0};switch(t){case d.default.allTags:i.tagFilter=e.peek().id;break;case d.default.allPlaces:i.locationFilter=e.peek().id;break;default:return s.default.wrap()}return this._photoProvider.getAllPhotos(i).then(function(t){for(var n=[],i=0,o=t;i<o.length;i++){var u=o[i];u.thumbnail&&n.push(u.thumbnail)}var a=new p.default(e.peek().key);x.utils.extend(a,e.peek());a.folder=x.utils.extend({},e.peek().folder);a.folder.covers=n;e(a);r._store.setItem(a);return s.default.wrap()},function(e){return s.default.wrapError(e)})};t.prototype._fetchRecentPlaces=function(e){var t={parentKey:void 0,startIndex:0,pageSize:100};return this._photoProvider.getAllPhotos(t).then(function(t){for(var n=t.length,r=0;e.length<5&&r<n;r++){var i=t[r].geoLocation,o=i&&i.hierarchyIndex;if(o){o=o.trim();e.indexOf(o)<0&&e.push(o)}}return s.default.wrap()},function(e){return s.default.wrapError(e)})};t.prototype._fetchPlaceTags=function(e,t){var n=this;return this._tagDataSource.getAllTags(d.default.allPlaces).then(function(e){for(var n=0,r=e.locations;n<r.length;n++){var i=r[n],o=i.hierarchyIndex&&i.hierarchyIndex.trim();if(o){i.hierarchyIndex=o;t.push(i);if(!i.country){var u=o.split("\t");i.country=u[0];!i.city&&u.length>1&&(i.city=u[u.length-1])}}}return s.default.wrap()},function(t){n._processError(e,t);return s.default.wrapError(t)})};t.prototype._processError=function(e,t){2===(t&&t.data&&t.data.code||0)&&this._identityDataSource.getIdentity().type===y.IdentityType.anonymous&&(t.data.code=152);var n=new(this.resources.consume(l.resourceKey));this._itemErrorProcessor.processError({requestKey:e,error:t,observer:n});n.flush()};t.prototype._getAllTagsSetKey=function(e,t){var n={tagType:d.default[e],grouped:t.skipGrouping?0:1};return g.serializeQuery(n,null,!0)};t.prototype._normalizeTags=function(e){for(var t={},n=[],r=0,i=e;r<i.length;r++){t[f=(a=i[r]).localizedTag||a.tag]?n.push(f):t[f]=!0}if(n.length){for(var s=[],o=0,u=e;o<u.length;o++){var a,f=(a=u[o]).localizedTag||a.tag,l=-1!==n.indexOf(f);(!l||l&&a.localizedTag!==a.tag)&&s.push(a)}return s}return e};t.prototype._clearPlaceholder=function(e){if(e.isPlaceholder){var t=new p.default(e.key);x.utils.extend(t,e);t.isPlaceholder=!1;t.queryType=v.default.AllMyPhotos;t.type=w.default.Folder;this._store.setItem(t)}};return t}(r.default);t.default=T});
define("odsp-next/models/photo/AllPhotosSet",["require","exports","knockout","../itemSet/ItemSetContent","@ms/odsp-shared/lib/utilities/object/EqualityComparers"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e,t){this.key=e||"";this.content=n.observable(new r.default);this.content.equalityComparer=i.objectStrictEquality;this.schema=n.observableArray([]);this.schema.equalityComparer=i.arrayStrictEquality;this.context=n.utils.extend({},t);this.isPlaceholder=!0};t.default=s});
define("odsp-next/utilities/regex/Regex",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}e.escapeUserInput=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")};return e}();t.default=n});
define("odsp-next/providers/photo/PhotoProvider",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../ProviderHelpers","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/locale/Locale","../../models/photo/AllPhotosSet","../../models/store/ItemsStore","../../models/item/OneDriveItem","../../models/item/ItemType","../../models/item/VirtualItemType","../../dataSources/url/QueryType","../item/ItemProvider","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-utilities/lib/dateTime/DateTime","./logging/OnThisDay.event"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y,b=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._store=n.resources.consume(f.resourceKey);n._photoDataSource=n.resources.consume(o.photo);n._urlDataSource=n.resources.consume(o.url);n._itemProvider=n.resources.consume(d.resourceKey);n.pages={};n._photoSetIsUpdating={};n._indicesBeingRequested={};n._pendingMetadataRequests={};n._totalChildCount={};n._photoGroupingData={};n._photoKeyToIndexMap={};var r=function(){if(!y)for(var e=[window.$Config&&window.$Config.mkt,u.default.language,navigator.language,"en"],t=0,n=e;t<n.length;t++){var r=n[t];if(r)try{(new Date).toLocaleDateString(r);y=r;break}catch(e){}}return y}();n._formatDate=function(e){return e.toLocaleDateString(r)};if("Intl"in window&&"object"==typeof window.Intl)try{n._dateFormatter=new Intl.DateTimeFormat(r,{month:"long",day:"numeric"});n._formatDate=n._dateFormatter.format}catch(e){}return n}t.prototype.getAllPhotos=function(e){var t=this,n=this.getAllPhotosSync(e),r=n.content.peek().items;e.tagFilter&&(e.tagFilter=decodeURIComponent(e.tagFilter));return this._photoDataSource.getAllPhotos(e).then(function(i){n.isPlaceholder=!1;if(n.isExpired){var s=Math.max(t._getAllPhotosCount(n.key).peek(),0);r=new Array(s)}var o=i.items,u=e.tagFilter?[]:t._mergeGroupings(n,i);t._mergeItemSets(i,n,e,r);n.content({items:r,groupings:u});return o})};t.prototype.determineStartEndRange=function(e,t,n){if(0===n)return{start:0,end:0};if(t.isExpired)return this.determineStartEndRangeForExpiredSet(e);var r=e.startIndex,i=e.endIndex||r+(e.pageSize||200);i=n>0?Math.min(n,i):i;return{start:r=Math.max(0,Math.min(i,r)),end:i}};t.prototype.determineStartEndRangeForExpiredSet=function(e){var t=this.getPhotoSetKey(e),n=e.startIndex;n<0&&(n=0);var r=e.pageSize;if(n<r&&e.endIndex<r)return{start:0,end:r};var i=this.findMonthGroupingByIndex(t,n);if(!i)return{start:0,end:0};r=i.count;return{start:i.startIndex,end:i.startIndex+r}};t.prototype.hasAllItemsInRange=function(e,t,n,r,s){return!s&&!!t.length&&!e.isExpired&&(r<=0||i.resultSetHasData(t,{start:n,end:r}))||!e.isExpired&&this._areAllPhotosInSetBeingRequested(e.key,t,n,r)};t.prototype.getAllPhotosForPage=function(e){var t,n=this,i=this.getAllPhotosSync(e);switch(e.photoType){case 0:case 6:i.isPlaceholder&&this.getAllPhotosMetadata(e).done(function(e){n.virtualizeAllPhotosSet(i)})}if(i.isExpired){this._invalidatePhotoSet(i.key);t=this.getAllPhotosMetadata(e)}return r.default.wrap(t).then(function(t){var s=i.content.peek().items;e.endIndex>0&&!s[e.endIndex]&&(e.endIndex=e.endIndex+1);var o=n.determineStartEndRange(e,i,s.length),u=o.start,a=o.end,f=!!t&&s.length!==t.items.length&&0!==s.length;if(n.hasAllItemsInRange(i,s,u,a,f))return r.default.wrap(i);if(i.isExpired){var l=Math.max(n._getAllPhotosCount(i.key).peek(),0);s=new Array(l)}var c=[],h=n.getPageForIndex(i.key,u,a),p=n.getPastPageForIndex(i.key,u,a,e.pageSize),d=n.getFuturePageForIndex(i.key,u,a,e.pageSize),m=n.findMonthGroupingByIndex(i.key,u),g=n.determinePagingTypeForContext(u,a,p,d,m,e.pageSize),y=v.deepCopy(e);if(1===g){if(!p.pastPagingToken)return;y.pagingToken=p.pastPagingToken;y.startIndex=p.endIndex;y.endIndex=p.endIndex+e.pageSize}else if(2===g){if(!d.futurePagingToken)return;y.pagingToken=d.futurePagingToken;y.startIndex=d.startIndex-e.pageSize;y.endIndex=d.startIndex;y.ascending=!0}else if(3===g){var b=!0,w=n._getStartDateForMonthGroup(m,b),E=m.count>e.pageSize,S=E?e.pageSize:m.count,x=m.startIndex+m.count;if(e.jumpToStartDate){w=e.jumpToStartDate;var T=e.endIndex-e.startIndex;S=(E=T>e.pageSize)?e.pageSize:T;x=e.endIndex;b=e.ascending}if(!w)return r.default.wrap(i);y.startDate=w;y.startIndex=x-S;y.endIndex=x;y.pageSize=S;y.ascending=b;if(E)for(var N=0,C=c=n.makeBatchedContextsForDateJumping(y,m,S);N<C.length;N++){var k=C[N];n._storePage(null,i,k)}}else if(0===g){y.startIndex=u;y.endIndex=e.pageSize}h=n._storePage(h,i,y);c.unshift(y);var L=function(e){return n._photoDataSource.getAllPhotos(e).then(function(t){i.isPlaceholder=!1;for(var r=e.startIndex;r<e.endIndex;r++){var o=r-e.startIndex,u=t.items[o];u&&(n._photoKeyToIndexMap[u.key]=r)}if(!(h=n.getPageForIndex(i.key,e.startIndex,e.endIndex))){h={startIndex:e.startIndex,endIndex:e.endIndex};n.insertPage(i.key,h)}if(!h.futurePagingToken&&!h.pastPagingToken){h.futurePagingToken=t.futurePagingToken;h.pastPagingToken=t.pastPagingToken}var a=e.tagFilter?[]:n._mergeGroupings(i,t);n._mergeItemSets(t,i,e,s);for(r=e.startIndex;r<=e.endIndex;r++)n._indicesBeingRequested[i.key][r]=!1;if(c&&c.length){var f=e.ascending?c.shift():c.pop();f.pagingToken=e.ascending?t.futurePagingToken:t.pastPagingToken;f.ascending=e.ascending;h=n.getPageForIndex(i.key,f.startIndex,f.endIndex);h=n._storePage(h,i,f);n._photoSetIsUpdating[i.key]=!0;return L(f)}i.isExpired=!1;i.content({items:s,groupings:a});n._photoSetIsUpdating[i.key]=!1;return i},function(e){for(var t=!0,n=0,i=s;n<i.length;n++){var o=i[n];if(o&&o.peek()){t=!1;break}}if(t)return r.default.wrapError(e)})};return 1===c.length?L(c.shift()):r.default.all([L(c.shift()),L(c.pop())])},function(e){})};t.prototype.makeBatchedContextsForDateJumping=function(e,t,n){for(var r=[],i=Math.ceil((t.count-e.pageSize)/e.pageSize),s=1;s<=i;s++){var o=v.deepCopy(e),u=n*s,a=e.startIndex-u;o.startIndex=a<0?0:a;o.endIndex=e.endIndex-u;if(s===i){o.ascending=!1;o.startDate=m.getLastDayOfMonth(this.getDateStringForAllPhotos(new Date(Date.parse(t.data.isoDate)),!0)).toISOString();o.startIndex=t.startIndex;o.pageSize=Math.abs(o.endIndex-o.startIndex)}else{o.ascending=!0;delete o.startDate}r.push(o)}return r};t.prototype.virtualizeAllPhotosSet=function(e){var t=e.content.peek(),n=t.items,r=!1,i=this._getAllPhotosCount(e.key).peek();if(-1!==i)if(n.length<i){for(var s=n.length;s<i;s++)n.push(null);r=!0}else if(n.length>i){var o=n.length-i;n.splice(-1*o);r=!0}r&&e.content({items:n,groupings:t.groupings})};t.prototype.determinePagingTypeForContext=function(e,t,n,r,i,s){var o=0;n&&e<=n.endIndex?o=1:r&&e<r.startIndex?o=2:e<s&&t<=s?o=0:i&&(o=3);return o};t.prototype.getItemSync=function(e){var t=this._photoDataSource.getItemKey(e),n=this._store.getItem(t);if(!n){var r=new l.default(t);r.properties.commandsSupported={defc:"1"};r.queryType=p.default.AllMyPhotos;r.displayType=p.default.AllMyPhotos;r.type=c.default.Folder;if(e.tagFilter){var i=e.tagFilter.split(";"),s=i[0],o=i[1];r.virtualItemType=h.default.Tag;r.name="#"+s;r.tags=[{source:null,type:null,tag:s,localizedTag:o}]}if(e.onThisDay){r.folder={childCount:0,photoCount:0,covers:[]};r.ownerId=this._urlDataSource.getOwnerId(t);var u=new Date(Date.parse(e.startDate));r.dateTakenTime=u;r.isAlbum=!0;r.virtualItemType=h.default.Album}e.tagFilter||e.locationFilter||(r.isRootFolder=!0);n=this._store.setItem(r)}return n};t.prototype.getAllPhotosSync=function(e){var t=this.getPhotoSetKey(e),n=this._store.getItemSet(t),r=this.getItemSync(e);if(!n){var i=e.ascending,s=void 0!==i&&i;(n=new a.default(t,e)).content.peek().groupings=[];n.item=r;n.isAscending=s;this._store.setItemSet(t,n)}return n};t.prototype.getAllPhotosMetadata=function(e){var t=this,n=this._photoDataSource.getMetadataContext(e),i=this.getPhotoSetKey(e);if(this._pendingMetadataRequests[i])return this._pendingMetadataRequests[i];var s=!1,o=this._itemProvider.getItem(n).then(function(e){var n=e.content.peek(),r=t.getPhotoGroupingData(i);t._totalChildCount[i]?t._totalChildCount[i](n.items.length):t._totalChildCount[i]=t.createObservable(n.items.length);var o=t._getGroupingByKey(n.groupings,"Month");r.itemGroup(o.itemGroups);var u=t._store.getItemSet(i),a=n.groupings,f=u.content.peek().groupings||[];if(u&&a){for(var l=!1,c=0,h=a;c<h.length;c++){for(var p=h[c],d=!1,v=0;v<f.length;v++){var m=f[v];if(m&&m.name===p.name){d=!0;if(m!==p){l=!0;f.splice(v,1);break}}}d||(l=!0)}if(l){f.splice.apply(f,[0,0].concat(a));u.content({items:u.content.peek().items,groupings:f})}}t._resolvePhotoSetGroupingData(i);s=!0;delete t._pendingMetadataRequests[i];return n},function(e){t._resolvePhotoSetGroupingData(i);delete t._pendingMetadataRequests[i];s=!0;return r.default.wrapError(e)});s||(this._pendingMetadataRequests[i]=o);return o};t.prototype.getPhotoGroupingData=function(e){this._photoGroupingData[e]||(this._photoGroupingData[e]={hasResolved:this.createObservable(!1),itemGroup:this.observables.createArray([])});return this._photoGroupingData[e]};t.prototype.getOnThisDayPhotos=function(e){var t,n=this,i=this.getAllPhotosSync(e),s=0===e.startIndex;s&&(t=new g.OnThisDay);return i.isPlaceholder||i.isExpired?this.getAllPhotosMetadata(e).then(function(o){for(var u=[],a=new Date(Date.parse(e.startDate)),f=n._getGroupingByKey(o.groupings,"Month"),c=a.getMonth(),h=a.getDate(),p=a.getFullYear(),d=new Date(p,c,h),m=new Date(p,c,h+1),g={},y=0,b=f.itemGroups;y<b.length;y++){var w=b[y],E=new Date(Date.parse(w.data.isoDate));if(!(E.getTime()>m.getTime())){var S=new Date(E.getTime());S.setUTCMonth(E.getUTCMonth()+1);for(;S.getTime()<=d.getTime()||d.getDate()!==h;){p--;d=new Date(p,c,h);m=new Date(p,c,h+1)}E.getTime()<m.getTime()&&S.getTime()>d.getTime()&&(g[d.toISOString()]=m.toISOString())}}for(var x in g)u.push({parentKey:void 0,startDate:x,endDate:g[x],highlights:e.highlights,pageSize:100,ascending:!0,rootItemId:e.rootItemId,startIndex:e.startIndex,endIndex:e.endIndex});return r.default.all(u.map(function(e){return n.getAllPhotos(e)})).then(function(r){var o,a=[].concat.apply([],r),f=[],c=null;if(a.length){c=u.map(function(e){return n.getAllPhotosSync(e)}).filter(function(e){return!!e.content.peek().items.length}).map(function(e){o||(o=new Date(Date.parse(e.context.startDate)));return e.content.peek().groupings[0]}).reduce(function(e,t){return{name:t.name,itemGroups:v.extend(e.itemGroups,t.itemGroups),groupMap:v.extend(e.groupMap,t.groupMap),groups:e.groups.concat(t.groups),groupType:2,itemToGroupMap:v.extend(e.itemToGroupMap,t.itemToGroupMap)}},{name:"",itemGroups:[],groupMap:{},groups:[],groupType:2,itemToGroupMap:{}});var h=0;c.groups=c.groups.map(function(e){e.startIndex=h;h+=e.keys.length;return e});f=a.map(function(e){return n._store.getItem(e.key)})}i.isPlaceholder=!1;i.isExpired=!1;var p=n.getItemSync(e).peek(),d={covers:a.map(function(e){return e.thumbnail}).filter(function(e){return!(!e||!e.url)}),photoCount:a.length},m=o?n._formatDate(o):"";i.item(v.extend(v.extend(new l.default(p.key),p),{childCount:a.length,folder:d,isPlaceholder:!1,name:m}));i.content({items:f,groupings:[c]});s&&t.end({itemsInFirstPage:f.length});return i},function(e){})}):r.default.wrap(i)};t.prototype.getPastPageForIndex=function(e,t,n,r){for(var i=0,s=this.pages[e]||(this.pages[e]=[]);i<s.length;i++){var o=s[i],u=o.endIndex+r,a=t<=o.endIndex&&t>=o.startIndex&&n<=u,f=t>=o.endIndex&&t<=u&&n<u,l=o.startIndex===t&&o.endIndex===n;if((a||f)&&!l)return o}return null};t.prototype.getFuturePageForIndex=function(e,t,n,r){for(var i=0,s=this.pages[e]||(this.pages[e]=[]);i<s.length;i++){var o=s[i],u=o.startIndex-r,a=n>=o.startIndex&&n<=o.endIndex&&t>=u,f=n>=o.startIndex&&n<=u&&t<=u,l=o.startIndex===t&&o.endIndex===n;if((a||f)&&!l)return o}return null};t.prototype.getPageForIndex=function(e,t,n){for(var r=0,i=this.pages[e]||(this.pages[e]=[]);r<i.length;r++){var s=i[r];if(t>=s.startIndex&&n<=s.endIndex)return s}return null};t.prototype.insertPage=function(e,t){for(var n=this.pages[e]||(this.pages[e]=[]),r=0;r<n.length;r++){var i=n[r];if(i.startIndex===t.startIndex&&i.endIndex===t.endIndex)return;if(t.endIndex<i.endIndex||t.endIndex===i.endIndex&&t.startIndex<i.startIndex){n.splice(r,0,t);return}}n.push(t)};t.prototype.findMonthGroupingByIndex=function(e,t){var n=this.getPhotoGroupingData(e),r=this.getPhotoGroupingData(e)&&n.itemGroup.peek();if(!r)return null;for(var i=0,s=r;i<s.length;i++){var o=s[i],u=o.startIndex+o.count;if(t>=o.startIndex&&t<u)return o}return null};t.prototype.getPhotoSetKey=function(e){return this._photoDataSource.getPhotoSetKey(e)};t.prototype.setAllPhotosSettings=function(e){return this._photoDataSource.setAllPhotosSettings(e)};t.prototype.getAllPhotosSettings=function(e){!e&&this._allPhotosSettings||(this._allPhotosSettings=this._photoDataSource.getAllPhotosSettings(e));return this._allPhotosSettings};t.prototype.getDateStringForAllPhotos=function(e,t){var n=new Date(e.getTime());n.setUTCDate(1);n.setUTCHours(0);n.setUTCMinutes(0);n.setUTCSeconds(0);n.setUTCMilliseconds(0);if(!t){var r=n.getUTCMonth();n.setUTCMonth(r+1)}return n};t.prototype._getGroupingByKey=function(e,t){for(var n=null,r=0,i=e;r<i.length;r++){var s=i[r];if(s&&s.name===t){n=s;break}}return n};t.prototype._mergeItemSets=function(e,t,n,r){var i=e.items,s=n.startIndex;if(n.ascending)for(var o=i.length-1;o>=0;o--,s++)r[s]=this._store.getItem(i[o].key);else for(o=0;o<i.length;o++,s++)r[s]=this._store.getItem(i[o].key);var u=this.getPhotoGroupingData(t.key),a=u&&u.itemGroup.peek().length>0,f=!e.futurePagingToken&&!e.pastPagingToken;(!n.locationFilter&&!n.tagFilter||n.pageSize!==i.length||f)&&(a||!u.hasResolved.peek()||f)||r.push(null)};t.prototype._getAllPhotosCount=function(e){var t=this._totalChildCount[e];t||(t=this._totalChildCount[e]=this.createObservable(-1));return t};t.prototype._storePage=function(e,t,n){if(!e){var r=t.key,i=n.startIndex,s=void 0===i?0:i,o=n.endIndex;e={startIndex:s,endIndex:void 0===o?n.pageSize:o};this.insertPage(r,e);var u=this._indicesBeingRequested[r];u||(u=this._indicesBeingRequested[r]={});for(var a=e.startIndex;a<e.endIndex;a++)u[a]=!0}return e};t.prototype._invalidatePhotoSet=function(e){delete this._photoGroupingData[e];delete this.pages[e];this._photoKeyToIndexMap={}};t.prototype._areAllPhotosInSetBeingRequested=function(e,t,n,r){var i=!0;if(!this._indicesBeingRequested[e])return!1;for(var s=n;s<r;s++)if(!this._indicesBeingRequested[e][s]){i=!1;break}return i};t.prototype._resolvePhotoSetGroupingData=function(e){this.getPhotoGroupingData(e).hasResolved(!0)};t.prototype._getStartDateForMonthGroup=function(e,t){var n,r;if(!e)return n;r=e.data.isoDate?new Date(Date.parse(e.data.isoDate)):this._getDateFromString(e.data.monthName,e.data.year);return(n=this.getDateStringForAllPhotos(r,t)).toISOString()};t.prototype._getDateFromString=function(e,t){var n=Date.parse(e+" 1, "+t);return isNaN(n)?null:new Date(n)};t.prototype._mergeGroupings=function(e,t){for(var n=e.content.peek().groupings,r=0,i=t.itemGroupings;r<i.length;r++){for(var s=i[r],o=s.groupType,u=void 0,a=0,f=n;a<f.length;a++){var l=f[a];if(l.groupType===o){u=l;break}}u||n.push(s);this._createMapsFromGroups(u||s,s)}return n};t.prototype._createMapsFromGroups=function(e,t){if(t)for(var n=0,r=t.groups;n<r.length;n++){var i=r[n],s=i.id;if(e.groupMap[s]){for(var o={},u=0,a=e.groupMap[s].keys;u<a.length;u++){o[d=a[u]]=!0}for(var f=0,l=i.keys;f<l.length;f++){o[d=l[f]]=!0}e.groupMap[s].keys=Object.keys(o)}else{e.groupMap[s]=i;e.groups.push(i)}for(var c=void 0,h=0,p=i.keys;h<p.length;h++){var d=p[h];e.itemToGroupMap[d]=s;var v=this._photoKeyToIndexMap[d];(void 0===c||v<c)&&(c=v)}i.startIndex=c}};return t}(s.default);t.default=b});
define("odsp-next/providers/photo/logging/OnThisDay.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OnThisDay=n.createPairedEvent({eventName:"OnThisDay,",shortEventName:"OnThisDay"},{itemsInFirstPage:2});t.default=t.OnThisDay});
define("odsp-next/providers/storageInfo/StorageInfoProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._storageInfoDataSource=n.resources.consume(i.storageInfo);return n}t.prototype.getStorageInfo=function(){return this._storageInfoDataSource.getStorageInfo()};t.prototype.redeemCode=function(e){return this._storageInfoDataSource.redeemCode(e)};t.prototype.sendInvitation=function(e){return this._storageInfoDataSource.sendInvitation(e)};return t}(r.default);t.default=s});
define("odsp-next/providers/storageOptions/StorageOptionsProvider",["require","exports","tslib","../../models/storageOptions/IStorageOptions","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","./StorageOptionsRequestor"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._storageOptionsDataSource=n.resources.consume(s.storageOptions);n._storageOptionsRequestor=new(n.managed(o.default));n._storageOptionsRequestor.updateStorageOptions();n.isReady=n.createPureComputed(n._computeIsReady);n.isEligibleForPremium=n.createPureComputed(n._computeIsEligibleForPremium);n.hasOffice=n.createPureComputed(n._computeHasOffice);n._data=n.createPureComputed(function(){return n._storageOptionsRequestor.storageOptionsData()});return n}t.prototype.getStorageOptions=function(){return this._storageOptionsDataSource.getStorageOptions()};t.prototype.getPremiumPurchaseInformation=function(e){var t=this;return this._storageOptionsRequestor.updateStorageOptions(e).then(function(e){var n=t._parsePremiumPlans(e),r=n[0],i=n[1];return r&&r.pricePerMonth?t._getPurchaseInfo(r,!0,!0):i&&i.pricePerMonth?t._getPurchaseInfo(i,!0,!1):r&&r.pricePerYear?t._getPurchaseInfo(r,!1,!0):i&&i.pricePerYear?t._getPurchaseInfo(i,!1,!1):void 0})};t.prototype.getHasCurrentOfficePlan=function(e){return this._storageOptionsRequestor.updateStorageOptions(e).then(function(e){return e.hasCurrentOfficePlan})};t.prototype.getIsEligibleForPremium=function(e){return this._storageOptionsRequestor.updateStorageOptions(e).then(function(e){if(e){if(e.hasCurrentOfficePlan)return!1;if(e.officePlans)for(var t=0,n=e.officePlans;t<n.length;t++){var i=n[t];if(r.PlanType[i.type]===r.PlanType.Home||r.PlanType[i.type]===r.PlanType.Personal||r.PlanType[i.type]===r.PlanType.Solo)for(var s=0,o=i.purchaseActions;s<o.length;s++){var u=o[s];if(1===u.durationInMonths||12===u.durationInMonths)return!0}}}return!1})};t.prototype._getPurchaseInfo=function(e,t,n){return{price:t?e.pricePerMonth:e.pricePerYear,purchaseUrl:t?e.secondaryOfficePlanUrl:e.mainOfficePlanUrl,planName:e.type,planType:n?r.PlanType.Personal:r.PlanType.Home}};t.prototype._parsePremiumPlans=function(e){var t,n;if(e&&e.officePlans)for(var i=0,s=e.officePlans;i<s.length;i++){var o=s[i];if(r.PlanType[o.type]!==r.PlanType.Trial){for(var u=0,a=o.purchaseActions;u<a.length;u++){var f=a[u];if(1===f.durationInMonths){o.pricePerMonth=f.price;o.secondaryOfficePlanUrl=f.purchaseUrl}if(12===f.durationInMonths){o.pricePerYear=f.price;o.mainOfficePlanUrl=f.purchaseUrl}}r.PlanType[o.type]===r.PlanType.Home?t=o:n=o}}return[n,t]};t.prototype._computeIsEligibleForPremium=function(){var e=this._data();if(e){if(e.hasCurrentOfficePlan)return!1;if(e.officePlans)for(var t=0,n=e.officePlans;t<n.length;t++){var i=n[t];if(r.PlanType[i.type]===r.PlanType.Home||r.PlanType[i.type]===r.PlanType.Personal||r.PlanType[i.type]===r.PlanType.Solo)for(var s=0,o=i.purchaseActions;s<o.length;s++){var u=o[s];if(1===u.durationInMonths||12===u.durationInMonths)return!0}}return!1}};t.prototype._computeHasOffice=function(){var e=this._data();if(e)return e.hasCurrentOfficePlan};t.prototype._computeIsReady=function(){return!!this._data()};return t}(i.default);t.default=u});
define("odsp-next/models/storageOptions/IStorageOptions",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Home=1]="Home";e[e.Personal=2]="Personal";e[e.Solo=3]="Solo";e[e.Trial=4]="Trial";e[e.Storage=5]="Storage"}(t.PlanType||(t.PlanType={}))});
define("odsp-next/providers/storageOptions/StorageOptionsRequestor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.storageOptionsData=n.createObservable(null);n._storageOptionsDataSource=n.resources.consume(i.storageOptions);return n}t.prototype.updateStorageOptions=function(e){void 0===e&&(e=!1);if(!e&&this.storageOptionsData.peek())return o.default.wrap(this.storageOptionsData.peek());var t=new s.Qos({name:"GetUpgradeOptionsRetry"});return this._storageOptionsHelper(0,t)};t.prototype._storageOptionsHelper=function(e,t){var n=this;if(e<=7)return this._storageOptionsDataSource.getStorageOptions().then(function(r){t.end({resultType:s.ResultTypeEnum.Success,extraData:{retries:e}});n.storageOptionsData(r);return r},function(r){r.data&&159===r.data.code?n.async.setTimeout(function(){n._storageOptionsHelper(e+1,t)},1e3):t.end({resultType:s.ResultTypeEnum.Failure,extraData:{retries:e}})});t.end({resultType:s.ResultTypeEnum.Failure,extraData:{retries:e}})};return t}(r.default);t.default=u});
define("odsp-next/providers/notification/NotificationProvider",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","../../models/notification/Notification","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t.handledNotifications={};t._notifications=r.observableArray([]);t._platformDetection=t.resources.consume(o.platformDetection);t.currentNotification=t.createComputed(function(){var e=t._notifications();return e.length&&e.sort(function(e,t){return e.severity===t.severity?0:e.severity>t.severity?-1:1})[0]||null});return t}t.prototype.requestNotification=function(e){var t=this,n=new s.default(e);if(!this._platformDetection.isIE||this._platformDetection.browserMajor>9){this._notifications.push(n);var r=function(){t._notifications.remove(n)};n.wait().then(r,r)}return n};return t}(i.default);t.default=u});
define("odsp-next/models/notification/Notification",["require","exports","tslib","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){var n=e.call(this,{})||this;n.text=t.text||"";n.severity=t.severity||1;n.dismissalType=t.dismissalType||2;n.timeout=t.timeout||0;n.action=t.action;n.actionText=t.actionText||"";n.isOpen=n.createObservable(!0);n.state=n.createObservable(1);n.canImplicitDismiss=2===n.dismissalType||3===n.dismissalType;n.showCloseButton=4!==n.dismissalType;var i=new r.default;n.createComputed(function(){var e=n.state();1!==e&&(2===e?i.complete(2):i.cancel())});n._promise=i.getPromise();return n}t.prototype.complete=function(){this.isOpen(!1);this.state(2)};t.prototype.dismiss=function(){this.isOpen(!1);this.state(3)};t.prototype.wait=function(){return this._promise};return t}(i.default);t.default=s});
define("odsp-next/dataSources/application/odc/ApplicationDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/odc/DataRequest","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../url/odc/UrlDataSource"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=o.default.skyApiBaseUrl+"GetApplicationDetails",a=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getApplicationDetails=function(e){var t=this;return(new i.default).send({apiName:"GetApplicationDetails",url:u+"?"+s.serializeQuery({appId:e.clientId}),requestType:"GET"}).then(function(n){return{userId:t._convertClientIdToUserId(e.clientId),email:null,name:n.name,image:n.logoUrl,profilePage:n.appUrl,entityType:3}})};t.prototype._convertClientIdToUserId=function(e){return parseInt(e,16).toString(10)};return t}(r.default);t.default=a});
define("odsp-next/dataSources/storageInfo/odc/StorageInfoDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../base/odc/DataRequest","../../base/odc/requestHandlers/SkyApiRequestHandler","../../item/ItemDataSource.resx","../../../resources/ODCResourceKeys"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=u.strings,l=function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._urlDataSource=t.resources.consume(a.urlDataSource);return t}t.prototype.getStorageInfo=function(){var e=this;return(new s.default).send({apiName:"GetStorageInfo",url:t._storageInfoUrl}).then(function(e){return e},function(t){return r.default.wrapError(e._getError(t.data.code))})};t.prototype.redeemCode=function(e){var n=new s.default,i=JSON.stringify({token:e.token,trackingGuid:e.trackingGuid});return n.sendPost("RedeemQuotaToken",t._redeemCodeUrl,i).then(function(e){return e=e.items||e.item},function(e){return r.default.wrapError(e.data.message)})};t.prototype.sendInvitation=function(e){var n=this,i=new s.default;if(!e)return null;var o=JSON.stringify({recipients:e.map(function(e){return{RecipientType:0,EmailAddress:e}})});return i.sendPost("SendInvitation",t._sendInvitationUrl,o).then(function(e){return e},function(e){return r.default.wrapError(n._getError(e.data.code).errorTitle)})};t.prototype._getError=function(e,t){var n={errorCode:e,errorDetailedText:"",errorTitle:""};switch(e){case 4102:n.errorTitle=f.InvalidCodeFailedToRedeem;break;default:n.errorTitle=f.DefaultTitle;n.errorDetailedText=f.DefaultSubText}return n};t._storageInfoUrl=o.SKY_API_DOMAIN+"/API/2/GetStorageInfo?planDetails=true&quotaForDisabled=true";t._redeemCodeUrl=o.SKY_API_DOMAIN+"/API/2/RedeemQuotaToken";t._sendInvitationUrl=o.SKY_API_DOMAIN+"/API/2/SendInvitation";return t}(i.default);t.default=l});
define("odsp-next/providers/ticketRedeemer/TicketRedeemerProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/modules/Modules"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(t){n.__extends(r,t);function r(e){var n=t.call(this,e)||this;n._urlDataSource=n.resources.consume(s.url);return n}r.prototype.getTicketRedeemerManager=function(){var e=this._urlDataSource.getAppSubfolder(!0);return this._onRequire(e)};r.prototype._onRequire=function(t){return i.default.resolve(new Promise(function(n,r){e(["../../dataSources/ticketRedeemer/"+t+"/TicketRedeemerManager"],n,r)})).then(o.getDefaultExport)};return r}(r.default);t.default=u});
define("odsp-next/dataSources/storageOptions/odc/StorageOptionsDataSource",["require","exports","tslib","../../base/odc/DataRequest","../../base/odc/requestHandlers/SkyApiRequestHandler","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/uri/Uri","@ms/odsp-shared/lib/utilities/navigation/Navigation.key"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(){var t=e.call(this)||this;t._navigation=t.resources.consume(u.navigation);return t}t.prototype.getStorageOptions=function(){var e=new r.default,n=this._navigation.viewParams.ctpMkt,i=this._navigation.viewParams.accountid,s=new o.default(t._storageOptionsUrl);s.setQueryParameter("ctpMkt",n,!1);s.setQueryParameter("accountid",i,!1);return e.send({apiName:"GetUpgradeOptions",url:s.toString()})};t._storageOptionsUrl=i.SKY_API_DOMAIN+"/API/2/GetUpgradeOptions";return t}(s.default);t.default=a});
define("odsp-next/providers/subscriptions/SubscriptionsProvider",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.getSubscriptions=function(e){return this._getSubscriptionsDataSource().then(function(t){return t.getSubscriptions(e)})};t.prototype.updateSubscription=function(e){return this._getSubscriptionsDataSource().then(function(t){return t.updateSubscription(e)})};t.prototype.getRootSubscriptions=function(){return this._getSubscriptionsDataSource().then(function(e){return e.getRootSubscriptions()})};t.prototype.createRootSubscription=function(e){return this._getSubscriptionsDataSource().then(function(t){return t.createRootSubscription(e)})};t.prototype.updateRootSubscription=function(e){return this._getSubscriptionsDataSource().then(function(t){return t.updateRootSubscription(e)})};t.prototype.deleteRootSubscription=function(e){return this._getSubscriptionsDataSource().then(function(t){return t.deleteRootSubscription(e)})};t.prototype._getSubscriptionsDataSource=function(){var e=this;if(this._subscriptionsDataSource)return r.default.wrap(this._subscriptionsDataSource);if(this.resources.isExposed(s.subscriptions)){this._subscriptionsDataSource=this.resources.consume(s.subscriptions);return r.default.wrap(this._subscriptionsDataSource)}return this.resources.consumeAsync(s.subscriptions).then(function(t){e._subscriptionsDataSource=t;return t})};return t}(i.default);t.default=o});
define("odsp-next/dataSources/subscriptions/vroom/SubscriptionsDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../base/vroom/VroomDataRequestor"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._vroomDataRequestor=n.vroomDataRequestor;return r}t.prototype.getSubscriptions=function(e){var t=this;return e.itemId?this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drive/items/"+e.itemId+"/subscriptions"}).then(function(e){return e.value.map(function(e){return t._translateToSubscriptionModel(e)})}):r.default.wrap([])};t.prototype.updateSubscription=function(e){var t=this,n=new Date;n.setMonth(n.getMonth()+1);var r={notificationUrl:"ActivityService://activity",expirationDateTime:n.toISOString(),scenarios:["FollowAFile"],muted:!e.isOn};return this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drives/"+e.item.ownerId+"/items/"+e.item.itemId+"/subscriptions",requestType:"POST",postData:JSON.stringify(r)}).then(function(e){return t._translateToSubscriptionModel(e)})};t.prototype.getRootSubscriptions=function(){var e=this;return this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drive/root/subscriptions",useAuthorizationHeaders:!0}).then(function(t){return t.value.map(function(t){return e._translateToSubscriptionModel(t)})})};t.prototype.createRootSubscription=function(e){var t=this;return this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drive/root/subscriptions",useAuthorizationHeaders:!0,requestType:"POST",postData:JSON.stringify(this._getPostData(e))}).then(function(e){return t._translateToSubscriptionModel(e)})};t.prototype.updateRootSubscription=function(e){var t=this;return this._vroomDataRequestor.send({apiName:"subscriptions",path:"/drive/root/subscriptions/"+e.id,useAuthorizationHeaders:!0,requestType:"PATCH",postData:JSON.stringify(this._getPostData(e))}).then(function(e){return t._translateToSubscriptionModel(e)})};t.prototype.deleteRootSubscription=function(e){return this._vroomDataRequestor.send({apiName:"deleteSubscription",requestType:"DELETE",path:"/drive/root/subscriptions/"+e.id,useAuthorizationHeaders:!0})};t.prototype._translateToSubscriptionModel=function(e){if(!e)return null;var t={id:e.id,muted:e.muted,expirationDateTime:e.expirationDateTime,notificationUrl:e.notificationUrl,resource:e.resource,scenarios:e.scenarios};e.createdBy&&e.createdBy.user&&(t.createdBy={user:{id:e.createdBy.user.id}});return t};t.prototype._getPostData=function(e){var t={notificationUrl:e.notificationUrl};if(e.expirationDateTime)t.expirationDateTime=e.expirationDateTime.toISOString();else{if(!e.expiresAfterDuration)throw new Error("Invalid expiration time");t.expiresAfterDuration=e.expiresAfterDuration}return t};t.dependencies=n.__assign({},i.default.dependencies,{vroomDataRequestor:o.resourceKey});return t}(i.default);t.default=u;t.resourceKey=s.createResolvedResourceKey(e("module").id,u)});
define("odsp-next/providers/thumbnail/ThumbnailProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../dataSources/base/vroom/VroomDataRequestor"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=999999,o=function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.getThumbnails=function(e,t,n){void 0===n&&(n=null);var r=t.map(u).join(",");return this.resources.consume(i.resourceKey).send({apiName:"thumbnails",path:"/drives/"+e.driveId+"/items/"+e.itemId+"/thumbnails?select="+r+(n?"&authkey="+n:""),needsAuthorization:!n})};t.prototype.getThumbnailForLargestDimension=function(e,t,n){return n?this.getThumbnailForSize(e,t,s):this.getThumbnailForSize(e,s,t)};t.prototype.getThumbnailForSize=function(e,t,n){var r="c"+t+"x"+n;return e.value[0][r]};return t}(r.default);t.default=o;function u(e){return"c"+(e.width||s)+"x"+(e.height||s)}});
define("odsp-next/dataSources/instrumentation/odc/InstrumentationDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-datasources/lib/Permissions","../../../dataSources/url/PageType","../../../providers/teachingBubble/TeachingBubbleProvider","../../../resources/ControlResourceKeys","../../../dataSources/floodgate/FloodgateDataSource.key","../../../dataSources/identity/odc/IdentityDataSource","../../../dataSources/url/odc/UrlDataSource","../../../controls/firstRunExperience/FirstRunExperienceStatus.key","../../../controls/firstRunExperience/FirstRunExperienceStatus","../../../utilities/features/Features"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._navigation=n.resources.consume(i.navigation);n._identityDataSource=n.resources.consume(l.resourceKey);n._urlDataSource=n.resources.consume(c.resourceKey);n._teachingBubbleProvider=n.resources.consume(u.resourceKey);n._firstRunExperienceStatus=n.resources.consume(h.resourceKey);n._isGuidedTourVisible=n.resources.consume(a.isGuidedTourVisible);return n}t.prototype.getEngagementData=function(e){if(e===o.default[o.default.StorageOptions])return{purchaseSource:this._navigation.viewParams.ocid||this._navigation.viewParams["WT.mc_id"]}};t.prototype.userExecuteAction=function(e){var t=this;if(d.isFeatureEnabled(d.EnableFloodgate)&&e){var n=e.name;this.resources.consumeAsync(f.resourceKey).then(function(e){0===n.indexOf("Upload")&&(n="Upload");if(t._identityDataSource.getIdentity().type!==s.IdentityType.anonymous){"NewSession"===n&&t._isValidNpsSurveyContext()&&e.recordUserAction("NewNpsSession");t._isMeaningfulNpsAction(n)&&e.recordUserAction("MeaningfulNpsAction")}e.recordUserAction(n)})}};t.prototype.userSeeItem=function(e){};t.prototype._isValidNpsSurveyContext=function(){var e=this._urlDataSource.getPageType(),t=e===o.default.Files||e===o.default.Photos;return!this._teachingBubbleProvider.currentBubble.peek()&&this._firstRunExperienceStatus.peek()!==p.FirstRunExperienceStatus.visible&&!this._isGuidedTourVisible.peek()&&t};t.prototype._isMeaningfulNpsAction=function(e){return"Open.File"===e||"Open.Media"===e||/OpenIn[a-zA-z]+/.test(e)||"Upload"===e||"CreateFolder"===e||/Create[a-zA-Z]+DocumentAction/.test(e)};return t}(r.default);t.default=v});
define("odsp-next/dataSources/floodgate/FloodgateDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./FloodgateDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/controls/firstRunExperience/FirstRunExperienceStatus.key",["require","exports","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","./FirstRunExperienceStatus"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id+".FirstRunExperienceStatus",factory:{dependencies:{observablesFactoryType:n.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType;return{instance:t.create(i.FirstRunExperienceStatus.notConfigured),disposable:t}}}})});
define("odsp-next/controls/firstRunExperience/FirstRunExperienceStatus",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.notConfigured=0]="notConfigured";e[e.visible=1]="visible";e[e.notVisible=2]="notVisible"}(t.FirstRunExperienceStatus||(t.FirstRunExperienceStatus={}))});
define("odsp-next/dataSources/encoding/odc/EncodingDataSource",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}e.prototype.getEncoding=function(){return"undefined"!=typeof FilesConfig&&FilesConfig&&FilesConfig.defaultCodePage?FilesConfig.defaultCodePage:null};return e}();t.default=n});
define("odsp-next/dataSources/videoItem/odc/VideoItemDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./VideoItemDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/upsell/odc/UpsellDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","../../base/odc/DataRequest","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.getUpsellFromOneRm=function(e){var t=new s.default,n=new o.Qos({name:this.getMarketingRequestApiId()}),r={url:e,apiName:"OneRM",returnRawXHR:!0,useDefaultHeaders:!0};return t.send(r).then(function(e){var t;try{t=e&&e.response&&JSON.parse(e.response)}catch(e){}t?2===t.ContentType?n.end({resultType:u.ResultTypeEnum.ExpectedFailure}):0===t.ContentType?n.end({resultType:u.ResultTypeEnum.Success}):n.end({resultType:u.ResultTypeEnum.Failure}):n.end({resultType:u.ResultTypeEnum.Failure});return t},function(e){n.end({resultType:u.ResultTypeEnum.Failure});return i.default.wrapError(e)})};t.prototype.getMarketingRequestApiId=function(){return"SkyDriveWeb_Internal_Control_FirstRunView_MarketingRequest"};return t}(r.default);t.default=a});
define("odsp-next/providers/upsell/UpsellProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._upsellDataSource=n.resources.consume(i.upsell);return n}t.prototype.getUpsellFromOneRm=function(e){return this._upsellDataSource.getUpsellFromOneRm(e)};t.prototype.getMarketingRequestApiId=function(){return this._upsellDataSource.getMarketingRequestApiId()};return t}(r.default);t.default=s});
define("odsp-next/actions/odc/ActionMap",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../BaseActionMap","./ExternalNavigateAction","../OpenInDesktopAction","./AddCoverPhotoAction","../addToAlbum/odc/AddToAlbumAction","../addToFolder/odc/AddToFolderAction","../ChangeFolderTypeAction","../ClearSelectionAction","./CreateDocumentAction","../createFolder/odc/CreateFolderAction","./CreateMountPointAction","./DefaultClickAction","../delete/odc/DeleteAction","../download/odc/DownloadAction","../editTags/odc/EditTagsAction","../embed/odc/EmbedAction","../emptyRecycleBin/odc/EmptyRecycleBinAction","../feedback/odc/FeedbackAction","../LanguagePickerAction","../navigateToItem/NavigateToItemAction","../NavigationAction","../sort/od/OneDriveSortAction","./OpenAction","../preview/PreviewAction","./OpenInOfficeClientAction","../OpenPdfInBrowserAction","./OpenInOfficeOnlineAction","../openInTextEditor/OpenInTextEditorAction","../orderPrints/odc/OrderPrintsAction","./PlayAudioAction","./PlaySlideShowAction","./StopSlideShowAction","./RemoveCoverPhotoAction","../RemoveFromRecentAction","./RemoveTagAction","../rename/odc/RenameAction","../restore/RestoreAction","../restoreAll/odc/RestoreAllAction","../rotate/RotateAction","./SaveSortOrderAction","../SetFocusAction","../shareByLink/odc/ShareByLinkAction","../showKeyboardMap/ShowKeyboardMapAction","../showOperations/ShowOperationsAction","../showPermissions/ShowPermissionsAction","../showSuggestedFiles/ShowSuggestedFilesAction","../ShowPropertiesAction","../ShowSelectionAction","../sort/SortAction","../toggleListLayout/odc/ToggleListLayoutAction","../viewOriginal/ViewOriginalAction","./UploadAction","./UpdateCaptionAction","./SurveyAction","./AddToSharedListAction","../removeFromSharedList/odc/RemoveFromSharedListAction","../addToBundle/odc/AddToBundleAction","./RemoveFromBundleAction","../reportAbuse/odc/ReportAbuseAction","./RemoveMountPointAction","../requestReview/odc/RequestReviewAction","./ViewInFolderAction","./SignOutAction","../ToggleDebugWindowAction","../RemoveFromAlbumAction","../addPhotosToAlbum/AddPhotosToAlbumAction","../createAlbum/CreateAlbumAction","../SelectAction","../SelectAllAction","../FilterSearchAction","../RemoveTagFromItemAction","../setAlbumCoverPhoto/odc/SetAlbumCoverPhotoAction","../setPhotosRoot/odc/SetPhotosRootAction","../FilterSearchByDateAction","../launchMoveCopyPanel/odc/LaunchMoveCopyPanelAction","./AutoExecuteAction","../toggleSelectionMode/ToggleSelectionModeAction","../redeemCode/odc/RedeemCodeAction","../save/odc/SaveAction","../redeem/odc/RedeemAction","../base/LazyLoadedAction","../switchPhotoFolderLayoutType/odc/SwitchPhotoFolderLayoutTypeAction","../createAlbumFromFolder/odc/CreateAlbumFromFolderAction","./VersionHistoryAction","./RearrangeAction","../applyOfficeLens/odc/ApplyOfficeLensAction","../removeOfficeLens/odc/RemoveOfficeLensAction","../base/OverrideAction","../printPdf/odc/PrintPdfAction","../saveAutoAlbum/odc/SaveAutoAlbumAction","../discardAutoAlbum/odc/DiscardAutoAlbumAction","../saveAutoAlbum/odc/ImplicitSaveAutoAlbumAction","../vault/odc/VaultAction","../showShareMultiItem/ShowShareMultiItemAction"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue,ae,fe,le,ce,he,pe,de,ve,me,ge,ye,be,we,Ee,Se,xe,Te,Ne,Ce,ke,Le,Ae,Oe,Me,_e,De,Pe,He,Be,je,Fe,Ie,qe,Re,Ue,ze){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var We=function(t){n.__extends(i,t);function i(){var n=t.call(this)||this,i=Oe.default.create("odsp-next/actions/quotaBlock/odc/QuotaBlockAction",function(){return new r.default(function(t,n){e(["odsp-next/actions/quotaBlock/odc/QuotaBlockAction"],t,n)})});n.ExternalNavigateAction=s.default;n.OpenInDesktopAction=o.default;n.AddCoverPhotoAction=u.default;n.AddPhotosToAlbumAction=ve.default;n.AddToAlbumAction=a.default;n.AddToBundleAction=oe.default;n.AddToFolderAction=f.default;n.AddToSharedListAction=ie.default;n.ApplyOfficeLensAction=He.default;n.AutoExecuteAction=Ne.default;n.ChangeFolderTypeAction=l.default;n.ClearSelectionAction=c.default;n.CreateAlbumAction=me.default;n.CreateAlbumFromFolderAction=_e.default;n.CreateDocumentAction=je.default.create(h.default,i);n.CreateFolderAction=p.default;n.CreateNewFolderAction=Oe.default.create("odsp-next/actions/createNewFolder/odc/CreateNewFolderAction",function(){return new r.default(function(t,n){e(["odsp-next/actions/createNewFolder/odc/CreateNewFolderAction"],t,n)})});n.CreateMountPointAction=d.default;n.DefaultClickAction=v.default;n.DeleteAction=m.default;n.DiscardAutoAlbumAction=qe.default;n.DownloadAction=g.default;n.DownloadZipContentsAction=Oe.default.create("odsp-next/actions/downloadZipContents/odc/DownloadZipContentsAction",function(){return new r.default(function(t,n){e(["odsp-next/actions/downloadZipContents/odc/DownloadZipContentsAction"],t,n)})});n.EditTagsAction=y.default;n.EmbedAction=b.default;n.EmptyRecycleBinAction=w.default;n.FeedbackAction=E.default;n.FilterSearchAction=be.default;n.FilterSearchByDateAction=xe.default;n.ImplicitSaveAutoAlbumAction=Re.default;n.LanguagePickerAction=S.default;n.LaunchMoveCopyPanelAction=Te.default;n.MoveCopyAction=Oe.default.create("odsp-next/actions/moveCopy/odc/MoveCopyAction",function(){return new r.default(function(t,n){e(["odsp-next/actions/moveCopy/odc/MoveCopyAction"],t,n)})});n.NavigateToItemAction=x.default;n.NavigationAction=T.default;n.OneDriveSortAction=N.default;n.OpenAction=C.default;n.PreviewAction=k.default;n.OpenInOfficeClientAction=L.default;n.OpenPdfInBrowserAction=A.default;n.OpenInOfficeOnlineAction=je.default.create(O.default,i);n.OpenInTextEditorAction=M.default;n.OrderPrintsAction=_.default;n.PlayAudioAction=D.default;n.PlaySlideShowAction=P.default;n.PrintPdfAction=Fe.default;n.RearrangeAction=Pe.default;n.RedeemAction=Ae.default;n.RedeemCodeAction=ke.default;n.RemoveCoverPhotoAction=B.default;n.RemoveFromAlbumAction=de.default;n.RemoveFromBundleAction=ue.default;n.RemoveFromRecentAction=j.default;n.RemoveFromSharedListAction=se.default;n.RemoveMountPointAction=fe.default;n.RemoveOfficeLensAction=Be.default;n.RemoveTagAction=F.default;n.RemoveTagFromItemAction=we.default;n.RenameAction=I.default;n.ReportAbuseAction=ae.default;n.RequestReviewAction=le.default;n.RestoreAction=q.default;n.RestoreAllAction=R.default;n.RotateAction=U.default;n.SaveAction=Le.default;n.SaveAutoAlbumAction=Ie.default;n.SaveSortOrderAction=z.default;n.SelectAction=ge.default;n.SelectAllAction=ye.default;n.SetAlbumCoverPhotoAction=Ee.default;n.SetFocusAction=W.default;n.SetPhotosRootAction=Se.default;n.ShareByLinkAction=X.default;n.ShowKeyboardMapAction=V.default;n.ShowOperationsAction=$.default;n.ShowPermissionsAction=J.default;n.ShowSuggestedFilesAction=K.default;n.ShowPropertiesAction=Q.default;n.ShowSelectionAction=G.default;n.ShowVersionHistoryAction=De.default;n.SignOutAction=he.default;n.SortAction=Y.default;n.StopSlideShowAction=H.default;n.SurveyAction=re.default;n.SwitchPhotoFolderLayoutTypeAction=Me.default;n.ToggleDebugWindowAction=pe.default;n.ToggleListLayoutAction=Z.default;n.ToggleSelectionModeAction=Ce.default;n.UpdateCaptionAction=ne.default;n.UploadAction=je.default.create(te.default,i);n.QuotaBlockAction=i;n.VaultAction=Ue.default;n.ViewInFolderAction=ce.default;n.ViewOriginalAction=ee.default;n.ShowShareMultiItemAction=ze.default;return n}return i}(i.default);t.default=We});
define("odsp-next/actions/BaseActionMap",["require","exports","./UnsupportedAction"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){this.AddCoverPhotoAction=n.default;this.AddExistingAppViewAction=n.default;this.AddFlowAction=n.default;this.AddPhotosToAlbumAction=n.default;this.AddToAlbumAction=n.default;this.AddToBundleAction=n.default;this.AddToFolderAction=n.default;this.AddToQuickLaunchAction=n.default;this.AddToSharedListAction=n.default;this.AddToSpotlightAction=n.default;this.AlertAction=n.default;this.ApplyOfficeLensAction=n.default;this.ApproveRejectAction=n.default;this.AuthenticationPolicyWarningAction=n.default;this.AutoExecuteAction=n.default;this.CancelEditAction=n.default;this.ChangeAppViewVisibilityAction=n.default;this.ChangeFolderTypeAction=n.default;this.CheckInAction=n.default;this.CheckOutAction=n.default;this.ClearFilterAction=n.default;this.ClearSelectionAction=n.default;this.ComplianceDetailsAction=n.default;this.ContentTypeNavigationAction=n.default;this.LaunchConfigureFlowsPanelAction=n.default;this.CopyFieldAction=n.default;this.CopyFormAction=n.default;this.CreateAlbumAction=n.default;this.CreateAlbumFromFolderAction=n.default;this.CreateAppViewAction=n.default;this.CreateColumnAction=n.default;this.CreateCustomDocumentAction=n.default;this.CreateDocumentAction=n.default;this.CreateFileRequestAction=n.default;this.CreateFolderAction=n.default;this.CreateItemAction=n.default;this.CreateMountPointAction=n.default;this.CreateNewFolderAction=n.default;this.CreateSitePageAction=n.default;this.CustomActionNavigationAction=n.default;this.CustomizeClientFormAction=n.default;this.CustomizeFormsNavigationAction=n.default;this.CustomizeViewAction=n.default;this.DefaultClickAction=n.default;this.DeleteAction=n.default;this.DeleteTemplateAction=n.default;this.DeleteAppAction=n.default;this.DeleteViewAction=n.default;this.DiscardAutoAlbumAction=n.default;this.DownloadAction=n.default;this.DownloadZipContentsAction=n.default;this.EditAction=n.default;this.EditItemAction=n.default;this.EditItemCancelAction=n.default;this.EditItemSaveAction=n.default;this.EditNewAppViewAction=n.default;this.EditNewMenuAction=n.default;this.EditNewMenuPaneAction=n.default;this.EditRenditionsAction=n.default;this.EditTagsAction=n.default;this.EmbedAction=n.default;this.EmptyRecycleBinAction=n.default;this.ExportListAction=n.default;this.ExternalNavigateAction=n.default;this.FeedbackAction=n.default;this.FileHandlerOpenAction=n.default;this.FilterAction=n.default;this.FilterSearchAction=n.default;this.FilterSearchByDateAction=n.default;this.GetLinkAction=n.default;this.GroupItemsAction=n.default;this.ImplicitSaveAutoAlbumAction=n.default;this.InvokeFirstRunExperienceAction=n.default;this.LanguagePickerAction=n.default;this.LaunchChangeTheLookPanelAction=n.default;this.LaunchColumnCustomizationPaneAction=n.default;this.LaunchColumnManagementPanelAction=n.default;this.LaunchCreateAppViewPanelAction=n.default;this.LaunchCreateGroupPanelAction=n.default;this.LaunchCreateShortcutPanel=n.default;this.LaunchFilterPanelAction=n.default;this.LaunchFlowWidgetPanelAction=n.default;this.LaunchFormatViewPaneAction=n.default;this.LaunchGroupifyPanelAction=n.default;this.LaunchGroupMembershipPanelAction=n.default;this.LaunchListCreationPanelAction=n.default;this.LaunchListFormAction=n.default;this.LaunchMoveCopyPanelAction=n.default;this.LaunchSitePermissionsPanelAction=n.default;this.LaunchSiteSettingsPanelAction=n.default;this.LaunchUserExpirationPanelAction=n.default;this.MakeHomepageAction=n.default;this.VaultAction=n.default;this.ModifyColumnAction=n.default;this.ModifyShowInFiltersPaneAction=n.default;this.MoveCopyAction=n.default;this.MoveLeftSpotlightAction=n.default;this.MoveRightSpotlightAction=n.default;this.NavigateToItemAction=n.default;this.NavigateToSharePointHomeAction=n.default;this.NavigationAction=n.default;this.OneDriveSortAction=n.default;this.OpenAction=n.default;this.OpenAppAction=n.default;this.OpenHyperlinkAction=n.default;this.OpenInExplorerAction=n.default;this.OpenInfoPathAction=n.default;this.OpenInOfficeClientAction=n.default;this.OpenInOfficeOnlineAction=n.default;this.OpenInSharePointAction=n.default;this.OpenInDesktopAction=n.default;this.OpenInTextEditorAction=n.default;this.OpenNeedsAttentionViewAction=n.default;this.OpenPdfInBrowserAction=n.default;this.OpenInPowerBIAction=n.default;this.OpenShortcutAction=n.default;this.OpenSiteAction=n.default;this.OrderPrintsAction=n.default;this.PinToMruAction=n.default;this.PlayAudioAction=n.default;this.PlaySlideShowAction=n.default;this.PolicyTipAction=n.default;this.PreviewAction=n.default;this.PrintPdfAction=n.default;this.PublishAction=n.default;this.RearrangeAction=n.default;this.RedeemAction=n.default;this.RedeemCodeAction=n.default;this.RemoveCoverPhotoAction=n.default;this.RemoveFromAlbumAction=n.default;this.RemoveFromBundleAction=n.default;this.RemoveFromRecentAction=n.default;this.RemoveFromSharedListAction=n.default;this.RemoveFromSpotlightAction=n.default;this.RemoveMountPointAction=n.default;this.RemoveOfficeLensAction=n.default;this.RemoveTagAction=n.default;this.RemoveTagFromItemAction=n.default;this.RenameAction=n.default;this.RenameColumnAction=n.default;this.ReportAbuseAction=n.default;this.RequestReviewAction=n.default;this.RestoreAction=n.default;this.RestoreAllAction=n.default;this.RestoreFilesAction=n.default;this.RotateAction=n.default;this.SaveAction=n.default;this.SaveAutoAlbumAction=n.default;this.SaveSortOrderAction=n.default;this.SaveViewAction=n.default;this.SeeAllAppsAction=n.default;this.SelectAction=n.default;this.SelectAllAction=n.default;this.SetAlbumCoverPhotoAction=n.default;this.SetDefaultViewAction=n.default;this.SetFocusAction=n.default;this.SetPhotosRootAction=n.default;this.SetUpApprovalFlowAction=n.default;this.SetUpReminderFlowAction=n.default;this.ShareAction=n.default;this.ShareByLinkAction=n.default;this.ShowExistingFlowsAction=n.default;this.ShowFiltersAction=n.default;this.ShowItemAnalyticsAction=n.default;this.ShowSuggestedFilesAction=n.default;this.ShowKeyPointsAction=n.default;this.ShowKeyboardMapAction=n.default;this.ShowMalwareDetectedAction=n.default;this.ShowOperationsAction=n.default;this.ShowPermissionsAction=n.default;this.ShowPropertiesAction=n.default;this.ShowRunReportAction=n.default;this.ShowSelectionAction=n.default;this.ShowVersionHistoryAction=n.default;this.SignOutAction=n.default;this.StopSlideShowAction=n.default;this.SurveyAction=n.default;this.SwitchPhotoFolderLayoutTypeAction=n.default;this.SwitchSharingLinkAction=n.default;this.SwitchViewAction=n.default;this.SyncAction=n.default;this.SynchronizeAppViewAction=n.default;this.LaunchTeamChannelAction=n.default;this.ToggleAction=n.default;this.ToggleDebugWindowAction=n.default;this.ToggleListLayoutAction=n.default;this.ToggleSelectionModeAction=n.default;this.TriggerFlowAction=n.default;this.TriggerFlowByIdAction=n.default;this.TriggerODBConvertToPdfFlowAction=n.default;this.TriggerODBRequestSignOffFlowAction=n.default;this.TriggerSignoffFlowAction=n.default;this.UndoCheckOutAction=n.default;this.UnPublishAction=n.default;this.UpdateCaptionAction=n.default;this.UpdatePermissionsAction=n.default;this.UploadAction=n.default;this.UploadTemplateAction=n.default;this.QuotaBlockAction=n.default;this.ViewInFolderAction=n.default;this.ViewItemAction=n.default;this.ViewOriginalAction=n.default;this.WorkflowAction=n.default};t.default=r});
define("odsp-next/actions/UnsupportedAction",["require","exports","tslib","../base/BaseAction"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t.name="Unsupported";return t}t.prototype.onIsAvailable=function(){return!1};return t}(r.default);t.default=i});
define("odsp-next/actions/odc/ExternalNavigateAction",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Qos.event","../../base/BaseAction","../../resources/ODCResourceKeys","@ms/odsp-utilities/lib/icons/OfficeFileNameHelper"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="ExternalNavigate";n._item=t.item;return n}t.prototype.onIsAvailable=function(){return!0};t.prototype.onExecute=function(e){var t=this,n=window.open("","_blank"),i=this._item.peek();return this.resources.consumeAsync(s.urlDataSource).then(function(e){var s=void 0;if(s=t._isOfficeItem()&&i.openUrl?i.openUrl:e.getItemUrl(i.key,{item:i})){n.location.href=s;return{resultType:r.ResultTypeEnum.Success}}n.close();return{resultType:r.ResultTypeEnum.Failure}})};t.prototype._isOfficeItem=function(){var e=this._item.peek(),t=e.extension&&e.extension.replace(/^\./,"");return t&&o.OfficeIconFileTypeMap[t]&&".pdf"!==e.extension};return t}(i.default);t.default=u});
define("odsp-next/actions/OpenInDesktopAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","./base/ItemSelectionHelper","../resources/DataSourceResourceKeys","../models/item/ItemType","@ms/odsp-datasources/lib/interfaces/item/UrlType","../dataSources/url/QueryType"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c;!function(e){e[e.DefaultClick=0]="DefaultClick";e[e.OpenInOfficeOnline=1]="OpenInOfficeOnline";e[e.OpenFileLocation=2]="OpenFileLocation";e[e.OpenItemActivityItem=3]="OpenItemActivityItem";e[e.OpenPdfInBrowser=4]="OpenPdfInBrowser"}(c=t.DesktopActionType||(t.DesktopActionType={}));var h=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.item,i=t.openRelation,s=void 0===i?0:i,a=t.actionType;n.name="OpenInDesktop";n._itemSelectionHelper=new(n.child(o.typeResourceKey))({overrideItem:2===s?r:void 0,allowMultiSelect:!1,canFallback:0!==s,ignoreSelection:0!==s});n._urlDataSource=n.resources.consume(u.url);n._actionType=a;return n}t.prototype.onIsAvailable=function(){return!0};t.prototype.onExecute=function(e,t){var n=this._itemSelectionHelper.firstItem(),r={id:n.id,name:n.name,actionType:c[this._actionType],queryType:l.default[n.queryType],itemType:a.default[n.type],openUrl:n.openUrl,parentUrl:n.parentLink,shortcutUrl:n.urls[f.default.shortcutTarget],siteUrl:this._urlDataSource.getCurrentSiteUrl(),fullItemUrl:this._urlDataSource.getItemUrl(n.key),extension:n.extension};window.external.notify(JSON.stringify(r));return i.default.wrap({resultType:s.ResultTypeEnum.Success})};return t}(r.default);t.default=h});
define("odsp-next/actions/base/ItemSelectionHelper",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../resources/ControlResourceKeys","../../utilities/selection/SelectionHelper","@ms/odsp-utilities/lib/resources/Resources","../../models/item/OneDriveItem"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r,u=i.resources,f=i.observables,l=n.getCurrentItem,c=void 0===l?u.consume(s.currentItem.lazy.optional):l,h=n.getItemSetSelectionModel,p=void 0===h?u.consume(s.itemsSelection.lazy.optional):h,d=n.getSelectionHelper,v=void 0===d?u.consume(o.resourceKey.lazy.optional):d,m=t.allowMultiSelect,g=void 0!==m&&m,y=t.canFallback,b=void 0!==y&&y,w=t.ignoreSelection,E=void 0!==w&&w,S=t.overrideItem,x=t.useCurrentSelectionGroup,T=void 0!==x&&x;r._allowMultiSelect=g;r._overrideItem=S;r._ignoreSelection=E;r._useCurrentSelectionGroup=T;r._placeholder=r.observables.create(new a.default);if(!S){r._selectionModel=p&&p();r._selectionHelper=v&&v()}b&&c&&(r._fallback=c());r.selection=f.pureCompute(r._computeSelection);r.firstItem=f.pureCompute(r._computeFirstItem);r.currentItem=f.pureCompute(function(){return(c&&c()||r._placeholder)()});return r}t.prototype.filterItems=function(e){var t=this.selection();if(!t.length)return!1;for(var n=this.observables,r=0,i=t;r<i.length;r++){var s=i[r],o=n.unwrap(s);if(!o)return!0;if(!e(o))return!1}return!0};t.prototype.resolveSelection=function(){var e=this;return this._resolveSelection().then(function(t){if(t&&t.length)return t;if(e._fallback){var n=e._fallback.peek();if(n)return[n]}return[]})};t.prototype.resolveFirst=function(){var e=this;return this._resolveSelection().then(function(t){return t&&t.length?t[0]:e._fallback?e._fallback.peek():void 0})};t.prototype.clearSelection=function(){this._selectionModel&&this._selectionModel.clear()};t.prototype.selectAll=function(){this._selectionModel&&this._selectionModel.selectAll()};t.prototype._computeSelection=function(){var e=this._getCurrentSelection();return!this._allowMultiSelect&&e.length>1?[]:e||[]};t.prototype._computeFirstItem=function(){var e=this.selection();return e&&e[0]&&e[0]()};t.prototype._getCurrentSelection=function(){if(this._overrideItem)return[this._overrideItem];var e,t=this._selectionModel;if(t){if(this._useCurrentSelectionGroup&&t.getSelectionModelGroup()){var n=t.getSelectionModelGroup().currentSelection();n&&(t=n)}e=t.selection()}else e=[];(0===e.length||this._ignoreSelection)&&this._fallback&&(e=[this._fallback]);return e};t.prototype._resolveSelection=function(){var e=this;if(this._overrideItem)return r.default.resolve([this._overrideItem.peek()]);var t=this.observables.ignore(function(){return e._computeSelection()});if(this._ignoreSelection||!t.length)return r.default.resolve([]);var n=this._selectionHelper;return n?n.resolveSelection():r.default.reject(new Error("Unable to resolve selection."))};return t}(i.default);t.ItemSelectionHelper=f;t.typeResourceKey=u.createResolvedTypeResourceKey(e("module").id,f,n.__assign({},i.default.dependencies,{currentItem:s.currentItem.lazy.optional,itemSetSelectionModel:s.itemsSelection.lazy.optional,selectionHelper:o.resourceKey.lazy.optional}));t.default=f});
define("odsp-next/utilities/selection/SelectionHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../providers/dialog/DialogProvider","../../controls/textContainer/TextContainer","@ms/odsp-utilities/lib/async/Promise","../../controls/commands/Commands.resx","./SelectionHelper.resx","../../utilities/icons/Icon","../../resources/ControlResourceKeys","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._dialogProvider=n.dialogProvider;r._promiseTracker=n.promiseTracker;r._itemSetSelectionModel=n.itemSetSelectionModel;return r}t.prototype.resolveSelection=function(){var e,t,n=this.createObservable(a.strings.resolveDescription),r=this.createObservable(!0),i=this.createObservable(!1),s=this._shouldShowDialog();if(this._itemSetSelectionModel){t=this._itemSetSelectionModel.resolveSelection().then(function(t){s=!1;e&&e.state(2);return t},function(t){if(e){n(a.strings.resolveError);r(!1);i(!0)}return o.default.wrapError(t)});s&&(e=this._createDialog(n,r,i)).wait().done(void 0,function(){t.cancel()});this._promiseTracker&&this._promiseTracker.registerPromise(t)}else t=o.default.wrap([]);return t};t.prototype._createDialog=function(e,t,n){return this._dialogProvider.requestDialog({title:a.strings.resolveTitle,isDismissable:!1,component:{name:s.default.tagName,params:{text:e}},actions:[{name:u.strings.cancelActionText,execute:function(){return o.default.wrap(3)},isVisible:t,icon:new f.default("Cancel"),isDefault:!0},{name:u.strings.ok,execute:function(){return o.default.wrap(3)},isVisible:n,icon:new f.default("Cancel"),isDefault:!0}]})};t.prototype._shouldShowDialog=function(){for(var e=0,t=this._itemSetSelectionModel.selection.peek();e<t.length;e++){var n=t[e];if(!this.peekUnwrapObservable(n))return!0}return!1};t.dependencies=n.__assign({},r.default.dependencies,{dialogProvider:i.resourceKey,promiseTracker:l.promiseTracker.optional,itemSetSelectionModel:l.itemsSelection});return t}(r.default);t.default=p;t.getSelectedItemApp=function(e){var t=e.selection();if(1===t.length){return c.unwrap(t[0]).appMap}};t.resourceKey=h.createResolvedResourceKey(e("module").id,p)});
define("odsp-next/actions/odc/AddCoverPhotoAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../base/ItemRedeemer","../../dataSources/url/QueryType","../base/ItemCommandHelper","../../base/BaseAction","../../providers/item/ItemProvider","../base/ItemSelectionHelper","../../models/item/command/CustomizationItemCommandKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="AddCoverPhotoAction";r._itemReedemer=new(r.managed(s.default));r._itemCommandHelper=new(r.managed(u.default));r._itemSelectionHelper=new(r.child(l.typeResourceKey))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this,t=this._itemSelectionHelper.currentItem();return t.queryType!==o.default.Search&&t.queryType!==o.default.SharedWithMe&&this._itemSelectionHelper.filterItems(function(t){return e._itemCommandHelper.isCommandSupported(t,c.addAsCoverPhoto)})};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var e,t=this;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:return(e=n.sent()).length?[2,this._itemReedemer.redeemItems(e,this).then(function(){var n=t.resources.consume(f.resourceKey),r=e[0].parent;return n.addCoverPhotos({items:e,target:r}).then(function(){return{resultType:i.ResultTypeEnum.Success}})})]:[2,r.default.resolve({resultCode:"EmptySelection",resultType:i.ResultTypeEnum.Failure})]}})})};return t}(a.default);t.default=h});
define("odsp-next/actions/base/ItemRedeemer",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/ProviderResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._ticketRedeemer=n.resources.consume(o.ticketRedeemer.optional);return n}t.prototype.redeemItem=function(e,t,n){return this.redeemItems([e],t,n)};t.prototype.redeemItems=function(e,t,n){return this._ticketRedeemer&&(this._doAnyItemsNeedRedemption(e)||n)?this._startTokenRedemption(t,e[0]):r.default.wrap({resultType:s.ResultTypeEnum.Success})};t.prototype._doAnyItemsNeedRedemption=function(e){if(e)for(var t=0,n=e;t<n.length;t++){var r=n[t];if(r&&r.tokenNeedsRedeeming)return!0}return!1};t.prototype._startTokenRedemption=function(e,t){return this._ticketRedeemer.getTicketRedeemerManager().then(function(n){return n.startRedeem(e,t)},function(e){return r.default.wrapError({})})};return t}(i.default);t.default=u});
define("odsp-next/actions/base/ItemCommandHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../providers/itemCommand/ItemCommandProvider","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,s=n.itemCommandProvider,o=void 0===s?r.resources.consume(i.resourceKey):s;r._itemCommandProvider=o;return r}t.prototype.isCommandSupported=function(e,t){var n=this._itemCommandProvider;return!n||!!n.getCommand(e,t)};t.prototype.getCommandBehavior=function(e,t){var n=this._itemCommandProvider,r=n&&n.getCommand(e,t);return r&&r.behavior};t.dependencies=n.__assign({},r.default.dependencies,{itemCommandProvider:i.resourceKey});return t}(r.default);t.default=o;t.resourceKey=s.createResolvedResourceKey(e("module").id,o)});
define("odsp-next/providers/itemCommand/ItemCommandProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._commandDataSource=n.itemCommandDataSource;return r}t.prototype.getCommand=function(e,t){return this._commandDataSource.getCommand(e,t)};t.dependencies=n.__assign({},r.default.dependencies,{itemCommandDataSource:i.itemCommand});return t}(r.default);t.default=o;t.resourceKey=s.createResolvedResourceKey(e("module").id,o)});
define("odsp-next/models/item/command/CustomizationItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.removeFromRecent=new n.default("removeFromRecent");t.rearrange=new n.default("rearrange");t.addAsCoverPhoto=new n.default("addCoverPhoto");t.removeAsCoverPhoto=new n.default("removeCoverPhoto")});
define("odsp-next/models/item/command/ItemCommandKey",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(t){this.id=""+ ++e._lastId;this.name=t}e.prototype.matches=function(e){return e===this};e._lastId=0;return e}();t.default=n});
define("odsp-next/actions/addToAlbum/odc/AddToAlbumAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../resources/DataSourceResourceKeys","../../../providers/panel/PanelProvider","../../../models/item/command/PhotoItemCommandKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){n.__extends(i,t);function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="AddToAlbum";n._panelProvider=n.resources.consume(o.resourceKey);n._urlDataSource=n.resources.consume(s.url);return n}i.prototype.getExecutorPath=function(){return"odsp-next/actions/addToAlbum/odc/AddToAlbumExecutor"};i.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/addToAlbum/odc/AddToAlbumExecutor"],t,n)})}};i.prototype.getExecutorParameters=function(){return{actionName:this.name,itemSelectionHelper:this.selectionHelper,panelProvider:this._panelProvider,urlDataSource:this._urlDataSource}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};i.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return this.itemCommandHelper.isCommandSupported(e,u.addToAlbum)};return i}(i.default);t.default=a});
define("odsp-next/actions/base/templates/ExecutorAction",["require","exports","tslib","../ExecutorLoader","./SelectionAction"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._loader=new(n.managed(r.default))({path:n.getExecutorPath(),getModule:n.getModuleFactory(),getExecutorParams:function(){return n.selectionHelper.resolveSelection().then(function(e){return n.getExecutorParameters({selection:e})})}});return n}t.prototype.onExecute=function(e,t){return this._loader.execute(e,t)};return t}(i.default);t.default=s});
define("odsp-next/actions/base/templates/SelectionAction",["require","exports","tslib","../../../base/BaseAction","../ItemCommandHelper","../ItemSelectionHelper"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var r=e.call(this,t)||this;r.itemCommandHelper=new(r.managed(i.default));r.selectionHelper=new(r.child(s.typeResourceKey))(n.__assign({},r.getSelectionOptions(),{overrideItem:t.item}));return r}t.prototype.getSelectionOptions=function(){return{}};return t}(r.default);t.default=o});
define("odsp-next/providers/panel/PanelProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../models/panel/Panel"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.currentPanels=r.observables.createArray();return r}t.prototype.requestPanel=function(e){var t=new s.default(e),n=this.currentPanels;n.push(t);var r=function(){return n.remove(t)};t.wait().then(r,r);return t};return t}(r.default);t.default=o;t.resourceKey=i.createResolvedResourceKey(e("module").id,o)});
define("odsp-next/models/panel/Panel",["require","exports","@ms/odsp-utilities/lib/async/Promise","knockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e){var t=this,i=e.noTitle,s=void 0!==i&&i,o=e.title,u=void 0===o?r.observable(""):o,a=e.elementDescribedBy,f=void 0===a?"":a,l=e.hasCommandBar,c=void 0!==l&&l,h=e.size,p=void 0===h?"Small":h,d=e.scrollMode,v=void 0===d?"auto":d,m=e.showCloseButton,g=void 0===m||m,y=e.includePadding,b=void 0===y||y,w=e.preserveLightDismiss,E=void 0!==w&&w,S=e.stickyCloseButton,x=void 0!==S&&S,T=e.component,N=void 0===T?null:T,C=e.maximizePanelContent,k=void 0!==C&&C,L=e.panelContentSize,A=void 0===L?r.observable({width:0,height:0}):L,O=e.isBlocking;this.size=p;this.title=r.isObservable(u)?u:r.observable(u);this.elementDescribedBy=f;this.maximizePanelContent=k;this.panelContentSize=A;this.noTitle=s;this.hasCommandBar=c;this.component=N;this.scrollMode=v;this.showCloseButton=g;this.includePadding=b;this.preserveLightDismiss=E;this.stickyCloseButton=x;this.isBlocking=O;this.state=r.observable(0);this._promise=new n.default(function(e){var n=r.computed(function(){if(1===t.state()){e(!0);n.dispose()}},t)})}e.prototype.wait=function(){return this._promise};return e}();t.default=i});
define("odsp-next/models/item/command/PhotoItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.play=new n.default("play");t.rotate=new n.default("rotate");t.editCaption=new n.default("editCaption");t.editTags=new n.default("editTags");t.removeTags=new n.default("removeTags");t.viewOriginal=new n.default("viewOriginal");t.applyOfficeLens=new n.default("applyOfficeLens");t.removeOfficeLens=new n.default("removeOfficeLens");t.addToAlbum=new n.default("addToAlbum");t.removeFromAlbum=new n.default("removeFromAlbum");t.addPhotosToAlbum=new n.default("addPhotosToAlbum")});
define("odsp-next/actions/addToFolder/odc/AddToFolderAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../models/item/ItemParentHelper"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){n.__extends(i,t);function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="AddToFolderAction";n._itemParentHelper=n.resources.consume(s.resourceKey);return n}i.prototype.getExecutorPath=function(){return"odsp-next/actions/addToFolder/odc/AddToFolderExecutor"};i.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/addToFolder/odc/AddToFolderExecutor"],t,n)})}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};i.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}};i.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem(),t=e&&this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"vault","root"));return!!t&&!t.vault.isLocked};return i}(i.default);t.default=o});
define("odsp-next/models/item/ItemParentHelper",["require","exports","../store/ItemsStore","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this._itemsStore=t.itemsStore}e.prototype.getParent=function(e){return this.getAncestorOrSelf(e,function(t){return t.key===e.parentKey})};e.prototype.getFacetedAncestorOrSelf=function(e,t,n){void 0===n&&(n="");return this.getAncestorOrSelf(e,function(e){return n?e[t]&&e[t][n]:!!e[t]})};e.prototype.getAncestorOrSelf=function(e,t){for(var n;e;){var r=this._itemsStore.getItem(e.key),i=r&&r.peek();if(!i)break;if(t(i)){n=r;break}e=e.parent}return n};e.dependencies={itemsStore:n.resourceKey};return e}();t.default=i;t.resourceKey=r.createResolvedResourceKey(e("module").id,i)});
define("odsp-next/actions/ChangeFolderTypeAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-datasources/lib/utilities/permissions/Identity","@ms/odsp-utilities/lib/logging/events/Qos.event","../utilities/icons/Icon","../controls/infoPane/InfoPane.resx","../base/BaseAction","../controls/folderTypeEditor/FolderTypeEditor","../resources/DataSourceResourceKeys","../providers/item/ItemProvider","../providers/dialog/DialogProvider","./base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="ChangeFolderType";r._itemProvider=r.resources.consume(c.resourceKey);r._urlDataSource=r.resources.consume(l.url);r._identityDataSource=r.resources.consume(l.identity);r._itemSelectionHelper=new(r.child(p.typeResourceKey))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem(),t=this._identityDataSource.getIdentity();return!(!(e&&t&&e.queryType&&t.type!==i.IdentityType.anonymous&&void 0!==e.category)||this._urlDataSource.isRecycleBin(e.queryType))};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var e,t,i,a,l=this;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:if(!(e=n.sent()))return[2,r.default.resolve({resultCode:"EmptySelection",resultType:s.ResultTypeEnum.Failure})];t=e.category;i=this.observables.create(t);a=this.resources.consume(h.resourceKey);return[2,a.requestDialog({title:u.strings.informationChangeFolderTitle,component:{name:f.default.tagName,params:{category:i}},actions:[{name:u.strings.informationSave,execute:function(){return r.default.resolve(2)},isAvailable:this.createComputed(function(){return e.category!==i()}),isDefault:!0,icon:new o.default("Save"),automationId:"changeFolderTypeSave"}]}).wait().then(function(){return l._itemProvider.changeFolderType({category:i(),item:e}).then(function(){return{resultType:s.ResultTypeEnum.Success}})})]}})})};return t}(a.default);t.ChangeFolderTypeAction=d;t.default=d});
define("odsp-next/controls/folderTypeEditor/FolderTypeEditor",["require","exports","./FolderTypeEditorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./FolderTypeEditor.html","./FolderTypeEditor.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-folder-type-editor",template:e("./FolderTypeEditor.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/folderTypeEditor/FolderTypeEditorViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../infoPane/InfoPane.resx","../../models/item/FolderCategory","knockout"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.infoPaneResx=i;n.category=t.category;n.typeDocuments=s.default[s.default.documents];n.typePhotos=s.default[s.default.photos];n.categoryText=o.observable(s.default[n.category()]);n.subscribe(n.categoryText,function(){n.category(s.default[n.categoryText()])});return n}return t}(r.default);t.default=u});
define("odsp-next/models/item/FolderCategory",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.documents=0]="documents";e[e.photos=1]="photos";e[e.favorites=2]="favorites"}(n||(n={}));t.default=n});
define("odsp-next/controls/folderTypeEditor/FolderTypeEditor.html",[],function(){return'<div class=FolderTypeEditor><div class=FolderTypeEditor-option><div class=ms-RadioButton><input class=ms-RadioButton-input type=radio name=folderType id=folderTypeDocuments data-bind="attr: { value: typeDocuments }, checked: categoryText"> <label for=folderTypeDocuments class=ms-RadioButton-field><span class=od-Label data-bind="text: infoPaneResx.strings.informationFolderTypeDocuments"></span></label></div></div><div class=FolderTypeEditor-option><div class=ms-RadioButton><input type=radio name=folderType id=folderTypePhotos value=photos data-bind="attr: { value: typePhotos }, checked: categoryText" class=ms-RadioButton-input> <label for=folderTypePhotos class=ms-RadioButton-field><span class=od-Label data-bind="text: infoPaneResx.strings.informationFolderTypePhotos"></span></label></div></div></div>'});
define("odsp-next/controls/folderTypeEditor/FolderTypeEditor.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".FolderTypeEditor-option+.FolderTypeEditor-option{margin-top:10px}"}])});
define("odsp-next/actions/ClearSelectionAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/DataSourceResourceKeys","./base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="ClearSelection";var i=r.resources;r._urlDataSource=i.consume(o.url);r._itemSelectionHelper=new(r.child(u.typeResourceKey))({allowMultiSelect:!0,canFallback:!1});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper,t=this._urlDataSource,n=t.getKeyParams(e.currentItem().key),r=t.getQueryType(n);return e.selection().length>0&&!t.isRecycleBin(r)};t.prototype.onExecute=function(e,t){this._itemSelectionHelper.clearSelection();return i.default.resolve({resultType:s.ResultTypeEnum.Success})};return t}(r.default);t.default=a});
define("odsp-next/actions/odc/CreateDocumentAction",["require","exports","tslib","../CreateDocumentAction","cookies","@ms/odsp-datasources/lib/interfaces/list/DocumentType","@ms/odsp-utilities/lib/async/Promise","../../resources/ODCResourceKeys","../../controls/createDocumentForm/CreateDocumentForm","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","@ms/odsp-utilities/lib/logging/events/Qos.event","./SkyApiHelper","../../dataSources/url/odc/UrlDataSource","../../dataSources/identity/odc/IdentityDataSource","../../providers/hiddenDom/HiddenDomProvider","../base/ItemCommandHelper","../../models/item/command/OfficeItemCommandKeys","../../models/item/command/WebItemCommandKeys","../base/ItemRedeemer","../../resources/ControlResourceKeys","../../resources/ProviderResourceKeys","../../utilities/features/Features","../../controls/commands/Commands.resx","../../dataSources/createDocument/odc/CreateDocumentDataSource"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._identityDataSource=n.resources.consume(p.resourceKey);n._itemDataSource=n.resources.consume(u.itemDataSource);n._hiddenDomProvider=n.resources.consume(d.resourceKey);n._createDocumentDataSource=n.resources.consume(x.resourceKey);n._forceRedeem=!n.resources.consume(w.userInfo).isAuthenticated();n._itemCommandHelper=new(n.managed(v.default));n._itemReedemer=new(n.managed(y.default));n.askForFileName=!!t.autoInvokedItem;t.autoInvokedItem&&t.docType===s.DocumentType.Text&&(n.redirect=!1);n._itemCommandKey=n._getItemCommandKey(n.docType);n._didUserUploadOrCreateFile=n.resources.consume(b.didUserUploadOrCreateFile.optional);n.docType===s.DocumentType.ExcelSurvey&&E.isFeatureEnabled(E.RedirectExcelSurveysToFormsV2)&&(n.name="CreateFormsSurveyDocumentAction");E.isFeatureEnabled(E.CreateDocumentToVroom)&&(n._vroomDocTypes=[s.DocumentType.Word,s.DocumentType.Excel,s.DocumentType.PowerPoint]);return n}t.prototype.onIsAvailable=function(){var t=this.item();return!(t&&t.vault&&t.vault.isLocked)&&!!this._itemCommandKey&&this._itemCommandHelper.isCommandSupported(t,this._itemCommandKey)&&e.prototype.onIsAvailable.call(this)};t.prototype.onExecute=function(t,n){var r,i=this,u=this.item.peek(),f=u.documentFormat&&1===u.documentFormat;!f&&E.isFeatureEnabled(E.CreateDocumentToVroom)&&-1!==this._vroomDocTypes.indexOf(this.docType)&&(r=window.open("","_blank"));return this._itemReedemer.redeemItem(u,this,this._forceRedeem).then(function(){var h=i._itemDataSource;if(i.askForFileName)return e.prototype.onExecute.call(i,t,n);i._didUserUploadOrCreateFile&&i._didUserUploadOrCreateFile(!0);if(i.docType===s.DocumentType.OneNote||2===i._itemCommandHelper.getCommandBehavior(u,i._itemCommandKey)){var p=i.navigation,d=h.createDocumentInTab(i.docType,u,!0);p.navigateTo({url:d,frameId:"_blank"});c.refreshItemWhenVisible(u,i.resources);return{resultType:l.ResultTypeEnum.Success}}if(i.docType===s.DocumentType.ExcelSurvey&&E.isFeatureEnabled(E.RedirectExcelSurveysToFormsV2)){p=i.navigation;var v=i._identityDataSource.getIdentity(),m="Action=Create&Host=ODC&Title="+encodeURIComponent(S.strings.FormDefaultName),g="https://forms.office.com/Pages/DesignPage.aspx?Action=Create&auth_pvr=WindowsLiveId"+(v.email?"&auth_upn="+encodeURIComponent(v.email):"")+"&Fragment="+encodeURIComponent(m);p.navigateTo({url:g,frameId:"_blank"});return{resultType:l.ResultTypeEnum.Success}}if(f||!E.isFeatureEnabled(E.CreateDocumentToVroom)||-1===i._vroomDocTypes.indexOf(i.docType)){var y=i._hiddenDomProvider,b=(d=h.createDocumentInTab(i.docType,u,!1),y.requestControl({name:a.default.tagName,params:{canary:FilesConfig.navCanary,formAction:d,resources:i.resources}}));i._writePerfForWac();document.getElementById("create_form").submit();y.disposeControl(b);c.refreshItemWhenVisible(u,i.resources);return o.default.wrap({resultType:l.ResultTypeEnum.Success})}i._createDocumentDataSource.create(u,i.docType).then(function(e){if(r)r.location.href=e;else{i.navigation.navigateTo({url:e})}i._writePerfForWac();c.refreshItemWhenVisible(u,i.resources);return{resultType:l.ResultTypeEnum.Success}}).catch(function(e){r&&r.close();return{resultType:l.ResultTypeEnum.Failure}})})};t.prototype._writePerfForWac=function(){var e={FR:"SDX.Skydrive*Root",ST:(new Date).getTime()};i.set("BP",f.serializeQuery(e),{domain:h.default.getCookieDomain()});try{localStorage.ODCWac_ST=(new Date).getTime().toString()}catch(e){}};t.prototype._getItemCommandKey=function(e){var t;switch(e){case s.DocumentType.Word:t=m.createWord;break;case s.DocumentType.Excel:t=m.createExcel;break;case s.DocumentType.PowerPoint:t=m.createPowerPoint;break;case s.DocumentType.ExcelSurvey:t=m.createSurvey;break;case s.DocumentType.OneNote:t=m.createOneNote;break;case s.DocumentType.Text:t=g.upload}return t};return t}(r.default);t.default=T});
define("odsp-next/actions/CreateDocumentAction",["require","exports","tslib","../base/BaseItemAction","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-datasources/lib/interfaces/list/DocumentType","../controls/itemNameEditor/ItemNameEditor","@ms/odsp-utilities/lib/async/Promise","../controls/commands/Commands.resx","../dataSources/url/QueryType","../utilities/icons/Icon","../providers/item/ItemProvider","../providers/dialog/DialogProvider","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../resources/ControlResourceKeys","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-list-utilities/lib/Actions/CreateDocumentActionHelperCore","../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createItemOperatorAsyncTypeResourceKey=new m.ResourceKey({name:e("module").id+".createItemOperator",loader:new m.AliasResourceLoader(function(){return a.default.resolve(new Promise(function(t,n){e(["../providers/operator/CreateItemOperator"],t,n)})).then(function(e){return e.typeResourceKey})})});var b=f.strings,w=function(e){n.__extends(r,e);function r(t){var n=e.call(this,t)||this;n.docType=t.docType;n.templateUrl=t.templateUrl;n.name="Create"+(o.DocumentType[n.docType]||"")+"DocumentAction";n.navigation=n.resources.consume(i.navigation);n.itemProvider=n.resources.consume(h.resourceKey);n._dialogProvider=n.resources.consume(p.resourceKey);n.platformDetection=n.resources.consume(d.platformDetection);n.redirect=!0;n.openInNewTab=!1;n.askForFileName=n.docType===o.DocumentType.OneNote;n._didUserUploadCreateFile=n.resources.consume(v.didUserUploadOrCreateFile.optional);n._isOneDriveWinApp=y.isOneDriveWinApp();return n}r.prototype.createDocument=function(e,t){var n=this,r=this.navigation,i=this.itemProvider,o=null,u=i.createDocument(e.key,this.docType,t,this.templateUrl).then(function(e){e&&(o=e);return a.default.wrap({resultType:s.ResultTypeEnum.Success})});u.done(function(e){o&&!window._isRunningTABTest&&n.async.setImmediate(function(){return r.navigateTo({url:o,frameId:n.openInNewTab?"_blank":null})})});return u};r.prototype.onIsAvailable=function(){return!(this.platformDetection.isMobile&&!this.platformDetection.isIPad||this._isOneDriveWinApp)&&this.item().queryType===l.default.Files};r.prototype.isCommandSupported=function(){return!0};r.prototype.onExecute=function(e,t){return this.isCommandSupported()?this.onExecuteCore():a.default.wrap({resultType:s.ResultTypeEnum.Success})};r.prototype.onExecuteCore=function(){if(!this._isCreatingFile){this._didUserUploadCreateFile&&this._didUserUploadCreateFile(!0);var e=this.item.peek();return this.askForFileName?this._createDocumentWithDialog(e):this.createDocument(e)}};r.prototype.createNewFile=function(e,n){var r=this;return this.resources.consumeAsync(t.createItemOperatorAsyncTypeResourceKey).then(function(t){var n=new t({fileName:e,parentItem:r.item.peek()});return r.trackPromise(n.start())})};r.prototype._createDocumentWithDialog=function(e){var t=this,n=this._dialogProvider,r=this.observables.create(""),i=this.observables.create(""),a=this.observables.create(!1),l=this.observables.create(!0),h=null,p=g.getDocExtension(this.docType);this._isCreatingFile=!0;var d=function(e){a(!0);l(!0);i(e);return 1},v=n.requestDialog({title:g.getDialogTitle(this.docType,b),isDismissable:this.docType!==o.DocumentType.Text,component:{name:u.default.tagName,params:{name:r,automationId:"createDocumentDialog",extension:p,status:i,hasError:a,isEnabled:l}},actions:[{name:b.CreateCommit,execute:function(){i(f.strings.Saving);l(!1);a(!1);return function(){var n=t.docType===o.DocumentType.OneNote||t.docType===o.DocumentType.ExcelSurvey||t.docType===o.DocumentType.ExcelForm?r.peek():r.peek()+p;if(t.redirect){return t.itemProvider.createDocument(e.key,t.docType,n,t.templateUrl).then(function(e){h=e;return 2},d)}return t.createNewFile(n,e).then(function(){return 2},d)}()},isAvailable:this.observables.pureCompute(function(){return t._isCreateAvailable(l,r)}),isDefault:!0,icon:new c.default("Save"),automationId:"createDocumentDialogCommit"}]}).wait().then(function(){return{resultType:s.ResultTypeEnum.Success}},function(){return{resultType:s.ResultTypeEnum.ExpectedFailure}});v.done(function(){t._isCreatingFile=!1;if(h){var e=t.navigation;t.async.setImmediate(function(){return e.navigateTo({url:h,frameId:t.openInNewTab?"_blank":null})})}});return v};r.prototype._isCreateAvailable=function(e,t){if(!e())return!1;var n=t();return!!n&&" "!==n[0]};return r}(r.default);t.default=w});
define("odsp-next/base/BaseItemAction",["require","exports","tslib","./BaseAction","../models/item/ItemParentHelper","../actions/base/ItemSelectionHelper"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,o=t.item,u=n.getItemSelectionHelperType,a=void 0===u?r.resources.consume(s.typeResourceKey.lazy):u,f=n.itemParentHelper,l=void 0===f?r.resources.consume(i.resourceKey):f;r.isItemSpecified=!!o;r.item=o||new(r.scope.attached(a()))({canFallback:!0,ignoreSelection:!0}).currentItem;r.itemParentHelper=l;return r}t.prototype.onIsAvailable=function(){return!!this.item()};t.prototype.getParent=function(e,t,n){var r=this.itemParentHelper.getFacetedAncestorOrSelf(e,t);return n?this.peekUnwrapObservable(r):this.unwrapObservable(r)};t.dependencies=n.__assign({},r.default.dependencies,{getItemSelectionHelperType:s.typeResourceKey.lazy,itemParentHelper:i.resourceKey});return t}(r.default);t.default=o});
define("odsp-next/controls/itemNameEditor/ItemNameEditor",["require","exports","./ItemNameEditorViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ItemNameEditor.html","./ItemNameEditor.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-item-name-editor",template:e("./ItemNameEditor.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/itemNameEditor/ItemNameEditorViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","./ItemNameEditor.resx","../../bindings/focus/SelectOnFocusBinding"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.namePlaceholder=s.strings.NewNamePlaceholder;n.nameLabel=s.strings.NewNameLabel;n.name=t.name;n.extension=t.extension;n.status=t.status||r.observable("");n.hasError=t.hasError||r.observable(!1);n.isEnabled=t.isEnabled||r.observable(!0);n.hasFocus=t.hasFocus||r.observable(!0);n.namePlaceholder=t.namePlaceholder||n.namePlaceholder;n.addBindingHandlers({selectOnFocus:o.default});return n}return t}(i.default);t.default=u});
define("odsp-next/bindings/focus/SelectOnFocusBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this,s=r.valueAccessor();r._platform=r.resources.consume(i.platformDetection.optional);r._isPermanent="object"==typeof s&&s.isPermanent||!1;r._isReentrant="object"==typeof s&&s.isReentrant||!1;document.activeElement===r.element&&r._select();var o=n.__assign({focus:r._onFocus,focusin:r._onFocus,mouseup:r._onMouseUp},r._isReentrant?{focusout:r._onFocusOut}:{});r.events.onAll(r.element,o);return r}t.prototype._select=function(){var e=this.element;if((this._isPermanent||!this._hasSelected)&&"function"==typeof this.element.select){e.select();try{this._platform.isIOS&&e.value&&e.setSelectionRange(0,e.value.length)}catch(e){}this._hasSelected=!0;return!0}return!1};t.prototype._onFocus=function(e){this._select();return!0};t.prototype._onFocusOut=function(){this._hasSelected=!1;return!0};t.prototype._onMouseUp=function(e){if(this._select())return!1};return t}(r.default);t.default=s});
define("odsp-next/controls/itemNameEditor/ItemNameEditor.html",[],function(){return"<div class=od-ItemNameEditor data-bind=\"css: { 'od-ItemNameEditor--noExtension': !extension, 'is-focused': hasFocus, 'is-error': hasError }\"><div class=od-TextField><label class=\"od-ItemNameEditor-nameLabel od-Label\" for=ItemNameEditor-input data-bind=\"text: nameLabel\"></label> <span class=od-ItemNameEditor-input><input class=od-TextField-field id=ItemNameEditor-input type=text data-bind=\"textInput: name, hasFocus: hasFocus, selectOnFocus, attr: { placeholder: namePlaceholder }, css: { 'od-ItemNameEditor-input--error': hasError }, enable: isEnabled, automation: 'itemNameEditor-Input'\"></span> <span class=od-ItemNameEditor-extension data-bind=\"text: extension\"></span></div>\x3c!--ko if: hasError--\x3e<div class=od-ItemNameEditor-status aria-live=assertive role=status data-bind=\"text: status, css: { 'od-ItemNameEditor-status--error': hasError }\"></div>\x3c!--/ko--\x3e</div>"});
define("odsp-next/controls/itemNameEditor/ItemNameEditor.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ItemNameEditor-nameLabel.od-Label{display:none}.od-ItemNameEditor-input{display:table-cell;width:100%}.od-ItemNameEditor-extension{direction:ltr;display:table-cell}[dir=ltr] .od-ItemNameEditor-extension{padding-left:8px}[dir=rtl] .od-ItemNameEditor-extension{padding-right:8px}.od-ItemNameEditor--noExtension .od-ItemNameEditor-input{display:block;width:auto}.od-ItemNameEditor--noExtension .od-ItemNameEditor-extension{display:none}.od-ItemNameEditor-status{font-size:12px;font-weight:400;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";word-wrap:break-word}.od-ItemNameEditor-status--error{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.od-ItemNameEditor-input--error{border-color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"!important}"}])});
define("@ms/odsp-list-utilities/lib/Actions/CreateDocumentActionHelperCore",["require","exports","tslib","@ms/items-view/lib/private/components/actions/createDocument/DocumentCreatorHelper"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/items-view/lib/private/components/actions/createDocument/DocumentCreatorHelper",["require","exports","../../../operations/createDocument/DocumentType"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getDocExtension=function(e){switch(e){case n.DocumentType.Word:return".docx";case n.DocumentType.Excel:case n.DocumentType.ExcelSurvey:case n.DocumentType.ExcelForm:return".xlsx";case n.DocumentType.PowerPoint:return".pptx";case n.DocumentType.OneNote:return"";case n.DocumentType.Text:return".txt";case n.DocumentType.Visio:return".vsdx";case n.DocumentType.Bohemia:return".b";case n.DocumentType.Prague:return".prague"}};t.getDialogTitle=function(e,t){var r="";switch(e){case n.DocumentType.Word:r=t.CreateWord;break;case n.DocumentType.Excel:r=t.CreateExcel;break;case n.DocumentType.PowerPoint:r=t.CreatePowerPoint;break;case n.DocumentType.OneNote:r=t.CreateOneNote;break;case n.DocumentType.ExcelSurvey:r=t.CreateExcelSurvey;break;case n.DocumentType.Text:r=t.CreateText;break;case n.DocumentType.ExcelForm:r=t.CreateFormForExcel;break;case n.DocumentType.Visio:r=t.CreateVisio;break;case n.DocumentType.Bohemia:r=t.CreateBohemia;break;case n.DocumentType.Prague:r=t.CreatePrague}return r}});
define("@ms/items-view/lib/private/operations/createDocument/DocumentType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Word=1]="Word";e[e.Excel=2]="Excel";e[e.PowerPoint=3]="PowerPoint";e[e.OneNote=4]="OneNote";e[e.ExcelSurvey=5]="ExcelSurvey";e[e.Text=6]="Text";e[e.ExcelForm=7]="ExcelForm";e[e.Visio=8]="Visio";e[e.Bohemia=9]="Bohemia";e[e.Prague=10]="Prague"}(t.DocumentType||(t.DocumentType={}))});
define("odsp-next/utilities/browser/WebViewDetector",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r,i,s,o=location.search;t.isWebViewHosted=function(){n||(n=/[?&]env=WebView/.test(o)||f()||function(){try{return!a()&&(window.parent&&window.parent!==window&&-1===navigator.userAgent.indexOf("PhantomJS/")||/[?&]env=Embedded/.test(o))}catch(e){return!1}}());return n};function u(){return!!window.sessionStorage.getItem("_isOneDriveWinApp")}t.isOneDriveWinAppTest=u;t.isOneDriveWinApp=function(){void 0===r&&(r=-1!==navigator.userAgent.indexOf("OneDriveWinApp")||u());return r};function a(){i||(i=-1!==navigator.userAgent.indexOf("SharePointDesktop")||-1!==navigator.userAgent.indexOf("Magellan")||/[?&]env=Desktop/.test(o));return i}t.isMagellan=a;function f(){if(!s){var e=navigator.userAgent;s=/Teams\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+)).* Electron\/((?:(\d+)\.)?(?:(\d+)\.)?(?:(\d+)\.\d+))/.test(e)}return s}t.isTeamsWebView=f});
define("odsp-next/controls/createDocumentForm/CreateDocumentForm",["require","exports","./CreateDocumentFormViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./CreateDocumentForm.html"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-create-doc-form",template:e("./CreateDocumentForm.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/createDocumentForm/CreateDocumentFormViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._platform=n.resources.consume(i.platformDetection);n.formAction=t.formAction;n.canary=t.canary;n.target=n._platform.isMobile?"":"_blank";return n}return t}(r.default);t.default=s});
define("odsp-next/controls/createDocumentForm/CreateDocumentForm.html",[],function(){return'<form class=CreateDocumentForm id=create_form name=create_form method=post data-bind="attr: { action: formAction, target: target }"><input name=canary type=hidden data-bind="value: canary"></form>'});
define("odsp-next/actions/odc/SkyApiHelper",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/ProviderResourceKeys","./OfficeActionIdMap","./OfficeClient","@ms/odsp-utilities/lib/events/EventGroup","../../models/item/ItemType","../../providers/item/ItemProvider"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function l(e,t){var n;e&&e.properties&&e.properties.commandsSupported&&(n=e.properties.commandsSupported[t]);return n}t.getActionId=l;t.isCommandSupported=function(e,t){return void 0!==l(e,t)};t.tryAutoRedeemItem=function(e,t,n){return c([e],t,n)};function c(e,t,s){return function(e){if(e)for(var t=0,n=e;t<n.length;t++){var r=n[t];if(r&&r.tokenNeedsRedeeming)return!0}return!1}(e)||s?function(e,t){return e.resources.consume(i.ticketRedeemer).getTicketRedeemerManager().then(function(n){return n.startRedeem(e,t)},function(e){return n.default.wrapError({})})}(t,e[0]):n.default.wrap({resultType:r.ResultTypeEnum.Success})}t.tryAutoRedeemItems=c;t.openInClient=function(e,t,n,r,i){var u;e.type===a.default.OneNote&&(u=e.urls.oneNoteClient);var f={url:u,isDavUrl:!!u,fileName:e.name,iconType:e.iconName,appType:r,extension:r===s.default[2].toString()?".one":e.extension,item:e};return o.default.executeOpenInClient(f,i)};t.refreshWhenVisible=function(e){var t=h(),n=t?t+"Hidden":"hidden",r=t+"visibilitychange",i=new u.default(this),s=window.document;if(n){var o=function(){if(!s[n]){i.off(s,r,o);e(!0)}};i.on(s,r,o)}};t.refreshItemWhenVisible=function(e,t,n){var r=h(),i=r?r+"Hidden":"hidden",s=r+"visibilitychange",o=new u.default({}),a=window.document;if(i){var l=function(){if(!a[i]){o.off(a,s,l);t.consume(f.resourceKey).invalidateItem(e.key,{triggerFetch:n})}};o.on(a,s,l)}};function h(){var e=window.document;return"hidden"in e?"":"msHidden"in e?"ms":"webkitHidden"in e?"webkit":"mozHidden"in e?"moz":void 0}});
define("odsp-next/actions/odc/OfficeActionIdMap",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.Excel=1]="Excel";e[e.OneNote=2]="OneNote";e[e.PowerPoint=3]="PowerPoint";e[e.Word=4]="Word";e[e.Visio=5]="Visio";e[e.Project=6]="Project";e[e.Publisher=7]="Publisher"}(n||(n={}));t.default=n});
define("odsp-next/actions/odc/OfficeClient",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","./ClientUtils","./OfficeActionIdMap","../../providers/item/ItemProvider"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(){}e.executeOpenInClient=function(t,i){e._item=t.item;e._provider=i.consume(o.resourceKey);if(t.isDavUrl){e._openInClient(t);return n.default.wrap({resultType:r.ResultTypeEnum.Success})}return e._getOpenInClientDetails(t)};e._getOpenInClientDetails=function(t){return e._provider.getOpenInClientDetails(e._item).then(function(i){if(i){var s=i.davUrl;t.url=s;t.isDavUrl=!0;e._openInClient(t)}return n.default.wrap({resultType:r.ResultTypeEnum.Success})})};e._openInClient=function(e){if(!e.useDirectInvoke){var t=i.default.OpenDocumentMode.WriteOnly;1===e.item.sharingRole&&(t=i.default.OpenDocumentMode.ReadOnly);e.appType===s.default[7].toString()&&(t=i.default.OpenDocumentMode.WriteOnly);var n=i.default.OpenDocumentOptions.None;e.Mode=t;e.Options=n;var r={DocumentUrl:e.url,Mode:t,Options:n,Application:i.default.OfficeApplication[e.appType],ContinueIfLauncherIsNull:!0};i.default.EditDocumentInClient(r,null,null)}};return e}();t.default=u});
define("odsp-next/actions/odc/ClientUtils",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){var e,t,n,r,i,s,o,u,a,f="SharePoint.OpenDocuments.5",l="SharePoint.OpenDocuments.4",c="SharePoint.OpenDocuments.3",h="SharePoint.OpenDocuments.2",p="application/x-sharepoint",d="application/x-sharepoint-webkit",v="application/x-sharepoint-protocolhandler",m="application/x-sharepoint-webkit-protocolhandler",g="application/officelive",y="npSharePointPlugin",b="IDBHO.IDBHOCtrl",w="OneNote.Notebook",E="ofv|",S="ofe|",x="u|",T="RoamingOfficeActiveX.RoamingOffice",N="application/x-vnd.officeondemand",C="office:",k="";var L={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4},A={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32},O={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4},M={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},_={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};function D(){return function(){!function(){if(s)return;s=!0;o=B("Windows NT")}();return o>=6.1}()&&!(window.navigator.userAgent.indexOf("ARM;")>=0)&&(U()||V()||X())}function P(){return window.navigator.userAgent.indexOf("Windows")>=0}function H(){return window.navigator.userAgent.indexOf("Windows Phone")>=0}function B(e){var t=new RegExp(e+"\\s+(\\d+(\\.\\d*)?)").exec(window.navigator.userAgent),n=-1;if(null!=t&&t.length>=2){n=parseFloat(t[1]);isNaN(n)&&(n=-1)}return n}function j(){!function(){if(!u){u=!0;a=B("Windows Phone")}}();return a>=8}function F(){return"function"==typeof navigator.msLaunchUri&&!H()&&!R()}function I(){return window.navigator.userAgent.indexOf("Macintosh")>=0}function q(){return window.navigator.userAgent.indexOf("iPhone")>=0||window.navigator.userAgent.indexOf("iPad")>=0}function R(){return window.navigator.userAgent.indexOf("Edge/")>=0}function U(){return window.navigator.userAgent.indexOf(" MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0}function z(){return!!U()&&8==window.document.documentMode}function W(){return window.navigator.userAgent.indexOf(" Firefox/")>=0}function X(){return window.navigator.userAgent.toLowerCase().indexOf("chrome")>=0}function V(){return function(){if(W())return J("firefox/");return 0}()>=3}function $(){return function(){if(window.navigator.userAgent.indexOf(" AppleWebKit/")>=0)return J("version/");return 0}()>=3}function J(e){var t=window.navigator.userAgent.toLowerCase(),n=t.indexOf(e);if(n>=0){var r=n+e.length,i=t.length;return parseInt(t.substring(r,i))}return 0}function K(e,t,n){F()?navigator.msLaunchUri(e,t,n):!X()&&!q()||R()?function(e,t,n){var r=document.getElementById("OICFrame");if(null==r){(r=document.createElement("iframe")).className="ObjectInDialog";r.style.visibility="hidden";r.src="about:blank";document.body.appendChild(r);r.id="OICFrame"}try{r.contentWindow.location.href=e}catch(e){null!=n&&n();return}null!=t&&t()}(e,t,n):function(e,t,n){var r=document.getElementById("OICLinkTag");if(null==r){(r=document.createElement("a")).id="OICLinkTag";r.style.visibility="hidden";r.href="";r.target="_top";document.body.appendChild(r);null!=r.addEventListener&&r.addEventListener("click",function(e){null!=e.stopPropagation&&e.stopPropagation()},!1)}try{r.href=e;r.click()}catch(e){null!=n&&n();return}null!=t&&t()}(e,t,n)}function Q(e){return 0!=(e.Options&A.SkipProtocolHandler)||z()}function G(e){return!Q(e)&&(!!function(e){return I()&&(e.Application==_.OneNote||le(v,!1)||le(m,!1))}(e)||(!!F()||(!(Y()||"ActiveXObject"in window&&!H()||X())||ge()>=15)))}function Y(){return I()&&(V()||$())||V()}function Z(e){return e===L.ReadOnly||e===L.ReadWrite}function ee(e,t,n,r){var s=function(e){if(e!=_.OneNote&&H()&&!j())return"office:";switch(e){case _.Excel:return"ms-excel:";case _.OneNote:return"onenote:";case _.PowerPoint:return"ms-powerpoint:";case _.Visio:return"ms-visio:";case _.Word:return"ms-word:";case _.Project:return"ms-project:";case _.Publisher:return"ms-publisher:";case _.Infopath:return"ms-infopath:";case _.Access:return"ms-access:";default:return""}}(e);if(null==s){me(O.Unattempted,i.Application);return!1}e==_.Visio&&n==L.ReadWrite&&(n=L.WriteOnly);var o=s;if(!(r=r||H()&&!j())){var u="";Z(n)?u+=E:u+=S;o+=te(u+=x)}K(o+=te(t),ne,re);return!0}function te(e){if(I()&&X()){var t="";try{t=decodeURI(e)}catch(e){}if(t==e)return encodeURI(e)}return e}function ne(){ve(M.ProtocolHandler)}function re(){i.Options|=A.SkipProtocolHandler;de(i,e,t)}function ie(){if(F())return!0;if(X()){void 0!==navigator.plugins.refresh&&navigator.plugins.refresh(!1);return!!navigator.mimeTypes[N]}if(W()){var e=document.createElement("RoamingExtensionElement");document.documentElement.appendChild(e);var t=document.createEvent("Events");t.initEvent("RoamingOfficeInstalled",!0,!1);e.dispatchEvent(t);return!!e.getAttribute("installed")}if(U())try{return new ActiveXObject(T).HrExists()}catch(e){}return!1}function se(e,t,n,r,i,s){oe(e,t,function(e){switch(e){case _.Excel:return"root\\office15\\excel.exe";case _.PowerPoint:return"root\\office15\\powerpnt.exe";case _.Visio:return"root\\office15\\visio.exe";case _.Word:return"root\\office15\\winword.exe";case _.Project:return"root\\office15\\winproj.exe";case _.Publisher:return"root\\office15\\mspub.exe";case _.Infopath:return"root\\office15\\infopath.exe";case _.Access:return"root\\office15\\msaccess.exe";default:return null}}(n),r,"x86",k,i,s)}function oe(e,t,i,s,o,u,a,f){var l="";null!=s&&(l+=" "+s);null!=e&&(l+=' "'+e+'"');if(F()||X()){n=a;r=f;var c=C;c+=' "'+u+'"';c+=' "'+i+'"';c+=' "ROAMING"';c+=' "'+t+'"';c+=' "'+o+'"';K(c+=" "+l,ue,ae)}else if(W()){var h=document.createElement("RoamingExtensionElement");h.setAttribute("cabUrl",u);h.setAttribute("app",i);h.setAttribute("licensingEntitlements",t);h.setAttribute("platform",o);h.setAttribute("args",l);document.documentElement.appendChild(h);var p=document.createEvent("Events");p.initEvent("RoamingOfficeLaunch",!0,!1);h.dispatchEvent(p);null!=a&&a(M.RoamingFFExtension)}else if(U()){var d=new ActiveXObject(T);if(null!=d)try{d.HrConfigureSingle(u,i,t,o,l);null!=a&&a(M.RoamingActiveX)}catch(e){}}else null!=f&&f(O.Failed)}function ue(){null!=n&&n(M.RoamingProtocolHandler)}function ae(){null!=r&&r(O.ControlNeeded)}function fe(){var e=document.getElementById(y);if(null==e){var t=p;I()&&$()&&ce(d)&&(t=d);if(!ce(t)){if(!I()||!ce(g))return null;t=g}var n=document.createElement("object");n.id=y;n.type=t;n.style.width="0px";n.style.height="0px";n.style.setProperty("visibility","hidden","");document.body.appendChild(n);e=document.getElementById(y)}return e}function le(e,t){var n=window.navigator.mimeTypes;if(null==n)return!1;var r=n[e];return!!r&&!(t&&!r.enabledPlugin)}function ce(e){return le(e,!0)}function he(e){try{if(null!=new ActiveXObject(e))return!0}catch(e){}return!1}function pe(e){switch(e){case _.OneNote:return w;default:return""}}function de(n,r,s){i=n;e=r;t=s;if(n.DocumentUrl){var o=n.DocumentUrl;try{o=decodeURIComponent(n.DocumentUrl)}catch(e){}n.Mode===L.ReadWrite&&A.CheckoutRequired===(n.Options&A.CheckoutRequired)&&(n.Mode=L.ForceCheckout);A.HostIsEditOnly===(n.Options&A.HostIsEditOnly)&&(n.Mode=L.WriteOnly);if(G(n))ee(n.Application,n.DocumentUrl,n.Mode,n.Application==_.OneNote);else if(z()&&function(e,t,n,r){try{var i=new ActiveXObject(f);if(i)return i.ViewDocument3(window.self,e,t,r)}catch(e){}return!1}(o,n.Mode,n.Options,pe(n.Application)))ve(M.O15ActiveX);else{var u;if(Y())u=function(e,t,n){var r=fe();if(null==r)return O.Unattempted;var i=!1;try{i=r.ViewDocument3(window.self,e,t,n)}catch(e){}if(!i)try{i=Z(t)?r.ViewDocument2(window.self,e,n):r.EditDocument2(window.self,e,n)}catch(e){}if(i){ve(M.NpapiPlugin);return O.None}return O.Failed}(o,n.Mode,pe(n.Application));else{!function(){try{var e=new ActiveXObject(b);null!=e&&e.SaveSSOCreds()}catch(e){}}();u=function(e,t,n,r){var i;try{if(i=new ActiveXObject(l)){if(i.ViewDocument3(window.self,e,t,r)){ve(M.O14ActiveX);return O.None}return O.Failed}}catch(e){}if(A.O14Only===(n&A.O14Only))return O.Unattempted;try{if(i=new ActiveXObject(c)){if(i.ViewDocument3(window.self,e,t,r)){ve(M.O12ActiveX);return O.None}return O.Failed}}catch(e){}if(A.O12UpOnly===(n&A.O12UpOnly))return O.Unattempted;try{if(i=new ActiveXObject(h)){if(Z(t)?i.ViewDocument2(window.self,e,r):i.EditDocument2(window.self,e,r)){ve(M.O11ActiveX);return O.None}return O.Failed}}catch(e){}return O.Unattempted}(o,n.Mode,n.Options,pe(n.Application))}if(u!=O.None){if(n.CouldUseRoamingApps&&D()&&n.Application!=_.OneNote){if(!ie()){me(O.ControlNeeded,i.Application);return}if(n.RoamingAppsLauncher){!function(n){void 0!==n.RoamingAppsLauncher&&null!=n.RoamingAppsLauncher?void 0===n.RoamingBitsUrl||null==n.RoamingBitsUrl?se(n.DocumentUrl,n.RoamingAppsLauncher,n.Application,n.ApplicationParameters,e,t):oe(n.DocumentUrl,n.RoamingAppsLauncher,n.RoamingApplicationExe,n.ApplicationParameters,n.RoamingPlatform,n.RoamingBitsUrl,e,t):me(O.Unattempted,i.Application)}(n);return}if(!n.ContinueIfLauncherIsNull){me(O.LauncherNeeded,i.Application);return}}if(!(A.NoProtocolHandlerFallback==(n.Options&A.NoProtocolHandlerFallback)||Q(n)||U()||I()&&u!=O.Unattempted)){ee(n.Application,n.DocumentUrl,n.Mode,n.Application==_.OneNote);return}me(u,i.Application)}}}else me(O.Unattempted,i.Application)}function ve(t){null!=e&&e(t)}function me(e,n){void 0===n&&(n=null);null!=t&&t(e,n)}function ge(){var e=0;if(Y()||X()){var t=fe();try{null!=t&&(e=t.GetOfficeVersion())}catch(e){}}else he(f)?e=15:he(l)?e=14:he(c)?e=12:he(h)&&(e=11);return e}function ye(){return I()&&(ce(p)||ce(d))}return{OpenDocumentMode:L,OpenDocumentOptions:A,OpenDocumentFailureType:O,OpenDocumentControl:M,OfficeApplication:_,EditDocumentInClient:de,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Mode=0;this.Options=0;this.Application=_.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.ApplicationParameters="";this.RoamingPlatform="";this.RoamingApplicationExe="";this.RoamingBitsUrl=""},OfficeVersionInstalled:ge,IsO14MacPluginInstalled:ye,OfferOfficeInDialog:function(){return P()&&ge()<=11},OfferOfficeNoIntrusive:function(){return P()&&ge()<15},OfferMacOffice:function(){return I()&&!(window.navigator.userAgent.indexOf("PPC Mac")>=0)&&!ye()},CanUseRoamingControl:ie,InitUrls:function(e,t,n){k=e},LaunchRoamingApps:se,LaunchRoamingApps2:oe,ShouldShowDialog:function(){return!H()}}}();t.default=n});
define("odsp-next/providers/hiddenDom/HiddenDomProvider",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t,n){var i=e.call(this,t,n)||this,s=i._controls=i.observables.createArray([]),o=document.createElement("div");o.style.display="none";var u=document.createElement("div");u.setAttribute("data-bind","component: $data");document.body.appendChild(o);r.applyBindingsToNode(o,{template:{nodes:[u],foreach:s}});return i}t.prototype.requestControl=function(e){this._controls.push(e);return e};t.prototype.disposeControl=function(e){var t=this._controls,n=t.indexOf(e);t.splice(n,1)};return t}(i.default);t.default=o;t.resourceKey=s.createResolvedResourceKey(e("module").id,o)});
define("odsp-next/models/item/command/OfficeItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createExcel=new n.default("createExcel");t.createOneNote=new n.default("createOneNote");t.createPowerPoint=new n.default("createPowerPoint");t.createWord=new n.default("createWord");t.createSurvey=new n.default("createSurvey");t.viewSurvey=new n.default("viewSurvey");t.editSurvey=new n.default("editSurvey");t.publishSurvey=new n.default("publishSurvey");t.openOnline=new n.default("openOnline");t.openInClient=new n.default("openInClient");t.viewVersionHistory=new n.default("viewVersionHistory");t.openInPowerBI=new n.default("openInPowerBI");t.contentTypeNavigation=new n.default("contentTypeNavigation");t.editNewMenu=new n.default("editNewMenu");t.uploadTemplate=new n.default("uploadTemplate")});
define("odsp-next/models/item/command/WebItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.upload=new n.default("upload");t.download=new n.default("download");t.sync=new n.default("sync")});
define("odsp-next/dataSources/createDocument/odc/CreateDocumentDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-datasources/lib/interfaces/list/DocumentType","@ms/odsp-utilities/lib/resources/Resources","../../base/vroom/VroomDataRequestor","../../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._vroomDataRequestor=n.vroomDataRequestor;return r}t.prototype.create=function(e,t){var n=this;return this.getCreateUrl(e,t).then(function(e){return n._vroomDataRequestor.send({apiName:"CreateDocument",path:e,requestType:"PUT",useAuthorizationHeaders:!0,headers:{Prefer:"allow-zerobyte"}}).then(function(e){return e.webUrl})})};t.prototype.getCreateUrl=function(e,t){var n=this;return this.getGraphItemUrl(e).then(function(e){return e+"/"+n.getDefaultExtension(t)+":/content?@name.conflictBehavior=defaultName"})};t.prototype.getGraphItemUrl=function(e){return this.resources.consumeAsync(u.graph).then(function(t){return t.getItemUrl(e,{isPath:!0,useDirectEndpoint:!0})})};t.prototype.getDefaultExtension=function(e){var t="";switch(e){case i.DocumentType.Word:t=".docx";break;case i.DocumentType.Excel:t=".xlsx";break;case i.DocumentType.PowerPoint:t=".pptx";break;default:throw new TypeError("Invalid DocumentType")}return t};t.dependencies=n.__assign({},r.default.dependencies,{vroomDataRequestor:o.resourceKey});return t}(r.default);t.default=a;t.resourceKey=s.createResolvedResourceKey(e("module").id,a,n.__assign({},r.default.dependencies,{vroomDataRequestor:o.resourceKey}))});
define("odsp-next/actions/createFolder/odc/CreateFolderAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/url/QueryType","../../base/templates/ExecutorAction","../../../models/item/command/FileSystemItemCommandKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(t){n.__extends(s,t);function s(){var e=null!==t&&t.apply(this,arguments)||this;e.name="CreateFolder";return e}s.prototype.getExecutorPath=function(){return"odsp-next/actions/createFolder/odc/CreateFolderExecutor"};s.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/createFolder/odc/CreateFolderExecutor"],t,n)})}};s.prototype.getSelectionOptions=function(){return{canFallback:!0}};s.prototype.getExecutorParameters=function(){var e=this;return this.selectionHelper.resolveFirst().then(function(t){return{actionName:e.name,item:t}})};s.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return!(e&&e.vault&&e.vault.isLocked)&&e&&e.queryType===i.default.Files&&this.itemCommandHelper.isCommandSupported(e,o.createFolder)};return s}(s.default);t.default=u});
define("odsp-next/models/item/command/FileSystemItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createFolder=new n.default("createFolder");t.rename=new n.default("rename");t.moveFrom=new n.default("moveFrom");t.copyFrom=new n.default("copyFrom");t.moveTo=new n.default("moveTo");t.copyTo=new n.default("copyTo");t.deleteItem=new n.default("deleteItem");t.restoreItem=new n.default("restoreItem");t.deleteAllItems=new n.default("deleteAllItems");t.restoreAllItems=new n.default("restoreAllItems");t.createText=new n.default("createText");t.changeExpiration=new n.default("changeExpiration");t.open=new n.default("open");t.openInTextEditor=new n.default("openInTextEditor");t.openPdfInBrowser=new n.default("openPdfInBrowser");t.quickEdit=new n.default("quickEdit");t.editItem=new n.default("editItem");t.createShortcut=new n.default("createShortcut");t.pinToMru=new n.default("pinToMru");t.printPdf=new n.default("printPdf")});
define("odsp-next/actions/odc/CreateMountPointAction",["require","exports","tslib","../../base/BaseAction","../../controls/commands/Commands.resx","../../controls/createMountPoint/CreateMountPoint","@ms/odsp-utilities/lib/async/Promise","../../providers/dialog/DialogProvider","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/string/StringHelper","../../utilities/icons/Icon","../../providers/item/ItemProvider","../base/ItemCommandHelper","../../models/item/command/SocialItemCommandKeys","../base/ItemRedeemer","../base/ItemSelectionHelper","@ms/odsp-utilities/lib/scope/Scope","../../resources/ControlResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.isSingleSelectAction=!0;r.canFallbackToParent=!0;r.name="CreateMountPoint";r._actionMap=r.resources.consume(g.actionMap);r._itemReedemer=new(r.managed(d.default));r._itemCommandHelper=new(r.managed(h.default));r._itemSelectionHelper=new(r.child(v.typeResourceKey))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._itemCommandHelper.isCommandSupported(e,p.addAsMountPoint)};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,o.default,function(){var e,t,r,h,p,d,v,g,y,b=this;return n.__generator(this,function(w){switch(w.label){case 0:e=this.resources.consume(u.resourceKey);return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(t=w.sent())?[4,this._itemReedemer.redeemItem(t,this)]:[2,{resultType:a.ResultTypeEnum.ExpectedFailure}];case 2:w.sent();r=new(this.scope.attached(m.default));h=this.observables.create(!0);p=this.observables.create(!0);d=this.observables.create(i.strings.CreateMountPointDetails);v=f.format(i.strings.CreateMountPointTitle,t.name);g=function(){return n.__awaiter(b,void 0,o.default,function(){var e,r,s;return n.__generator(this,function(n){switch(n.label){case 0:e=this.resources.consume(c.resourceKey);h(!1);p(!1);d(i.strings.CreateMountPointWait);n.label=1;case 1:n.trys.push([1,3,,4]);return[4,e.createMountPoint({item:t})];case 2:r=n.sent();new(this.managed(this._actionMap.OpenAction))({openRelation:2,item:this.createObservable(r)}).execute(null);return[2,2];case 3:if((s=n.sent()).data&&s.data.message){d(s.data.message);return[2,1]}return[2,1];case 4:return[2]}})})};y=e.requestDialog({title:v,component:{name:s.default.tagName,params:{text:d,isLearnMoreVisible:h}},actions:[{name:i.strings.CreateMountPointConfirm,execute:function(){return g()},isAvailable:h,isVisible:h,icon:new l.default("OneDriveAdd"),isDefault:!0},{name:i.strings.Close,execute:function(){return o.default.resolve(2)},isAvailable:this.observables.create(!0),isVisible:r.attach(this.observables.pureCompute(function(){return!h()})),icon:new l.default("Cancel"),isDefault:!0}]});w.label=3;case 3:w.trys.push([3,,5,6]);return[4,y.wait()];case 4:w.sent();this._itemSelectionHelper.clearSelection();return[3,6];case 5:r.dispose();return[7];case 6:return[2,{resultType:a.ResultTypeEnum.Success}]}})})};return t}(r.default);t.default=y});
define("odsp-next/controls/createMountPoint/CreateMountPoint",["require","exports","./CreateMountPointViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./CreateMountPoint.html"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-create-mp",template:e("./CreateMountPoint.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/createMountPoint/CreateMountPointViewModel",["require","exports","tslib","../commands/Commands.resx","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(n){var i=e.call(this,n)||this;i.text=n.text;i.isLearnMoreVisible=n.isLearnMoreVisible;i.learnMoreText=r.strings.CreateMountPointLearnMore;i.learnMoreUrl=t.LEARNMORE_URL;return i}t.LEARNMORE_URL="https://go.microsoft.com/fwlink/p/?LinkID=389986";return t}(i.default);t.default=s});
define("odsp-next/controls/createMountPoint/CreateMountPoint.html",[],function(){return'<div class=CreateMountPoint><span data-bind="text: text"></span> <a data-bind="attr: {href: learnMoreUrl}, text: learnMoreText, visible: isLearnMoreVisible"></a></div>'});
define("odsp-next/models/item/command/SocialItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.share=new n.default("share");t.addToShared=new n.default("addToShared");t.embed=new n.default("embed");t.comment=new n.default("comment");t.removeFromShared=new n.default("removeFromShared");t.addAsMountPoint=new n.default("addAsMountPoint");t.removeAsMountPoint=new n.default("removeAsMountPoint");t.reportAbuse=new n.default("reportAbuse");t.requestReview=new n.default("requestReview");t.alertItem=new n.default("alertItem");t.addToSpotlight=new n.default("alertItem")});
define("odsp-next/actions/odc/DefaultClickAction",["require","exports","tslib","../DefaultClickAction","../../resources/ODCResourceKeys","./ShowNotSharedAction","../../dataSources/url/AutoActionType","../base/ItemCommandHelper","../../models/item/command/CoreItemCommandKeys","../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._odcUrlDataSource=n.resources.consume(i.urlDataSource);n._itemCommandHelper=new(n.managed(u.default));n._defaultClickBehavior=n.createPureComputed(n._computeDefaultClickBehavior);n._isOneDriveWinApp=f.isOneDriveWinApp();return n}t.prototype.onIsAvailable=function(){var t=this.item(),n=this.hideIfDefaultIsDownload&&4===this._itemCommandHelper.getCommandBehavior(t,a.defaultClick);return e.prototype.onIsAvailable.call(this)&&!n};t.prototype.onComputeAction=function(){var t,n=this;switch(this._defaultClickBehavior()){case 1:t=e.prototype.onComputeAction.call(this);break;case 2:case 3:t=this._isOneDriveWinApp?new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item,focusUrl:!0}):new(this.managed(this.actionMap.OpenInOfficeOnlineAction))({item:this.item,openLocal:!this.userInvokedItem,useDefaultAction:!0});break;case 4:case 7:t=new(this.managed(this.actionMap.DownloadAction))({item:this.item,userInvokedItem:this.userInvokedItem});break;case 6:case 10:t=new(this.managed(this.actionMap.OpenInOfficeClientAction))({item:this.item,userInvokedItem:this.userInvokedItem});break;case 11:t=new(this.managed(this.actionMap.NavigationAction))({url:this.createPureComputed(function(){var e=n._odcUrlDataSource.qualifyUrl(n._odcUrlDataSource.getDefaultClickUrl(n.item(),{action:o.default.defaultClick,viewParams:n.viewParams()}));return n._odcUrlDataSource.getAuthenticateUrl(e)}),userInvokedItem:this.userInvokedItem});break;case 15:t=new(this.managed(this.actionMap.PlayAudioAction))({item:this.item});break;case 50:t=new(this.managed(s.default))}return t};t.prototype._computeDefaultClickBehavior=function(){return this._itemCommandHelper.getCommandBehavior(this.item(),a.defaultClick)};return t}(r.default);t.default=l});
define("odsp-next/actions/DefaultClickAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ControlResourceKeys","../models/item/ItemType","../resources/DataSourceResourceKeys","../resources/ProviderResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../dataSources/url/PageType","./base/ItemSelectionHelper","../models/item/engagement/ItemEngagementParts","@ms/odsp-utilities/lib/logging/engagement/parts/EventEngagementParts","../models/engagement/Engagement","../providers/engagement/Engagement"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openEngagementPart=new v.EngagementPart("Open",2);var g=function(e){n.__extends(r,e);function r(n,r){void 0===r&&(r={});var i=e.call(this,n,r)||this;i.name="DefaultClick";i.isQosLogged=!1;var o=n.item,f=n.userInvokedItem,c=void 0!==f&&f,p=n.hideIfDefaultIsDownload,d=void 0!==p&&p,m=n.sourceEngagement,g=void 0===m?"":m,y=i,b=y.resources,w=y.observables;b.expose(v.engagementSourceResourceKey,b.consume(v.engagementSourceResourceKey).withPart(t.openEngagementPart));i._itemSelectionHelper=new(i.child(h.typeResourceKey))({overrideItem:o,allowMultiSelect:!1,canFallback:!1});i.item=i._itemSelectionHelper.firstItem;i.sourceEngagement=g;i.userInvokedItem=c;i.hideIfDefaultIsDownload=d;i.actionMap=b.consume(s.actionMap);i.urlDataSource=b.consume(u.url);i.viewParams=b.consume(s.viewParams);i._isFilePickerPage=w.pureCompute(i._computeIsFilePickerPage);i._action=w.pureCompute(i._computeAction);i._action.equalityComparer=l.objectStrictEquality;i._instrumentationProvider=b.consume(a.instrumentation);return i}r.prototype.onIsAvailable=function(){var e=this.observables.peekUnwrap(this._action);return!!e&&e.isAvailable()};r.prototype.onExecute=function(e){var t=this.observables,n=t.peekUnwrap(this.item);this._logEngagement(n,e);var r=this._instrumentationProvider;r&&n&&r.userClickItem(n);var s=t.peekUnwrap(this._action);return s&&s.execute(e)||f.default.resolve({resultType:i.ResultTypeEnum.ExpectedFailure})};r.prototype.onComputeAction=function(){return new(this.managed(this.actionMap.OpenAction))({openRelation:2,item:this.item})};r.prototype._computeIsFilePickerPage=function(){return this.urlDataSource.getPageType(this.viewParams())===c.default.FilePicker};r.prototype._computeAction=function(){var e,t=this._lastAction;if(t){t.dispose();this._lastAction=void 0}var n=this.item();this._isFilePickerPage()&&n&&n.type!==o.default.Folder||(e=this.onComputeAction());this._lastAction=e;return e};r.prototype._logEngagement=function(e,t){var n=this.sourceEngagement;if(n){var r;if(e)switch(e.type){case o.default.File:r="FileOpen."+n;break;case o.default.Folder:r="FolderOpen."+n;break;case o.default.App:r="AppOpen."+n;break;case o.default.Subsite:r="SubsiteOpen."+n;break;default:r="Open."+n}else r="Open."+n;this.resources.consume(m.resourceKey).withPart(d.clickEngagementPart).withPart(p.itemEngagementPart,{item:e}).logData({name:r,extraData:{action:t?t.type:"unknown"}})}};return r}(r.default);t.default=g});
define("odsp-next/models/item/engagement/ItemEngagementParts",["require","exports","../../engagement/Engagement"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemEngagementPart=new n.EngagementPart("Item",1)});
define("odsp-next/actions/odc/ShowNotSharedAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../../controls/textContainer/TextContainer.resx","../../controls/textContainer/TextContainer","@ms/odsp-utilities/lib/async/Promise","../../providers/dialog/DialogProvider"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=s.strings,l=function(e){n.__extends(t,e);function t(){var t=e.call(this,{})||this;t.name="ShowNotShared";t._dialogProvider=t.resources.consume(a.resourceKey);return t}t.prototype.onExecute=function(e){return this._dialogProvider.requestDialog({title:f.titleNotShared,component:{name:o.default.tagName,params:{text:f.textNotShared}},actions:[]}).wait().then(function(){return u.default.wrap({resultType:i.ResultTypeEnum.Success})})};return t}(r.default);t.default=l});
define("odsp-next/models/item/command/CoreItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultClick=new n.default("defaultClick")});
define("odsp-next/actions/delete/odc/DeleteAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/url/QueryType","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys","../../../models/item/command/FileSystemItemCommandKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){n.__extends(s,t);function s(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="Delete";n.logStartEnd=!0;n._currentItem=n.resources.consume(o.currentItem);return n}s.prototype.getExecutorPath=function(){return"odsp-next/actions/delete/odc/DeleteExecutor"};s.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/delete/odc/DeleteExecutor"],t,n)})}};s.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};s.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek()}};s.prototype.onIsAvailable=function(){var e=this;return this._currentItem()&&this.selectionHelper.filterItems(function(t){var n=!!t.parent&&t.parent.isBundle,r=!!t.parent&&t.parent.isAlbum;return e.itemCommandHelper.isCommandSupported(t,u.deleteItem)&&t.queryType!==i.default.SharedWithMe&&t.queryType!==i.default.DocsInCommon&&!n&&!r})};return s}(s.default);t.default=a});
define("odsp-next/actions/download/odc/DownloadAction",["require","exports","tslib","cookies","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys","../../../dataSources/url/QueryType","../../../models/item/command/WebItemCommandKeys","../../../actions/base/ItemCommandHelper","../../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(t){n.__extends(s,t);function s(e){void 0===e&&(e={});var n=t.call(this,e)||this;n._itemCommandHelper=new(n.managed(f.default));n.name="Download";n._currentItem=n.resources.consume(o.currentItem);n._itemCommandHelper=new(n.managed(f.default));n._isOneDriveWinApp=l.isOneDriveWinApp();return n}s.prototype.getExecutorPath=function(){return"odsp-next/actions/download/odc/DownloadExecutor"};s.prototype.getModuleFactory=function(){return function(){return new i.default(function(t,n){e(["odsp-next/actions/download/odc/DownloadExecutor"],t,n)})}};s.prototype.getSelectionOptions=function(){return{allowMultiSelect:!this._isOneDriveWinApp,canFallback:!0}};s.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek(),actionName:this.name}};s.prototype.onIsAvailable=function(){var e=this,t=this.selectionHelper.selection(),n=this.selectionHelper.firstItem();if((t.length>1||n&&n.folder)&&r.get("BadgerAuth"))return!1;var i=this._currentItem();return!(t.length>1&&i.queryType===u.default.SharedWithMe&&i.isRootFolder)&&this.selectionHelper.filterItems(function(t){return e._itemCommandHelper.isCommandSupported(t,a.download)})};return s}(s.default);t.default=c});
define("odsp-next/actions/editTags/odc/EditTagsAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/ItemCommandHelper","../../../models/item/command/PhotoItemCommandKeys","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){n.__extends(o,t);function o(e){var n=t.call(this,e)||this;n.name="EditTagsAction";n._itemCommandHelper=new(n.managed(i.default));n._currentItem=n.resources.consume(u.currentItem);return n}o.prototype.getExecutorPath=function(){return"odsp-next/actions/editTags/odc/EditTagsExecutor"};o.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/editTags/odc/EditTagsExecutor"],t,n)})}};o.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}};o.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek()}};o.prototype.onIsAvailable=function(){var e=this;return this.selectionHelper.filterItems(function(t){return t&&(!!t.photo||!!t.video)&&e._itemCommandHelper.isCommandSupported(t,s.editTags)})};return o}(o.default);t.default=a});
define("odsp-next/actions/embed/odc/EmbedAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../models/item/command/SocialItemCommandKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){n.__extends(i,t);function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="Embed";return n}i.prototype.getExecutorPath=function(){return"odsp-next/actions/embed/odc/EmbedExecutor"};i.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/embed/odc/EmbedExecutor"],t,n)})}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};i.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}};i.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&this.itemCommandHelper.isCommandSupported(e,s.embed)};return i}(i.default);t.default=o});
define("odsp-next/actions/emptyRecycleBin/odc/EmptyRecycleBinAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../utilities/icons/Icon","@ms/odsp-utilities/lib/logging/events/Qos.event","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys","../../../controls/textContainer/TextContainer","../../../providers/dialog/DialogProvider","../../../resources/DataSourceResourceKeys","../../../controls/commands/Commands.resx","../../../models/item/command/FileSystemItemCommandKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(t){n.__extends(o,t);function o(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="EmptyRecycleBin";n._urlDataSource=n.resources.consume(l.url);n._strings=c.strings;n._usePollGetItemsForDeletion=e.usePollGetItemsForDeletion;n._currentItem=n.resources.consume(u.currentItem);return n}o.prototype.getExecutorPath=function(){return"odsp-next/actions/emptyRecycleBin/odc/EmptyRecycleBinExecutor"};o.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/emptyRecycleBin/odc/EmptyRecycleBinExecutor"],t,n)})}};o.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};o.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem.peek(),usePollGetItemsForDeletion:this._usePollGetItemsForDeletion}};o.prototype.onIsAvailable=function(){var e=this.selectionHelper.selection(),t=this._currentItem();return t&&this.itemCommandHelper.isCommandSupported(t,h.deleteAllItems)&&this._urlDataSource.isRecycleBin(t.queryType)&&t.childCount>0&&0===e.length};o.prototype.onExecute=function(e){var n=this;return this._usePollGetItemsForDeletion?t.prototype.onExecute.call(this,e):this.resources.consume(f.resourceKey).requestDialog({title:this._strings.emptyRecycleBin,component:{name:a.default.tagName,params:{text:this._strings.recycleBinEmptyConfirm}},actions:[{name:this._strings.recycleBinEmptyConfirmYes,execute:function(){return r.default.wrap(2)},isAvailable:this.createObservable(!0),icon:new i.default("Delete"),isDefault:!1},{name:this._strings.recycleBinEmptyConfirmNo,execute:function(){return r.default.wrap(3)},isAvailable:this.createObservable(!0),icon:new i.default("Cancel"),isDefault:!0}]}).wait().then(function(){return t.prototype.onExecute.call(n,e)}).then(function(){return{resultType:s.ResultTypeEnum.Success}})};return o}(o.default);t.default=p});
define("odsp-next/actions/navigateToItem/NavigateToItemAction",["require","exports","tslib","../../base/BaseAction","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../base/ItemSelectionHelper"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t)||this;r.name="NavigateToItem";r._urlDataSource=r.resources.consume(s.url);r._viewParams=r.resources.consume(i.viewParams);var u=t.item,a=t.itemSet,f=void 0===a?r.resources.consume(i.currentItemSet):a,l=t.forceAsFocusItem,c=void 0!==l&&l,h=t.isRedirect,p=void 0!==h&&h,d=t.forceInSameWindow,v=void 0!==d&&d,m=t.shouldPreserveAction,g=void 0!==m&&m;r._itemSet=f;r._forceAsFocusItem=r.wrapObservable(c);r._isRedirect=p;r._forceInSameWindow=r.wrapObservable(v);r._shouldPreserveAction=r.wrapObservable(g);var y=n.itemSelectionHelperType,b=void 0===y?r.resources.consume(o.typeResourceKey):y;r._itemSelectionHelper=new(r.scope.attached(b))({overrideItem:u,allowMultiSelect:!1,canFallback:!0});r._url=r.createPureComputed(r._computeUrl);r._target=r.createPureComputed(r._computeTarget);var w=r.resources.consume(i.actionMap);r._navigationAction=new(r.managed(w.NavigationAction))({url:r._url,ignoreHistory:r._isRedirect,target:r._target});return r}t.prototype.onIsAvailable=function(){return this._navigationAction.isAvailable()};t.prototype.onExecute=function(e){return this._navigationAction.execute(e)};t.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._urlDataSource.getDefaultClickUrl(e,{focusUrl:this._forceAsFocusItem(),preserveAction:this._shouldPreserveAction(),itemSet:this._itemSet(),viewParams:this._viewParams()})||""};t.prototype._computeTarget=function(){var e;return!this._forceInSameWindow()&&(e=this._url())&&0!==e.indexOf("#")?"_blank":"_top"};return t}(r.default);t.default=u});
define("odsp-next/actions/sort/od/OneDriveSortAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","./../SortAction","../../../resources/ControlResourceKeys","../../../resources/PagesResourceKeys","./SortActionMode"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="Sort";n._sortManager=n.resources.consume(a.sortManager);n._currentItemSet=n.resources.consume(u.currentItemSet);n._mode=t.mode;n._column=t.column;n._ascending=t.ascending;return n}t.prototype.onExecute=function(e,t){var n=o.default.getSortedColumn(this._currentItemSet().schema);this._column||(this._column=n);var r={sortMode:f.default[this._mode],sortAscending:"Ascending"};this._column&&(r.sortColumn=this._column.internalName||this._column.key);if(this._mode===f.default.Column)this.updateCurrentSort(this._column,n.isAscending);else if(this._mode===f.default.Order){if(this._currentItemSet&&this._currentItemSet().schema){r.sortAscending=this._ascending?"Ascending":"Descending";this.updateCurrentSort(n,this._ascending)}}else i.default.wrap({resultType:s.ResultTypeEnum.Failure});return i.default.wrap({resultType:s.ResultTypeEnum.Success,extraData:r})};t.prototype.onIsAvailable=function(){return!!this._currentItemSet&&(!this._isVaultLocked()&&!!o.default.getSortedColumn(this._currentItemSet().schema))};t.prototype.onIsToggled=function(){var e=!1;if(this._mode===f.default.Column&&this._column)e=this._column.isSorted;else if(this._mode===f.default.Order&&this._currentItemSet&&this._currentItemSet().schema){var t=o.default.getSortedColumn(this._currentItemSet().schema);e=t&&t.isAscending===this._ascending}return!this._isVaultLocked()&&e};t.prototype.updateCurrentSort=function(e,t){if(e){var n=e.internalName||e.key;this._sortManager.updateSort(n,t)}};t.prototype._isVaultLocked=function(){var e=this._currentItemSet&&this._currentItemSet().item();return e&&e.vault&&e.vault.isLocked};return t}(r.default);t.default=l});
define("odsp-next/actions/sort/SortAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/PagesResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="SortAction";n.isExecutionIntentional=!0;n._sortManager=n.resources.consume(o.sortManager);n._column=t.column;n._ascending=t.ascending;return n}t.getSortedColumn=function(e){var t,n=e();if(n)for(var r=0;r<n.length;r++)if(n[r]&&n[r].isSorted){t=n[r];break}return t};t.prototype.onExecute=function(e,t){this._updateCurrentSort(this._column,this._ascending);return i.default.wrap({resultType:s.ResultTypeEnum.Success})};t.prototype.onIsAvailable=function(){return!0};t.prototype.onIsToggled=function(){var e=!1;this._column&&(e=this._column.isSorted&&this._column.isAscending===this._ascending);return e};t.prototype._updateCurrentSort=function(e,t){if(e){var n=e.internalName||e.key;this._sortManager.updateSort(n,t)}};return t}(r.default);t.default=u});
define("odsp-next/resources/PagesResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.sortManager=new n.ResourceKey("sortManager");t.dataManager=new n.ResourceKey("dataManager");t.listViewContextMenuCommandSet=new n.ResourceKey("listViewContextMenuCommandSet");t.topCommandSet=new n.ResourceKey("topCommandSet");t.listViewContextMenuHelper=new n.ResourceKey("listViewContextMenuHelper");t.fileContent=new n.ResourceKey("fileContent");t.contentRange=new n.ResourceKey("contentRange");t.error=new n.ResourceKey("error");!function(e){!function(e){e.isLeftNavClosing=new n.ResourceKey("base.leftNav.isLeftNavClosing");e.isLeftNavVisible=new n.ResourceKey("base.leftNav.isLeftNavVisible");e.hideLeftNav=new n.ResourceKey("base.leftNav.hideLeftNav");e.isLeftNavUserExpanded=new n.ResourceKey("base.leftNav.isLeftNavUserExpanded");e.toggleIsLeftNavUserExpanded=new n.ResourceKey("base.leftNav.toggleIsLeftNavUserExpanded")}(e.leftNav||(e.leftNav={}));!function(e){e.context=new n.ResourceKey("base.suiteNav.context");e.isTopBarVisible=new n.ResourceKey("base.suiteNav.isTopBarVisible");e.isTopBarHamburgerVisible=new n.ResourceKey("base.suiteNav.isTopBarHamburgerVisible");e.isSuiteNavHamburgerVisible=new n.ResourceKey("base.suiteNav.isSuiteNavHamburgerVisible");e.supportHamburgerInSuiteNav=new n.ResourceKey("base.suiteNav.supportHamburgerInSuiteNav");e.isSuiteNavHidden=new n.ResourceKey("base.suiteNav.isSuiteNavHidden")}(e.suiteNav||(e.suiteNav={}));!function(e){e.transclusionProvider=new n.ResourceKey("base.commandBar.transclusionProvider");e.isDarkTheme=new n.ResourceKey("base.commandBar.isDarkTheme");e.isSearchHidden=new n.ResourceKey("base.commandBar.isSearchHidden")}(e.commandBar||(e.commandBar={}));!function(e){e.isInfoPaneAvailable=new n.ResourceKey("base.infoPane.isInfoPaneAvailable");e.hidePreview=new n.ResourceKey("base.infoPane.hidePreview")}(e.infoPane||(e.infoPane={}));!function(e){e.isFiltersPaneAvailable=new n.ResourceKey("base.filtersPane.isFiltersPaneAvailable")}(e.filtersPane||(e.filtersPane={}));!function(e){e.isColumnCustomizationPaneExpanded=new n.ResourceKey("base.columnCustomizationPane.isColumnCustomizationPaneExpanded");e.columnToFormat=new n.ResourceKey("base.columnCustomizationPane.columnToFormat");e.viewToFormat=new n.ResourceKey("base.columnCustomizationPane.viewToFormat")}(e.columnCustomizationPane||(e.columnCustomizationPane={}));!function(e){e.hasFooter=new n.ResourceKey("base.footer.hasFooter")}(e.footer||(e.footer={}));e.isSPLightSpeed=new n.ResourceKey("base.isSPLightSpeed");e.addPaddingBottom=new n.ResourceKey("base.addPaddingBottom");e.makeFlexBox=new n.ResourceKey("base.makeFlexBox");e.contextMenuHelper=new n.ResourceKey("base.contextMenuHelper");e.isRetrievingData=new n.ResourceKey("base.isRetrievingData");e.isSmartBannerVisible=new n.ResourceKey("base.isSmartBannerVisible")}(t.base||(t.base={}));!function(e){e.layoutType=new n.ResourceKey("files.layoutType");e.resx=new n.ResourceKey("files.resx");e.isArrangeControlVisible=new n.ResourceKey("files.isArrangeControlVisible")}(t.files||(t.files={}));!function(e){e.layoutType=new n.ResourceKey("photos.layoutType")}(t.photos||(t.photos={}));!function(e){e.layoutType=new n.ResourceKey("storageInfo.layoutType")}(t.storageInfo||(t.storageInfo={}));t.eventScope=new n.ResourceKey("eventScope")});
define("odsp-next/actions/sort/od/SortActionMode",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.Column=0]="Column";e[e.Order=1]="Order"}(n||(n={}));t.default=n});
define("odsp-next/actions/odc/OpenAction",["require","exports","tslib","../OpenAction","../../resources/ControlResourceKeys","../../resources/DataSourceResourceKeys","../../models/item/command/CoreItemCommandKeys","../base/ItemCommandHelper","@ms/odsp-utilities/lib/logging/events/Qos.event","../../dataSources/url/PageType","../vault/VaultActionType"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._itemCommandHelper=new(n.managed(u.default));n._skipVaultChecks=!!t.ignoreHistory;return n}t.prototype.onIsAvailable=function(){var t=this.item();return e.prototype.onIsAvailable.call(this)&&this._itemCommandHelper.isCommandSupported(t,o.defaultClick)};t.prototype.onExecute=function(t,n){var r=this,o=this.item.peek();if(o&&o.vault&&!this._skipVaultChecks){var u=this.resources.consume(s.url),c=this.resources.consume(i.viewParams),h=u.getPageType(c.peek()),p=h===f.default.FilePicker||h===f.default.FolderPicker;if(o.vault.isLocked||p){var d=this.resources.consume(i.actionMap);return new(this.managed(d.VaultAction))({actionType:l.default.Unlock,usePopup:!0,item:this.item}).execute(null).then(function(i){if(i.resultType===a.ResultTypeEnum.Success)return e.prototype.onExecute.call(r,t,n)})}}return e.prototype.onExecute.call(this,t,n)};return t}(r.default);t.default=c});
define("odsp-next/actions/OpenAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../models/item/engagement/ItemEngagementParts","../resources/ControlResourceKeys","../models/item/ItemType","./base/ItemSelectionHelper","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="Open";var i=t.item,s=t.openRelation,o=void 0===s?0:s,a=t.ignoreHistory,l=void 0!==a&&a,c=t.itemSet,h=void 0===c?r.resources.consume(u.currentItemSet):c,p=t.openLocal,d=void 0!==p&&p,v=t.focusUrl,m=void 0!==v&&v,g=t.preserveAction,y=void 0!==g&&g,b=t.nonFoldersOnly,w=void 0!==b&&b;r._openRelation=o;r._nonFoldersOnly=w;r._focusUrl=r.wrapObservable(m);r._itemSelectionHelper=new(r.child(f.typeResourceKey))({overrideItem:2===o?i:void 0,allowMultiSelect:!1,canFallback:0!==o,ignoreSelection:0!==o});r.item=r.createComputed(r._computeItem,{deferEvaluation:!0,pure:!0});var E=r.resources.consume(u.actionMap);r._navigateToItemAction=new(r.managed(E.NavigateToItemAction))({item:r.item,itemSet:h,forceAsFocusItem:r.createPureComputed(r._computeForceAsFocusItem),forceInSameWindow:d,isRedirect:l,shouldPreserveAction:y});return r}t.prototype.onIsAvailable=function(){var e=this.item();return(!this._nonFoldersOnly||e&&!e.folder)&&this._navigateToItemAction.isAvailable()};t.prototype.onExecute=function(e,t){var n=this.item.peek();n.type===a.default.Folder&&t&&t.data&&(t.data.folder=!0);t.data.extraData||(t.data.extraData={});l.extend(t.data.extraData,{uniqueId:n.properties?n.properties.uniqueId:void 0});return this._navigateToItemAction.execute(e).then(function(){var e={fileType:a.default[n.type],extension:n.extension||""};return i.default.resolve({resultType:s.ResultTypeEnum.Success,extraData:e})})};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(o.itemEngagementPart,{item:this.item.peek()})};t.prototype.trackUserAction=function(t){switch(this.item.peek().type){case a.default.File:e.prototype.trackUserAction.call(this,"Open.File");break;case a.default.Media:e.prototype.trackUserAction.call(this,"Open.Media");break;default:e.prototype.trackUserAction.call(this,t)}};t.prototype._computeItem=function(){var e,t=this._itemSelectionHelper.firstItem();switch(this._openRelation){case 3:e=t&&t.parent;break;case 1:case 2:e=t;break;default:case 0:e=t}return e};t.prototype._computeForceAsFocusItem=function(){return this._focusUrl()};return t}(r.default);t.default=c});
define("odsp-next/actions/vault/VaultActionType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.Lock=1]="Lock";e[e.Unlock=2]="Unlock";e[e.Manage=3]="Manage";e[e.FreDialog=4]="FreDialog";e[e.ShowFiles=5]="ShowFiles";e[e.Reset=6]="Reset";e[e.Debug=7]="Debug";e[e.FilesRemaining=8]="FilesRemaining"}(n||(n={}));t.default=n});
define("odsp-next/actions/preview/PreviewAction",["require","exports","tslib","../../base/BaseAction","../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/models/store/BaseDataStore","@ms/odsp-utilities/lib/models/store/DataStoreCachingType","../base/ItemSelectionHelper","../../dataSources/url/QueryType","../../models/item/engagement/ItemEngagementParts","../../models/item/ItemParentHelper","../../utilities/features/Features","../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="Preview";var r=n.resources.consume(i.actionMap);n._dataStore=new s.default("",o.default.local);n._itemSelectionHelper=new(n.child(u.typeResourceKey))({allowMultiSelect:!1,overrideItem:t.item,canFallback:!1});n._openAction=new(n.managed(r.OpenAction))({focusUrl:n.observables.compute(n._computeFocusUrl),item:t.item,openRelation:t.item?2:void 0,nonFoldersOnly:!0});n._openInDesktopAction=new(n.managed(r.OpenInDesktopAction))({item:t.item});n._itemParentHelper=n.resources.consume(l.resourceKey);return n}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem(),t=null;e&&(t=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")));return e&&!e.external&&this._openAction.isAvailable()&&(c.isFeatureEnabled(c.ODBVroomSharedWithMe)||e.queryType!==a.default.SharedWithMe)&&(!t||!t.list||t.list.isDocumentLibrary)};t.prototype.onExecute=function(e,t){var n=this._itemSelectionHelper.firstItem.peek();!n||"ms-word"!==n.appMap&&"ms-powerpoint"!==n.appMap?this._dataStore.setValue("OfficeDocClickTime",""):this._dataStore.setValue("OfficeDocClickTime",new Date);return h.isMagellan()?this._openInDesktopAction.execute(e):this._openAction.execute(e)};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(f.itemEngagementPart,{item:this._itemSelectionHelper.firstItem.peek()})};t.prototype._computeFocusUrl=function(){var e=this._itemSelectionHelper.firstItem();return!(e&&e.queryType===a.default.Recent)};return t}(r.default);t.default=p});
define("odsp-next/actions/odc/OpenInOfficeClientAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/object/ObjectUtil","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/browser/PlatformDetection.key","./SkyApiHelper","../base/ItemRedeemer","./OfficeActionIdMap","../base/ItemCommandHelper","../../resources/ODCResourceKeys","../../dataSources/url/odc/UrlDataSource","../../base/BaseAction","../base/ItemSelectionHelper","../../models/item/command/OfficeItemCommandKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g,y=((g={})[1]=l.default.Excel,g[2]=l.default.OneNote,g[3]=l.default.PowerPoint,g[4]=l.default.Word,g[5]=l.default.Visio,g[6]=l.default.Project,g[7]=l.default.Publisher,g),b=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="OpenInOfficeClient";r._itemReedemer=new(r.managed(f.default));r._navigation=r.resources.consume(o.navigation);r._platform=r.resources.consume(u.platformDetection);r._itemCommandHelper=new(r.managed(c.default));r._urlDataSource=r.resources.consume(h.urlDataSource);r._itemSelectionHelper=new(r.child(v.typeResourceKey))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._platform,t=this._itemSelectionHelper.firstItem();return(e.isMac||e.isWindows||e.isIOS||e.isWinPhone||e.isAndroid)&&!!t&&this._itemCommandHelper.isCommandSupported(t,m.openInClient)};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var e,o=this;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:if(!(e=n.sent()))return[2,r.default.resolve({resultCode:"EmptySelection",resultType:s.ResultTypeEnum.Failure})];t.data.extraData||(t.data.extraData={});i.extend(t.data.extraData,{fileType:e.extension?e.extension.toLowerCase():void 0});return[2,this._itemReedemer.redeemItem(e,this).then(function(){if(o._platform.isMobile){var t=o._navigation,n=o._urlDataSource;t.navigateTo(n.getOpenInOfficeClientUrl(e,o._navigation.viewParams,p.default.viewerId));return{resultType:s.ResultTypeEnum.Success}}var r=o._itemCommandHelper.getCommandBehavior(e,m.openInClient),i=y[r];return a.openInClient(e,p.default.viewerId,!!e.isGroup,l.default[i],o.resources)})]}})})};return t}(d.default);t.default=b});
define("odsp-next/actions/OpenPdfInBrowserAction",["require","exports","tslib","./base/ItemCommandHelper","./base/ItemSelectionHelper","../base/BaseAction","../models/item/command/FileSystemItemCommandKeys","../resources/ControlResourceKeys","../resources/DataSourceResourceKeys","../utilities/item/ListItemTypeConverter","../utilities/browser/WebViewDetector","./OpenInDesktopAction","../models/item/engagement/ItemEngagementParts"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="OpenPdfInBrowserAction";var s=n,o=s.observables,f=s.resources;n._itemCommandHelper=f.consume(r.resourceKey);n._itemSelectionHelper=new(n.child(i.typeResourceKey))({overrideItem:t.item});n._urlDataSource=f.consume(a.url);var h=o.pureCompute(function(){var e=n._itemSelectionHelper.firstItem();return e&&e.openUrl}),p=f.consume(u.actionMap);n._navigationAction=new(n.managed(p.NavigationAction))({url:h,target:"_blank"});l.isOneDriveWinApp()&&(n._openInDesktopAction=new(n.managed(p.OpenInDesktopAction))({openRelation:2,item:n._itemSelectionHelper.firstItem,actionType:c.DesktopActionType.OpenPdfInBrowser}));return n}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!(this._openInDesktopAction&&!this._openInDesktopAction.isAvailable())&&(!!e&&f.canListItemBeOpened(e,this._urlDataSource)&&this._itemCommandHelper.isCommandSupported(e,o.openPdfInBrowser)&&".pdf"===e.extension.toLowerCase())};t.prototype.onExecute=function(e,t){return this._openInDesktopAction?this._openInDesktopAction.execute(e):this._navigationAction.execute(e)};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(h.itemEngagementPart,{item:this._itemSelectionHelper.firstItem.peek()})};return t}(s.default);t.default=p});
define("odsp-next/utilities/item/ListItemTypeConverter",["require","exports","@ms/odsp-datasources/lib/Permissions"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.convertToISPListItem=function(e){return e};t.convertToIOneDriveItem=function(e){return e};t.canListItemBeOpened=function(e,t){return e&&e.extension&&!!e.openUrl&&!t.isRecycleBin(e.queryType)&&4!==e.itemStatus&&3!==e.itemStatus&&n.PermissionMask.hasItemPermission(e,n.PermissionMask.openItems)}});
define("odsp-next/actions/odc/OpenInOfficeOnlineAction",["require","exports","tslib","cookies","../OpenInOfficeOnlineAction","./SkyApiHelper","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../../dataSources/url/QueryType","../../dataSources/url/odc/UrlDataSource","../../models/item/command/OfficeItemCommandKeys","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});return e.call(this,t)||this}t.prototype.onIsAvailable=function(){var e=this.item();return!!e&&((e.extension&&".pdf"===e.extension.toLowerCase()||this._itemCommandHelper.isCommandSupported(e,f.openOnline))&&e.queryType!==u.default.RecycleBin)};t.prototype.onExecute=function(t,n){var i=this.item.peek();i.queryType!==u.default.Search&&s.refreshItemWhenVisible(i.parent.isStub?i:i.parent,this.resources,!0);n.data.extraData||(n.data.extraData={});l.extend(n.data.extraData,{fileType:i.extension?i.extension.toLowerCase():void 0});r.set("BP",o.serializeQuery({FR:"SDX.Skydrive*Root",ST:(new Date).getTime()}),{domain:a.default.getCookieDomain()});try{localStorage.ODCWac_ST=(new Date).getTime().toString()}catch(e){}return e.prototype.onExecute.call(this,t,n)};return t}(i.default);t.default=c});
define("odsp-next/actions/OpenInOfficeOnlineAction",["require","exports","tslib","../base/BaseAction","../models/item/engagement/ItemEngagementParts","../resources/DataSourceResourceKeys","./base/ItemCommandHelper","../models/item/command/OfficeItemCommandKeys","./base/ItemSelectionHelper","../resources/ControlResourceKeys","../utilities/browser/WebViewDetector","../utilities/killSwitch/KillSwitch"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h="4DF83139-3BF3-4543-81F8-8AE4BF66F8B3",p=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="OpenInOfficeOnline";var r=t.openLocal,i=void 0!==r&&r,u=t.forceReadOnly,p=void 0!==u&&u,d=t.useDefaultAction,v=void 0!==d&&d;n._forceReadOnly=p;n._useDefaultAction=v;n._urlDataSource=n.resources.consume(s.url);n._viewParams=n.resources.consume(f.viewParams);n._itemSelectionHelper=new(n.child(a.typeResourceKey))({overrideItem:t.item});n._itemCommandHelper=n.resources.consume(o.resourceKey);n.item=n._itemSelectionHelper.firstItem;n._url=n.createPureComputed(n._computeUrl);var m=!1;c.default.isActivated(h,"09/03/2018","Teams Open Office Online In-App")||(m=l.isTeamsWebView());var g=n.resources.consume(f.actionMap);n._navigationAction=new(n.managed(g.NavigationAction))({url:n._url,target:i||l.isMagellan()||m?void 0:"_blank",postProcessUrl:function(e){return n._postProcessUrl(e)}});return n}t.prototype._postProcessUrl=function(e){return e};t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!(e&&e.openUrl&&e.appMap)&&this._itemCommandHelper.isCommandSupported(e,u.openOnline)&&this._navigationAction.isAvailable()};t.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(i.itemEngagementPart,{item:this._itemSelectionHelper.firstItem.peek()})};t.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return"";var t=this._viewParams();return this._urlDataSource.getOpenInOfficeOnlineUrl(e,t,{forceReadOnly:this._forceReadOnly,useDefaultAction:this._useDefaultAction})};return t}(r.default);t.default=p});
define("odsp-next/actions/openInTextEditor/OpenInTextEditorAction",["require","exports","tslib","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../base/BaseAction","../../resources/DataSourceResourceKeys","../../utilities/mime/MimeHelper","../base/ItemSelectionHelper","../base/ItemCommandHelper","../../models/item/command/FileSystemItemCommandKeys","../../models/item/engagement/ItemEngagementParts","../../resources/ControlResourceKeys","../../dataSources/url/QueryType","../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var i=e.call(this,t,n)||this;i.name="OpenInTextEditor";var o=i.resources,f=n.urlDataSource,l=void 0===f?o.consume(s.url):f,h=n.viewParams,d=void 0===h?o.consume(c.viewParams):h,v=n.itemCommandHelper,m=void 0===v?o.consume(a.resourceKey):v,g=n.platformDetection,y=void 0===g?o.consume(r.platformDetection):g,b=n.actionMap,w=void 0===b?o.consume(c.actionMap):b;i._urlDataSource=l;i._viewParams=d;i._itemCommandHelper=m;i._platformDetection=y;i._url=i.createPureComputed(i._computeUrl);i._itemSelectionHelper=new(i.child(u.typeResourceKey))({overrideItem:t.item});i._navigationAction=new(i.managed(w.NavigationAction))({url:i._url,target:"_blank"});i._isOneDriveWinApp=p.isOneDriveWinApp();return i}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return!1;var t=this._itemSelectionHelper.currentItem(),n=this._urlDataSource.getKeyParams(t.key),r=this._urlDataSource.getQueryType(n);return this._itemCommandHelper.isCommandSupported(e,f.openInTextEditor)&&!this._platformDetection.isMobile&&this._navigationAction.isAvailable()&&!!e&&!!e.parent&&o.canOpenItemInMonaco(e)&&r!==h.default.SharedWithMe&&!this._isOneDriveWinApp&&!this._urlDataSource.isRecycleBin(r)&&4!==e.itemStatus&&3!==e.itemStatus};t.prototype.onExecute=function(e){return this._navigationAction.execute(e)};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(l.itemEngagementPart,{item:this._itemSelectionHelper.firstItem.peek()})};t.prototype._computeUrl=function(){var e=this._itemSelectionHelper.firstItem();return e&&e.parent?this._urlDataSource.getTextEditorItemUrl(e,{parentItem:this._itemSelectionHelper.currentItem(),viewParams:this._viewParams()}):""};return t}(i.default);t.OpenInTextEditorAction=d;t.default=d});
define("odsp-next/actions/orderPrints/odc/OrderPrintsAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../resources/DataSourceResourceKeys","../../../utilities/features/Features","@ms/odsp-datasources/lib/Permissions","../../../dataSources/url/QueryType","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../base/templates/ExecutorAction"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(t){n.__extends(f,t);function f(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="OrderPrints";n._platformDetection=n.resources.consume(a.platformDetection);n._identity=n.resources.consume(i.identity).getIdentity();return n}f.prototype.getExecutorPath=function(){return"odsp-next/actions/orderPrints/odc/OrderPrintsExecutor"};f.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/orderPrints/odc/OrderPrintsExecutor"],t,n)})}};f.prototype.getExecutorParameters=function(){return{actionName:this.name,itemSelectionHelper:this.selectionHelper}};f.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};f.prototype.onIsAvailable=function(){if(!s.isFeatureEnabled(s.EnableOrderPrints))return!1;if(this._identity.type===o.IdentityType.anonymous)return!1;var e=this.selectionHelper.firstItem(),t=this.selectionHelper.selection().length,n=e&&e.queryType,r=n===u.default.Files||n===u.default.Photos||n===u.default.Search||n===u.default.AllMyPhotos||n===u.default.SharedWithMe;return!(!t||!r)&&(this._identity.type!==o.IdentityType.aad&&e.photo&&t>=1&&t<=100&&$Config&&"en-us"===$Config.mkt.toLowerCase()&&!this._platformDetection.isMac)};return f}(f.default);t.default=l});
define("odsp-next/actions/odc/PlayAudioAction",["require","exports","tslib","../base/ItemSelectionHelper","../../base/BaseAction","../../dataSources/url/QueryType","../../resources/ControlResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="PlayAudio";var i=n.resources.consume(o.actionMap),s=n.observables;n._item=new(n.child(r.typeResourceKey))({overrideItem:t.item,allowMultiSelect:!1,canFallback:!1}).firstItem;var u=new(n.managed(i.OpenAction))({focusUrl:s.pureCompute(n._computeFocusUrl),item:t.item,nonFoldersOnly:!0});n._action=u;return n}t.prototype.onIsAvailable=function(){var e=this._item();return e&&!e.external&&!!e.audio&&this._action.isAvailable()};t.prototype.onExecute=function(e,t){return this._action.execute(e)};t.prototype._computeFocusUrl=function(){var e=this._item();return!(e&&e.queryType===s.default.Recent)};return t}(i.default);t.default=u});
define("odsp-next/actions/odc/PlaySlideShowAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/ControlResourceKeys","../../base/BaseAction","../base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="PlaySlideShow";r._slideshowState=r.resources.consume(s.slideshowState);r._itemSelectionHelper=new(r.child(u.typeResourceKey))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!(!e||!e.photo||this._slideshowState.isSlideShowModeEnabled())};t.prototype.onExecute=function(e,t){this._slideshowState.isSlideShowModeEnabled(!0);return this._slideshowState.enterSlideshowMode()?r.default.resolve({resultType:i.ResultTypeEnum.Success}):r.default.resolve({resultType:i.ResultTypeEnum.Failure})};return t}(o.default);t.default=a});
define("odsp-next/actions/odc/StopSlideShowAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/ControlResourceKeys","../../base/BaseAction","../base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="StopSlideShow";r._slideshowState=r.resources.consume(s.slideshowState);r._itemSelectionHelper=new(r.child(u.typeResourceKey))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){return!!this._itemSelectionHelper.firstItem()&&this._slideshowState.isSlideShowModeEnabled()};t.prototype.onExecute=function(e,t){return this._slideshowState&&this._slideshowState.exitSlideshowMode()?r.default.resolve({resultType:i.ResultTypeEnum.Success}):r.default.resolve({resultType:i.ResultTypeEnum.Failure})};return t}(o.default);t.default=a});
define("odsp-next/actions/odc/RemoveCoverPhotoAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../base/ItemRedeemer","../../dataSources/url/QueryType","../base/ItemCommandHelper","../../base/BaseAction","../../providers/item/ItemProvider","../base/ItemSelectionHelper","../../models/item/command/CustomizationItemCommandKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="RemoveCoverPhotoAction";r._itemReedemer=new(r.managed(s.default));r._itemCommandHelper=new(r.managed(u.default));r._itemSelectionHelper=new(r.child(l.typeResourceKey))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this;return this._itemSelectionHelper.currentItem().queryType!==o.default.SharedWithMe&&this._itemSelectionHelper.filterItems(function(t){return e._itemCommandHelper.isCommandSupported(t,c.removeAsCoverPhoto)})};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var e,t=this;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:return(e=n.sent()).length?[2,this._itemReedemer.redeemItems(e,this).then(function(){var n=t.resources.consume(f.resourceKey),r=e[0].parent;return n.removeCoverPhotos({items:e,target:r}).then(function(){return{resultType:i.ResultTypeEnum.Success}})})]:[2,r.default.resolve({resultCode:"EmptySelection",resultType:i.ResultTypeEnum.Failure})]}})})};return t}(a.default);t.default=h});
define("odsp-next/actions/RemoveFromRecentAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../dataSources/url/QueryType","../providers/mruRecent/MruRecentProvider","./base/ItemSelectionHelper","../resources/DataSourceResourceKeys","../utilities/features/Features","./base/ItemCommandHelper","../models/item/command/CustomizationItemCommandKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="RemoveFromRecent";r._urlDataSource=r.resources.consume(a.url);r._itemCommandHelper=new(r.managed(l.default));r._itemSelectionHelper=new(r.child(u.typeResourceKey))({allowMultiSelect:!f.isFeatureEnabled(f.MruToMruPlusPlusSkyApi),canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._urlDataSource.getKeyParams(this._itemSelectionHelper.currentItem().key),t=this._urlDataSource.getQueryType(e),n=this._itemSelectionHelper.firstItem();return t===s.default.Recent&&!!n&&this._itemCommandHelper.isCommandSupported(n,c.removeFromRecent)};t.prototype.onExecute=function(e,t){var n=this,r=this._itemSelectionHelper.currentItem.peek();return this._itemSelectionHelper.resolveSelection().then(function(e){n._itemSelectionHelper.clearSelection();return n.resources.consumeAsync(o.resourceKey).then(function(t){return t.removeFromRecent({parentKey:r.key,items:e})})}).then(function(){return{resultType:i.ResultTypeEnum.Success}})};return t}(r.default);t.default=h});
define("odsp-next/providers/mruRecent/MruRecentProvider",["require","exports","tslib","../item/ItemProvider","../../utilities/features/Features","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-microservice/lib/microService/helpers/PdfSupport","@ms/sp-resource-path","@ms/odsp-utilities/lib/list/SharingType","../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t)||this;r._dataSource=n.mruRecentDataSource;r._itemProvider=n.itemProvider;var i=n.location,s=void 0===i?window.location:i;r._origin=new a.SPResourcePath(s.href).authority;return r}t.prototype.changePinStatus=function(e){return this._dataSource.changePinStatus(e)};t.prototype.getTokenForMru=function(){return this._dataSource.getTokenForMru()};t.prototype.removeFromRecent=function(e){var t=this;return i.isFeatureEnabled(i.MruToMruPlusPlusSkyApi)?this._dataSource.removeRecentItem(e).then(function(n){t._itemProvider.invalidateItem(e.parentKey);return n}):this._itemProvider.removeFromRecent(e)};t.prototype.recordDocumentView=function(e){var t=e.graph,r=new a.SPResourcePath(e.openUrl),i=""+(r.authority||this._origin)+r.path,s=e.sharingType,o=e.dateCreatedTime,u=e.dateModifiedTime,l=e.mruState,c=e.properties,d=void 0===c?{}:c,v=d.editorName,m=void 0===v?[]:v,g=d.creatorName,y=void 0===g?[]:g,b=l&&l.mruId,w=m[0],E=y[0],S=n.__assign({category:"Document",type:"DocumentUrl",app:h(e),url:i},function(e){var t=e.name,n=e.extension,r=n&&n.replace(/^\.+/,"");return{title:t&&(n?t.replace(RegExp("."+r+"$"),""):t),extension:r}}(e),{file_size:e.size},b?{mru_id:b}:{onedrive_info:t&&{drive_id:t.driveId,item_id:t.itemId,parent_reference_id:e.parent&&e.parent.graph&&e.parent.graph.itemId,drive_type:t.driveType},resource_id:e.itemId},{sharing_info:{state:"number"==typeof s&&s<f.default.Private?1:0},modification_info:p(w,u),creation_info:p(E,o)});return this._dataSource.recordDocumentView(e,S)};t.dependencies=n.__assign({},s.default.dependencies,{itemProvider:r.resourceKey,mruRecentDataSource:l.mruRecent});return t}(s.default);t.default=c;function h(e){return u.canRenderNative(e.extension)?"PdfViewer":e.audio||e.image360||e.photo||e.video?"Media":"OtherNonOffice"}function p(e,t){if(e&&t)return{timestamp:t.toISOString(),user_info:{upn:e.sip||e.email,display_name:e.title}}}t.resourceKey=o.createResolvedResourceKey(e("module").id,c)});
define("@ms/odsp-microservice/lib/microService/helpers/PdfSupport",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["ai","pdf"],r=["doc","docx","odt","rtf","ods","xls","xlsm","xlsx","odp","ppt","pptx","pps","ppsx","tiff","tif","epub","htm","html","eml","msg","md","markdown"],i=["dwg","dxf"];function s(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}t.canConvert=function(e,t){return s(r,e)||!!t&&s(i,e)};t.canRenderNative=function(e){return s(n,e)}});
define("odsp-next/actions/odc/RemoveTagAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../base/ItemRedeemer","../base/ItemCommandHelper","../../resources/ControlResourceKeys","../../base/BaseAction","../../resources/ProviderResourceKeys","../../models/item/command/PhotoItemCommandKeys","../base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="RemoveTag";r._tag=t.tag;r._itemReedemer=new(r.managed(s.default));r._itemCommandHelper=new(r.managed(o.default));r._itemSet=r.resources.consume(u.currentItemSet);r._tagProvider=r.resources.consume(f.tag);r._itemSelectionHelper=new(r.child(c.typeResourceKey))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this;return this._itemSelectionHelper.filterItems(function(t){return e._itemCommandHelper.isCommandSupported(t,l.removeTags)})};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var e,t=this;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:return(e=n.sent()).length?[2,this._itemReedemer.redeemItems(e,this).then(function(){var n=t._tag.peek(),r=t.resources.consume(f.photo).getAllPhotosSettings().peek();return t._tagProvider.updateTags({items:e,tagsToAdd:null,tagsToDelete:[n],parentKey:t._itemSet.peek().key,rootItemId:r.rootId}).then(function(){return{resultType:i.ResultTypeEnum.Success}})})]:[2,r.default.resolve({resultCode:"EmptySelection",resultType:i.ResultTypeEnum.Failure})]}})})};return t}(a.default);t.default=h});
define("odsp-next/actions/rename/odc/RenameAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../models/item/command/FileSystemItemCommandKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){n.__extends(i,t);function i(e){var n=t.call(this,e)||this;n.name="Rename";return n}i.prototype.getExecutorPath=function(){return"odsp-next/actions/rename/odc/RenameExecutor"};i.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/rename/odc/RenameExecutor"],t,n)})}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};i.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}};i.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&this.itemCommandHelper.isCommandSupported(e,s.rename)};return i}(i.default);t.default=o});
define("odsp-next/actions/restore/RestoreAction",["require","exports","tslib","../../base/BaseAction","../base/ItemSelectionHelper","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/Promise","../base/ItemCommandHelper","../../resources/DataSourceResourceKeys","../../models/item/command/FileSystemItemCommandKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.restoreItemsOperatorTypeResourceKey=new l.ResourceKey({name:e("module").id+".restoreItemsOperator",loader:new l.AliasResourceLoader(function(){return o.default.resolve(new Promise(function(t,n){e(["./RestoreItemsOperator"],t,n)})).then(function(e){return e.typeResourceKey})})});var c=function(e){n.__extends(r,e);function r(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(a.url);n._itemSelectionHelper=new(n.child(i.typeResourceKey))({allowMultiSelect:!0,overrideItem:t.item});n._itemCommandHelper=new(n.managed(u.default));return n}r.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(!e)return!1;var t=this._itemSelectionHelper.currentItem(),n=this._urlDataSource.getKeyParams(t.key);return!!this._urlDataSource.isRecycleBin(this._urlDataSource.getQueryType(n))&&this._itemCommandHelper.isCommandSupported(e,f.restoreItem)};r.prototype.onExecute=function(e){var n=this,r=this._itemSelectionHelper.currentItem.peek().key;return this._itemSelectionHelper.resolveSelection().then(function(e){return n.resources.consumeAsync(t.restoreItemsOperatorTypeResourceKey).then(function(t){var i=new t({parentKey:r,items:e});n.trackPromise(i.start());return i.wait()})}).then(function(){return{resultType:s.ResultTypeEnum.Success}})};return r}(r.default);t.RestoreAction=c;t.default=c});
define("odsp-next/actions/restoreAll/odc/RestoreAllAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../base/ItemCommandHelper","../../../models/item/command/FileSystemItemCommandKeys","../../../resources/ControlResourceKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){n.__extends(i,t);function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="RestoreAll";n._itemCommandHelper=new(n.managed(s.default));n._currentItem=n.resources.consume(u.currentItem);return n}i.prototype.getExecutorPath=function(){return"odsp-next/actions/restoreAll/odc/RestoreAllExecutor"};i.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/restoreAll/odc/RestoreAllExecutor"],t,n)})}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};i.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,currentItem:this._currentItem}};i.prototype.onIsAvailable=function(){var e=this.selectionHelper.selection&&this.selectionHelper.selection(),t=this._currentItem();return t&&t.childCount>0&&0===e.length&&this._itemCommandHelper.isCommandSupported(t,o.restoreAllItems)};return i}(i.default);t.default=a});
define("odsp-next/actions/rotate/RotateAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../base/ItemSelectionHelper","../base/ItemCommandHelper","../base/ItemRedeemer","../../models/item/command/PhotoItemCommandKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/base/Rotation","../../resources/DataSourceResourceKeys","../../models/itemsScope/ItemsScopeFeature.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.rotateItemsOperatorTypeResourceKey=new l.ResourceKey({name:e("module").id,loader:new l.AliasResourceLoader(function(){return f.default.resolve(new Promise(function(t,n){e(["./RotateItemsOperator"],t,n)})).then(function(e){return e.typeResourceKey})})});var d=function(e){n.__extends(r,e);function r(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._itemSelectionHelper=new(n.child(s.typeResourceKey))({allowMultiSelect:!0,overrideItem:t.item});n._itemCommandHelper=new(n.managed(o.default));n._itemRedeemer=new(n.managed(u.default));return n}r.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return this._itemCommandHelper.isCommandSupported(e,a.rotate)};r.prototype.onExecute=function(e){var n=this,r=this._itemSelectionHelper.currentItem.peek().key;return this._itemSelectionHelper.resolveSelection().then(function(e){return n._itemRedeemer.redeemItems(e,n).then(function(){return n.resources.consumeAsync(t.rotateItemsOperatorTypeResourceKey)}).then(function(t){n.resources.consume(p.isItemsScopeEnabledInAllPhotosPivotResourceKey)&&n.resources.consumeAsync(h.itemInvalidator).then(function(t){t.invalidPhotoSetAsUpdated(e)});var i=new t({items:e,parentKey:r,rotation:c.default.right});return n.trackPromise(i.start())})}).then(function(){return{resultType:i.ResultTypeEnum.Success}})};return r}(r.default);t.RotateAction=d;t.default=d});
define("@ms/odsp-shared/lib/base/Rotation",["require","exports","tslib","@ms/utilities-image/lib/Rotation","@ms/utilities-image/lib/Rotation"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);t.default=i.default});
define("@ms/utilities-image/lib/Rotation",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.none=0]="none";e[e.right=1]="right";e[e.flip=2]="flip";e[e.left=3]="left"}(n=t.Rotation||(t.Rotation={}));t.default=n});
define("odsp-next/models/itemsScope/ItemsScopeFeature.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../utilities/features/Features","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.isItemsScopeEnabledResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabled",factory:{dependencies:{},create:function(e){return{instance:r.isOneDrive?r.isFeatureEnabled(r.UseItemsScopeInOneDrive)||r.isFeatureEnabled(r.UseItemsScopeInSitesForODB):r.isFeatureEnabled(r.UseItemsScopeInTeamSites)}}}});t.isItemsScopeEnabledInFilesPivotResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInFilesPivot",factory:{dependencies:{},create:function(){return{instance:r.isOneDrive?r.isFeatureEnabled(r.UseItemsScopeInOneDrive):r.isFeatureEnabled(r.UseItemsScopeInTeamSites)}}}});t.isItemsScopeEnabledInRecentPivotResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInRecentPivot",factory:{dependencies:{},create:function(){return{instance:r.isFeatureEnabled(r.UseItemsScopeInRecent)}}}});t.isItemsScopeEnabledInSharedPivotResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInSharedPivot",factory:{dependencies:{},create:function(){return{instance:r.isFeatureEnabled(r.UseItemsScopeInShared)}}}});t.isItemsScopeEnabledInCrossSitePivotsResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeEnabledInCrossSitePivots",factory:{dependencies:{},create:function(){return{instance:!!r.isOneDrive&&r.isFeatureEnabled(r.UseItemsScopeInSitesForODB)}}}});t.isItemsScopeEnabledInAllPhotosPivotResourceKey=new n.ResourceKey({name:e("module").id+".isItemsScopeInAllPhotosEnabled",factory:{dependencies:{platformDetection:i.platformDetection},create:function(e){return{instance:r.isFeatureEnabled(r.UseItemsScopeInAllPhotos)&&(!e.platformDetection.isIE||r.isFeatureEnabled(r.UseItemsScopeInAllPhotosEnableIE))}}}})});
define("odsp-next/actions/odc/SaveSortOrderAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/ControlResourceKeys","../sort/SortAction","../../dataSources/item/odc/SortFieldMap","../../dataSources/item/odc/SortDirectionMap","../../dataSources/url/QueryType","../../providers/item/ItemProvider"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="SaveSort";n._item=n.resources.consume(o.currentItem);n._currentItemSet=n.resources.consume(o.currentItemSet);return n}t.prototype.onExecute=function(e,t){var n=u.default.getSortedColumn(this._currentItemSet().schema);if(!n)return i.default.wrapError({resultType:s.ResultTypeEnum.Failure});var r=n.isAscending,o=a.default[n.internalName||n.key].toString(),l=null===r?f.default.defaultValue.toString():r?f.default.ascending.toString():f.default.descending.toString();return this.resources.consume(c.resourceKey).saveSortOrder({sortOrder:o,sortDirection:l,item:this._item()}).then(function(){return{resultType:s.ResultTypeEnum.Success}})};t.prototype.onIsAvailable=function(){var e=this._item(),t=e&&e.displayType;return!(e&&e.vault&&e.vault.isLocked)&&(t===l.default.Files||t===l.default.Photos)};return t}(r.default);t.default=h});
define("odsp-next/actions/SetFocusAction",["require","exports","tslib","../base/BaseItemAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/domUtils/DomUtils","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="SetFocus";n._selector=t.selector;n._shouldClick=t.shouldClick;return n}t.prototype.onExecute=function(e,t){var n=document.querySelector(this._selector);if(n){n.focus();this._shouldClick&&s.default.clickElement(n)}return i.default.wrap({resultType:o.ResultTypeEnum.Success})};return t}(r.default);t.default=u});
define("odsp-next/actions/shareByLink/odc/ShareByLinkAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../resources/DataSourceResourceKeys","../../base/templates/ExecutorAction","../../../dataSources/url/QueryType","../../../models/item/command/SocialItemCommandKeys","../../base/ItemCommandHelper"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(t){n.__extends(s,t);function s(e){var n=t.call(this,e)||this;n.sharingMethod=e&&e.sharingMethod?e.sharingMethod:null;n._alreadyRedeemed=e&&e.alreadyRedeemed?e.alreadyRedeemed:null;n.name="ShareByLink";n._urlDataSource=n.resources.consume(i.url);n._itemCommandHelper=new(n.managed(a.default));return n}s.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();if(!e)return!1;var t=this.selectionHelper.selection().length,n=t>1&&e.queryType===o.default.SharedWithMe&&e.isRootFolder,r=t>1&&e.isAlbum,i=this._urlDataSource.isRecycleBin(e.queryType);return(this._itemCommandHelper.isCommandSupported(e,u.share)||e.vault)&&!n&&!r&&!i&&this._allItemsSupportShare()};s.prototype.getExecutorPath=function(){return"odsp-next/actions/shareByLink/odc/ShareByLinkExecutor"};s.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/shareByLink/odc/ShareByLinkExecutor"],t,n)})}};s.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}};s.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,startState:this._startState,alreadyRedeemed:this._alreadyRedeemed,sharingMethod:this.sharingMethod}};s.prototype._allItemsSupportShare=function(){var e=this.selectionHelper.selection();if(!e.length)return!1;for(var t=0,n=e;t<n.length;t++){var r=n[t];if(r){var i=r();if(!i)return!0;if(!this._itemCommandHelper.isCommandSupported(i,u.share)&&(!i.vault||i.vault.isLocked))return!1}}return!0};return s}(s.default);t.default=f});
define("odsp-next/actions/showKeyboardMap/ShowKeyboardMapAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","../base/ExecutorLoader"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){n.__extends(r,t);function r(n){var r=t.call(this,n)||this;r.name="ShowKeymap";r._executorLoader=new(r.managed(s.default))({path:"odsp-next/actions/showKeyboardMap/ShowKeyboardMapExecutor",getModule:function(){return new i.default(function(t,n){e(["odsp-next/actions/showKeyboardMap/ShowKeyboardMapExecutor"],t,n)})},getExecutorParams:function(){return{}}});return r}r.prototype.onIsAvailable=function(){return!0};r.prototype.onExecute=function(e){return this._executorLoader.execute(e)};return r}(r.default);t.default=o});
define("odsp-next/actions/showOperations/ShowOperationsAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../base/ControlExecutorAction","../../providers/operation/OperationProvider","../../models/operation/OperationState"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._operationProvider=n.resources.consume(o.resourceKey);n.state=n.createPureComputed(n._computeState);return n}t.prototype._computeState=function(){return{isAvailable:this._operationProvider.overall.state()!==u.default.expired,isToggled:this._operationProvider.isLocked()}};return t}(i.default);t.ShowOperationsHandler=a;var f=s.create({name:"ShowOperations",source:{moduleDefinition:{path:"./ShowOperationsExecutor",getModule:function(){return new r.default(function(t,n){e(["./ShowOperationsExecutor"],t,n)})}}},handlerType:a});t.default=f});
define("odsp-next/actions/base/ControlExecutorAction",["require","exports","tslib","../../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../base/ControlExecutorLoader"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.name,i=t.source,o=t.handlerType,u=t.actionParams,a=t.useToggleBehavior,f=void 0!==a&&a;n.name=r;var l=o?new(n.managed(o))(u):void 0,c=l&&l.state||n.createObservable({isAvailable:!0}),h=l&&l.getParams?function(){return l.getParams()}:function(){};n._controlExecutorLoader=new(n.managed(s.default))({source:i,state:c,useToggleBehavior:f,getParams:h});return n}t.prototype.onIsAvailable=function(){return this._controlExecutorLoader.isAvailable()};t.prototype.onIsToggled=function(){return this._controlExecutorLoader.isToggled()};t.prototype.onExecute=function(e){return this._controlExecutorLoader.execute(e).then(function(){return{resultType:i.ResultTypeEnum.Success}})};return t}(r.default);t.ControlExecutorAction=o;t.create=function(e){var t=e.name,r=e.source,i=e.useToggleBehavior,s=e.handlerType;return function(e){n.__extends(o,e);function o(n){return e.call(this,{name:t,source:r,useToggleBehavior:i,actionParams:n,handlerType:s})||this}return o}(o)}});
define("odsp-next/actions/base/ControlExecutorLoader",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/modules/Modules","../../providers/hiddenDom/HiddenDomProvider"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=t.state,s=t.source,a=t.useToggleBehavior,f=t.getParams;if(function(e){return!!e.moduleDefinition}(s)){var l=s.moduleDefinition;n._getComponentDefinition=function(){return o.loadModule(l)}}else{var c=s.component;n._getComponentDefinition=function(){return i.default.wrap(c)}}n._useToggleBehavior=a;n._state=r;n._getParams=f;n._action=n.createObservable();n._hiddenDomProvider=n.resources.consume(u.resourceKey);n.isAvailable=n.createPureComputed(n._computeIsAvailable);n.isToggled=n.createPureComputed(n._computeIsToggled);return n}t.prototype.execute=function(e){var t,r=this;if(this._useToggleBehavior){var o=this._action.peek();if(o){o.cancel();return i.default.wrap()}}var u=new s.default,a={complete:function(){u.complete()},fail:function(e){u.error(e)},cancel:function(){u.cancel()}};this._useToggleBehavior&&this._action(a);return i.default.as(this._getParams()).then(function(i){return r._getComponentDefinition().then(function(s){t={name:s.tagName,params:n.__assign({action:a,event:e},i||{},{resources:r.resources})};r._hiddenDomProvider.requestControl(t);return u.getPromise()})}).then(function(){t&&r._hiddenDomProvider.disposeControl(t);r._action.peek()===a&&r._action(void 0)},function(e){t&&r._hiddenDomProvider.disposeControl(t);r._action.peek()===a&&r._action(void 0);return i.default.wrapError(e)})};t.prototype._computeIsAvailable=function(){return this._state().isAvailable};t.prototype._computeIsToggled=function(){var e=this._state().isToggled;return void 0!==e&&e||this._useToggleBehavior&&!!this._action()};return t}(r.default);t.default=a});
define("odsp-next/actions/showPermissions/ShowPermissionsAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../base/ControlExecutorAction","../base/ItemSelectionHelper","../../controls/infoPane/sections/sharing/SharingSection.css"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.state=n.createPureComputed(n._computeState);n._itemSelectionHelper=new(n.child(o.typeResourceKey))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});n.engagementSource=t.engagementSource;return n}t.prototype.getParams=function(){return{item:this._itemSelectionHelper.firstItem.peek(),engagementSource:this.engagementSource}};t.prototype._computeState=function(){return{isAvailable:!!this._itemSelectionHelper.firstItem()}};return t}(i.default);t.ShowPermissionsHandler=u;var a=s.create({name:"ShowPermissions",source:{moduleDefinition:{path:"./ShowPermissionsExecutor",getModule:function(){return new r.default(function(t,n){e(["./ShowPermissionsExecutor"],t,n)})}}},handlerType:u});t.default=a});
define("odsp-next/controls/infoPane/sections/sharing/SharingSection.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".InfoPane-sharing{margin-top:8px}.SharingSection-shareLink{line-height:26px;font-size:12px}html[dir=ltr] .SharingSection-shareLink{float:right}html[dir=rtl] .SharingSection-shareLink{float:left}.SharingSection-entity{padding:8px 0;font-size:12px}.SharingSection-entity .ms-Persona{white-space:nowrap}.SharingSection-entity .ms-Persona .ms-Persona-details{display:inline-block;max-width:170px;padding:0}.SharingSection-addPeople{font-size:17px;font-weight:300;min-height:50px;margin-top:10px}.SharingSection-addPeople-icon{display:inline-block;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:20px;border-radius:50%;width:50px;height:50px}[dir=ltr] .SharingSection-addPeople-icon{margin-right:10px}[dir=rtl] .SharingSection-addPeople-icon{margin-left:10px}.SharingSection-addPeople-icon .ms-Icon--PeopleAdd{position:relative;top:12px}[dir=ltr] .SharingSection-addPeople-icon .ms-Icon--PeopleAdd{left:15px}[dir=rtl] .SharingSection-addPeople-icon .ms-Icon--PeopleAdd{right:15px}.SharingSection-addPeople-text{display:inline-block;vertical-align:top;line-height:50px}.SharingSection-linksBox a{display:inline-block;margin-top:5px}.SharingSection-link,.od-PermissionsPanel-link{padding-top:8px}.od-alert{display:none}.od-alert.od-PermissionsPanel-alert{display:block}div.ms-ContextualMenu.is-open{z-index:299}.od-PermissionsPanel{height:100%;overflow-y:auto;overflow-x:hidden}.od-PermissionsPanel .od-SharingLink-linkSwitcher{font-size:12px}.od-PermissionPile-FacePile{display:inline-block;margin:0;padding:0}.od-PermissionsPanel-shareLink{line-height:26px;font-size:12px}html[dir=ltr] .od-PermissionsPanel-shareLink{float:right}html[dir=rtl] .od-PermissionsPanel-shareLink{float:left}.od-PermissionsPanel-stopSharing{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:15px;background:0 0;border:none;padding:0;cursor:pointer}.od-PermissionsPanel-stopSharing:focus,.od-PermissionsPanel-stopSharing:hover{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}@media screen and (-ms-high-contrast:active){.od-PermissionsPanel-stopSharing a:focus{border:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){.od-PermissionsPanel-stopSharing a:focus{border:1px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}.od-PermissionsPanel-entity{padding:8px 0;font-size:12px}.od-PermissionsPanel-entity .od-Persona{white-space:nowrap}.od-PermissionsPanel-entity .od-Persona .od-Persona-details{display:inline-block;max-width:200px;padding:0}.od-PermissionsPanel-addPeople{font-size:17px;font-weight:300;min-height:50px;padding-bottom:10px}.od-PermissionsPanel-addPeople-icon{display:inline-block;background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";font-size:20px;border-radius:50%;width:50px;height:50px}[dir=ltr] .od-PermissionsPanel-addPeople-icon{margin-right:10px}[dir=rtl] .od-PermissionsPanel-addPeople-icon{margin-left:10px}.od-PermissionsPanel-addPeople-icon .ms-Icon--PeopleAdd{position:relative;top:12px}[dir=ltr] .od-PermissionsPanel-addPeople-icon .ms-Icon--PeopleAdd{left:15px}[dir=rtl] .od-PermissionsPanel-addPeople-icon .ms-Icon--PeopleAdd{right:15px}.od-PermissionsPanel-addPeople-text{display:inline-block;vertical-align:top;line-height:50px}.od-PermissionsPanel-linksBox a{display:inline-block;margin-top:5px}.od-PermissionsPanel-link{padding-top:8px}.od-PermissionsPanel-container{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden}.od-PermissionsPanel-container-withCommandbar{top:40px}.od-PermissionsPanel-head{font-size:21px;font-weight:100}.isFluent .od-PermissionsPanel-head{font-size:20px;font-weight:600;margin-bottom:15px}.od-PermissionsPanel-fileName{font-size:14px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";overflow:hidden;text-overflow:ellipsis;white-space:nowrap;height:25px}[dir=ltr] .od-PermissionsPanel-fileName{padding-right:40px}[dir=rtl] .od-PermissionsPanel-fileName{padding-left:40px}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path{padding:3px;display:inline-block;vertical-align:middle}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element{display:inline;word-break:break-all}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element:after{display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";padding:0 5px;font-size:8px;font-weight:800;content:'\\E76C'}.od-PermissionsPanel-fileName .od-PermissionsPanel-Path .od-PermissionsPanel-Path-Element:last-child:after{content:'';display:none}html[dir=rtl] .od-PermissionsPanel-Path-Element:after{content:'\\E76B'}.od-PermissionsPanel-titleBar{padding-top:15px;padding-bottom:10px;border-bottom:solid 1px "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}[dir=ltr] .od-PermissionsPanel-titleBar{padding-left:40px}[dir=rtl] .od-PermissionsPanel-titleBar{padding-right:40px}.od-PermissionsPanel-content{padding-top:15px;width:300px;height:calc(100% - 110px)}[dir=ltr] .od-PermissionsPanel-content{padding-left:40px}[dir=rtl] .od-PermissionsPanel-content{padding-right:40px}.od-PermissionsPanel-linksBox{padding-bottom:10px}.od-SharingSection-PermissionsPile{width:320px;padding:16px;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";box-sizing:border-box;margin-bottom:16px}.od-SharingSection-PermissionsPile .InfoPane-sectionHeader{padding-bottom:10px;cursor:default}.isFluent .od-SharingSection-PermissionsPile .InfoPane-sectionHeader{padding-bottom:0}.od-SharingSection-PermissionsPile-personas{margin-bottom:4px}.od-SharingSection-PermissionsPile-personas .od-Persona{display:inline-block;width:32px;height:32px;box-sizing:border-box;cursor:pointer;vertical-align:top}[dir=ltr] .od-SharingSection-PermissionsPile-personas .od-Persona{margin-right:4px}[dir=rtl] .od-SharingSection-PermissionsPile-personas .od-Persona{margin-left:4px}.od-SharingSection-PermissionsPile-personas .od-Persona.od-Persona--xs{border:1px solid transparent}.od-SharingSection-PermissionsPile-personas .od-Persona.od-Persona--xs .od-Persona-initials{font-size:15px}.od-SharingSection-PermissionsPile-personas .od-Persona-presence{box-sizing:border-box;border:1px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-SharingSection-PermissionsPile-personas .od-PersonaTile{outline:0}.od-focus--enabled .od-Persona--xs:focus{box-shadow:0 0 0 1px "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:" inset}.od-SharingSection-PermissionsPile-addFriend{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";height:100%;border-radius:50%;position:relative;font-size:17px}.od-SharingSection-PermissionsPile-numberText{font-size:10px;font-weight:600;padding-top:16px;text-align:center;pointer-events:none;color:"},{theme:"black",defaultValue:"#000000"},{rawString:";line-height:normal}.od-SharingSection-PermissionsPile-personaBorder{box-sizing:border-box}.od-SharingSection-PermissionsPile-personaBorder:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SharingSection-PermissionsPile-personaIcon{position:relative;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";height:100%;pointer-events:none;color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";border-radius:50%}.od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{position:absolute;top:4px;-ms-transform:translateX(-50%);transform:translateX(-50%);color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";font-size:12px;line-height:normal}[dir=ltr] .od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{left:50%}[dir=rtl] .od-SharingSection-PermissionsPile-personaIcon.od-SharingSection-PermissionsPile-personaIcon--many .ms-Icon{right:50%}.od-SharingSection-PermissionsPile-personaMore{position:relative;background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";height:100%}.od-SharingSection-PermissionsPile-moreNumber{position:absolute;font-size:10px;font-weight:600;top:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}[dir=ltr] .od-SharingSection-PermissionsPile-moreNumber{left:50%}[dir=rtl] .od-SharingSection-PermissionsPile-moreNumber{right:50%}.od-SharingSection-PermissionsPile-description{margin-bottom:4px;padding:2px}.od-SharingSection-PermissionsPile-description .ms-Icon{font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}.od-SharingSection-PermissionsPile-descriptionText{display:inline-block;font-size:11px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";vertical-align:top;padding:3px}.od-Persona .od-Persona--xs{display:inline-block}.od-SharingSection-PermissionsPile-personas .od-Persona .od-Persona-details{display:none}.od-ShowPermissions-commandBar{position:absolute;outline:0;margin:0;border:0;top:0;right:0;left:0;width:100%;padding:0;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}.od-ShowPermissions-commandBar .ms-CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.5s;padding:0}@media (prefers-reduced-motion:reduce){.od-ShowPermissions-commandBar .ms-CommandBar{animation:none}}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:inset 0 1px 0 0 "},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button i{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button:hover{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:none}.od-ShowPermissions-commandBar .ms-CommandBar .ms-OverflowSet-item:first-child button:focus{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:0 0 0 1px "},{theme:"white",defaultValue:"#ffffff"},{rawString:" inset}.od-ShowPermissions-commandBar .CommandBar{animation-name:ms-fadeIn,ms-slideDownIn20;animation-duration:367ms;animation-timing-function:cubic-bezier(.1,.9,.2,1);animation-fill-mode:both;animation-delay:.5s}@media (prefers-reduced-motion:reduce){.od-ShowPermissions-commandBar .CommandBar{animation:none}}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:hover{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";box-shadow:inset 0 1px 0 0 "},{theme:"themeSecondary",defaultValue:"#2b88d8"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-icon .od-IconGlyph{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-commandText{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child .CommandBarItem-linkWrapper{padding-left:12px;padding-right:12px}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";box-shadow:none}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-icon{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:hover .CommandBarItem-commandText{color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:focus{background-color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.od-ShowPermissions-commandBar .CommandBar .CommandBarItem:first-child:focus .CommandBarItem-link:before{border:1px solid "},{theme:"themeDarker",defaultValue:"#004578"},{rawString:";margin:2px -8px}"}])});
define("odsp-next/actions/showSuggestedFiles/ShowSuggestedFilesAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../base/ControlExecutorAction","./ShowSuggestedFilesExecutor.css"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.state=n.createPureComputed(n._computeState);return n}t.prototype._computeState=function(){return{isAvailable:!0}};return t}(i.default);t.ShowSuggestedFilesHandler=o;var u=s.create({name:"ShowSuggestedFiles",source:{moduleDefinition:{path:"./ShowSuggestedFilesExecutor",getModule:function(){return new r.default(function(t,n){e(["./ShowSuggestedFilesExecutor"],t,n)})}}},handlerType:o});t.default=u});
define("odsp-next/actions/showSuggestedFiles/ShowSuggestedFilesExecutor.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-SuggestedFiles-titleBar{padding-bottom:8px}.od-SuggestedFiles-head{font-size:20px;font-weight:600}.od-SuggestedFiles-description{padding:4px 0 12px;font-size:14px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}"}])});
define("odsp-next/actions/ShowPropertiesAction",["require","exports","tslib","../base/BaseAction","../controls/detailsPane/IsDetailsPaneExpanded","../controls/filtersPane/IsFiltersPaneExpanded","@ms/odsp-utilities/lib/async/Promise","./base/ItemSelectionHelper","../resources/PagesResourceKeys","../resources/ControlResourceKeys","../resources/LoggingResourceKeys","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/events/EventGroup","../dataSources/url/QueryType"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="ShowProperties";var o=n.isInfoPaneExpanded,c=void 0===o?r.resources.consume(i.resourceKey):o,h=n.isSharingSectionExpanded,p=void 0===h?r.resources.consume(f.isSharingSectionExpanded.optional):h,d=n.isInfoPaneAvailable,v=void 0===d?r.resources.consume(a.base.infoPane.isInfoPaneAvailable.optional):d,m=n.isFiltersPaneExpanded,g=void 0===m?r.resources.consume(s.resourceKey):m,y=n.isColumnCustomizationPaneExpanded,b=void 0===y?r.resources.consume(a.base.columnCustomizationPane.isColumnCustomizationPaneExpanded.optional):y,w=n.rumOneHelper,E=void 0===w?r.resources.consume(l.rumOneHelper.optional):w,S=n.itemSelectionHelperType,x=void 0===S?r.resources.consume(u.typeResourceKey):S,T=t.useToggleBehavior,N=void 0!==T&&T,C=t.isSharingSectionExpanded,k=void 0!==C&&C,L=t.allowMultiSelect,A=void 0!==L&&L;r._isInfoPaneExpanded=c;r._isSharingSectionExpanded=p;r._isInfoPaneAvailable=v||r.observables.create(!0);r._isFiltersPaneExpanded=g;r._isColumnCustomizationPaneExpanded=b;r._rumOneHelper=E;r._useToggleBehavior=N;r._allowMultiSelect=A;r._shouldExpandSharingSection=k;r._itemSelectionHelper=new(r.scope.attached(x))({allowMultiSelect:r._allowMultiSelect,canFallback:!0,useCurrentSelectionGroup:!0});return r}t.prototype.onExecute=function(e){if(!this.isToggled.peek()){this._rumOneHelper&&this._rumOneHelper.logPropertiesPaneLaunch();this._isFiltersPaneExpanded&&this._isFiltersPaneExpanded(!1);this._isColumnCustomizationPaneExpanded&&this._isColumnCustomizationPaneExpanded(!1)}this._isSharingSectionExpanded&&this._isSharingSectionExpanded(this._shouldExpandSharingSection);this._isInfoPaneExpanded(!this._useToggleBehavior||!this._isInfoPaneExpanded.peek());h.default.raise(document.body,"resize",void 0,!0);return o.default.wrap({resultType:c.ResultTypeEnum.Success})};t.prototype.onIsAvailable=function(){if(!this._isInfoPaneAvailable())return!1;var e=this._itemSelectionHelper.firstItem;if(!e())return!1;var t=[e];this._allowMultiSelect&&(t=this._itemSelectionHelper.selection());for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i){var s=i();if(s&&(s.error||s.isPlaceholder&&s.queryType!==p.default.Search))return!1}}return!0};t.prototype.onIsToggled=function(){return this._isInfoPaneExpanded()};return t}(r.default);t.ShowPropertiesAction=d;t.default=d});
define("odsp-next/controls/detailsPane/IsDetailsPaneExpanded",["require","exports","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id+".isDetailsPaneExpanded",factory:{dependencies:{observablesFactoryType:n.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})});
define("odsp-next/controls/filtersPane/IsFiltersPaneExpanded",["require","exports","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id+".isFiltersPaneExpanded",factory:{dependencies:{observablesFactoryType:n.observablesFactoryTypeResourceKey},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})});
define("odsp-next/actions/ShowSelectionAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/DataSourceResourceKeys","../dataSources/url/PageType","../controls/list/react/SelectionManager","./base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="ShowSelection";r._urlDataSource=r.resources.consume(o.url);r._isSelectionModal=r.resources.consume(a.isSelectionModalResourceKey);r._itemSelectionHelper=new(r.child(f.typeResourceKey))({allowMultiSelect:!0,canFallback:!1});return r}t.prototype.onIsAvailable=function(){return(this._itemSelectionHelper.selection().length>0||this._isSelectionModal())&&this._urlDataSource.getPageType()!==u.default.TextFileEditor};t.prototype.onExecute=function(e,t){this._itemSelectionHelper.clearSelection();this._isSelectionModal(!1);return i.default.resolve({resultType:s.ResultTypeEnum.Success})};return t}(r.default);t.default=l});
define("odsp-next/controls/list/react/SelectionManager",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","office-ui-fabric-react/lib/utilities/selection/interfaces","office-ui-fabric-react/lib/utilities/selection/Selection","../../../models/store/ItemsStore","../../../resources/UtilityResourceKeys","../../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this,o=r.observables;r._selectionModel=n.itemSetSelectionModel;r._clientSideExtensionHelper=n.clientSideExtensionHelper;r._itemsStore=n.itemsStore;var u=r.selection=new s.Selection({selectionMode:1===r._selectionModel.mode?i.SelectionMode.single:i.SelectionMode.multiple,onSelectionChanged:r._onSelectionChange.bind(r),getKey:r.getKey.bind(r),canSelectItem:r._canSelectItem.bind(r)});r._isModal=o.create(!!u.isModal&&u.isModal());o.compute(r._computeUpdateItems);o.backgroundCompute(r._computeUpdateReactSelection);r.isModal=o.compute({read:function(){return r._isModal()},write:function(e){return u&&u.setModal(e)},pure:!0});return r}t.prototype.getKey=function(e,t){return e&&this._selectionModel.getItemKey(this._itemsStore.getItem(""+e.key))||""+t};t.prototype._computeUpdateReactSelection=function(){var e=this,t=this._selectionModel,n=this.selection,r=t.selection();this.observables.ignore(function(){if(e._shouldUpdateSelection())if(0===t.mode&&(t.isAllSelected()&&!n.isAllSelected()||0===t.selectedCount()&&n.isAllSelected()))n.setAllSelected(t.isAllSelected()&&!n.isAllSelected());else{n.setChangeEvents(!1);n.setAllSelected(!1);for(var i=0,s=r;i<s.length;i++){var o=s[i];n.setKeySelected(t.getItemKey(o),!0,!1)}n.setChangeEvents(!0)}})};t.prototype._shouldUpdateSelection=function(){var e=this._selectionModel,t=this.selection,n=!1;if(e.selectedCount()!==t.count||0===e.mode&&e.isAllSelected()!==t.isAllSelected())n=!0;else if(!t.isAllSelected()||1===e.mode)for(var r=0,i=e.selection();r<i.length;r++){var s=i[r];if(!t.isKeySelected(e.getItemKey(s))){n=!0;break}}return n};t.prototype._onSelectionChange=function(){var e=this;this.observables.ignore(function(){var t=e._selectionModel,n=e.selection;e._isModal(!!n.isModal&&n.isModal());if(e._shouldUpdateSelection()){if(n.mode===i.SelectionMode.multiple&&(!t.isAllSelected()&&n.isAllSelected()||t.isAllSelected()&&0===n.count))!t.isAllSelected()&&n.isAllSelected()?t.selectAll():t.clear();else{for(var r=[],s=0,o=n.getSelection();s<o.length;s++){var u=o[s],a=e.getKey(u);r.push(a)}t.setSelectedKeys(r)}var f=e._clientSideExtensionHelper;f&&f.raiseListChangeEvent(n.getSelection())}})};t.prototype._computeUpdateItems=function(){var e=this,t=this._selectionModel.itemSet(),n=[];if(t)for(var r=0,i=t.content().items;r<i.length;r++){var s=i[r],o=this.observables.peekUnwrap(s);o?n.push(o):n.push(void 0)}this.observables.ignore(function(){var r=t&&e.observables.peekUnwrap(t.item);(t&&!t.isPlaceholder||r&&r.isStub)&&e.selection.setItems(n,!1)})};t.prototype._canSelectItem=function(e){var t=this;return this.observables.ignore(function(){return t._selectionModel.canSelectItem(t._itemsStore.getItem(e.key))})};return t}(r.default);t.SelectionManager=l;t.selectionManagerResourceKey=new f.ResourceKey({name:e("module").id+".selectionManager",factory:new f.ResolvedResourceFactory(l,n.__assign({},r.default.dependencies,{itemSetSelectionModel:a.itemsSelection,clientSideExtensionHelper:u.clientSideExtensionHelper.optional,itemsStore:o.resourceKey}))});t.getKeyResourceKey=new f.ResourceKey({name:e("module").id+".getKey",factory:{dependencies:{selectionManager:t.selectionManagerResourceKey},create:function(e){var t=e.selectionManager;return{instance:function(e,n){return t.getKey(e,n)}}}}});t.selectionModeResourceKey=new f.ResourceKey({name:e("module").id+".selectionMode",factory:{dependencies:{itemSetSelectionModel:a.itemsSelection},create:function(e){return{instance:0===e.itemSetSelectionModel.mode?i.SelectionMode.multiple:i.SelectionMode.single}}}});t.isSelectionModalResourceKey=new f.ResourceKey({name:e("module").id+".getKey",factory:{dependencies:{selectionManager:t.selectionManagerResourceKey},create:function(e){return{instance:e.selectionManager.isModal}}}});t.resourceKey=new f.ResourceKey({name:e("module").id,factory:{dependencies:{selectionManager:t.selectionManagerResourceKey},create:function(e){return{instance:e.selectionManager.selection}}}});t.hasSelectionResourceKey=new f.ResourceKey({name:e("module").id+".hasSelection",factory:{dependencies:{itemSetSelectionModel:a.itemsSelection,isSelectionModal:t.isSelectionModalResourceKey,observablesFactoryType:r.observablesFactoryTypeResourceKey},create:function(e){var t=new e.observablesFactoryType,n=e.itemSetSelectionModel,r=e.isSelectionModal;return{instance:t.pureCompute(function(){return r()||n.selectedCount()>0}),disposable:t}}}})});
define("office-ui-fabric-react/lib/utilities/selection/interfaces",["require","exports","@uifabric/utilities"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SELECTION_CHANGE=n.SELECTION_CHANGE;t.SelectionDirection=n.SelectionDirection;t.SelectionMode=n.SelectionMode});
define("office-ui-fabric-react/lib/utilities/selection/Selection",["require","exports","@uifabric/utilities"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Selection=n.Selection});
define("odsp-next/actions/toggleListLayout/odc/ToggleListLayoutAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../base/BaseAction","../../../dataSources/url/QueryType","../../../controls/list/layouts/LayoutType","../../../resources/ControlResourceKeys","@ms/odsp-shared/lib/utilities/navigation/NavigationHelper","../ToggleListLayoutHelper","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/object/ObjectUtil","../../../models/itemsScope/ItemsScopeFeature.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="ToggleListLayout";n._layoutType=o.getValidLayout(t.layoutType);n._shouldClearContextualFilter=void 0===t.clearContextualFilter||t.clearContextualFilter;n._currentItem=n.resources.consume(u.currentItem);n._viewParams=n.resources.consume(u.viewParams);n._actionMap=n.resources.consume(u.actionMap);n._urlDataSource=n.resources.consume(l.url);n._helper=new(n.managed(f.default));return n}t.prototype.onIsAvailable=function(){var e=this.resources.consume(h.isItemsScopeEnabledInAllPhotosPivotResourceKey),t=this._currentItem(),n=t&&t.queryType,r=t.key!==this._urlDataSource.getRootItemKey(s.default.SharedWithMe)&&n!==s.default.DocsInCommon;e||(r=r&&n!==s.default.AllMyPhotos);var i=this._urlDataSource.getKeyParams(t.key),u=!0;this._layoutType===o.SingleAlbum&&(u=n===s.default.Files);e&&n===s.default.AllMyPhotos&&(u="allmyphotos"===i.qt&&!i.tagFilter&&!i.locationFilter&&!i.onThisDay);return r&&u};t.prototype.onExecute=function(e,t){var n,i=this;if(this._shouldClearContextualFilter){var s=c.extend({},this._viewParams.peek());delete s.ft;n=new(this.managed(this._actionMap.NavigationAction))({url:"#"+a.serializeQuery(s)}).execute(e)}else n=r.default.wrap();return n.then(function(){return i._helper.changeLayout(i._layoutType)},function(){return i._helper.changeLayout(i._layoutType)})};t.prototype.onIsToggled=function(){return this._layoutType===this._helper.pageLayoutType()};return t}(i.default);t.default=p});
define("odsp-next/controls/list/layouts/LayoutType",["require","exports","../../../utilities/features/Features"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r;t.Albums="ms-albums-list";t.AllPhotos=n.isFeatureEnabled(n.UseTilesListForAllPhotos)?"od-tiles-list":"ms-all-photos-list";t.FilteredPhotos="ms-filtered-photos-list";t.CustomGridList="ms-grid-customlist";t.CustomList="ms-details-customlist";t.Details="ms-details-list";t.CompactDetails="ms-compact-details-list";t.Grid=n.isFeatureEnabled(n.UseTilesList)?"od-tiles-list":"ms-grid-list";t.SingleAlbum="ms-single-album-list";t.TagGrid="od-tag-grid";t.TagsList="od-tags-list";t.DocumentCardsGrid="od-doccard-grid";t.SharedGrid="od-shared-grid-list";t.SitesGrid="od-sites-grid-list";t.Path=((r={})[t.Albums]="odsp-next/controls/list/AlbumsList",r[t.AllPhotos]=n.isFeatureEnabled(n.UseTilesListForAllPhotos)?"odsp-next/controls/list/TilesList":"odsp-next/controls/list/AllPhotosList",r[t.FilteredPhotos]="odsp-next/controls/list/FilteredPhotosList",r[t.CustomGridList]="odsp-next/controls/list/CustomGridList",r[t.CustomList]="odsp-next/controls/list/CustomList",r[t.Details]="odsp-next/controls/list/DetailsList",r[t.CompactDetails]="odsp-next/controls/list/CompactDetailsList",r[t.Grid]=n.isFeatureEnabled(n.UseTilesList)?"odsp-next/controls/list/TilesList":"odsp-next/controls/list/GridList",r[t.SingleAlbum]="odsp-next/controls/list/SingleAlbumList",r[t.TagGrid]="odsp-next/controls/list/TagGrid",r[t.TagsList]="odsp-next/controls/list/TagsList",r[t.DocumentCardsGrid]="odsp-next/controls/list/DocumentCardsGridList",r[t.SharedGrid]="odsp-next/controls/list/SharedGridList",r[t.SitesGrid]="odsp-next/controls/list/SitesGridList",r);t.getValidLayout=function(e,n){var r=n&&n.isCustomList,i=n&&n.isPlaceholder;switch(e){case t.Albums:return t.Albums;case t.AllPhotos:return t.AllPhotos;case t.FilteredPhotos:return t.FilteredPhotos;case t.CustomGridList:return i?e:r?t.CustomGridList:t.Grid;case t.CustomList:case t.Details:return i?e:r?t.CustomList:t.Details;case t.CompactDetails:return t.CompactDetails;case"ms-grid-list":case"od-tiles-list":case t.Grid:return i?e:r?t.CustomGridList:t.Grid;case t.SingleAlbum:return t.SingleAlbum;case t.TagGrid:return t.TagGrid;case t.TagsList:return t.TagsList;case t.DocumentCardsGrid:return t.DocumentCardsGrid;case t.SharedGrid:return t.SharedGrid;case t.SitesGrid:return t.SitesGrid;default:return r?t.CustomList:t.Details}}});
define("odsp-next/actions/toggleListLayout/ToggleListLayoutHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/modules/Modules","@ms/odsp-utilities/lib/logging/events/Qos.event","../../controls/list/layouts/LayoutType","../../resources/PagesResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/PromiseDebouncer","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e,t){var n=e.replace("odsp-next/controls/list","."),r=t.filter(function(e){return 0===e.indexOf(n)});return r.length>0?r[0]:n+".js"},h=function(t){n.__extends(s,t);function s(e,n){void 0===e&&(e={});var r=t.call(this,e,n)||this;r._pageLayoutType=n.pageLayoutType;r.layoutType=r._getLayoutType();r._debouncer=r.scope.attach(new f.default);return r}s.prototype._getLayoutType=function(){var t=this,n=this.observables,r=n.create("");n.backgroundCompute(function(){var n=t._pageLayoutType(),s=o.Path[n];t._debouncer.debounce(s?i.loadModule({path:s,getModule:function(){return new a.default(function(t,n){if("undefined"==typeof __webpack_public_path__)window.require([s],t,n);else{var r=e.context("odsp-next/controls/list",!0,/\.js$/);t(r(c(s,r.keys())))}})}}).then(function(e){return e.tagName}):a.default.wrap("")).then(function(e){r(e)})});return r};s.dependencies=n.__assign({},r.default.dependencies,{pageLayoutType:u.files.layoutType});return s}(r.default);t.LayoutTypeResolver=h;t.layoutTypeResolverKey=new l.ResourceKey({name:e("module").id+".layoutTypeResolver",factory:new l.ResolvedResourceFactory(h)});t.resolvedLayoutTypeResourceKey=new l.ResourceKey({name:e("module").id+".resolvedLayoutType",factory:{dependencies:{layoutTypeResolver:t.layoutTypeResolverKey},create:function(e){return{instance:e.layoutTypeResolver.layoutType}}}});var p=function(t){n.__extends(r,t);function r(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.pageLayoutType=n.resources.consume(u.files.layoutType);return n}r.prototype.changeLayout=function(t){var n=this,r=o.Path[t];return i.loadModule({path:r,getModule:function(){return new a.default(function(t,n){if("undefined"==typeof __webpack_public_path__)window.require([r],t,n);else{var i=e.context("odsp-next/controls/list",!0,/\.js$/);t(i(c(r,i.keys())))}})}}).then(function(e){n.pageLayoutType(e.tagName);return a.default.wrap({resultType:s.ResultTypeEnum.Success,extraData:{layout:t}})})};return r}(r.default);t.default=p});
define("odsp-next/actions/viewOriginal/ViewOriginalAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/BaseAction","../base/ItemCommandHelper","../base/ItemSelectionHelper","../NavigationAction","../../models/item/command/PhotoItemCommandKeys"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="ViewOriginal";n._itemCommandHelper=new(n.managed(s.default));n._selectionHelper=new(n.child(o.typeResourceKey))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});n._url=n.observables.pureCompute(function(){var e=n._selectionHelper.firstItem(),t=e&&e.photo&&e.photo.originalUrl;return t&&t.replace(/#/g,"%23")});n._navigationAction=new(n.managed(u.default))({url:n._url,target:"_blank"});return n}t.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();return!!e&&!!this._url()&&this._itemCommandHelper.isCommandSupported(e,a.viewOriginal)};t.prototype.onExecute=function(e,t){return this._url.peek()?this._navigationAction.execute(e):r.default.reject({})};return t}(i.default);t.default=f});
define("odsp-next/actions/odc/UploadAction",["require","exports","tslib","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","../../models/item/ItemType","../base/ItemRedeemer","../UploadAction"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.logStartEnd=!0;n.name="Upload."+r.UploadProcessorType[n.uploadProcessorType];n._itemRedeemer=new(n.managed(s.default));return n}t.prototype.onIsAvailable=function(){if(!this._isPlatformSupported())return!1;var t=this.item();return e.prototype.onIsAvailable.call(this)&&t.type===i.default.Folder};t.prototype.onExecute=function(t,n){var r=this,i=this.item.peek();return this._itemRedeemer.redeemItem(i,this).then(function(){return e.prototype.onExecute.call(r,t,n)})};t.prototype._isPlatformSupported=function(){var e=!1,t=this.platform.isIPad&&this.platform.browserMajor<6;if(this.platform.isWinAppWipEnabled)return!1;if(!t)switch(this.uploadProcessorType){case r.UploadProcessorType.Html5file:e=this.platform.isHtml5FileUploadSupported;break;case r.UploadProcessorType.Folder:e=this.platform.isFolderUploadSupported}return e};return t}(o.default);t.default=u});
define("odsp-next/actions/UploadAction",["require","exports","tslib","../base/BaseItemAction","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/async/Promise","../resources/ControlResourceKeys","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","@ms/odsp-utilities/lib/logging/events/Qos.event","../dataSources/url/QueryType","../providers/operator/UploadOperator.key","../providers/engagement/Engagement","@ms/odsp-shared/lib/base/ActionInputType","./base/ItemCommandHelper","../models/item/command/WebItemCommandKeys","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../utilities/killSwitch/KillSwitch"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="Upload";n.platform=n.resources.consume(v.platformDetection);n.uploadProcessorType=t.uploadProcessorType;n._onDemandInput=!m.default.isActivated("D3F3420F-5034-4DFC-AC04-D8B19BA8DB85","07/08/2018","Revert back to old file input method for the upload actions");if(n._onDemandInput){n._resetInputElement();n.addDisposable({dispose:function(){if(n._inputElement){document.body.removeChild(n._inputElement);n._inputElement=void 0}}})}else n.inputType=n.createObservable(n._getInputType(n.uploadProcessorType));n.itemCommandHelper=n.resources.consume(p.resourceKey);n.skipInvalidation=!1;return n}t.prototype.onExecute=function(e,t){this.resources.consume(c.resourceKey).logData({name:"Upload.TopMenu.Click",isIntentional:!0});if(!this._onDemandInput){var n=e.target;return this._uploadFiles(n)}var r=new i.default;this._clickHiddenInput(r);return r.getPromise()};t.prototype.onIsAvailable=function(){var e=!1,t=this.item();if(!this.itemCommandHelper.isCommandSupported(t,d.upload))return!1;switch(this.uploadProcessorType){case u.UploadProcessorType.Html5file:e=this.platform.isHtml5FileUploadSupported;break;case u.UploadProcessorType.Folder:e=this.platform.isFolderUploadSupported}return e&&!t.isPlaceholder&&t.queryType===f.default.Files};t.prototype._resetInputElement=function(){var e=this;this._inputElement&&document.body.removeChild(this._inputElement);var t=document.createElement("input");this._inputElement=t;t.style.display="none";t.type="file";var n="commandFileInput";if(this.uploadProcessorType===u.UploadProcessorType.Folder){n="commandFolderInput";t.webkitdirectory=!0}t.className=n;t.multiple=!0;t.onchange=function(n){e._uploadFiles(t).done(function(){e._resetInputElement()})};document.body.appendChild(t)};t.prototype._clickHiddenInput=function(e){var t=this,n=this._inputElement;n.onchange=function(r){t._uploadFiles(n).then(function(t){e.complete(t)},function(t){e.error(t)}).then(function(){t._resetInputElement()})};n.click()};t.prototype._uploadFiles=function(e){var t=this,n=Array.prototype.slice.call(e&&(e["test-files"]||e.files)||[]);if(n){var r=this.resources.consume(o.currentItemSet);return this.resources.consumeAsync(l.asyncTypeResourceKey).then(function(e){var i=new e({files:n,parentItem:t.item.peek(),wasDragAndDropped:!1,type:t.uploadProcessorType,itemSet:r.peek(),skipInvalidation:t.skipInvalidation,isTemplate:t.isTemplate});i.start();return i.wait()}).then(function(){return{resultType:a.ResultTypeEnum.Success}})}return s.default.wrap({resultType:a.ResultTypeEnum.ExpectedFailure})};t.prototype._getInputType=function(e){switch(e){case u.UploadProcessorType.Html5file:return h.default.htmlFileUpload;case u.UploadProcessorType.Folder:return h.default.folderUpload;default:return h.default.none}};return t}(r.default);t.default=g});
define("odsp-next/providers/operator/UploadOperator.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.asyncTypeResourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./UploadOperator"],t,n)}).then(function(e){return e.typeResourceKey})})})});
define("@ms/odsp-shared/lib/base/ActionInputType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.none=0]="none";e[e.htmlFileUpload=1]="htmlFileUpload";e[e.folderUpload=2]="folderUpload";e[e.downlevelUpload=3]="downlevelUpload";e[e.silverlightUpload=4]="silverlightUpload"}(n||(n={}));t.default=n});
define("odsp-next/actions/odc/UpdateCaptionAction",["require","exports","tslib","../UpdateCaptionAction","../base/ItemCommandHelper","../../models/item/command/PhotoItemCommandKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._itemCommandHelper=new(t.managed(i.default));return t}t.prototype.onIsAvailable=function(){return e.prototype.onIsAvailable.call(this)&&this._itemCommandHelper.isCommandSupported(this.item(),s.editCaption)};return t}(r.default);t.default=o});
define("odsp-next/actions/UpdateCaptionAction",["require","exports","tslib","../base/BaseItemAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../providers/item/ItemProvider"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="UpdateCaption";n.caption=t.caption;return n}t.prototype.onExecute=function(e,t){return this.resources.consume(s.resourceKey).updateItemProperty({item:this.item(),propertyName:"caption",propertyValue:this.caption(),overrideLock:!0}).then(function(){return{resultType:i.ResultTypeEnum.Success}})};return t}(r.default);t.default=o});
define("odsp-next/actions/odc/SurveyAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../base/BaseAction","../base/ItemSelectionHelper","../../utilities/icons/Icon","../NavigationAction","../base/ItemCommandHelper","../../resources/ODCResourceKeys","../../controls/sharing/shareSurvey/ShareSurvey","../../dataSources/url/odc/UrlDataSource","../../controls/sharing/shareSurvey/ShareSurvey.resx","../../models/item/command/OfficeItemCommandKeys","../../providers/dialog/DialogProvider"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="Survey";r._actionType=t.actionType;r._navigation=r.resources.consume(o.navigation);r._dialogProvider=r.resources.consume(g.resourceKey);r._itemCommandHelper=new(r.managed(c.default));r._urlDataSource=r.resources.consume(h.urlDataSource);r._itemSelectionHelper=new(r.child(a.typeResourceKey))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this,t=this._getCommandKey();return this._itemSelectionHelper.filterItems(function(n){return e._itemCommandHelper.isCommandSupported(n,t)})};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var t,o,u,a,f,c,h;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:if(!(t=n.sent()))return[2,r.default.resolve({resultCode:"EmptySelection",resultType:s.ResultTypeEnum.Failure})];if(1===this._actionType)return[2,this.showShareDialog(t)];o=this._navigation;u=this._urlDataSource.getAuthKeyParamValue();a=this._urlDataSource.getTicketParamValue();f=o.viewParams.qt;c=3===this._actionType?3:2;h=i.format("/edit.aspx?cid={0}&resid={1}&wacqt={2}&formAction={3}&app=Excel",d.default.viewerId,t,f||"",c);u?h+="&authKey="+u:a&&(h+="&ticket="+a);return[2,new(this.managed(l.default))({url:h,target:"_blank"}).execute(e)]}})})};t.prototype.showShareDialog=function(e){var t=i.format(v.strings.title,e.name);return this._dialogProvider.requestDialog({title:t,size:"Large",component:{name:p.default.tagName,params:{item:e,previewSrc:FilesConfig.imgBaseUrl+"images/embed_form.png"}},actions:[{name:v.strings.done,execute:function(){return r.default.resolve(2)},isAvailable:this.observables.create(!0),isVisible:this.observables.create(!0),icon:new f.default("Cancel")}]}).wait().then(function(){return{resultType:s.ResultTypeEnum.Success}})};t.prototype._getCommandKey=function(){switch(this._actionType){case 1:return m.publishSurvey;case 2:return m.viewSurvey;case 3:return m.editSurvey}};return t}(u.default);t.default=y});
define("odsp-next/controls/sharing/shareSurvey/ShareSurvey",["require","exports","./ShareSurveyViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ShareSurvey.html","./ShareSurvey.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-share-survey",template:e("./ShareSurvey.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/sharing/shareSurvey/ShareSurveyViewModel",["require","exports","tslib","knockout","../../../providers/sharing/SharingProvider","../../../bindings/focus/SelectOnFocusBinding","./ShareSurvey.resx","@ms/odsp-shared/lib/base/ViewModel","../../loadingSpinner/LoadingSpinner"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.loadingSpinnerTagName=a.default.tagName;n._item=t.item;n.previewSrc=t.previewSrc;n.isLoading=r.observable(!0);n.sharingLink=r.observable(null);n.hasError=r.observable(!1);n.instructionsText=o.strings.note;n.createText=o.strings.create;n.removeText=o.strings.remove;n.loadingText=o.strings.loading;n.errorText=o.strings.error;n._sharingProvider=n.resources.consume(i.resourceKey);n._getSharingInfo();n.addBindingHandlers({selectOnFocus:s.default});return n}t.prototype.onCreateClicked=function(){var e=this;this.isLoading(!0);this._sharingProvider.manageSharingLinks([this._item],{type:7,role:3,create:!0}).done(function(){e._getSharingInfo()},function(t){e.isLoading(!1);e.hasError(!0)})};t.prototype.onRemoveClicked=function(){var e=this;this.isLoading(!0);var t={id:this.sharingLink().id,type:7,role:5,create:!1};this._sharingProvider.manageSharingLinks([this._item],t).done(function(){e.isLoading(!1);e.sharingLink(null)},function(t){e.isLoading(!1);e.hasError(!0)})};t.prototype._getSharingInfo=function(){var e=this;this._sharingProvider.getSharingData(this._item).getLinks().then(function(t){e.isLoading(!1);if(t)for(var n=0,r=t;n<r.length;n++){var i=r[n];7===i.type&&e.sharingLink(i)}})};return t}(u.default);t.default=f});
define("odsp-next/providers/sharing/SharingProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../resources/DataSourceResourceKeys","../../resources/ProviderResourceKeys","../item/ItemProvider","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","./ShareItemHelper","./SharingData"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataSource=n.sharingDataSource;r._sharingDataDataSource=n.sharingDataDataSource;r._itemProvider=n.externallySharedItemProvider||n.itemProvider;r._shareDataCache={};r._shareItemHelper=n.shareItemHelper;return r}t.prototype.getSharingInformation=function(e,t,n){return this._dataSource.getSharingInformation(e,t,n)};t.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(n){if(n.link){t._invalidateCachedItem(e.items[0]);t._invalidateItem(e.items[0])}return n})};t.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(n){t._invalidateCachedItem(e.item);t._invalidateItem(e.item);return n})};t.prototype.updatePermissions2=function(e,t,n){var r=this;return this._dataSource.updatePermissions2(e,t,n).then(function(e){r._invalidateCachedItem(t);r._invalidateItem(t);return e})};t.prototype.updatePermissionsMultiple=function(e,t,n,r,i){var s=this;return this._dataSource.updatePermissionsMultiple(e,t,n,r,i).then(function(e){s._invalidateCachedItem(t);s._invalidateItem(t);return e})};t.prototype.supportsExistingAccessOption=function(e){return this._dataSource.supportsExistingAccessOption(e)};t.prototype.getClientId=function(){return this._dataSource.getClientId()};t.prototype.parseRawSharingInformation=function(e){return this._dataSource.parseRawSharingInformation(e)};t.prototype.emailWithoutPermissioning=function(e,t,n){return this._dataSource.emailWithoutPermissioning(e,t,n)};t.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t)};t.prototype.getSharingData=function(e,t){var n=this._shareDataCache[e.id],r=n&&n.data;if(!r||e.eTag!==n.eTag||t){r=this.scope.attach(new l.default({item:e},{dataSource:this._sharingDataDataSource}));this._shareDataCache[e.id]={eTag:e.eTag,data:r}}return r};t.prototype.share=function(e,t,n){var r=this;return this._shareItemHelper.share(e,t,n).then(function(e){r._invalidateCache();return e})};t.prototype.unshare=function(e){var t=this;return this._dataSource.unshare(e).then(function(n){t._invalidateCache();var r=t._itemProvider;if(r){r.invalidateItem(e.parent.key);r.invalidateItem(e.key)}return n})};t.prototype.updatePermissions=function(e,t,n,r){var i=this;return this._dataSource.updatePermissions(e,t,n,r).then(function(e){i._invalidateCache();i._itemProvider&&i._itemProvider.invalidateItem(t.parent.key);return e})};t.prototype.manageSharingLinks=function(e,t){var n=this;if(t&&t.link&&t.link.shareId&&!t.create){var r={item:e[0],kind:t.link.kind,shareId:t.link.shareId};return this._dataSource.unshareLink(r).then(function(e){n._invalidateCachedItem(r.item);n._invalidateItem(r.item);return[]})}var i=(e=e&&e.length?e:[]).map(function(e){return n.getSharingData(e)});return this._dataSource.manageSharingLinks(i,t).then(function(t){n._invalidateCache();var r=e[0]&&e[0].parent&&e[0].parent.key;r&&n._itemProvider.invalidateItem(r);return t})};t.prototype._invalidateCache=function(){this._shareDataCache={}};t.prototype._invalidateCachedItem=function(e){e&&e.id&&this._shareDataCache[e.id]&&(this._shareDataCache[e.id]=null)};t.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.parent&&e.parent.key&&this._itemProvider.invalidateItem(e.parent.key)};t.dependencies=n.__assign({},r.default.dependencies,{sharingDataSource:s.sharing,sharingDataDataSource:s.sharingData.optional,navigation:a.navigation,externallySharedItemProvider:o.externallySharedItem.optional,itemProvider:u.resourceKey.optional,shareItemHelper:f.resourceKey});return t}(r.default);t.default=c;t.resourceKey=i.createResolvedResourceKey(e("module").id,c)});
define("odsp-next/providers/sharing/ShareItemHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/async/Promise","../../resources/DataSourceResourceKeys","../item/ItemProvider","../operation/OperationProvider","../../models/operation/OperationError","../../models/operation/OperationType","../../models/operation/OperationState","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../controls/sharing/shareByEmail/Sharing.resx","../../resources/SPOResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._dataSource=n.sharingDataSource;r._itemProvider=n.itemProvider;r._operationProvider=n.operationProvider;r._navigation=n.navigation;r._urlDataSource=n.urlDataSource;r._sharingContextInformation=n.sharingContextInformation;return r}t.prototype.share=function(e,t,n){if(this._sharingContextInformation||n)return this._dataSource.share(e,t);var r=this._getShareOperation(t),i=this._dataSource.share(e,t);r.state(c.default.started);return i.then(this._onSuccess(t,r),this._onError(r))};t.prototype._getShareOperation=function(e){var t=this,n=this.observables,r=this._operationProvider.register({name:e.items[0].name,type:l.default.shareItem,payloads:{shareItem:{items:e.items}},iconName:e.items[0].iconName,actions:{hipCheck:{isAvailable:n.create(!1),execute:function(){t._navigation.navigateTo({url:t._urlDataSource.getHipCheckUrl(),frameId:"_blank"});r.state(c.default.expired);return s.default.wrap()}},verifyAccount:{isAvailable:n.create(!1),execute:function(){t._navigation.navigateTo({url:t._urlDataSource.getVerifyAccountUrl(),frameId:"_blank"});r.state(c.default.expired);return s.default.wrap()}}}});r.progress.maximum(1);r.progress.current(0);return r};t.prototype._onSuccess=function(e,t){var n=this;return function(r){e.items[0].parent&&n._itemProvider&&n._itemProvider.invalidateItem(e.items[0].parent.key);t.progress.current(1);r.statusCode>=0?t.state(c.default.completed):t.state(c.default.failed);var i=t.payloads.peek();i.shareItem.result=r.statusCode;t.payloads(i);return r}};t.prototype._onError=function(e){var t=this;return function(n){var r=e.payloads.peek();r.shareItem.result=n.statusCode||n.code;e.payloads(r);var i,o=n.code;if(3006===o&&t._urlDataSource.getHipCheckUrl()){e.actions.peek().hipCheck.isAvailable(!0);i=n&&n.message}else if(3009!==o&&3033!==o||!t._urlDataSource.getVerifyAccountUrl())3007!==o&&3034!==o&&3036!==o&&3037!==o&&1007!==o&&3035!==o||(i=n&&n.message);else{e.actions.peek().verifyAccount.isAvailable(!0);i=p.strings.VerifyAccount}i&&e.error(new f.default({message:i}));e.state(c.default.failed);return s.default.wrapError(n)}};t.dependencies=n.__assign({},r.default.dependencies,{sharingDataSource:o.sharing,itemProvider:u.resourceKey.optional,operationProvider:a.resourceKey,navigation:h.navigation,urlDataSource:o.url,sharingContextInformation:d.sharingContextInformation.optional});return t}(r.default);t.default=v;t.resourceKey=i.createResolvedResourceKey(e("module").id,v)});
define("odsp-next/resources/SPOResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.pageContext=new n.ResourceKey("pageContext");t.listContext=new n.ResourceKey("listContext");t.listItems=new n.ResourceKey("listItems");t.inplaceEditorUrl=new n.ResourceKey("inplaceEditorUrl");t.inplaceEditorClosing=new n.ResourceKey("inplaceEditorClosing");t.appViewChangeInProgress=new n.ResourceKey("appViewChangeInProgress");t.appViewErrorMessage=new n.ResourceKey("appViewChangeInProgress");t.itemsPerGroup=new n.ResourceKey("itemsPerGroup");t.loggingContext=new n.ResourceKey("loggingContext");t.loggingContextBuckets=new n.ResourceKey("loggingContextBuckets");t.contentTypes=new n.ResourceKey("provider.contentTypes");t.onePageContext=new n.ResourceKey("onePageContext");t.sharingContextInformation=new n.ResourceKey("sharingContextInformation");t.searchBehavior=new n.ResourceKey("searchBehavior");t.newDocumentTemplates=new n.ResourceKey("newDocumentTemplates")});
define("odsp-next/providers/sharing/SharingData",["require","exports","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.item=e.item;this._dataSource=t.dataSource}e.prototype.getSettings=function(){var e=this;if(!this._settingsPromise){this._settingsPromise=this._dataSource.getSettings(this);this._settingsPromise.done(null,function(t){if(n.default.isCanceled(t)){e._settingsPromise=null;e._rawResponse=null}})}return this._settingsPromise};e.prototype.getPermissions=function(e){this._permissionsPromise&&!e||(this._permissionsPromise=this._dataSource.getPermissions(this));return this._permissionsPromise};e.prototype.cancelGetPermissionsPromise=function(){if(this._permissionsPromise){this._permissionsPromise.cancel();this._cleanCacheIfCancel()}};e.prototype.getLinks=function(){var e=this;this._linksPromise||(this._linksPromise=this._dataSource.getLinks(this).then(function(t){e._linksData=t;return t}));return this._linksPromise};e.prototype.cancelGetLinksPromise=function(){if(this._linksPromise){this._linksPromise.cancel();this._cleanCacheIfCancel()}};e.prototype.getBestSharingLink=function(e){return this._dataSource.getBestSharingLink(this,e)};e.prototype.setLink=function(e){var t=this._linksData;if(e&&t){var n=t.filter(function(t){return t&&t.role===e.role&&t.type===e.type});if(0===n.length)t.push(e);else{var r=n[0];r.url=e.url;r.expiration=e.expiration;r.isActive=e.isActive}}};e.prototype.doSharingScopesContainLinks=function(){return this._dataSource.doSharingScopesContainLinks()};e.prototype.getRawResponse=function(){var e=this;if(!this._rawResponse){this._rawResponse=this._dataSource.getRawResponse(this);this._rawResponse.done(null,function(t){n.default.isCanceled(t)&&(e._rawResponse=null)})}return this._rawResponse};e.prototype._cleanCacheIfCancel=function(){this._linksPromise=null;this._settingsPromise=null;this._permissionsPromise=null;this._rawResponse=null};return e}();t.default=r});
define("odsp-next/controls/loadingSpinner/LoadingSpinner",["require","exports","./LoadingSpinnerViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./LoadingSpinner.html","./LoadingSpinner.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-loadingSpinner",template:e("./LoadingSpinner.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/loadingSpinner/LoadingSpinnerViewModel",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/ViewModel","../../bindings/imageLoader/ImageLoaderBinding","./LoadingSpinner.resx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;t&&void 0!==t.loadingText?n.loadingText=t.loadingText:n.loadingText=o.strings.LoadingText;n.addBindingHandlers({imageLoader:s.default});n.isVisible=r.observable(!0);n.isImageLoaded=r.observable(!1);n.loadingImageUrl=window.require.toUrl("odsp-media/images/loading/loadingspinner.gif");return n}t.prototype.hideSpinner=function(){this.isVisible(!1)};return t}(i.default);t.default=u});
define("odsp-next/bindings/imageLoader/ImageLoaderBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","../../utilities/images/ImageLoader","../../utilities/images/logging/ImageLoad.event","../../utilities/images/ImageLoadType","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/PromiseDebouncer"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t)||this;r._debouncer=new a.default;r._imageLoader=r.resources.consume(i.resourceKey);var s=r.valueAccessor(),o=s.src,u=s.image,f=s.error,l=s.isLoaded,c=s.isError,h=s.actualSize,p=s.scenarioName;r._src=r.wrapObservable(o);r._image=r.wrapObservable(u);r._error=r.wrapObservable(f);r._scenarioName=p;var d=n.outputExtenders,v=void 0===d?{deferred:!0}:d;r.createComputed(r._computeLoadImage);r.createBackgroundComputed(function(){var e=r._image();l&&l(!!e);if(h){var t=void 0;if(e){t={width:e.width,height:e.height}}h(t)}u&&u(e)}).extend(v);r.createBackgroundComputed(function(){var e=r._error();f&&f(e);c&&c(!!e)}).extend(v);return r}t.prototype._computeLoadImage=function(){var e,t=this,n=this.unwrapObservable(this._src);this._image(void 0);this._scenarioName&&(e=new s.default({name:this._scenarioName,loadType:o.default.queue}));this._debouncer.debounce(this.trackPromise(this._imageLoader.loadImage({url:n,imageElement:this.element,scenarioName:this._scenarioName}))).then(function(n){t._image(n);t._error(void 0);e&&e.end({resultType:u.ResultTypeEnum.Success})},function(n){t._error(n);e&&e.end({resultType:n.isExpected?u.ResultTypeEnum.ExpectedFailure:u.ResultTypeEnum.Failure})})};return t}(r.default);t.default=f});
define("odsp-next/utilities/images/ImageLoader",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/auth/DomainAuthenticator","@ms/odsp-utilities/lib/async/Semaphore","./logging/ImageLoad.event","./ImageLoadType","@ms/odsp-utilities/lib/logging/events/Qos.event","./ThumbnailCache","@ms/utilities-error/lib/ApiError"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=16,d=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._semaphore=new u.default(p);r._thumbnailCache=n.thumbnailCache;return r}t.prototype.loadImage=function(e){var t=this,n=e.url,r=e.imageElement,i=void 0===r?document.createElement("img"):r,s=e.scenarioName,u={url:n,width:0,height:0},a=this._thumbnailCache,f=function(){return o.default.authenticate(n).then(function(){return t._waitForImageLoad(i,n,s)}).then(function(e){a.record(u);if(i.complete&&!e)return t._waitForTimeout(300)}).then(function(){var e=i.naturalWidth||i.width,t=i.naturalHeight||i.height;return{url:n,width:e,height:t}})};return a.isLoaded(u)?f():this._semaphore.enqueue(f)};t.prototype._waitForImageLoad=function(e,t,n){var r,s,o,u=this.async,c=this.events,p=function(){o&&u.clearTimeout(o);c.off(e)},d=new i.default(function(){p();e.setAttribute("src","")}),v=t&&t.indexOf("&encodeFailures=1")>=0;c.onAll(e,{load:function(){p();if(v&&1===e.naturalWidth&&e.naturalHeight>6e4){var t=e.naturalHeight-6e4,n=406===t||412===t;s&&s.end({resultType:n?l.ResultTypeEnum.ExpectedFailure:l.ResultTypeEnum.Failure,resultCode:""+t,error:"Encoded failure"});d.error(new h.ApiError({code:""+t,isExpected:n,message:"Server returned encoded failure "+t}))}else{s&&s.end({resultType:l.ResultTypeEnum.Success});d.complete(r)}},error:function(){p();s&&s.end({resultType:l.ResultTypeEnum.Failure});d.error(new Error("Image '"+t+"' failed to load"))}});o=u.setTimeout(function(){d.cancel()},3e4);n&&(s=new a.default({name:n,loadType:f.default.server}));e.setAttribute("src",t);r=!!e.complete;return this.trackPromise(d.getPromise())};t.prototype._waitForTimeout=function(e){var t,n=this.async,r=new i.default(function(){t&&n.clearTimeout(t)});t=n.setTimeout(function(){r.complete()},e);return r.getPromise()};t.dependencies=n.__assign({},r.default.dependencies,{thumbnailCache:c.resourceKey});return t}(r.default);t.default=d;t.resourceKey=s.createResolvedResourceKey(e("module").id,d)});
define("odsp-next/utilities/images/logging/ImageLoad.event",["require","exports","@ms/odsp-utilities/lib/logging/PairedEventBase","@ms/odsp-utilities/lib/logging/events/Qos.event","../ImageLoadType","@ms/odsp-utilities/lib/logging/events/ResultTypeEnum"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ImageLoadType=i.ImageLoadType;t.ResultTypeEnum=s.ResultTypeEnum;t.ImageLoad=n.createPairedEvent({eventName:"ImageLoad,Qos,",shortEventName:"ImageLoad"},{loadType:{typeRef:i.ImageLoadType,type:6}},r.Qos);t.default=t.ImageLoad});
define("odsp-next/utilities/images/ImageLoadType",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n;!function(e){e[e.none=0]="none";e[e.queue=1]="queue";e[e.server=2]="server"}(n=t.ImageLoadType||(t.ImageLoadType={}));t.default=n});
define("odsp-next/utilities/images/ThumbnailCache",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=432e5,o=6e5,u=4,a=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r._recordsByThumbnailKey={};r._bucketsByImageKey={};var i=r.observables;r.lastAccessedDate=i.create(new Date);var s=n.pruneThumbnailsExtenders,u=void 0===s?{rateLimit:{timeout:o}}:s;i.backgroundCompute(r._pruneThumbnails).extend(u);return r}t.prototype.getCoveragePercent=function(e,t){var n=c(e),r=c(t);return Math.sqrt(r/n)};t.prototype.register=function(e,t,n,r){void 0===n&&(n=t);void 0===r&&(r=!0);var i=this.lastAccessedDate;i(new Date);var s=l(this.getCoveragePercent(e,n)),o=f(e),u=f(t),a=this._recordsByThumbnailKey,c=this._bucketsByImageKey,h=a[o]||{lastAccessed:void 0,buckets:{}};h.lastAccessed=i.peek();var p=h.buckets[s];if(!p||this.getCoveragePercent(p.size,n)>1){p&&delete c[p.key];p=h.buckets[s]={key:u,size:n,image:t,isLoaded:r,lastAccessed:i.peek()}}c[u]=p;a[o]=h};t.prototype.record=function(e){var t=this.lastAccessedDate;t(new Date);var n=f(e),r=this._bucketsByImageKey,i=r[n];i?i.isLoaded=!0:r[n]={key:n,size:e,image:e,isLoaded:!0,lastAccessed:t.peek()}};t.prototype.isLoaded=function(e){var t=this.lastAccessedDate;t(new Date);var n=f(e),r=this._bucketsByImageKey[n];r&&(r.lastAccessed=t.peek());return!!r&&r.isLoaded};t.prototype.retrieve=function(e,t,n){void 0===t&&(t=1);void 0===n&&(n=t);var r=f(e),i=this._recordsByThumbnailKey[r],s=this.lastAccessedDate;s(new Date);if(i){var o=i.buckets;i.lastAccessed=s.peek();var u=l(t),a=l(n),c=-1/0,h=!1;for(var p in o){var d=Number(p);if(d<=u&&d>=a&&o[d].isLoaded){c=Math.max(c,d);h=!0}}var v=h&&o[c];return v&&v.image}};t.prototype._pruneThumbnails=function(){var e=this.lastAccessedDate().getTime();h(this._recordsByThumbnailKey,e);h(this._bucketsByImageKey,e)};return t}(r.default);t.default=a;t.resourceKey=i.createResolvedResourceKey(e("module").id,a);function f(e){var t=e.url,n=e.width,r=e.height;return JSON.stringify({url:t,width:n,height:r})}function l(e){return Math.floor(Math.log(e)/Math.log(2)*u)}function c(e){return e.width*e.height}function h(e,t){for(var n=0,r=Object.keys(e);n<r.length;n++){var i=r[n];t-e[i].lastAccessed.getTime()>s&&delete e[i]}}});
define("odsp-next/controls/loadingSpinner/LoadingSpinner.html",[],function(){return'<div class=od-LoadingSpinner data-automationid=ms-loadingSpinner><img class=od-LoadingSpinner-loadingGif role=presentation data-bind="click: hideSpinner, visible: isVisible, imageLoader: { src: loadingImageUrl, isLoaded: isImageLoaded }"> <span class=od-LoadingSpinner-loadingText data-bind="text: loadingText"></span></div>'});
define("odsp-next/controls/loadingSpinner/LoadingSpinner.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-LoadingSpinner{white-space:nowrap}.od-LoadingSpinner-loadingText{vertical-align:top}.od-LoadingSpinner-loadingGif{vertical-align:bottom}"}])});
define("odsp-next/controls/sharing/shareSurvey/ShareSurvey.html",[],function(){return'<div class=ShareSurvey><div class=od-sharesurvey-preview><img data-bind="attr: {src: previewSrc}"></div><div class=od-sharesurvey-details>\x3c!--ko if: isLoading--\x3e<span class=ms-font-m data-bind="component: { name: loadingSpinnerTagName, params: { loadingText: loadingText } }"></span>\x3c!--/ko--\x3e\x3c!--ko if: !isLoading()--\x3e<span class=od-sharesurvey-instructions data-bind="text: instructionsText"></span>\x3c!--ko if: !sharingLink()--\x3e<button class="od-Button od-sharesurvey-create" data-bind="click: onCreateClicked"><span class=od-Button-label data-bind="text: createText"></span></button>\x3c!--/ko--\x3e\x3c!--ko if: sharingLink()--\x3e<input type=text class=od-sharesurvey-textbox readonly data-bind="attr: {value: sharingLink().url}, selectOnFocus: { isPermanent: true }"><br><button class=od-Button data-bind="click: onRemoveClicked"><span class=od-Button-label data-bind="text: removeText"></span></button>\x3c!--/ko--\x3e<br>\x3c!--ko if: hasError()--\x3e<span class=od-sharesurvey-error data-bind="text: errorText"></span>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div><div class=ms-clearfix></div></div>'});
define("odsp-next/controls/sharing/shareSurvey/ShareSurvey.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:"html[dir=ltr] .od-sharesurvey-preview{float:left}html[dir=rtl] .od-sharesurvey-preview{float:right}[dir=ltr] .od-sharesurvey-preview{margin-right:10px}[dir=rtl] .od-sharesurvey-preview{margin-left:10px}.od-sharesurvey-details{max-width:350px}html[dir=ltr] .od-sharesurvey-details{float:left}html[dir=rtl] .od-sharesurvey-details{float:right}.od-sharesurvey-create{margin-top:10px}.od-sharesurvey-textbox{padding:1px 5px 2px 10px;margin:10px 0;width:100%;box-sizing:border-box;text-overflow:ellipsis}html[dir=rtl] .od-sharesurvey-textbox{padding:1px 10px 2px 5px}.od-sharesurvey-error{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}"}])});
define("odsp-next/actions/odc/AddToSharedListAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../base/ItemRedeemer","../base/ItemCommandHelper","../../base/BaseAction","../../providers/item/ItemProvider","../../models/item/command/SocialItemCommandKeys","../base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="AddToSharedList";r._itemReedemer=new(r.managed(s.default));r._itemCommandHelper=new(r.managed(o.default));r._itemSelectionHelper=new(r.child(l.typeResourceKey))({allowMultiSelect:!1,canFallback:!0,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._itemCommandHelper.isCommandSupported(e,f.addToShared)};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var e,t=this;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(e=n.sent())?[2,this._itemReedemer.redeemItem(e,this,!0).then(function(){t.resources.consume(a.resourceKey).invalidateItem(e.key,{triggerFetch:!0});return{resultType:i.ResultTypeEnum.Success}})]:[2,r.default.resolve({resultCode:"EmptySelection",resultType:i.ResultTypeEnum.Failure})]}})})};return t}(u.default);t.default=c});
define("odsp-next/actions/removeFromSharedList/odc/RemoveFromSharedListAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../models/item/command/SocialItemCommandKeys","../../base/ItemCommandHelper","../../../resources/ControlResourceKeys"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){n.__extends(i,t);function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="RemoveFromSharedList";n._itemCommandHelper=new(n.managed(o.default));n._currentItem=n.resources.consume(u.currentItem);return n}i.prototype.getExecutorPath=function(){return"odsp-next/actions/removeFromSharedList/odc/RemoveFromSharedListExecutor"};i.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/removeFromSharedList/odc/RemoveFromSharedListExecutor"],t,n)})}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}};i.prototype.getExecutorParameters=function(){return{currentItem:this._currentItem.peek(),selectionHelper:this.selectionHelper}};i.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return this._itemCommandHelper.isCommandSupported(e,s.removeFromShared)};return i}(i.default);t.default=a});
define("odsp-next/actions/addToBundle/odc/AddToBundleAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../dataSources/url/odc/UrlDataSource"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){n.__extends(i,t);function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="AddToBundleAction";return n}i.prototype.getExecutorPath=function(){return"odsp-next/actions/addToBundle/odc/AddToBundleExecutor"};i.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/addToBundle/odc/AddToBundleExecutor"],t,n)})}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};i.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}};i.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&e.isBundle&&e.ownerId===s.default.viewerId};return i}(i.default);t.default=o});
define("odsp-next/actions/odc/RemoveFromBundleAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../dataSources/url/odc/UrlDataSource","../../base/BaseAction","../../providers/operator/UpdateBundleOperator","../base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="RemoveFromBundleAction";r._itemSelectionHelper=new(r.child(a.typeResourceKey))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!(e&&e.parent&&e.parent.isBundle)&&e.parent.ownerId===s.default.viewerId};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var e,t=this;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveSelection()];case 1:return(e=n.sent()).length?[2,this.resources.consumeAsync(u.typeResourceKey).then(function(n){var r=new n({items:e.map(function(e){return e.id}),bundleAction:1,item:e[0].parent});t.trackPromise(r.start());return r.wait()}).then(function(){return{resultType:i.ResultTypeEnum.Success}})]:[2,r.default.resolve({resultCode:"EmptySelection",resultType:i.ResultTypeEnum.Failure})]}})})};return t}(o.default);t.default=f});
define("odsp-next/providers/operator/UpdateBundleOperator",["require","exports","tslib","./BaseOperator","../../providers/item/ItemProvider","../../models/operation/OperationType","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._context=t;r._itemProvider=n.itemProvider;return r}t.prototype.getOperationDetails=function(t){var n=e.prototype.getOperationDetails.call(this,t),r=t.input;n.type=s.default.updateBundle;n.name=r.name;n.iconName=r.iconName;n.payloads.updateBundle={item:r,parent:r.parent};return n};t.prototype.onStart=function(e){var t=[new r.Task(this._context.item.key,this._context.item)];e.update(t);return this._itemProvider.updateBundle(this._context,e)};t.dependencies=n.__assign({},r.default.dependencies,{itemProvider:i.resourceKey});return t}(r.default);t.default=u;t.typeResourceKey=o.createResolvedTypeResourceKey(e("module").id,u)});
define("odsp-next/providers/operator/BaseOperator",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../models/task/Task","../../models/task/TaskObserver","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal","../operation/OperationProvider","../../models/operation/OperationState","../../models/operation/OperationError","../../models/operation/OperationType","../../models/operation/OperationBatch"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Task=i.default;t.TaskObserver=s.default;t.OperationType=c.default;var p=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r._actionsByName={};var i=n.operationProvider,o=void 0===i?r.resources.consume(a.resourceKey):i;r._operationProvider=o;r._operationBatch=new h.default;r._operationsByKey={};r._completionSignal=new u.default;r._completionSignal.getPromise().done(function(){r.dispose()},function(){r.dispose()});r._observer=r.addDisposable(new s.default(r._onTaskChanges.bind(r)));r._throttleExecuteAllActions=r.async.debounce(r._executeAllActions);r.registerActions({cancel:r.onCancel});r.addDisposable(r._operationProvider.groups.subscribe(r._onOperationProviderGroupsChanged,r,"arrayChange"));return r}t.prototype.dispose=function(){e.prototype.dispose.call(this);this._observer=null;this._actionsByName={};this._getActionExecutor=null;this._onTaskChanges=null;this._operationsByKey={};this._groupOperation=null;this._throttleExecuteAllActions=null};t.prototype.start=function(){var e=this;return this.onStart(this._observer).then(function(){e._completeIfNoGroupCreated()},function(t){e._completeIfNoGroupCreated();return o.default.wrapError(t)})};t.prototype.wait=function(){return this._completionSignal.getPromise()};t.prototype.onStart=function(e){return o.default.wrap()};t.prototype.onCancel=function(e,t){e=e.map(function(e){return e.cancel()});t.update(e);return o.default.wrap()};t.prototype.registerActions=function(e){for(var t in e){var n=e[t];if(n){n._BaseOperator_actionName=t;this._actionsByName[t]={action:e[t],callback:e[t].bind(this),queue:[],signal:new u.default}}else delete this._actionsByName[t]}};t.prototype.getOperationDetails=function(e){var t;t=1===e.status?f.default.completed:2===e.status?f.default.failed:3===e.status?f.default.canceled:f.default.started;return{type:c.default.multiple,name:"",iconName:null,error:e.error&&new l.default({message:e.error.message,payloads:{}})||null,state:t,progress:{minimum:0,maximum:3!==e.status?1:0,current:1===e.status?1:0},visibility:0,payloads:{},actions:[]}};t.prototype.onOperationFinished=function(e){};t.prototype._queueTaskForAction=function(e,t){var n=this._actionsByName[e];n.queue.push(t);this._throttleExecuteAllActions();return n.signal.getPromise()};t.prototype._executeAllActions=function(){for(var e in this._actionsByName){var t=this._actionsByName[e],n=t.signal;t.signal=new u.default;if(t.queue.length){var r=t.queue.splice(0,t.queue.length);t.callback(r,this._observer).done(d(n),v(n))}}};t.prototype._onTaskChanges=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];this._updateOperationForTask(r)}};t.prototype._updateOperationForTask=function(e){var t,n=e.current,r=this.getOperationDetails(n),i=this._operationsByKey[n.key];t={};for(var s=0,o=r.actions;s<o.length;s++){var u=o[s],a=u._BaseOperator_actionName,f=this._actionsByName[a];f&&f.action===u&&(t[a]=!0)}if(!i){var l={};for(var a in this._actionsByName)l[a]={isAvailable:this.createObservable(a in t),execute:this._getActionExecutor(a,n)};var c={batch:this._operationBatch,type:r.type,name:r.name,iconName:r.iconName,payloads:r.payloads,progress:r.progress,visibility:r.visibility,actions:l};i=this._operationsByKey[n.key]=this._operationProvider.register(c)}if(i.name!==r.name){i.name=r.name;i.payloads(r.payloads)}i.progress.minimum(r.progress.minimum);i.progress.maximum(r.progress.maximum);i.progress.current(r.progress.current);i.type(r.type);i.error(r.error);i.state(r.state);for(var a in this._actionsByName)i.actions.peek()[a].isAvailable(a in t)};t.prototype._getActionExecutor=function(e,t){var n=this;return function(){return n._queueTaskForAction(e,t)}};t.prototype._createGroupOperationSubscription=function(e){var t=this,n=this.createPureComputed(function(){var t=e.state();return t===f.default.completed||t===f.default.canceled||t===f.default.failed||t===f.default.expired});this.createBackgroundComputed(function(){n()&&t.observables.ignore(function(){t.onOperationFinished(e)})})};t.prototype._onOperationProviderGroupsChanged=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t],i=r.value;if(i.batch===this._operationBatch)if("added"===r.status){if(!this._groupOperation){this._groupOperation=i;this._createGroupOperationSubscription(i)}}else"deleted"!==r.status||r.moved||this._completionSignal.complete()}};t.prototype._completeIfNoGroupCreated=function(){this._groupOperation||this._completionSignal.complete()};t.dependencies=n.__assign({},r.default.dependencies,{operationProvider:a.resourceKey});return t}(r.default);t.default=p;function d(e){return function(){return e.complete()}}function v(e){return function(t){return e.error(t)}}});
define("odsp-next/models/task/TaskObserver",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this._tasksByKey={};this._onChanges=e}e.map=function(e,t){return{update:function(n,r){void 0===r&&(r=!1);e.update(n.map(function(e){return t(e)}),r)}}};e.prototype.dispose=function(){this._tasksByKey={};this._onChanges=null};e.prototype.getTasks=function(){var e=[];for(var t in this._tasksByKey)e.push(this._tasksByKey[t]);return e};e.prototype.getTask=function(e){return this._tasksByKey[e]};e.prototype.update=function(e,t){void 0===t&&(t=!1);var n,r,i;n={};for(var s in this._tasksByKey)n[s]=this._tasksByKey[s];i=[];for(var o=0,u=e;o<u.length;o++){var a=u[o],f=n[a.key],l=a.compare(f);l&&i.push(l);delete n[a.key];this._tasksByKey[a.key]=a}if(t)for(var s in n){r=n[s];delete this._tasksByKey[s];i.push({previous:r,current:null})}this.onChanges(i)};e.prototype.onChanges=function(e){this._onChanges&&this._onChanges(e)};return e}();t.default=n});
define("odsp-next/actions/reportAbuse/odc/ReportAbuseAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../models/item/command/SocialItemCommandKeys","../../base/templates/ExecutorAction"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){n.__extends(s,t);function s(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="ReportAbuse";return n}s.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}};s.prototype.getExecutorPath=function(){return"odsp-next/actions/reportAbuse/odc/ReportAbuseExecutor"};s.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/reportAbuse/odc/ReportAbuseExecutor"],t,n)})}};s.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper}};s.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return this.itemCommandHelper.isCommandSupported(e,i.reportAbuse)};return s}(s.default);t.default=o});
define("odsp-next/actions/odc/RemoveMountPointAction",["require","exports","tslib","../../base/BaseAction","../../controls/commands/Commands.resx","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/string/StringHelper","../../controls/textContainer/TextContainer","../../resources/DataSourceResourceKeys","../../utilities/icons/Icon","../../providers/dialog/DialogProvider","../../providers/item/ItemProvider","../base/ItemCommandHelper","../../models/item/command/SocialItemCommandKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="RemoveMountPoint";r._urlDataSource=r.resources.consume(f.url);r._dialogProvider=r.resources.consume(c.resourceKey);r._itemProvider=r.resources.consume(h.resourceKey);r._navigation=r.resources.consume(v.navigation);r._itemCommandHelper=new(r.managed(p.default));r._itemSelectionHelper=new(r.child(m.typeResourceKey))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&this._itemCommandHelper.isCommandSupported(e,d.removeAsMountPoint)};t.prototype.onExecute=function(e,t){var n=this,r=this._itemSelectionHelper.currentItem.peek(),f=this._itemProvider,c=this._navigation,h=this._dialogProvider;return this._itemSelectionHelper.resolveFirst().then(function(e){if(!e)return{resultType:o.ResultTypeEnum.ExpectedFailure};var t=e.parent,p=u.format(i.strings.RemoveMountPointDetails2,e.name);return h.requestDialog({title:i.strings.RemoveMountPointTitle,component:{name:a.default.tagName,params:{text:p}},actions:[{name:i.strings.RemoveMountPoint,execute:function(){return s.default.resolve(2)},isAvailable:n.observables.create(!0),icon:new l.default("Cancel"),isDefault:!0}]}).wait().then(function(){n._itemSelectionHelper.clearSelection();return f.removeMountPoint({parentKey:r.key,item:e}).then(function(){var e=t?n._urlDataSource.getDefaultClickUrl(t):"";c.navigateTo(e);return{resultType:o.ResultTypeEnum.Success}})})})};return t}(r.default);t.default=g});
define("odsp-next/actions/requestReview/odc/RequestReviewAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../base/ItemCommandHelper","../../../models/item/command/SocialItemCommandKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(t){n.__extends(i,t);function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="RequestReview";n._itemCommandHelper=new(n.managed(s.default));return n}i.prototype.getExecutorPath=function(){return"odsp-next/actions/requestReview/odc/RequestReviewExecutor"};i.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/requestReview/odc/RequestReviewExecutor"],t,n)})}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!1}};i.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper}};i.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return this._itemCommandHelper.isCommandSupported(e,o.requestReview)};return i}(i.default);t.default=u});
define("odsp-next/actions/odc/ViewInFolderAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../base/ItemRedeemer","../../models/item/ItemType","../../dataSources/url/PageType","../../dataSources/url/QueryType","../../resources/ODCResourceKeys","../../dataSources/url/odc/UrlDataSource","../../base/BaseAction","../base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="ViewInFolderAction";r._navigation=r.resources.consume(s.navigation);r._urlDataSource=r.resources.consume(l.urlDataSource);r._itemReedemer=new(r.managed(o.default));r._itemSelectionHelper=new(r.child(p.typeResourceKey))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem(),t=this.resources.consume(l.urlDataSource),n=e&&e.parentKey&&e.queryType===f.default.Search,r=t.isCurrentQuery(f.default.Photos);return!!e&&(n||r&&e.type===u.default.Media)&&e.ownerId===c.default.viewerId};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var e,t=this;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(e=n.sent())?[2,this._itemReedemer.redeemItem(e,this).then(function(){t._navigation.navigateTo({url:t._urlDataSource.getItemUrl(e.parentKey,{page:a.default.Files})});return r.default.resolve({resultType:i.ResultTypeEnum.Success})})]:[2,r.default.resolve({resultCode:"EmptySelection",resultType:i.ResultTypeEnum.Failure})]}})})};return t}(h.default);t.default=d});
define("odsp-next/actions/RemoveFromAlbumAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/logging/events/Qos.event","../providers/album/AlbumProvider.key","./base/ItemCommandHelper","../models/item/command/PhotoItemCommandKeys","./base/ItemSelectionHelper"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="RemoveFromAlbum";r._itemCommandHelper=new(r.managed(o.default));r._itemSelectionHelper=new(r.child(a.typeResourceKey))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.currentItem(),t=this._itemSelectionHelper.firstItem();return!!e.isAlbum&&!!t&&this._itemCommandHelper.isCommandSupported(t,u.removeFromAlbum)};t.prototype.onExecute=function(e,t){var n=this,r=this._itemSelectionHelper.currentItem();return this._itemSelectionHelper.resolveSelection().then(function(e){n._itemSelectionHelper.clearSelection();var t={album:r,items:e};return n.resources.consumeAsync(s.resourceKey).then(function(e){return e.removeFromAlbum(t)}).then(function(){return{resultType:i.ResultTypeEnum.Success}},function(e){return{resultType:i.ResultTypeEnum.Failure}})})};return t}(r.default);t.default=f});
define("odsp-next/providers/album/AlbumProvider.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./AlbumProvider"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/actions/addPhotosToAlbum/AddPhotosToAlbumAction",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../base/ControlExecutorAction","../base/ItemSelectionHelper","../base/ItemCommandHelper","../../models/item/command/PhotoItemCommandKeys","../../models/item/VirtualItemType","@ms/odsp-utilities/lib/async/Promise","../../dataSources/base/odc/Config"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.item;n._itemSelectionHelper=new(n.child(s.typeResourceKey))({overrideItem:r,allowMultiSelect:!1,canFallback:!0});n._itemCommandHelper=new(n.managed(o.default));n.state=n.createPureComputed(n._computeState);return n}t.prototype.getParams=function(){return this._itemSelectionHelper.resolveFirst().then(function(e){return{item:e}})};t.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem();return{isAvailable:!!e&&!!l.Config.hcid&&e.virtualItemType===a.default.Album&&this._itemCommandHelper.isCommandSupported(e,u.addPhotosToAlbum)}};return t}(r.default);t.AddPhotosToAlbumHandler=c;var h=i.create({name:"AddPhotosToAlbum",source:{moduleDefinition:{path:"./AddPhotosToAlbumExecutor",getModule:function(){return new f.default(function(t,n){e(["./AddPhotosToAlbumExecutor"],t,n)})}}},handlerType:c});t.default=h});
define("odsp-next/actions/createAlbum/CreateAlbumAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../base/ControlExecutorAction","../base/ItemSelectionHelper","../../models/item/VirtualItemType"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._itemSelectionHelper=new(n.child(o.typeResourceKey))({allowMultiSelect:!1,canFallback:!0});n.state=n.createPureComputed(n._computeState);return n}t.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem();return{isAvailable:e&&e.virtualItemType===u.default.AlbumRoot}};return t}(i.default);t.CreateAlbumHandler=a;var f=s.create({name:"CreateAlbum",source:{moduleDefinition:{path:"./CreateAlbumExecutor",getModule:function(){return new r.default(function(t,n){e(["./CreateAlbumExecutor"],t,n)})}}},handlerType:a});t.default=f});
define("odsp-next/actions/SelectAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ControlResourceKeys","../base/BaseAction"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="SelectAction";r._item=t.item;r._selectItems=t.selectItems;r._showProperties=t.showProperties;r._actionMap=r.resources.consume(s.actionMap);r._selectionModel=r.resources.consume(s.itemsSelection);return r}t.prototype.onIsAvailable=function(){var e=this._item();return!!e&&!e.isPlaceholder&&1===this._selectionModel.mode};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var e,t=this;return n.__generator(this,function(n){if(!this._selectionModel)return[2,r.default.resolve({resultCode:"NoSelectionModel",resultType:i.ResultTypeEnum.Failure})];if(this._selectItems){e=this._selectItems.map(function(e){return t._selectionModel.getItemKey(e)});this._selectionModel.setSelectedKeys(e)}else{this._selectionModel.clear();this._selectionModel.setItemSelected(this._item,!0)}this._showProperties&&this._actionMap&&(new(this.managed(this._actionMap.ShowPropertiesAction))).execute(null);return[2,r.default.resolve({resultType:i.ResultTypeEnum.Success})]})})};return t}(o.default);t.default=u});
define("odsp-next/actions/SelectAllAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ControlResourceKeys","../base/BaseAction"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="SelectAll";r._selectionModel=r.resources.consume(s.itemsSelection);return r}t.prototype.onIsAvailable=function(){return 0===this._selectionModel.mode};t.prototype.onExecute=function(e,t){this._selectionModel.selectAll();return r.default.resolve({resultType:i.ResultTypeEnum.Success})};return t}(o.default);t.default=u});
define("odsp-next/actions/FilterSearchAction",["require","exports","tslib","../base/BaseAction","../dataSources/url/QueryType","./NavigationAction","../resources/DataSourceResourceKeys","../resources/ControlResourceKeys","../dataSources/search/ISearchDataSource"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="FilterSearch";n._filter=t.filter;n._urlDataSource=n.resources.consume(o.url);n._viewParams=n.resources.consume(u.viewParams);n._showCurrentView=t.showCurrentView;n._url=n.createPureComputed(n._computeUrl);n._supportsSearchFiltering=n._getSupportsSearchFiltering();n._navigationAction=new(n.managed(s.default))({url:n._url,forceNavigation:!0});return n}t.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)};t.prototype.onIsAvailable=function(){this._viewParams();return this._supportsSearchFiltering()&&!this._urlDataSource.isSearchPassThrough()&&this._urlDataSource.getQueryType()===i.default.Search&&this._navigationAction.isAvailable()};t.prototype.onIsToggled=function(){this._viewParams();var e=this._urlDataSource.getQueryType()===i.default.Search&&this._urlDataSource.isSearchFilterApplied(this._filter)&&!this._urlDataSource.isSearchPassThrough();e&&this._showCurrentView(e&&this._filter!==a.SearchFilterType.all);return e};t.prototype._computeUrl=function(){this._viewParams();return this._urlDataSource.getSearchFilterQueryUrl(this._filter)};t.prototype._getSupportsSearchFiltering=function(){var e=this.createObservable(!1);this.resources.consumeAsync(o.search).done(function(t){e(t.getCapabilities().supportsSearchFiltering)});return e};return t}(r.default);t.default=f});
define("odsp-next/actions/RemoveTagFromItemAction",["require","exports","tslib","../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../resources/ProviderResourceKeys","../models/item/VirtualItemType","./base/ItemSelectionHelper","../resources/ControlResourceKeys","../models/itemsScope/ItemsScopeFeature.key"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="RemoveTagFromItem";r._itemSelectionHelper=new(r.child(a.typeResourceKey))({allowMultiSelect:!0,canFallback:!1,overrideItem:t.item});r._viewParams=r.resources.consume(f.viewParams);return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.currentItem();return e.virtualItemType===u.default.Tag&&!!e.tags&&e.tags.length>0};t.prototype.onExecute=function(e,t){var n=this,r=this._itemSelectionHelper.currentItem(),u=r.tags,a=this.resources.consume(o.tag),f=this.resources.consume(o.photo).getAllPhotosSettings().peek();return this._itemSelectionHelper.resolveSelection().then(function(e){var t,o=e[0],c=o&&o.tags;if(c&&u)for(var h=0,p=c;h<p.length;h++){var d=p[h];if(d.tag===u[0].tag){t=d;break}}n._itemSelectionHelper.clearSelection();if(!t)return i.default.resolve({resultType:s.ResultTypeEnum.Failure});var v=!1,m=n._viewParams.peek();n.resources.consume(l.isItemsScopeEnabledInAllPhotosPivotResourceKey)&&void 0===m.tagFilter&&(v=!0);return a.updateTags({items:e,tagsToAdd:null,tagsToDelete:[t],parentKey:r.key,rootItemId:f.rootId,skipInvalidate:v}).then(function(){return{resultType:s.ResultTypeEnum.Success}})})};return t}(r.default);t.default=c});
define("odsp-next/actions/setAlbumCoverPhoto/odc/SetAlbumCoverPhotoAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys","../../base/ItemCommandHelper","../../../models/item/command/FileSystemItemCommandKeys","../../../models/item/VirtualItemType"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(t){n.__extends(i,t);function i(e){var n=t.call(this,e)||this;n.name="SetAlbumCoverPhoto";n._currentItem=n.resources.consume(s.currentItem);n._itemCommandHelper=new(n.managed(o.default));return n}i.prototype.getExecutorPath=function(){return"odsp-next/actions/setAlbumCoverPhoto/odc/SetAlbumCoverPhotoExecutor"};i.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/setAlbumCoverPhoto/odc/SetAlbumCoverPhotoExecutor"],t,n)})}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1}};i.prototype.getExecutorParameters=function(){return{itemSelectionHelper:this.selectionHelper,currentItem:this._currentItem.peek()}};i.prototype.onIsAvailable=function(){var e=this._currentItem(),t=this.selectionHelper.firstItem();return!!e&&e.virtualItemType===a.default.Album&&this._itemCommandHelper.isCommandSupported(e,u.deleteItem)&&!!t&&!(!t.photo&&!t.video)};return i}(i.default);t.default=f});
define("odsp-next/actions/setPhotosRoot/odc/SetPhotosRootAction",["require","exports","tslib","../../../base/BaseAction","@ms/odsp-utilities/lib/async/Promise","../../base/ExecutorLoader","../../../providers/item/ItemProvider","../../../resources/ProviderResourceKeys","../../../resources/ControlResourceKeys","../../../resources/ODCResourceKeys","../../../dataSources/url/PageType","../../../dataSources/url/QueryType","@ms/odsp-shared/lib/utilities/logging/events/Action.event"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(t){n.__extends(r,t);function r(n){var r=t.call(this,n)||this;r.name="SetPhotosRoot";r._rootId=n.rootId;r._photoProvider=r.resources.consume(u.photo);r._itemProvider=r.resources.consume(o.resourceKey);r._viewParams=r.resources.consume(a.viewParams);r._urlDataSource=r.resources.consume(f.urlDataSource);r._executorLoader=new(r.managed(s.default))({path:"odsp-next/actions/setPhotosRoot/odc/SetPhotosRootExecutor",getModule:function(){return new i.default(function(t,n){e(["odsp-next/actions/setPhotosRoot/odc/SetPhotosRootExecutor"],t,n)})},getExecutorParams:function(){return{photoProvider:r._photoProvider,itemProvider:r._itemProvider,urlDataSource:r._urlDataSource,rootId:r._rootId}}});return r}r.prototype.onIsToggled=function(){var e=!1,t=this._viewParams().id;if("ROOT"===this._rootId)e="root"===t;else if("SAMSUNGFOLDER"===this._rootId){e="samsungGallery"===this._photoProvider.getAllPhotosSettings()().folderName}else if("ALLPHOTOSFOLDER"===this._rootId){e="photos"===this._photoProvider.getAllPhotosSettings()().folderName}return e};r.prototype.onIsAvailable=function(){var e=this._viewParams();switch(this._urlDataSource.getPhotoType(e)){case 0:case 9:return!0;default:return!1}};r.prototype.onExecute=function(e){return this._executorLoader.execute(e)};r.prototype.onCreateQosEvent=function(e){return new h.Action({name:this.name,pageType:this._urlDataSource&&l.default[this._urlDataSource.getPageType()]||"",queryType:this._urlDataSource&&c.default[this._urlDataSource.getQueryType()]||"",logStartEnd:this.logStartEnd,extraData:{filter:this._rootId}})};return r}(r.default);t.default=p});
define("odsp-next/actions/FilterSearchByDateAction",["require","exports","tslib","../base/BaseAction","../dataSources/url/QueryType","./NavigationAction","../resources/DataSourceResourceKeys","../resources/ControlResourceKeys","../dataSources/search/ISearchDataSource"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="FilterSearchByDateAction";n._filter=t.filter;n._urlDataSource=n.resources.consume(o.url);n._viewParams=n.resources.consume(u.viewParams);n._showCurrentView=t.showCurrentView;n._url=n.createPureComputed(n._computeUrl);n._supportsSearchFiltering=n._getSupportsSearchFiltering();n._navigationAction=new(n.managed(s.default))({url:n._url,forceNavigation:!0});return n}t.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)};t.prototype.onIsAvailable=function(){this._viewParams();return this._supportsSearchFiltering()&&!this._urlDataSource.isSearchPassThrough()&&this._urlDataSource.getQueryType()===i.default.Search&&this._navigationAction.isAvailable()};t.prototype.onIsToggled=function(){this._viewParams();var e=this._urlDataSource.isSearchByDateFilterApplied(this._filter)&&this._urlDataSource.getQueryType()===i.default.Search&&!this._urlDataSource.isSearchPassThrough();e&&this._showCurrentView(e&&this._filter!==a.SearchFilterDateType.anyDate);return e};t.prototype._computeUrl=function(){this._viewParams();return this._urlDataSource.getSearchByDateFilterQueryUrl(this._filter)};t.prototype._getSupportsSearchFiltering=function(){var e=this.createObservable(!1);this.resources.consumeAsync(o.search).done(function(t){e(t.getCapabilities().supportsSearchFiltering)});return e};return t}(r.default);t.default=f});
define("odsp-next/actions/launchMoveCopyPanel/odc/LaunchMoveCopyPanelAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/url/PageType","../../../dataSources/url/QueryType","../../../resources/ODCResourceKeys","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys","../../../resources/DataSourceResourceKeys","../../../models/item/command/FileSystemItemCommandKeys"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(t){n.__extends(u,t);function u(e){var n=t.call(this,e)||this;n._isMove=e.isMove;n.name="LaunchMoveCopyPanel";n._currentItem=n.resources.consume(a.currentItem);n._urlDataSource=n.resources.consume(o.urlDataSource);n._moveCopyDataSource=n.resources.consume(f.copy);n._capabilities=n._moveCopyDataSource.getCapabilities();return n}u.prototype.getExecutorPath=function(){return"odsp-next/actions/launchMoveCopyPanel/LaunchMoveCopyPanelExecutor"};u.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/launchMoveCopyPanel/LaunchMoveCopyPanelExecutor"],t,n)})}};u.prototype.getSelectionOptions=function(){return{allowMultiSelect:!0,canFallback:!0}};u.prototype.getExecutorParameters=function(){return{isMove:this._isMove,actionName:this.name,selectionHelper:this.selectionHelper}};u.prototype.onIsAvailable=function(){var e=this;if(!this._capabilities.supportsMoveCopy)return!1;var t=this._currentItem();if(this.selectionHelper.selection().length>1&&t.queryType===s.default.SharedWithMe&&t.isRootFolder)return!1;if(!this._isMove&&this._urlDataSource.getAuthKeyParamValue())return!1;var n=this._isMove?l.moveFrom:l.copyFrom;return this._urlDataSource.getPageType()!==i.default.TextFileEditor&&this.selectionHelper.filterItems(function(t){return e.itemCommandHelper.isCommandSupported(t,n)})};return u}(u.default);t.default=c});
define("odsp-next/actions/odc/AutoExecuteAction",["require","exports","tslib","../../base/BaseItemAction","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/ODCResourceKeys","../../resources/ControlResourceKeys","@ms/odsp-datasources/lib/interfaces/list/DocumentType","../../dataSources/url/AutoActionType","@ms/odsp-shared/lib/utilities/navigation/Navigation.key"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="AutoExecute";n._focusItem=t.focusItem;n._actionMap=n.resources.consume(u.actionMap);n._navigation=n.resources.consume(l.navigation);n._urlDataSource=n.resources.consume(o.urlDataSource);n._viewParams=n.resources.consume(u.viewParams);n._actionType=n.createPureComputed(n._computeAutoActionType,{deferEvaluation:!0});n._createAction=n.createPureComputed(n._computeCreateAction,{deferEvaluation:!0});n._action=n.createPureComputed(n._computeAction,{deferEvaluation:!0});return n}t.prototype.onExecute=function(e,t){var n,r=this._actionType.peek(),o=this._action.peek(),u=this.item.peek(),a=this._viewParams.peek();n=o&&o.isAvailable.peek()?o.execute(e):i.default.wrap({resultType:s.ResultTypeEnum.ExpectedFailure});r!==f.default.locate&&this._navigation.navigateTo(this._urlDataSource.getDefaultClickUrl(u,{viewParams:a}));return n};t.prototype.onIsAvailable=function(){var e=this._actionType(),t=this.item(),n=this._focusItem(),r=!t.isPlaceholder,i=!n||!n().isPlaceholder;return!!e&&i&&r};t.prototype._computeAutoActionType=function(){var e=this._viewParams();return this._urlDataSource.getAutoActionType(e)};t.prototype._computeCreateAction=function(){var e,t=this;switch(this._actionType()){case f.default.defaultClick:e=function(){return new(t.managed(t._actionMap.DefaultClickAction))({sourceEngagement:"AutoExecuteAction",item:t._focusItem&&t._focusItem()})};break;case f.default.download:e=function(){return new(t.managed(t._actionMap.DownloadAction))({})};break;case f.default.share:case f.default.sharing:e=function(){return new(t.managed(t._actionMap.ShareByLinkAction))({})};break;case f.default.sendSurvey:e=function(){return new(t.managed(t._actionMap.SurveyAction))({actionType:1})};break;case f.default.createTextDocument:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:a.DocumentType.Text,autoInvokedItem:!0})};break;case f.default.createWord:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:a.DocumentType.Word,autoInvokedItem:!0})};break;case f.default.createExcel:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:a.DocumentType.Excel,autoInvokedItem:!0})};break;case f.default.createExcelForm:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:a.DocumentType.ExcelSurvey,autoInvokedItem:!0})};break;case f.default.createPowerPoint:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:a.DocumentType.PowerPoint,autoInvokedItem:!0})};break;case f.default.createOneNote:e=function(){return new(t.managed(t._actionMap.CreateDocumentAction))({docType:a.DocumentType.OneNote,autoInvokedItem:!0})};break;case f.default.openInExcel:case f.default.openInWord:case f.default.openInPowerPoint:case f.default.openInOneNote:case f.default.openInVisio:case f.default.openInProject:case f.default.openInPublisher:case f.default.openInOffice:e=function(){return new(t.managed(t._actionMap.OpenInOfficeClientAction))({})};break;case f.default.embed:e=function(){return new(t.managed(t._actionMap.EmbedAction))({})};break;case f.default.reportAbuse:e=function(){return new(t.managed(t._actionMap.ReportAbuseAction))({})};break;case f.default.addToShared:e=function(){return new(t.managed(t._actionMap.AddToSharedListAction))({})};break;case f.default.editBrowser:e=function(){return new(t.managed(t._actionMap.OpenInOfficeOnlineAction))({})};break;case f.default.feedback:e=function(){return new(t.managed(t._actionMap.FeedbackAction))({})};break;case f.default.versionHistory:e=function(){return new(t.managed(t._actionMap.ShowVersionHistoryAction))({})};break;case f.default.locate:}return e};t.prototype._computeAction=function(){var e=this._action.peek();e&&e.dispose();e=null;var t=this._createAction();t&&(e=t());return e};return t}(r.default);t.default=c});
define("odsp-next/actions/toggleSelectionMode/ToggleSelectionModeAction",["require","exports","tslib","../../base/BaseAction","../base/ItemSelectionHelper","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../controls/list/react/SelectionManager"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="ToggleSelectionModeAction";n._platformDetection=n.resources.consume(u.platformDetection);n._isSelectionModal=n.resources.consume(a.isSelectionModalResourceKey);n._selectionHelper=new(n.child(i.typeResourceKey))({});return n}t.prototype.onIsAvailable=function(){return this._platformDetection.isMobile&&!this._isSelectionModal()&&!this._selectionHelper.firstItem()};t.prototype.onExecute=function(e){var t=this._isSelectionModal.peek();this._isSelectionModal(!t);return s.default.wrap({resultType:o.ResultTypeEnum.Success})};t.prototype.onIsToggled=function(){return this._isSelectionModal()};return t}(r.default);t.default=f});
define("odsp-next/actions/redeemCode/odc/RedeemCodeAction",["require","exports","tslib","../../../base/BaseAction","../../base/ExecutorLoader","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){n.__extends(r,t);function r(n){var r=t.call(this,n)||this;r.name="RedeemCode";r._executorLoader=new(r.managed(i.default))({path:"odsp-next/actions/redeemCode/odc/RedeemCodeExecutor",getModule:function(){return new s.default(function(t,n){e(["odsp-next/actions/redeemCode/odc/RedeemCodeExecutor"],t,n)})},getExecutorParams:function(){return{redeemSuccess:n.redeemSuccess,redeemCode:n.redeemCode,actionName:r.name}}});return r}r.prototype.onExecute=function(e){return this._executorLoader.execute(e)};r.prototype.onIsAvailable=function(){return!0};return r}(r.default);t.default=o});
define("odsp-next/actions/save/odc/SaveAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../SaveAction"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(t){n.__extends(i,t);function i(){return null!==t&&t.apply(this,arguments)||this}i.prototype.getExecutorPath=function(){return"odsp-next/actions/save/SaveExecutor"};i.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/save/SaveExecutor"],t,n)})}};return i}(i.default);t.default=s});
define("odsp-next/actions/save/SaveAction",["require","exports","tslib","../../base/BaseAction","../base/ExecutorLoader","../base/ItemSelectionHelper","../../resources/ControlResourceKeys","../../providers/item/ItemContentProvider"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="Save";n._itemContentsProvider=n.resources.consume(u.resourceKey);var r=n.resources.consume(o.currentItem);n._selectionHelper=new(n.child(s.typeResourceKey))({overrideItem:t.item,allowMultiSelect:!1,canFallback:!1});n._loader=new(n.managed(i.default))({path:n.getExecutorPath(),getModule:n.getModuleFactory(),getExecutorParams:function(){return{selectionHelper:n._selectionHelper,currentItem:r.peek()}}});return n}t.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();if(!e)return!1;var t=this._itemContentsProvider.getItemContent(e);return!!t.isEditable()&&(!!t.memoryContent()&&(!t.hasConflict()&&(!t.hasPendingSave()&&t.hasChanges())))};t.prototype.onExecute=function(e){return this._loader.execute(e)};return t}(r.default);t.SaveAction=a;t.default=a});
define("odsp-next/providers/item/ItemContentProvider",["require","exports","../../models/item/ItemContent","@ms/odsp-utilities/lib/disposable/Disposable","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){this._itemContents={}}e.prototype.getItemContent=function(e){var t=e.key,i=this._itemContents,s=i[t];if(!s){s=new n.default;r.hook(s,function(){delete i[t]});i[t]=s}return s};e.prototype.dispose=function(){this._itemContents={}};return e}();t.default=s;t.resourceKey=i.createResolvedResourceKey(e("module").id,s,{})});
define("odsp-next/models/item/ItemContent",["require","exports","tslib","knockout","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.memoryContent=r.observable(null);n.serverContent=r.observable(null);n.outDated=r.observable(!1);n.isEditable=r.observable(!1);n.hasConflict=n.createPureComputed(n._computeHasConflict);n.hasPendingSave=n.createPureComputed(n._computeHasPendingSave);n.hasChanges=n.createPureComputed(n._computeHasChanges);n._lastSaved=r.observable(null);n._pendingSave=r.observable(null);return n}t.prototype.startingSave=function(){this.hasPendingSave.peek()||this._pendingSave(this.memoryContent.peek().text)};t.prototype.saveFailed=function(){this.hasPendingSave.peek()&&this._pendingSave(null)};t.prototype.saveSucceded=function(){if(this.hasPendingSave.peek()){this.updateETag=!0;this._lastSaved(this._pendingSave.peek());this._pendingSave(null)}};t.prototype._computeHasPendingSave=function(){return!!this._pendingSave()};t.prototype._computeHasChanges=function(){var e=this.memoryContent();if(!e||"string"!=typeof e.text)return!1;var t=this._lastSaved();if(null===t){this._lastSaved(e.text);return!1}return e.text!==t};t.prototype._computeHasConflict=function(){return!!this.serverContent()};return t}(i.default);t.default=s});
define("odsp-next/actions/redeem/odc/RedeemAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../base/BaseAction","../../base/ItemRedeemer","../../../dataSources/url/PageType","../../../providers/item/ItemProvider","@ms/odsp-utilities/lib/logging/events/Qos.event","../../base/ItemSelectionHelper","../../../resources/DataSourceResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="Redeem";n._itemProvider=n.resources.consume(u.resourceKey);n._urlDataSource=n.resources.consume(l.url);n._itemReedemer=new(n.managed(s.default));n._selectionHelper=new(n.child(f.typeResourceKey))({overrideItem:t.item,allowMultiSelect:!0,canFallback:!1});return n}t.prototype.onIsAvailable=function(){return this._urlDataSource.getPageType()===o.default.TextFileEditor&&this._selectionHelper.filterItems(function(e){return e.tokenNeedsRedeeming})};t.prototype.onExecute=function(e){var t=this;return this._selectionHelper.resolveSelection().then(function(e){return t._itemReedemer.redeemItems(e,t).then(function(){for(var n=0,i=e;n<i.length;n++){var s=i[n];t._itemProvider.invalidateItem(s.key,{triggerFetch:!0})}return r.default.wrap({resultType:a.ResultTypeEnum.Success})})})};return t}(i.default);t.default=c});
define("odsp-next/actions/base/LazyLoadedAction",["require","exports","tslib","@ms/odsp-shared/lib/base/ActionInputType","../../base/BaseAction","../UnsupportedAction","../../resources/ProviderResourceKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="LazyLoadedAction";n.isQosLogged=!1;n._actionParams=t;n._action=n.createObservable(new(n.managed(s.default))({}));var r=n.resources.consume(o.bundleLoader);n._getActionPromise=n.trackPromise(r.waitFor(n.actionPath,n.getModule).then(function(e){var t=new(n.managed(e))(n._actionParams);n._action(t);return t}));n.inputType=n.createPureComputed(n._computeInputType);return n}t.create=function(e,n){var r=function(){for(var r=[],i=0;i<arguments.length;i++)r[i-0]=arguments[i];this.actionPath=e;this.getModule=n;t.apply(this,r)};r.prototype=t.prototype;return r};t.prototype.onIsAvailable=function(){return this._action().isAvailable()};t.prototype.onIsToggled=function(){return this._action().isToggled()};t.prototype.onExecute=function(e,t){return this._getActionPromise.then(function(t){return t.execute(e)})};t.prototype._computeInputType=function(){var e=this._action();return e.inputType?e.inputType():r.default.none};return t}(i.default);t.default=u});
define("odsp-next/actions/switchPhotoFolderLayoutType/odc/SwitchPhotoFolderLayoutTypeAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../dataSources/url/odc/UrlDataSource","../../../models/itemSet/ItemSetMonitor","../../base/templates/ExecutorAction"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(t){n.__extends(o,t);function o(e){var n=t.call(this,e)||this;n.name="SwitchPhotoFolderLayoutType";n._itemSetMonitor=n.resources.consume(s.resourceKey);return n}o.prototype.onIsToggled=function(){var e=this._itemSetMonitor.item();return!i.default.getKeyParams(e.key).ft};o.prototype.getExecutorPath=function(){return"odsp-next/actions/switchPhotoFolderLayoutType/odc/SwitchPhotoFolderLayoutTypeExecutor"};o.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/switchPhotoFolderLayoutType/odc/SwitchPhotoFolderLayoutTypeExecutor"],t,n)})}};o.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}};o.prototype.getExecutorParameters=function(){return{actionName:this.name}};return o}(o.default);t.default=u});
define("odsp-next/models/itemSet/ItemSetMonitor",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../../resources/ControlResourceKeys","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this,s=n.itemSet;r.itemSet=s;r.item=r.createPureComputed(r._computeItem);r.item.equalityComparer=i.objectStrictEquality;r.isEmpty=r.createPureComputed(r._computeIsEmpty);r.hasItems=r.createPureComputed(r._computeHasItems);r.hasName=r.createPureComputed(r._computeHasName);r.hasParent=r.createPureComputed(r._computeHasParent);r.name=r.createPureComputed(r._computeName);r.isPlaceholder=r.createPureComputed(r._computeIsPlaceholder);return r}t.prototype._computeItem=function(){return this.itemSet().item()};t.prototype._computeHasItems=function(){return this.itemSet().content().items.length>0};t.prototype._computeIsEmpty=function(){var e=0===this.itemSet().content().items.length&&!this.itemSet().isPlaceholder,t=!this.item().isPlaceholder;return e&&t};t.prototype._computeHasName=function(){var e=this.item();return!(!e.displayName&&!e.name)};t.prototype._computeHasParent=function(){return!!this.item().parent};t.prototype._computeName=function(){var e=this.item();return e.displayName||e.name};t.prototype._computeIsPlaceholder=function(){return this.item().isPlaceholder};t.dependencies=n.__assign({},r.default.dependencies,{itemSet:s.currentItemSet});return t}(r.default);t.ItemSetMonitor=u;t.resourceKey=o.createResolvedResourceKey(e("module").id,u);t.default=u});
define("odsp-next/actions/createAlbumFromFolder/odc/CreateAlbumFromFolderAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../resources/DataSourceResourceKeys","../../../dataSources/url/QueryType","../../../models/item/ItemType","../../../dataSources/url/odc/UrlDataSource","../../../dataSources/url/PageType","../../base/templates/ExecutorAction","../../../resources/ODCResourceKeys","@ms/odsp-datasources/lib/Permissions","../../../models/item/ItemParentHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(t){n.__extends(f,t);function f(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="CreateAlbumFromFolder";n._identity=n.resources.consume(i.identity);n._urlDataSource=n.resources.consume(l.urlDataSource);n._itemParentHelper=n.resources.consume(h.resourceKey);return n}f.prototype.isValidItem=function(e,t,n){var r=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"mountPoint")),i=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"vault"));return n!==a.default.TextFileEditor&&t&&t.type!==c.IdentityType.anonymous&&e.ownerId===u.default.viewerId&&!r&&e.type===o.default.Folder&&e.queryType===s.default.Files&&"root"!==e.id&&!e.isBundle&&!e.isAlbum&&!i};f.prototype.getExecutorPath=function(){return"odsp-next/actions/createAlbumFromFolder/odc/CreateAlbumFromFolderExecutor"};f.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/createAlbumFromFolder/odc/CreateAlbumFromFolderExecutor"],t,n)})}};f.prototype.getExecutorParameters=function(){return{actionName:this.name,itemSelectionHelper:this.selectionHelper}};f.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};f.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();if(!e)return!1;var t=this._identity.getIdentity(),n=this._urlDataSource.getPageType();return this.isValidItem(e,t,n)};return f}(f.default);t.default=p});
define("odsp-next/actions/odc/VersionHistoryAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../models/item/ItemType","../NavigationAction","../base/ItemCommandHelper","../../utilities/features/Features","../../dataSources/url/odc/UrlDataSource","../../base/BaseAction","../../resources/DataSourceResourceKeys","../showVersionHistoryAction/ShowReactVersionHistoryAction","../base/ItemSelectionHelper","../../models/item/command/OfficeItemCommandKeys","../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="VersionHistory";r._itemCommandHelper=new(r.managed(u.default));r._itemSelectionHelper=new(r.child(p.typeResourceKey))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!e&&!v.isOneDriveWinApp()&&(this._itemCommandHelper.isCommandSupported(e,d.viewVersionHistory)||!!e&&(e.type===s.default.File||e.type===s.default.Media)&&!e.dateDeletedTime&&a.isFeatureEnabled(a.VersionAllFiles))};t.prototype.onExecute=function(e,t){return n.__awaiter(this,void 0,r.default,function(){var t,s,u;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._itemSelectionHelper.resolveFirst()];case 1:if(!(t=n.sent()))return[2,r.default.resolve({resultCode:"EmptySelection",resultType:i.ResultTypeEnum.Failure})];if(this._itemCommandHelper.isCommandSupported(t,d.viewVersionHistory)){s=this.resources.consume(c.url);u=s.getVersionHistoryUrl(f.default.viewerId,t.id);return[2,new(this.managed(o.default))({url:u,target:"_blank"}).execute(e)]}return[2,(new(this.managed(h.default))).execute(e)]}})})};return t}(l.default);t.default=m});
define("odsp-next/actions/showVersionHistoryAction/ShowReactVersionHistoryAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../odb/ActionHelper","@ms/odsp-datasources/lib/Permissions","../base/ControlExecutorAction","../base/ItemSelectionHelper","../../models/item/ItemParentHelper","../../resources/DataSourceResourceKeys","../../dataSources/url/PageType","../base/ItemCommandHelper","../../models/item/command/MetadataItemCommandKeys","../../controls/infoPane/sections/sharing/SharingSection.css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.state=n.createPureComputed(n._computeState);n._urlDataSource=n.resources.consume(l.url);n._itemParentHelper=n.resources.consume(f.resourceKey);n._itemCommandHelper=n.resources.consume(h.resourceKey);n._itemSelectionHelper=new(n.child(a.typeResourceKey))({allowMultiSelect:!1,canFallback:!1});return n}t.prototype.getParams=function(){return{item:this._itemSelectionHelper.firstItem}};t.prototype._computeState=function(){var e=this._itemSelectionHelper.firstItem(),t=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")),n=t&&t.list,r=!s.default.isFolder(e,!0)&&o.PermissionMask.hasItemPermission(e,o.PermissionMask.viewVersions);return{isAvailable:this._urlDataSource.getPageType()!==c.default.TextFileEditor&&!!n&&!n.isExternal&&(n.enableVersions||n.isModerated)&&this._itemCommandHelper.isCommandSupported(e,p.versionHistory)&&3!==e.itemStatus&&4!==e.itemStatus&&r}};return t}(i.default);t.ShowReactVersionHistoryHandler=d;var v=u.create({name:"ShowReactVersionHistory",source:{moduleDefinition:{path:"./ShowReactVersionHistoryExecutor",getModule:function(){return new r.default(function(t,n){e(["./ShowReactVersionHistoryExecutor"],t,n)})}}},handlerType:d});t.default=v});
define("odsp-next/actions/odb/ActionHelper",["require","exports","./Actions.resx","../../controls/commands/Commands.resx","../../utilities/icons/Icon","@ms/odsp-utilities/lib/logging/events/Qos.event","../../models/item/ItemType","@ms/odsp-datasources/lib/Permissions","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-list-utilities/lib/Actions/CheckedOutHelper","../../controls/textContainer/TextContainer"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(){}e.isFolder=function(e,t){return t?e&&(e.type===o.default.Folder||e.type===o.default.OneNote):e&&e.type===o.default.Folder};e.isCheckedOut=function(e){return f.isCheckedOut(e)};e.isCheckedOutByUser=function(e,t){return f.isCheckedOutByUser(e,t)};e.isCheckedOutByOther=function(t,n){return e.isCheckedOut(t)&&!e.isCheckedOutByUser(t,n)};e.showCheckedOutByOtherDialog=function(e){return e.requestDialog({title:n.strings.FileCheckedoutOrLockedWarningTitle,component:{name:l.default.tagName,params:{text:n.strings.FileCheckedoutOrLockedWarning}},actions:[{name:r.strings.cancelActionText,execute:function(){return a.default.wrap(2)},icon:new i.default("Cancel"),isDefault:!0}]}).wait().then(function(){return{resultType:s.ResultTypeEnum.Success}})};e.isPublished=function(t,n){return n.isModerated?t.properties[e.PublishProperty]&&"3"!==t.properties[e.PublishProperty]&&"1"!==t.properties[e.PublishProperty]:0===e.getVersionNoModeration(t,n).minor&&0!==e.getVersionNoModeration(t,n).major};e.needsPublishingReminder=function(t,n){return u.PermissionMask.hasItemPermission(t,u.PermissionMask.editListItems)&&n.enableMinorVersions&&!e.isFolder(t,!0)};e.isPublishingRelevant=function(t,n){return u.PermissionMask.hasItemPermission(t,u.PermissionMask.editListItems)&&n.enableMinorVersions&&!e.isCheckedOut(t)&&!e.isFolder(t,!0)};e.getVersionNoModeration=function(e,t){return t.isModerated?{major:0,minor:0}:this.getVersion(e,t)};e.getVersion=function(t,n){if(t&&t.properties&&t.properties[e.VersionProperty]){var r=Number(t.properties[e.VersionProperty])%512;return{major:Math.floor(Number(t.properties[e.VersionProperty])/512),minor:r}}return{major:0,minor:0}};e.isApprovalRelevant=function(t,n){return n&&n.isModerated&&!e.isCheckedOut(t)&&u.PermissionMask.hasItemPermission(t,u.PermissionMask.editListItems)&&u.PermissionMask.hasItemPermission(t,u.PermissionMask.approveItems)};e.FileTypeProperty="FSObjType";e.PublishProperty="_ModerationStatus.";e.VersionProperty="_UIVersion";return e}();t.default=c});
define("@ms/odsp-list-utilities/lib/Actions/CheckedOutHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CheckOutUserProperty="CheckedOutUserId";function n(e){return!!e.properties[t.CheckOutUserProperty]}t.isCheckedOut=n;function r(e,n){var r=Number(n);return!isNaN(r)&&Number(e.properties[t.CheckOutUserProperty])===r}t.isCheckedOutByUser=r;t.isCheckedOutByOther=function(e,t){return n(e)&&!r(e,t)}});
define("odsp-next/models/item/command/MetadataItemCommandKeys",["require","exports","./ItemCommandKey"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.checkout=new n.default("checkout");t.quickEdit=new n.default("quickEdit");t.editItem=new n.default("editItem");t.viewItem=new n.default("viewItem");t.versionHistory=new n.default("versionHistory");t.exportList=new n.default("exportList")});
define("odsp-next/actions/odc/RearrangeAction",["require","exports","tslib","../../base/BaseAction","../../resources/ControlResourceKeys","../../resources/ODCResourceKeys","../NavigationAction","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../base/ItemCommandHelper","../../models/item/command/CustomizationItemCommandKeys"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.name="Rearrange";n._platformDetection=n.resources.consume(u.platformDetection);n._odcUrlDataSource=n.resources.consume(s.urlDataSource);n._item=n.resources.consume(i.currentItem);n._itemCommandHelper=new(n.managed(a.default));n._navigationAction=new(n.managed(o.default))({url:n.createPureComputed(function(){var e=n._item();return n._odcUrlDataSource.getArrangeViewUrl(e.uploadOwnerId,e.id)})});return n}t.prototype.onIsAvailable=function(){var e=this._item();return!this._platformDetection.isMobile&&!!e.folder&&(e.folder.photoCount>1||e.folder.documentCount>1)&&this._itemCommandHelper.isCommandSupported(e,f.rearrange)};t.prototype.onExecute=function(e,t){return this._navigationAction.execute(e)};return t}(r.default);t.default=l});
define("odsp-next/actions/applyOfficeLens/odc/ApplyOfficeLensAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../resources/ControlResourceKeys","../../../models/item/command/PhotoItemCommandKeys"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(t){n.__extends(i,t);function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="ApplyOfficeLens";n._item=n.resources.consume(s.currentItem);return n}i.prototype.getExecutorPath=function(){return"odsp-next/actions/applyOfficeLens/odc/ApplyOfficeLensExecutor"};i.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/applyOfficeLens/odc/ApplyOfficeLensExecutor"],t,n)})}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}};i.prototype.getExecutorParameters=function(){return{actionName:this.name,selectionHelper:this.selectionHelper,item:this._item.peek()}};i.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&this._item&&this.itemCommandHelper.isCommandSupported(e,o.applyOfficeLens)};return i}(i.default);t.default=u});
define("odsp-next/actions/removeOfficeLens/odc/RemoveOfficeLensAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../resources/ControlResourceKeys","../../base/ItemSelectionHelper","../../base/ExecutorLoader","../../../base/BaseAction","../../base/ItemCommandHelper","../../../models/item/command/PhotoItemCommandKeys"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(t){n.__extends(u,t);function u(n){void 0===n&&(n={});var u=t.call(this,n)||this;u.name="RemoveOfficeLens";u._selectionHelper=new(u.child(s.typeResourceKey))({overrideItem:n.item,allowMultiSelect:!1,canFallback:!1});u._itemCommandHelper=new(u.managed(a.default));u._item=u.resources.consume(i.currentItem);u._loader=new(u.managed(o.default))({path:"odsp-next/actions/removeOfficeLens/odc/RemoveOfficeLensExecutor",getModule:function(){return new r.default(function(t,n){e(["odsp-next/actions/removeOfficeLens/odc/RemoveOfficeLensExecutor"],t,n)})},getExecutorParams:function(){return{actionName:u.name,selectionHelper:u._selectionHelper,item:u._item.peek()}}});return u}u.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();return e&&this._item()&&this._itemCommandHelper.isCommandSupported(e,f.removeOfficeLens)};u.prototype.onExecute=function(e){return this._loader.execute(e)};return u}(u.default);t.default=l});
define("odsp-next/actions/base/OverrideAction",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/base/ActionInputType"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r._primary=new(r.managed(t.primary))(t.actionParams);var i=n.__assign({},t.actionParams,{primaryActionName:r._primary.name});r._secondary=new(r.managed(t.secondary))(i);r.name=r._primary.name;r.isAvailable=r._primary.isAvailable;r.isExecuting=r.createPureComputed(r._computeIsExecuting);r.isToggled=r.createPureComputed(r._computeIsToggled);r.inputType=r.createPureComputed(r._computeInputType);return r}t.create=function(e,r){return function(t){n.__extends(i,t);function i(n){return t.call(this,{primary:e,secondary:r,actionParams:n})||this}return i}(t)};t.prototype.execute=function(e){return this._getAction().execute(e)};t.prototype._getAction=function(){return this._secondary.isAvailable.peek()?this._secondary:this._primary};t.prototype._computeIsExecuting=function(){return this._primary.isExecuting()||this._secondary.isExecuting()};t.prototype._computeIsToggled=function(){return this._primary.isToggled()||this._secondary.isToggled()};t.prototype._computeInputType=function(){var e=this._secondary.isAvailable()?this._secondary:this._primary;return e&&e.inputType?e.inputType():i.default.none};return t}(r.default);t.default=s});
define("odsp-next/actions/printPdf/odc/PrintPdfAction",["require","exports","tslib","../../base/templates/ExecutorAction","@ms/odsp-utilities/lib/browser/PlatformDetection.key","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../../resources/ODCResourceKeys","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","../../../utilities/features/Features","../../../utilities/logging/odc/UsageNames","@ms/odsp-utilities/lib/logging/events/Engagement.event","@ms/odsp-utilities/lib/logging/events/UsageType","../../../resources/ProviderResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(t){n.__extends(r,t);function r(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="PrintPdf";n._urlDataSource=n.resources.consume(o.urlDataSource);n._instrumentationProvider=n.resources.consume(p.instrumentation);n._platform=n.resources.consume(i.platformDetection);n._navigation=n.resources.consume(s.navigation);n._supportsIframePrint=n._platform.isChrome||n._platform.isSafari;return n}r.prototype.getExecutorPath=function(){return"odsp-next/actions/printPdf/odc/PrintPdfExecutor"};r.prototype.getModuleFactory=function(){return function(){return new u.default(function(t,n){e(["odsp-next/actions/printPdf/odc/PrintPdfExecutor"],t,n)})}};r.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!1}};r.prototype.getExecutorParameters=function(){return{actionName:this.name,urlDataSource:this._urlDataSource,instrumentationProvider:this._instrumentationProvider,navigation:this._navigation,selectionHelper:this.selectionHelper}};r.prototype.onExecute=function(e){var n=this;return this._supportsIframePrint?this.selectionHelper.resolveFirst().then(function(e){var t=n._urlDataSource.getPrintPdfUrl(e);c.default.logData({name:l.UsageName[l.UsageName.PrintPdfNative],location:l.LocationName[l.LocationName.OneUp],usageType:h.UsageType[h.UsageType.Click],currentPage:n._instrumentationProvider.currentPageName(),previousPage:n._instrumentationProvider.previousPageName()});n._navigation.navigateTo({url:t,frameId:"_blank"});return u.default.wrap({resultType:a.ResultTypeEnum.Success})}):t.prototype.onExecute.call(this,e)};r.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return e&&".pdf"===e.extension&&!this._platform.isMobile&&f.isFeatureEnabled(f.UseWebPdfViewer)};return r}(r.default);t.default=d});
define("odsp-next/utilities/logging/odc/UsageNames",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.Storage50GbPlanMonthly=1]="Storage50GbPlanMonthly";e[e.Storage50GbPlanAnnual=2]="Storage50GbPlanAnnual";e[e.OfficeHomeMonthly=3]="OfficeHomeMonthly";e[e.OfficeHomeAnnual=4]="OfficeHomeAnnual";e[e.OfficePersonalMonthly=5]="OfficePersonalMonthly";e[e.OfficePersonalAnnual=6]="OfficePersonalAnnual";e[e.OfficeTrial=7]="OfficeTrial";e[e.OfficeOffer1YearFree=8]="OfficeOffer1YearFree";e[e.OfficeSolo=9]="OfficeSolo";e[e.OfficeHomeLearnMore=10]="OfficeHomeLearnMore";e[e.OfficePersonalLearnMore=11]="OfficePersonalLearnMore";e[e.ChangeCurrency=12]="ChangeCurrency";e[e.OfficePersonalTermsAndConditions=13]="OfficePersonalTermsAndConditions";e[e.FeatureCardStorage=14]="FeatureCardStorage";e[e.FeatureCardProductivity=15]="FeatureCardProductivity";e[e.FeatureCardSecurity=16]="FeatureCardSecurity";e[e.FeatureCardSharing=17]="FeatureCardSharing";e[e.FeatureCardOfficeApps=18]="FeatureCardOfficeApps";e[e.LaunchFeatureCard=19]="LaunchFeatureCard";e[e.LaunchSeeAllFeatures=20]="LaunchSeeAllFeatures";e[e.MonthlyAnnualPriceToggle=21]="MonthlyAnnualPriceToggle";e[e.StoragePlanOnSlider=22]="StoragePlanOnSlider";e[e.OfficePersonalOnSlider=23]="OfficePersonalOnSlider";e[e.OfficeHomeOnSlider=24]="OfficeHomeOnSlider";e[e.SelectPlanOnSlider=25]="SelectPlanOnSlider";e[e.EmbedConfiguratorLinkShown=26]="EmbedConfiguratorLinkShown";e[e.EmbedConfiguratorClick=27]="EmbedConfiguratorClick";e[e.WhatsTakingUpSpace=28]="WhatsTakingUpSpace";e[e.SelectedOfficeHomeMonthly=29]="SelectedOfficeHomeMonthly";e[e.SelectedOfficePersonalMonthly=30]="SelectedOfficePersonalMonthly";e[e.PlansInterruptDialogAnnualOption=31]="PlansInterruptDialogAnnualOption";e[e.PlansInterruptDialogMonthlyOption=32]="PlansInterruptDialogMonthlyOption";e[e.PrintPdfNative=33]="PrintPdfNative";e[e.PrintPdfDownloadOptionShown=34]="PrintPdfDownloadOptionShown";e[e.PrintPdfDownloadOptionClicked=35]="PrintPdfDownloadOptionClicked";e[e.SharedViaFacebook=36]="SharedViaFacebook";e[e.SharedViaTwitter=37]="SharedViaTwitter";e[e.SharedViaLinkedIn=38]="SharedViaLinkedIn";e[e.SharedViaSinaWeibo=39]="SharedViaSinaWeibo";e[e.ShowPlansInterruptDialog=40]="ShowPlansInterruptDialog";e[e.ClosePlansInterruptDialog=41]="ClosePlansInterruptDialog";e[e.InterruptO365Clicked=42]="InterruptO365Clicked";e[e.InterruptOD50Clicked=43]="InterruptOD50Clicked";e[e.DownloadOfficeApps=44]="DownloadOfficeApps";e[e.QuotaUsageClick=45]="QuotaUsageClick"}(t.UsageName||(t.UsageName={}));!function(e){e[e.OfficePlansSection=1]="OfficePlansSection";e[e.StoragePlansSection=2]="StoragePlansSection";e[e.UpgradePage=3]="UpgradePage";e[e.BelowQuotaProgressBar=4]="BelowQuotaProgressBar";e[e.EmbedPane=5]="EmbedPane";e[e.OneUp=6]="OneUp";e[e.SharingDialog=7]="SharingDialog"}(t.LocationName||(t.LocationName={}))});
define("odsp-next/actions/saveAutoAlbum/odc/SaveAutoAlbumAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../utilities/features/Features","../../../models/item/VirtualItemType","../../../models/item/ItemHelper"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){n.__extends(i,t);function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="SaveAutoAlbum";n._isHidden=e.isHidden||!1;return n}i.prototype.getExecutorPath=function(){return"odsp-next/actions/saveAutoAlbum/odc/SaveAutoAlbumExecutor"};i.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/saveAutoAlbum/odc/SaveAutoAlbumExecutor"],t,n)})}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};i.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper,isHidden:this._isHidden}};i.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return s.isFeatureEnabled(s.EnableEvokeAlignments)&&e&&e.virtualItemType===o.default.Album&&(u.isAutoAlbum(e)||s.isFeatureEnabled(s.EvokeDev))};return i}(i.default);t.default=a});
define("odsp-next/actions/discardAutoAlbum/odc/DiscardAutoAlbumAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../base/templates/ExecutorAction","../../../utilities/features/Features","../../../models/item/VirtualItemType","../../../models/item/ItemHelper"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(t){n.__extends(i,t);function i(e){void 0===e&&(e={});var n=t.call(this,e)||this;n.name="DiscardAutoAlbum";return n}i.prototype.getExecutorPath=function(){return"odsp-next/actions/discardAutoAlbum/odc/DiscardAutoAlbumExecutor"};i.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/discardAutoAlbum/odc/DiscardAutoAlbumExecutor"],t,n)})}};i.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};i.prototype.getExecutorParameters=function(){return{selectionHelper:this.selectionHelper}};i.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem();return s.isFeatureEnabled(s.EnableEvokeAlignments)&&e&&e.virtualItemType===o.default.Album&&u.isAutoAlbum(e)};return i}(i.default);t.default=a});
define("odsp-next/actions/saveAutoAlbum/odc/ImplicitSaveAutoAlbumAction",["require","exports","tslib","../../../base/BaseAction"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.name="ImplicitSaveAutoAlbum";n._action=t.action;n._saveAutoAlbumAction=t.saveAutoAlbumAction;return n}t.prototype.onExecute=function(e,t){var n=this;return this._action.execute(e).then(function(t){n._saveAutoAlbumAction.isAvailable()&&n._saveAutoAlbumAction.execute(e);return t})};t.prototype.onIsAvailable=function(){return this._action.isAvailable()};return t}(r.default);t.default=i});
define("odsp-next/actions/vault/odc/VaultAction",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../../resources/ControlResourceKeys","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../base/templates/ExecutorAction","@ms/odsp-shared/lib/utilities/knockout/ObservablesFactory","../../../models/item/ItemParentHelper","../../../dataSources/vault/IVaultDataSource","../../../dataSources/vault/odc/VaultLogHelper","@ms/odsp-utilities/lib/logging/events/Qos.event","../VaultActionType","./VaultHelper","../../base/ItemSelectionHelper","../../../dataSources/url/PageType","../../../dataSources/url/QueryType","../../../utilities/browser/WebViewDetector"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=function(t){n.__extends(u,t);function u(e){var n=t.call(this,e)||this;n._itemParentHelper=n.resources.consume(f.resourceKey);n._itemSelectionHelper=new(n.child(v.typeResourceKey))({allowMultiSelect:!0,overrideItem:e.item});n._urlDataSource=n.resources.consume(s.url);n._viewParams=n.resources.consume(i.viewParams);n._vaultActionType=e.actionType;n._fixItUrl=e.fixItUrl;n._usePopup=e.usePopup;n._isGlobal=e.isGlobal;n._goPremiumSource=e.goPremiumSource;n._vaultHelper=new(n.managed(d.default))({item:e.item&&e.item.peek(),fixItUrl:e.fixItUrl,itemParentHelper:n._itemParentHelper});n._isVaultUnlocked=n.observables.createCallback(a.forSingleValue(!1));n._vaultFreState=n.observables.createCallback(a.forSingleValue(l.VaultFreState.NotCreated));n._isVaultDisabled=n.observables.createCallback(a.forSingleValue(!1));n.resources.isDefined(s.vault)&&n.resources.consumeAsync(s.vault).then(function(e){e.vaultStateSubscribe(n._isVaultUnlocked);e.vaultFreSubscribe(n._vaultFreState);e.vaultDisabledSubscribe(n._isVaultDisabled)});n._isOneDriveWinApp=y.isOneDriveWinApp();return n}u.prototype.getExecutorPath=function(){return"odsp-next/actions/vault/odc/VaultExecutor"};u.prototype.getModuleFactory=function(){return function(){return new r.default(function(t,n){e(["odsp-next/actions/vault/odc/VaultExecutor"],t,n)})}};u.prototype.getSelectionOptions=function(){return{allowMultiSelect:!1,canFallback:!0}};u.prototype.onIsAvailable=function(){var e=this.selectionHelper.firstItem(),t=e&&this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"vault"));if(this._isVaultDisabled())return!1;if(this._vaultActionType===p.default.ShowFiles){var n=this._itemSelectionHelper.currentItem(),r=this._urlDataSource.getKeyParams(n.key);return this._urlDataSource.getQueryType(r)===g.default.RecycleBin&&this._vaultFreState()===l.VaultFreState.FreShown&&!this._isOneDriveWinApp&&!this._isVaultUnlocked()}if(this._vaultActionType===p.default.Unlock)return!!(t&&t.vault&&t.vault.isLocked);if(this._vaultActionType===p.default.Lock){var i=this._isGlobal&&this._isVaultUnlocked(),s=e&&e.vault&&e.vault.root&&!e.vault.isLocked;return!(!i&&!s)}return t&&!t.error||this._isVaultUnlocked()};u.prototype.getExecutorParameters=function(){return{actionType:this._vaultActionType,fixItUrl:this._fixItUrl,usePopup:this._usePopup,isPickerPage:this._isPickerPage,goPremiumSource:this._goPremiumSource}};u.prototype.onExecute=function(e,n){var i=this._urlDataSource.getPageType(this._viewParams.peek());this._isPickerPage=i===m.default.FilePicker||i===m.default.FolderPicker;o.Engagement.logData({name:"Vault."+c.getVaultActionName(this._vaultActionType),extraData:{location:c.getPageName(i)}});if(this._vaultActionType===p.default.Unlock&&this._usePopup&&!this._isOneDriveWinApp&&!this._isPickerPage){var s=this._vaultFreState.peek();if(s===l.VaultFreState.BubbleShown||s===l.VaultFreState.Created){this._vaultActionType=p.default.FreDialog;return t.prototype.onExecute.call(this,e,n)}var u=this._vaultActionType.toString();return this._vaultHelper.unlockPopup().then(function(e){return e?r.default.resolve({name:u,resultType:h.ResultTypeEnum.Success}):r.default.reject({name:u,resultType:h.ResultTypeEnum.Failure})})}return t.prototype.onExecute.call(this,e,n)};return u}(u.default);t.default=b});
define("odsp-next/dataSources/vault/IVaultDataSource",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.NotCreated=-1]="NotCreated";e[e.Created=0]="Created";e[e.BubbleShown=1]="BubbleShown";e[e.FreShown=2]="FreShown"}(t.VaultFreState||(t.VaultFreState={}));t.STORAGE_KEY_VAULT_PREFIX="oneDriveVault";t.STORAGE_KEY_VAULT_CANARY="canary";t.VAULT_FREE_FILE_LIMIT=3});
define("odsp-next/dataSources/vault/odc/VaultLogHelper",["require","exports","../../url/PageType"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=["","Lock","Unlock","Manage","FreDialog","ShowFiles","Reset","Debug","FilesRemaining"];t.VAULT_GOPREMIUM_SOURCE_ICONCOMMAND="PVault-IconUpsell";t.VAULT_GOPREMIUM_SOURCE_QUOTABANNERLEARNMORE="PVault-QuotaBannerLearnMore";t.VAULT_GOPREMIUM_SOURCE_QUOTABANNER="PVault-QuotaBannerGoPremium";t.getVaultActionName=function(e){return r[e]};t.getPageName=function(e){switch(e){case n.default.Files:return"Files";case n.default.Restore:return"Restore";case n.default.RansomwareDetection:return"RansomwareDetection";case n.default.ManageVault:return"ManageVault";default:return""}}});
define("odsp-next/actions/vault/odc/VaultHelper",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/logging/events/Engagement.event","../../../utilities/features/Features","../../../utilities/icons/Icon","../../../providers/dialog/DialogProvider","../../../dataSources/identity/odc/IdentityDataSource","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/Signal","../../../controls/htmlContainer/HTMLContainer","./VaultAction.resx","../../../dataSources/vault/odc/VaultDataSource.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._item=t.item;n._fixItUrl=t.fixItUrl;n._itemParentHelper=t.itemParentHelper;n._identityDataSource=n.resources.consume(a.resourceKey);return n}t.prototype.unlockPopup=function(){this._unlockSignal=new c.default;this.events.on(window,"message",this._onReceivedMessage);this._showPopupNotice();this._createLoginPopup();return this._unlockSignal.getPromise()};t.prototype._onReceivedMessage=function(e){var t=this;if(this._loginPopup&&e.origin===window.location.origin&&e.data){var n=void 0;try{n=JSON.parse(e.data)}catch(e){}if(n&&n.isVault){this.async.clearInterval(this._popupInterval);this._popupInterval=0;var r=new l.Qos({name:"VaultHelper.FinalizeUnlock"});if(n.success){n.canary&&(FilesConfig.canary=n.canary);n.navCanary&&(FilesConfig.navCanary=n.navCanary);this.resources.consumeAsync(d.resourceKey).then(function(e){e.unlockVault().then(function(){r.end({resultType:l.ResultTypeEnum.Success});t._popupNoticeDialog.complete();t._unlockSignal.complete(n.success);t._loginPopup.close();t._loginPopup=null}).catch(function(){r.end({resultType:l.ResultTypeEnum.Failure,resultCode:"UnlockSessionMismatch",error:n.error&&n.error.message||"Unknown"});t._showUnlockError()})})}else{r.end({resultType:l.ResultTypeEnum.Failure,resultCode:"UnlockFailure",error:n.error&&n.error.message||"Unknown"});this._showUnlockError()}}}};t.prototype._showUnlockError=function(){this._popupNoticeDialogText(p.strings.popupNoticeText+'<p class="ms-fontColor-error">'+p.strings.popupNoticeFailureText+"<p>");this._unlockSignal.complete(!1);if(this._loginPopup){this._loginPopup.close();this._loginPopup=null}};t.prototype._createLoginPopup=function(){var e,t=this.unwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(this._item,"vault","root"));e=s.isFeatureEnabled(s.ProjectVForceSAScope)?this._identityDataSource.getAuthUrl("msa_strong_auth:"):(e=this._fixItUrl||"/unlock?id="+(t&&t.id||""))+"&v=unlock&popup=1&force=1&ru="+encodeURIComponent(window.location.href);var n=window.screenX,r=window.screenY,i=window.outerWidth,o=window.outerHeight,u=n+Math.max(i-500,0)/2,a=r+Math.max(o-500,0)/2;this._loginPopup=window.open(e,"vaultPopup","width=500,height=500,top="+a+",left="+u+",status=no,resizeable=yes,toolbar=no,menubar=no,scrollbars=yes");this._monitorLoginPopup()};t.prototype._monitorLoginPopup=function(){var e=this;this._popupInterval||(this._popupInterval=this.async.setInterval(function(){if(e._loginPopup)if(e._loginPopup.closed){e.async.clearInterval(e._popupInterval);e._popupInterval=0}else try{e._loginPopup.postMessage("updating reference of parent to support navigations in auth popup",window.location.origin)}catch(t){if(t&&"TypeError"===t.name){i.Engagement.logData({name:"Vault.VerificationNeeded.Blocked"});e._loginPopup=null}}else{e.async.clearInterval(e._popupInterval);e._popupInterval=0}},500))};t.prototype._showPopupNotice=function(){var e=this;if(!this._popupNoticeDialog||1!==this._popupNoticeDialog.state.peek()){var t=this.resources.consume(u.resourceKey),n=p.strings.popupNoticeTitle;this._popupNoticeDialogText=this.observables.create(p.strings.popupNoticeText);this._popupNoticeDialog=t.requestDialog({title:n,isSoftDismissable:!1,component:{name:h.default.tagName,params:{html:this._popupNoticeDialogText}},actions:[{name:p.strings.popupNoticeLinkText,execute:function(){return e.onDialogExecute()},isAvailable:this.observables.create(!0),icon:new o.default("CheckMark"),isDefault:!0}]});this._logVaultEvent("Vault.VerificationNeeded.Shown");this._popupNoticeDialog.wait().catch(function(){if(e._loginPopup&&3===e._popupNoticeDialog.state.peek()){e._logVaultEvent("Vault.VerificationNeeded.Dismiss");e._unlockSignal.cancel();e._loginPopup.close();e._loginPopup=null}});this._popupNoticeDialog.wait().then(function(){e._loginPopup&&2===e._popupNoticeDialog.state.peek()&&e._logVaultEvent("Vault.VerificationNeeded.Succeeded")})}};t.prototype.onDialogExecute=function(){this._logVaultEvent("Vault.VerificationNeeded.ShowPopup");if(this._loginPopup&&!this._loginPopup.closed)try{this._loginPopup.focus()}catch(e){}else this._createLoginPopup();return f.default.resolve(1)};t.prototype._logVaultEvent=function(e){i.Engagement.logData({name:e})};return t}(r.default);t.default=v});
define("odsp-next/controls/htmlContainer/HTMLContainer",["require","exports","./HTMLContainerViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./HTMLContainer.html"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"ms-html-container",template:e("./HTMLContainer.html"),viewModel:n.default});t.default=i});
define("odsp-next/controls/htmlContainer/HTMLContainerViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.html=t.html;return n}return t}(r.default);t.default=i});
define("odsp-next/controls/htmlContainer/HTMLContainer.html",[],function(){return'<div class=HTMLContainer data-bind="html: html"></div>'});
define("odsp-next/actions/showShareMultiItem/ShowShareMultiItemAction",["require","exports","tslib","@ms/odsp-utilities/lib/logging/events/Qos.event","../../resources/DataSourceResourceKeys","../../base/BaseAction","../base/ItemSelectionHelper","@ms/odsp-utilities/lib/async/Promise","../base/ItemCommandHelper","../../models/item/command/SocialItemCommandKeys","../../dataSources/url/QueryType","../base/ItemRedeemer"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._itemRedeemer=new(n.managed(c.default));n._itemsBeingShared=t.focusItems;n._selectionHelper=new(n.child(o.typeResourceKey))({overrideItem:null,allowMultiSelect:!0,canFallback:!0});n._urlDataSource=n.resources.consume(i.url);n._itemCommandHelper=n.resources.consume(a.resourceKey);n.name="ShowShareMultiItemAction";return n}t.prototype.onIsAvailable=function(){var e=this._selectionHelper.firstItem();if(!e)return!1;var t=this._selectionHelper.selection().length,n=t>1&&e.queryType===l.default.SharedWithMe&&e.isRootFolder,r=t>1&&e.isAlbum,i=this._urlDataSource.isRecycleBin(e.queryType);return this._itemCommandHelper.isCommandSupported(e,f.share)&&!n&&!r&&!i};t.prototype.onExecute=function(e,t){var n=this;this._itemsBeingShared.peek()&&this._itemsBeingShared(void 0);var i=this._selectionHelper.selection().map(function(e){return e.peek()});return this._itemRedeemer.redeemItems(i,this).then(function(){n._itemsBeingShared(i);return u.default.wrap({resultType:r.ResultTypeEnum.Success})},function(e){return u.default.reject(e)})};return t}(s.default);t.default=h});
define("odsp-next/dataSources/itemCommand/odc/ItemCommandDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../models/item/command/ItemCommand","../../item/odc/SkyApiCommands","../../../models/item/command/CoreItemCommandKeys","../../../models/item/command/SocialItemCommandKeys","../../../models/item/command/PhotoItemCommandKeys","../../../models/item/command/CustomizationItemCommandKeys","../../../models/item/command/FileSystemItemCommandKeys","../../../models/item/command/OfficeItemCommandKeys","../../../models/item/command/WebItemCommandKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p,d;var v=function(e){var t={};for(var n in e){var r=e[n];if(r instanceof Array)for(var i=0,s=r;i<s.length;i++){t[s[i].id]=n}else t[r.id]=n}return t}(((p={})[s.abdicatePermissions]=u.removeFromShared,p[s.addCoverPhoto]=f.addAsCoverPhoto,p[s.applyOfficeLens]=a.applyOfficeLens,p[s.addTag]=a.removeTags,p[s.addToAlbum]=[a.addToAlbum,a.editTags],p[s.addToSharedList]=u.addToShared,p[s.changeExpiration]=l.changeExpiration,p[s.comment]=u.comment,p[s.copy]=l.copyFrom,p[s.createExcel]=c.createExcel,p[s.createExcelSurvey]=c.createSurvey,p[s.createFolder]=l.createFolder,p[s.createMountPoint]=u.addAsMountPoint,p[s.createOneNote]=c.createOneNote,p[s.createPowerPoint]=c.createPowerPoint,p[s.createWord]=c.createWord,p[s.defaultClick]=o.defaultClick,p[s.deleteCommand]=l.deleteItem,p[s.download]=h.download,p[s.editSurvey]=c.editSurvey,p[s.embed]=u.embed,p[s.emptyRecycleBin]=l.deleteAllItems,p[s.modifyCaption]=a.editCaption,p[s.move]=l.moveFrom,p[s.openInOffice]=c.openInClient,p[s.openInTextEditor]=l.openInTextEditor,p[s.openPdfInBrowser]=l.openPdfInBrowser,p[s.playAudio]=a.play,p[s.rearrange]=f.rearrange,p[s.removeCoverPhoto]=f.removeAsCoverPhoto,p[s.removeFromAlbum]=a.removeFromAlbum,p[s.removeFromRecent]=f.removeFromRecent,p[s.removeMountPoint]=u.removeAsMountPoint,p[s.rename]=l.rename,p[s.removeOfficeLens]=a.removeOfficeLens,p[s.reportAbuse]=u.reportAbuse,p[s.requestReview]=u.requestReview,p[s.restore]=l.restoreItem,p[s.restoreAll]=l.restoreAllItems,p[s.rotate]=a.rotate,p[s.share]=[u.share,a.addPhotosToAlbum],p[s.shareSurvey]=c.publishSurvey,p[s.upload]=[h.upload,l.createText],p[s.viewInBrowser]=c.openOnline,p[s.viewOriginal]=a.viewOriginal,p[s.viewSurvey]=c.viewSurvey,p[s.viewVersions]=c.viewVersionHistory,p));var m={1:1,2:2,3:3,4:4,7:7,6:6,10:10,11:11,15:15,50:50},g={1:1,2:2,3:3,4:4,5:5,6:6,7:7},y={1:1,2:2},b=((d={})[s.openInTextEditor]=!0,d[s.openPdfInBrowser]=!0,d),w=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getCommand=function(e,t){var n,r=this._getCommandName(t);if(r){var s=this._getActionId(e,r);if(s)switch(t){case o.defaultClick:n=this._createDefaultClickCommand(s);break;case c.openInClient:n=this._createOpenInClientCommand(s);break;case c.createWord:case c.createExcel:case c.createPowerPoint:case c.createOneNote:n=this._createCreateDocumentCommand(s);break;default:n=new i.default}else this._isGeneralSupportedCommand(r)&&(n=new i.default)}return n};t.prototype._getActionId=function(e,t){var n;e&&e.properties&&e.properties.commandsSupported&&(n=e.properties.commandsSupported[t]);return n};t.prototype._isGeneralSupportedCommand=function(e){return b[e]};t.prototype._getCommandName=function(e){return function(e){return v[e.id]}(e)};t.prototype._createDefaultClickCommand=function(e){var t=m[e]||0;return new i.default({behavior:t})};t.prototype._createOpenInClientCommand=function(e){var t=g[e]||0;return new i.default({behavior:t})};t.prototype._createCreateDocumentCommand=function(e){var t=y[e]||0;return new i.default({behavior:t})};return t}(r.default);t.default=w});
define("odsp-next/models/item/command/ItemCommand",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){void 0===e&&(e={});var t=e.behavior;this.behavior=t};t.default=n});
define("odsp-next/dataSources/processFilters/odc/ProcessFiltersDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../base/vroom/VroomDataRequestor"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s;!function(e){e[e.OfficeLens=0]="OfficeLens"}(s||(s={}));var o=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});return e.call(this,t)||this}t.prototype.applyOfficeLens=function(e){var t=this.resources.consume(i.resourceKey),n={name:s[s.OfficeLens]};return t.send({apiName:"lenses",path:"/drive/items/"+e.item.id+"/lenses",requestType:"POST",postData:JSON.stringify(n)})};t.prototype.removeOfficeLens=function(e){return this.resources.consume(i.resourceKey).send({apiName:"lenses",path:"/drive/items/"+e.item.id+"/lenses/"+s[s.OfficeLens],requestType:"DELETE"})};return t}(r.default);t.default=o});
define("odsp-next/providers/processFilters/ProcessFiltersProvider",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","../../resources/DataSourceResourceKeys","../item/ItemProvider","../../models/task/Task"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._processFiltersDataSource=n.resources.consume(s.processFilters);n._itemProvider=n.resources.consume(o.resourceKey);return n}t.prototype.applyOfficeLens=function(e,t){return this._updateOfficeLens(e,t,this._processFiltersDataSource.applyOfficeLens.bind(this))};t.prototype.removeOfficeLens=function(e,t){return this._updateOfficeLens(e,t,this._processFiltersDataSource.removeOfficeLens.bind(this))};t.prototype._updateOfficeLens=function(e,t,n){var i=this,s=[new u.default(e.item.key,e.item)];t.update(s);return n(e).then(function(){i._itemProvider.invalidateItem(e.parentKey);i._itemProvider.invalidateItem(e.item.key,{triggerFetch:!0});s=s.map(function(e){return e.succeed()});t.update(s)},function(e){s=s.map(function(t){return t.fail(e)});t.update(s);return r.default.wrapError(e)})};return t}(i.default);t.default=a});
define("odsp-next/utilities/experiment/ExperimentHelper",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../features/Features","@ms/odsp-utilities/lib/logging/events/Experiment.event","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../resources/ProviderResourceKeys","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c,h=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._navigation=n.resources.consume(u.navigation);n._userInfoProvider=n.resources.consume(a.userInfo);return n}t.prototype.isExperimentManualTest=function(e){return!!this._navigation.viewParams["EXPExperimentTest_e"+e]};t.prototype.isInapplicableEnvironment=function(){var e="edog"===(window._spPageContextInfo&&window._spPageContextInfo.env);return!(!window.$Config||!window.$Config.isINT)||e};t.prototype.startEXPExperimentBehindFeature=function(e,t){var n=this,o=t.experimentId,u=t.experimentName,a=t.variationMap,f=t.getVariationFunction;if(i.isFeatureEnabled(e)){if(this.isExperimentManualTest(o)){var l=this._navigation.viewParams["EXPExperimentTest_e"+o],c=Number(l);return isNaN(c)||!a[c]?r.default.wrap(0):r.default.wrap(c)}return this.getExperimentVariation(o,f).then(function(t){t&&!n.isInapplicableEnvironment()&&s.default.logData({name:e.ODC?String(e.ODC):String(e.ODB),isInRamp:!0,experiment:u,variant:a[t]&&a[t].name});return t})}return r.default.wrap(0)};t.prototype.getExperimentVariation=function(e,t){var n=this;return this._userInfoProvider.getEXPExperimentVariation(e).then(function(s){if(s)return r.default.wrap(s);var o=n.resources.consume(f.identity.optional).getIdentity().id,u=t(o);new l.Qos({name:"ExpHelper.Assignment."+e}).end({resultType:l.ResultTypeEnum.Success,resultCode:"Variation."+u});return i.isFeatureEnabled(i.ExpFactCleanup)?n._userInfoProvider.setEXPExperimentVariation(e,u,p).then(function(e){return e?r.default.wrap(u):r.default.wrap(0)}):n._userInfoProvider.setEXPExperimentVariation(e,u).then(function(e){return e?r.default.wrap(u):r.default.wrap(0)})})};return t}(o.default);t.default=h;!function(e){e[e.QuotaUxRevision=1]="QuotaUxRevision";e[e.QuotaUxRevisionAA=2]="QuotaUxRevisionAA";e[e.QuotaUxRevision2=3]="QuotaUxRevision2";e[e.QuotaUxRevisionAA2=4]="QuotaUxRevisionAA2";e[e.Iconography=219512403]="Iconography";e[e.ReaectShell=631936892]="ReaectShell";e[e.Unknown1=313862562]="Unknown1";e[e.Unknown2=758340426]="Unknown2";e[e.Unknown3=860081470]="Unknown3";e[e.Unknown4=860647394]="Unknown4";e[e.Unknown5=911653430]="Unknown5";e[e.Unknown6=973349173]="Unknown6"}(c=t.ExperimentId||(t.ExperimentId={}));var p=[c.QuotaUxRevision,c.QuotaUxRevisionAA,c.QuotaUxRevision2,c.QuotaUxRevisionAA2,c.Iconography,c.ReaectShell]});
define("odsp-next/utilities/educationAndUpsells/EducationAndUpsells",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/async/Promise","../../providers/inAppMessaging/InAppMessagingProvider.key"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new i.ResourceKey("EducationAndUpsells");var f=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(o.url);var r=n.resources.consume(s.navigation);n._newUserOverride=r.viewParams.forceNewUser;return n}t.prototype.getExistingUserTypeOfPremiumUpsell=function(e,t,n){var r=this;void 0===n&&(n=!1);return this._checkIsRootAndValid(e,t)?this.getIsNewUser(e,t).then(function(e){return e?u.default.wrap():r.resources.consumeAsync(a.resourceKey).then(function(e){return e.getPremiumUpsellType()})}):u.default.wrap()};t.prototype.getAreNoFilesAdded=function(e){if(this._newUserOverride)return!0;for(var t=0,n=0,r=0,i=e.content().items;r<i.length;r++){var s=i[r];if(void 0===s)return!1;if(s().folder){t++;if(s().childCount>0)return!1}else n++;if(t>2||n>1)return!1}return!0};t.prototype.getIsNewUser=function(e,t){return this._checkIsRootAndValid(e,t)?this.resources.consumeAsync(a.resourceKey).then(function(e){return e.isAnyMessageActive(206)}):u.default.wrap(!1)};t.prototype._checkIsRootAndValid=function(e,t){return e.key===this._urlDataSource.getRootItemKey()&&!t.isPlaceholder&&!t.isExpired};return t}(r.default);t.default=f});
define("odsp-next/providers/inAppMessaging/InAppMessagingProvider.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./InAppMessagingProvider"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/teachingBubble/odc/TeachingBubbleDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getMaxDisplayBubbleCount=function(){return 1};return t}(r.default);t.default=i});
define("odsp-next/dataSources/recycleBin/odc/RecycleBinDataSource",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../resources/DataSourceResourceKeys","@ms/odsp-utilities/lib/graft/Graft","../../../models/item/ItemType","../../../models/item/OneDriveItem","../../../dataSources/url/QueryType"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(i.url);return n}t.prototype.getRecycleBinItem=function(e){var t=this._urlDataSource.getRootItemKey(a.default.RecycleBin),n=new u.default(t);s.default(n,{key:t,queryType:a.default.RecycleBin,properties:{commandsSupported:{defc:"1"}},type:o.default.Folder,isRootFolder:!0});return n};return t}(r.default);t.default=f});
define("odsp-next/providers/recycleBin/RecycleBinProvider",["require","exports","tslib","../../resources/DataSourceResourceKeys","@ms/odsp-shared/lib/base/BaseModel"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._dataSource=n.resources.consume(r.recycleBin);return n}t.prototype.getRecycleBinItem=function(e){return this._dataSource.getRecycleBinItem(e)};return t}(i.default);t.default=s});
define("odsp-next/providers/dragAndDropRobot/DragAndDropRobotProvider",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../controls/dragAndDrop/dragAndDropHint/DragAndDropHint"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){void 0===t&&(t={});return e.call(this,t)||this}t.prototype.getGridHintComponent=function(e,t){return t()?{component:this._getDragAndDropHintComponent(e,t),aspectRatio:2}:null};t.prototype.getFooterHintComponent=function(e,t){return t()&&e()?null:this._getDragAndDropHintComponent(e,t)};t.prototype._getDragAndDropHintComponent=function(e,t){return{name:i.default.tagName,params:{isRobotVisible:t(),isGridView:e()}}};return t}(r.default);t.DragAndDropRobotProvider=s;t.default=s});
define("odsp-next/controls/dragAndDrop/dragAndDropHint/DragAndDropHint",["require","exports","./DragAndDropHintViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./DragAndDropHint.html","./DragAndDropHint.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-drag-and-drop-hint",template:e("./DragAndDropHint.html"),viewModel:n.default});t.default=i});
define("odsp-next/controls/dragAndDrop/dragAndDropHint/DragAndDropHintViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","../DragAndDrop.resx","@ms/odsp-utilities/lib/browser/PlatformDetection.key","../../../providers/engagement/Engagement","../../../utilities/dragAndDropRobot/DragAndDropAnimationHelper.key","../../../controls/firstRunExperience/FirstRunExperienceStatus.key","../../../controls/firstRunExperience/FirstRunExperienceStatus","../../../resources/ControlResourceKeys","../../../resources/ProviderResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p="DragAndDropRobot",d=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._actionMap=n.resources.consume(c.actionMap);n._isItemSetRendered=n.resources.consume(c.isItemSetRendered);n._platformDetection=n.resources.consume(o.platformDetection);n._bundleLoader=n.resources.consume(h.bundleLoader);var r=n.resources.consume(u.resourceKey),a=new(n.managed(n._actionMap.UploadAction))({uploadProcessorType:i.UploadProcessorType.Html5file});n._isUploadAvailable=a.isAvailable;n._firstRunExperienceStatus=n.resources.consume(f.resourceKey);n.isGridView=t.isGridView;n.showDropHint=n.createPureComputed(n._computeShowDropHint);n.dropSuggestionText=n.isRobotVisible?s.strings.DragAndDropHintEmptyRobotText:s.strings.DragAndDropHintText;n.fileImageUrl=typeof window.require.toUrl("odsp-media/images/odrobot/dragfilegrid.svg");n.isAnimationApplicable=!1;n.isAnimationClassApplicable=n.createObservable(!1);n.isReady=n.createObservable(!1);n.isRobotVisible=t.isRobotVisible;if(n.isRobotVisible){n.createBackgroundComputed(n._computeShowRobotAnimation);n.robotImageUrl=n.createPureComputed(n._computeRobotImageUrl)}else n.isReady(!0);n.createBackgroundComputed(function(){n.showDropHint()&&n.isRobotVisible&&r.logData({name:p+".Show",extraData:{isGridView:n.isGridView}})});return n}t.prototype._computeShowRobotAnimation=function(){var e=this;this._isBundleLoaded=this._bundleLoader.getBundleInfo(1).isLoaded();this.resources.consumeAsync(a.resourceKey).then(function(t){if(e._isBundleLoaded)if(!t.getInitialized()&&e.isRobotVisible&&e._firstRunExperienceStatus()!==l.FirstRunExperienceStatus.visible){t.setIsInitialized(!0);t.setIntializeTime();e.isAnimationApplicable=!0;e._setAnimationTimer();e.isReady(!0)}else if(t.getInitialized()){e.isAnimationApplicable=!0;e.isReady(!0);e._setAnimationTimer()}})};t.prototype._computeShowDropHint=function(){return this._isUploadAvailable()&&!this._platformDetection.isMobile&&this._isItemSetRendered()&&this.isReady()};t.prototype._setAnimationTimer=function(){var e=this;this.async.setTimeout(function(){e.isAnimationClassApplicable(!0)},500)};t.prototype._computeRobotImageUrl=function(){if(this.isReady()){return"url('"+window.require.toUrl("odsp-media/images/odrobot/"+(this.isAnimationApplicable?"robotlistv2.gif":"robotlistv2.svg"))+"')"}return""};return t}(r.default);t.default=d});
define("odsp-next/utilities/dragAndDropRobot/DragAndDropAnimationHelper.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id+".dragAndDropAnimationHelper",loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./DragAndDropAnimationHelper"],t,n)}).then(function(e){return e.resourceKey})})});t.default=t.resourceKey});
define("odsp-next/controls/dragAndDrop/dragAndDropHint/DragAndDropHint.html",[],function(){return"\x3c!--ko if: showDropHint()--\x3e<div class=od-DragAndDropHint data-bind=\"css: { 'od-DragAndDropHint--grid': isGridView, 'ms-slideLeftIn40': isAnimationClassApplicable() && isGridView, 'ms-slideUpIn20': isAnimationClassApplicable() && !isGridView, 'is-animating': isReady() && (isAnimationApplicable && !isAnimationClassApplicable()) }\"><div class=od-DragAndDropHint-box data-bind=\"css: { 'od-DragAndDropHint-box--grid': isGridView, 'od-DragAndDropHint-box--robot': isRobotVisible }\">\x3c!--ko if: isGridView--\x3e<div class=od-DragAndDropHint-fileContainer><img class=od-DragAndDropHint-file data-bind=\"attr: { src: fileImageUrl }\"></div>\x3c!--/ko--\x3e<div class=od-DragAndDropHint-text data-bind=\"text: dropSuggestionText, css: { 'od-DragAndDropHint-text--grid': isGridView }\"></div></div>\x3c!--ko if: isRobotVisible--\x3e<div class=od-DragAndDropHint-robot data-bind=\"style: { 'background-image': robotImageUrl }, css: { 'od-DragAndDropHint-robot--grid': isGridView, 'od-DragAndDropHint-robotAnimation': isReady() && isAnimationApplicable }\"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e"});
define("odsp-next/controls/dragAndDrop/dragAndDropHint/DragAndDropHint.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-DragAndDropHint-box{font-size:14px;font-weight:400;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";text-align:center;box-sizing:border-box}.od-DragAndDropHint-file{height:80%;top:50%;-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);position:absolute;width:100%}html[dir=ltr] .od-DragAndDropHint-file{left:50%}html[dir=rtl] .od-DragAndDropHint-file{right:50%}.od-DragAndDropHint-fileContainer{width:100%;height:74%;position:relative}.od-DragAndDropHint-robot{height:173px;width:100%;background-repeat:no-repeat;background-position:center center;background-size:auto 100%;margin-top:12px}.od-DragAndDropHint-box--robot{border:2px dashed "},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-DragAndDropHint-robot--grid{display:inline-block;margin:0;background-position:-25px;background-size:auto 100%;width:45%;vertical-align:top}.od-DragAndDropHint--grid{height:100%;width:100%;position:relative}.od-DragAndDropHint-box--grid{height:100%;width:54%;display:inline-block;vertical-align:top}.od-DragAndDropHint-text--grid{padding:4px 5px;font-size:15px;overflow:hidden;width:100%;display:inline-block;box-sizing:border-box;text-overflow:ellipsis;height:40%}.od-DragAndDropHint.is-animating{opacity:0}.od-DragAndDropHint-robotAnimation.od-DragAndDropHint-robot--grid{background-size:auto 106%}"}])});
define("odsp-next/dataSources/winApp/wip/odc/WIPDataSource",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/browser/PlatformDetection.key"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this._isWinAppWipEnabled=t.platformDetection.isWinAppWipEnabled}e.prototype.isWIPEnabled=function(){return this._isWinAppWipEnabled};return e}();t.default=i;t.resourceKey=n.createResolvedResourceKey(e("module").id,i,{platformDetection:r.platformDetection})});
define("odsp-next/controls/list/columns/ListColumns",["require","exports","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.columnMenuHelperTypeResourceKey=new r.ResourceKey({name:e("module").id+".columnMenuHelperType",loader:new r.AliasResourceLoader(function(){return n.default.resolve(new Promise(function(t,n){e(["../../columnsHeader/ColumnMenuHelper"],t,n)})).then(function(e){return e.typeResourceKey.local})})});t.addColumnCommandHelperTypeResourceKey=new r.ResourceKey({name:e("module").id+".addColumnCommandHelperType",loader:new r.AliasResourceLoader(function(){return n.default.resolve(new Promise(function(t,n){e(["../../columnsHeader/AddColumnCommandHelper"],t,n)})).then(function(e){return e.typeResourceKey.local})})})});
define("odsp-next/dataSources/pushChannel/odc/PushChannelDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./PushChannelDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/providers/pushChannel/PushChannelProvider.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./PushChannelProvider"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/rootItems/odc/RootItems.key",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../item/ItemTaskObserver","../../../models/item/ItemType","../../../dataSources/url/QueryType","../../../resources/DataSourceResourceKeys","../../item/ItemTaskObserver","../../../models/store/ItemsStore",".././RootItemsTypeFilter.key","../../../controls/leftPane/LeftPane.resx"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p={itemTaskObserverType:f.resourceKey,itemsStore:l.resourceKey,observablesFactoryType:r.observablesFactoryTypeResourceKey,rootItemsTypeFilter:c.resourceKey.optional,urlDataSource:a.url};t.resourceKey=new i.ResourceKey({name:e("module").id+".rootItems",factory:{dependencies:p,create:function(e){var t=e.itemsStore,r=e.rootItemsTypeFilter,i=e.urlDataSource,a=new e.observablesFactoryType,f=new e.itemTaskObserverType,l=i.getKey(n.__assign({},i.getKeyParams(i.getRootItemKey(u.default.Files)),i.saveItemTypeFilter(r))),c=i.getKey(n.__assign({},i.getKeyParams(i.getRootItemKey(u.default.Recent)),i.saveItemTypeFilter(r))),p=i.getKey(n.__assign({},i.getKeyParams(i.getRootItemKey(u.default.AllMyPhotos))));f.update([new s.Task(l).succeed({item:{key:l,name:s.Graft.backup(h.strings.Files),displayName:s.Graft.backup(h.strings.Files),type:s.Graft.backup(o.default.Folder),properties:{commandsSupported:{defc:"1"}}}}),new s.Task(c).succeed({item:{key:c,name:s.Graft.backup(h.strings.Recent),displayName:s.Graft.backup(h.strings.Recent),type:s.Graft.backup(o.default.Folder),properties:{commandsSupported:{defc:"1"}}}}),new s.Task(p).succeed({item:{key:p,name:s.Graft.backup(h.strings.Photos),displayName:s.Graft.backup(h.strings.Photos),type:s.Graft.backup(o.default.Folder),displayType:s.Graft.backup(u.default.AllMyPhotos),properties:{commandsSupported:{defc:"1"}}}})]);f.flush();return{instance:a.create({files:t.getItem(l),recent:t.getItem(c),photos:t.getItem(p)}),disposable:a}}}})});
define("odsp-next/dataSources/rootItems/RootItemsTypeFilter.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey(e("module").id)});
define("odsp-next/dataSources/itemAutoRefresh/odc/ItemAutoRefreshDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemAutoRefreshDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/providers/itemAutoRefresh/ItemAutoRefreshProvider.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemAutoRefreshProvider"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/inAppMessaging/odc/InAppMessagingDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./InAppMessagingDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/mruRecent/odc/MruRecentDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./MruRecentDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/itemActivityFeed/helper/odc/ItemActivityFeedHelper.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemActivityFeedHelper"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/winApp/communication/odc/WinAppCommunicatorDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./WinAppCommunicatorDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/providers/winApp/keyboardHelper/WinAppKeyboardHelper.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./WinAppKeyboardHelper"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/providers/quota/WinAppQuotaProvider.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./WinAppQuotaProvider"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/providers/profilechangehandler/ProfileChangeHandler.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ProfileChangeHandler"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/resources/FloodgateResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.floodgateAppId=new n.ResourceKey("floodgate.appId")});
define("odsp-next/dataSources/infoPane/InfoPaneManager.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeResourceKey=new n.ResourceKey(e("module").id)});
define("odsp-next/dataSources/infoPane/odc/InfoPaneManager.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.typeResourceKey=new n.ResourceKey({name:""+e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./InfoPaneManager"],t,n)}).then(function(e){return e.typeResourceKey})})})});
define("odsp-next/dataSources/item/ItemCacheToKOStoreDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey("IItemCacheToKOStoreDataSource")});
define("odsp-next/dataSources/item/od/ItemCacheToKOStoreDataSource.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemCacheToKOStoreDataSource"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/controls/itemsScope/odc/DefaultClickActionControlHandler.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./DefaultClickActionControlHandler"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/itemInvalidator/odc/ItemInvalidator.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemInvalidator"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/controls/itemsScope/ItemsScopeControlHandlerResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.defaultClickHandler=new n.ResourceKey("itemsScopeControlHandler.defaultClickHandler");t.userHoverCard=new n.ResourceKey("itemsScopeControlHandler.userHoverCard");t.locationHoverCard=new n.ResourceKey("itemsScopeControlHandler.locationHoverCard");t.itemHoverCard=new n.ResourceKey("itemsScopeControlHandler.itemHoverCard");t.itemSetColumns=new n.ResourceKey("itemsScopeControlHandler.itemSetColumns");t.missingMetadataField=new n.ResourceKey("itemsScopeControlHandler.missingMetadataField");t.sharedFieldClickAction=new n.ResourceKey("itemsScopeControlHandler.sharedFieldClickAction");t.itemExecuteFlowAction=new n.ResourceKey("itemsScopeControlHandler.itemExecuteFlowAction");t.itemEditPropsAction=new n.ResourceKey("itemsScopeControlHandler.itemEditPropsAction");t.syncAction=new n.ResourceKey("itemsScopeControlHandler.syncAction");t.switchLayoutAction=new n.ResourceKey("itemsScopeControlHandler.switchLayoutAction");t.createListItemAction=new n.ResourceKey("itemsScopeControlHandler.createListItemAction");t.hoverCardCommands=new n.ResourceKey("itemsScopeControlHandler.hoverCardCommands");t.moveCopyAction=new n.ResourceKey("itemsScopeControlHandler.moveCopyAction");t.uploadItemsAction=new n.ResourceKey("itemsScopeControlHandler.uploadItemsAction")});
define("odsp-next/controls/itemsScope/od/ItemsScopeControlHandlerResourceKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-utilities/lib/async/Promise"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemSetColumns=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return r.default.resolve(new Promise(function(t,n){e(["./ItemSetColumnsControlHandler"],t,n)})).then(function(e){return e.resourceKey})})})});
define("odsp-next/models/itemCache/ItemCacheConfiguration.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey("IItemCacheConfiguration")});
define("odsp-next/models/itemCache/od/ItemCacheConfiguration.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemCacheConfiguration"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/models/itemsScope/ItemsScopeAddon.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey("ItemsScopeAddon")});
define("odsp-next/models/itemsScope/od/ItemsScopeAddon.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemsScopeAddon"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/models/itemsScope/ItemsScopeKeyConverter.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey("IItemsScopeKeyConverter")});
define("odsp-next/models/itemsScope/od/ItemsScopeKeyConverter.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemsScopeKeyConverter"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/controls/shim/base/Base.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".c_ic_hide{display:none}.c_clr{clear:both}.NotificationBase .t_sela,.NotificationBase.t_cbr{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.NotificationBase button,.NotificationBase input[type=button]{font-size:14px;font-weight:400;box-sizing:border-box;box-shadow:none;margin:0;padding:0;background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";border:1px solid "},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";cursor:pointer;display:inline-block;height:30px;min-width:80px;outline:0;padding:4px 20px 6px 20px}.NotificationBase textarea{padding:4px 8px;border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.NotificationBase input{border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.NotificationBase.UI_Dialog_ZoomTest{visibility:hidden}.NotificationBase.UI_Dialog_BG{height:100%;width:100%}.NotificationBase.ModalDialog{height:380px;width:860px;margin:auto}.NotificationBase.ModalDialog.UI_Dialog_BG{background-color:rgba(255,255,255,.5)!important;top:0;height:100%;width:100%}.NotificationBase.ModalDialog .OuterContainer{background-color:transparent}.NotificationBase.ModalDialog .InnerContainer{box-shadow:0 0 5px 0 "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";background-color:#fff;left:0!important;right:0!important;position:absolute!important;margin:auto!important}#sidebar{top:50px!important;z-index:298}#sidebar h1{font-size:17px;font-weight:300}#sidebar a.ContactTile,#sidebar a.FavoritesItem{overflow:visible}"}])});
define("odsp-next/controls/FabricIconsDeferred",["require","exports","../utilities/icons/fabric/index"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.initializeIcons(window.require.toUrl("odsp-media/fonts/"),{disableWarnings:!0})});
define("odsp-next/utilities/icons/fabric/index",["require","exports","./odsp-next-icons","./odsp-next-icons-0","./odsp-next-icons-1","./odsp-next-icons-2","./odsp-next-icons-3","./odsp-next-icons-4","./odsp-next-icons-5","./odsp-next-icons-6","./odsp-next-icons-7","./odsp-next-icons-8","./odsp-next-icons-9","./odsp-next-icons-10","./odsp-next-icons-11","./odsp-next-icons-12","./odsp-next-icons-13","./odsp-next-icons-14","./odsp-next-icons-15","./odsp-next-icons-16","./odsp-next-icons-17","./odsp-next-icons-18","./iconAliases"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x="https://spoprod-a.akamaihd.net/files/fabric/assets/icons/";t.initializeIcons=function(e,t){void 0===e&&(e=x);[n.initializeIcons,r.initializeIcons,i.initializeIcons,s.initializeIcons,o.initializeIcons,u.initializeIcons,a.initializeIcons,f.initializeIcons,l.initializeIcons,c.initializeIcons,h.initializeIcons,p.initializeIcons,d.initializeIcons,v.initializeIcons,m.initializeIcons,g.initializeIcons,y.initializeIcons,b.initializeIcons,w.initializeIcons,E.initializeIcons].forEach(function(n){return n(e,t)});S.registerIconAliases()}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-0",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-0"',src:"url('"+e+"odsp-next-icons-0-c18ff6a9.woff') format('woff')"},icons:{InternetSharing:"",Brightness:"",MapPin:"",Airplane:"",Tablet:"",QuickNote:"",Video:"",Phone:"",Shop:"",Stop:"",Link:"",AllApps:"",Zoom:"",ZoomOut:"",Microphone:"",Camera:"",Send:"",FavoriteList:"",PageSolid:"",Forward:"",Refresh:"",ReportHacked:"",EMI:"",MiniLink:"",Blocked:"",ReadingMode:"",Favicon:"",Remove:"",Checkbox:"",CheckboxComposite:"",CheckboxFill:"",CheckboxIndeterminate:"",CheckboxCompositeReversed:"",BackToWindow:"",FullScreen:"",Print:"",Up:"",Down:"",OEM:"",Save:"",ReturnKey:"",Cloud:"",Flashlight:"",CommandPrompt:"",Sad:"",RealEstate:"",SIPMove:"",EraseTool:"",GripperTool:"",Dialpad:"",PageLeft:"",PageRight:"",MultiSelect:"",KeyboardClassic:"",Play:"",Pause:"",InkingTool:"",Emoji2:"",GripperBarHorizontal:"",System:"",Personalize:"",SearchAndApps:"",Globe:"",EaseOfAccess:"",ContactInfo:"",Memo:"",IncomingCall:"",Paste:"",WindowsLogo:"",GripperBarVertical:"",Unlock:"",Slideshow:"",AutoEnhanceOn:"",AutoEnhanceOff:"",Color:"",SaveAs:"",Light:"",Filters:"",AspectRatio:"",Contrast:"",Redo:"",Crop:"",PhotoCollection:"",Album:"",Rotate:"",PanoIndicator:"",Translate:"",RedEye:"",ThumbnailView:"",Package:"",Telemarketer:"",Warning:"",Financial:"",Education:"",ShoppingCart:"",Train:"",Move:"",TouchPointer:"",Merge:"",TurnRight:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-1",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-1"',src:"url('"+e+"odsp-next-icons-1-e4b6522a.woff') format('woff')"},icons:{Ferry:"",Highlight:"",PowerButton:"",Tab:"",Admin:"",TVMonitor:"",Speakers:"",Game:"",UnstackSelected:"",StackIndicator:"",Nav2DMapView:"",StreetsideSplitMinimize:"",Car:"",Bus:"",EatDrink:"",SeeDo:"",LocationCircle:"",Home:"",SwitcherStartEnd:"",ParkingLocation:"",IncidentTriangle:"",Touch:"",MapDirections:"",CaretHollow:"",CaretSolid:"",Location:"",MapLayers:"",SearchNearby:"",Work:"",Recent:"",Hotel:"",Bank:"",LocationDot:"",Dictionary:"",ChromeBack:"",FolderOpen:"",PinnedFill:"",RevToggleKey:"",USB:"",Previous:"",Next:"",Sync:"",Help:"",Emoji:"",MailForward:"",ClosePane:"",OpenPane:"",PreviewLink:"",ZoomIn:"",Bookmarks:"",Document:"",ProtectedDocument:"",OpenInNewWindow:"",MailFill:"",ViewAll:"",Switch:"",Rename:"",Go:"",Remote:"",SelectAll:"",Orientation:"",Import:"",Picture:"",ChromeClose:"",ShowResults:"",Message:"",CalendarDay:"",CalendarWeek:"",MailReplyAll:"",Read:"",Cut:"",PaymentCard:"",Copy:"",Important:"",MailReply:"",GotoToday:"",Font:"",FontColor:"",FolderFill:"",Permissions:"",DisableUpdates:"",Unfavorite:"",Italic:"",Underline:"",Bold:"",MoveToFolder:"",Dislike:"",Like:"",AlignCenter:"",OpenFile:"",ClearSelection:"",FontDecrease:"",FontIncrease:"",FontSize:"",CellPhone:"",RepeatOne:"",RepeatAll:"",Calculator:"",Library:"",PostUpdate:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-2",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-2"',src:"url('"+e+"odsp-next-icons-2-05ed3546.woff') format('woff')"},icons:{NewFolder:"",CalendarReply:"",UnsyncFolder:"",SyncFolder:"",BlockContact:"",Accept:"",BulletedList:"",Preview:"",News:"",Chat:"",Group:"",World:"",DockLeft:"",DockRight:"",Repair:"",Street:"",RadioBullet:"",Stopwatch:"",Clock:"",WorldClock:"",AlarmClock:"",Photo:"",ActionCenter:"",Hospital:"",Timer:"",FullCircleMask:"",LocationFill:"",ChromeMinimize:"",ChromeRestore:"",Annotation:"",Fingerprint:"",Handwriting:"",ChromeFullScreen:"",Completed:"",Label:"",FlickDown:"",FlickUp:"",FlickLeft:"",FlickRight:"",MiniExpand:"",MiniContract:"",Streaming:"",MusicInCollection:"",OneDriveLogo:"",Code:"",LightningBolt:"",CalculatorMultiply:"",CalculatorSubtract:"",CalculatorPercentage:"",CalculatorEqualTo:"",PrintfaxPrinterFile:"",StorageOptical:"",Communications:"",Headset:"",Health:"",FrontCamera:"",ChevronUpSmall:"",ChevronDownSmall:"",ChevronUpMed:"",ChevronDownMed:"",Devices2:"",PC1:"",PresenceChickletVideo:"",Reply:"",HalfAlpha:"",ConstructionCone:"",DoubleChevronLeftMed:"",Volume0:"",Volume1:"",Volume2:"",Volume3:"",Chart:"",Robot:"",Manufacturing:"",LockSolid:"",FitPage:"",FitWidth:"",BidiLtr:"",BidiRtl:"",RightDoubleQuote:"",Sunny:"",CloudWeather:"",Cloudy:"",PartlyCloudyDay:"",PartlyCloudyNight:"",ClearNight:"",RainShowersDay:"",Rain:"",Thunderstorms:"",RainSnow:"",Snow:"",BlowingSnow:"",Frigid:"",Fog:"",Squalls:"",Duststorm:"",Unknown:"",Precipitation:"",Ribbon:"",AreaChart:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-3",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-3"',src:"url('"+e+"odsp-next-icons-3-f2148a98.woff') format('woff')"},icons:{Assign:"",FlowChart:"",CheckList:"",Diagnostic:"",Generate:"",LineChart:"",Equalizer:"",BarChartHorizontal:"",BarChartVertical:"",Freezing:"",FunnelChart:"",Processing:"",Quantity:"",ReportDocument:"",StackColumnChart:"",SnowShowerDay:"",HailDay:"",WorkFlow:"",HourGlass:"",StoreLogoMed20:"",TimeSheet:"",TriangleSolid:"",UpgradeAnalysis:"",VideoSolid:"",RainShowersNight:"",SnowShowerNight:"",Teamwork:"",HailNight:"",PeopleAdd:"",Glasses:"",DateTime2:"",Shield:"",Header1:"",PageAdd:"",NumberedList:"",PowerBILogo:"",Info2:"",MusicInCollectionFill:"",Asterisk:"",ErrorBadge:"",CircleFill:"",Record2:"",AllAppsMirrored:"",BookmarksMirrored:"",BulletedListMirrored:"",CaretHollowMirrored:"",CaretSolidMirrored:"",ChromeBackMirrored:"",ClearSelectionMirrored:"",ClosePaneMirrored:"",DockLeftMirrored:"",DoubleChevronLeftMedMirrored:"",GoMirrored:"",HelpMirrored:"",ImportMirrored:"",ImportAllMirrored:"",ListMirrored:"",MailForwardMirrored:"",MailReplyMirrored:"",MailReplyAllMirrored:"",MiniContractMirrored:"",MiniExpandMirrored:"",OpenPaneMirrored:"",ParkingLocationMirrored:"",SendMirrored:"",ShowResultsMirrored:"",ThumbnailViewMirrored:"",Media:"",Devices3:"",Focus:"",VideoLightOff:"",StatusTriangle:"",VolumeDisabled:"",Puzzle:"",EmojiNeutral:"",EmojiDisappointed:"",HomeSolid:"",PDF:"",HeartBroken:"",StoreLogo16:"",MultiSelectMirrored:"",Broom:"",AddToShoppingList:"",Cocktails:"",Wines:"",Articles:"",Cycling:"",DietPlanNotebook:"",Pill:"",ExerciseTracker:"",HandsFree:"",Medical:"",Running:"",Weights:"",Trackers:"",AddNotes:"",AllCurrency:"",BarChart4:"",CirclePlus:"",Coffee:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-4",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-4"',src:"url('"+e+"odsp-next-icons-4-b330d968.woff') format('woff')"},icons:{Cotton:"",Money:"",PieDouble:"",PieSingle:"",RemoveFilter:"",Savings:"",Sell:"",StockDown:"",StockUp:"",Lamp:"",Source:"",MSNVideos:"",Cricket:"",Golf:"",Baseball:"",Soccer:"",MoreSports:"",AutoRacing:"",CollegeHoops:"",CollegeFootball:"",ProFootball:"",ProHockey:"",Rugby:"",SubstitutionsIn:"",Tennis:"",Arrivals:"",Design:"",Website:"",Drop:"",HistoricalWeather:"",SkiResorts:"",Snowflake:"",BusSolid:"",FerrySolid:"",AirplaneSolid:"",TrainSolid:"",Ticket:"",WifiWarning4:"",Devices4:"",AzureLogo:"",BingLogo:"",MSNLogo:"",OutlookLogoInverse:"",OfficeLogo:"",SkypeLogo:"",Door:"",EditMirrored:"",GiftCard:"",DoubleBookmark:"",StatusErrorFull:"",Certificate:"",FastForward:"",Rewind:"",Photo2:"",OpenSource:"",Movers:"",CloudDownload:"",Family:"",WindDirection:"",Bug:"",SiteScan:"",BrowserScreenShot:"",F12DevTools:"",CSS:"",JS:"",DeliveryTruck:"",ReminderPerson:"",ReminderGroup:"",TabletMode:"",Umbrella:"",NetworkTower:"",CityNext:"",CityNext2:"",Section:"",OneNoteLogoInverse:"",ToggleFilled:"",ToggleBorder:"",SliderThumb:"",ToggleThumb:"",MiracastLogoLarge:"",Documentation:"",Badge:"",Giftbox:"",VisualStudioLogo:"",HomeGroup:"",ExcelLogoInverse:"",WordLogoInverse:"",PowerPointLogoInverse:"",Cafe:"",SpeedHigh:"",Commitments:"",ThisPC:"",MusicNote:"",MicOff:"",PlaybackRate1x:"",EdgeLogo:"",CompletedSolid:"",AlbumRemove:"",MessageFill:"",TabletSelected:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-5",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-5"',src:"url('"+e+"odsp-next-icons-5-851fb4e0.woff') format('woff')"},icons:{MobileSelected:"",LaptopSelected:"",TVMonitorSelected:"",DeveloperTools:"",Shapes:"",InsertTextBox:"",LowerBrightness:"",WebComponents:"",OfflineStorage:"",DOM:"",CloudUpload:"",ScrollUpDown:"",DateTime:"",Event:"",Cake:"",Org:"",PartyLeader:"",DRM:"",CloudAdd:"",AppIconDefault:"",Photo2Add:"",Photo2Remove:"",Calories:"",POI:"",FacebookLogo:"",TwitterLogo:"",AddTo:"",RadioBtnOff:"",RadioBtnOn:"",ExploreContent:"",Product:"",ProgressLoopInner:"",ProgressLoopOuter:"",Blocked2:"",FangBody:"",PageHeader:"",ChatInviteFriend:"",Brush:"",Shirt:"",Crown:"",Diamond:"",ScaleUp:"",QRCode:"",Feedback:"",SharepointLogoInverse:"",YammerLogo:"",Hide:"",Uneditable:"",ReturnToSession:"",CalendarMirrored:"",SwayLogoInverse:"",OutOfOffice:"",Trophy:"",ReopenPages:"",EmojiTabSymbols:"",AADLogo:"",AccessLogo:"",AdminALogoInverse32:"",AdminCLogoInverse32:"",AdminDLogoInverse32:"",AdminELogoInverse32:"",AdminLLogoInverse32:"",AdminMLogoInverse32:"",AdminOLogoInverse32:"",AdminPLogoInverse32:"",AdminSLogoInverse32:"",AdminYLogoInverse32:"",BoxLogo:"",DelveLogoInverse:"",DropboxLogo:"",ExchangeLogoInverse:"",LyncLogo:"",OfficeVideoLogoInverse:"",ParatureLogo:"",SocialListeningLogo:"",VisioLogoInverse:"",Balloons:"",Cat:"",MailAlert:"",MailCheck:"",MailLowImportance:"",MailPause:"",MailRepeat:"",SecurityGroup:"",Table:"",VoicemailForward:"",VoicemailReply:"",Waffle:"",RemoveEvent:"",EventInfo:"",ForwardEvent:"",WipePhone:"",AddOnlineMeeting:"",JoinOnlineMeeting:"",RemoveLink:"",PeopleBlock:"",PeopleRepeat:"",PeopleAlert:"",PeoplePause:"",TransferCall:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-6",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-6"',src:"url('"+e+"odsp-next-icons-6-e74b4266.woff') format('woff')"},icons:{AddPhone:"",UnknownCall:"",NoteReply:"",NoteForward:"",NotePinned:"",RemoveOccurrence:"",Timeline:"",EditNote:"",CircleHalfFull:"",Room:"",Unsubscribe:"",Subscribe:"",HardDrive:"",RecurringTask:"",TaskManager:"",TaskManagerMirrored:"",Combine:"",Split:"",DoubleChevronUp:"",DoubleChevronLeft:"",DoubleChevronRight:"",TextBox:"",TextField:"",NumberField:"",Dropdown:"",PenWorkspace:"",BookingsLogo:"",ClassNotebookLogoInverse:"",DelveAnalyticsLogo:"",DocsLogoInverse:"",Dynamics365Logo:"",DynamicSMBLogo:"",OfficeAssistantLogo:"",OfficeStoreLogo:"",OneNoteEduLogoInverse:"",PlannerLogo:"",PowerApps:"",Suitcase:"",ProjectLogoInverse:"",CaretLeft8:"",CaretRight8:"",CaretUp8:"",CaretDown8:"",CaretLeftSolid8:"",CaretRightSolid8:"",CaretUpSolid8:"",CaretDownSolid8:"",ClearFormatting:"",Superscript:"",Subscript:"",Strikethrough:"",Export:"",ExportMirrored:"",DoubleChevronDown:"",FollowUser:"",ReplyAll:"",GoogleDriveLogo:"",WorkforceManagement:"",RecruitmentManagement:"",Questionnaire:"",ManagerSelfService:"",ProductRelease:"",ReplyMirrored:"",ReplyAllMirrored:"",Medal:"",AddGroup:"",QuestionnaireMirrored:"",CloudImportExport:"",TemporaryUser:"",CaretSolid16:"",GroupedDescending:"",GroupedAscending:"",AwayStatus:"",MyMoviesTV:"",GenericScan:"",AustralianRules:"",WifiEthernet:"",TrackersMirrored:"",DateTimeMirrored:"",StopSolid:"",DoubleChevronUp12:"",DoubleChevronDown12:"",DoubleChevronLeft12:"",DoubleChevronRight12:"",CalendarAgenda:"",ConnectVirtualMachine:"",AddEvent:"",AssetLibrary:"",DataConnectionLibrary:"",DocLibrary:"",FormLibrary:"",FormLibraryMirrored:"",ReportLibrary:"",ReportLibraryMirrored:"",ContactCard:"",CustomList:"",CustomListMirrored:"",IssueTracking:"",IssueTrackingMirrored:"",PictureLibrary:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-7",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-7"',src:"url('"+e+"odsp-next-icons-7-aceffecc.woff') format('woff')"},icons:{OfficeAddinsLogo:"",OfflineOneDriveParachute:"",OfflineOneDriveParachuteDisabled:"",TriangleSolidUp12:"",TriangleSolidDown12:"",TriangleSolidLeft12:"",TriangleSolidRight12:"",TriangleUp12:"",TriangleDown12:"",TriangleLeft12:"",TriangleRight12:"",ArrowUpRight8:"",ArrowDownRight8:"",DocumentSet:"",DelveAnalytics:"",ArrowUpRightMirrored8:"",ArrowDownRightMirrored8:"",CompanyDirectory:"",OpenEnrollment:"",CompanyDirectoryMirrored:"",OneDriveAdd:"",ProfileSearch:"",Header2:"",Header3:"",Header4:"",RingerSolid:"",Eyedropper:"",MarketDown:"",CalendarWorkWeek:"",SidePanel:"",GlobeFavorite:"",CaretTopLeftSolid8:"",CaretTopRightSolid8:"",ViewAll2:"",DocumentReply:"",PlayerSettings:"",ReceiptForward:"",ReceiptReply:"",ReceiptCheck:"",Fax:"",RecurringEvent:"",ReplyAlt:"",ReplyAllAlt:"",EditStyle:"",EditMail:"",Lifesaver:"",LifesaverLock:"",InboxCheck:"",FolderSearch:"",CollapseMenu:"",ExpandMenu:"",Boards:"",SunAdd:"",SunQuestionMark:"",LandscapeOrientation:"",DocumentSearch:"",PublicCalendar:"",PublicContactCard:"",PublicEmail:"",PublicFolder:"",WordDocument:"",PowerPointDocument:"",ExcelDocument:"",GroupedList:"",ClassroomLogo:"",Sections:"",EditPhoto:"",Starburst:"",ShareiOS:"",AirTickets:"",PencilReply:"",Tiles2:"",SkypeCircleCheck:"",SkypeCircleClock:"",SkypeCircleMinus:"",SkypeMessage:"",ClosedCaption:"",ATPLogo:"",OfficeFormsLogoInverse:"",EmptyRecycleBin:"",Hide2:"",iOSAppStoreLogo:"",AndroidLogo:"",Breadcrumb:"",BirthdayCake:"",TimeEntry:"",CRMProcesses:"",PageEdit:"",PageArrowRight:"",PageRemove:"",Database:"",DataManagementSettings:"",CRMServices:"",EditContact:"",ConnectContacts:"",AppIconDefaultAdd:"",AppIconDefaultList:"",ActivateOrders:"",DeactivateOrders:"",ScatterChart:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-8",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-8"',src:"url('"+e+"odsp-next-icons-8-df1db014.woff') format('woff')"},icons:{DocumentManagement:"",CRMReport:"",KnowledgeArticle:"",Relationship:"",HomeVerify:"",ZipFolder:"",SurveyQuestions:"",TextDocument:"",TextDocumentShared:"",PageCheckedOut:"",SaveAndClose:"",Script:"",Archive:"",ActivityFeed:"",Compare:"",EventDate:"",ArrowUpRight:"",CaretRight:"",SetAction:"",CaretSolidLeft:"",CaretSolidDown:"",CaretSolidRight:"",CaretSolidUp:"",PowerAppsLogo:"",PowerApps2Logo:"",SearchIssue:"",SearchIssueMirrored:"",FabricAssetLibrary:"",FabricDataConnectionLibrary:"",FabricDocLibrary:"",FabricFormLibrary:"",FabricFormLibraryMirrored:"",FabricReportLibrary:"",FabricReportLibraryMirrored:"",FabricPublicFolder:"",FabricFolderSearch:"",FabricMovetoFolder:"",FabricUnsyncFolder:"",FabricSyncFolder:"",FabricOpenFolderHorizontal:"",FabricFolderFill:"",FabricNewFolder:"",FabricPictureLibrary:"",AddFavorite:"",AddFavoriteFill:"",BufferTimeBefore:"",BufferTimeAfter:"",BufferTimeBoth:"",PublishContent:"",ClipboardList:"",ClipboardListMirrored:"",CannedChat:"",SkypeForBusinessLogo:"",TabCenter:"",PageCheckedin:"",PageList:"",ReadOutLoud:"",CaretBottomLeftSolid8:"",CaretBottomRightSolid8:"",FolderHorizontal:"",MicrosoftStaffhubLogo:"",GiftboxOpen:"",StatusCircleOuter:"",StatusCircleInner:"",StatusCircleRing:"",StatusTriangleOuter:"",StatusTriangleInner:"",StatusTriangleExclamation:"",StatusCircleExclamation:"",StatusCircleErrorX:"",StatusCircleInfo:"",StatusCircleBlock:"",StatusCircleBlock2:"",StatusCircleQuestionMark:"",StatusCircleSync:"",Toll:"",ExploreContentSingle:"",CollapseContent:"",CollapseContentSingle:"",InfoSolid:"",GroupList:"",ProgressRingDots:"",CaloriesAdd:"",BranchFork:"",AddHome:"",AddWork:"",MobileReport:"",ScaleVolume:"",HardDriveGroup:"",FastMode:"",ToggleLeft:"",ToggleRight:"",TriangleShape:"",RectangleShape:"",CubeShape:"",Trophy2:"",BucketColor:"",BucketColorFill:"",Taskboard:"",SingleColumn:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-9",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-9"',src:"url('"+e+"odsp-next-icons-9-e4ca5fa4.woff') format('woff')"},icons:{DoubleColumn:"",TripleColumn:"",ColumnLeftTwoThirds:"",ColumnRightTwoThirds:"",AccessLogoFill:"",AnalyticsLogo:"",AnalyticsQuery:"",NewAnalyticsQuery:"",AnalyticsReport:"",WordLogo:"",WordLogoFill:"",ExcelLogoFill:"",OneNoteLogo:"",OneNoteLogoFill:"",OutlookLogo:"",OutlookLogoFill:"",PowerPointLogo:"",PowerPointLogoFill:"",PublisherLogo:"",PublisherLogoFill:"",ScheduleEventAction:"",FlameSolid:"",ServerProcesses:"",Server:"",SaveAll:"",LinkedInLogo:"",Decimals:"",SidePanelMirrored:"",ProtectRestrict:"",Blog:"",UnknownMirrored:"",PublicContactCardMirrored:"",GridViewSmall:"",GridViewMedium:"",GridViewLarge:"",Step:"",StepInsert:"",StepShared:"",StepSharedAdd:"",StepSharedInsert:"",ViewDashboard:"",ViewList:"",ViewListGroup:"",ViewListTree:"",TriggerAuto:"",TriggerUser:"",PivotChart:"",StackedBarChart:"",StackedLineChart:"",BuildQueue:"",BuildQueueNew:"",UserFollowed:"",ContactLink:"",Stack:"",Bullseye:"",VennDiagram:"",FiveTileGrid:"",FocalPoint:"",RingerRemove:"",TeamsLogoInverse:"",TeamsLogo:"",TeamsLogoFill:"",SkypeForBusinessLogoFill:"",SharepointLogo:"",SharepointLogoFill:"",DelveLogo:"",DelveLogoFill:"",OfficeVideoLogo:"",OfficeVideoLogoFill:"",ExchangeLogo:"",ExchangeLogoFill:"",Signin:"",DocumentApproval:"",CloneToDesktop:"",InstallToDrive:"",Blur:"",Build:"",ProcessMetaTask:"",BranchFork2:"",BranchLocked:"",BranchCommit:"",BranchCompare:"",BranchMerge:"",BranchPullRequest:"",BranchSearch:"",BranchShelveset:"",RawSource:"",MergeDuplicate:"",RowsGroup:"",RowsChild:"",Deploy:"",Redeploy:"",ServerEnviroment:"",VisioDiagram:"",HighlightMappedShapes:"",TextCallout:"",IconSetsFlag:"",VisioLogo:"",VisioLogoFill:"",VisioDocument:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-10",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-10"',src:"url('"+e+"odsp-next-icons-10-3d7acda8.woff') format('woff')"},icons:{TimelineProgress:"",TimelineDelivery:"",Backlog:"",TeamFavorite:"",TaskGroup:"",TaskGroupMirrored:"",ScopeTemplate:"",AssessmentGroupTemplate:"",NewTeamProject:"",CommentAdd:"",CommentNext:"",CommentPrevious:"",ShopServer:"",LocaleLanguage:"",QueryList:"",UserSync:"",UserPause:"",StreamingOff:"",ArrowTallUpLeft:"",ArrowTallUpRight:"",ArrowTallDownLeft:"",ArrowTallDownRight:"",FieldEmpty:"",FieldFilled:"",FieldChanged:"",FieldNotChanged:"",RingerOff:"",PlayResume:"",BulletedList2:"",BulletedList2Mirrored:"",ImageCrosshair:"",GitGraph:"",Repo:"",RepoSolid:"",FolderQuery:"",FolderList:"",FolderListMirrored:"",LocationOutline:"",POISolid:"",CalculatorNotEqualTo:"",BoxSubtractSolid:"",BoxAdditionSolid:"",BoxMultiplySolid:"",BoxPlaySolid:"",BoxCheckmarkSolid:"",CirclePauseSolid:"",CirclePause:"",MSNVideosSolid:"",CircleStopSolid:"",CircleStop:"",NavigateBack:"",NavigateBackMirrored:"",NavigateForward:"",NavigateForwardMirrored:"",UnknownSolid:"",UnknownMirroredSolid:"",CircleAddition:"",CircleAdditionSolid:"",FilePDB:"",FileTemplate:"",FileSQL:"",FileJAVA:"",FileASPX:"",FileCSS:"",FileSass:"",FileLess:"",FileHTML:"",JavaScriptLanguage:"",CSharpLanguage:"",CSharp:"",VisualBasicLanguage:"",VB:"",CPlusPlusLanguage:"",CPlusPlus:"",FSharpLanguage:"",FSharp:"",TypeScriptLanguage:"",PythonLanguage:"",PY:"",CoffeeScript:"",MarkDownLanguage:"",FullWidth:"",FullWidthEdit:"",Plug:"",PlugSolid:"",PlugConnected:"",PlugDisconnected:"",UnlockSolid:"",Variable:"",Parameter:"",CommentUrgent:"",Storyboard:"",DiffInline:"",DiffSideBySide:"",ImageDiff:"",ImagePixel:"",FileBug:"",FileCode:"",FileComment:"",BusinessHoursSign:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-11",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-11"',src:"url('"+e+"odsp-next-icons-11-de4ac3a0.woff') format('woff')"},icons:{FileImage:"",FileSymlink:"",AutoFillTemplate:"",WorkItem:"",WorkItemBug:"",LogRemove:"",ColumnOptions:"",Packages:"",BuildIssue:"",AssessmentGroup:"",VariableGroup:"",FullHistory:"",Wheelchair:"",SingleColumnEdit:"",DoubleColumnEdit:"",TripleColumnEdit:"",ColumnLeftTwoThirdsEdit:"",ColumnRightTwoThirdsEdit:"",StreamLogo:"",PassiveAuthentication:"",AlertSolid:"",MegaphoneSolid:"",TaskSolid:"",ConfigurationSolid:"",BugSolid:"",CrownSolid:"",Trophy2Solid:"",QuickNoteSolid:"",ConstructionConeSolid:"",PageListSolid:"",PageListMirroredSolid:"",StarburstSolid:"",ReadingModeSolid:"",SadSolid:"",HealthSolid:"",ShieldSolid:"",GiftBoxSolid:"",ShoppingCartSolid:"",MailSolid:"",ChatSolid:"",RibbonSolid:"",FinancialSolid:"",FinancialMirroredSolid:"",HeadsetSolid:"",PermissionsSolid:"",ParkingSolid:"",ParkingMirroredSolid:"",DiamondSolid:"",AsteriskSolid:"",OfflineStorageSolid:"",BankSolid:"",DecisionSolid:"",Parachute:"",ParachuteSolid:"",FiltersSolid:"",ColorSolid:"",ReviewSolid:"",ReviewRequestSolid:"",ReviewRequestMirroredSolid:"",ReviewResponseSolid:"",FeedbackRequestSolid:"",FeedbackRequestMirroredSolid:"",FeedbackResponseSolid:"",WorkItemBar:"",WorkItemBarSolid:"",Separator:"",NavigateExternalInline:"",PlanView:"",TimelineMatrixView:"",EngineeringGroup:"",ProjectCollection:"",CaretBottomRightCenter8:"",CaretBottomLeftCenter8:"",CaretTopRightCenter8:"",CaretTopLeftCenter8:"",DonutChart:"",ChevronUnfold10:"",ChevronFold10:"",DoubleChevronDown8:"",DoubleChevronUp8:"",DoubleChevronLeft8:"",DoubleChevronRight8:"",ChevronDownEnd6:"",ChevronUpEnd6:"",ChevronLeftEnd6:"",ChevronRightEnd6:"",EgnyteLogo:"",GoogleDriveLogoLeftGreen:"",GoogleDriveLogoBottomBlue:"",GoogleDriveLogoRightYellow:"",ContextMenu:"",AzureAPIManagement:"",AzureServiceEndpoint:"",VSTSLogo:"",VSTSAltLogo1:"",VSTSAltLogo2:"",FileTypeSolution:"",WordLogoInverse16:"",WordLogo16:"",WordLogoFill16:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-12",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-12"',src:"url('"+e+"odsp-next-icons-12-92d4b45f.woff') format('woff')"},icons:{PowerPointLogoInverse16:"",PowerPointLogo16:"",PowerPointLogoFill16:"",ExcelLogoInverse16:"",ExcelLogo16:"",ExcelLogoFill16:"",OneNoteLogoInverse16:"",OneNoteLogo16:"",OneNoteLogoFill16:"",OutlookLogoInverse16:"",OutlookLogo16:"",OutlookLogoFill16:"",PublisherLogoInverse16:"",PublisherLogo16:"",PublisherLogoFill16:"",VisioLogoInverse16:"",VisioLogo16:"",VisioLogoFill16:"",TestBeaker:"",TestBeakerSolid:"",TestExploreSolid:"",TestAutoSolid:"",TestUserSolid:"",TestImpactSolid:"",TestPlan:"",TestStep:"",TestParameter:"",TestSuite:"",TestCase:"",Sprint:"",SignOut:"",TriggerApproval:"",Rocket:"",AzureKeyVault:"",Onboarding:"",Transition:"",LikeSolid:"",DislikeSolid:"",CRMCustomerInsightsApp:"",EditCreate:"",SearchData:"",UnSetColor:"",DeclineCall:"",RectangularClipping:"",TeamsLogo16:"",TeamsLogoFill16:"",Spacer:"",SkypeLogo16:"",SkypeForBusinessLogo16:"",SkypeForBusinessLogoFill16:"",FilterSolid:"",MailUndelivered:"",MailTentative:"",MailTentativeMirrored:"",MailReminder:"",ReceiptUndelivered:"",ReceiptTentative:"",ReceiptTentativeMirrored:"",Inbox:"",IRMReply:"",IRMReplyMirrored:"",IRMForward:"",IRMForwardMirrored:"",VoicemailIRM:"",EventAccepted:"",EventTentative:"",EventTentativeMirrored:"",EventDeclined:"",IDBadge:"",BackgroundColor:"",OfficeFormsLogoInverse16:"",OfficeFormsLogo:"",OfficeFormsLogoFill:"",OfficeFormsLogo16:"",OfficeFormsLogoFill16:"",OfficeFormsLogoInverse24:"",OfficeFormsLogo24:"",OfficeFormsLogoFill24:"",PageLock:"",NotExecuted:"",NotImpactedSolid:"",FieldReadOnly:"",FieldRequired:"",BacklogBoard:"",ExternalBuild:"",ExternalTFVC:"",ExternalXAML:"",IssueSolid:"",DefectSolid:"",LadybugSolid:"",MTMLogo:"",NugetLogo:"",TFVCLogo:"",ProjectLogo32:"",ProjectLogoFill32:"",ProjectLogo16:"",ProjectLogoFill16:"",SwayLogo32:"",SwayLogoFill32:"",SwayLogo16:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-13",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-13"',src:"url('"+e+"odsp-next-icons-13-5b7ae95a.woff') format('woff')"},icons:{SwayLogoFill16:"",ClassNotebookLogo32:"",ClassNotebookLogoFill32:"",ClassNotebookLogo16:"",ClassNotebookLogoFill16:"",ClassNotebookLogoInverse32:"",ClassNotebookLogoInverse16:"",StaffNotebookLogo32:"",StaffNotebookLogoFill32:"",StaffNotebookLogo16:"",StaffNotebookLogoFill16:"",StaffNotebookLogoInverted32:"",StaffNotebookLogoInverted16:"",KaizalaLogo:"",TaskLogo:"",ProtectionCenterLogo32:"",NonprofitLogo32:"",GallatinLogo:"",Globe2:"",Guitar:"",Breakfast:"",Brunch:"",BeerMug:"",Vacation:"",Teeth:"",Taxi:"",Chopsticks:"",SyncOccurence:"",UnsyncOccurence:"",GIF:"",PrimaryCalendar:"",SearchCalendar:"",VideoOff:"",MicrosoftFlowLogo:"",BusinessCenterLogo:"",ToDoLogoBottom:"",ToDoLogoTop:"",EditSolid12:"",EditSolidMirrored12:"",UneditableSolid12:"",UneditableSolidMirrored12:"",UneditableMirrored:"",AdminALogo32:"",AdminALogoFill32:"",ToDoLogoInverse:"",WaffleOffice365:"",ImageSearch:"",NewsSearch:"",VideoSearch:"",R:"",FontColorA:"",FontColorSwatch:"",LightWeight:"",NormalWeight:"",SemiboldWeight:"",GroupObject:"",UngroupObject:"",AlignHorizontalLeft:"",AlignHorizontalCenter:"",AlignHorizontalRight:"",AlignVerticalTop:"",AlignVerticalCenter:"",AlignVerticalBottom:"",HorizontalDistributeCenter:"",VerticalDistributeCenter:"",Ellipse:"",Line:"",Octagon:"",Hexagon:"",Pentagon:"",RightTriangle:"",HalfCircle:"",QuarterCircle:"",ThreeQuarterCircle:"","6PointStar":"","12PointStar":"",ArrangeBringToFront:"",ArrangeSendToBack:"",ArrangeSendBackward:"",ArrangeBringForward:"",BorderDash:"",BorderDot:"",LineStyle:"",LineThickness:"",WindowEdit:"",HintText:"",MediaAdd:"",AnchorLock:"",AutoHeight:"",ChartSeries:"",ChartXAngle:"",ChartYAngle:"",Combobox:"",LineSpacing:"",Padding:"",PaddingTop:"",PaddingBottom:"",PaddingLeft:"",PaddingRight:"",NavigationFlipper:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-14",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-14"',src:"url('"+e+"odsp-next-icons-14-aa5974c9.woff') format('woff')"},icons:{AlignJustify:"",TextOverflow:"",VisualsFolder:"",VisualsStore:"",PictureCenter:"",PictureFill:"",PicturePosition:"",PictureStretch:"",PictureTile:"",Slider:"",SliderHandleSize:"",DefaultRatio:"",NumberSequence:"",GUID:"",ReportAdd:"",DashboardAdd:"",MapPinSolid:"",WebPublish:"",PieSingleSolid:"",BlockedSolid:"",DrillDown:"",DrillDownSolid:"",DrillExpand:"",DrillShow:"",SpecialEvent:"",OneDriveFolder16:"",ChronosLogo:"",FunctionalManagerDashboard:"",BIDashboard:"",CodeEdit:"",RenewalCurrent:"",RenewalFuture:"",SplitObject:"",BulkUpload:"",DownloadDocument:"",Flower:"",WaitlistConfirm:"",WaitlistConfirmMirrored:"",LaptopSecure:"",DragObject:"",EntryView:"",EntryDecline:"",ContactCardSettings:"",ContactCardSettingsMirrored:"",CalendarSettings:"",CalendarSettingsMirrored:"",HardDriveLock:"",HardDriveUnlock:"",AccountManagement:"",TransitionPop:"",TransitionPush:"",TransitionEffect:"",LookupEntities:"",ExploreData:"",AddBookmark:"",SearchBookmark:"",DrillThrough:"",MasterDatabase:"",CertifiedDatabase:"",MaximumValue:"",MinimumValue:"",VisualStudioIDELogo32:"",ApacheIvyLogo32:"",BitbucketLogo32:"",LinuxLogo32:"",GradleLogo32:"",PasteAsText:"",PasteAsCode:"",BrowserTab:"",BrowserTabScreenshot:"",DesktopScreenshot:"",FileYML:"",ClipboardSolid:"",FabricUserFolder:"",FabricNetworkFolder:"",AnalyticsView:"",Video360Generic:"",Leave:"",CircleShapeSolid:"",SquareShapeSolid:"",TriangleShapeSolid:"",DropShapeSolid:"",RectangleShapeSolid:"",ZoomToFit:"",InsertColumnsLeft:"",InsertColumnsRight:"",InsertRowsAbove:"",InsertRowsBelow:"",DeleteColumns:"",DeleteRows:"",DeleteRowsMirrored:"",DeleteTable:"",AccountBrowser:"",GitLogo:"",GitHubLogo:"",ApacheMavenLogo:"",NPMLogo:"",GitFork:"",SVNLogo:"",JenkinsLogo:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-15",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-15"',src:"url('"+e+"odsp-next-icons-15-c0bd56c1.woff') format('woff')"},icons:{VersionControlPush:"",ExternalGit:"",StackedColumnChart2:"",TripleColumnWide:"",QuadColumn:"",WhiteBoardApp16:"",WhiteBoardApp32:"",PinnedSolid:"",InsertSignatureLine:"",ArrangeByFrom:"",Phishing:"",CreateMailRule:"",PublishCourse:"",DictionaryRemove:"",UserRemove:"",UserEvent:"",Encryption:"",PasswordField:"",OpenInNewTab:"",Hide3:"",VerifiedBrandSolid:"",MarkAsProtected:"",AuthenticatorApp:"",WebTemplate:"",DefenderTVM:"",MedalSolid:"",D365TalentLearn:"",D365TalentInsight:"",D365TalentHRCore:"",BacklogList:"",ButtonControl:"",TableGroup:"",MountainClimbing:"",TagUnknown:"",TagUnknownMirror:"",Link12:"",Presentation:"",Presentation12:"",Lock12:"",BuildDefinition:"",ReleaseDefinition:"",SaveTemplate:"",UserGauge:"",TagSolid:"",OfficeChat:"",OfficeChatSolid:"",MailSchedule:"",WarningSolid:"",Blocked2Solid:"",SkypeCircleArrow:"",SkypeArrow:"",SyncStatus:"",SyncStatusSolid:"",ProjectDocument:"",ToDoLogoOutline:"",VisioOnlineLogoFill32:"",VisioOnlineLogo32:"",VisioOnlineLogoCloud32:"",VisioDiagramSync:"",Event12:"",EventDateMissed12:"",UserOptional:"",ResponsesMenu:"",DoubleDownArrow:"",DistributeDown:"",BookmarkReport:"",FilterSettings:"",GripperDotsVertical:"",MailAttached:"",AddIn:"",LinkedDatabase:"",TableLink:"",PromotedDatabase:"",BarChartVerticalFilter:"",BarChartVerticalFilterSolid:"",MicrosoftTranslatorLogo:"",ShowTimeAs:"",FileRequest:"",WorkItemAlert:"",PowerBILogo16:"",PowerBILogoBackplate16:"",BulletedListText:"",BulletedListBullet:"",BulletedListTextMirrored:"",BulletedListBulletMirrored:"",NumberedListText:"",NumberedListNumber:"",NumberedListTextMirrored:"",NumberedListNumberMirrored:"",RemoveLinkChain:"",RemoveLinkX:"",FabricTextHighlight:"",ClearFormattingA:"",ClearFormattingEraser:"",Photo2Fill:"",IncreaseIndentText:"",IncreaseIndentArrow:"",DecreaseIndentText:"",DecreaseIndentArrow:"",IncreaseIndentTextMirrored:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-16",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-16"',src:"url('"+e+"odsp-next-icons-16-a8d42f4d.woff') format('woff')"},icons:{IncreaseIndentArrowMirrored:"",DecreaseIndentTextMirrored:"",DecreaseIndentArrowMirrored:"",CheckListText:"",CheckListCheck:"",CheckListTextMirrored:"",CheckListCheckMirrored:"",NumberSymbol:"",Coupon:"",VerifiedBrand:"",ReleaseGate:"",ReleaseGateCheck:"",ReleaseGateError:"",M365InvoicingLogo:"",RemoveFromShoppingList:"",ShieldAlert:"",FabricTextHighlightComposite:"",Dataflows:"",GenericScanFilled:"",DiagnosticDataBarTooltip:"",SaveToMobile:"",Orientation2:"",ScreenCast:"",ShowGrid:"",SnapToGrid:"",ContactList:"",NewMail:"",EyeShadow:"",DockerLogo:"",JavaLogo:"",KeubernetesLogo:"",ReactLogo:"",SwiftLogo:"",XamarinLogo:"",AmazonWebServicesLogo:"",FabricFolderConfirm:"",InformationBarriers:"",CommentActive:"",ColumnVerticalSectionEdit:"",WavingHand:"",ShakeDevice:"",SmartGlassRemote:"",Rotate90Clockwise:"",Rotate90CounterClockwise:"",CampaignTemplate:"",ChartTemplate:"",PageListFilter:"",SecondaryNav:"",ColumnVerticalSection:"",SkypeCircleSlash:"",SkypeSlash:"",CustomizeToolbar:"",DuplicateRow:"",RemoveFromTrash:"",MailOptions:"",Childof:"",Footer:"",Header:"",BarChartVerticalFill:"",StackedColumnChart2Fill:"",PlainText:"",AccessibiltyChecker:"",OneDriveFileVault:"",DatabaseSync:"",ReservationOrders:"",TabOneColumn:"",TabTwoColumn:"",TabThreeColumn:"",PythonLogoBlue:"",PythonLogoYellow:"",RustLanguageLogo:"",RubyGemsLogo:"",MicrosoftTranslatorLogoGreen:"",MicrosoftTranslatorLogoBlue:"",InternalInvestigation:"",AddReaction:"",ContactHeart:"",VisuallyImpaired:"",EventToDoLogo:"",Variable2:"",ModelingView:"",DisconnectVirtualMachine:"",ReportLock:"",Uneditable2:"",Uneditable2Mirrored:"",BarChartVerticalEdit:"",GlobalNavButtonActive:"",PollResults:"",Rerun:"",QandA:"",QandAMirror:"",BookAnswers:"",AlertSettings:"",TableComputed:"",ExcelLogo16Mono:"󰀀",ExcelLogo16L01:"󰀁",ExcelLogo16L02:"󰀂",ExcelLogo16L03:"󰀃",ExcelLogo16L04:"󰀄",ExcelLogo16L05:"󰀅"}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-17",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-17"',src:"url('"+e+"odsp-next-icons-17-15358fb7.woff') format('woff')"},icons:{ExcelLogo16L06:"󰀆",ExcelLogo16L07:"󰀇",ExcelLogo16L08:"󰀈",ExcelLogo32Mono:"󰀉",ExcelLogo32L01:"󰀊",ExcelLogo32L02:"󰀋",ExcelLogo32L03:"󰀌",ExcelLogo32L04:"󰀍",ExcelLogo32L05:"󰀎",ExcelLogo32L06:"󰀏",ExcelLogo32L07:"󰀐",ExcelLogo32L08:"󰀑",ExcelLogo32L09:"󰀒",ExcelLogo32L10:"󰀓",ExcelLogo32L11:"󰀔",ExcelLogo32L12:"󰀕",WordLogo16Mono:"󰀖",WordLogo16L01:"󰀗",WordLogo16L02:"󰀘",WordLogo16L03:"󰀙",WordLogo16L04:"󰀚",WordLogo16L05:"󰀛",WordLogo16L06:"󰀜",WordLogo16L07:"󰀝",WordLogo32Mono:"󰀞",WordLogo32L01:"󰀟",WordLogo32L02:"󰀠",WordLogo32L03:"󰀡",WordLogo32L04:"󰀢",WordLogo32L05:"󰀣",WordLogo32L06:"󰀤",WordLogo32L07:"󰀥",WordLogo32L08:"󰀦",WordLogo32L09:"󰀧",WordLogo32L10:"󰀨",PowerPointLogo16Mono:"󰀩",PowerPointLogo16L01:"󰀪",PowerPointLogo16L02:"󰀫",PowerPointLogo16L03:"󰀬",PowerPointLogo16L04:"󰀭",PowerPointLogo16L05:"󰀮",PowerPointLogo16L06:"󰀯",PowerPointLogo32Mono:"󰀰",PowerPointLogo32L01:"󰀱",PowerPointLogo32L02:"󰀲",PowerPointLogo32L03:"󰀳",PowerPointLogo32L04:"󰀴",PowerPointLogo32L05:"󰀵",PowerPointLogo32L06:"󰀶",PowerPointLogo32L07:"󰀷",PowerPointLogo32L08:"󰀸",PowerPointLogo32L09:"󰀹",OneNoteLogo16Mono:"󰀺",OneNoteLogo16L01:"󰀻",OneNoteLogo16L02:"󰀼",OneNoteLogo16L03:"󰀽",OneNoteLogo16L04:"󰀾",OneNoteLogo16L05:"󰀿",OneNoteLogo16L06:"󰁀",OneNoteLogo16L07:"󰁁",OneNoteLogo32Mono:"󰁂",OneNoteLogo32L01:"󰁃",OneNoteLogo32L02:"󰁄",OneNoteLogo32L03:"󰁅",OneNoteLogo32L04:"󰁆",OneNoteLogo32L05:"󰁇",OneNoteLogo32L06:"󰁈",OneNoteLogo32L07:"󰁉",OneNoteLogo32L08:"󰁊",OneNoteLogo32L09:"󰁋",OneNoteLogo32L10:"󰁌",OutlookLogo16Mono:"󰁍",OutlookLogo16L01:"󰁎",OutlookLogo16L02:"󰁏",OutlookLogo16L03:"󰁐",OutlookLogo16L04:"󰁑",OutlookLogo16L05:"󰁒",OutlookLogo16L06:"󰁓",OutlookLogo16L07:"󰁔",OutlookLogo16L08:"󰁕",OutlookLogo16L09:"󰁖",OutlookLogo16L10:"󰁗",OutlookLogo16L11:"󰁘",OutlookLogo16L12:"󰁙",OutlookLogo32Mono:"󰁚",OutlookLogo32L01:"󰁛",OutlookLogo32L02:"󰁜",OutlookLogo32L03:"󰁝",OutlookLogo32L04:"󰁞",OutlookLogo32L05:"󰁟",OutlookLogo32L06:"󰁠",OutlookLogo32L07:"󰁡",OutlookLogo32L08:"󰁢",OutlookLogo32L09:"󰁣",OutlookLogo32L10:"󰁤",OutlookLogo32L11:"󰁥",OutlookLogo32L12:"󰁦",OutlookLogo32L13:"󰁧",OutlookLogo32L14:"󰁨",OutlookLogo32L15:"󰁩"}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/odsp-next-icons-18",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.initializeIcons=function(e,t){void 0===e&&(e="");var r={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons-18"',src:"url('"+e+"odsp-next-icons-18-0265b7ed.woff') format('woff')"},icons:{OutlookLogo32L16:"󰁪",OutlookLogo32L17:"󰁫",OutlookLogo32L18:"󰁬",OutlookLogo32L19:"󰁭",OutlookLogo32L20:"󰁮",OutlookLogo32L21:"󰁯",SharePointLogo16Mono:"󰁰",SharePointLogo16L01:"󰁱",SharePointLogo16L02:"󰁲",SharePointLogo16L03:"󰁳",SharePointLogo16L04:"󰁴",SharePointLogo16L05:"󰁵",SharePointLogo16L06:"󰁶",SharePointLogo32Mono:"󰁷",SharePointLogo32L01:"󰁸",SharePointLogo32L02:"󰁹",SharePointLogo32L03:"󰁺",SharePointLogo32L04:"󰁻",SharePointLogo32L05:"󰁼",SharePointLogo32L06:"󰁽",SharePointLogo32L07:"󰁾",SharePointLogo32L08:"󰁿",SharePointLogo32L09:"󰂀",YammerLogo16Mono:"󰂁",YammerLogo16L01:"󰂂",YammerLogo16L02:"󰂃",YammerLogo16L03:"󰂄",YammerLogo16L04:"󰂅",YammerLogo16L05:"󰂆",YammerLogo16L06:"󰂇",YammerLogo32Mono:"󰂈",YammerLogo32L01:"󰂉",YammerLogo32L02:"󰂊",YammerLogo32L03:"󰂋",YammerLogo32L04:"󰂌",YammerLogo32L05:"󰂍",YammerLogo32L06:"󰂎",YammerLogo32L07:"󰂏",YammerLogo32L08:"󰂐",YammerLogo32L09:"󰂑",TeamsLogo16Mono:"󰂒",TeamsLogo16L01:"󰂓",TeamsLogo16L02:"󰂔",TeamsLogo16L03:"󰂕",TeamsLogo16L04:"󰂖",TeamsLogo16L05:"󰂗",TeamsLogo32Mono:"󰂘",TeamsLogo32L01:"󰂙",TeamsLogo32L02:"󰂚",TeamsLogo32L03:"󰂛",TeamsLogo32L04:"󰂜",TeamsLogo32L05:"󰂝",TeamsLogo32L06:"󰂞",TeamsLogo32L07:"󰂟",TeamsLogo32L08:"󰂠",OneDriveLogo16Mono:"󰂡",OneDriveLogo16L01:"󰂢",OneDriveLogo16L02:"󰂣",OneDriveLogo16L03:"󰂤",OneDriveLogo16L04:"󰂥",OneDriveLogo32Mono:"󰂦",OneDriveLogo32L01:"󰂧",OneDriveLogo32L02:"󰂨",OneDriveLogo32L03:"󰂩",OneDriveLogo32L04:"󰂪",SkypeLogo16Mono:"󰂫",SkypeLogo16L01:"󰂬",SkypeLogo16L02:"󰂭",SkypeLogo32Mono:"󰂮",SkypeLogo32L01:"󰂯",SkypeLogo32L02:"󰂰",SkypeLogo32L03:"󰂱",SkypeLogo32L04:"󰂲",DecreaseIndentLegacy:"",IncreaseIndentLegacy:"",SizeLegacy:""}};n.registerIcons(r,t)}});
define("odsp-next/utilities/icons/fabric/iconAliases",["require","exports","@uifabric/styling"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.registerIconAliases=function(){n.registerIconAlias("trash","delete");n.registerIconAlias("onedrive","onedrivelogo");n.registerIconAlias("alertsolid12","eventdatemissed12");n.registerIconAlias("sixpointstar","6pointstar");n.registerIconAlias("twelvepointstar","12pointstar");n.registerIconAlias("toggleon","toggleleft");n.registerIconAlias("toggleoff","toggleright")};t.default=t.registerIconAliases});
define("odsp-next/utilities/TestHooks",["require","exports","@ms/odsp-utilities/lib/modules/Modules"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});window.__loadTests=function(){return n.loadModuleExport({path:"odsp-next-test/functional/remote/execution/Initialization",require:window.require,getExport:function(e){return e.initialize}}).then(function(e){return e()})}});
define("odsp-next/controls/leftNav/LeftNav",["require","exports","./LeftNavViewModel","../../bindings/component/ControlBinding","./LeftNav.html","./LeftNav.css","./leftNavSublink/LeftNavSublink"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=r.createResolvedControlDefinitionResourceKey({automationName:"ms-left-nav",name:e("module").id,template:e("./LeftNav.html"),viewModelType:n.default});t.default=t.resourceKey});
define("odsp-next/controls/leftNav/LeftNavViewModel",["require","exports","tslib","knockout","../../utilities/browser/ResponsiveUI","@ms/odsp-shared/lib/base/ViewModel","../../bindings/selection/SelectionBinding","../../providers/engagement/Engagement","@ms/odsp-shared/lib/utilities/logging/LoggingHelper","@ms/odsp-utilities/lib/string/StringHelper","./LeftNav.resx","../../bindings/keyboard/KeyboardBinding","../siteIcon/SiteIcon","../../bindings/component/ControlBinding","./leftNavSublink/LeftNavSublink.key","../fluentStyling/FluentStyling.key","../../bindings/teachingBubble/TeachingBubbleBinding","../../providers/teachingBubble/TeachingBubbleProvider"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var y=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.siteIconTagName=h.default.tagName;r.addBindingHandlers({teachingBubble:m.default,selection:o.default,keyboard:c.default,control:p.default});r._engagement=n.engagement;var i=r.observables,s=t.linkGroups,u=void 0===s?i.createArray():s,a=t.isLeftNavVisible,f=void 0===a?i.create(!0):a;r.linkGroups=u;r._teachingBubbleProvider=n.teachingBubbleProvider;r.isLeftNavVisible=f;r.isFluentFlight=n.useFluentStyling;r.responsiveUI=n.responsiveUI;r._initializeSubSections();return r}t.prototype.toggleExpanded=function(e){var t=e.engagementName;if(t){t=t.replace(/\s/g,"");e.isExpanded()?t+="Collapse":t+="Expand";this._engagement.logData({name:t+".LeftNav.Click",isIntentional:!0})}e.isExpanded(!e.isExpanded());e.keepOpen=r.observable(!0);return!1};t.prototype.onClick=function(e,t){e.engagementName&&this._engagement.logData({name:e.engagementName+".LeftNav.Click",isIntentional:!0,extraData:n.__assign({},e.engagementExtraData||{},{action:a.capitalizeFirstLetter(t.type)})});var r=this._teachingBubbleProvider;if(e.teachingBubble&&r){var i=r.currentBubble.peek();if(i&&i.campaign&&e.teachingBubble.campaignGuid===i.campaign.campaignGuid){r.clearCurrentBubble();r.markBubbleAsDismissed(e.teachingBubble)}}if(e.action){e.action.execute(t);return!1}return!0};t.prototype.getLinkGroupAriaLabel=function(e){var t=e.groupingName,n=void 0===t?"":t,r=e.text,i=void 0===r?"":r;switch(n){case"SitesGrouping":return f.format(l.strings.ariaLabelForLeftNavTeamSiteHeader,this.unwrapObservable(i));case"UserNameGrouping":return f.format(l.strings.ariaLabelForLeftNavUserNameLinkGroupHeader,this.unwrapObservable(i));default:return f.format(l.strings.ariaLabelForLeftNavLinkGroupHeader,this.unwrapObservable(i))}};t.prototype._processGroups=function(e){for(var t=0;t<this.linkGroups().length;t++){var n=this.linkGroups()[t];n.notificationSublinkSpecification=p.toSpecification(d.default,{isLeftNavVisible:this.isLeftNavVisible,linkGroup:n});t>0&&!n.keepOpen&&n.isExpanded(e)}};t.prototype._initializeSubSections=function(){var e=this;this.createComputed(function(){switch(e.responsiveUI.formFactorSize()){case"Small":case"Medium":case"Large":e._processGroups(!1);return!1;default:e._processGroups(!0);return!0}})};t.dependencies=n.__assign({},s.default.dependencies,{teachingBubbleProvider:g.resourceKey.optional,responsiveUI:i.resourceKey,engagement:u.resourceKey,useFluentStyling:v.resourceKey});return t}(s.default);t.default=y});
define("@ms/odsp-shared/lib/utilities/logging/LoggingHelper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ClickName="Click";t.capitalizeFirstLetter=function(e){return e.charAt(0).toUpperCase()+e.slice(1)}});
define("odsp-next/controls/siteIcon/SiteIcon",["require","exports","./SiteIconViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","../../bindings/component/ControlBinding","./SiteIcon.html","./SiteIcon.css"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=r.registerComponent({tagName:"ms-site-icon",template:e("./SiteIcon.html"),viewModel:n.default,synchronous:!0});t.resourceKey=i.createResolvedControlDefinitionResourceKey({automationName:"ms-site-icon",name:e("module").id,template:e("./SiteIcon.html"),viewModelType:n.default});t.default=s});
define("odsp-next/controls/siteIcon/SiteIconViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../image/tile/ImageTile","../icon/glyph/IconGlyph","@ms/odsp-shared/lib/models/image/Alignments"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.imageTileTagName=i.default.tagName;r.iconGlyphTagName=s.default.tagName;var u=t.acronym,a=t.color,f=t.icon,l=t.iconUrl,c=t.size,h=void 0===c?{width:28,height:28}:c,p=t.mode,d=void 0===p?"site":p;r._size=r.wrapObservable(h);r.iconUrl=r.wrapObservable(l);r.icon=r.wrapObservable(f);r.acronym=r.wrapObservable(u);r.color=r.wrapObservable(a);r.mode=d;r.acronymStyle=r.createPureComputed(r._computeAcronymStyle);r.isImageLoaded=r.createObservable(!1);r.imageTileParams={image:r.createPureComputed(r._computeImage),isLoaded:r.isImageLoaded,desiredSize:r._size,alignment:o.AlignmentType.fitExpand};r.iconGlyphParams={icon:r.icon};return r}t.prototype._computeImage=function(){return{url:this.unwrapObservable(this.iconUrl),width:0,height:0}};t.prototype._computeAcronymStyle=function(){var e=.4*this._size().height,t=.72*e;return{height:Math.ceil(e)+"px","font-size":Math.ceil(t)+"px","line-height":Math.ceil(e)+"px"}};return t}(r.default);t.default=u});
define("odsp-next/controls/image/tile/ImageTile",["require","exports","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./ImageTileViewModel","./ImageTile.html","./ImageTile.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n.registerComponent({tagName:"od-image-tile",template:e("./ImageTile.html"),viewModel:r.default,synchronous:!0});t.default=i});
define("odsp-next/controls/image/tile/ImageTileViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","@ms/odsp-shared/lib/base/Rotation","../../../bindings/imageLoader/ImageLoaderBinding","../../../bindings/imageRecycler/ImageRecyclerBinding","@ms/odsp-utilities/lib/string/StringHelper","@ms/odsp-utilities/lib/math/Transform","@ms/odsp-utilities/lib/math/Rectangle","@ms/odsp-shared/lib/models/image/Alignments","../../../utilities/images/ThumbnailCache","@ms/odsp-utilities/lib/object/ObjectUtil"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.addBindingHandlers({imageLoader:s.default,imageRecycler:o.default});var u=t.image,a=t.rotation,f=void 0===a?i.default.none:a,p=t.desiredSize,d=t.scale,v=void 0===d?1:d,m=t.isLoaded,g=void 0===m?r.createObservable(!1):m,y=t.position,b=t.loadedImage,w=t.error,E=t.loadImageScenarioName,S=n.thumbnailCache,x=void 0===S?r.resources.consume(c.resourceKey):S,T=n.outputExtenders,N=void 0===T?{deferred:!0}:T;r._image=r.wrapObservable(u);r._rotation=r.wrapObservable(f);r._scale=r.wrapObservable(v);r._desiredSize=r.wrapObservable(p);r._alignment=l.createAlignment(t.alignment);r._thumbnailCache=x;r._loadedImage=r.wrapObservable(b);r._error=r.wrapObservable(w);r.isRotating=r._getIsRotating();r.alignmentName=r.createPureComputed(r._computeAlignmentName);r.actualSize=r.createPureComputed(r._computeActualSize);r.actualSize.equalityComparer=h.deepCompare;r.isLoaded=r.createPureComputed(r._computeIsLoaded);r._imageUrl=r.createPureComputed(r._computeImageUrl);r._finalSize=r.createPureComputed(r._computeFinalSize);r._finalSize.equalityComparer=h.deepCompare;r._position=r.createPureComputed(r._computePosition);r._position.equalityComparer=h.deepCompare;r.imageElementStyle=r.createPureComputed(r._computeImageElementStyle);r.imageElementStyle.equalityComparer=h.deepCompare;r.imageBackgroundStyle=r.createPureComputed(r._computeImageBackgroundStyle);r.imageBackgroundStyle.equalityComparer=h.deepCompare;r.createBackgroundComputed(r._computeRecordImage);r.imageLoaderParams={src:r._imageUrl,image:r._loadedImage,error:r._error,scenarioName:E};y&&r.createBackgroundComputed(function(){return y(r._position())}).extend(N);g&&r.createBackgroundComputed(function(){return g(r.isLoaded())}).extend(N);return r}t.prototype._computeImageUrl=function(){var e=this._image();return e&&e.url&&u.format(e.url,e.width,e.height)||""};t.prototype._computeFinalSize=function(){var e,t=this._image(),n=this._scale();if(t&&!t.width){var r=this.actualSize(),i=window.devicePixelRatio||1;e=r&&{width:r.width*n/i,height:r.height*n/i}}else e=t&&{width:t.width*n,height:t.height*n};return e};t.prototype._computeImageElementStyle=function(){var e,t=this._desiredSize(),n=this._finalSize(),r=this._rotation();if(n){var i=void 0;i=t&&t.width&&t.height?t:n;var s=this._alignment.getTransform(n,i),o=s.translate.x/i.width,u=s.translate.y/i.height,f=s.scale*n.width/i.width,l=void 0;if(r){var c=void 0;if(r%2==1){var h={width:n.height,height:n.width};c=this._alignment.getTransform(h,i).multiply(s.invert())}else c=a.default.IDENTITY;l="rotate("+90*r+"deg) scale("+c.scale.toFixed(6)+")"}else l="";e={left:(100*o).toFixed(2)+"%",top:(100*u).toFixed(2)+"%",width:(100*f).toFixed(2)+"%","-webkit-transform":l,"-ms-transform":l,transform:l}}else e={left:"",top:"",width:"","-webkit-transform":"","-ms-transform":"",transform:""};return e};t.prototype._computeImageBackgroundStyle=function(){var e=this._finalSize(),t=this._imageUrl();return{"max-width":e?e.width.toFixed(2)+"px":"","max-height":e?e.height.toFixed(2)+"px":"","background-image":'url("'+t+'")'}};t.prototype._getIsRotating=function(){var e,t=this,n=this.createObservable(this._rotation.peek()),r=this.createPureComputed(function(){var r=t._rotation();e&&t.async.clearTimeout(e);e=t.async.setTimeout(function(){return n(r)},300);return n()});return this.createPureComputed(function(){return t._rotation()!==r()})};t.prototype._computeRecordImage=function(){var e=this._image();e&&this.isLoaded()&&this._thumbnailCache.record(e)};t.prototype._computeIsLoaded=function(){return!!this._loadedImage()};t.prototype._computeActualSize=function(){var e,t=this._loadedImage();if(t){e={width:t.width,height:t.height}}return e};t.prototype._computePosition=function(){var e,t=this._desiredSize(),n=this._finalSize(),r=this._rotation();if(n){var i=void 0;i=t&&t.width&&t.height?t:n;var s=void 0;s=r%2==1?{width:n.height,height:n.width}:n;var o=this._alignment.getTransform(s,i),u=o.translate.x,a=o.translate.y,l=o.scale*s.width,c=o.scale*s.height;e=new f.default(u,a,l,c)}return e};t.prototype._computeAlignmentName=function(){var e;if(!this._rotation())switch(this._alignment.name){case"cover-center":e="cover";break;case"fit-center":e="fit"}return e};return t}(r.default);t.default=p});
define("odsp-next/bindings/imageRecycler/ImageRecyclerBinding",["require","exports","tslib","@ms/odsp-shared/lib/bindings/base/BaseBinding","../imageLoader/ImageLoaderBinding","../../utilities/images/ImageRecycler","knockout"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this,u=r.resources.consume(s.resourceKey),a=r.valueAccessor(),f=u.checkOutImage(),l=r.bindingContext,c=a.attr,h=void 0===c?{}:c,p=a.style,d=a.css,v=a.class;o.applyBindingsToNode(f,{attr:n.__assign({alt:""},h)},l);p&&o.applyBindingsToNode(f,{style:p},l);d&&o.applyBindingsToNode(f,{css:d},l);v&&o.applyBindingsToNode(f,{class:v},l);new(r.managed(i.default))({element:f,allBindingsAccessor:r.allBindingsAccessor,valueAccessor:function(){return a.imageLoader},bindingContext:l});o.virtualElements.setDomNodeChildren(r.element,[f]);r.addDisposable({dispose:function(){if(f){o.cleanNode(f);u.checkInImage(f).done()}}});r.controlsDescendantBindings=!0;return r}t.supportsVirtualElements=!0;return t}(r.default);t.default=u});
define("odsp-next/utilities/images/ImageRecycler",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/async/Signal","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=300;t.EMPTY_IMAGE="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";var u=function(e){n.__extends(r,e);function r(t,n){var r=e.call(this,t,n)||this,i=r._images=[];r.async.setInterval(function(){i.length>o&&i.splice(o,1/0)},6e4);return r}r.prototype.checkOutImage=function(){return this._images.shift()||document.createElement("img")};r.prototype.checkInImage=function(e){var n=this,r=new i.default,s=this.async;s.setTimeout(function(){e.setAttribute("src",t.EMPTY_IMAGE);e.removeAttribute("style");e.removeAttribute("class");s.setTimeout(function(){e.removeAttribute("src");n._images.push(e);r.complete()},1e3)},0);return r.getPromise()};return r}(r.default);t.default=u;t.resourceKey=s.createResolvedResourceKey(e("module").id,u)});
define("@ms/odsp-utilities/lib/math/Transform",["require","exports","./Point","./Rectangle"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){void 0===e&&(e=new n.default);void 0===t&&(t=1);this.translate=e;this.scale=t}e.areEqual=function(e,t,r){void 0===r&&(r=1e-6);return n.default.areEqual(e.translate,t.translate,r)&&Math.abs(Math.log(e.scale/t.scale))<r};e.zoom=function(t,n,r){return new e(t.subtract(n).scale(r-1),r)};e.centerWithinBounds=function(t,i,s){return new e(new r.default(n.default.ORIGIN,t).getCenter().subtract(n.default.getCenter([i,s])))};e.prototype.apply=function(e){return e.scale(this.scale).add(this.translate)};e.prototype.multiply=function(t){return new e(this.translate.add(t.translate.scale(this.scale)),this.scale*t.scale)};e.prototype.invert=function(){return new e(this.translate.scale(-1/this.scale),1/this.scale)};e.IDENTITY=new e;return e}();t.default=i});
define("@ms/odsp-shared/lib/models/image/Alignments",["require","exports","tslib","@ms/utilities-image/lib/Alignments"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@ms/utilities-image/lib/Alignments",["require","exports","@ms/odsp-utilities/lib/math/Transform","@ms/odsp-utilities/lib/math/Point"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.cover=0]="cover";e[e.center=1]="center";e[e.fit=2]="fit";e[e.fitExpand=3]="fitExpand";e[e.fitExpandHeight=4]="fitExpandHeight";e[e.fitExpandWidth=5]="fitExpandWidth";e[e.fitWidth=6]="fitWidth";e[e.fitHeight=7]="fitHeight";e[e.top=8]="top"}(i=t.AlignmentType||(t.AlignmentType={}));var s=function(e,t){this.name=e;this.getTransform=t};function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new s(e.map(function(e){return e.name}).join("-"),function(t,r){for(var i=n.default.IDENTITY,s=0,o=e;s<o.length;s++){var u=o[s],a={width:t.width*i.scale,height:t.height*i.scale};i=u.getTransform(a,r).multiply(i)}return i})}t.center=new s(i[i.center],function(e,t){var i=new r.default((t.width-e.width)/2,(t.height-e.height)/2);return new n.default(i)});t.top=new s(i[i.top],function(e,t){var i=new r.default((t.width-e.width)/2,0);return new n.default(i)});t.fitWidth=new s(i[i.fitWidth],function(e,t){var i=t.width/e.width;return new n.default(r.default.ORIGIN,Math.min(i,1))});t.fitHeight=new s(i[i.fitHeight],function(e,t){var i=t.height/e.height;return new n.default(r.default.ORIGIN,Math.min(i,1))});t.fit=new s(i[i.fit],function(e,n){return(e.width/e.height>n.width/n.height?t.fitWidth:t.fitHeight).getTransform(e,n)});t.fitExpandWidth=new s(i[i.fitExpandWidth],function(e,t){var i=t.width/e.width;return new n.default(r.default.ORIGIN,i)});t.fitExpandHeight=new s(i[i.fitExpandHeight],function(e,t){var i=t.height/e.height;return new n.default(r.default.ORIGIN,i)});t.fitExpand=new s(i[i.fitExpand],function(e,n){return(e.width/e.height>n.width/n.height?t.fitExpandWidth:t.fitExpandHeight).getTransform(e,n)});t.cover=new s(i[i.cover],function(e,n){return(e.width/e.height>n.width/n.height?t.fitHeight:t.fitWidth).getTransform(e,n)});t.fitCenter=o(t.fit,t.center);t.fitExpandCenter=o(t.fitExpand,t.center);t.coverCenter=o(t.cover,t.center);function u(e){var n,r;if("string"==typeof e)n=i[e];else{if(function(e){return"object"==typeof e}(e))return e;n=e}switch(n){case i.top:r=t.top;break;case i.fitHeight:r=t.fitHeight;break;case i.fitWidth:r=t.fitWidth;break;case i.fit:r=t.fitCenter;break;case i.fitExpand:r=t.fitExpandCenter;break;case i.center:r=t.center;break;default:r=t.coverCenter}return r}t.getAlignment=u;t.createAlignment=function(e){var t;t=e instanceof Array?e:[e];return o.apply(void 0,t.map(u))}});
define("odsp-next/controls/image/tile/ImageTile.html",[],function(){return"<span class=od-ImageTile data-bind=\"css: { 'od-ImageTile--isLoaded': isLoaded, 'od-ImageTile--isDimensioned': !!actualSize(), 'od-ImageTile--isRotating': isRotating, 'od-ImageTile--isAligned': !!alignmentName(), 'od-ImageTile--isCustom': !alignmentName() }, class: (alignmentName() ? 'od-ImageTile--' + alignmentName() : '')\"><span class=od-ImageTile-background data-bind=\"style: imageBackgroundStyle\"></span>\x3c!--ko imageRecycler: {\r\n imageLoader: imageLoaderParams,\r\n class: 'od-ImageTile-image',\r\n style: imageElementStyle\r\n }--\x3e\x3c!--/ko--\x3e</span>"});
define("odsp-next/controls/image/tile/ImageTile.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-ImageTile{display:block;position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden}.od-ImageTile img{display:block}.od-ImageTile--cover .od-ImageTile-background{top:0;left:0;bottom:0;right:0;width:100%;height:100%;margin:auto;background-size:cover;background-repeat:no-repeat;background-position:center}.od-ImageTile--fit .od-ImageTile-background{top:0;left:0;bottom:0;right:0;width:100%;height:100%;margin:auto;background-size:contain;background-repeat:no-repeat;background-position:center}.od-ImageTile-image{display:block;opacity:0;position:absolute;box-sizing:border-box}.od-ImageTile-image,a .od-ImageTile-image{border:none}.od-ImageTile-background{display:block;opacity:0;position:absolute;box-sizing:border-box}.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isAligned .od-ImageTile-background{opacity:1}@media screen and (-ms-high-contrast:active){.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isAligned .od-ImageTile-background{opacity:0}}.od-ImageTile--isLoaded.od-ImageTile--isDimensioned.od-ImageTile--isCustom .od-ImageTile-image{opacity:1}@media screen and (-ms-high-contrast:active){.od-ImageTile--isLoaded.od-ImageTile--isDimensioned .od-ImageTile-image{opacity:1}}.od-ImageTile--isRotating .od-ImageTile-image{transition:transform 167ms cubic-bezier(.1,.25,.75,.9)}"}])});
define("odsp-next/controls/icon/glyph/IconGlyph",["require","exports","./IconGlyphViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./IconGlyph.html","./IconGlyph.css"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r.registerComponent({tagName:"od-icon-glyph",template:e("./IconGlyph.html"),viewModel:n.default,synchronous:!0});t.default=i});
define("odsp-next/controls/icon/glyph/IconGlyphViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","knockout"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.icon=i.isObservable(t.icon)?t.icon:i.observable(t.icon);n.badge=i.isObservable(t.badge)?t.badge:i.observable(t.badge);n.iconClasses=n.createComputed(function(){return n.icon()&&n.icon().getClass()||""});n.badgeClasses=n.createComputed(function(){return n.badge()&&n.badge().getClass()||""});return n}return t}(r.default);t.default=s});
define("odsp-next/controls/icon/glyph/IconGlyph.html",[],function(){return"<i class=od-IconGlyph data-bind=\"class: iconClasses, attr: { 'data-icon-name': icon }, css: { 'od-IconGlyph--badged': badge, 'od-IconGlyph--visible': icon }, with: badge\"><i class=od-IconGlyph-badge data-bind=\"class: $component.badgeClasses, attr: { 'data-icon-name': $component.badge }\"></i></i>"});
define("odsp-next/controls/icon/glyph/IconGlyph.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-IconGlyph.ms-Icon{display:none;font-size:16px;text-align:center;white-space:nowrap;position:relative}.od-IconGlyph.ms-Icon.od-IconGlyph--visible{display:inline-block}.od-IconGlyph.ms-Icon.ms-Icon--Add{font-size:15px}.od-IconGlyph-badge.ms-Icon{display:none;position:absolute;top:-.2em;font-size:.7em;width:1em;height:1em;text-align:center;white-space:nowrap}[dir=ltr] .od-IconGlyph-badge.ms-Icon{right:-.2em}[dir=rtl] .od-IconGlyph-badge.ms-Icon{left:-.2em}.od-IconGlyph-badge.ms-Icon.ms-Icon--StatusErrorFull{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:";background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";border-radius:50%;margin-top:0;font-size:12px}.od-IconGlyph-badge.ms-Icon.ms-Icon--StatusErrorFull:before{position:relative;top:-2px}.od-IconGlyph.ms-Icon.od-IconGlyph--badged .od-IconGlyph-badge.ms-Icon{display:inline-block}"}])});
define("odsp-next/controls/siteIcon/SiteIcon.html",[],function(){return"<span class=od-SiteIcon data-bind=\"css: { 'od-SiteIcon--hasIcon': !!icon, 'od-SiteIcon--hasAcronym': !!acronym, 'od-SiteIcon--hasImage': isImageLoaded }, class: 'od-SiteIcon--' + mode, style: { 'background-color': color }\">\x3c!--ko if: !!icon()--\x3e<span class=od-SiteIcon-icon data-bind=\"component: { name: iconGlyphTagName, params: iconGlyphParams }\"></span>\x3c!--/ko--\x3e\x3c!--ko if: !!acronym()--\x3e<span class=od-SiteIcon-acronym aria-hidden=true data-bind=\"style: acronymStyle, text: acronym\"></span>\x3c!--/ko--\x3e\x3c!--ko if: !!iconUrl()--\x3e<span class=od-SiteIcon-image data-bind=\"component: { name: imageTileTagName, params: imageTileParams }\"></span>\x3c!--/ko--\x3e</span>"});
define("odsp-next/controls/siteIcon/SiteIcon.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-SiteIcon{position:absolute;top:0;left:0;bottom:0;right:0;display:block;overflow:hidden;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}.od-SiteIcon--person{border-radius:50%}.isFluent .od-SiteIcon{border-radius:2px}.od-SiteIcon-icon{position:absolute;top:0;left:0;right:0;bottom:0}.od-SiteIcon-icon .od-IconGlyph.ms-Icon{position:absolute;margin:auto;top:0;left:0;bottom:0;right:0;width:100%}.od-SiteIcon-acronym{position:absolute;top:0;left:0;bottom:0;right:0;height:18px;margin:auto;text-align:center;white-space:nowrap;font-weight:100;font-size:13px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:'}.od-SiteIcon-image{position:absolute;top:0;left:0;right:0;bottom:0;visibility:hidden}.od-SiteIcon--site .od-SiteIcon-image:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;box-shadow:inset 0 0 0 1px rgba(0,0,0,.06)}.od-SiteIcon--hasImage .od-SiteIcon-image{visibility:inherit}'}])});
define("odsp-next/controls/leftNav/leftNavSublink/LeftNavSublink.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./LeftNavSublink"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("odsp-next/bindings/teachingBubble/TeachingBubbleBinding",["require","exports","tslib","../../resources/ProviderResourceKeys","@ms/odsp-shared/lib/bindings/base/BaseBinding","../../controls/firstRunExperience/FirstRunExperienceStatus.key","../../controls/firstRunExperience/FirstRunExperienceStatus"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,i=n.resources.consume(r.teachingBubble.optional);if(!i)return n;n.teachingBubbleProvider=i;n._value=n.valueAccessor();n._firstRunExperienceStatus=n.resources.consume(s.resourceKey);n.createBackgroundComputed(n._computeAddTeachingBubble);return n}t.prototype._computeAddTeachingBubble=function(){var e=this.unwrapObservable(this._value);if(e){var t=this.unwrapObservable(e.campaign),n=this.wrapObservable(e.isVisible);if(this._firstRunExperienceStatus()===o.FirstRunExperienceStatus.notVisible&&t){this._campaign&&t.campaignGuid!==this._campaign.campaignGuid&&this.teachingBubbleProvider.currentBubble.peek()&&this.teachingBubbleProvider.currentBubble.peek().campaign===this._campaign&&this.teachingBubbleProvider.clearCurrentBubble();this._campaign=t;this.teachingBubbleProvider.addBubble({bubble:t,isVisible:n,element:this.element})}}};return t}(i.default);t.default=u});
define("odsp-next/controls/leftNav/LeftNav.html",[],function(){return"<div class=LeftNav><div class=LeftNav-linkArea>\x3c!--ko foreach: linkGroups--\x3e\x3c!--ko if: links && links().length > 0--\x3e<div class=LeftNav-linkGroupContainer><div class=LeftNav-linkGroup role=group data-bind=\"automation: automationId, css: { 'is-expanded': isExpanded }, selection: { data: links, mode: 'single', direction: 'vertical', properties: { focused: 'isFocused', href: 'url' } }, attr: { tabindex: $component.isLeftNavVisible() ? 0: -1, 'aria-label': $component.getLinkGroupAriaLabel($data) }\">\x3c!--ko if: !$data.hideGroupHeader--\x3e<div class=LeftNav-linkGroupHeader data-bind=\"attr: { 'title': text }, css: { 'LeftNav-linkGroupHeader--hasPlus': $data.plusIconProperties && $data.plusIconProperties(), 'LeftNav-linkGroupHeader--hasSubText': $data.subText, 'LeftNav-linkGroupHeader--hasIcon': $data.icon, 'ms-fontSize-14': $component.isFluentFlight, 'ms-font-s': !$component.isFluentFlight, 'ms-fontWeight-semibold': $component.isFluentFlight, 'ms-fontWeight-regular': !$component.isFluentFlight }, teachingBubble: { isVisible: $component.isLeftNavVisible, campaign: $data.teachingBubble }, click: $component.onClick.bind($component)\">\x3c!--ko if: $data.icon--\x3e<span class=od-LeftNav-linkGroupHeaderIcon data-bind=\"component: { name: $component.siteIconTagName, params: $data.icon }\"></span>\x3c!--/ko--\x3e<span class=\"od-LeftNav-linkGroupHeaderTitle LeftNav-fadient\" data-bind=\"text: $data.text\"></span>\x3c!--ko if: $data.subText--\x3e<span class=od-LeftNav-linkGroupHeaderSubText data-bind=\"text: $data.subText\"></span>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko control: $data.notificationSublinkSpecification--\x3e\x3c!--/ko--\x3e</div>\x3c!--ko if: !$data.hideGroupHeader && $data.plusIconProperties && $data.plusIconProperties()--\x3e<a class=LeftNav-linkGroup-plusWrapper role=button href=javascript:; data-bind=\"css: { 'LeftNav-basicLink': $data.plusIconProperties().displayLinkWithText, 'LeftNav-linkGroup-addTeamsiteLink': $data.plusIconProperties().displayLinkWithText }, attr: { 'aria-label': $data.plusIconProperties().text, 'title': $data.plusIconProperties().displayLinkWithText ? '' : $data.plusIconProperties().text, tabindex: $component.isLeftNavVisible() ? 0: -1 }, click: function(context, event) { $component.onClick($data.plusIconProperties(), event); }\">\x3c!--ko if: $data.plusIconProperties().displayLinkWithText--\x3e<span data-bind=\"text: $data.plusIconProperties().text\"></span>\x3c!--/ko--\x3e\x3c!--ko ifnot: $data.plusIconProperties().displayLinkWithText--\x3e<i class=\"LeftNav-linkGroup-plus ms-Icon ms-Icon--Add\" data-bind=\"icon: true\"></i>\x3c!--/ko--\x3e</a>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div></div>"});
define("odsp-next/controls/leftNav/LeftNav.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".LeftNav-expandButton.ms-Icon{position:absolute;height:40px;text-align:center;-ms-transform:rotate(0);transform:rotate(0);-ms-transform-origin:50% 50%;transform-origin:50% 50%;line-height:32px;height:32px}[dir=ltr] .LeftNav-expandButton.ms-Icon{left:17px}[dir=rtl] .LeftNav-expandButton.ms-Icon{right:17px}.isFluent .LeftNav-expandButton.ms-Icon{line-height:36px;height:36px}.lg .LeftNav-expandButton.ms-Icon,.md .LeftNav-expandButton.ms-Icon,.sm .LeftNav-expandButton.ms-Icon{height:40px;line-height:40px}.LeftNav-expandButton.is-link.ms-Icon{cursor:default}.LeftNav-linkGroup.is-expanded .LeftNav-expandButton{-ms-transform:rotate(-180deg);transform:rotate(-180deg)}.xlg .LeftNav-linkArea,.xxlg .LeftNav-linkArea,.xxxlg .LeftNav-linkArea,.xxxxlg .LeftNav-linkArea{padding-top:8px}.LeftNav-linkGroupContainer{position:relative;padding:8px 0 0 0}.LeftNav-linkGroupContainer .LeftNav-linkGroup-plusWrapper{top:8px}.LeftNav-linkGroupContainer .LeftNav-linkGroup-addTeamsiteLink{top:0;width:208px}.isFluent .LeftNav-linkGroupContainer .LeftNav-linkGroup-addTeamsiteLink{width:228px}.LeftNav-linkGroupContainer:first-child{padding:24px 0 0 0}.isFluent .LeftNav-linkGroupContainer:first-child{padding:0}.LeftNav-linkGroupContainer:first-child .LeftNav-linkGroup-plusWrapper{top:24px}.isFluent .LeftNav-linkGroupContainer:first-child .LeftNav-linkGroup-plusWrapper{top:8px}.LeftNav-subLinksClip{overflow:hidden}.LeftNav-subLinks{transition:margin-top 267ms cubic-bezier(.1,.9,.2,1)}.LeftNav-subLinks:focus{outline:0}a.LeftNav-link{color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:"}a.LeftNav-subLink{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.isFluent .LeftNav-linkText{position:relative;top:-1px}.LeftNav-linkGroupHeader,a.LeftNav-groupLink,a.LeftNav-link,a.LeftNav-subLink{margin:0;display:block;padding:0 16px 0 16px;border:none;background:0 0;text-decoration:none;white-space:nowrap;overflow:hidden;position:relative;color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}html[dir=rtl] .LeftNav-linkGroupHeader,html[dir=rtl] a.LeftNav-groupLink,html[dir=rtl] a.LeftNav-link,html[dir=rtl] a.LeftNav-subLink{padding:0 16px 0 16px}a.LeftNav-groupLink,a.LeftNav-link,a.LeftNav-subLink{height:32px;line-height:32px}.isFluent a.LeftNav-groupLink,.isFluent a.LeftNav-link,.isFluent a.LeftNav-subLink{height:36px;line-height:36px}.lg a.LeftNav-groupLink,.lg a.LeftNav-link,.lg a.LeftNav-subLink,.md a.LeftNav-groupLink,.md a.LeftNav-link,.md a.LeftNav-subLink,.sm a.LeftNav-groupLink,.sm a.LeftNav-link,.sm a.LeftNav-subLink{height:40px;line-height:40px}[dir=ltr] .LeftNav-linkGroupHeader--hasIcon{padding-left:56px}[dir=rtl] .LeftNav-linkGroupHeader--hasIcon{padding-right:56px}.LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderTitle{line-height:32px;text-overflow:ellipsis;overflow:hidden}.isFluent .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderTitle{line-height:36px}.lg .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderTitle,.md .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderTitle,.sm .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderTitle{line-height:40px}.LeftNav-linkGroupHeader--hasSubText{padding-top:4px;padding-bottom:8px}.LeftNav-linkGroupHeader--hasSubText .od-LeftNav-linkGroupHeaderTitle{line-height:17px;font-size:14px}.lg .LeftNav-linkGroupHeader--hasSubText .od-LeftNav-linkGroupHeaderTitle,.md .LeftNav-linkGroupHeader--hasSubText .od-LeftNav-linkGroupHeaderTitle,.sm .LeftNav-linkGroupHeader--hasSubText .od-LeftNav-linkGroupHeaderTitle{line-height:17px}.LeftNav-linkGroupHeader--hasSubText .od-LeftNav-linkGroupHeaderSubText{line-height:15px}.LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderIcon{display:block;position:absolute;width:32px;height:32px}[dir=ltr] .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderIcon{margin-left:-40px}[dir=rtl] .LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderIcon{margin-right:-40px}.LeftNav-linkGroupHeader .od-LeftNav-linkGroupHeaderSubText{display:block;font-size:12px;text-overflow:ellipsis;overflow:hidden}.od-focus--enabled a.LeftNav-groupLink.LeftNav-is-focused:after,.od-focus--enabled a.LeftNav-link.LeftNav-is-focused:after,.od-focus--enabled a.LeftNav-subLink.LeftNav-is-focused:after{content:'';box-shadow:0 0 0 1px "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:" inset;width:100%;position:absolute;height:100%;left:0;top:0}.od-focus--enabled .LeftNav-linkGroupHeader:focus{box-shadow:0 0 0 1px "},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:" inset;outline:1px solid transparent}a.LeftNav-groupLink:hover,a.LeftNav-link:hover,a.LeftNav-subLink:hover{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}.LeftNav-linkGroupHeader{cursor:default;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";outline:0}.isFluent .LeftNav-linkGroupHeader{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:"}[dir=ltr] .LeftNav-linkGroupHeader--hasPlus{margin-right:20px}[dir=rtl] .LeftNav-linkGroupHeader--hasPlus{margin-left:20px}a.LeftNav-groupLink,a.LeftNav-link,a.LeftNav-subLink{cursor:pointer}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink,html[dir=ltr] a.LeftNav-link,html[dir=ltr] a.LeftNav-subLink{border-left:4px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}html[dir=rtl] a.LeftNav-groupLink,html[dir=rtl] a.LeftNav-link,html[dir=rtl] a.LeftNav-subLink{border-right:4px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){html[dir=ltr] a.LeftNav-groupLink,html[dir=ltr] a.LeftNav-link,html[dir=ltr] a.LeftNav-subLink{border-left:4px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}html[dir=rtl] a.LeftNav-groupLink,html[dir=rtl] a.LeftNav-link,html[dir=rtl] a.LeftNav-subLink{border-right:4px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}a.LeftNav-groupLink:hover:not(.LeftNav-is-active),a.LeftNav-link:hover:not(.LeftNav-is-active),a.LeftNav-subLink:hover:not(.LeftNav-is-active){background:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.isFluent a.LeftNav-groupLink:hover:not(.LeftNav-is-active),.isFluent a.LeftNav-link:hover:not(.LeftNav-is-active),.isFluent a.LeftNav-subLink:hover:not(.LeftNav-is-active){background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink:hover:not(.LeftNav-is-active),html[dir=ltr] a.LeftNav-link:hover:not(.LeftNav-is-active),html[dir=ltr] a.LeftNav-subLink:hover:not(.LeftNav-is-active){border-left:4px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}html[dir=rtl] a.LeftNav-groupLink:hover:not(.LeftNav-is-active),html[dir=rtl] a.LeftNav-link:hover:not(.LeftNav-is-active),html[dir=rtl] a.LeftNav-subLink:hover:not(.LeftNav-is-active){border-right:4px solid "},{theme:"white",defaultValue:"#ffffff"},{rawString:"}}@media screen and (-ms-high-contrast:black-on-white){html[dir=ltr] a.LeftNav-groupLink:hover:not(.LeftNav-is-active),html[dir=ltr] a.LeftNav-link:hover:not(.LeftNav-is-active),html[dir=ltr] a.LeftNav-subLink:hover:not(.LeftNav-is-active){border-left:4px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}html[dir=rtl] a.LeftNav-groupLink:hover:not(.LeftNav-is-active),html[dir=rtl] a.LeftNav-link:hover:not(.LeftNav-is-active),html[dir=rtl] a.LeftNav-subLink:hover:not(.LeftNav-is-active){border-right:4px solid "},{theme:"black",defaultValue:"#000000"},{rawString:"}}@media screen and (-ms-high-contrast:active){a.LeftNav-groupLink:focus,a.LeftNav-link:focus,a.LeftNav-subLink:focus{outline:0;box-shadow:0 0 0 1px "},{theme:"white",defaultValue:"#ffffff"},{rawString:" inset}}@media screen and (-ms-high-contrast:black-on-white){a.LeftNav-groupLink:focus,a.LeftNav-link:focus,a.LeftNav-subLink:focus{outline:0;box-shadow:0 0 0 1px "},{theme:"black",defaultValue:"#000000"},{rawString:" inset}}a.LeftNav-groupLink:active:not(.LeftNav-is-active) .LeftNav-linkText,a.LeftNav-link:active:not(.LeftNav-is-active) .LeftNav-linkText,a.LeftNav-subLink:active:not(.LeftNav-is-active) .LeftNav-linkText{-ms-transform:scale(.95);transform:scale(.95);display:inline-block}a.LeftNav-groupLink.LeftNav-is-active:hover,a.LeftNav-link.LeftNav-is-active:hover,a.LeftNav-subLink.LeftNav-is-active:hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";background:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active:hover,html[dir=ltr] a.LeftNav-link.LeftNav-is-active:hover,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active:hover{border-left:4px solid #1aebff}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active:hover,html[dir=rtl] a.LeftNav-link.LeftNav-is-active:hover,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active:hover{border-right:4px solid #1aebff}}@media screen and (-ms-high-contrast:black-on-white){html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active:hover,html[dir=ltr] a.LeftNav-link.LeftNav-is-active:hover,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active:hover{border-left:4px solid #37006e}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active:hover,html[dir=rtl] a.LeftNav-link.LeftNav-is-active:hover,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active:hover{border-right:4px solid #37006e}}a.LeftNav-groupLink.LeftNav-is-active,a.LeftNav-link.LeftNav-is-active,a.LeftNav-subLink.LeftNav-is-active{font-weight:400;color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";background:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";padding-left:14px}html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active,html[dir=ltr] a.LeftNav-link.LeftNav-is-active,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active{border-left:2px solid "},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active,html[dir=rtl] a.LeftNav-link.LeftNav-is-active,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active{border-right:2px solid "},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}.isFluent a.LeftNav-groupLink.LeftNav-is-active,.isFluent a.LeftNav-link.LeftNav-is-active,.isFluent a.LeftNav-subLink.LeftNav-is-active{font-weight:600;color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";background:"},{theme:"neutralQuaternaryAlt",defaultValue:"#dadada"},{rawString:";padding-left:16px}html[dir=ltr] .isFluent a.LeftNav-groupLink.LeftNav-is-active,html[dir=ltr] .isFluent a.LeftNav-link.LeftNav-is-active,html[dir=ltr] .isFluent a.LeftNav-subLink.LeftNav-is-active{border-left:0 solid transparent}html[dir=rtl] .isFluent a.LeftNav-groupLink.LeftNav-is-active,html[dir=rtl] .isFluent a.LeftNav-link.LeftNav-is-active,html[dir=rtl] .isFluent a.LeftNav-subLink.LeftNav-is-active{border-right:0 solid transparent}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active,html[dir=ltr] a.LeftNav-link.LeftNav-is-active,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active{border-left:4px solid #1aebff}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active,html[dir=rtl] a.LeftNav-link.LeftNav-is-active,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active{border-right:4px solid #1aebff}}@media screen and (-ms-high-contrast:black-on-white){html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active,html[dir=ltr] a.LeftNav-link.LeftNav-is-active,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active{border-left:4px solid #37006e}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active,html[dir=rtl] a.LeftNav-link.LeftNav-is-active,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active{border-right:4px solid #37006e}}.LeftNav-linkGroupHeader>.LeftNav-fadient:after,a.LeftNav-groupLink>.LeftNav-fadient:after,a.LeftNav-link>.LeftNav-fadient:after,a.LeftNav-subLink>.LeftNav-fadient:after{content:'';position:absolute;top:0;width:24px;height:32px;pointer-events:none}[dir=ltr] .LeftNav-linkGroupHeader>.LeftNav-fadient:after,[dir=ltr] a.LeftNav-groupLink>.LeftNav-fadient:after,[dir=ltr] a.LeftNav-link>.LeftNav-fadient:after,[dir=ltr] a.LeftNav-subLink>.LeftNav-fadient:after{right:0}[dir=rtl] .LeftNav-linkGroupHeader>.LeftNav-fadient:after,[dir=rtl] a.LeftNav-groupLink>.LeftNav-fadient:after,[dir=rtl] a.LeftNav-link>.LeftNav-fadient:after,[dir=rtl] a.LeftNav-subLink>.LeftNav-fadient:after{left:0}html[dir=ltr] .isFluent .LeftNav-linkGroupHeader>.LeftNav-fadient:after,html[dir=ltr] .isFluent a.LeftNav-groupLink>.LeftNav-fadient:after,html[dir=ltr] .isFluent a.LeftNav-link>.LeftNav-fadient:after,html[dir=ltr] .isFluent a.LeftNav-subLink>.LeftNav-fadient:after{background-image:linear-gradient(to right,rgba(243,242,241,0) 0,rgba(243,242,241,.5) 25%,#f3f2f1 80%,#f3f2f1 100%)}html[dir=rtl] .isFluent .LeftNav-linkGroupHeader>.LeftNav-fadient:after,html[dir=rtl] .isFluent a.LeftNav-groupLink>.LeftNav-fadient:after,html[dir=rtl] .isFluent a.LeftNav-link>.LeftNav-fadient:after,html[dir=rtl] .isFluent a.LeftNav-subLink>.LeftNav-fadient:after{background-image:linear-gradient(to left,rgba(243,242,241,0) 0,rgba(243,242,241,.5) 25%,#f3f2f1 80%,#f3f2f1 100%)}html[dir=ltr] .LeftNav-linkGroupHeader>.LeftNav-fadient:after,html[dir=ltr] a.LeftNav-groupLink>.LeftNav-fadient:after,html[dir=ltr] a.LeftNav-link>.LeftNav-fadient:after,html[dir=ltr] a.LeftNav-subLink>.LeftNav-fadient:after{background-image:linear-gradient(to right,rgba(255,255,255,0) 0,rgba(255,255,255,.5) 25%,"},{theme:"white",defaultValue:"#ffffff"},{rawString:" 80%,"},{theme:"white",defaultValue:"#ffffff"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=ltr] .LeftNav-linkGroupHeader>.LeftNav-fadient:after,html[dir=ltr] a.LeftNav-groupLink>.LeftNav-fadient:after,html[dir=ltr] a.LeftNav-link>.LeftNav-fadient:after,html[dir=ltr] a.LeftNav-subLink>.LeftNav-fadient:after{background-image:none}}html[dir=rtl] .LeftNav-linkGroupHeader>.LeftNav-fadient:after,html[dir=rtl] a.LeftNav-groupLink>.LeftNav-fadient:after,html[dir=rtl] a.LeftNav-link>.LeftNav-fadient:after,html[dir=rtl] a.LeftNav-subLink>.LeftNav-fadient:after{background-image:linear-gradient(to left,rgba(255,255,255,0) 0,rgba(255,255,255,.5) 25%,"},{theme:"white",defaultValue:"#ffffff"},{rawString:" 80%,"},{theme:"white",defaultValue:"#ffffff"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=rtl] .LeftNav-linkGroupHeader>.LeftNav-fadient:after,html[dir=rtl] a.LeftNav-groupLink>.LeftNav-fadient:after,html[dir=rtl] a.LeftNav-link>.LeftNav-fadient:after,html[dir=rtl] a.LeftNav-subLink>.LeftNav-fadient:after{background-image:none}}html[dir=ltr] .isFluent a.LeftNav-groupLink:hover:not(.LeftNav-is-active)>span:after,html[dir=ltr] .isFluent a.LeftNav-link:hover:not(.LeftNav-is-active)>span:after,html[dir=ltr] .isFluent a.LeftNav-subLink:hover:not(.LeftNav-is-active)>span:after{background-image:linear-gradient(to right,rgba(237,235,233,0) 0,rgba(237,235,233,.5) 25%,#edebe9 80%,#edebe9 100%)}html[dir=rtl] .isFluent a.LeftNav-groupLink:hover:not(.LeftNav-is-active)>span:after,html[dir=rtl] .isFluent a.LeftNav-link:hover:not(.LeftNav-is-active)>span:after,html[dir=rtl] .isFluent a.LeftNav-subLink:hover:not(.LeftNav-is-active)>span:after{background-image:linear-gradient(to left,rgba(237,235,233,0) 0,rgba(237,235,233,.5) 25%,#edebe9 80%,#edebe9 100%)}html[dir=ltr] a.LeftNav-groupLink:hover:not(.LeftNav-is-active)>span:after,html[dir=ltr] a.LeftNav-link:hover:not(.LeftNav-is-active)>span:after,html[dir=ltr] a.LeftNav-subLink:hover:not(.LeftNav-is-active)>span:after{background-image:linear-gradient(to right,rgba(248,248,248,0) 0,rgba(248,248,248,.5) 25%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 80%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink:hover:not(.LeftNav-is-active)>span:after,html[dir=ltr] a.LeftNav-link:hover:not(.LeftNav-is-active)>span:after,html[dir=ltr] a.LeftNav-subLink:hover:not(.LeftNav-is-active)>span:after{background-image:none}}html[dir=rtl] a.LeftNav-groupLink:hover:not(.LeftNav-is-active)>span:after,html[dir=rtl] a.LeftNav-link:hover:not(.LeftNav-is-active)>span:after,html[dir=rtl] a.LeftNav-subLink:hover:not(.LeftNav-is-active)>span:after{background-image:linear-gradient(to left,rgba(248,248,248,0) 0,rgba(248,248,248,.5) 25%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 80%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=rtl] a.LeftNav-groupLink:hover:not(.LeftNav-is-active)>span:after,html[dir=rtl] a.LeftNav-link:hover:not(.LeftNav-is-active)>span:after,html[dir=rtl] a.LeftNav-subLink:hover:not(.LeftNav-is-active)>span:after{background-image:none}}html[dir=ltr] .isFluent a.LeftNav-groupLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=ltr] .isFluent a.LeftNav-link:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=ltr] .isFluent a.LeftNav-subLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after{background-image:linear-gradient(to right,rgba(237,235,233,0) 0,rgba(237,235,233,.5) 25%,#edebe9 80%,#edebe9 100%)}html[dir=rtl] .isFluent a.LeftNav-groupLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=rtl] .isFluent a.LeftNav-link:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=rtl] .isFluent a.LeftNav-subLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after{background-image:linear-gradient(to left,rgba(237,235,233,0) 0,rgba(237,235,233,.5) 25%,#edebe9 80%,#edebe9 100%)}html[dir=ltr] a.LeftNav-groupLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=ltr] a.LeftNav-link:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=ltr] a.LeftNav-subLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after{background-image:linear-gradient(to right,rgba(248,248,248,0) 0,rgba(248,248,248,.5) 25%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 80%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=ltr] a.LeftNav-link:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=ltr] a.LeftNav-subLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after{background-image:none}}html[dir=rtl] a.LeftNav-groupLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=rtl] a.LeftNav-link:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=rtl] a.LeftNav-subLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after{background-image:linear-gradient(to left,rgba(248,248,248,0) 0,rgba(248,248,248,.5) 25%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 80%,"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=rtl] a.LeftNav-groupLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=rtl] a.LeftNav-link:active:not(.LeftNav-is-active) .LeftNav-linkText:after,html[dir=rtl] a.LeftNav-subLink:active:not(.LeftNav-is-active) .LeftNav-linkText:after{background-image:none}}html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active:hover>span:after,html[dir=ltr] a.LeftNav-link.LeftNav-is-active:hover>span:after,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active:hover>span:after{background-image:linear-gradient(to right,rgba(234,234,234,0) 0,rgba(234,234,234,.5) 25%,"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:" 80%,"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active:hover>span:after,html[dir=ltr] a.LeftNav-link.LeftNav-is-active:hover>span:after,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active:hover>span:after{background-image:none}}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active:hover>span:after,html[dir=rtl] a.LeftNav-link.LeftNav-is-active:hover>span:after,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active:hover>span:after{background-image:linear-gradient(to left,rgba(234,234,234,0) 0,rgba(234,234,234,.5) 25%,"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:" 80%,"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active:hover>span:after,html[dir=rtl] a.LeftNav-link.LeftNav-is-active:hover>span:after,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active:hover>span:after{background-image:none}}html[dir=ltr] .isFluent a.LeftNav-groupLink.LeftNav-is-active>span:after,html[dir=ltr] .isFluent a.LeftNav-link.LeftNav-is-active>span:after,html[dir=ltr] .isFluent a.LeftNav-subLink.LeftNav-is-active>span:after{background-image:linear-gradient(to right,rgba(225,223,221,0) 0,rgba(225,223,221,.5) 25%,#e1dfdd 80%,#e1dfdd 100%)}html[dir=rtl] .isFluent a.LeftNav-groupLink.LeftNav-is-active>span:after,html[dir=rtl] .isFluent a.LeftNav-link.LeftNav-is-active>span:after,html[dir=rtl] .isFluent a.LeftNav-subLink.LeftNav-is-active>span:after{background-image:linear-gradient(to left,rgba(225,223,221,0) 0,rgba(225,223,221,.5) 25%,#e1dfdd 80%,#e1dfdd 100%)}html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active>span:after,html[dir=ltr] a.LeftNav-link.LeftNav-is-active>span:after,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active>span:after{background-image:linear-gradient(to right,rgba(244,244,244,0) 0,rgba(244,244,244,.5) 25%,"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:" 80%,"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=ltr] a.LeftNav-groupLink.LeftNav-is-active>span:after,html[dir=ltr] a.LeftNav-link.LeftNav-is-active>span:after,html[dir=ltr] a.LeftNav-subLink.LeftNav-is-active>span:after{background-image:none}}html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active>span:after,html[dir=rtl] a.LeftNav-link.LeftNav-is-active>span:after,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active>span:after{background-image:linear-gradient(to left,rgba(244,244,244,0) 0,rgba(244,244,244,.5) 25%,"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:" 80%,"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:" 100%)}@media screen and (-ms-high-contrast:active){html[dir=rtl] a.LeftNav-groupLink.LeftNav-is-active>span:after,html[dir=rtl] a.LeftNav-link.LeftNav-is-active>span:after,html[dir=rtl] a.LeftNav-subLink.LeftNav-is-active>span:after{background-image:none}}a.LeftNav-subLink{font-weight:100;font-size:17px;text-overflow:ellipsis}.isFluent a.LeftNav-subLink{font-weight:400;font-size:14px}[dir=ltr] a.LeftNav-subLink.LeftNav-subLinkIndent{padding-left:56px}[dir=rtl] a.LeftNav-subLink.LeftNav-subLinkIndent{padding-right:56px}.LeftNav-loadingTemplate,.LeftNav-subLinksAsText{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";padding:8px 16px 8px 16px}html[dir=rtl] .LeftNav-loadingTemplate,html[dir=rtl] .LeftNav-subLinksAsText{padding:8px 16px 8px 16px}.lg .LeftNav-loadingTemplate,.lg .LeftNav-subLinksAsText,.md .LeftNav-loadingTemplate,.md .LeftNav-subLinksAsText,.sm .LeftNav-loadingTemplate,.sm .LeftNav-subLinksAsText{font-size:14px}.xlg .LeftNav-loadingTemplate,.xlg .LeftNav-subLinksAsText,.xxlg .LeftNav-loadingTemplate,.xxlg .LeftNav-subLinksAsText,.xxxlg .LeftNav-loadingTemplate,.xxxlg .LeftNav-subLinksAsText,.xxxxlg .LeftNav-loadingTemplate,.xxxxlg .LeftNav-subLinksAsText{font-size:12px}a.LeftNav-link.is-defaultCursor:hover{cursor:default}.LeftNav-link .ms-Icon--ChevronDown:hover{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:"}.LeftNav-linkGroup-plusWrapper{cursor:pointer;margin:auto;position:absolute;top:0;width:30px;height:32px;font-size:14px;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:"}[dir=ltr] .LeftNav-linkGroup-plusWrapper{right:8px}[dir=rtl] .LeftNav-linkGroup-plusWrapper{left:8px}.isFluent .LeftNav-linkGroup-plusWrapper{height:36px;width:36px;background:0 0}.LeftNav-linkGroup-plusWrapper:hover{background:"},{theme:"neutralLighterAlt",defaultValue:"#f8f8f8"},{rawString:"}.isFluent .LeftNav-linkGroup-plusWrapper:hover{background:0 0}.LeftNav-linkGroup-plusWrapper:active{-ms-transform:scale(.95);transform:scale(.95)}.LeftNav-linkGroup-plus{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";width:14px;height:14px;margin:auto;position:absolute;top:0;bottom:0;right:0;left:0}.isFluent .LeftNav-linkGroup-plus:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.LeftNav-sublinks-icon{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}[dir=ltr] .LeftNav-sublinks-icon{margin-right:10px}[dir=rtl] .LeftNav-sublinks-icon{margin-left:10px}.isFluent .LeftNav-sublinks-icon{font-size:16px;color:"},{theme:"neutralSecondary",defaultValue:"#666666"},{rawString:";vertical-align:top}[dir=ltr] .isFluent .LeftNav-sublinks-icon{margin-right:16px}[dir=rtl] .isFluent .LeftNav-sublinks-icon{margin-left:16px}.LeftNav-sublinks-portrait.has-iconOverlayImage{background-color:transparent}.LeftNav-sublinks-portrait{overflow:hidden;width:28px;height:28px;background-color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";vertical-align:top;font-size:28px;margin-top:2px;position:relative;display:inline-block}[dir=ltr] .LeftNav-sublinks-portrait{margin-right:8px}[dir=rtl] .LeftNav-sublinks-portrait{margin-left:8px}.lg .LeftNav-sublinks-portrait,.md .LeftNav-sublinks-portrait,.sm .LeftNav-sublinks-portrait{height:28px;width:28px;margin-top:6px}.LeftNav-sublinks-portrait.ms-Icon--Group:before{font-size:24px;display:inline-block;margin-top:7px;vertical-align:top;width:39px}[dir=ltr] .LeftNav-sublinks-portrait.ms-Icon--Group:before{padding-right:6px}[dir=rtl] .LeftNav-sublinks-portrait.ms-Icon--Group:before{padding-left:6px}html[dir=ltr] .LeftNav-sublinks-portrait.ms-Icon--Group:before{text-align:right}html[dir=rtl] .LeftNav-sublinks-portrait.ms-Icon--Group:before{text-align:left}[dir=ltr] .LeftNav-sublinks-portrait.ms-Icon--Group:before{margin-left:-6px}[dir=rtl] .LeftNav-sublinks-portrait.ms-Icon--Group:before{margin-right:-6px}.lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,.md .LeftNav-sublinks-portrait.ms-Icon--Group:before,.sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{font-size:28px;margin-top:8px;vertical-align:top;width:46px}[dir=ltr] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=ltr] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=ltr] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{padding-right:6px}[dir=rtl] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=rtl] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=rtl] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{padding-left:6px}html[dir=ltr] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,html[dir=ltr] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,html[dir=ltr] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{text-align:right}html[dir=rtl] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,html[dir=rtl] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,html[dir=rtl] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{text-align:left}[dir=ltr] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=ltr] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=ltr] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{margin-left:-7px}[dir=rtl] .lg .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=rtl] .md .LeftNav-sublinks-portrait.ms-Icon--Group:before,[dir=rtl] .sm .LeftNav-sublinks-portrait.ms-Icon--Group:before{margin-right:-7px}.LeftNav-sublinks-portrait img{max-width:28px;max-height:28px;position:absolute;top:0}[dir=ltr] .LeftNav-sublinks-portrait img{left:0}[dir=rtl] .LeftNav-sublinks-portrait img{right:0}.lg .LeftNav-sublinks-portrait img,.md .LeftNav-sublinks-portrait img,.sm .LeftNav-sublinks-portrait img{width:28px;height:28px}.od-LeftNav-sublink-siteIcon{position:relative;display:inline-block;margin-top:2px;vertical-align:top;width:28px;height:28px}[dir=ltr] .od-LeftNav-sublink-siteIcon{margin-right:4px}[dir=rtl] .od-LeftNav-sublink-siteIcon{margin-left:4px}.isFluent .od-LeftNav-sublink-siteIcon{width:24px;height:24px;margin-top:6px}.lg .od-LeftNav-sublink-siteIcon,.md .od-LeftNav-sublink-siteIcon,.sm .od-LeftNav-sublink-siteIcon{margin-top:4px;width:28px;height:28px}.od-Browser--edge .LeftNav-expandButton.ms-Icon,.od-Browser--ie .LeftNav-expandButton.ms-Icon{line-height:36px}.isFluent .od-Browser--edge .LeftNav-expandButton.ms-Icon,.isFluent .od-Browser--ie .LeftNav-expandButton.ms-Icon{line-height:40px}.lg.od-Browser--edge .LeftNav-expandButton.ms-Icon,.lg.od-Browser--ie .LeftNav-expandButton.ms-Icon,.md.od-Browser--edge .LeftNav-expandButton.ms-Icon,.md.od-Browser--ie .LeftNav-expandButton.ms-Icon,.sm.od-Browser--edge .LeftNav-expandButton.ms-Icon,.sm.od-Browser--ie .LeftNav-expandButton.ms-Icon{line-height:42px}.lg.od-Browser--edge .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.lg.od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.md.od-Browser--edge .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.md.od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.sm.od-Browser--edge .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.sm.od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon{line-height:43px}.od-Browser--edge .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon{line-height:32px}.isFluent .od-Browser--edge .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon,.isFluent .od-Browser--ie .LeftNav-linkGroup.is-expanded .LeftNav-expandButton.ms-Icon{line-height:40px}.LeftNav-notificationLink,.LeftNav-subLinkWarningText{position:relative;display:block;margin:0;padding:8px 20px;height:auto;font-size:12px;font-weight:400;line-height:14px}.isFluent .LeftNav-notificationLink,.isFluent .LeftNav-subLinkWarningText{font-size:14px}.LeftNav-notificationLink.LeftNav-is-active,.LeftNav-subLinkWarningText.LeftNav-is-active{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:"}@media screen and (-ms-high-contrast:active){.LeftNav-notificationLink:focus,.LeftNav-subLinkWarningText:focus{box-shadow:0 0 0 1px "},{theme:"white",defaultValue:"#ffffff"},{rawString:" inset}}@media screen and (-ms-high-contrast:black-on-white){.LeftNav-notificationLink:focus,.LeftNav-subLinkWarningText:focus{box-shadow:0 0 0 1px "},{theme:"black",defaultValue:"#000000"},{rawString:" inset}}.LeftNav-subLinkWarningText.LeftNav-is-active{background-color:#fed9cc}.LeftNav-Button{display:block;height:auto;padding:4px 2px 6px;margin:8px 20px;width:calc(100% - 40px)}.LeftNav-Button.od-Button+.od-Button{margin:4px 20px}.LeftNav-notificationLink{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";font-weight:400}.LeftNav-subLinkWarningText{color:"},{theme:"red",defaultValue:"#e81123"},{rawString:";font-weight:700}.LeftNav-basicLink{display:block;margin:0;padding:8px 16px;position:relative;height:auto;color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:";font-size:12px}.isFluent .LeftNav-basicLink{font-size:14px}html[dir=ltr] .isFluent .LeftNav-basicLink{padding-left:48px}html[dir=rtl] .isFluent .LeftNav-basicLink{padding-right:48px}.LeftNav-bubbleAnchor{position:absolute;top:0;bottom:0}[dir=ltr] .LeftNav-bubbleAnchor{right:0}[dir=rtl] .LeftNav-bubbleAnchor{left:0}.LeftNav-teamifyBanner{box-sizing:border-box;padding:20px}[dir=ltr] .LeftNav-linkGroup-addTeamsiteLink{right:0}[dir=rtl] .LeftNav-linkGroup-addTeamsiteLink{left:0}.od-leftNav-groupLink-container{display:-ms-flexbox;display:flex}.od-leftNav-groupLink-container .LeftNav-fadient{-ms-flex-positive:10;flex-grow:10;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}html[dir=ltr] .od-LeftNav-sublink-sitePin{padding-left:10px}html[dir=rtl] .od-LeftNav-sublink-sitePin{padding-right:10px}"}])});
define("odsp-next/controls/leftNav/leftNavSublink/LeftNavSublink",["require","exports","./LeftNavSublinkViewModel","@ms/odsp-shared/lib/utilities/knockout/ComponentFactory","./templates/LeftNavTemplates","../../../bindings/component/ControlBinding","./LeftNavSublink.html","../LeftNav.css","../../loadingSpinner/LoadingSpinner","../../siteIcon/SiteIcon"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=s.createResolvedControlDefinitionResourceKey({automationName:"ms-left-nav-sublink",name:e("module").id,template:e("./LeftNavSublink.html"),viewModelType:n.default});r.registerTemplate(i.LINK_TEMPLATE,e("./templates/Link.html"));r.registerTemplate(i.INDENTED_TEMPLATE,e("./templates/IndentedLink.html"));r.registerTemplate(i.LOAD_TEMPLATE,e("./templates/Load.html"));r.registerTemplate(i.TEXT_TEMPLATE,e("./templates/Text.html"));r.registerTemplate(i.WARNING_TEXT_TEMPLATE,e("./templates/WarningText.html"));r.registerTemplate(i.GROUPLINK_TEMPLATE,e("./templates/GroupLink.html"));r.registerTemplate(i.MORE_TEMPLATE,e("./templates/More.html"));r.registerTemplate(i.NOTIFICATION_TEMPLATE,e("./templates/NotificationLink.html"));r.registerTemplate(i.BASIC_LINK_TEMPLATE,e("./templates/BasicLink.html"));r.registerTemplate(i.COMPONENT_TEMPLATE,e("./templates/Component.html"));t.default=t.resourceKey});
define("odsp-next/controls/leftNav/leftNavSublink/LeftNavSublinkViewModel",["require","exports","tslib","@ms/odsp-shared/lib/base/ViewModel","../../../providers/engagement/Engagement","@ms/odsp-shared/lib/utilities/logging/LoggingHelper","../LeftNav.resx","./templates/LeftNavTemplates","../../../bindings/teachingBubble/TeachingBubbleBinding","../../../models/teachingBubble/TeachingBubbleCampaigns","../../loadingSpinner/LoadingSpinner","../../../providers/teachingBubble/TeachingBubbleProvider","../../fluentStyling/FluentStyling.key","../../../utilities/features/Features","../../../bindings/component/ControlBinding","../../sitePin/odb/SitePin.key","../../../resources/LoggingResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.loadingSpinnerTagName=l.default.tagName;r.addBindingHandlers({teachingBubble:a.default,control:d.default});var i=t.linkGroup,s=t.isLeftNavVisible,o=void 0===s?r.createObservable(!0):s,u=t.isSublinkMenu,f=void 0===u||u;r._engagement=n.engagement;r._teachingBubbleProvider=n.teachingBubbleProvider;r._rumOneHelper=n.rumOneHelper;r.leftNavItems=i;r.isLeftNavVisible=o;r.isFluentFlight=n.useFluentStyling;r._linksTruncatedWithMore=r.createObservable(!1);void 0!==r.leftNavItems.hideLinksAfterFoldAfter&&r._linksTruncatedWithMore(!0);r.leftNavRenderedItems=r.createPureComputed(r._computeLeftNavRenderedItems);r.shouldMoreBeRendered=r.createPureComputed(function(){return r._linksTruncatedWithMore()&&!!r.leftNavItems.hideLinksAfterFoldAfter&&r.leftNavItems.hideLinksAfterFoldAfter()<r.leftNavItems.links().length});r.sublinkRole=f?"menu":void 0;r.isPinningSiteEnabled=r.createObservable(p.isFeatureEnabled(p.ODBLeftNavPins));r.addDisposable(r.leftNavItems.links.filter(function(e){return!!e.action&&e.action.isAvailable()}));return r}t.prototype.onClick=function(e,t){this._rumOneHelper&&this._rumOneHelper.logOnePageNavigationStart();e.engagementName&&this._engagement.logData({name:e.engagementName+".LeftNav.Click",isIntentional:!0,extraData:n.__assign({},e.engagementExtraData||{},{action:s.capitalizeFirstLetter(t.type)})});var r=this._teachingBubbleProvider,i=r&&r.currentBubble.peek();if(i){var o=i.campaign,u=e.teachingBubble,a=u&&u.campaignGuid===o.campaignGuid,l=this._isLinkSharedLibrary(e)&&o.campaignGuid===f.ODB_SHARED_LIBRARIES.campaignGuid;if(o&&(l||a)){r.clearCurrentBubble();r.markBubbleAsSeen(o)}}e.isFocused(!1);if(e.action){e.action.isAvailable.peek()&&e.action.execute(t);return!1}return!0};t.prototype.toggleMore=function(){this._linksTruncatedWithMore(!1)};t.prototype.renderMode=function(e){var t=e.renderAs;switch(void 0===t?0:t){case 1:return u.TEXT_TEMPLATE;case 2:return u.WARNING_TEXT_TEMPLATE;case 3:return u.LOAD_TEMPLATE;case 4:return u.GROUPLINK_TEMPLATE;case 5:return u.MORE_TEMPLATE;case 6:return u.NOTIFICATION_TEMPLATE;case 7:return u.INDENTED_TEMPLATE;case 8:return u.BASIC_LINK_TEMPLATE;case 9:return u.BUTTON_TEMPLATE;case 10:return u.COMPONENT_TEMPLATE;default:case 0:return u.LINK_TEMPLATE}};t.prototype.getSitePinControl=function(e){return d.toSpecification(v.resourceKey,{engagementName:"LeftNav",onPinClick:this.onPinClick.bind(this),siteItemReference:e.siteItemReference,pinOrder:e.pinOrder&&e.pinOrder(),keysToInvalidate:e.keysToInvalidateOnPinning})};t.prototype.onPinClick=function(e,t){if(this.leftNavItems&&this.leftNavItems.links){var n=this.leftNavItems.links.peek(),r=!1;e&&n.forEach(function(n){if(n&&n.siteItemReference&&n.siteItemReference.SiteId===e.SiteId&&n.pinOrder){r=!0;n.pinOrder(t)}});r&&this.leftNavItems.links(n)}};t.prototype._isLinkSharedLibrary=function(e){return!(!e.engagementName||["SuggestedSite","MoreSites","Sites.CreateGroup"].indexOf(e.engagementName)<0)};t.prototype._computeLeftNavRenderedItems=function(){var e=this.leftNavItems.hideLinksAfterFoldAfter,t=this._sortLeftNavItems(this.leftNavItems.links());this._addExtraEngagementInfo(t);if(this._linksTruncatedWithMore()&&void 0!==e&&e()<t.length){var n=t.slice(0,this.leftNavItems.hideLinksAfterFoldAfter());n.push({text:o.strings.moreLabel,isActive:this.createObservable(!1),isFocused:this.createObservable(!1),renderAs:5});return n}return t};t.prototype._addExtraEngagementInfo=function(e){e&&e.length>0&&e.forEach(function(e,t){e.engagementExtraData=n.__assign({},e.engagementExtraData,{position:t,isPinned:!(!e.pinOrder||!e.pinOrder.peek()),TargetSiteId:e&&e.siteItemReference&&e.siteItemReference.SiteId,TargetWebId:e&&e.siteItemReference&&e.siteItemReference.WebId})})};t.prototype._sortLeftNavItems=function(e){return e&&e.length>0?e.sort(function(e,t){return t.pinOrder&&t.pinOrder.peek()||e.pinOrder&&e.pinOrder.peek()?e.pinOrder&&e.pinOrder.peek()?t.pinOrder&&t.pinOrder.peek()?t.pinOrder.peek()-e.pinOrder.peek():-1:1:t.weight||e.weight?e.weight?t.weight?t.weight-e.weight:-1:1:0}):e};t.dependencies=n.__assign({},r.default.dependencies,{teachingBubbleProvider:c.resourceKey.optional,engagement:i.resourceKey,useFluentStyling:h.resourceKey,rumOneHelper:m.rumOneHelper.optional});return t}(r.default);t.default=g});
define("odsp-next/controls/leftNav/leftNavSublink/templates/LeftNavTemplates",["require","exports","./Link.html","./IndentedLink.html","./Load.html","./Text.html","./WarningText.html","./GroupLink.html","./NotificationLink.html","./More.html","./BasicLink.html","./Component.html"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LINK_TEMPLATE="ms-left-nav-link";t.BUTTON_TEMPLATE="ms-left-nav-button";t.LOAD_TEMPLATE="ms-left-nav-load";t.TEXT_TEMPLATE="ms-left-nav-text";t.WARNING_TEXT_TEMPLATE="ms-left-nav-warning-text";t.GROUPLINK_TEMPLATE="ms-left-nav-groupLink";t.MORE_TEMPLATE="ms-left-nav-more";t.NOTIFICATION_TEMPLATE="ms-left-nav-notificationLink";t.INDENTED_TEMPLATE="ms-left-nav-indentedlink";t.BASIC_LINK_TEMPLATE="ms-left-nav-basicLink";t.COMPONENT_TEMPLATE="ms-left-nav-component"});
define("odsp-next/controls/leftNav/leftNavSublink/templates/Link.html",[],function(){return"\x3c!--ko if: !$data.isHidden || !$data.isHidden()--\x3e<a role=menuitem class=\"LeftNav-subLink ms-font-m\" data-bind=\"attr: { href: $data.url, target: $data.openInNewTab && $data.openInNewTab() ? '_blank' : null, tabindex: isFocused() ? 0: -1, 'aria-current': isActive() ? 'page' : undefined, 'aria-label': $data.altText }, teachingBubble: { isVisible: $component.isLeftNavVisible, campaign: $data.teachingBubble }, hasFocus: isFocused, automation: $data.automationId, css: { 'LeftNav-is-active': isActive, 'LeftNav-is-focused': isFocused }, click: $parent.onClick.bind($parent), automationType: 'Link'\">\x3c!--ko if: $data.icon--\x3e<i class=\"LeftNav-sublinks-icon ms-Icon\" data-bind=\"class: $data.icon.getClass()\">\x3c!--ko if: $data.iconOverlayImageUrl--\x3e<img onerror=\"this.style.display = 'none';\" data-bind=\"attr: { src: $data.iconOverlayImageUrl }\">\x3c!--/ko--\x3e</i>\x3c!--/ko--\x3e<span class=LeftNav-fadient><span class=LeftNav-linkText data-bind=\"text: $data.text, attr: { 'id': $data.domId ? $data.domId : '', 'title': $data.text }\"></span></span></a>\x3c!--/ko--\x3e"});
define("odsp-next/controls/leftNav/leftNavSublink/templates/IndentedLink.html",[],function(){return"<a role=menuitem class=\"LeftNav-subLink LeftNav-subLinkIndent\" data-bind=\"attr: { href: url, target: $data.openInNewTab && $data.openInNewTab() ? '_blank' : null, tabindex: isFocused() ? 0: -1, 'aria-current': isActive() ? 'page' : undefined, 'aria-label': $data.altText }, hasFocus: isFocused, automation: $data.automationId, css: { 'LeftNav-is-active': isActive, 'LeftNav-is-focused': isFocused }, click: $component.onClick.bind($component), automationType: 'Link'\"><span><span class=LeftNav-linkText data-bind=\"text: $data.text\"></span></span></a>"});
define("odsp-next/controls/leftNav/leftNavSublink/templates/Load.html",[],function(){return'<div class=LeftNav-loadingTemplate>\x3c!--ko component: { name: $component.loadingSpinnerTagName, params: { "loadingText": text } }--\x3e\x3c!--/ko--\x3e</div>'});
define("odsp-next/controls/leftNav/leftNavSublink/templates/Text.html",[],function(){return'<div class=LeftNav-subLinksAsText data-bind="html: $data.text"></div>'});
define("odsp-next/controls/leftNav/leftNavSublink/templates/WarningText.html",[],function(){return'<div class=LeftNav-subLinkWarningText data-bind="html: $data.text"></div>'});
define("odsp-next/controls/leftNav/leftNavSublink/templates/GroupLink.html",[],function(){return"<a role=menuitem tabindex=-1 class=\"od-siteItem-SitePin LeftNav-groupLink ms-fontWeight-regular\" data-bind=\"attr: { href: $data.url, target: $data.openInNewTab && $data.openInNewTab() ? '_blank' : null, 'aria-current': isActive() ? 'page' : undefined, title: $data.text }, hasFocus: isFocused, css: { 'LeftNav-is-active': isActive, 'LeftNav-is-focused': $data.isFocused, 'ms-font-s': !$component.isFluentFlight, 'ms-fontSize-14': $component.isFluentFlight }, click: $component.onClick.bind($component), automationType: 'Link'\"><span class=od-leftNav-groupLink-container><span class=LeftNav-fadient><span class=LeftNav-linkText><span class=od-LeftNav-sublink-siteIcon data-bind=\"component: { name: 'ms-site-icon', params: { iconUrl: $data.iconOverlayImageUrl, icon: $data.icon, acronym: $data.acronym, color: $data.color } }\"></span> <span data-bind=\"text: $data.text\"></span></span></span>\x3c!--ko if: $data.allowPinning && $component.isPinningSiteEnabled--\x3e<span class=od-LeftNav-sublink-sitePin data-bind=\"control: $component.getSitePinControl($data)\"></span>\x3c!--/ko--\x3e</span></a>"});
define("odsp-next/controls/leftNav/leftNavSublink/templates/NotificationLink.html",[],function(){return"<a class=LeftNav-notificationLink data-bind=\"attr: { href: $data.url, target: $data.openInNewTab && $data.openInNewTab() ? '_blank' : null, tabindex: $component.isLeftNavVisible() ? 0: -1, 'aria-label': $data.altText }, visible: !$data.show || $data.show(), click: $component.onClick.bind($component), automation: $data.automationId, automationType: 'Link'\"><span class=LeftNav-linkText data-bind=\"text: $data.text\"></span></a>"});
define("odsp-next/controls/leftNav/leftNavSublink/templates/More.html",[],function(){return"<div class=LeftNav-subLinksAsText><a href=# data-bind=\"click: $parent.toggleMore.bind($parent), attr: { tabindex: isFocused() ? 0: -1, 'aria-selected': isActive }, text: $data.text, title: $data.text\"></a></div>"});
define("odsp-next/controls/leftNav/leftNavSublink/templates/BasicLink.html",[],function(){return"<a class=LeftNav-basicLink role=menuitem data-bind=\"attr: { href: url, target: $data.openInNewTab && $data.openInNewTab() ? '_blank' : '', tabindex: $data.isFocused() ? 0: -1, 'aria-current': isActive() ? 'page' : undefined }, css: { 'LeftNav-is-active': isActive, 'LeftNav-is-focused': isFocused }, hasFocus: isFocused, automation: $data.automationId, click: $component.onClick.bind($component)\"><span data-bind=\"text: text\"></span> <span class=LeftNav-bubbleAnchor data-bind=\"teachingBubble: { isVisible: $component.isLeftNavVisible, campaign: $data.teachingBubble }\"></span></a>"});
define("odsp-next/controls/leftNav/leftNavSublink/templates/Component.html",[],function(){return'<div class=LeftNav-subLinksAsComponent data-bind="component: $data.component"></div>'});
define("odsp-next/controls/sitePin/odb/SitePin.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./SitePin"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("odsp-next/controls/leftNav/leftNavSublink/LeftNavSublink.html",[],function(){return"<div class=LeftNav-subLinksClip><div class=LeftNav-subLinks data-bind=\"attr: { role: sublinkRole }, style: { marginTop: 0 }, template: { name: renderMode, foreach: leftNavRenderedItems, as: 'linkItem' }\"></div></div>"});