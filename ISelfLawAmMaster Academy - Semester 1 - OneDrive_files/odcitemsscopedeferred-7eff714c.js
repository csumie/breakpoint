define("@ms/items-view-addon-graph/lib/GraphAddonDeferred",["require","exports","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/addons/registerControlHandler","./models/keys/DriveItemKeyFacet","@ms/items-view/lib/private/operations/createFolder","@ms/items-view/lib/private/operations/deleteItems","@ms/items-view/lib/private/operations/renameItem","@ms/items-view/lib/private/operations/uploadItems","@ms/items-view/lib/private/controls/createFolderActionControl","@ms/items-view/lib/private/controls/renameActionControl","@ms/items-view/lib/private/controls/deleteActionControl","@ms/items-view/lib/private/controls/uploadItemsActionControl","@ms/items-view/lib/private/controls/downloadItemsActionControl","@ms/items-view/lib/private/controls/itemThumbnailControl","@ms/items-view/lib/private/controls/followItemActionControl","./handlers/operations/driveItem/createFolderOperationHandler","./handlers/operations/driveItem/deleteItemsOperationHandler","./handlers/operations/driveItem/renameItemOperationHandler","./handlers/operations/driveItem/uploadItemsOperationHandler","./handlers/controls/driveItem/createFolderActionControlHandler","./handlers/controls/driveItem/renameItemActionControlHandler","./handlers/controls/driveItem/deleteItemsActionControlHandler","./handlers/controls/driveItem/uploadItemsActionControlHandler","./handlers/controls/driveItem/downloadItemsActionControlHandler","./handlers/controls/driveItem/getDefaultShareLinkActionControlHandler","./handlers/controls/driveItem/followItemActionControlHandler","./handlers/controls/driveItem/permissionGrantActionControlHandler","./handlers/controls/itemThumbnailControl","@ms/items-view/lib/private/controls/getDefaultShareLinkActionControl","@ms/items-view/lib/private/controls/permissionInviteActionControl","./models/keys/DriveFollowedItemKeyFacet","./handlers/operations/driveItem/followItemOperationHandler","@ms/items-view/lib/private/operations/followItem","@ms/items-view/lib/private/controls/itemsViewSearchControl","./handlers/controls/itemsViewSearchControl","./models/keys/DriveItemSetKeyFacet","./models/keys/SearchItemSetKeyFacet","@ms/items-view/lib/private/controls/filteredItemSetControl","./handlers/controls/driveItemSetFilteredItemSetControlHandler"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.graphAddonDeferred=n.createAddon(function(){return function(e){e(r.registerControlHandler(B.driveItemSetKeyFacet,P.itemsViewSearchControl)(H.driveItemSearchControlHandler));e(r.registerControlHandler(j.searchItemSetKeyFacet,P.itemsViewSearchControl)(H.searchItemSearchControlHandler));e(r.registerControlHandler(B.driveItemSetKeyFacet,F.filteredItemSetControl)(I.driveItemSetFilteredItemSetControlHandler));e(n.registerOperationHandler(i.driveItemKeyFacet,s.createFolderOperation)(m.driveItemCreateFolderOperationHandler));e(n.registerOperationHandler(i.driveItemKeyFacet,o.deleteItemsOperation)(g.driveItemDeleteItemsOperationHandler));e(n.registerOperationHandler(i.driveItemKeyFacet,u.renameItemOperation)(y.driveItemRenameItemOperationHandler));e(n.registerOperationHandler(i.driveItemKeyFacet,a.uploadItemsOperation)(b.driveItemUploadItemsOperationHandler));e(r.registerControlHandler(i.driveItemKeyFacet,f.createFolderActionControl)(w.driveItemCreateFolderActionControlHandler));e(r.registerControlHandler(i.driveItemKeyFacet,l.renameActionControl)(E.driveItemRenameItemActionControlHandler));e(r.registerControlHandler(i.driveItemKeyFacet,c.deleteActionControler)(S.driveItemDeleteItemsActionControlHandler));e(r.registerControlHandler(i.driveItemKeyFacet,h.uploadItemsActionControl)(x.driveItemUploadItemsActionControlHandler));e(r.registerControlHandler(i.driveItemKeyFacet,A.shareLinkActionControl)(N.driveItemDefaultShareLinkControlHandler));e(r.registerControlHandler(i.driveItemKeyFacet,O.permissionInviteActionControl)(k.driveItemPermissionGrantControlHandler));e(r.registerControlHandler(i.driveItemKeyFacet,p.downloadItemsActionControlFacet)(T.driveItemDownloadItemsActionControlHandler));e(r.registerControlHandler(i.driveItemKeyFacet,d.itemThumbnailControl)(L.driveItemThumbnailControlHandler));e(r.registerControlHandler(i.driveItemKeyFacet,v.followItemActionControl)(C.driveItemfollowItemActionControlHandler));e(n.registerOperationHandler(M.driveFollowedItemKeyFacet,D.followItemOperation)(_.driveItemFollowItemOperationHandler))}})});
define("@ms/items-view/lib/private/operations/createFolder",["require","exports","../models/Facet","../store/actions/implementOperation"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createFolderOperation=new n.Facet("createFolder");t.createFolder=r.implementOperation({operationTypeFacet:t.createFolderOperation})});
define("@ms/items-view/lib/private/operations/deleteItems",["require","exports","../models/Facet","./progress"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.deleteItemsOperation=new n.Facet("deleteItems");t.deleteProgressKeyFacet=new r.ProgressKeyFacet("deleteItems");t.deleteItems=r.implementOperationWithProgress({operationTypeFacet:t.deleteItemsOperation,progressKeyFacet:t.deleteProgressKeyFacet})});
define("@ms/items-view/lib/private/operations/progress",["require","exports","tslib","../models/KeyFacet","../models/AutoKeyFacet","./getItems","../store/actions/createActionCreator","../models/Facet","../utilities/Graft","../store/actions/implementOperation","../facets/ProgressFacets","../facets/SetFacets","../facets/GroupFacets","../facets/DemandFacets","./readItems","../utilities/async/CancelError","../addons/registerOperationHandler","../models/items/ItemResolver","./pruneItems"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.progressRootItemKeyFacet=new r.KeyFacet("progressRoot",{});t.progressRootItemKey=t.progressRootItemKeyFacet.serialize({});t.progressAddon=m.createAddon(function(){return function(e){var n;e(y.registerPermanentItemDemands({items:(n={},n[t.progressRootItemKey]={},n)}));e(s.supportFacets({keyFacet:t.progressRootItemKeyFacet,facets:[]}))}});t.expireProgressItems=o.createAsyncActionCreator(function(e){var r=Object.keys(e.items);return function(e){var i=e(d.readItems(function(e){var i,s,o=new g.ItemResolver,f={};if(r)for(var h=0,p=r;h<p.length;h++){var d=p[h],v=E(e,{itemKey:d});if(v===l.ProgressPhase.canceled||v===l.ProgressPhase.completed||v===l.ProgressPhase.failed){f[d]=!0;o.resolveItems({items:(i={},i[d]=n.__assign({},l.progressPhaseFacet.pack(l.ProgressPhase.expired)),i)})}}o.resolveItems({items:(s={},s[t.progressRootItemKey]=u.pack({childItems:c.childItemsFacet},{childItems:{itemKeys:new a.ArrayRemoveMatchPatch(function(e){return!!f[e]})}}),s)});return{itemResolver:o}}));return e(i.itemResolver.execute())}});var b=new u.Facet("blockExpiration"),w=new i.AutoKeyFacet("blockExpirationOwner");t.blockProgressExpiration=o.createAsyncActionCreator(function(e){var r=w.serializeNext();return function(e){var i,f;e(s.resolveItems({items:(i={},i[t.progressRootItemKey]=n.__assign({},b.pack((f={},f[r]=!0,f))),i)}));return o.createAsyncActionCreator(function(n){return function(n){var i,o;e(s.resolveItems({items:(i={},i[t.progressRootItemKey]=u.pack({blockExpiration:b},{blockExpiration:(o={},o[r]=new a.Delete,o)}),i)}))}})}});t.isProgressExpirationBlocked=function(e,n){var r=e.demandItemFacet(b,t.progressRootItemKey);return!!r&&Object.keys(r).length>0};t.getTotalProgressSize=function(e,t){return e.demandItemFacet(l.overallProgressSizeFacet,t.itemKey)};function E(e,t){return e.demandItemFacet(l.overallProgressPhaseFacet,t.itemKey)||l.DEFAULT_PROGRESS_PHASE}t.getOverallProgressPhase=E;t.getItemCountsByProgressPhase=function(e,t){return e.demandItemFacet(l.overallProgressCountsFacet,t.itemKey)||l.DEFAULT_PROGRESS_COUNTS};t.getOverallSimpleProgressBreakdown=function(e,t){return e.demandItemFacet(l.overallSimpleProgressBreakdownFacet,t.itemKey)||l.DEFAULT_SIMPLE_PROGRESS_BREAKDOWN};t.progressBatchKeyFacet=new i.AutoKeyFacet("progressBatch");var S=function(e){n.__extends(i,e);function i(n,i){var s=e.call(this,"progress-"+n,{taskKey:r.stringPart(),batch:r.subKeyPart(t.progressBatchKeyFacet)})||this;s._getTaskKey=i;return s}i.prototype.serializeBatchKey=function(e){return this.serialize({batch:t.progressBatchKeyFacet.deserialize(e),taskKey:void 0})};i.prototype.serializeTaskKey=function(e,n,r){var i=this._getTaskKey;return this.serialize({batch:t.progressBatchKeyFacet.deserialize(e),taskKey:i?i(n,r):n})};return i}(r.KeyFacet);t.ProgressKeyFacet=S;t.implementOperationWithProgress=function(e){var r=this,i=e.operationTypeFacet,s=e.progressKeyFacet,p=e.initializeBatch;return o.createAsyncActionCreator(function(e){var o=e.items;return function(d){return n.__awaiter(r,void 0,void 0,function(){var r,v,m,b,w,E,S,T,N,C,k,L,A,O;return n.__generator(this,function(M){switch(M.label){case 0:b=t.progressBatchKeyFacet.serializeNext();w=s.serializeBatchKey(b);E={};d(y.registerItemDemands({owner:E,items:(r={},r[w]={},r)}));S=[];T=new g.ItemResolver;for(L in o)if(Object.prototype.hasOwnProperty.call(o,L)){A=o[L];O=s.serializeTaskKey(b,L,A);T.resolveItems({items:(v={},v[O]=n.__assign({},l.sourceItemFacet.pack({itemKey:L}),u.pack({options:i},{options:A}),l.progressPhaseFacet.pack(l.ProgressPhase.created)),v)});S.push(O)}T.resolveItems({items:(m={},m[t.progressRootItemKey]=u.pack({childItems:c.childItemsFacet},{childItems:{itemKeys:new a.ArrayConcatIfNotMatchKeyPatch([w],function(e){return e})}}),m[w]=n.__assign({},u.pack({childItems:c.childItemsFacet},{childItems:{itemKeys:new a.ArrayConcatIfNotMatchKeyPatch(S,function(e){return e})}}),h.isGroupFacet.pack(!0)),m)});d(T.execute());p&&d(p(n.__assign({},e,{progressBatchKey:w})));N=d(f.startOperation({operationTypeFacet:i,items:o})),C=N.completed,k=N.items;for(L in k)if(Object.prototype.hasOwnProperty.call(k,L)){A=o[L];O=s.serializeTaskKey(b,L,A);d(x(n.__assign({progressItemKey:O},k[L])))}M.label=1;case 1:M.trys.push([1,,3,4]);return[4,C];case 2:M.sent();return[3,4];case 3:d(y.removeItemDemands({owner:E}));return[7];case 4:return[2]}})})}})};function x(e){var t=this,r=e.progressItemKey,i=e.started,o=e.completed;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,u,a,f,c,h;return n.__generator(this,function(d){switch(d.label){case 0:c={};e(y.registerItemDemands({owner:c,items:(t={},t[r]={},t)}));d.label=1;case 1:d.trys.push([1,4,5,6]);return[4,i];case 2:d.sent();e(s.resolveItems({items:(u={},u[r]=n.__assign({},l.progressPhaseFacet.pack(l.ProgressPhase.started)),u)}));return[4,o];case 3:d.sent();e(s.resolveItems({items:(a={},a[r]=n.__assign({},l.progressPhaseFacet.pack(l.ProgressPhase.completed)),a)}));return[3,6];case 4:h=d.sent();e(s.resolveItems({items:(f={},f[r]=n.__assign({},l.progressPhaseFacet.pack(v.isCancel(h)?l.ProgressPhase.canceled:l.ProgressPhase.failed),h?n.__assign({},p.errorFacet.pack(h)):{}),f)}));return[3,6];case 5:e(y.removeItemDemands({owner:c}));return[7];case 6:return[2]}})})}}t.trackItemProgress=x;t.createCancelProgressItemsOperationHandler=function(e){return m.createBatchedItemsOperationHandler()(function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,s;return n.__generator(this,function(o){t=r(d.readItems(function(t){var r=new g.ItemResolver,i=[];function s(e){var o,f=t.demandItemFacet(l.cancelSourceFacet,e);f&&i.push(f);r.resolveItems({items:(o={},o[e]=n.__assign({},f?{}:n.__assign({},l.progressPhaseFacet.pack(l.ProgressPhase.canceled)),u.pack({error:p.errorFacet},{error:new a.Delete})),o)});var h=t.demandItemFacet(c.childItemsFacet,e);if(h)for(var d=0,v=h.itemKeys;d<v.length;d++){s(v[d])}}for(var o in e.items)Object.prototype.hasOwnProperty.call(e.items,o)&&s(o);return{itemResolver:r,sourcesToCancel:i}}));r(t.itemResolver.execute());for(i=0,s=t.sourcesToCancel;i<s.length;i++)s[i].cancel();return[2]})})}})}});
define("@ms/items-view/lib/private/facets/ProgressFacets",["require","exports","tslib","../models/Facet","../models/itemCache/ComputedItemFacet","./SetFacets"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createdItemFacet=new r.Facet("createdItem");t.sourceItemFacet=new r.Facet("sourceItem");t.destinationItemFacet=new r.Facet("destinationItem");t.conflictResolutionFacet=new r.Facet("conflictResolution");t.ProgressPhase={created:"created",started:"started",completed:"completed",failed:"failed",canceled:"canceled",expired:"expired"};t.progressPhaseFacet=new r.Facet("phase");t.progressSizeFacet=new r.Facet("progressSize");t.cancelSourceFacet=new r.Facet("cancelSource");t.DEFAULT_PROGRESS_COUNTS={created:0,started:0,completed:0,failed:0,canceled:0,expired:0};t.DEFAULT_PROGRESS_PHASE=t.ProgressPhase.created;t.overallProgressCountsFacet=new i.ComputedItemFacet("overallProgressCounts",function(e,r){var i=n.__assign({},t.DEFAULT_PROGRESS_COUNTS),o=e.demandItemFacet(t.progressPhaseFacet,r.itemKey);o&&i[o]++;var u=e.demandItemFacet(s.childItemsFacet,r.itemKey);if(u)for(var a=0,f=u.itemKeys;a<f.length;a++){var l=f[a],c=e.demandItemFacet(t.overallProgressCountsFacet,l);if(c){i.created+=c.created;i.started+=c.started;i.completed+=c.completed;i.failed+=c.failed;i.canceled+=c.canceled;i.expired+=c.expired}}return i});t.overallProgressPhaseFacet=new i.ComputedItemFacet("overallProgressPhase",function(e,n){var r=e.demandItemFacet(t.overallProgressCountsFacet,n.itemKey);if(r)return o(r)});function o(e){return e.started?t.ProgressPhase.started:e.created?t.ProgressPhase.created:e.failed?t.ProgressPhase.failed:e.completed?t.ProgressPhase.completed:e.canceled?t.ProgressPhase.canceled:t.ProgressPhase.expired}t.getPhaseFromItemCountsByPhase=o;t.overallProgressSizeFacet=new i.ComputedItemFacet("overallProgressSize",function(e,n){var r=e.demandItemFacet(t.progressSizeFacet,n.itemKey);if(r)return r;var i=e.demandItemFacet(s.childItemsFacet,n.itemKey);if(i){for(var o={total:0,current:0},u=0,a=i.itemKeys;u<a.length;u++){var f=a[u],l=e.demandItemFacet(t.overallProgressSizeFacet,f);if(!l)return;o.current+=l.current;o.total+=l.total}return o}});t.DEFAULT_SIMPLE_PROGRESS_PHASE=t.ProgressPhase.started;t.DEFAULT_SIMPLE_PROGRESS_BREAKDOWN={phase:t.DEFAULT_SIMPLE_PROGRESS_PHASE,count:0};t.overallSimpleProgressBreakdownFacet=new i.ComputedItemFacet("overallSimpleProgressBreakdown",function(e,n){var r=e.demandItemFacet(t.overallProgressCountsFacet,n.itemKey);if(r)return u(r)});function u(e){return e.started||e.created?{phase:t.ProgressPhase.started,count:e.started+e.completed+e.created+e.failed}:e.failed?{phase:t.ProgressPhase.failed,count:e.failed}:e.completed?{phase:t.ProgressPhase.completed,count:e.completed}:{phase:t.ProgressPhase.canceled,count:e.canceled+e.expired}}t.getSimpleProgressBreakdown=u});
define("@ms/items-view/lib/private/operations/renameItem",["require","exports","../models/Facet","./progress","../models/KeyFacet"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.renameItemOperation=new n.Facet("renameItem");var s=new i.KeyFacet("renameItemProgressItem",{itemKey:i.stringPart(),oldName:i.stringPart()});t.renameProgressKeyFacet=new r.ProgressKeyFacet("renameItems",function(e,t){var n=Object.keys(t.names)[0];return s.serialize({itemKey:e,oldName:n})});t.renameItem=r.implementOperationWithProgress({operationTypeFacet:t.renameItemOperation,progressKeyFacet:t.renameProgressKeyFacet})});
define("@ms/items-view/lib/private/operations/uploadItems",["require","exports","tslib","../store/actions/implementOperation","../models/Facet"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadItemsOperation=new i.Facet("uploadItems");t.uploadItems=r.implementOperation({operationTypeFacet:t.uploadItemsOperation});var s=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t}(r.ItemOperationError);t.UploadItemOperationError=s});
define("@ms/items-view/lib/private/controls/createFolderActionControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createFolderActionControl=new n.ControlFacet("createFolderActionControl")});
define("@ms/items-view/lib/private/controls/renameActionControl",["require","exports","../models/controls/ControlFacet","../components/controls/defaultRenderComponentControlOption"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.renameActionControl=new n.ControlFacet("renameActionControl",{renameWizard:r.defaultRenderComponentOption()})});
define("@ms/items-view/lib/private/controls/deleteActionControl",["require","exports","../models/controls/ControlFacet","../components/controls/defaultRenderComponentControlOption"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.deleteActionControl=new n.ControlFacet("deleteActionControl",{deleteWizard:r.defaultRenderComponentOption()});t.deleteActionControler=t.deleteActionControl});
define("@ms/items-view/lib/private/controls/itemThumbnailControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemThumbnailControl=new n.ControlFacet("itemThumbnailControl")});
define("@ms/items-view-addon-graph/lib/handlers/operations/driveItem/createFolderOperationHandler",["require","exports","tslib","../../../models/keys/DriveItemKeyFacet","@ms/items-view/lib/private/addons/registerOperationHandler","../../../utilities/Data","@ms/items-view/lib/private/facets/ProgressFacets","@ms/items-view/lib/private/facets/SetFacets","../../../utilities/getDriveItemFacets","@ms/items-view/lib/private/models/items/ItemResolver"],function(e,t,n,r,i,s,o,u,a,f){"use strict";var l=this;Object.defineProperty(t,"__esModule",{value:!0});t.driveItemCreateFolderOperationHandler=i.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,i=e.options.folders,c=r.driveItemKeyFacet.deserialize(t),h=c.endpoint,p=c.driveId,d=Object.keys(i)[0],v=i[d].progressItemKey;return function(e){return n.__awaiter(l,void 0,void 0,function(){var i,l,m,g,y,b,w;return n.__generator(this,function(E){switch(E.label){case 0:g=s.getDriveItemUrl(c)+"/children";return[4,e(s.getRawData({url:g,method:"POST",body:{name:d,folder:{},"@microsoft.graph.conflictBehavior":"rename"},qosName:"createFolder",endpoint:h}))];case 1:y=E.sent();b=r.driveItemKeyFacet.serialize({endpoint:h,driveId:p,itemId:y.id});w=new f.ItemResolver;v&&w.resolveItems({items:(i={},i[v]=n.__assign({},o.createdItemFacet.pack({itemKey:b})),i)});w.invalidateItems({items:(l={},l[t]=[u.defaultChildItemSetFacet],l)});w.resolveItems({items:(m={},m[b]=n.__assign({},a.getDriveItemFacets({driveItem:y,parentFolderItemKey:t,endpoint:h})),m)});e(w.execute());return[2]}})})}})});
define("@ms/items-view-addon-graph/lib/handlers/operations/driveItem/deleteItemsOperationHandler",["require","exports","tslib","../../../models/keys/DriveItemKeyFacet","@ms/items-view/lib/private/addons/registerOperationHandler","../../../utilities/Data","@ms/items-view/lib/private/operations/invalidateItems","@ms/items-view/lib/private/facets/ItemFacets"],function(e,t,n,r,i,s,o,u){"use strict";var a=this;Object.defineProperty(t,"__esModule",{value:!0});t.driveItemDeleteItemsOperationHandler=i.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,i=r.driveItemKeyFacet.deserialize(t);return function(e){return n.__awaiter(a,void 0,void 0,function(){var r,a;return n.__generator(this,function(n){switch(n.label){case 0:a=s.getDriveItemUrl(i);return[4,e(s.getRawData({url:a,method:"DELETE",qosName:"deleteItem",endpoint:i.endpoint}))];case 1:n.sent();e(o.invalidateItems({items:(r={},r[t]=[u.deletedFacet],r)}));return[2]}})})}})});
define("@ms/items-view-addon-graph/lib/handlers/operations/driveItem/renameItemOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/store/actions/implementOperation","../../../models/keys/DriveItemKeyFacet","@ms/items-view/lib/private/addons/registerOperationHandler","../../../utilities/Data","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/facets/ErrorFacets","../../../utilities/getDriveItemFacets","@ms/items-view/lib/private/operations/readItem","@ms/items-view/lib/private/models/items/ItemResolver"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";var h=this;Object.defineProperty(t,"__esModule",{value:!0});t.driveItemRenameItemOperationHandler=s.createSingleItemOperationHandler({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,s=e.options.names,p=i.driveItemKeyFacet.deserialize(t);return function(e){return n.__awaiter(h,void 0,void 0,function(){var i,h,d,v,m,g,y;return n.__generator(this,function(b){switch(b.label){case 0:i=Object.keys(s)[0];h=s[i],d=h.newName,v=h.newExtension;m=o.getDriveItemUrl(p);g=e(l.readItem({fileName:u.fileNameFacet},t)).fileName;y="string"==typeof v?v:g&&g.extension||"";return[4,e(o.getRawData({url:m,method:"PATCH",body:{name:""+d+y},qosName:"renameItem",endpoint:p.endpoint})).then(function(r){var i,s,o=new c.ItemResolver;o.invalidateItems({items:(i={},i[t]=[u.displayNameFacet],i)});o.resolveItems({items:(s={},s[t]=n.__assign({},u.displayNameFacet.pack(r.name),u.fileNameFacet.pack(f.getFileName(r.name||"",!!r.folder))),s)});e(o.execute())}).catch(function(e){if(e.status===r.STATUS_CODE_ZERO)throw new r.ItemOperationError({facets:n.__assign({},a.offlineErrorFacet.pack({}))});throw e})];case 1:b.sent();return[2]}})})}})});
define("@ms/items-view-addon-graph/lib/handlers/operations/driveItem/uploadItemsOperationHandler",["require","exports","tslib","@ms/odsp-graph/lib/services/upload/Uploader","@ms/odsp-graph/lib/services/upload/UploadService","@ms/odsp-graph/lib/services/upload/UploadWaiter","@ms/odsp-graph/lib/services/upload/UploadStateMachine","@ms/odsp-graph/lib/services/upload/ActivityBandwidthVerifier","../../../utilities/Data","../../../utilities/Auth","../../../utilities/getDriveItemFacets","@uifabric/utilities/lib/Async","@ms/items-view/lib/private/store/middleware/RunOnceMiddleware","../../../models/keys/DriveItemKeyFacet","@ms/items-view/lib/private/addons/registerOperationHandler","@ms/items-view/lib/private/operations/readItem","@ms/items-view/lib/private/operations/readItems","@ms/items-view/lib/private/facets/FileSystemFacets","@ms/items-view/lib/private/operations/getItems","@ms/items-view/lib/private/facets/ProgressFacets","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/facets/SetFacets","@ms/odsp-utilities/lib/async/Promise","@ms/items-view/lib/private/utilities/async/CancelError","@ms/items-view/lib/private/models/items/ItemResolver"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var N=h.asOnceOnly(function(){return new s.UploadWaiter({},{})}),C=h.asOnceOnly(function(e){var t=e(a.getDataRequestor),s=function(e){n.__extends(t,e);function t(t){return e.call(this,t,{performanceNow:u.performanceNow})||this}return t}(u.ActivityBandwidthVerifier),f=new i.UploadService({},{dataRequestor:t}),l=new o.UploadStateMachine({},{activityBandwidthVerifierType:s,uploadService:f});return new r.Uploader({},{uploadService:f,uploadStateMachine:l})}),k=0;t.driveItemUploadItemsOperationHandler=d.createSingleItemOperationHandler({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,r=e.itemKey,i=e.options.sourceEntries,s=p.driveItemKeyFacet.deserialize(r),o=s.endpoint,u=s.driveId,f=Object.keys(i)[0],c=i[f].progressItemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,h,d,m,S,x,N,C;return n.__generator(this,function(k){switch(k.label){case 0:if(!(m=e(v.readItem({sourceFile:g.sourceFileFacet},f)).sourceFile))throw new Error("No source file for Graph upload.");S=a.getDriveItemUrl(s)+":";c&&e(y.resolveItems({items:(t={},t[c]=n.__assign({},b.progressSizeFacet.pack({total:m.size,current:0})),t)}));return[4,e(L({progressItemKey:c,sourceFile:m,itemUrl:S,endpoint:o}))];case 1:x=k.sent();N=p.driveItemKeyFacet.serialize({endpoint:o,driveId:u,itemId:x.id});C=new T.ItemResolver;c&&C.resolveItems({items:(i={},i[c]=n.__assign({},b.createdItemFacet.pack({itemKey:N}),w.pack({progressSize:b.progressSizeFacet},{progressSize:{current:m.size}})),i)});C.invalidateItems({items:(h={},h[r]=[E.defaultChildItemSetFacet],h)});C.resolveItems({items:(d={},d[N]=n.__assign({},l.getDriveItemFacets({driveItem:x,parentFolderItemKey:r,endpoint:o})),d)});e(C.execute());return[2]}})})}});function L(e){var t=this,r=e.progressItemKey,i=e.sourceFile,s=e.itemUrl,o=e.endpoint;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,u,a,l,h,p,d,v,g,E;return n.__generator(this,function(n){switch(n.label){case 0:t=e(C);u=e(N);return[4,e(f.getSessionToken(o))];case 1:a=n.sent();l=new c.Async;h=0;p=l.debounce(function(t){var n;if(t>h){r&&e(y.resolveItems({items:(n={},n[r]=w.pack({progressSize:b.progressSizeFacet},{progressSize:{current:t}}),n)}));h=t}},300,{leading:!1});d=e(m.readItems(function(e){return e.demandItemFacet(b.cancelSourceFacet,r)}));v=t.upload({conflictBehavior:"fail",qosData:{uploadId:""+ ++k},accessToken:a,fileName:i.name,content:i,itemUrl:s,onProgress:p,onPromptForConfictBehavior:function(e){return Promise.reject(e)},onWait:function(e){return u.wait(e)}});g=d?d.token.subscribe(function(){v.cancel()}):void 0;n.label=2;case 2:n.trys.push([2,4,5,6]);return[4,v];case 3:return[2,n.sent()];case 4:E=n.sent();if(S.default.isCanceled(E))throw new x.CancelError;throw E;case 5:g&&g();l.dispose();return[7];case 6:return[2]}})})}}});
define("@ms/odsp-graph/lib/services/upload/Uploader",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","../../models/error/Error","@ms/odsp-utilities/lib/logging/events/Qos.event"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){var n=t.uploadService,r=t.uploadStateMachine,i=t.useStreamingUpload,s=void 0!==i&&i;this._uploadService=n;this._uploadStateMachine=r;this._useStreamingUpload=s}e.prototype.upload=function(e){var t=e.conflictBehavior,o=n.__rest(e,["conflictBehavior"]),u=o.qosData,a=new s.Qos({name:"VroomUploader.upload",extraData:u});return this._uploadState(o,{conflictBehavior:t,allowStreaming:this._useStreamingUpload}).then(function(e){a.end({resultType:s.ResultTypeEnum.Success});return e},function(e){a.end({resultType:r.default.isCanceled(e)?s.ResultTypeEnum.ExpectedFailure:s.ResultTypeEnum.Failure,error:e.message,resultCode:i.getResultCodeFromError(e),extraData:n.__assign({},u,i.getQosExtraDataFromError(e))});return r.default.reject(e)})};e.prototype._uploadState=function(e,t){var n=this,i=t.sessionUrl,s=t.item,o=t.error;if(s)return r.default.resolve(s);if(o){var u=void 0;i&&(u=this._uploadService.cancelSession({qosData:e.qosData,sessionUrl:i}).then(function(){},function(){}));return r.default.resolve(u).then(function(){return r.default.reject(o)})}return this._uploadStateMachine.advanceState(e,t).then(function(t){return n._uploadState(e,t)})};return e}();t.Uploader=o;t.default=o});
define("@ms/odsp-graph/lib/services/upload/UploadService",["require","exports","tslib","@ms/odsp-utilities/lib/async/Signal"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this._dataRequestor=t.dataRequestor}e.prototype.createSession=function(e){var t=e.qosData,r=e.itemUrl,i=e.allowCookies,o=e.accessToken,u=e.fileName,a=e.fileSize,f=e.lastModifiedDate,l=e.eTag,c=e.conflictBehavior,h={item:n.__assign({},s(r)?{"@microsoft.graph.conflictBehavior":c}:{"@name.conflictBehavior":c},f?{fileSystemInfo:{lastModifiedDateTime:f.toISOString()}}:{})},p=n.__assign({},l?{"If-Match":l}:{},{Prefer:"synchronousmetadata"});return this._dataRequestor.send({path:r+"/"+encodeURIComponent(u)+":/"+(s(r)?"createUploadSession":"oneDrive.createUploadSession"),requestType:"POST",apiName:"CreateSession",headers:p,allowCookies:i,accessToken:o,useAuthorizationHeaders:!0,postData:JSON.stringify(h),qosExtraData:n.__assign({conflictBehavior:c,fileSize:a},t)})};e.prototype.cancelSession=function(e){var t=e.qosData,n=e.sessionUrl;return this._dataRequestor.send({requestType:"DELETE",apiName:"CancelSession",path:n,needsAuthorization:!1,qosExtraData:t})};e.prototype.uploadFragment=function(e){var t=e.qosData,i=e.sessionUrl,s=e.startByte,o=e.endByte,u=e.fileSize,a=e.content,f=e.timeout,l=e.onProgress,c={"Content-Range":"bytes "+s+"-"+Math.max(o-1,s)+"/"+u},h=!0,p=this._dataRequestor.send({path:i,needsAuthorization:!1,requestType:"PUT",apiName:"UploadFragment",headers:c,postData:a,timeout:f,hasContentType:!1,onUploadProgress:function(e){e.lengthComputable&&h&&l(s+e.loaded)},qosExtraData:n.__assign({},t,{startByte:s,endByte:o,fileSize:u})}),d=new r.default(function(){h=!1;p.cancel()});p.done(function(e){h=!1;d.complete(e)},function(e){h=!1;d.error(e)});return d.getPromise()};e.prototype.commit=function(e){var t=e.qosData,r=e.itemUrl,i=e.accessToken,o=e.fileName,u=(e.description,e.eTag),a=e.conflictBehavior,f=e.sessionUrl,l={"If-Match":u},c=s(r)?{"@microsoft.graph.conflictBehavior":a,"@microsoft.graph.sourceUrl":f}:{"@name.conflictBehavior":a,"@content.sourceUrl":f};return this._dataRequestor.send({path:r+"/"+encodeURIComponent(o),requestType:"PUT",apiName:"CommitSession",headers:l,accessToken:i,useAuthorizationHeaders:!0,postData:JSON.stringify(c),qosExtraData:n.__assign({conflictBehavior:a},t)})};e.prototype.getStatus=function(e){var t=e.qosData,n=e.sessionUrl;return this._dataRequestor.send({requestType:"GET",apiName:"GetStatus",path:n,needsAuthorization:!1,qosExtraData:t})};e.prototype.getItem=function(e){var t=e.qosData,r=e.itemUrl,i=e.accessToken,s=e.fileName;return this._dataRequestor.send({requestType:"GET",apiName:"GetItem",path:r+"/"+encodeURIComponent(s),useAuthorizationHeaders:!0,accessToken:i,qosExtraData:n.__assign({},t)})};return e}();t.UploadService=i;function s(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)}});
define("@ms/odsp-graph/lib/services/upload/UploadWaiter",["require","exports","@ms/odsp-utilities/lib/async/Async","@ms/odsp-utilities/lib/events/EventGroup","@ms/odsp-utilities/lib/scope/Scope","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){var s=t.asyncType,o=void 0===s?n.default:s,u=t.eventGroupType,a=void 0===u?r.default:u,f=t.targetWindow,l=void 0===f?window:f,c=this._scope=new i.default;this._async=c.attach(new o(this));this._events=c.attach(new a(this));this._targetWindow=l}e.prototype.dispose=function(){this._scope.dispose()};e.prototype.wait=function(e){var t,n=e.duration,r=e.allowWakeWhenOnline,i=void 0!==r&&r,u=this._async,a=this._events,f=this._targetWindow,l=new o.default(function(){u.clearTimeout(t)}),c=function(){i&&l.complete()};t=u.setTimeout(function(){l.complete()},n);a.on(f,"online",c);return l.getPromise().then(function(){a.off(f,"online",c)},function(e){a.off(f,"online",c);return s.default.reject(e)})};return e}();t.UploadWaiter=u});
define("@ms/odsp-graph/lib/services/upload/UploadStateMachine",["require","exports","tslib","../../models/error/Error","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-utilities/lib/async/Signal"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=62914560,a=Math.pow(2,.25),f=function(){function e(e,t){this._uploadService=t.uploadService;this._activityBandwidthVerifierType=t.activityBandwidthVerifierType;var n=t.useCommitForUpload,r=void 0!==n&&n,i=t.checkForCompletedUploadOnSessionTermination,s=void 0===i||i,o=t.shouldCancelOnCompleteFailure,a=void 0===o||o,f=t.maximumFragmentSize,l=void 0===f?u:f;this._shouldCancelOnCompleteFailure=a;this._useCommitForUpload=r;this._checkForCompletedUploadOnSessionTermination=s;this._maximumFragmentSize=l}e.prototype.advanceState=function(e,t){var n=this,r=t.sessionUrl,i=t.nextExpectedRanges;return(r?i?this._uploadItemState(e,t):this._getStatusState(e,t):this._createSessionState(e,t)).then(function(t){return t.error?n._handleGeneralErrorState(e,t):n._getState(t,{waitDuration:void 0,attemptsRemaining:void 0})})};e.prototype._createSessionState=function(e,t){var s=this,o=e.qosData,u=new i.Qos({name:"VroomUploader.createSession",extraData:o});return this._uploadService.createSession({qosData:o,itemUrl:e.itemUrl,allowCookies:e.allowCookies,accessToken:e.accessToken,fileName:e.fileName,fileSize:e.content.size,eTag:e.eTag,lastModifiedDate:e.lastModifiedDate,conflictBehavior:t.conflictBehavior}).then(function(e){u.end({resultType:i.ResultTypeEnum.Success});return s._getState(t,{nextExpectedRanges:e.nextExpectedRanges,sessionUrl:e.uploadUrl})},function(a){return s._handleCreateSessionErrorState(e,s._getState(t,{error:a})).then(function(e){e.error?u.end({resultType:i.ResultTypeEnum.Failure,error:a.message,resultCode:r.getResultCodeFromError(a),extraData:n.__assign({},o,r.getQosExtraDataFromError(a))}):u.end({resultType:i.ResultTypeEnum.ExpectedFailure,resultCode:"Canceled"});return e})})};e.prototype._handleCreateSessionErrorState=function(e,t){var n=this;return this._handleErrorState(t,function(r,i){switch(r){case"entityTagDoesNotMatch":case"resourceModified":case"versionNumberDoesNotMatch":case"nameAlreadyExists":case"unlockRequired":case 409:case 412:return n._promptForConflictBehaviorState(i,e,t)}})};e.prototype._getStatusState=function(e,t){var s=this,o=e.qosData,u=new i.Qos({name:"VroomUploader.getStatus",extraData:o});return this._uploadService.getStatus({qosData:o,sessionUrl:t.sessionUrl}).then(function(e){u.end({resultType:i.ResultTypeEnum.Success});return s._getState(t,{nextExpectedRanges:e.nextExpectedRanges})},function(e){u.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign({},o,r.getQosExtraDataFromError(e))});return s._getState(t,{error:e})})};e.prototype._uploadItemState=function(e,t){var s=this,o=e.qosData,u=e.content.size,a=this._getNextRange({fileSize:u,nextExpectedRanges:t.nextExpectedRanges}),f=new i.Qos({name:"VroomUploader.uploadItem",extraData:e.qosData});return(a&&a.start<u?t.allowStreaming?this._uploadStreamState({nextRange:a},e,t):this._uploadFragmentState({nextRange:a},e,t):this._useCommitForUpload?this._commitState(e,t):this._shouldCancelOnCompleteFailure?this._cancelSessionState(e,t):this._terminateUploadOnCompleteFailure(t)).then(function(t){if(t.error)return s._handleUploadItemErrorState(e,t).then(function(e){var t=e.error;t?f.end({resultType:i.ResultTypeEnum.Failure,error:t.message,resultCode:r.getResultCodeFromError(t),extraData:n.__assign({},o,r.getQosExtraDataFromError(t))}):f.end({resultType:i.ResultTypeEnum.Success});return e});f.end({resultType:i.ResultTypeEnum.Success});return t})};e.prototype._terminateUploadOnCompleteFailure=function(e){return s.default.resolve(this._getState(e,{error:new Error("The upload session is still open but there are no more bytes to upload.")}))};e.prototype._uploadFragmentState=function(e,t,s){var u=this,f=e.nextRange,l=t.onProgress,c=t.content,h=t.content.size,p=t.qosData,d=s.sessionUrl,v=s.speed,m=void 0===v?1/8:v,g=f.start,y=f.end;l&&l(g);var b,w,E=this._getFragmentSize(m),S=Math.min(g+E,y),x=new o.default(function(){b&&b.cancel()}),T=m>1/1920?6e4:3e5,N=new this._activityBandwidthVerifierType({timeout:T,totalBytes:S-g}),C=new i.Qos({name:"VroomUploader.uploadFragment",extraData:n.__assign({},p,{startByte:g,endByte:S,fileSize:h,speed:m,fragmentSize:E})});(b=this._uploadService.uploadFragment({qosData:p,sessionUrl:d,startByte:g,endByte:S,fileSize:h,content:c.slice(g,S),timeout:T,onProgress:function(e){w=e;if(m>1/1920&&!N.doesActivityHaveRemainingCapacity(e-g)){C.end({resultType:i.ResultTypeEnum.ExpectedFailure,resultCode:"Aborted",extraData:n.__assign({},p,{lastByte:e})});x.complete(u._getState(s,{speed:Math.max(.5*m,1/1920),nextExpectedRanges:void 0}));b&&b.cancel()}l&&l(e)}}).then(function(e){l&&l(S);C.end({resultType:i.ResultTypeEnum.Success});return s=u._isItem(e)?u._getState(s,{item:e}):u._getState(s,{nextExpectedRanges:e.nextExpectedRanges,speed:Math.min(N.didActivityHaveExtraCapacity()?m*a:m,1)})},function(e){C.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign({},p,r.getQosExtraDataFromError(e),{lastByte:w})});return u._getState(s,{error:e})})).done(function(e){x.complete(e)});return x.getPromise()};e.prototype._uploadStreamState=function(e,t,s){var u=this,a=e.nextRange,f=t.onProgress,l=t.content,c=t.content.size,h=t.qosData,p=s.sessionUrl,d=a.start,v=a.end,m=Math.min(v-d,this._maximumFragmentSize),g=d+m;f&&f(d);var y,b=new o.default(function(){y&&y.cancel()}),w=new i.Qos({name:"VroomUploader.uploadStream",extraData:n.__assign({},h,{startByte:d,endByte:g,fileSize:c,fragmentSize:m})});(y=this._uploadService.uploadFragment({qosData:h,sessionUrl:p,startByte:d,endByte:g,fileSize:c,content:l.slice(d,g),timeout:864e5,onProgress:function(e){f&&f(e)}}).then(function(e){f&&f(g);w.end({resultType:i.ResultTypeEnum.Success});return s=u._isItem(e)?u._getState(s,{item:e}):u._getState(s,{nextExpectedRanges:e.nextExpectedRanges})},function(e){w.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign({},h,r.getQosExtraDataFromError(e),{lastByte:void 0})});return u._handleUploadStreamErrorState({nextRange:a},t,u._getState(s,{error:e}))})).done(function(e){b.complete(e)});return b.getPromise()};e.prototype._handleUploadStreamErrorState=function(e,t,n){var r=this,i=e.nextRange;return this._handleErrorState(n,function(e){switch(e){case 0:return r._wait({duration:1e3},t).then(function(){return r._getStatusState(t,n).then(function(e){return r._getNextRange({fileSize:t.content.size,nextExpectedRanges:e.nextExpectedRanges}).start>i.start?e:r._getState(n,{allowStreaming:!1})})})}})};e.prototype._commitState=function(e,t){var s=this,o=e.qosData,u=e.onProgress;u&&u(e.content.size);var a=new i.Qos({name:"VroomUploader.commit",extraData:o});return this._uploadService.commit({qosData:o,itemUrl:e.itemUrl,accessToken:e.accessToken,fileName:e.fileName,sessionUrl:t.sessionUrl,conflictBehavior:t.conflictBehavior}).then(function(e){a.end({resultType:i.ResultTypeEnum.Success});return s._getState(t,{item:e})},function(e){return s._handleCommitErrorState(s._getState(t,{error:e})).then(function(t){a.end({resultType:t.error?i.ResultTypeEnum.Failure:i.ResultTypeEnum.ExpectedFailure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign({},o,r.getQosExtraDataFromError(e))});return t})})};e.prototype._handleCommitErrorState=function(e){var t=this;return this._handleErrorState(e,function(n){switch(n){case"uploadSessionFailed":case"uploadSessionNotFound":case 410:return s.default.resolve(t._getState(e,{error:void 0,sessionUrl:void 0}))}})};e.prototype._cancelSessionState=function(e,t){var s=this,o=e.qosData,u=new i.Qos({name:"VroomUploader.cancelSession",extraData:o});return this._uploadService.cancelSession({qosData:e.qosData,sessionUrl:t.sessionUrl}).then(function(){u.end({resultType:i.ResultTypeEnum.Success});return s._getState(t,{sessionUrl:void 0})},function(e){u.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign({},o,r.getQosExtraDataFromError(e))});return s._getState(t,{sessionUrl:void 0})})};e.prototype._handleUploadItemErrorState=function(e,t){var n=this,r=t.speed,i=void 0===r?1:r;t=this._getState(t,{nextExpectedRanges:void 0});return this._handleErrorState(t,function(r,o){switch(r){case 0:return window.navigator.onLine?t.allowStreaming?s.default.resolve(n._getState(t,{allowStreaming:!1})):s.default.resolve(n._getState(t,{speed:Math.max(i*(1/8),1/1920)})):void 0;case"uploadSessionFailed":case"uploadSessionNotFound":case 404:return s.default.resolve(n._getState(t,{error:void 0,sessionUrl:void 0}));case"entityTagDoesNotMatch":case"resourceModified":case"versionNumberDoesNotMatch":case"nameAlreadyExists":case"unlockRequired":case 409:case 412:return n._promptForConflictBehaviorState(o,e,t);case"invalidRange":case 416:return n._wait({duration:1e3},e).then(function(){return n._getState(t,{error:void 0})})}})};e.prototype._getItemIfCompletedState=function(e,t){var s=this,o=e.qosData,u=new i.Qos({name:"VroomUploader.getItemIfCompleted",extraData:o});return this._uploadService.getItem({qosData:o,fileName:e.fileName,itemUrl:e.itemUrl,accessToken:e.accessToken}).then(function(n){u.end({resultType:i.ResultTypeEnum.Success});return e.lastModifiedDate&&n.fileSystemInfo&&n.fileSystemInfo.lastModifiedDateTime===e.lastModifiedDate.toISOString()&&n.size===e.content.size&&"rename"!==t.conflictBehavior?s._getState(t,{item:n,error:void 0}):s._getState(t,{error:new Error("The upload session has terminated but the existing item does not match the input.")})},function(e){u.end({resultType:i.ResultTypeEnum.Failure,error:e.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign({},o,r.getQosExtraDataFromError(e))});return s._getState(t,{error:e})})};e.prototype._handleGeneralErrorState=function(e,t){var n=this,r=t.waitDuration,i=void 0===r?500:r,s=t.attemptsRemaining,o=void 0===s?10:s;return this._handleErrorState(t,function(r){switch(r){case"uploadSessionNotFound":return n._checkForCompletedUploadOnSessionTermination?n._getItemIfCompletedState(e,t):void 0;case"authFailure":case"unauthenticated":case 401:case"lockMismatch":case 423:case 501:case"quotaLimitReached":case 507:return}if("number"==typeof r){if(r>=400&&r<500)return;if(0===r||r>=500&&r<600)return n._wait({duration:i,allowWakeWhenOnline:!0},e).then(function(){return n._getState(t,{error:void 0,waitDuration:Math.min(2*i,3e4),attemptsRemaining:void 0})});if(!o)return;return n._wait({duration:1e3},e).then(function(){return n._getState(t,{error:void 0,waitDuration:void 0,attemptsRemaining:Math.max(o-1,0)})})}})};e.prototype._handleErrorState=function(e,t){var n=e.error,i=r.getErrorResolution(n,t);void 0===i&&(i=s.default.resolve(e));return i};e.prototype._promptForConflictBehaviorState=function(e,t,o){var u=this,a=t.onPromptForConfictBehavior,f=t.qosData,l=new i.Qos({name:"VroomUploader.promptForConflictBehavior",extraData:f});return s.default.resolve().then(function(){return a(e)}).then(function(e){l.end({resultType:i.ResultTypeEnum.Success,extraData:f});return u._getState(o,{error:void 0,conflictBehavior:e})},function(t){l.end({resultType:i.ResultTypeEnum.Failure,error:t.message,resultCode:r.getResultCodeFromError(e),extraData:n.__assign({},f,r.getQosExtraDataFromError(t))});return u._getState(o,{error:t})})};e.prototype._wait=function(e,t){var n=e.duration,o=e.allowWakeWhenOnline,u=t.onWait,a=t.qosData,f=new i.Qos({name:"VroomUploader.wait",extraData:a});return s.default.resolve(u({duration:n,allowWakeWhenOnline:o})).then(function(){f.end({resultType:i.ResultTypeEnum.Success})},function(e){f.end({resultType:s.default.isCanceled(e)?i.ResultTypeEnum.Success:i.ResultTypeEnum.Failure,error:e&&e.message,resultCode:r.getResultCodeFromError(e)});return s.default.reject(e)})};e.prototype._getState=function(e,t){return n.__assign({},e,t)};e.prototype._getNextRange=function(e){var t=e.fileSize,n=e.nextExpectedRanges;return(void 0===n?[]:n).reduce(function(e,n){var r,i=n.split("-",2),s=i[0],o=i[1],u=parseInt(s,10);if(!e||u<e.start&&u<t){r={start:u,end:""===o?t:Math.min(parseInt(o,10)+1,t)}}else r=e;return r},void 0)};e.prototype._isItem=function(e){return!!e.id};e.prototype._getFragmentSize=function(e){var t,n=e*u;t=n>327680?n-n%327680:n-n%32768;return Math.min(Math.max(t,32768),this._maximumFragmentSize)};return e}();t.UploadStateMachine=f});
define("@ms/odsp-graph/lib/services/upload/ActivityBandwidthVerifier",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.performanceNow=window.performance?function(){return window.performance.now()}:function(){return Date.now()};var n=function(){function e(e,t){this._performanceNow=t.performanceNow;this._startTime=this._performanceNow();this._expirationTime=this._startTime+e.timeout;this._totalBytes=e.totalBytes;this._progressPoints=0}e.prototype.doesActivityHaveRemainingCapacity=function(e){var t=this._getRateRatio(e);return void 0===t||t<=1};e.prototype.didActivityHaveExtraCapacity=function(){return this._getRateRatio(this._totalBytes)<=.5};e.prototype._getRateRatio=function(e){this._progressPoints++;var t,n=this._performanceNow(),r=n-this._startTime,i=this._expirationTime-n,s=this._totalBytes-e;(this._progressPoints>=4&&r>=4e3||this._progressPoints>0&&0===s)&&i>0&&(t=s/i/(e/r));return t};return e}();t.ActivityBandwidthVerifier=n});
define("@ms/items-view/lib/private/facets/FileSystemFacets",["require","exports","../models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.entryBatchFacet=new n.Facet("entryBatch");t.sourceFileFacet=new n.Facet("sourceFile")});
define("@ms/items-view-addon-graph/lib/handlers/controls/driveItem/createFolderActionControlHandler",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","@ms/items-view/lib/private/utilities/fileSystem/nameValidator","../../../utilities/hasPermission"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemCreateFolderActionControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(i.canCreateFolderFacet,n),validator:r.nameValidator}}}})});
define("@ms/items-view/lib/private/utilities/fileSystem/nameValidator",["require","exports","@ms/utilities-strings/lib/index","./nameValidator.resx"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i;!function(e){e[e.InvalidStart=0]="InvalidStart";e[e.InvalidEnd=1]="InvalidEnd";e[e.InvalidCharacters=2]="InvalidCharacters";e[e.Empty=3]="Empty"}(i=t.ValidatorErrorType||(t.ValidatorErrorType={}));function s(e,t){var n=e.trim();return 0===n.length?i.Empty:t.invalidCharactersRegex.test(n)?i.InvalidCharacters:t.cannotStartWithRegex&&t.cannotStartWithRegex.test(n)?i.InvalidStart:t.cannotEndWithRegex&&t.cannotEndWithRegex.test(n)?i.InvalidEnd:void 0}t.isNameValid=s;function o(e,t){switch(e){case i.InvalidCharacters:return n.format(r.default.invalidNameError,t.invalidCharacters);case i.InvalidStart:return n.format(r.default.invalidNameStartError,t.cannotStartWith);case i.InvalidEnd:return n.format(r.default.invalidNameEndError,t.cannotEndWith);case i.Empty:return r.default.emptyNameError;case void 0:return}}t.getErrorString=o;function u(e){return function(t){return o(s(t,e),e)}}t.createNameValidator=u;t.nameValidator=u({invalidCharactersRegex:/["\*:<>\?\/\\\|]/,invalidCharacters:'" * : < > ? / \\ |'});t.nameValidatorWithoutPoundPercent=u({invalidCharactersRegex:/["\*:<>\?\/\\\|#%]/,invalidCharacters:'" * : < > ? / \\ # %|'})});
define("@ms/items-view-addon-graph/lib/utilities/hasPermission",["require","exports","tslib","../models/facets/SharedFacet","../models/facets/CommandsFacets","../models/keys/CommandsItemKeyFacet","../models/keys/DriveItemKeyFacet","@ms/items-view/lib/private/models/itemCache/ComputedItemFacet","@ms/items-view/lib/private/facets/DocumentFacets"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.canAddToOneDriveFacet=new u.ComputedItemFacet("addToOneDrive",function(e,t){return f(e,n.__assign({},t,{commandFacet:i.addToOneDriveFacet}))});t.canCreateFolderFacet=new u.ComputedItemFacet("canCreateFolder",function(e,t){return f(e,n.__assign({},t,{commandFacet:i.createFolderFacet}))});t.canCreateLinkFacet=new u.ComputedItemFacet("canCreateLink",function(e,t){return f(e,n.__assign({},t,{commandFacet:i.createLinkFacet}))});t.canDeleteFacet=new u.ComputedItemFacet("canDelete",function(e,t){return f(e,n.__assign({},t,{commandFacet:i.deleteFacet}))});t.canDownloadFacet=new u.ComputedItemFacet("canDownload",function(e,t){return!e.demandItemFacet(a.oneNoteFacet,t.itemKey)&&f(e,n.__assign({},t,{commandFacet:i.downloadFacet}))});t.canInviteFacet=new u.ComputedItemFacet("canInvite",function(e,t){return f(e,n.__assign({},t,{commandFacet:i.inviteFacet}))});t.canMoveFacet=new u.ComputedItemFacet("canMove",function(e,t){return f(e,n.__assign({},t,{commandFacet:i.moveFacet}))});t.canUseOfficeLensFacet=new u.ComputedItemFacet("canUseOfficeLens",function(e,t){return f(e,n.__assign({},t,{commandFacet:i.officeLensFacet}))});t.canRenameFacet=new u.ComputedItemFacet("canRename",function(e,t){return f(e,n.__assign({},t,{commandFacet:i.renameFacet}))});t.canUploadFacet=new u.ComputedItemFacet("canUpload",function(e,t){return f(e,n.__assign({},t,{commandFacet:i.uploadFacet}))});function f(e,t){var n=t.itemKey,r=t.commandFacet,i=e.demandItemFacet(o.driveItemKeyFacet,n);if(!i)return!1;var u=i.endpoint,a=i.driveId,f=e.demandItemFacet(r,s.commandsItemKeyFacet.serialize({endpoint:u,driveId:a}));return!!f&&!!f.roles&&l(e,{itemKey:n,oneOfRequiredRoles:f.roles})}t.hasPermission=f;function l(e,t){var n=t.itemKey;return c(e,{oneOfRequiredRoles:t.oneOfRequiredRoles,effectiveRoles:p(e,n)})}t.hasRequiredItemRole=l;function c(e,t){var n=t.oneOfRequiredRoles,r=t.effectiveRoles;for(var i in r)if(i in n)return!0;return!1}t.hasRequiredRole=c;function h(e,t){var n=e.demandItemFacet(r.sharedFacet,t);return!n||!n.effectiveRoles||!n.owner}t.isOwner=h;function p(e,t){if(h(e,t))return["read","write","owner"];var n=e.demandItemFacet(r.sharedFacet,t);return n&&n.effectiveRoles?n.effectiveRoles:[]}t.getEffectiveItemRoles=p});
define("@ms/items-view-addon-graph/lib/handlers/controls/driveItem/renameItemActionControlHandler",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","@ms/items-view/lib/private/utilities/fileSystem/nameValidator","../../../utilities/hasPermission"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemRenameItemActionControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(i.canRenameFacet,n),validator:r.nameValidator}}}})});
define("@ms/items-view-addon-graph/lib/handlers/controls/driveItem/deleteItemsActionControlHandler",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","../../../utilities/hasPermission"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemDeleteItemsActionControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(r.canDeleteFacet,n)}}}})});
define("@ms/items-view-addon-graph/lib/handlers/controls/driveItem/uploadItemsActionControlHandler",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","../../../utilities/hasPermission"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemUploadItemsActionControlHandler=n.createControlHandler()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(r.canUploadFacet,n)}}}})});
define("@ms/items-view-addon-graph/lib/handlers/controls/driveItem/downloadItemsActionControlHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerControlHandler","../../../models/keys/DriveItemKeyFacet","../../../utilities/Data","@ms/items-view/lib/private/facets/ItemFacets","../../../utilities/hasPermission","@ms/odsp-graph/lib/models/error/Error","@ms/items-view/lib/private/store/actions/implementOperation","@ms/items-view/lib/private/facets/ErrorFacets","@ms/odsp-graph/lib/models/error/Error"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemDownloadItemsActionControlHandler=r.createControlHandler()(h);function h(){return function(e){return p}}t.getDownloadItemActionControlHandler=h;function p(e,t){if(1!==t.itemKeys.length)return{};var r=t.itemKeys[0];if(e.demandItemFacet(o.folderFacet,r))return{};var h=e.demandItemFacet(i.driveItemKeyFacet,r),p=h?s.getDriveItemUrl(h):void 0,d=h&&h.endpoint||"";return{isAvailable:e.demandItemFacet(u.canDownloadFacet,r),getDownloadData:p?function(){return function(e){var t=this,r=e.itemUrl,i=e.endpoint;return function(o){return n.__awaiter(t,void 0,void 0,function(){var t,u,h,p;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,o(s.getRawData({url:e.itemUrl,method:"GET",qosName:"getItemDownloadUrl",endpoint:i}))];case 1:t=n.sent();if(!(u=function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)}(r)?t["@microsoft.graph.downloadUrl"]:t["@content.downloadUrl"]))throw new Error("Unable to obtain download URL.");return[2,{method:"GET",url:u}];case 2:if((h=n.sent())instanceof a.GraphError){p=c.getErrorResolution(h,function(e,t){switch(e){case"unauthenticated":case 401:return l.authFailureErrorFacet.pack({});case"itemNotFound":case 404:return l.fileNotFoundErrorFacet.pack({});case"accessDenied":case 403:return l.accessDeniedErrorFacet.pack({});default:return l.offlineErrorFacet.pack({})}});throw new f.ItemOperationError({innerError:h,facets:p})}throw h;case 3:return[2]}})})}}({itemUrl:p,endpoint:d})}:void 0}}});
define("@ms/items-view-addon-graph/lib/handlers/controls/driveItem/getDefaultShareLinkActionControlHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerControlHandler","../../../models/keys/DriveItemKeyFacet","../../../utilities/Data"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemDefaultShareLinkControlHandler=r.createControlHandler()(o);function o(){return function(e){return u}}t.getDefaultShareLinkActionControlHandler=o;function u(e,t){var r=t.itemKey,o=e.demandItemFacet(i.driveItemKeyFacet,r);return{isAvailable:!0,getShareLink:function(){return function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,o;return n.__generator(this,function(n){switch(n.label){case 0:if(!(t=e.driveItem))return[3,2];i=s.getDriveItemUrl(t)+"/invite";return[4,r(s.getRawDataWithCache({url:i,method:"POST",qosName:"getDefaultShareLink",endpoint:t.endpoint,headers:{prefer:"getDefaultLink","Content-type":"application/json"}}))];case 1:if(!(o=n.sent()))throw new Error("Unable to obtain default share URL");return[2,{url:o.value[0].link.webUrl,scope:o.value[0].link.scope}];case 2:throw new Error("Unable to obtain default share URL")}})})}}({driveItem:o})}}}});
define("@ms/items-view-addon-graph/lib/handlers/controls/driveItem/followItemActionControlHandler",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemfollowItemActionControlHandler=n.createControlHandler()(function(){return function(){return function(){return{}}}})});
define("@ms/items-view-addon-graph/lib/handlers/controls/driveItem/permissionGrantActionControlHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerControlHandler","../../../models/keys/DriveItemKeyFacet","../../../utilities/Data"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemPermissionGrantControlHandler=r.createControlHandler()(o);function o(){return function(e){return u}}t.getPermissionGrantActionControlHandler=o;function u(e,t){var r=t.itemKey,o=t.link,u=t.recipients,a=e.demandItemFacet(i.driveItemKeyFacet,r);return{isAvailable:!0,permissionInvite:function(){return function(e){var t=this;return function(r){return n.__awaiter(t,void 0,void 0,function(){var t,i,o,u,a,f,l,c,h,p,d;return n.__generator(this,function(n){switch(n.label){case 0:t=e.driveItem,i=e.link,o=e.recipients;if(!t)throw new Error("Unable to obtain default share URL");u=t.endpoint;f=btoa(i);a="u!"+f.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");l=o.map(function(e){return{email:e}});c={recipients:l,roles:["read"]};h=u+"/shares/"+a+"/permission/grant";return[4,r(s.getRawDataWithCache({url:h,method:"POST",qosName:"permissionGrant",endpoint:t.endpoint,headers:{"Content-type":"application/json",Accept:"application/json"},body:c}))];case 1:p=n.sent();d=p.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}});return[2,{recipients:d}]}})})}}({driveItem:a,link:o,recipients:u})}}}});
define("@ms/items-view-addon-graph/lib/handlers/controls/itemThumbnailControl",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","../../models/keys/DriveItemKeyFacet","../../models/facets/GraphThumbnailSetFacet"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemThumbnailControlHandler=n.createControlHandler()(function(){return function(e){return s}});function s(e,t){var n=t.itemKey,s=t.desiredSize,o=e.demandItemFacet(r.driveItemKeyFacet,n),u=function(e){return e&&(t=e,t&&"number"==typeof t.length)?e[0]:e;var t}(e.demandItemFacet(i.graphThumbnailSetFacet,n));return o&&u&&u.large?{thumbnail:{url:a(u.large.url,s),width:0,height:0}}:{}}var o=/width=[0-9]*/,u=/height=[0-9]*/;function a(e,t){var n=""+(t.width||"");o.test(e)?e=e.replace(o,"width="+n):e+=(e.indexOf("?")>-1?"&":"?")+"width="+n;var r=""+(t.height||"");u.test(e)?e=e.replace(u,"height="+r):e+=(e.indexOf("?")>-1?"&":"?")+"height="+r;return e}});
define("@ms/items-view/lib/private/controls/getDefaultShareLinkActionControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.shareLinkActionControl=new n.ControlFacet("getDefaultShareLinkActionControl")});
define("@ms/items-view/lib/private/controls/permissionInviteActionControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.permissionInviteActionControl=new n.ControlFacet("permissionInviteActionControl")});
define("@ms/items-view-addon-graph/lib/handlers/operations/driveItem/followItemOperationHandler",["require","exports","tslib","@ms/items-view/lib/private/addons/registerOperationHandler","../../../utilities/Data","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/models/items/ItemResolver","../../../models/keys/DriveFollowedItemKeyFacet","../../../models/facets/ConfigurationFacets","@ms/items-view/lib/private/operations/configuration/readConfiguration"],function(e,t,n,r,i,s,o,u,a,f){"use strict";var l=this;Object.defineProperty(t,"__esModule",{value:!0});t.driveItemFollowItemOperationHandler=r.createSingleItemOperationHandler()(function(e){var t=e.itemKey,r=e.options.isFollowed,c=u.driveFollowedItemKeyFacet.deserialize(t),h=c.driveItemKey,p=h.itemId,d=void 0===p?"":p;return function(e){return n.__awaiter(l,void 0,void 0,function(){var t,l,p,v,m,g,y,b,w;return n.__generator(this,function(E){switch(E.label){case 0:p=e(f.readConfiguration({useGraphEndpointForSavedForLater:a.useGraphEndpointForSavedForLaterFacet,graphEndpoint:a.graphEndpointConfigurationFacet})),v=p.useGraphEndpointForSavedForLater,m=p.graphEndpoint;g=v&&m?m:h.endpoint;if(!r)return[3,2];y=g+"/drives/"+h.driveId+"/items/"+d+"/follow";return[4,e(i.getRawData({url:y,method:"POST",qosName:"followItem",endpoint:g}))];case 1:E.sent();return[3,4];case 2:y=g+"/drives/"+h.driveId+"/following/"+d;return[4,e(i.getRawData({url:y,method:"DELETE",qosName:"unfollowItem",endpoint:g}))];case 3:E.sent();E.label=4;case 4:b=new o.ItemResolver;w=u.driveFollowedItemKeyFacet.serialize(c);b.invalidateItems({items:(t={},t[w]=[s.isFollowedFacet],t)});b.resolveItems({items:(l={},l[w]=n.__assign({},s.isFollowedFacet.pack(r)),l)});e(b.execute());return[2]}})})}})});
define("@ms/items-view/lib/private/controls/itemsViewSearchControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemsViewSearchControl=new n.ControlFacet("itemsViewSearchControl")});
define("@ms/items-view-addon-graph/lib/handlers/controls/itemsViewSearchControl",["require","exports","tslib","@ms/items-view/lib/private/addons/registerControlHandler","../../models/keys/DriveItemSetKeyFacet","../../models/keys/SearchItemSetKeyFacet"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function o(e,t){return s.searchItemSetKeyFacet.serialize(n.__assign({},{driveItemKey:e.driveItemKey},t?{searchTerm:t}:{searchTerm:void 0}))}t.driveItemSearchControlHandler=r.createControlHandler()(u);t.searchItemSearchControlHandler=r.createControlHandler()(u);function u(){return function(e){return function(e,t){var n,r=t.itemKey,u=e.demandItemFacet(i.driveItemSetKeyFacet,r);if(u)n=function(e){return u?o(u,e):void 0};else{var a=e.demandItemFacet(s.searchItemSetKeyFacet,r);n=function(e){return a?o(a,e):void 0}}return{isAvailable:!0,getSearchItemKey:n}}}}});
define("@ms/items-view-addon-graph/lib/handlers/controls/driveItemSetFilteredItemSetControlHandler",["require","exports","tslib","../../models/keys/DriveItemSetKeyFacet","../../models/keys/SearchItemSetKeyFacet","@ms/items-view/lib/private/addons/registerControlHandler","@ms/items-view/lib/private/models/itemSets/filters/itemExtensionFilterHandler","@ms/items-view/lib/private/models/itemSets/filters/itemTypeFilterHandler"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.driveItemSetFilteredItemSetControlHandler=s.createControlHandler()(function(){return function(e){return a}});function a(e,t){var s=t.handlers,a=t.itemKey,f=e.demandItemFacet(r.driveItemSetKeyFacet,a),l=e.demandItemFacet(i.searchItemSetKeyFacet,a);if(s&&(f||l)){for(var c=[],h=0,p=s;h<p.length;h++){var d=p[h];if(d.key===u.itemPhotoTypeFilterHandler.key)c.push("photo");else if(d.key===u.itemVideoTypeFilterHandler.key)c.push("video");else if(d.key===u.itemFolderTypeFilterHandler.key)c.push("folder");else{var v=o.getExtensionFromFilterHandler(d);v&&c.push(v)}}if(f)return{itemKey:r.driveItemSetKeyFacet.serialize(n.__assign({},f,{extFilters:c}))}}return{}}});
define("@ms/items-view/lib/private/components/itemSetTilesList/ItemSetTilesList",["require","exports","tslib","react","../decorators/withResponsiveMode","./hooks/useItemSetTileCells","./InjectableItemSetTilesList","@uifabric/experiments/lib/TilesList"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){return r.createElement(u.TilesList,n.__assign({},e))};t.ItemSetTilesList=i.withResponsiveMode()(function(e){var t=s.useItemSetTileCells(e);return r.createElement(o.InjectableItemSetTilesList,n.__assign({},e,t,{onRenderTilesList:a}))});t.ItemSetTilesList.displayName="ItemSetTilesList"});
define("@ms/items-view/lib/private/components/itemSetTilesList/hooks/useItemSetTileCells",["require","exports","tslib","react","@uifabric/experiments/lib/Tile","../../itemPage/ItemPage","../../../controls/childItemsControl","../../../facets/SetFacets","../../../facets/GroupFacets","../../../facets/DemandFacets","../../../facets/ItemFacets","office-ui-fabric-react/lib/utilities/decorators/withResponsiveMode","../../../controls/itemSetTilesListControl","../../../facets/MediaFacets","../../../utilities/objects","../../itemSetList/ItemSetSelectionContext","../ItemTileCell","../HeaderTileCell","../../../models/itemCache/bindItemCacheSelectorToProps","../../../hooks/useItemCacheSelector","../../../controls/itemSetPagingControl"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SIZES={small:{tileDefaultHeight:135,tileDefaultWidth:138,documentGroupTileMargin:12,photoGroupTileMargin:8,groupMargin:40},large:{tileDefaultHeight:171,tileDefaultWidth:176,documentGroupTileMargin:8,photoGroupTileMargin:8,groupMargin:40}};t.useItemSetTileCells=function(e){var t=e.itemKey,n=e.doNotRenderShimmerTile,r=e.responsiveMode,i=e.layoutSupportsRandomAccess;return b.useItemCacheSelector(y.bindItemCacheSelectorToProps(E,e),[t,n,r,i])};function E(e,r){var i=r.itemKey,s=r.doNotRenderShimmerTile,p=void 0!==s&&s,d=r.responsiveMode,v=void 0===d?c.ResponsiveMode.large:d,y=r.layoutSupportsRandomAccess,b=e.demandItemFacet(w.itemSetPagingControl,r.itemKey),E=w.itemSetPagingControl.evaluate(b)(e,{setItemKey:r.itemKey}),A=E.totalItemCount,O=E.getPageKeys,M=y&&!!A&&void 0!==O,_=e.demandItemFacet(u.childItemsFacet,i),D=e.demandItemFacet(a.mediaGroupFacet,i),P=e.demandItemFacet(o.childItemsControl,i),H=o.childItemsControl.evaluate(P)(e,{itemKey:i,itemKeys:_&&_.itemKeys}).itemKeys,B=v>c.ResponsiveMode.large?"large":"small",j=t.SIZES[B],F=C(B),I=e.demandItemFacet(h.itemSetTilesListControl,i),q={mode:2,spacing:j.photoGroupTileMargin},R={mode:"large"===B?1:3,marginBottom:j.groupMargin,spacing:j.documentGroupTileMargin,minRowHeight:j.tileDefaultHeight},U=h.itemSetTilesListControl.evaluate(I)(e,{itemSetKey:i,itemKeys:H,responsiveMode:v,tileRenderer:m.ItemTileCell,grid:n.__assign({},R,D?q:{})}),z=U.tileRenderer,W=U.groupControlHandler,X=U.tileControlHandler,V=U.grid,$=[],J=[],K=[],Q=0;if(H){for(var G=0,Y=H;G<Y.length;G++){var Z=Y[G],ee=M&&void 0===Z;if(ee||e.isItemFacetResolved(u.pageFacet,Z)){K.push({key:ee?Q.toString():Z,content:{key:Z,setKey:i,index:-1,tileSize:B,tileMode:"document",enableRandomAccess:M},desiredSize:F,onRender:T});ee&&Q++}else if(e.isItemFacetResolved(a.isGroupFacet,Z)&&e.demandItemFacet(a.isGroupFacet,Z)){if(K.length>0){$.push(n.__assign({key:"",items:K},V));K=[]}var te=L(e,{itemKey:Z}),ne=e.demandItemFacet(a.mediaGroupFacet,Z)||D,re=h.itemSetTilesListGroupControl.evaluate(W)(e,{groupKey:Z,itemKeys:te,tileRenderer:z,headerRenderer:g.HeaderTileCell,tileControlHandler:X,showHeader:!!e.demandItemFacet(l.displayNameFacet,Z),grid:n.__assign({},V,ne?q:{})}),ie=re.tileRenderer,se=re.headerRenderer,oe=re.tileControlHandler,ue=re.showHeader,ae=re.grid;ue&&se&&$.push({key:Z,content:{key:Z,index:-1,setKey:i,tileSize:B,tileMode:"document",headerRenderer:se},onRender:x});for(var fe=[],le=0,ce=te;le<ce.length;le++){var he=ce[le];J.push({key:he});var pe=h.itemSetTilesListTileControl.evaluate(oe)(e,{itemKey:he,desiredSize:ne&&k(e,{itemKey:he})||F,tileMode:ne?"media":"document"}),de=pe.desiredSize,ve=pe.tileMode;e.isItemFacetResolved(u.pageFacet,he)?fe.push({key:Z,content:{key:Z,setKey:i,index:-1,tileSize:B,tileMode:"document"},desiredSize:de,onRender:T}):fe.push({key:he,content:{key:he,index:Q,tileSize:B,tileMode:ve,setKey:i,tileRenderer:ie},desiredSize:de,onRender:S});Q++}var me=n.__assign({key:Z,items:fe},ae);$.push(me)}else{J.push({key:Z});var ge=h.itemSetTilesListTileControl.evaluate(X)(e,{itemKey:Z,desiredSize:D&&k(e,{itemKey:Z})||F,tileMode:D?"media":"document"}),ye=(de=ge.desiredSize,ge.tileMode);K.push({key:Z,content:{key:Z,index:Q,tileSize:B,tileMode:ye,setKey:i,tileRenderer:z},desiredSize:de,onRender:S});Q++}}K.length>0&&$.push(n.__assign({key:"",items:K},V))}else p||e.isItemFacetResolved(f.errorFacet,i)||$.push(n.__assign({key:"",items:[{key:"",content:{key:"",setKey:i,index:Q,tileSize:B,tileMode:D?"media":"document"},desiredSize:C(B),onRender:N,isPlaceholder:!0}]},V,{isPlaceholder:!0}));return{setKey:i||"",items:$,selectionItems:J,isDataReadyForLayout:e.isItemFacetResolved(u.childItemsFacet,i)||e.isItemFacetResolved(f.errorFacet,i),getPageKeys:O}}function S(e,t){var n=e.tileRenderer;return n?r.createElement(v.SELECTION_CONTEXT.Consumer,null,function(i){return r.createElement(v.SET_SIZE_CONTEXT.Consumer,null,function(s){return r.createElement(n,{contentSize:t,itemKey:e.key,itemSetKey:e.setKey,tileSize:e.tileSize,itemTileMode:e.tileMode,selectionIndex:e.index,selection:i,"aria-posinset":e.index>-1?e.index+1:void 0,"aria-setsize":s})})}):null}function x(e){var t=e.headerRenderer;return t?r.createElement(v.SELECTION_CONTEXT.Consumer,null,function(n){return r.createElement(t,{itemKey:e.key,selection:n})}):null}function T(e,t){return e.enableRandomAccess?null:r.createElement(s.ItemPage,{itemKey:e.key,layout:"tile",contentSize:t})}function N(e,t){return r.createElement(i.ShimmerTile,{contentSize:t,itemName:!0,itemActivity:!0,itemThumbnail:!0})}function C(e){var n=t.SIZES[e];return{width:n.tileDefaultWidth,height:n.tileDefaultHeight}}function k(e,t){var n=e.demandItemFacet(p.thumbnailFacet,t.itemKey)||e.demandItemFacet(p.dimensionsFacet,t.itemKey);return n&&d.pickObject(n,["width","height"])}function L(e,t){for(var n=e.demandItemFacet(u.childItemsFacet,t.itemKey),r=[],i=0,s=n&&n.itemKeys||[];i<s.length;i++){var o=s[i];e.isItemFacetResolved(a.isGroupFacet,o)&&e.demandItemFacet(a.isGroupFacet,o)?r.push.apply(r,L(e,{itemKey:o})):r.push(o)}return r}});
define("@ms/items-view/lib/private/components/itemSetList/ItemSetSelectionContext",["require","exports","react"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SELECTION_CONTEXT=n.createContext(void 0);t.SET_SIZE_CONTEXT=n.createContext(0)});
define("@ms/items-view/lib/private/components/itemSetTilesList/ItemTileCell",["require","exports","tslib","react","../itemTile/ItemTile","../defaultDropZone/DefaultDropZone","../withAction/WithAction","../actions/defaultClick/DefaultClickAction","../decorators/withActionInvoker","../withItemCache/WithItemCache"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.itemKey,l=e.selectionIndex;return r.createElement(f.WithItemCache,null,function(f){var c=f.itemCache,h=o.evaluateAction(c,r.createElement(u.ItemDefaultClickAction,{itemKey:t})),p=o.evaluateAction(c,r.createElement(s.ItemDefaultDropZone,{itemKey:t,layoutMode:"absolute",enableDrag:!0,itemIndex:l}));return r.createElement(o.WithAction,{action:h},function(o){var u=o.isAvailable,f=r.createElement(r.Fragment,null,r.createElement(a.RegisterInvokeAction,n.__assign({},o,{itemKey:t,index:l})),r.createElement(i.ItemTile,n.__assign({contentSize:e.contentSize,itemKey:t,tileSize:e.tileSize,selectionIndex:l,invokeSelection:u,href:u?"javascript:;":void 0,role:"listitem"},e)));return s.renderChildrenWithDropZoneElement(f,p)})})};return t}(r.PureComponent);t.ItemTileCell=l});
define("@ms/items-view/lib/private/components/itemTile/ItemTile",["require","exports","tslib","react","@uifabric/experiments/lib/Tile","@uifabric/experiments/lib/FolderCover","@uifabric/experiments/lib/components/signals/Signals","../fields/baseText/BaseTextField","./ItemTile.scss","../itemFileTypeIcon/ItemFileTypeIcon","../fields/signal/SignalIcon","../../controls/itemAriaLabelControl","../../models/items/AriaHelper","../itemThumbnail/ItemThumbnail","../withItemCache/WithItemCache","@uifabric/utilities/lib/css","../../facets/ItemFacets","../../facets/GroupFacets","../../facets/MediaFacets","../fileHoverCard/getItemHoverCard","../../controls/itemTileControl","../../facets/ConfigurationFacets","../fields/date/DateRenderer","../../facets/DocumentFacets","../withAction/WithAction"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var N=s.FolderCover,C={small:{iconSize:48},large:{iconSize:64}},k=function(e){e.itemKey;var t=n.__rest(e,["itemKey"]);return r.createElement(i.Tile,n.__assign({},t))},L=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onThumbnailLoad=function(){n.setState({thumbnailLoaded:!0})};n._onThumbnailError=function(){n.setState({thumbnailFailed:!0})};n.state={};return n}t.prototype.render=function(){var e=this,t=this.props,L=t.itemKey,A=t.className,O=t.itemTileMode,M=void 0===O?"document":O,_=t.background,D=t.foreground,P=n.__rest(t,["itemKey","className","itemTileMode","background","foreground"]),H=this.props.tileSize,B=void 0===H?"large":H,j=this.state,F=j.thumbnailLoaded,I=j.thumbnailFailed;return r.createElement(d.WithItemCache,null,function(t){var d,O=t.itemCache,H=O.demandItem({displayName:m.displayNameFacet,dateModified:m.dateModifiedFacet,folder:m.folderFacet,oneNote:x.oneNoteFacet,isGroup:g.isGroupFacet,count:g.countFacet,isShared:m.isSharedFacet},L),j=H.displayName,q=H.folder,R=H.oneNote,U=H.isGroup,z=H.count,W=H.isShared,X=O.demandItemFacet(w.itemTileControl,L),V=w.itemTileControl.evaluate(X)(O,{itemKey:L,itemName:r.createElement(u.BaseText,{className:a.name,"data-automationid":"name",text:j||"",title:j||""}),itemActivity:r.createElement(S.DateRenderer,{itemKey:L}),tileAs:k}),$=V.tileAs,J=V.itemName,K=V.itemActivity,Q=l.getLifeCycleSignals(O,L,1,!0),G=Q&&Q.map(function(e){return e.signal}),Y=O.isItemFacetResolved(y.thumbnailFacet,L),Z=Y?O.demandItemFacet(y.thumbnailFacet,L):void 0,ee=O.demandItemFacet(c.itemAriaLabelControl,L),te=h.getRowAriaLabel(O,{itemKey:L}),ne=c.itemAriaLabelControl.evaluate(ee)(O,{itemKey:L,itemAriaLabel:te}).itemAriaLabel,re=O.demandItemFacet(E.enableFluentIconsFacet,E.configurationItemKey),ie=r.createElement($,n.__assign({itemKey:L,className:v.css(a.tile,A,(d={},d[a.hideThumbnail]=!F||!!I,d[a.hideFileTypeIcon]=!!F||!!Z&&!I,d)),itemName:J?r.createElement(o.SignalField,{signalsFieldMode:"compact",before:G},J):null,ariaLabel:ne,"data-automationid":"ItemTile",itemActivity:K?r.createElement(o.SignalField,null,K):null},P,{showForegroundFrame:!("document"!==M||q&&!R),showBackgroundFrame:"media"===M,hideForeground:!!Z&&!F,hideBackground:!!Z&&!F,foreground:r.createElement("div",null)})),se=i.getTileLayout(ie),oe=se.foregroundSize,ue=void 0===oe?{width:0,height:0}:oe,ae=se.backgroundSize,fe=void 0===ae?{width:0,height:0}:ae,le=[],ce=[];if(q&&!R||U){var he=r.createElement(N,{key:"folder",className:a.folderCover,folderCoverSize:e.props.tileSize,folderCoverType:"default",metadata:z,signal:e._getFolderCoverSignal(W),isFluent:re}),pe=s.getFolderCoverLayout(he).contentSize;le.push(s.renderFolderCoverWithLayout(he,{children:z?r.createElement("span",{className:a.blankFolderCover,style:{width:pe.width+"px",height:pe.height+"px"}}):null}))}else if(I||Y&&!F&&!Z)Y&&F||le.push(T.evaluateAction(O,r.createElement(f.ItemFileTypeIcon,{key:"fileTypeIcon",itemKey:L,className:a.fileTypeIcon,preferAppIcon:!1,size:C[B].iconSize})));else{"media"===M?ce.push(T.evaluateAction(O,r.createElement(p.ItemThumbnail,{key:"thumbnail",itemKey:L,className:a.thumbnail,desiredSize:fe,onError:e._onThumbnailError,onLoad:e._onThumbnailLoad}))):le.push(T.evaluateAction(O,r.createElement(p.ItemThumbnail,{key:"thumbnail",itemKey:L,className:a.thumbnail,desiredSize:ue,onError:e._onThumbnailError,onLoad:e._onThumbnailLoad})));le.push(T.evaluateAction(O,r.createElement(f.ItemFileTypeIcon,{key:"fileTypeIcon",itemKey:L,className:F?a.tileAppIcon:a.fileTypeIcon,size:F?16:C[B].iconSize,preferAppIcon:!!F})))}var de=T.evaluateAction(O,i.renderTileWithLayout(ie,{foreground:D||null===D?D:le.length>0?le:null,background:_||null===_?_:ce.length>0?ce:null})),ve=b.getItemHoverCard(O,{itemKey:L});return ve?r.createElement(ve,{itemKey:L},de):de})};t.prototype.UNSAFE_componentWillReceiveProps=function(e){e.itemKey!==this.props.itemKey&&this.setState({thumbnailLoaded:!1,thumbnailFailed:!1})};t.prototype._getFolderCoverSignal=function(e){return e?r.createElement(o.SharedSignal,null):null};return t}(r.PureComponent);t.ItemTile=L});
define("@uifabric/experiments/lib/FolderCover",["require","exports","tslib","./components/FolderCover/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@uifabric/experiments/lib/components/FolderCover/index",["require","exports","tslib","./FolderCover","./initializeFolderCovers"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("@uifabric/experiments/lib/components/FolderCover/FolderCover",["require","exports","tslib","react","../../Utilities","./FolderCover.scss","../signals/Signal.scss","office-ui-fabric-react/lib/Icon"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s,f=o,l=4,c={small:{width:72-2*l,height:52-2*l},large:{width:112-2*l,height:80-2*l}},h={small:{default:{back:"folderCoverSmallDefaultBack",front:"folderCoverSmallDefaultFront"},media:{back:"folderCoverSmallMediaBack",front:"folderCoverSmallMediaFront"}},large:{default:{back:"folderCoverLargeDefaultBack",front:"folderCoverLargeDefaultFront"},media:{back:"folderCoverLargeMediaBack",front:"folderCoverLargeMediaFront"}}},p=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e,t=this.props,s=t.folderCoverSize,o=void 0===s?"large":s,l=t.folderCoverType,c=void 0===l?"default":l,p=t.hideContent,d=void 0!==p&&p,v=t.metadata,m=t.signal,g=t.children,y=t.isFluent,b=n.__rest(t,["folderCoverSize","folderCoverType","hideContent","metadata","signal","children","isFluent"]),w=h[o][c],E=r.createElement("span",{className:i.css("ms-FolderCover-metadata",a.metadata)},v),S=r.createElement("span",{className:i.css("ms-FolderCover-signal",a.signal,y?f.isFluent:f.dark)},m);return r.createElement("div",n.__assign({},b,{className:i.css(a.root,(e={},e["ms-FolderCover--isSmall "+a.isSmall]="small"===o,e["ms-FolderCover--isLarge "+a.isLarge]="large"===o,e["ms-FolderCover--isDefault "+a.isDefault]="default"===c,e["ms-FolderCover--isMedia "+a.isMedia]="media"===c,e["ms-FolderCover--hideContent "+a.hideContent]=d,e["ms-FolderCover--isFluent "+a.isFluent]=y,e))}),r.createElement(u.Icon,{"aria-hidden":!0,className:i.css("ms-FolderCover-back",a.back),iconName:w.back}),this._renderChildren({children:g}),r.createElement(u.Icon,{"aria-hidden":!0,className:i.css("ms-FolderCover-front",a.front),iconName:w.front}),y?r.createElement(r.Fragment,null,E,S):r.createElement(r.Fragment,null,S,E))};t.prototype._renderChildren=function(e){var t=e.children,n="function"==typeof t?t(d(this.props)):t;return n?r.createElement("span",{className:i.css("ms-FolderCover-content",a.content)},r.createElement("span",{className:i.css("ms-FolderCover-frame",a.frame)},n)):null};return t}(r.Component);t.FolderCover=p;t.getFolderCoverLayout=function(e){return d(e.props)};function d(e){var t=e.folderCoverSize,r=void 0===t?"large":t,i=e.isFluent,s=n.__assign({},c[r]);i&&(s.height-=8);return{contentSize:s}}t.renderFolderCoverWithLayout=function(e,t){var i=e.type;return r.createElement(i,n.__assign({},e.props,t))}});
define("@uifabric/experiments/lib/components/FolderCover/FolderCover.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".root_ee0ecd1f{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;position:relative;vertical-align:bottom;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.root_ee0ecd1f,.root_ee0ecd1f.isSmall_ee0ecd1f{width:72px;height:52px}.root_ee0ecd1f.isLarge_ee0ecd1f{width:112px;height:80px}.front_ee0ecd1f{display:block;position:absolute;left:-3px;right:-3px;bottom:-4px}.back_ee0ecd1f{display:block;position:absolute;left:-3px;right:-3px;bottom:-4px}.content_ee0ecd1f{position:absolute;left:4px;right:4px;bottom:4px;top:4px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;opacity:1;-webkit-transition:opacity 0.2s linear;transition:opacity 0.2s linear}.hideContent_ee0ecd1f .content_ee0ecd1f{opacity:0}.isFluent_ee0ecd1f .content_ee0ecd1f{top:12px}.frame_ee0ecd1f{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;position:relative;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;overflow:hidden;max-width:100%;max-height:100%;-webkit-box-shadow:0 1px 3px 2px rgba(1,1,0,0.06);box-shadow:0 1px 3px 2px rgba(1,1,0,0.06);background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";min-width:32px;min-height:32px}.metadata_ee0ecd1f{display:block;-webkit-box-flex:1;-ms-flex:1 1;flex:1 1;white-space:nowrap;text-overflow:ellipsis;overflow:hidden;font-weight:400;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:relative}html[dir='ltr'] .metadata_ee0ecd1f{margin-right:8px}html[dir='rtl'] .metadata_ee0ecd1f{margin-left:8px}html[dir='ltr'] .metadata_ee0ecd1f{text-align:right}html[dir='rtl'] .metadata_ee0ecd1f{text-align:left}.isFluent_ee0ecd1f .metadata_ee0ecd1f{color:"},{theme:"yellowDark",defaultValue:"#d29200"},{rawString:"}html[dir='ltr'] .isFluent_ee0ecd1f .metadata_ee0ecd1f{text-align:left}html[dir='rtl'] .isFluent_ee0ecd1f .metadata_ee0ecd1f{text-align:right}.metadata_ee0ecd1f,.metadata_ee0ecd1f.isSmall_ee0ecd1f{font-size:12px;margin-bottom:3px}html[dir='ltr'] .metadata_ee0ecd1f,html[dir='ltr'] .metadata_ee0ecd1f.isSmall_ee0ecd1f{margin-left:4px}html[dir='rtl'] .metadata_ee0ecd1f,html[dir='rtl'] .metadata_ee0ecd1f.isSmall_ee0ecd1f{margin-right:4px}.isLarge_ee0ecd1f .metadata_ee0ecd1f{font-size:14px;margin-bottom:6px}html[dir='ltr'] .isLarge_ee0ecd1f .metadata_ee0ecd1f{margin-left:8px}html[dir='rtl'] .isLarge_ee0ecd1f .metadata_ee0ecd1f{margin-right:8px}.signal_ee0ecd1f{display:block;position:relative;margin-bottom:8px}html[dir='ltr'] .signal_ee0ecd1f{margin-left:8px}html[dir='rtl'] .signal_ee0ecd1f{margin-right:8px}html[dir='ltr'] .signal_ee0ecd1f{margin-right:4px}html[dir='rtl'] .signal_ee0ecd1f{margin-left:4px}.signal_ee0ecd1f,.signal_ee0ecd1f.isSmall_ee0ecd1f{font-size:17px;margin-bottom:3px}.isLarge_ee0ecd1f .signal_ee0ecd1f{font-size:21px;margin-bottom:6px}html[dir='ltr'] .isLarge_ee0ecd1f .signal_ee0ecd1f{margin-right:7px}html[dir='rtl'] .isLarge_ee0ecd1f .signal_ee0ecd1f{margin-left:7px}\n"}]);t.root="root_ee0ecd1f";t.isSmall="isSmall_ee0ecd1f";t.isLarge="isLarge_ee0ecd1f";t.front="front_ee0ecd1f";t.back="back_ee0ecd1f";t.content="content_ee0ecd1f";t.hideContent="hideContent_ee0ecd1f";t.isFluent="isFluent_ee0ecd1f";t.frame="frame_ee0ecd1f";t.metadata="metadata_ee0ecd1f";t.signal="signal_ee0ecd1f"});
define("@ms/items-view/lib/private/components/itemTile/ItemTile.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".tile_d9460a2f.hideFileTypeIcon_d9460a2f .fileTypeIcon_d9460a2f{display:none}.tile_d9460a2f.hideThumbnail_d9460a2f .thumbnail_d9460a2f{display:none}.folderCover_d9460a2f{margin:3px}.thumbnail_d9460a2f{display:inline-block}.thumbnailNotResolved_d9460a2f{display:none}.fileTypeIcon_d9460a2f{margin:16px}.name_d9460a2f{display:inline;max-width:100%}.blankFolderCover_d9460a2f{background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";display:inline-block}.tileAppIcon_d9460a2f{position:absolute;bottom:0;margin:4px}[dir='ltr'] .tileAppIcon_d9460a2f{left:0px}[dir='rtl'] .tileAppIcon_d9460a2f{right:0px}\n"}]);t.tile="tile_d9460a2f";t.hideFileTypeIcon="hideFileTypeIcon_d9460a2f";t.fileTypeIcon="fileTypeIcon_d9460a2f";t.hideThumbnail="hideThumbnail_d9460a2f";t.thumbnail="thumbnail_d9460a2f";t.folderCover="folderCover_d9460a2f";t.thumbnailNotResolved="thumbnailNotResolved_d9460a2f";t.name="name_d9460a2f";t.blankFolderCover="blankFolderCover_d9460a2f";t.tileAppIcon="tileAppIcon_d9460a2f"});
define("@ms/items-view/lib/private/components/itemThumbnail/ItemThumbnail",["require","exports","tslib","react","../../controls/itemThumbnailControl","@uifabric/utilities/lib/css","@uifabric/utilities/lib/math","./ItemThumbnail.scss","../../facets/MediaFacets","../../models/images/ImageByUrlKeyFacet","../../facets/ItemFacets","../../operations/images/ImageAddon","../../components/decorators/connectToItemCache"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.componentDidMount=function(){this.props.itemCacheDispatch(c.imageAddon)};t.prototype.render=function(){var e,t=this.props,i=t.url,a=t.actualSize,f=t.desiredSize,l=t.className,c=t.onError,h=t.onLoad;if(!i)return null;d(a)&&d(f)&&(e=o.fitContentToBounds({boundsSize:f,contentSize:a,mode:"contain"}));return r.createElement("img",n.__assign({className:s.css(u.image,l),src:i,onLoad:h,onError:c},e?{style:{width:e.width+"px",height:e.height+"px"}}:{}))};return t}(r.PureComponent);t.ItemThumbnail=h.connectToItemCache(function(e,t){var n,r,s=t.itemKey,o=t.desiredSize,u=e.isItemFacetResolved(a.thumbnailFacet,s),c=u?e.demandItemFacet(a.thumbnailFacet,s):void 0;if(!u||c){var h=e.demandItemFacet(i.itemThumbnailControl,s),p=i.itemThumbnailControl.evaluate(h)(e,{itemKey:s,originalImage:c,desiredSize:o,thumbnail:c}).thumbnail;if(p&&p.url){var d=f.imageByUrlKeyFacet.serialize({url:p.url});n=e.demandItemFacet(l.openUrlFacet,d);r=e.demandItemFacet(a.dimensionsFacet,d)}}return{url:n,actualSize:r}})(p);function d(e){return!!e&&e.width>0&&e.height>0}});
define("@ms/items-view/lib/private/components/itemThumbnail/ItemThumbnail.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".image_4aa51e4d{display:block}\n"}]);t.image="image_4aa51e4d"});
define("@ms/items-view/lib/private/models/images/ImageByUrlKeyFacet",["require","exports","../KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.imageByUrlKeyFacet=new n.KeyFacet("imageByUrl",{url:n.stringPart()})});
define("@ms/items-view/lib/private/operations/images/ImageAddon",["require","exports","tslib","../../addons/registerOperationHandler","../../models/images/ImageByUrlKeyFacet","../../operations/getItems","../../utilities/async/Signal","@uifabric/utilities/lib/EventGroup","@uifabric/utilities/lib/Async","../../facets/ItemFacets","../../operations/configuration/readConfiguration","../../facets/ConfigurationFacets","../../utilities/async/CancelError","../../utilities/async/wait","../../facets/MediaFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=3e4,m=30;function g(e){var t=this,r=i.imageByUrlKeyFacet.deserialize(e.itemKey).url;return function(i){return n.__awaiter(t,void 0,void 0,function(){var t,l,c,g,y,b,w,E,S;return n.__generator(this,function(x){switch(x.label){case 0:l=new o.Signal,c=l.resolve,g=l.reject,y=l.promise;(b=new Image).src=r;w=!!b.complete;E=new u.EventGroup(null);(S=new a.Async(void 0)).setTimeout(function(){g(new h.CancelError)},v);E.on(b,"load",function(){c()});E.on(b,"error",function(){g(new Error("Image failed to load."))});x.label=1;case 1:x.trys.push([1,,5,6]);return[4,y];case 2:x.sent();return!b.complete||w?[3,4]:[4,p.wait(m)];case 3:x.sent();x.label=4;case 4:i(s.resolveItems({items:(t={},t[e.itemKey]=n.__assign({},f.openUrlFacet.pack(r),d.dimensionsFacet.pack({width:b.naturalWidth||b.width||0,height:b.naturalHeight||b.height||0})),t)}));return[3,6];case 5:S.dispose();E.dispose();return[7];case 6:return[2]}})})}}t.imageAddon=r.createAddon(function(){return function(e){var t=e(l.readConfiguration({maxParallelImageLoadCount:c.maxParallelImageLoadCountFacet})).maxParallelImageLoadCount,n=void 0===t?16:t;e(r.registerOperationHandler(i.imageByUrlKeyFacet,s.getItemsOperation)(r.createSingleItemOperationHandler({maxParallelOperationCount:n})(g)))}})});
define("@ms/items-view/lib/private/controls/itemTileControl",["require","exports","../models/controls/ControlFacet","../components/controls/defaultRenderComponentControlOption"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemTileControl=new n.ControlFacet("itemTileControl",{tileAs:r.defaultRenderComponentOption()})});
define("@ms/items-view/lib/private/components/itemSetTilesList/HeaderTileCell",["require","exports","react","../decorators/connectToItemCache","../../facets/ItemFacets"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.HeaderTileCell=r.connectToItemCache(function(e,t){return{text:e.demandItemFacet(i.displayNameFacet,t.itemKey)||""}})(function(e){return n.createElement("div",null,n.createElement("h3",null,e.text))})});
define("@ms/items-view/lib/private/components/itemSetTilesList/InjectableItemSetTilesList",["require","exports","tslib","react","office-ui-fabric-react/lib/MarqueeSelection","../decorators/withLayoutRenderComplete","./ItemSetTilesList.scss","@uifabric/utilities/lib/dom/findElementRecursive","../itemSetList/ItemSetSelectionContext"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=n.props,i=r.selection,s=r.selectionItems;i&&i.setItems(s,!0);return n}t.prototype.render=function(){var e=this.props,t=e.selection,s=e.selectionMode,u=(e.ref,e.disableMarqueeSelection),f=e.ariaLabel,c=e.selectionItems,h=e.onRenderTilesList,p=n.__rest(e,["selection","selectionMode","ref","disableMarqueeSelection","ariaLabel","selectionItems","onRenderTilesList"]),d=h(n.__assign({role:"list",className:o.root,"aria-label":f},p)),v=t?r.createElement(i.SelectionZone,{selection:t,selectionMode:s,onItemInvoked:this.props.onItemInvoked,onItemContextMenu:this.props.onItemContextMenu,disableAutoSelectOnInputElements:!0},r.createElement(a.SELECTION_CONTEXT.Provider,{value:t},r.createElement(a.SET_SIZE_CONTEXT.Provider,{value:c.length},d))):d;return t?u?v:r.createElement(i.MarqueeSelection,{selection:t,onShouldStartSelection:l},v):d};t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=e.selection,n=e.selectionItems;t&&t.setItems(n,e.setKey!==this.props.setKey||!e.setKey)};return t}(r.PureComponent);t.InjectableItemSetTilesList=s.withLayoutRenderComplete({qosName:"Tiles"})(f);function l(e){return!u.findElementRecursive(e.target,function(e){return null!==e.getAttribute("data-selection-index")})}});
define("@ms/items-view/lib/private/components/itemSetTilesList/ItemSetTilesList.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".root_aa4d6d14{display:block}\n"}]);t.root="root_aa4d6d14"});
define("@ms/items-view/lib/private/components/DeferredComponents",["require","exports","tslib","./actions/showMalwareDetected/MalwareDetectedDialog","./progress/panel/ProgressPanel","./itemsContextMenu/ItemsContextMenu","./itemsContextMenu/ActionContextMenu","./uploader/UploaderCore"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t);n.__exportStar(s,t);n.__exportStar(o,t);n.__exportStar(u,t)});
define("@ms/items-view/lib/private/components/actions/showMalwareDetected/MalwareDetectedDialog",["require","exports","tslib","react","@ms/utilities-strings/lib/index","office-ui-fabric-react/lib/Label","office-ui-fabric-react/lib/Dialog","office-ui-fabric-react/lib/Button","../../../utilities/async/CancelError","./MalwareDetectedMessage.resx","../../scope/actions/strings.resx","office-ui-fabric-react/lib/Styling","../../withAction/WithAction","../../actions/download/DownloadAction"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.state={};return n}t.prototype.render=function(){var e=this,t=this.props.itemKey,d=function(){e.props.reject(new a.CancelError)},m=c.getTheme();return r.createElement(h.WithAction,{action:r.createElement(p.ItemDownloadAction,{itemKeys:[t]})},function(t){var a=t.isAvailable,c=t.execute,h=a?function(){return n.__awaiter(e,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:t.trys.push([0,2,,3]);this.setState({startedDownload:!0});return[4,c()];case 1:t.sent();this.props.resolve();return[3,3];case 2:e=t.sent();this.props.reject(e);return[3,3];case 3:return[2]}})})}:void 0,p=a?f.default.malwareDetectedAllowDownloadMessage:f.default.malwareDetectedMessage;return e.state.startedDownload?null:r.createElement(o.Dialog,{isOpen:!0,onDismiss:d,title:f.default.malwareDetectedDialogHeader,closeButtonAriaLabel:f.default.closeButtonAriaLabel,type:o.DialogType.close,styles:v,dialogContentProps:{styles:function(){return{title:{color:m.semanticColors.errorText,fontWeight:"500"}}}}},r.createElement(s.Label,null,i.formatToArray(p,r.createElement("a",{href:"https://go.microsoft.com/fwlink/?linkid=862871",target:"_blank"},f.default.malwareDetectedLearnMore))),r.createElement(o.DialogFooter,null,h?r.createElement(u.DefaultButton,{onClick:h},f.default.malwareDialogDownload):null,r.createElement(u.DefaultButton,{onClick:d,primary:!0},l.default.cancelActionText)))})};return t}(r.PureComponent);t.MalwareDetectedDialog=d;function v(){return{main:{maxWidth:"450px !important"}}}});
define("@ms/items-view/lib/private/components/actions/download/DownloadAction",["require","exports","../../downloader/Downloader","../../base/actions/download/DownloadAction","../../decorators/connectToItemCache"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemDownloadAction=i.connectToItemCache(function(){return{downloader:n.Downloader}})(r.ItemDownloadAction);t.DownloadAction=i.connectToItemCache(function(){return{downloader:n.Downloader}})(r.DownloadAction)});
define("@ms/items-view/lib/private/components/downloader/Downloader",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","@ms/utilities-browser/lib/PlatformDetection","@ms/items-view-utilities/lib/navigation/NavigateViaPost"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=(new s.PlatformDetection).isIE,a={},f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onFrameRef=function(e){var t=e&&e.contentDocument;n.setState({targetDocument:t||void 0})};n._async=new i.Async(n);n._window=null;n.state=a;return n}t.prototype.render=function(){var e=this.state.downloadData;return e?u||this.props.preferOpenInBrowser?null:r.createElement("div",{style:{display:"none"}},r.createElement("iframe",{hidden:!0,ref:this._onFrameRef,src:"GET"===e.method?e.url:"about:blank"})):null};t.prototype.UNSAFE_componentWillMount=function(){return n.__awaiter(this,void 0,void 0,function(){return n.__generator(this,function(e){this._getDownloadData();return[2]})})};t.prototype.componentDidMount=function(){if(u||this.props.preferOpenInBrowser)try{this._window=window.open()}catch(e){}this._onUpdate(a);if(this._window){var e=this._window&&this._window.document;this.setState({targetDocument:e||void 0})}};t.prototype.componentDidUpdate=function(e,t){this._onUpdate(t)};t.prototype.componentWillUnmount=function(){if(this._window){this._window.close();this._window=null}};t.prototype.componentDidCatch=function(e){this.props.reject(e)};t.prototype._onUpdate=function(e){var t=this.state,n=t.downloadData,r=t.targetDocument;!e.downloadData&&n&&this._async.setTimeout(this._onDownloadTimeout,2e4);try{!e.downloadData&&n&&"GET"===n.method&&this._window&&(this._window.location.href=n.url);e.targetDocument&&e.downloadData||!r||!n||"POST"!==n.method||o.navigateViaPost({document:r,postdata:n.postData,url:n.url})}catch(e){this.props.reject(e)}};t.prototype._getDownloadData=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:n.trys.push([0,2,,3]);return[4,this.props.getDownloadData()];case 1:e=n.sent();this.setState({downloadData:e});return[3,3];case 2:t=n.sent();this.props.reject(t);return[3,3];case 3:return[2]}})})};t.prototype._onDownloadTimeout=function(){this.props.resolve()};return t}(r.PureComponent);t.Downloader=f});
define("@ms/items-view-utilities/lib/navigation/NavigateViaPost",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.navigateViaPost=function(e){var t=e.document;t.body||t.createElement("body");var n=t.createElement("form");n.action=e.url;n.method="POST";n.style.visibility="hidden";n.target="_self";var r=e.postdata;for(var i in r)if(r.hasOwnProperty(i)){var s=t.createElement("input");s.type="hidden";s.name=i;s.value=r[i];n.appendChild(s)}t.body.appendChild(n);n.submit()}});
define("@ms/items-view/lib/private/components/base/actions/download/DownloadAction",["require","exports","tslib","react","../../../../controls/downloadItemsActionControl","../../../decorators/selectors","../../../../models/telemetry/getItemEngagement","../../../itemsScope/ItemsScope","../../../decorators/connectToItemsScope","../../../decorators/connectToItemCache","../../../withAction/WithAction","../../../action/Action"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemDownloadAction=f.connectToItemCache(function(e,t){var s=t.itemKeys,f=t.downloader,h=s[0];if(!h)return{action:null};var p=a.getItemsScope(e).itemsScopeItemKey,d=e.demandItemFacet(i.downloadItemsActionControlFacet,h),v=i.downloadItemsActionControlFacet.evaluate(d)(e,{itemKeys:s,downloader:f,isAvailable:!1}),m=v.downloader,g=v.getDownloadData,y=v.isAvailable;if(!m||!g||!y)return{action:null};var b=e.dispatch,w=function(){return b(g())},E=l.renderComponentOnExecute(function(e){return r.createElement(u.ItemsScope,{itemsScopeItemKey:p},r.createElement(m,n.__assign({itemKeys:s,getDownloadData:w},e)))},{scope:"headless"});return{action:r.createElement(c.Action,n.__assign({isAvailable:y,onExecute:E},o.getItemActionEngagement(e,{itemKey:h,engagement:{name:"Download",isIntentional:!0}})))}})(l.ActionSelector);t.DownloadAction=s.withSelectedItems()(s.withCurrentItemAsFallback()(t.ItemDownloadAction))});
define("@ms/items-view/lib/private/components/progress/panel/ProgressPanel",["require","exports","tslib","react","office-ui-fabric-react/lib/Panel","../../../operations/progress","../ProgressStrings.resx","../list/ProgressList","../../withItemCache/WithItemCache","../../../utilities/objects","../../../facets/SetFacets","../../../facets/ProgressFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=[],p=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this;return r.createElement(a.WithItemCache,null,function(t){var n=t.itemCache,a=t.dispatch,p=n.demandItemFacet(l.childItemsFacet,s.progressRootItemKey),d=p&&p.itemKeys||h,v=d.filter(function(e){var t=s.getOverallProgressPhase(n,{itemKey:e});return t===c.ProgressPhase.completed||t===c.ProgressPhase.canceled});return r.createElement(i.Panel,{isOpen:!0,headerText:o.default.progressTitle,isLightDismiss:!0,onDismissed:function(){a(s.expireProgressItems({items:f.makeObject(v,function(){return!0})}));e.props.resolve()},closeButtonAriaLabel:o.default.progressCloseActionText},r.createElement(u.ProgressList,{itemKeys:d}))})};return t}(r.PureComponent);t.ProgressPanel=p});
define("@ms/items-view/lib/private/components/progress/list/ProgressList",["require","exports","tslib","react","@uifabric/experiments/lib/TilesList","../itemTile/ProgressItemTile","./ProgressList.scss","../../withItemCache/WithItemCache","../ProgressStrings.resx","@uifabric/utilities/lib/css","../../../facets/ProgressFacets","../../../facets/SetFacets","../../../operations/progress","../../../controls/progressListControl"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.itemKeys,n=e.groupsOnly;return r.createElement(u.WithItemCache,null,function(e){for(var s=e.itemCache,u=[],f=s.demandItemFacet(p.progressListControl,void 0),d=p.progressListControl.evaluate(f)(s,{}).groupControlHandler,g=function(e){if(h.getOverallProgressPhase(s,{itemKey:e})===l.ProgressPhase.expired)return"continue";var t=function(r,i){u.push({key:r,content:{itemKey:r,index:u.length},onRender:0===i?v:m});if(!(n&&i>=1)){var o=s.demandItemFacet(p.progressListGroupControl,e),a=s.demandItemFacet(c.childItemsFacet,r),f=a&&a.itemKeys,l=p.progressListGroupControl.evaluate(o,d)(s,{itemKey:r,childItemKeys:f,maxChildItemCount:void 0}).maxChildItemCount;if(f)for(var h=0,g="number"==typeof l?f.slice(0,l):f;h<g.length;h++){var y=g[h];t(y,i+1)}}};t(e,0)},y=0,b=t;y<b.length;y++){g(b[y])}return u.length>0?r.createElement(i.TilesList,{className:o.root,items:u,role:"presentation"}):r.createElement("p",null,a.default.progressNoItemsMessage)})};return t}(r.Component);t.ProgressList=d;function v(e){var t=e.itemKey;return r.createElement("div",{className:f.css(o.group)},r.createElement(s.ProgressItemTile,{itemKey:t,format:"group"}))}function m(e){var t=e.itemKey;return r.createElement("div",{className:f.css(o.item)},r.createElement(s.ProgressItemTile,{itemKey:t,format:"item"}))}});
define("@ms/items-view/lib/private/components/progress/itemTile/ProgressItemTile",["require","exports","tslib","react","@uifabric/utilities/lib/css","./ProgressItemTile.scss","office-ui-fabric-react/lib/ProgressIndicator","../../withItemCache/WithItemCache","../../../controls/progressControl","../../itemFileTypeIcon/ItemFileTypeIcon","../../../operations/progress","office-ui-fabric-react/lib/components/Button/IconButton/IconButton","@ms/utilities-strings/lib/index","../ProgressStrings.resx","../../../facets/ProgressFacets","../../../facets/ItemFacets","../../../facets/DemandFacets","../../withAction/WithAction","../actions/cancel/CancelProgressAction","../actions/expire/ExpireProgressAction","../../../utilities/async/CancelError","../../actionCommandButtonStrip/ActionCommandButtonStrip","../../decorators/withControlHandler","../../../controls/selectedItemsControl"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var T,N,C=[],k=((T={})[d.ProgressPhase.started]=function(e){return h.format(h.getLocalizedCountValue(p.default.genericStartedItemsTitle,p.default.genericCompletedItemsTitleIntervals,e)||"",e)},T[d.ProgressPhase.completed]=function(e){return h.format(h.getLocalizedCountValue(p.default.genericCompletedItemsTitle,p.default.genericCompletedItemsTitleIntervals,e)||"",e)},T[d.ProgressPhase.failed]=function(e){return h.format(h.getLocalizedCountValue(p.default.genericFailedItemsTitle,p.default.genericFailedItemsTitleIntervals,e)||"",e)},T[d.ProgressPhase.canceled]=function(e){return h.format(h.getLocalizedCountValue(p.default.genericFailedItemsTitle,p.default.genericFailedItemsTitleIntervals,e)||"",e)},T),L=((N={})[d.ProgressPhase.created]=p.default.genericCreatedDescription,N[d.ProgressPhase.canceled]=p.default.genericCanceledDescription,N[d.ProgressPhase.completed]=p.default.genericCompletedDescription,N),A=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e,t=this.props,n=t.icon,u=t.actions,a=t.cancel,f=t.description,l=t.title,c=l?r.createElement("div",{className:i.css(s.title)},l):l,h=f?r.createElement("div",{className:i.css(s.description)},f):f;return r.createElement("div",{className:i.css(s.tile,(e={},e[s.hasIcon]=!!n,e[s.error]=!!this.props.error,e))},n?r.createElement("span",{className:i.css(s.icon)},this.props.icon):null,r.createElement("div",{className:i.css(s.progress)},r.createElement(o.ProgressIndicator,{label:c,description:h,percentComplete:this.props.percentComplete,progressHidden:this.props.progressHidden})),u?r.createElement("div",{className:i.css(s.actions)},u):null,a?r.createElement("span",{className:i.css(s.cancel)},a):null)};return t}(r.PureComponent);t.ProgressTile=A;var O=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,i=t.itemKey,s=t.format;return r.createElement(u.WithItemCache,null,function(t){var o=t.itemCache,u=(t.dispatch,o.demandItemFacet(d.sourceItemFacet,i)),h=u&&u.itemKey,T=o.demandItemFacet(v.displayNameFacet,i)||o.demandItemFacet(v.displayNameFacet,h),N=o.demandItemFacet(m.errorFacet,i),O=o.demandItemFacet(a.progressControl,i),M=l.getItemCountsByProgressPhase(o,{itemKey:i}),_=l.getOverallSimpleProgressBreakdown(o,{itemKey:i}),D=_.phase,P=_.count,H=l.getOverallProgressPhase(o,{itemKey:i}),B=D!==d.ProgressPhase.started?1:void 0,j=a.progressControl.evaluate(O)(o,n.__assign({itemKey:e.props.itemKey,title:T||k[D](P),description:N&&!w.isCancel(N)?N.message:L[H]},B?{percentComplete:B}:{},{itemCountsByPhase:M,format:s,commands:C})),F=j.title,I=j.description,q=j.percentComplete,R=j.commands,U="started"===D?r.createElement(y.CancelProgressAction,null):"failed"===D?r.createElement(b.ExpireProgressAction,null):null,z="started"===D||"failed"===D&&"number"==typeof q&&q<1;return r.createElement(S.ControlHandlerProvider,{controlHandlers:x.selectedItemsControl.pack(function(e,t){return{itemKeys:[i]}})},r.createElement(g.WithAction,{action:U},function(e){var t=e.execute,n=e.isAvailable?function(){t().catch(function(){})}:void 0;return r.createElement(A,{title:"item"===s&&T||F,description:I,percentComplete:q,error:N&&!w.isCancel(N)?N:void 0,progressHidden:!z,icon:"item"===s?r.createElement(f.ItemFileTypeIcon,{itemKey:h,size:48}):void 0,cancel:n?r.createElement(c.IconButton,{iconProps:{iconName:"Cancel"},ariaLabel:"started"===D?p.default.progresslistCancelButtonAriaLabel:p.default.progresslistRemoveButtonAriaLabel,onClick:n}):void 0,actions:R.length>0?r.createElement(E.ActionCommandButtonStrip,{commands:R}):void 0})}))})};return t}(r.PureComponent);t.ProgressItemTile=O});
define("@ms/items-view/lib/private/components/progress/itemTile/ProgressItemTile.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".tile_45e8cf86{display:block;position:relative;padding-bottom:8px}[dir='ltr'] .tile_45e8cf86{padding-right:40px}[dir='rtl'] .tile_45e8cf86{padding-left:40px}.tile_45e8cf86.hasIcon_45e8cf86{min-height:60px}[dir='ltr'] .tile_45e8cf86.hasIcon_45e8cf86{padding-left:56px}[dir='rtl'] .tile_45e8cf86.hasIcon_45e8cf86{padding-right:56px}.title_45e8cf86{display:inline}.icon_45e8cf86{position:absolute;width:48px;display:block;top:8px}[dir='ltr'] .icon_45e8cf86{left:0}[dir='rtl'] .icon_45e8cf86{right:0}.progress_45e8cf86{display:block}.error_45e8cf86 .progress_45e8cf86 .ms-ProgressIndicator-itemProgress{display:none}.description_45e8cf86{font-size:12px}.error_45e8cf86 .description_45e8cf86{color:#a80000}.actions_45e8cf86{display:block;margin:8px 0 20px 0}.cancel_45e8cf86{position:absolute;display:block;top:0;width:32px;font-size:14px}[dir='ltr'] .cancel_45e8cf86{right:0}[dir='rtl'] .cancel_45e8cf86{left:0}\n"}]);t.tile="tile_45e8cf86";t.hasIcon="hasIcon_45e8cf86";t.title="title_45e8cf86";t.icon="icon_45e8cf86";t.progress="progress_45e8cf86";t.error="error_45e8cf86";t.description="description_45e8cf86";t.actions="actions_45e8cf86";t.cancel="cancel_45e8cf86"});
define("@ms/items-view/lib/private/controls/progressControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.progressControl=new n.ControlFacet("progress")});
define("@ms/items-view/lib/private/components/progress/actions/cancel/CancelProgressAction",["require","exports","tslib","react","../../../withItemCache/WithItemCache","../../../../operations/progress/cancelProgressItems","../../../../utilities/objects","../../../action/Action","../../../../operations/progress","../../../decorators/selectors"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.itemKeys;return r.createElement(i.WithItemCache,null,function(i){var f=i.itemCache,l=i.dispatch,c=t.filter(function(e){return"started"===a.getOverallSimpleProgressBreakdown(f,{itemKey:e}).phase});return r.createElement(u.Action,{onExecute:function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){l(s.cancelProgressItems({items:o.makeObject(c,function(){return{}})}));return[2]})})},isAvailable:c.length>0})})};return t}(r.PureComponent);t.ItemCancelProgressAction=l;t.CancelProgressAction=f.withSelectedItems()(l)});
define("@ms/items-view/lib/private/operations/progress/cancelProgressItems",["require","exports","../../models/Facet","../../store/actions/implementOperation"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.cancelProgressItemsOperation=new n.Facet("cancelProgressItemsOperation");t.cancelProgressItems=r.implementOperation({operationTypeFacet:t.cancelProgressItemsOperation})});
define("@ms/items-view/lib/private/components/progress/actions/expire/ExpireProgressAction",["require","exports","tslib","react","../../../withItemCache/WithItemCache","../../../../utilities/objects","../../../action/Action","../../../../operations/progress","../../../../facets/GroupFacets","../../../decorators/selectors"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.itemKeys;return r.createElement(i.WithItemCache,null,function(i){var f=i.itemCache,l=i.dispatch,c=t.filter(function(e){var t=f.demandItemFacet(a.isGroupFacet,e),n=u.getOverallSimpleProgressBreakdown(f,{itemKey:e}).phase;return t&&"failed"===n});return r.createElement(o.Action,{onExecute:function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){l(u.expireProgressItems({items:s.makeObject(c,function(){return!0})}));return[2]})})},isAvailable:c.length>0})})};return t}(r.PureComponent);t.ItemExpireProgressAction=l;t.ExpireProgressAction=f.withSelectedItems()(l)});
define("@ms/items-view/lib/private/components/actionCommandButtonStrip/ActionCommandButtonStrip",["require","exports","tslib","react","office-ui-fabric-react/lib/Button","../commandSet/CommandSet","@uifabric/experiments/lib/LayoutGroup","./CommandButton.scss"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(s.CommandSet,{commands:this.props.commands},function(e){var t=e.menuItems;return r.createElement(o.LayoutGroup,{direction:"horizontal"},t.map(function(e){var t=e.onClick,n=t?function(){t()}:void 0;return r.createElement(i.DefaultButton,{className:u.commandButton,key:e.key,onClick:n},e.name)}))})};return t}(r.PureComponent);t.ActionCommandButtonStrip=a});
define("@uifabric/experiments/lib/LayoutGroup",["require","exports","tslib","./components/LayoutGroup/index"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@uifabric/experiments/lib/components/LayoutGroup/index",["require","exports","tslib","./LayoutGroup"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("@uifabric/experiments/lib/components/LayoutGroup/LayoutGroup",["require","exports","tslib","react","office-ui-fabric-react/lib/Styling","office-ui-fabric-react/lib/Utilities"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._getJustify=function(e){return"end"===e?"flex-end":"center"===e?"center":"flex-start"};return t}t.prototype.render=function(){var e=this.props,t=e.children,o=e.direction,u=e.layoutGap,a=e.justify,f=s.getNativeProps(this.props,s.divProperties),l=r.Children.count(t),c=r.Children.map(t,function(e,t){var n=t===l-1;return r.createElement("div",{className:i.mergeStyles("ms-LayoutGroup-item","horizontal"===o&&!n&&{marginRight:u+"px"},"vertical"===o&&!n&&{marginBottom:u+"px"},"fill"===a&&{flexBasis:"0",flexGrow:1})},e)});return r.createElement("div",n.__assign({},f,{className:i.mergeStyles("ms-LayoutGroup",{display:"flex",flexDirection:"horizontal"===o?"row":"column",justifyContent:this._getJustify(a)})}),c)};t.defaultProps={layoutGap:8,direction:"vertical",justify:"start"};return t}(r.Component);t.LayoutGroup=o});
define("@ms/items-view/lib/private/components/actionCommandButtonStrip/CommandButton.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".commandButton_3bbc318a{font-size:14px}\n"}]);t.commandButton="commandButton_3bbc318a"});
define("@ms/items-view/lib/private/components/progress/list/ProgressList.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".root_af89891e{overflow-x:hidden}.group_af89891e{margin:14px 8px 0 8px}.item_af89891e{margin:0}\n"}]);t.root="root_af89891e";t.group="group_af89891e";t.item="item_af89891e"});
define("@ms/items-view/lib/private/controls/progressListControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.progressListGroupControl=new n.ControlFacet("progressListGroupControl",{});t.progressListControl=new n.ControlFacet("progressListControl",{groupControlHandler:n.childControlOption(t.progressListGroupControl)})});
define("@ms/items-view/lib/private/components/itemsContextMenu/ItemsContextMenu",["require","exports","../decorators/selectors","../decorators/connectToItemCache","./ActionContextMenu","../../controls/itemsContextMenuControl","../commands/new/newCommand","../commands/open/openCommand","../commands/upload/uploadCommand","../commands/share/shareCommand","../commands/download/downloadCommand","../commands/rename/renameCommand","../commands/delete/deleteCommand","../telemetry/TelemetryProvider","../../utilities/components/Props","../../models/itemsScope/getCurrentItemKey","../commands/follow/followCommand"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=[o.newCommand,u.openCommand,a.uploadCommand,f.shareCommand,f.copyLinkCommand,m.followCommand,l.downloadCommand,h.deleteCommand,c.renameCommand],y=p.createTelemetryProvider({withContext:{component:"ContextMenu"}});t.ItemsContextMenu=d.wrapWithParent(y)(r.connectToItemCache(function(e,t){var r=v.getCurrentItemKey(e),i=n.getCurrentItemSetKey(e),o=t.commands,u=void 0===o?[]:o,a=e.demandItemFacet(s.itemsContextMenuControl,r),f=s.itemsContextMenuControl.evaluate(a)(e,{itemKey:r||"",itemSetKey:i,commands:g}),l=f.commands,c=f.onMenuOpened;return{commands:l.concat(u),onMenuOpened:c}})(i.ActionContextMenu));t.ItemsContextMenu.displayName="ItemsContextMenu"});
define("@ms/items-view/lib/private/components/itemsContextMenu/ActionContextMenu",["require","exports","tslib","react","office-ui-fabric-react/lib/ContextualMenu","../commandSet/CommandSet","./ActionContextMenu.resx","../../utilities/arrays"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=[];t.ActionContextMenu=s.connectToCommandSets(function(e){return{main:e.commands}},function(e,t){var n=t.items,r=void 0===n?a:n,s=t.directionalHint,o=void 0===s?i.DirectionalHint.rightTopEdge:s,l=t.isBeakVisible,c=void 0!==l&&l,h=t.onMenuOpened;return{items:u.concat(r,f(e.main,t)),directionalHint:o,isBeakVisible:c,onMenuOpened:h}})(function(e){var t=e.isOpen,s=n.__rest(e,["isOpen"]);return t?r.createElement(i.ContextualMenu,n.__assign({},s)):null});function f(e,t){var r=t.target;return e.map(function(e){var i=e.subMenuProps,s=e.onClick,u=e.hasLaunchTarget,a=n.__rest(e,["subMenuProps","onClick","hasLaunchTarget"]);return n.__assign({},a,{name:e.iconProps&&"More"===e.iconProps.iconName?o.default.More:e.name,icon:void 0,iconProps:void 0,subMenuProps:i?n.__assign({},i,{items:f(i.items,t)}):void 0,onClick:u&&s?function(e){e&&r&&(r instanceof Event?e.target=r.target:r instanceof Element&&(e.target=r));s(e)}:s})})}});
define("@ms/items-view/lib/private/components/commands/new/newCommand",["require","exports","../../../models/Facet","../createFolder/createFolderCommand","office-ui-fabric-react/lib/ContextualMenu","../Commands.resx","../createDocument/createDocumentCommand"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.newCommand={key:new n.Facet("newCommand").id,automationId:"newCommand",name:s.default.Create,title:s.default.CreateCommandAriaLabel,iconProps:{iconName:"CalculatorAddition"},subMenuProps:{items:[r.createFolderCommand,{name:"-",key:"divider_1",itemType:i.ContextualMenuItemType.Divider},o.createWordCommand,o.createExcelCommand,o.createPowerPointCommand,o.createOneNoteCommand,o.createExcelSurveyCommand,o.createFormForExcelCommand,o.createVisioCommand,o.createBohemiaCommand,o.createPragueCommand]}}});
define("@ms/items-view/lib/private/components/commands/createFolder/createFolderCommand",["require","exports","react","../../../models/Facet","../../actions/createFolder/CreateFolderAction","../getCommandIconProps","../../scope/commands/commands.resx","../../selectionVisibility/SelectionVisibility"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createFolderCommand={key:new r.Facet("createFolder").id,automationId:"createFolderCommand",name:o.default.CreateFolder,action:n.createElement(u.HideWithSelection,null,n.createElement(i.CreateFolderAction,null)),iconProps:s.getCommandIconProps({size:16,type:2})}});
define("@ms/items-view/lib/private/components/actions/createFolder/CreateFolderAction",["require","exports","tslib","../../base/actions/createFolder/CreateFolderAction","../../decorators/connectToItemCache","../../../utilities/components/Async"],function(e,t,n,r,i,s){"use strict";var o=this;Object.defineProperty(t,"__esModule",{value:!0});var u=s.asAsync(function(){return n.__awaiter(o,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./CreateFolderWizard"],t,n)})];case 1:return[2,t.sent().CreateFolderWizard]}})})});t.ItemCreateFolderAction=i.connectToItemCache(function(){return{createFolderWizard:u}})(r.ItemCreateFolderAction);t.CreateFolderAction=i.connectToItemCache(function(){return{createFolderWizard:u}})(r.CreateFolderAction)});
define("@ms/items-view/lib/private/components/base/actions/createFolder/CreateFolderAction",["require","exports","tslib","react","../../../../operations/createFolder","../../../decorators/selectors","../../../../controls/createFolderActionControl","../../../../facets/ItemFacets","../../../../models/telemetry/getItemEngagement","../../../decorators/connectToItemCache","../../../withAction/WithAction","../../../action/Action"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";var h=this;Object.defineProperty(t,"__esModule",{value:!0});t.ItemCreateFolderAction=f.connectToItemCache(function(e,t){var s=t.itemKey,f=t.createFolderWizard;if(!s)return{action:null};var p,d=!0,v=e.demandItemFacet(u.folderFacet,s),m=e.demandItemFacet(o.createFolderActionControl,s),g=o.createFolderActionControl.evaluate(m)(e,{itemKey:s,isAvailable:!1,createFolderWizard:f}),y=g.isAvailable,b=g.createFolderWizard,w=g.validator,E=g.maxLength,S=g.title;y||(d=!1);p=b;var x=e.dispatch,T=function(e){var t=e.name;return n.__awaiter(h,void 0,void 0,function(){var e,r;return n.__generator(this,function(n){switch(n.label){case 0:return[4,x(i.createFolder({items:(e={},e[s]={folders:(r={},r[t]={},r)},e)}))];case 1:n.sent();return[2]}})})},N=l.renderComponentOnExecute(function(e){return r.createElement(p,n.__assign({},e,{isAvailable:d&&!!v,itemKey:s,maxLength:E,onCreateFolder:T,title:S,validator:w}))});return{action:r.createElement(c.Action,n.__assign({isAvailable:d,onExecute:N},a.getItemActionEngagement(e,{itemKey:s,engagement:{name:"CreateFolder",isIntentional:!0}})))}})(l.ActionSelector);t.CreateFolderAction=s.withOnlyCurrentItem()(t.ItemCreateFolderAction)});
define("@ms/items-view/lib/private/components/commands/getCommandIconProps",["require","exports","tslib","@uifabric/file-type-icons/lib/index","./Commands.scss"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getCommandIconProps=function(e){return n.__assign({},r.getFileTypeIconProps(e),{className:i.newDocumentCommandIcon})}});
define("@ms/items-view/lib/private/components/commands/Commands.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".newDocumentCommandIcon_c7fb06c9{height:16px;width:16px}.newDocumentCommandIcon_c7fb06c9 img{line-height:normal;display:block}#obf-TPromptContainer:focus{outline:1px solid #605e5c}#obf-TFormRating{color:#333333}#obf-TFormComment{background-color:#fff}\n"}]);t.newDocumentCommandIcon="newDocumentCommandIcon_c7fb06c9"});
define("@ms/items-view/lib/private/components/commands/createDocument/createDocumentCommand",["require","exports","react","../../scope/commands/commands.resx","../../../models/Facet","../../../operations/createDocument/DocumentType","../../actions/createDocument/CreateDocumentAction","../getCommandIconProps","../../selectionVisibility/SelectionVisibility"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createWordCommand={key:new i.Facet("createWord").id,automationId:"createWordCommand",name:r.default.CreateWord,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.Word})),iconProps:u.getCommandIconProps({extension:"docx",size:16})};t.createExcelCommand={key:new i.Facet("createExcel").id,automationId:"createExcelCommand",name:r.default.CreateExcel,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.Excel})),iconProps:u.getCommandIconProps({extension:"xlsx",size:16})};t.createPowerPointCommand={key:new i.Facet("createPowerPoint").id,automationId:"createPowerPointCommand",name:r.default.CreatePowerPoint,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.PowerPoint})),iconProps:u.getCommandIconProps({extension:"pptx",size:16})};t.createOneNoteCommand={key:new i.Facet("createOneNote").id,automationId:"createOneNoteCommand",name:r.default.CreateOneNote,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.OneNote})),iconProps:u.getCommandIconProps({extension:"onetoc",size:16})};t.createExcelSurveyCommand={key:new i.Facet("createExcelSurvey").id,automationId:"createExcelSurveyCommand",name:r.default.CreateExcelSurvey,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.ExcelSurvey})),iconProps:u.getCommandIconProps({extension:"xlsx",size:16})};t.createFormForExcelCommand={key:new i.Facet("createFormForExcel").id,automationId:"createFormForExcelCommand",name:r.default.CreateFormForExcel,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.ExcelForm})),iconProps:u.getCommandIconProps({extension:"xlsx",size:16})};t.createVisioCommand={key:new i.Facet("createVisio").id,automationId:"createVisioCommand",name:r.default.CreateVisio,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.Visio})),iconProps:u.getCommandIconProps({extension:"vsdx",size:16})};t.createBohemiaCommand={key:new i.Facet("createBohemia").id,automationId:"createBohemiaCommand",name:r.default.CreateBohemia,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.Bohemia})),iconProps:u.getCommandIconProps({extension:"b",size:16})};t.createPragueCommand={key:new i.Facet("createPrague").id,automationId:"createPragueCommand",name:r.default.CreatePrague,action:n.createElement(a.HideWithSelection,null,n.createElement(o.CreateDocumentAction,{documentType:s.DocumentType.Prague})),iconProps:u.getCommandIconProps({extension:"p",size:16})}});
define("@ms/items-view/lib/private/components/actions/createDocument/CreateDocumentAction",["require","exports","tslib","../../../operations/createDocument/DocumentType","../../../facets/ItemFacets","../../../controls/createDocumentActionControl","../../decorators/withWizard","./DocumentCreator","../../decorators/selectors","../../decorators/connectToItemCache","../../../models/telemetry/getItemEngagement"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=o.withWizard()(u.DocumentCreator);t.CreateDocumentAction=a.withOnlyCurrentItem()(f.connectToItemCache(function(e,t){var o=t.itemKey,u=t.documentType,a=o&&e.demandItemFacet(i.folderFacet,o),f=e.demandItemFacet(s.createDocumentActionControl,o),c=u===r.DocumentType.OneNote||u===r.DocumentType.ExcelSurvey||u===r.DocumentType.ExcelForm,h=s.createDocumentActionControl.evaluate(f)(e,{itemKey:o,documentType:u,isAvailable:!1,openWindow:function(e){return window.open(e.url||"","_blank")}}),p=h.isAvailable,d=h.askForFileName,v=h.validator,m=h.openWindow;return n.__assign({isAvailable:p&&!!a},l.getItemActionEngagement(e,{itemKey:o,engagement:{name:"CreateDocument",isIntentional:!0,extraData:{documentType:r.DocumentType[u]}}}),{askForFileName:c||d,validator:v,openWindow:m})})(c))});
define("@ms/items-view/lib/private/components/actions/createDocument/DocumentCreator",["require","exports","tslib","react","./DocumentCreatorHelper","../../scope/actions/createDocument/DocumentCreator.resx","../../../models/AutoKeyFacet","../../decorators/asAutoAction","../defaultClick/DefaultClickAction","../../nameDialog/NameDialog","../../../utilities/async/CancelError","../../../operations/createDocument","../../../controls/targetWindowControl","../../decorators/withControlHandler"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=new o.AutoKeyFacet("newDocument");var v=u.asAutoAction()(a.ItemDefaultClickAction),m=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.targetWindow=null;n._targetWindowControlHandler=function(e,t){var r=n.targetWindow;return!t.targetWindow&&r?{targetWindow:r}:{}};n._onItemOpened=function(){n.setState({isItemOpened:!0});n.props.resolve()};n._onContinue=function(e){return n._createDocument(e.name).then(function(){n.setState({showDialog:!1})})};n._onCancel=function(){n.props.reject(new l.CancelError)};n._createDocument=function(e){n.targetWindow=n.props.openWindow({});return g(n.state,n.props,e,n.targetWindow)};n.state={newDocumentKey:d.serializeNext(),showDialog:t.askForFileName};return n}t.prototype.componentDidMount=function(){this.state.showDialog||this._createDocument(void 0)};t.prototype.render=function(){var e=this.props,t=e.documentType,n=e.validator,o=this.state,u=o.showDialog,a=o.isItemOpened;return u?r.createElement(f.NameDialog,{title:i.getDialogTitle(t,s.default)||"",name:"",placeHolder:s.default.NewNamePlaceholder,fileExtensionText:i.getDocExtension(t),onContinue:this._onContinue,onCancel:this._onCancel,continueText:s.default.CreateCommit,validator:n}):a?null:r.createElement(p.ControlHandlerProvider,{controlHandlers:h.targetWindowControl.pack(this._targetWindowControlHandler)},r.createElement(v,{onComplete:this._onItemOpened,itemKey:this.state.newDocumentKey}))};return t}(r.Component);t.DocumentCreator=m;function g(e,t,n,r){var i,s=t.itemCacheDispatch,o=t.itemKey,u=t.documentType,a=t.askForFileName,f=t.templateItemKey,l=e.newDocumentKey;return!a||a&&n?s(c.createDocument({items:(i={},i[o]={documentType:u,newDocumentKey:l,targetWindow:r,fileName:n,templateItemKey:f},i)})):Promise.resolve()}t.createDocumentExecutor=g});
define("@ms/items-view/lib/private/components/decorators/asAutoAction",["require","exports","tslib","react","../withAction/WithAction","../../utilities/async/wait","../../utilities/async/TimeoutError"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onTimeout=n._onTimeout.bind(n);n.state={};return n}t.prototype.render=function(){return null};t.prototype.componentDidMount=function(){var e=this.props.timeout;this._mayExecute(this.props,this.state)?this._execute():"number"==typeof e&&(this._timeoutId=setTimeout(this._onTimeout,e))};t.prototype.componentDidUpdate=function(e,t){var n=this._mayExecute(e,t),r=this._mayExecute(this.props,this.state);if(!n&&r){if("number"==typeof this._timeoutId){clearTimeout(this._timeoutId);this._timeoutId=void 0}this._execute()}};t.prototype.componentWillUnmount=function(){this._isDisposed=!0};t.prototype._mayExecute=function(e,t){return!t.isTimedOut&&!t.isExecuting&&e.isAvailable&&0===e.executingCount};t.prototype._onTimeout=function(){var e=this.props,t=e.onError,n=e.timeout,r=void 0===n?0:n;this.setState({isTimedOut:!0});t&&t(new o.TimeoutError({timeout:r}))};t.prototype._execute=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t,r,i,o,u,a,f,l;return n.__generator(this,function(n){switch(n.label){case 0:e=this.props,t=e.execute,r=e.onStart,i=e.onComplete,o=e.onError,u=e.rateLimit,a=void 0===u?0:u,f=e.onExecuteProps;n.label=1;case 1:n.trys.push([1,3,4,6]);this.setState({isExecuting:!0});r&&r();return[4,t(f)];case 2:n.sent();i&&i();return[3,6];case 3:l=n.sent();o&&o(l);return[3,6];case 4:return[4,s.wait(a)];case 5:n.sent();this._isDisposed||this.setState({isExecuting:void 0});return[7];case 6:return[2]}})})};return t}(r.PureComponent);t.AutoActionExecutor=u;t.asAutoAction=function(e){void 0===e&&(e={});return function(t){var s=t;return function(t){n.__extends(o,t);function o(){return null!==t&&t.apply(this,arguments)||this}o.prototype.render=function(){var t=this.props,o=t.onStart,a=t.onComplete,f=t.onError,l=t.onExecuteProps,c=n.__rest(t,["onStart","onComplete","onError","onExecuteProps"]);return r.createElement(i.WithAction,{action:r.createElement(s,n.__assign({},c))},function(t){return r.createElement(u,n.__assign({},t,e,{onExecuteProps:l,onComplete:a,onError:f,onStart:o}))})};return o}(r.PureComponent)}}});
define("@ms/items-view/lib/private/components/nameDialog/NameDialog",["require","exports","tslib","react","office-ui-fabric-react/lib/Spinner","office-ui-fabric-react/lib/Dialog","office-ui-fabric-react/lib/TextField","office-ui-fabric-react/lib/Button","./NameDialog.scss","./NameDialog.resx"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r._onNameRef=function(e){if(e){e.focus();e.select()}};r._onNameChanged=function(e,t){void 0===t&&(t="");var n=r.props.validator;r.setState({name:t,errorMessage:n?n(t):void 0})};r._onClickAction=function(){return n.__awaiter(r,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:this.setState({showSpinner:!0});n.label=1;case 1:n.trys.push([1,3,4,5]);return[4,this.props.onContinue({name:this.state.name})];case 2:n.sent();return[3,5];case 3:e=n.sent();t=e;this._isDisposed||this.setState({errorMessage:t&&t.message});return[3,5];case 4:this._isDisposed||this.setState({showSpinner:!1});return[7];case 5:return[2]}})})};r._onKeyPress=function(e){13===e.which&&r._onClickAction()};r.state={name:r.props.name};return r}t.prototype.render=function(){var e=this.state,t=e.name,n=e.errorMessage,l=e.showSpinner,c=this.props,h=c.nameFieldAriaLabel,p=c.continueText,d=void 0===p?f.default.continue:p,v=c.cancelText,m=c.onCancel,g=c.placeHolder,y=c.maxLength,b=c.fileExtensionText,w=c.isMultiline,E=c.cols;return r.createElement(s.Dialog,{isOpen:!0,title:this.props.title,onDismiss:m},r.createElement("div",{className:a.nameDialogContent},r.createElement(o.TextField,{ariaLabel:h,componentRef:this._onNameRef,value:t,onChange:this._onNameChanged,errorMessage:n,placeholder:g,maxLength:y,onKeyPress:this._onKeyPress,multiline:w,cols:E}),b&&r.createElement("span",{className:a.nameDialogContentFileExtension},b)),r.createElement(s.DialogFooter,null,r.createElement(u.PrimaryButton,{disabled:!t||!!n||l,onClick:this._onClickAction},d),v&&r.createElement(u.DefaultButton,{onClick:m},v),l&&r.createElement(i.Spinner,{size:i.SpinnerSize.medium,className:a.nameDialogSpinner})))};t.prototype.componentWillUnmount=function(){this._isDisposed=!0};return t}(r.PureComponent);t.NameDialog=function(e){return r.createElement(l,n.__assign({},e))}});
define("@ms/items-view/lib/private/components/nameDialog/NameDialog.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".nameDialogContent_8c95f271{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.nameDialogContent_8c95f271 .ms-TextField{width:100%}.nameDialogContentFileExtension_8c95f271{padding:5px}.nameDialogSpinner_8c95f271{display:inline-block;padding-bottom:7px;vertical-align:bottom}\n"}]);t.nameDialogContent="nameDialogContent_8c95f271";t.nameDialogContentFileExtension="nameDialogContentFileExtension_8c95f271";t.nameDialogSpinner="nameDialogSpinner_8c95f271"});
define("@ms/items-view/lib/private/operations/createDocument",["require","exports","../models/Facet","../store/actions/implementOperation"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createDocumentOperation=new n.Facet("createDocument");t.createDocument=r.implementOperation({operationTypeFacet:t.createDocumentOperation});t.createCustomDocumentOperation=new n.Facet("createCustomDocument");t.createCustomDocument=r.implementOperation({operationTypeFacet:t.createCustomDocumentOperation})});
define("@ms/items-view/lib/private/components/commands/upload/uploadCommand",["require","exports","../../../models/Facet","./uploadFileCommand","./uploadFolderCommand","../Commands.resx","@ms/utilities-browser/lib/PlatformDetection"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=new o.PlatformDetection;t.uploadCommand={key:new n.Facet("upload").id,automationId:"uploadCommand",name:s.default.Upload,title:s.default.UploadCommandTooltip,iconProps:{iconName:"upload"},action:u.isFolderUploadSupported?void 0:r.uploadFileCommand.action,subMenuProps:u.isFolderUploadSupported?{items:[r.uploadFileCommand,i.uploadFolderCommand]}:void 0}});
define("@ms/items-view/lib/private/components/commands/upload/uploadFileCommand",["require","exports","react","../../../models/Facet","../Commands.resx","../../selectionVisibility/SelectionVisibility","../../actions/upload/UploadFileAction"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadFileCommand={key:new r.Facet("uploadFile").id,automationId:"uploadFileCommand",name:i.default.UploadFile,action:n.createElement(s.HideWithSelection,null,n.createElement(o.UploadFileAction,null))}});
define("@ms/items-view/lib/private/components/actions/upload/UploadFileAction",["require","exports","tslib","react","./UploadAction","../../fileSystemDialog/FileSystemDialog","@ms/utilities-browser/lib/PlatformDetection","../../action/Action","../../decorators/connectToItemCache"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=new o.PlatformDetection,l=a.connectToItemCache(function(){return{type:"file"}})(s.FileSystemDialog),c=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(u.ActionBase,{})};return t}(r.PureComponent);t.UploadFileAction=f.isHtml5FileUploadSupported?a.connectToItemCache(function(){return{fileSelector:l}})(i.UploadAction):c});
define("@ms/items-view/lib/private/components/fileSystemDialog/FileSystemDialog",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","../../utilities/fileSystem/FileEntries","./FileSystemDialog.scss"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u={inputElement:null,files:void 0,hasNothingHappened:!1},a=function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r._onInputRef=function(e){r.setState({inputElement:e})};r._onInputChange=function(e){var t=e.target.files,n=[];if(t)for(var i=0,s=t.length;i<s;i++)n.push(t[i]);r.setState({files:n})};r._onNothingHappened=function(){r.setState(function(e){return n.__assign({},e,{hasNothingHappened:!e.files})})};r.state=u;r._events=new i.EventGroup(r);r._async=new i.Async(r);return r}t.prototype.render=function(){return r.createElement("input",{className:o.input,"data-automationid":"directory"===this.props.type?"commandFolderInput":"commandFileInput",type:"file",ref:this._onInputRef,multiple:!0,onChange:this._onInputChange})};t.prototype.componentDidMount=function(){this._onStateChanged(u)};t.prototype.componentDidUpdate=function(e,t){this._onStateChanged(t)};t.prototype.componentWillUnmount=function(){this._events.dispose();this._async.dispose()};t.prototype._onStateChanged=function(e){var t=this.state,n=t.files,r=t.inputElement,i=t.hasNothingHappened,o=this.props,u=o.onContinue,a=o.onCancel;if(!e.files&&n){u(s.buildEntriesFromFileList(n))}else if(!e.hasNothingHappened&&i)a();else if(!e.inputElement&&r){"directory"===this.props.type&&(r.webkitdirectory=!0);this._async.setTimeout(this._onNothingHappened,36e5);r.click()}};return t}(r.PureComponent);t.FileSystemDialog=a});
define("@ms/items-view/lib/private/components/fileSystemDialog/FileSystemDialog.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".input_1c74c4c0{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);t.input="input_1c74c4c0"});
define("@ms/items-view/lib/private/components/commands/upload/uploadFolderCommand",["require","exports","react","../../../models/Facet","../Commands.resx","../../selectionVisibility/SelectionVisibility","../../actions/upload/UploadFolderAction"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadFolderCommand={key:new r.Facet("uploadFolder").id,automationId:"uploadFolderCommand",name:i.default.UploadFolder,action:n.createElement(s.HideWithSelection,null,n.createElement(o.UploadFolderAction,null))}});
define("@ms/items-view/lib/private/components/actions/upload/UploadFolderAction",["require","exports","tslib","react","./UploadAction","../../fileSystemDialog/FileSystemDialog","@ms/utilities-browser/lib/PlatformDetection","../../action/Action","../../decorators/connectToItemCache"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(u.ActionBase,{})};return t}(r.PureComponent),l=new o.PlatformDetection,c=a.connectToItemCache(function(){return{type:"directory"}})(s.FileSystemDialog);t.UploadFolderAction=l.isFolderUploadSupported?a.connectToItemCache(function(){return{fileSelector:c}})(i.UploadAction):f});
define("@ms/items-view/lib/private/components/commands/download/downloadCommand",["require","exports","tslib","react","../../../models/Facet","../../actions/download/DownloadAction","../Commands.resx","../../actions/showMalwareDetected/ShowMalwareDetectedAction","../../../facets/CommandFacets"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.downloadCommand={key:new i.Facet("download").id,automationId:"downloadCommand",name:o.default.Download,action:r.createElement(u.ShowMalwareDetectedAction,{action:r.createElement(s.DownloadAction,null)}),iconProps:{iconName:"download"},facets:n.__assign({},a.isReadonlyFacet.pack(!0))}});
define("@ms/items-view/lib/private/components/actions/showMalwareDetected/ShowMalwareDetectedAction",["require","exports","tslib","../../base/actions/showMalwareDetected/ShowMalwareDetectedAction","../../decorators/connectToItemCache","../../../utilities/components/Async"],function(e,t,n,r,i,s){"use strict";var o=this;Object.defineProperty(t,"__esModule",{value:!0});var u=s.asAsync(function(){return n.__awaiter(o,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../../DeferredComponents"],t,n)})];case 1:return[2,t.sent().MalwareDetectedDialog]}})})});function a(){return{malwareDetectedWizard:u}}t.ItemShowMalwareDetectedAction=i.connectToItemCache(a)(r.ItemShowMalwareDetectedAction);t.ShowMalwareDetectedAction=i.connectToItemCache(a)(r.ShowMalwareDetectedAction)});
define("@ms/items-view/lib/private/components/base/actions/showMalwareDetected/ShowMalwareDetectedAction",["require","exports","tslib","react","../../../decorators/selectors","../../../../controls/malwareDetectedControl","../../../../facets/ItemFacets","../../../withAction/WithAction","../../../../models/telemetry/getItemEngagement","../../../decorators/connectToItemCache","../../../action/Action"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemShowMalwareDetectedAction=f.connectToItemCache(function(e,t){var i=t.itemKey,f=t.malwareDetectedWizard,c=t.action;if(e.demandItemFacet(o.malwareDetectedFacet,i)){var h=e.demandItemFacet(s.malwareDetectedControl,i),p=s.malwareDetectedControl.evaluate(h)(e,{itemKey:i,malwareDetectedWizard:f}).malwareDetectedWizard,d=u.renderComponentOnExecute(function(e){return r.createElement(p,n.__assign({},e,{itemKey:i}))});return{action:u.evaluateAction(e,r.createElement(l.Action,n.__assign({onExecute:d},a.getItemActionEngagement(e,{itemKey:i,engagement:{name:"MalwareDetected",isIntentional:!0}}))))}}return{action:u.evaluateAction(e,c)}})(u.ActionSelector);t.ShowMalwareDetectedAction=i.withSelectedItems()(i.withExactlyOneItem()(t.ItemShowMalwareDetectedAction))});
define("@ms/items-view/lib/private/controls/malwareDetectedControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.malwareDetectedControl=new n.ControlFacet("malwareDetectedControl")});
define("@ms/items-view/lib/private/components/commands/rename/renameCommand",["require","exports","../../../models/Facet","react","../../actions/rename/RenameAction","../Commands.resx","../../selectionVisibility/SelectionVisibility","../../keyboard/KeyboardMap.resx"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.renameCommand={key:new n.Facet("rename").id,automationId:"renameCommand",name:s.default.Rename,action:r.createElement(o.ShowOnlyWithSelection,null,r.createElement(i.RenameAction,null)),iconProps:{iconName:"rename"},shortcutProps:{content:u.default.renameDesc,keySequences:["F2"]}}});
define("@ms/items-view/lib/private/components/actions/rename/RenameAction",["require","exports","tslib","react","../../base/actions/rename/RenameAction","../../scope/actions/strings.resx","../../../utilities/components/Props","./RenameDialog","../../../utilities/async/CancelError","../../../operations/renameItem","../../../operations/progress","../../../operations/renameItem/RenameProgressAddon"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,i=t.resolve,o=t.reject,f=t.onRename,l=t.lockedWarningMessage,c=t.title,h=t.validator,p=t.fileExtensionText,d=t.oldName,v=c||s.default.Rename;return r.createElement(u.RenameDialog,{onContinue:function(t){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:i();return f?[4,f(t)]:[3,2];case 1:e.sent();e.label=2;case 2:return[2]}})})},onCancel:function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){o(new a.CancelError);return[2]})})},title:v,continueText:s.default.RenameCommit,name:d,validator:h,fileExtensionText:p,lockedWarningMessage:l,warningDialogCancelText:s.default.cancelActionText,cancelText:s.default.cancelActionText})};return t}(r.PureComponent),p=l.implementOperationWithProgress({operationTypeFacet:f.renameItemOperation,progressKeyFacet:f.renameProgressKeyFacet,initializeBatch:function(){return c.renameProgressAddon}});function d(){return{renameWizard:h,renameItem:p}}t.ItemRenameAction=o.injectInitialProps(d)(i.ItemRenameAction);t.RenameAction=o.injectInitialProps(d)(i.RenameAction)});
define("@ms/items-view/lib/private/components/base/actions/rename/RenameAction",["require","exports","tslib","react","../../../../operations/renameItem","../../../decorators/selectors","../../../../controls/renameActionControl","../../../../facets/ItemFacets","../../../../models/telemetry/getItemEngagement","../../../decorators/connectToItemCache","../../../withAction/WithAction","../../../action/Action"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";var h=this;Object.defineProperty(t,"__esModule",{value:!0});t.ItemRenameAction=f.connectToItemCache(function(e,t){var s=t.itemKey,f=t.renameWizard,p=t.renameItem,d=void 0===p?i.renameItem:p;if(!s)return{action:null};var v,m=!e.demandItemFacet(u.malwareDetectedFacet,s),g=e.demandItemFacet(u.fileNameFacet,s),y=g&&g.name||"",b=e.demandItemFacet(o.renameActionControl,s),w=o.renameActionControl.evaluate(b)(e,{itemKey:s,isAvailable:!1,renameWizard:f}),E=w.isAvailable,S=w.renameWizard,x=w.validator,T=w.lockedWarningMessage,N=w.title;E||(m=!1);v=S;var C=e.dispatch,k=function(e){var t=e.name;return n.__awaiter(h,void 0,void 0,function(){var e,r;return n.__generator(this,function(n){switch(n.label){case 0:return[4,C(d({items:(e={},e[s]={names:(r={},r[y]={newName:t},r)},e)}))];case 1:n.sent();return[2]}})})},L=l.renderComponentOnExecute(function(e){return r.createElement(v,n.__assign({},e,{isAvailable:m&&!!s&&!!g,itemKey:s,onRename:k,oldName:y,lockedWarningMessage:T,fileExtensionText:g&&g.extension,title:N,validator:x}))});return{action:r.createElement(c.Action,n.__assign({isAvailable:m,onExecute:L},a.getItemActionEngagement(e,{itemKey:s,engagement:{name:"Rename",isIntentional:!0}})))}})(l.ActionSelector);t.RenameAction=s.withSelectedItems()(s.withExactlyOneItem()(t.ItemRenameAction))});
define("@ms/items-view/lib/private/components/actions/rename/RenameDialog",["require","exports","tslib","react","../../nameDialog/NameDialog","../../warningDialog/WarningDialog","../../keyboard/KeyboardZone"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RenameDialog=function(e){var t=e.lockedWarningMessage,u=e.warningDialogCancelText,a=e.onCancel,f=e.title;return t?r.createElement(s.WarningDialog,{cancelText:u,title:f,prompt:t,onCancel:a}):r.createElement(o.KeyboardZone,null,r.createElement(i.NameDialog,n.__assign({},e)))}});
define("@ms/items-view/lib/private/components/warningDialog/WarningDialog",["require","exports","react","office-ui-fabric-react/lib/Dialog","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Label"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WarningDialog=function(e){var t=e.title,o=e.prompt,u=e.cancelText,a=e.onCancel;return n.createElement(r.Dialog,{onDismiss:a,isOpen:!0,title:t,maxWidth:e.maxWidth},n.createElement(s.Label,null,o),n.createElement(r.DialogFooter,null,n.createElement(i.PrimaryButton,{onClick:a,componentRef:function(e){e&&e.focus()}},u)))}});
define("@ms/items-view/lib/private/components/keyboard/KeyboardZone",["require","exports","tslib","react","./KeyboardContext","@uifabric/utilities/lib/dom"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onFocusCapture=function(){var e=document.activeElement;e&&(n._div===e||s.elementContains(n._div,e))&&n._keyboardManager.setIsActive(!0)};n._keyboardManager=new i.KeyboardManager({isDefault:!1});n._keyboardManager&&n._keyboardManager.setIsActive(!0);n._parentContext=void 0;n._registerAsChild=!1;return n}t.prototype.componentWillUnmount=function(){if(this._keyboardManager){this._keyboardManager.setIsActive(!1);this._keyboardManager.dispose()}this._parentContext&&this._parentContext.registerActiveChild(!1)};t.prototype.render=function(){var e=this;return r.createElement(i.KEYBOARD_CONTEXT.Consumer,null,function(t){var n=t.keyboardManager;if(!e._registerAsChild){n.registerActiveChild(!0);e._registerAsChild=!0;e._parentContext=n}return r.createElement("div",{ref:function(t){return e._div=t},onFocusCapture:e._onFocusCapture},r.createElement(i.KEYBOARD_CONTEXT.Provider,{value:{keyboardManager:e._keyboardManager}},e.props.children))})};return t}(r.PureComponent);t.KeyboardZone=o});
define("@ms/items-view/lib/private/operations/renameItem/RenameProgressAddon",["require","exports","tslib","../../addons/registerOperationHandler","../../addons/registerControlHandler","../../controls/progressControl","@ms/utilities-strings/lib/index","../progress","./RenameStrings.resx","../../facets/ProgressFacets","../renameItem"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c,h=((c={})[f.ProgressPhase.started]=function(e){return o.format(o.getLocalizedCountValue(a.default.renameStartedItemsTitle,a.default.renameCompletedItemsTitleIntervals,e)||"",e)},c[f.ProgressPhase.completed]=function(e){return o.format(o.getLocalizedCountValue(a.default.renameCompletedItemsTitle,a.default.renameCompletedItemsTitleIntervals,e)||"",e)},c[f.ProgressPhase.failed]=function(e){return o.format(o.getLocalizedCountValue(a.default.renameFailedItemsTitle,a.default.renameFailedItemsTitleIntervals,e)||"",e)},c[f.ProgressPhase.canceled]=function(e){return o.format(o.getLocalizedCountValue(a.default.renameFailedItemsTitle,a.default.renameFailedItemsTitleIntervals,e)||"",e)},c);t.renameProgressAddon=r.createAddon(function(){return function(e){e(i.registerControlHandler(l.renameProgressKeyFacet,s.progressControl)(i.createControlHandler()(p)))}});function p(){return function(e){return d}}function d(e,t){var r=u.getOverallSimpleProgressBreakdown(e,t),i=r.phase,s=r.count,o=h[i](s);return n.__assign({},o?{title:o}:{})}});
define("@ms/items-view/lib/private/components/commands/delete/deleteCommand",["require","exports","react","../../../models/Facet","../../actions/delete/DeleteAction","../Commands.resx","../../selectionVisibility/SelectionVisibility","../../keyboard/KeyboardMap.resx"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.deleteCommand={key:new r.Facet("delete").id,automationId:"deleteCommand",name:s.default.DeleteItem,action:n.createElement(o.ShowOnlyWithSelection,null,n.createElement(i.DeleteAction,null)),iconProps:{iconName:"delete"},shortcutProps:{keySequences:["Delete"],content:u.default.deleteDesc}}});
define("@ms/items-view/lib/private/components/actions/delete/DeleteAction",["require","exports","tslib","react","../../../utilities/components/Props","../../base/actions/delete/DeleteAction","../../../utilities/async/CancelError","../../confirmationDialog/ConfirmationDialog","../../scope/actions/strings.resx","../../../operations/deleteItems/DeleteStrings.resx","../../withItemCache/WithItemCache","../../../facets/ItemFacets","../../warningDialog/WarningDialog","../../../models/items/ItemStrings.resx","../../../operations/deleteItems","../../../operations/progress","../../../operations/deleteItems/DeleteProgressAddon","../../../facets/ConfigurationFacets","../../../models/configuration/getConfiguration"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var b=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,i=t.resolve,s=t.reject,d=t.onDelete,v=t.defaultToDelete,m=void 0!==v&&v,b=t.itemKeys,w=function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:i();return[4,d()];case 1:e.sent();return[2]}})})},E=function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){s(new o.CancelError);return[2]})})};return r.createElement(l.WithItemCache,null,function(e){var t=e.itemCache,n=y.getConfiguration(t,{enableDeleteCancelConfirmationStrings:g.enableDeleteCancelConfirmationStringsConfigurationFacet}).enableDeleteCancelConfirmationStrings;return 1===b.length&&b.some(function(e){var n=t.demandItemFacet(c.isCheckedOutFacet,e);return!!(n&&n.byOther)})?r.createElement(h.WarningDialog,{onCancel:E,cancelText:a.default.cancelActionText,title:p.default.checkedOutOrLockedWarningTitle,prompt:p.default.checkedOutOrLockedWarning}):r.createElement(u.ConfirmationDialog,{onCancel:E,onConfirm:w,yesText:n?f.default.deleteConfirmButtonText:void 0,noText:n?f.default.deleteCancelButtonText:void 0,defaultToYes:m,title:a.default.deleteConfirmTitle,prompt:a.default.deleteConfirmText})})};return t}(r.PureComponent),w=v.implementOperationWithProgress({operationTypeFacet:d.deleteItemsOperation,progressKeyFacet:d.deleteProgressKeyFacet,initializeBatch:function(){return m.deleteProgressAddon}});function E(){return{deleteWizard:b,deleteItems:w}}t.ItemDeleteAction=i.injectInitialProps(E)(s.ItemDeleteAction);t.DeleteAction=i.injectInitialProps(E)(s.DeleteAction)});
define("@ms/items-view/lib/private/components/base/actions/delete/DeleteAction",["require","exports","tslib","react","../../../../operations/deleteItems","../../../../utilities/objects","../../../decorators/selectors","../../../../controls/deleteActionControl","../../../../models/telemetry/getItemEngagement","../../../decorators/connectToItemCache","../../../withAction/WithAction","../../../action/Action"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";var h=this;Object.defineProperty(t,"__esModule",{value:!0});t.ItemDeleteAction=f.connectToItemCache(function(e,t){var o=t.itemKeys,f=t.deleteWizard,p=t.deleteItems,d=void 0===p?i.deleteItems:p;if(0===o.length)return{action:null};for(var v=o.length>0,m=!0,g=f,y=0,b=o;y<b.length;y++){var w=b[y],E=e.demandItemFacet(u.deleteActionControler,w),S=u.deleteActionControler.evaluate(E)(e,{itemKey:w,isAvailable:!1,deleteWizard:f,isBatchDelete:v}),x=S.isAvailable,T=S.deleteWizard;x||(m=!1);g=T}var N=e.dispatch,C=function(){return n.__awaiter(h,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:e={};return[4,N(d({items:s.makeObject(o,function(){return e})}))];case 1:t.sent();return[2]}})})},k=l.renderComponentOnExecute(function(e){return r.createElement(g,n.__assign({},e,{onDelete:C,itemKeys:o}))});return{action:r.createElement(c.Action,n.__assign({isAvailable:m,onExecute:k},a.getItemActionEngagement(e,{itemKey:o[0],engagement:{name:"Delete",isIntentional:!0}})))}})(l.ActionSelector);t.DeleteAction=o.withSelectedItems()(t.ItemDeleteAction)});
define("@ms/items-view/lib/private/components/confirmationDialog/ConfirmationDialog",["require","exports","react","office-ui-fabric-react/lib/Dialog","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/Label","./ConfirmationDialog.resx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ConfirmationDialog=function(e){var t=e.onConfirm,u=e.onCancel,a=e.defaultToYes,f=void 0!==a&&a,l=e.yesText,c=void 0===l?o.default.yes:l,h=e.noText,p=void 0===h?o.default.no:h,d=f?i.PrimaryButton:i.DefaultButton,v=f?i.DefaultButton:i.PrimaryButton;return n.createElement(r.Dialog,{onDismiss:u,isOpen:!0,title:e.title,maxWidth:e.maxWidth},n.createElement(s.Label,null,e.prompt),n.createElement(r.DialogFooter,null,n.createElement(d,{"data-automationid":"confirmbutton",onClick:t},c),n.createElement(v,{"data-automationid":"cancelbutton",onClick:u,componentRef:function(e){e&&e.focus()}},p)))}});
define("@ms/items-view/lib/private/operations/deleteItems/DeleteProgressAddon",["require","exports","tslib","react","../../addons/registerOperationHandler","../../addons/registerControlHandler","../../controls/progressControl","@ms/utilities-strings/lib/index","../progress","./DeleteStrings.resx","../../facets/ProgressFacets","../../components/itemLink/ItemLink","../deleteItems","../../facets/SetFacets","../../facets/ItemFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v,m,g=((v={})[l.ProgressPhase.started]=function(e){var t=e.count;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteStartedItemsTitle,f.default.deleteCompletedItemsTitleIntervals,t)||"",t)},v[l.ProgressPhase.completed]=function(e){var t=e.count;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteCompletedItemsTitle,f.default.deleteCompletedItemsTitleIntervals,t)||"",t)},v[l.ProgressPhase.failed]=function(e){var t=e.count;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteFailedItemsTitle,f.default.deleteFailedItemsTitleIntervals,t)||"",t)},v[l.ProgressPhase.canceled]=function(e){var t=e.count;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteFailedItemsTitle,f.default.deleteFailedItemsTitleIntervals,t)||"",t)},v),y=((m={})[l.ProgressPhase.started]=function(e){var t=e.count,n=e.itemKey;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteStartedItemsDestinationTitle,f.default.deleteStartedItemsDestinationTitleIntervals,t)||"",t,r.createElement(c.ItemLink,{key:"link",itemKey:n}))},m[l.ProgressPhase.completed]=function(e){var t=e.count,n=e.itemKey;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteCompletedItemsDestinationTitle,f.default.deleteCompletedItemsDestinationTitleIntervals,t)||"",t,r.createElement(c.ItemLink,{key:"link",itemKey:n}))},m[l.ProgressPhase.failed]=function(e){var t=e.count,n=e.itemKey;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteFailedItemsDestinationTitle,f.default.deleteFailedItemsDestinationTitleIntervals,t)||"",t,r.createElement(c.ItemLink,{key:"link",itemKey:n}))},m[l.ProgressPhase.canceled]=function(e){var t=e.count,n=e.itemKey;return u.formatToArray(u.getLocalizedCountValue(f.default.deleteFailedItemsDestinationTitle,f.default.deleteFailedItemsDestinationTitleIntervals,t)||"",t,r.createElement(c.ItemLink,{key:"link",itemKey:n}))},m);t.deleteProgressAddon=i.createAddon(function(){return function(e){e(s.registerControlHandler(h.deleteProgressKeyFacet,o.progressControl)(s.createControlHandler()(b)))}});function b(){return function(e){return w}}function w(e,t){var r,i=a.getOverallSimpleProgressBreakdown(e,t),s=i.phase,o=i.count,u=function(e,t){var n=void 0,r=e.demandItemFacet(p.childItemsFacet,t.itemKey);if(r)for(var i=0,s=r.itemKeys;i<s.length;i++){var o=s[i],u=e.demandItemFacet(l.sourceItemFacet,o),a=u&&u.itemKey,f=e.demandItemFacet(d.parentFolderItemFacet,a),c=f&&f.itemKey;if(c)if(n){if(c!==n)break}else n=c}return n}(e,t);r="group"===t.format&&u?y[s]({count:o,itemKey:u}):g[s]({count:o});return n.__assign({},r?{title:r}:{})}});
define("@ms/items-view/lib/private/components/itemLink/ItemLink",["require","exports","react","../withItemCache/WithItemCache","../withAction/WithAction","office-ui-fabric-react/lib/Link","../actions/defaultClick/DefaultClickAction","../../facets/ItemFacets","../../models/itemsScope/getCurrentItemKey","../../models/items/haveSameParentItem"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ItemLink=function(e){var t=e.itemKey;return n.createElement(r.WithItemCache,null,function(r){var l,c=r.itemCache;if(e.children)l=e.children;else{var h=c.demandItemFacet(u.displayNameFacet,t);l=h}var p=a.getCurrentItemKey(c),d=f.haveSameParentItem(c,{itemKey1:t,itemKey2:p})?null:n.createElement(o.ItemDefaultClickAction,{itemKey:t});return n.createElement(i.WithAction,{action:d},function(e){var t=e.isAvailable,r=e.execute,i=t?function(){r().catch(function(){})}:void 0;return i?n.createElement(s.Link,{onClick:i},l):n.createElement("span",null,l)})})}});
define("@ms/items-view/lib/private/models/items/haveSameParentItem",["require","exports","./getItemKey","./getPreferredItemKey"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.haveSameParentItem=function(e,t){var i=n.getItemKey(e,{itemKey:t.itemKey1}),s=n.getItemKey(e,{itemKey:t.itemKey2});return r.getPreferredItemKey(e,{itemKey:i})===r.getPreferredItemKey(e,{itemKey:s})}});
define("@ms/items-view/lib/private/models/items/getPreferredItemKey",["require","exports","../../facets/OperationFacets"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getPreferredItemKey=function(e,t){var r=t.itemKey,i=e.demandItemFacet(n.preferredKeyFacetFacet,r);if(!i)return r;var s=e.demandItemFacet(i,r);return s&&i.serialize(s)||r}});
define("@ms/items-view/lib/private/components/commands/follow/followCommand",["require","exports","tslib","react","../../../models/Facet","../../actions/follow/FollowAction","../Commands.resx"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){return e?o.default.RemoveFromSaved:o.default.SaveForLater};t.followCommand={key:new i.Facet("follow").id,automationId:"followCommand",action:r.createElement(s.FollowAction,null),name:o.default.SaveForLater,postProcess:function(e){return n.__assign({},e,{name:e.iconOnly?void 0:u(e.actionState.isToggled)})},commandBarButtonAs:function(e){var t=e.defaultRender,i=e.actionState&&e.actionState.isToggled,s="boolean"==typeof i&&u(i)||void 0;return t?r.createElement(t,n.__assign({},e,{iconProps:{iconName:i?"SingleBookmarkSolid":"SingleBookmark"},name:e.iconOnly?void 0:s,text:e.iconOnly?void 0:s,title:s})):null}}});
define("@ms/items-view/lib/private/components/uploader/UploaderCore",["require","exports","tslib","react","../../utilities/async/CancelError","../decorators/connectToItemCache","../../operations/uploadItems/uploadEntries","../../operations/uploadItems/UploadProgressAddon"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={isStarted:!1,isCanceled:!1,error:void 0,isComplete:!1},f=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onItemQueued=function(e){var t=n.props.onItemQueued;t&&t(e)};n._onItemUploaded=function(e){var t=n.props.onItemUploaded;t&&t(e)};n._onItemFailed=function(e){var t=n.props.onItemFailed;t&&t(e)};n._onEntryBatchCreated=function(e){var t=n.props.onUploadStarted;t&&t(e)};n._onEntryBatchUploaded=function(e){var t=n.props.onUploadCompleted;t&&t(e)};n._onEntryBatchFailed=function(e){var t=n.props.onUploadFailed;t&&t(e)};n.state=a;n._cancelSource=new i.CancelSource;return n}t.prototype.render=function(){return null};t.prototype.componentDidMount=function(){this._onStateChanged(a)};t.prototype.componentDidUpdate=function(e,t){this._onStateChanged(t)};t.prototype.componentWillUnmount=function(){this._cancelSource.cancel()};t.prototype._onStateChanged=function(e){var t=this.state,n=t.isCanceled,r=t.isComplete;!e.isComplete&&r?this.props.resolve():!e.error&&this.state.error?this.props.reject(this.state.error):!e.isCanceled&&n?this.props.reject(new i.CancelError):this.state.isStarted||this._startUpload()};t.prototype._startUpload=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t,r,s;return n.__generator(this,function(n){switch(n.label){case 0:e=this.props,t=e.itemCacheDispatch,r=e.entryBatchKey;this.setState({isStarted:!0});n.label=1;case 1:n.trys.push([1,3,,4]);t(u.uploadProgressAddon);return[4,t(o.uploadEntryBatch({parentItemKey:this.props.itemKey,sourceEntryKey:r,callbacks:{onEntryBatchCreated:this._onEntryBatchCreated,onEntryBatchFailed:this._onEntryBatchFailed,onEntryBatchUploaded:this._onEntryBatchUploaded,onItemFailed:this._onItemFailed,onItemUploaded:this._onItemUploaded,onItemQueued:this._onItemQueued},cancelToken:this._cancelSource.token}))];case 2:n.sent();if(this._cancelSource.token.isCanceled())return[2];this.setState({isComplete:!0});return[3,4];case 3:s=n.sent();if(this._cancelSource.token.isCanceled())return[2];i.isCancel(s)?this.setState({isCanceled:!0}):this.setState({error:s});return[3,4];case 4:return[2]}})})};return t}(r.PureComponent);t.BaseUploaderCore=f;t.UploaderCore=s.connectToItemCache()(f)});
define("@ms/items-view/lib/private/operations/uploadItems/uploadEntries",["require","exports","tslib","../demandItems","../observeItems","../../facets/SetFacets","../../store/actions/createActionCreator","../../facets/ItemFacets","../uploadItems","../createFolder","../../facets/ProgressFacets","../../store/actions/implementOperation","../progress","../getItems","../../utilities/Graft","../../models/Facet","../../facets/GroupFacets","../../utilities/async/CancelError","../../utilities/symbol","../../utilities/async/all","../readItems","../../facets/FileSystemFacets","../../facets/DemandFacets","./UploadProgressKeyFacet","../pruneItems"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});y.polyfill();var N=function(){},C={onItemQueued:N,onItemUploaded:N,onItemFailed:N,onEntryBatchCreated:N,onEntryBatchUploaded:N,onEntryBatchFailed:N};t.uploadEntryBatch=function(e){var t=this,r=e.parentItemKey,i=e.sourceEntryKey,s=e.callbacks,o=void 0===s?C:s,u=e.options,a=void 0===u?{}:u;return function(s){return n.__awaiter(t,void 0,void 0,function(){var t,u,f,l,c;return n.__generator(this,function(n){switch(n.label){case 0:s(h.progressAddon);u={};s(T.registerItemDemands({owner:u,items:(t={},t[i]={},t)}));f=new g.CancelSource;e.cancelToken&&e.cancelToken.subscribe(f.cancel);return[4,s(A({sourceEntryKey:i}))];case 1:l=n.sent();return[4,s(l({parentItemKey:r,cancelToken:f.token,callbacks:o,options:a}))];case 2:c=n.sent().completed;n.label=3;case 3:n.trys.push([3,,5,6]);return[4,c];case 4:n.sent();return[3,6];case 5:f.dispose();s(T.removeItemDemands({owner:u}));return[7];case 6:return[2]}})})}};function k(e){var t=e.sourceEntryKey,r=e.cancelToken,i=x.getUploadProgressKey(t);return function(e){return n.__asyncGenerator(this,arguments,function(){var o,u,a,f,l,c,h,m,g,y,b;return n.__generator(this,function(w){switch(w.label){case 0:c={};e(T.registerItemDemands({owner:c,items:(o={},o[i]={},o)}));w.label=1;case 1:w.trys.push([1,,16,17]);e(p.resolveItems({items:(u={},u[i]=n.__assign({},s.childItemsFacet.pack({itemKeys:[]})),u)}));w.label=2;case 2:w.trys.push([2,9,10,15]);h=n.__asyncValues(e(L({itemKey:t,cancelToken:r})));w.label=3;case 3:return[4,n.__await(h.next())];case 4:if(!(m=w.sent(),!m.done))return[3,8];g=m.value;r.throwIfCanceled();y=x.getUploadProgressKey(g);e(p.resolveItems({items:(a={},a[i]=v.pack({childItems:s.childItemsFacet},{childItems:{itemKeys:new d.ArrayConcatIfNotMatchKeyPatch([y],function(e){return e})}}),a)}));return[4,n.__await(e(A({sourceEntryKey:g})))];case 5:return[4,w.sent()];case 6:w.sent();w.label=7;case 7:return[3,3];case 8:return[3,15];case 9:b=w.sent();f={error:b};return[3,15];case 10:w.trys.push([10,,13,14]);return m&&!m.done&&(l=h.return)?[4,n.__await(l.call(h))]:[3,12];case 11:w.sent();w.label=12;case 12:return[3,14];case 13:if(f)throw f.error;return[7];case 14:return[7];case 15:return[3,17];case 16:e(T.removeItemDemands({owner:c}));return[7];case 17:return[2]}})})}}function L(e){var t=e.itemKey,o=e.cancelToken;return function(e){return n.__asyncGenerator(this,arguments,function(){var u,a,f,l,c,h,p,d,v,m,g;return n.__generator(this,function(y){switch(y.label){case 0:f={};return[4,n.__await(e(r.demandItems(function(e){var n=e.demandItemFacet(s.defaultChildItemSetFacet,t);return n&&n.itemKey})))];case 1:return(l=y.sent())?[3,3]:[4,n.__await(void 0)];case 2:return[2,y.sent()];case 3:y.trys.push([3,12,13,18]);c=n.__asyncValues(e(i.observeItemsUntilResolved(function(e){o&&o.throwIfCanceled();var t=e.demandItemFacet(s.childItemsFacet,l),n=[];if(t)for(var r=0,i=t.itemKeys;r<i.length;r++){var u=i[r];e.isItemFacetResolved(s.pageFacet,u)?e.demandItemFacet(s.childItemsFacet,u):n.push(u)}return n})));y.label=4;case 4:return[4,n.__await(c.next())];case 5:if(!(h=y.sent(),!h.done))return[3,11];p=h.value;d=0,v=p;y.label=6;case 6:return d<v.length?(m=v[d])in f?[3,9]:[4,n.__await(m)]:[3,10];case 7:return[4,y.sent()];case 8:y.sent();f[m]=!0;y.label=9;case 9:d++;return[3,6];case 10:return[3,4];case 11:return[3,18];case 12:g=y.sent();u={error:g};return[3,18];case 13:y.trys.push([13,,16,17]);return h&&!h.done&&(a=c.return)?[4,n.__await(a.call(c))]:[3,15];case 14:y.sent();y.label=15;case 15:return[3,17];case 16:if(u)throw u.error;return[7];case 17:return[7];case 18:return[2]}})})}}function A(e){var t=this,i=e.sourceEntryKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,e(r.demandItems(function(e){return e.demandItemFacet(E.entryBatchFacet,i)}))];case 1:return t.sent()?[2,O(i)]:[4,e(r.demandItems(function(e){return e.demandItemFacet(u.folderFacet,i)}))];case 2:return t.sent()?[2,M(i)]:[2,_(i)]}})})}}function O(e){var t=this;return o.createAsyncActionCreator(function(r){var i=r.parentItemKey,o=r.callbacks,u=r.options,a=x.getUploadProgressKey(e);return function(f){var c,y,w=new g.CancelSource;r.cancelToken.subscribe(w.cancel);var E={};f(T.registerItemDemands({owner:{},items:(c={},c[a]={},c)}));f(p.resolveItems({items:(y={},y[h.progressRootItemKey]=v.pack({childItems:s.childItemsFacet},{childItems:{itemKeys:new d.ArrayConcatIfNotMatchKeyPatch([a],function(e){return e})}}),y[a]=n.__assign({},m.isGroupFacet.pack(!0),l.cancelSourceFacet.pack(w),l.sourceItemFacet.pack({itemKey:e}),l.destinationItemFacet.pack({itemKey:i})),y)}));var S=n.__awaiter(t,void 0,void 0,function(){var t,r,s,a,l,c,h,p,d,v,m;return n.__generator(this,function(g){switch(g.label){case 0:s=[];a=[];g.label=1;case 1:g.trys.push([1,6,7,12]);l=n.__asyncValues(f(k({sourceEntryKey:e,cancelToken:w.token})));g.label=2;case 2:return[4,l.next()];case 3:if(!(c=g.sent(),!c.done))return[3,5];h=c.value;w.token.throwIfCanceled();p=f(h({parentItemKey:i,cancelToken:w.token,callbacks:o,options:u})),d=p.started,v=p.completed;s.push(d);a.push(v);g.label=4;case 4:return[3,2];case 5:return[3,12];case 6:m=g.sent();t={error:m};return[3,12];case 7:g.trys.push([7,,10,11]);return c&&!c.done&&(r=l.return)?[4,r.call(l)]:[3,9];case 8:g.sent();g.label=9;case 9:return[3,11];case 10:if(t)throw t.error;return[7];case 11:return[7];case 12:return[2,{startedWork:s,completedWork:a}]}})}),x=n.__awaiter(t,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:t=(e=Promise).race;return[4,S];case 1:return[4,t.apply(e,[n.sent().startedWork])];case 2:n.sent();return[2]}})}),N=n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:e=b.waitForAll;return[4,S];case 1:return[4,e.apply(void 0,[t.sent().completedWork])];case 2:t.sent();return[2]}})});n.__awaiter(t,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:o.onEntryBatchCreated({progressItemKey:a});n.label=1;case 1:n.trys.push([1,3,4,5]);return[4,N];case 2:n.sent();o.onEntryBatchUploaded({progressItemKey:a});return[3,5];case 3:t=n.sent();o.onEntryBatchFailed({error:t,progressItemKey:a});return[3,5];case 4:f(p.resolveItems({items:(e={},e[a]=v.pack({cancelSource:l.cancelSourceFacet},{cancelSource:new d.Delete}),e)}));f(T.removeItemDemands({owner:E}));return[7];case 5:return[2]}})});return{started:x,completed:N}}})}function M(e){var t=this;return o.createAsyncActionCreator(function(i){var s=i.parentItemKey,o=i.callbacks,a=i.options,y=x.getUploadProgressKey(e);return function(E){var N,C,L=new g.CancelSource;i.cancelToken.subscribe(L.cancel);var A={};E(T.registerItemDemands({owner:A,items:(N={},N[y]={},N[e]={},N)}));E(p.resolveItems({items:(C={},C[y]=n.__assign({},S.errorFacet.pack(void 0),l.progressPhaseFacet.pack(l.ProgressPhase.created),m.isGroupFacet.pack(!0),l.destinationItemFacet.pack({itemKey:s}),l.sourceItemFacet.pack({itemKey:e}),l.cancelSourceFacet.pack(L)),C)}));var O=E(function(e){var t=this;return function(i){var s=e.sourceEntryKey,o=e.parentItemKey,a=e.cancelToken,h=x.getUploadProgressKey(s),d=n.__awaiter(t,void 0,void 0,function(){var e,t,d,v,m,g,y,b,E,S=this;return n.__generator(this,function(x){switch(x.label){case 0:return[4,i(r.demandItems(function(e){return e.demandItemFacet(u.fileNameFacet,s)}))];case 1:if(!(v=x.sent()))throw new Error("Invalid folder name.");m={folders:(e={},e[v.name]={progressItemKey:h},e)};i(p.resolveItems({items:(t={},t[h]=n.__assign({},f.createFolderOperation.pack(m)),t)}));g=i(c.startOperation({operationTypeFacet:f.createFolderOperation,items:(d={},d[o]=m,d)})),y=g.started,b=g.completed;E=a.subscribe(function(){var e;i(c.cancelOperation({operationTypeFacet:f.createFolderOperation,items:(e={},e[o]=m,e)}))});n.__awaiter(S,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,y];case 1:e.sent();E();return[2]}})});return[2,{started:y,itemCreated:n.__awaiter(S,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:return[4,b];case 1:n.sent();e=i(w.readItems(function(e){return e.demandItemFacet(l.createdItemFacet,h)}));if(!(t=e&&e.itemKey))throw new Error("No folder created.");return[2,t]}})})}]}})});return{started:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,d];case 1:return[4,e.sent().started];case 2:e.sent();return[2]}})}),itemCreated:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,d];case 1:return[4,e.sent().itemCreated];case 2:return[2,e.sent()]}})})}}}({sourceEntryKey:e,parentItemKey:s,cancelToken:L.token})),M=O.started,_=O.itemCreated,D=n.__awaiter(t,void 0,void 0,function(){var t,r,i,s,u,f,l,c,h,p,d,v;return n.__generator(this,function(m){switch(m.label){case 0:return[4,_];case 1:i=m.sent();s=[M];u=[];m.label=2;case 2:m.trys.push([2,7,8,13]);f=n.__asyncValues(E(k({sourceEntryKey:e,cancelToken:L.token})));m.label=3;case 3:return[4,f.next()];case 4:if(!(l=m.sent(),!l.done))return[3,6];c=l.value;h=E(c({parentItemKey:i,cancelToken:L.token,callbacks:o,options:a})),p=h.started,d=h.completed;s.push(p);u.push(d);m.label=5;case 5:return[3,3];case 6:return[3,13];case 7:v=m.sent();t={error:v};return[3,13];case 8:m.trys.push([8,,11,12]);return l&&!l.done&&(r=f.return)?[4,r.call(f)]:[3,10];case 9:m.sent();m.label=10;case 10:return[3,12];case 11:if(t)throw t.error;return[7];case 12:return[7];case 13:return[2,{startedWork:s,completedWork:u}]}})}),P=n.__awaiter(t,void 0,void 0,function(){var e,t;return n.__generator(this,function(n){switch(n.label){case 0:t=(e=Promise).race;return[4,D];case 1:return[4,t.apply(e,[n.sent().startedWork])];case 2:n.sent();return[2]}})}),H=n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:e=b.waitForAll;return[4,D];case 1:return[4,e.apply(void 0,[t.sent().completedWork])];case 2:t.sent();return[2]}})});n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:o.onItemQueued({progressItemKey:y});t.label=1;case 1:t.trys.push([1,3,4,5]);return[4,H];case 2:t.sent();o.onItemUploaded({progressItemKey:y});return[3,5];case 3:t.sent();o.onItemFailed({progressItemKey:y});return[3,5];case 4:E(p.resolveItems({items:(e={},e[y]=v.pack({cancelSource:l.cancelSourceFacet},{cancelSource:new d.Delete}),e)}));L.dispose();E(T.removeItemDemands({owner:A}));return[7];case 5:return[2]}})});E(h.trackItemProgress({started:P,completed:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,_];case 1:e.sent();return[2]}})}),progressItemKey:y}));return{started:P,completed:H}}})}function _(e){var t=this;return o.createAsyncActionCreator(function(i){var s=i.parentItemKey,o=i.callbacks,f=i.options,y=x.getUploadProgressKey(e);return function(b){var E,N,C=new g.CancelSource;i.cancelToken.subscribe(C.cancel);if(b(w.readItems(function(e){return e.demandItemFacet(l.createdItemFacet,y)})))return{started:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})}),completed:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})})};var k={};b(T.registerItemDemands({owner:k,items:(E={},E[y]={},E[e]={},E)}));b(p.resolveItems({items:(N={},N[y]=n.__assign({},S.errorFacet.pack(void 0),l.progressPhaseFacet.pack(l.ProgressPhase.created),m.isGroupFacet.pack(!1),l.destinationItemFacet.pack({itemKey:s}),l.sourceItemFacet.pack({itemKey:e}),l.cancelSourceFacet.pack(C)),N)}));var L=b(function(e){var t=this,i=e.sourceEntryKey,s=e.parentItemKey,o=e.cancelToken,f=e.options,h=x.getUploadProgressKey(i);return function(e){var d,v={sourceEntries:(d={},d[i]=n.__assign({progressItemKey:h},f),d)},m=n.__awaiter(t,void 0,void 0,function(){var t,f,d,m,g,y,b,w=this;return n.__generator(this,function(E){switch(E.label){case 0:return[4,e(r.demandItems(function(e){return e.demandItemFacet(u.fileSizeFacet,i)}))];case 1:void 0!==(d=E.sent())&&e(p.resolveItems({items:(t={},t[h]=n.__assign({},l.progressSizeFacet.pack({total:d,current:0})),t)}));m=e(c.startOperation({operationTypeFacet:a.uploadItemsOperation,items:(f={},f[s]=v,f)})),g=m.started,y=m.completed;b=o.subscribe(function(){var t;e(c.cancelOperation({operationTypeFacet:a.uploadItemsOperation,items:(t={},t[s]=v,t)}))});n.__awaiter(w,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,g];case 1:e.sent();b();return[2]}})});return[2,{started:g,completed:y}]}})});return{started:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,m];case 1:return[2,e.sent().started]}})}),completed:n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,m];case 1:return[2,e.sent().completed]}})})}}}({sourceEntryKey:e,parentItemKey:s,cancelToken:C.token,options:f})),A=L.started,O=L.completed;n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:o.onItemQueued({progressItemKey:y});t.label=1;case 1:t.trys.push([1,3,4,5]);return[4,O];case 2:t.sent();o.onItemUploaded({progressItemKey:y});return[3,5];case 3:t.sent();o.onItemFailed({progressItemKey:y});return[3,5];case 4:b(p.resolveItems({items:(e={},e[y]=v.pack({cancelSource:l.cancelSourceFacet},{cancelSource:new d.Delete}),e)}));C.dispose();b(T.removeItemDemands({owner:k}));return[7];case 5:return[2]}})});b(h.trackItemProgress({started:A,completed:O,progressItemKey:y}));return{started:A,completed:O}}})}});
define("@ms/items-view/lib/private/operations/uploadItems/UploadProgressKeyFacet",["require","exports","../../models/KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadProgressKeyFacet=new n.KeyFacet("uploadProgress",{sourceEntryKey:n.stringPart()});t.getUploadProgressKey=function(e){return t.uploadProgressKeyFacet.serialize({sourceEntryKey:e})}});
define("@ms/items-view/lib/private/operations/uploadItems/UploadProgressAddon",["require","exports","tslib","react","../../addons/registerOperationHandler","../../store/actions/implementOperation","../../addons/registerControlHandler","../../controls/progressControl","@ms/utilities-strings/lib/index","../../components/uploader/UploadStrings.resx","../../components/progress/ProgressStrings.resx","../../operations/getItems","@ms/items-view-utilities/lib/string/DriveSpaceHelper","../../operations/progress","../../facets/ProgressFacets","../../facets/ItemFacets","../../facets/FileSystemFacets","../readItems","../../facets/SetFacets","../../components/itemLink/ItemLink","../../operations/progress/cancelProgressItems","../../components/progress/commands/retry/retryProgressCommand","../progress/retryProgressItems","../../components/progress/commands/replace/replaceProgressCommand","../../components/progress/commands/rename/renameProgressCommand","../progress/resolveProgressItems","../../models/Facet","../../facets/ErrorFacets","../../facets/DemandFacets","./UploadProgressKeyFacet","./uploadEntries","./UploadProgressErrorKeyFacet","../../facets/ConfigurationFacets","../../models/configuration/getConfiguration"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var P,H;t.uploadProgressKeyFacet=A.uploadProgressKeyFacet;t.getUploadProgressKey=A.getUploadProgressKey;var B=((P={})[d.ProgressPhase.started]=function(e){var t=e.count;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadStartedItemsTitle,f.default.uploadCompletedItemsTitleIntervals,t)||"",t)},P[d.ProgressPhase.completed]=function(e){var t=e.count;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadCompletedItemsTitle,f.default.uploadCompletedItemsTitleIntervals,t)||"",t)},P[d.ProgressPhase.failed]=function(e){var t=e.count;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadFailedItemsTitle,f.default.uploadFailedItemsTitleIntervals,t)||"",t)},P[d.ProgressPhase.canceled]=function(e){var t=e.count;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadFailedItemsTitle,f.default.uploadFailedItemsTitleIntervals,t)||"",t)},P),j=((H={})[d.ProgressPhase.started]=function(e){var t=e.count,n=e.itemKey;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadStartedItemsDestinationTitle,f.default.uploadCompletedItemsDestinationTitleIntervals,t)||"",t,r.createElement(b.ItemLink,{key:"link",itemKey:n}))},H[d.ProgressPhase.completed]=function(e){var t=e.count,n=e.itemKey;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadCompletedItemsDestinationTitle,f.default.uploadCompletedItemsDestinationTitleIntervals,t)||"",t,r.createElement(b.ItemLink,{key:"link",itemKey:n}))},H[d.ProgressPhase.failed]=function(e){var t=e.count,n=e.itemKey;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadFailedItemsDestinationTitle,f.default.uploadFailedItemsDestinationTitleIntervals,t)||"",t,r.createElement(b.ItemLink,{key:"link",itemKey:n}))},H[d.ProgressPhase.canceled]=function(e){var t=e.count,n=e.itemKey;return a.formatToArray(a.getLocalizedCountValue(f.default.uploadFailedItemsDestinationTitle,f.default.uploadFailedItemsDestinationTitleIntervals,t)||"",t,r.createElement(b.ItemLink,{key:"link",itemKey:n}))},H);t.uploadProgressAddon=i.createAddon(function(){return function(e){e(i.registerOperationHandler(A.uploadProgressKeyFacet,c.getItemsOperation)(i.createSingleItemOperationHandler()(q)));e(o.registerControlHandler(A.uploadProgressKeyFacet,u.progressControl)(o.createControlHandler()(F)));e(i.registerOperationHandler(A.uploadProgressKeyFacet,w.cancelProgressItemsOperation)(p.createCancelProgressItemsOperationHandler(A.uploadProgressKeyFacet)));e(i.registerOperationHandler(A.uploadProgressKeyFacet,S.retryProgressItemsOperation)(i.createSingleItemOperationHandler()(R)));e(i.registerOperationHandler(A.uploadProgressKeyFacet,N.resolveProgressItemsOperation)(i.createSingleItemOperationHandler()(U)))}});function F(){return function(e){return I}}function I(e,t){var r=e.demandItemFacet(d.sourceItemFacet,t.itemKey),i=e.demandItemFacet(m.entryBatchFacet,r&&r.itemKey),o=D.getConfiguration(e,{enableNewConflictUploadErrorStrings:_.enableNewConflictUploadErrorStringsConfigurationFacet}).enableNewConflictUploadErrorStrings,u=function e(t,n){var r=t.demandItemFacet(d.progressSizeFacet,n.itemKey);if(r)return r;var i=t.demandItemFacet(y.childItemsFacet,n.itemKey);if(i){for(var s={total:0,current:0},o=0,u=i.itemKeys;o<u.length;o++){var a=u[o],f=e(t,{itemKey:a});if(!f)return;s.total+=f.total;s.current+=f.current}return s}var l=t.demandItemFacet(d.sourceItemFacet,n.itemKey);if(l){var c=t.demandItemFacet(v.fileSizeFacet,l.itemKey);if("number"!=typeof c)return;var h=t.demandItemFacet(d.createdItemFacet,n.itemKey);return{total:c,current:h?c:0}}return}(e,t),a=u?u.total>0?u.current/u.total:1:void 0,c=e.demandItemFacet(d.destinationItemFacet,t.itemKey),g=c&&c.itemKey;if(r&&!i){var b=p.getOverallProgressPhase(e,t),w=e.demandItemFacet(v.folderFacet,r.itemKey),S=void 0;b===d.ProgressPhase.completed&&u?S=h.default.getDisplayString(u.total):w?b!==d.ProgressPhase.created&&b!==d.ProgressPhase.started||(S=z(u)||l.default.genericStartedIndeterminateDescription):b===d.ProgressPhase.started?S=z(u):b===d.ProgressPhase.created&&(S=l.default.genericCreatedDescription);var N=e.demandItemFacet(L.errorFacet,t.itemKey),A=[],O=void 0;if(N)if(N instanceof s.ItemOperationError){var P=C.unpack({conflict:k.conflictErrorFacet,retry:k.retryErrorFacet,offline:k.offlineErrorFacet,accessDenied:k.accessDeniedErrorFacet,invalidName:k.invalidNameErrorFacet,emptyFolder:k.emptyFolderUnsupportedFacet,overQuota:k.overQuotaErrorFacet,lockMismatch:k.lockMismatchErrorFacet,authFailure:k.authFailureErrorFacet,folderUpload:k.folderUploadUnsupportedFacet,targetFolder:k.targetFolderErrorFacet,malware:k.malwareErrorFacet,throttle:k.throttleErrorFacet},N.facets),H=P.conflict,F=P.retry,I=P.offline,q=P.accessDenied,R=P.invalidName,U=P.emptyFolder,W=P.overQuota,X=P.lockMismatch,V=P.authFailure,$=P.folderUpload,J=P.targetFolder,K=P.malware,Q=P.throttle;if(H){S=o?f.default.newConflictUploadWithoutRenameErrorText:f.default.conflictUploadWithoutRenameErrorText;A.push(o?x.addNewVersionProgressCommand:x.replaceProgressCommand);if(H.supportsRename){S=o?f.default.newConflictUploadErrorText:f.default.conflictUploadErrorText;O=M.uploadProgressErrorKeyFacet.serialize({type:"conflict+rename"});A.push(T.renameProgressCommand)}else O=M.uploadProgressErrorKeyFacet.serialize({type:"conflict"})}else if(q){S=f.default.accessDeniedUploadErrorText;O=M.uploadProgressErrorKeyFacet.serialize({type:"accessDenied"})}else if(R){S=f.default.invalidNameUploadErrorText;A.push(T.renameProgressCommand);O=M.uploadProgressErrorKeyFacet.serialize({type:"invalidName"})}else if(U||$){S=f.default.folderUploadNotSupported;O=M.uploadProgressErrorKeyFacet.serialize({type:"folderUpload"})}else if(W){S=f.default.overQuotaSharedFolderUploadErrorText;O=M.uploadProgressErrorKeyFacet.serialize({type:"overQuota"})}else if(X){S=f.default.lockMismatchUploadErrorText;A.push(E.retryProgressCommand);O=M.uploadProgressErrorKeyFacet.serialize({type:"lockMismatch"})}else if(V){S=f.default.authFailureUploadErrorText;A.push(E.retryProgressCommand);O=M.uploadProgressErrorKeyFacet.serialize({type:"authFailure"})}else if(J){S=f.default.targetFolderMissingUploadErrorText;O=M.uploadProgressErrorKeyFacet.serialize({type:"targetFolder"})}else if(K){S=f.default.malwareDetectedUploadErrorText;O=M.uploadProgressErrorKeyFacet.serialize({type:"malware"})}else if(Q){S=f.default.throttledUploadErrorText;A.push(E.retryProgressCommand);O=M.uploadProgressErrorKeyFacet.serialize({type:"throttle"})}else if(I){S=f.default.disconnectedUploadText;A.push(E.retryProgressCommand);O=M.uploadProgressErrorKeyFacet.serialize({type:"offline"})}else if(!F){S=N.message||f.default.generalUploadNoRetryErrorText;O=M.uploadProgressErrorKeyFacet.serialize({type:"noRetry"})}if(F){S=f.default.generalUploadErrorText;A.push(E.retryProgressCommand);O=M.uploadProgressErrorKeyFacet.serialize({type:"retry"})}}else{S=N.message||f.default.generalUploadErrorText;A.push(E.retryProgressCommand);O=M.uploadProgressErrorKeyFacet.serialize({type:"unknown"})}return n.__assign({percentComplete:a},O?{errorKey:O}:{},S?{description:S}:{},{commands:A})}var G=p.getOverallSimpleProgressBreakdown(e,t),Y=(b=G.phase,G.count);S=void 0;b===d.ProgressPhase.completed&&u?S=h.default.getDisplayString(u.total):b===d.ProgressPhase.started&&(S=z(u)||l.default.genericStartedIndeterminateDescription);var Z=void 0;Z="group"===t.format&&g?j[b]({count:Y,itemKey:g}):B[b]({count:Y});return n.__assign({},Z?{title:Z}:{},S?{description:S}:{},{percentComplete:a})}function q(e){var t=this;return function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(e){return[2]})})}}function R(e){var t=this,r=e.itemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,s,o,u;return n.__generator(this,function(n){switch(n.label){case 0:t=e(g.readItems(function(e){return{sourceItem:e.demandItemFacet(d.sourceItemFacet,r),destinationItem:e.demandItemFacet(d.destinationItemFacet,r)}})),i=t.sourceItem,s=t.destinationItem;o=i&&i.itemKey;u=s&&s.itemKey;if(!o)throw new Error("No source entry to retry.");if(!u)throw new Error("No parent item to retry.");return[4,e(O.uploadEntryBatch({sourceEntryKey:o,parentItemKey:u}))];case 1:n.sent();return[2]}})})}}function U(e){var t=this,r=e.itemKey,i=e.options;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,s,o,u,a;return n.__generator(this,function(n){switch(n.label){case 0:t=e(g.readItems(function(e){return{sourceItem:e.demandItemFacet(d.sourceItemFacet,r),destinationItem:e.demandItemFacet(d.destinationItemFacet,r)}})),s=t.sourceItem,o=t.destinationItem;u=s&&s.itemKey;a=o&&o.itemKey;if(!u)throw new Error("No source entry to retry.");if(!a)throw new Error("No parent item to retry.");return[4,e(O.uploadEntryBatch({sourceEntryKey:u,parentItemKey:a,options:i}))];case 1:n.sent();return[2]}})})}}function z(e){return e&&e.total>0?a.format(l.default.genericStartedByteProgressDescription,h.default.getDisplayString(e.current),h.default.getDisplayString(e.total)):void 0}});
define("@ms/items-view/lib/private/components/progress/commands/retry/retryProgressCommand",["require","exports","react","../../actions/retry/RetryProgressAction","../../../../models/Facet","../../ProgressStrings.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.retryProgressCommand={key:new i.Facet("retryProgressCommand").id,name:s.default.progressRetryActionText,action:n.createElement(r.RetryProgressAction,null)}});
define("@ms/items-view/lib/private/components/progress/actions/retry/RetryProgressAction",["require","exports","tslib","react","../../../withItemCache/WithItemCache","../../../../operations/progress/retryProgressItems","../../../../utilities/objects","../../../action/Action","../../../../operations/progress","../../../decorators/selectors"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.itemKeys;return r.createElement(i.WithItemCache,null,function(i){var f=i.itemCache,l=i.dispatch,c=t.filter(function(e){return"failed"===a.getOverallSimpleProgressBreakdown(f,{itemKey:e}).phase});return r.createElement(u.Action,{onExecute:function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){l(s.retryProgressItems({items:o.makeObject(c,function(){return{}})}));return[2]})})},isAvailable:c.length>0})})};return t}(r.PureComponent);t.ItemRetryProgressAction=l;t.RetryProgressAction=f.withSelectedItems()(l)});
define("@ms/items-view/lib/private/operations/progress/retryProgressItems",["require","exports","../../models/Facet","../../store/actions/implementOperation"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.retryProgressItemsOperation=new n.Facet("retryProgressItemsOperation");t.retryProgressItems=r.implementOperation({operationTypeFacet:t.retryProgressItemsOperation})});
define("@ms/items-view/lib/private/components/progress/commands/replace/replaceProgressCommand",["require","exports","react","../../actions/resolve/ResolveProgressAction","../../../../models/Facet","../../ProgressStrings.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.replaceProgressCommand={key:new i.Facet("renameProgressCommand").id,name:s.default.progressReplaceActionText,action:n.createElement(r.ResolveProgressAction,{conflictResolution:"replace"})};t.addNewVersionProgressCommand={key:new i.Facet("addNewVersionProgressCommand").id,name:s.default.progressAddNewVersionActionText,action:n.createElement(r.ResolveProgressAction,{conflictResolution:"replace"})}});
define("@ms/items-view/lib/private/components/progress/actions/resolve/ResolveProgressAction",["require","exports","tslib","react","../../../withItemCache/WithItemCache","../../../../operations/progress/resolveProgressItems","../../../../utilities/objects","../../../action/Action","../../../../operations/progress","../../../decorators/selectors"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,f=t.itemKeys,l=t.conflictResolution;return r.createElement(i.WithItemCache,null,function(t){var i=t.itemCache,c=t.dispatch,h=f.filter(function(e){return"failed"===a.getOverallSimpleProgressBreakdown(i,{itemKey:e}).phase});return r.createElement(u.Action,{onExecute:function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){c(s.resolveProgressItems({items:o.makeObject(h,function(){return{conflictResolution:l}})}));return[2]})})},isAvailable:h.length>0})})};return t}(r.PureComponent);t.ItemResolveProgressAction=l;t.ResolveProgressAction=f.withSelectedItems()(l)});
define("@ms/items-view/lib/private/operations/progress/resolveProgressItems",["require","exports","../../models/Facet","../../store/actions/implementOperation"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resolveProgressItemsOperation=new n.Facet("resolveProgressItemsOperation");t.resolveProgressItems=r.implementOperation({operationTypeFacet:t.resolveProgressItemsOperation})});
define("@ms/items-view/lib/private/components/progress/commands/rename/renameProgressCommand",["require","exports","react","../../actions/resolve/ResolveProgressAction","../../../../models/Facet","../../ProgressStrings.resx"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.renameProgressCommand={key:new i.Facet("renameProgressCommand").id,name:s.default.progressRenameActionText,action:n.createElement(r.ResolveProgressAction,{conflictResolution:"rename"})}});
define("@ms/items-view/lib/private/operations/uploadItems/UploadProgressErrorKeyFacet",["require","exports","../../models/KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.uploadProgressErrorKeyFacet=new n.KeyFacet("uploadProgress",{type:n.stringPart()})});
define("@ms/items-view/lib/private/operations/DeferredOperations",["require","exports","tslib","./uploadItems/FileEntryAddon","./demandItems"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t);n.__exportStar(i,t)});
define("@ms/items-view/lib/private/operations/uploadItems/FileEntryAddon",["require","exports","tslib","../../operations/getItems","../../operations/clearItems","../../operations/deleteItems","../../models/KeyFacet","../../models/AutoKeyFacet","../../models/Facet","../../addons/registerOperationHandler","../../facets/SetFacets","../../facets/ItemFacets","../../operations/readItems","../../models/items/ItemResolver","../../models/items/PageHelpers","../../facets/FileSystemFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=new u.AutoKeyFacet("batch");var g=new o.KeyFacet("batchChildren",{batch:o.subKeyPart(m)}),y=new o.KeyFacet("fileEntry",{batch:o.subKeyPart(m),index:o.numberPart(),path:o.stringPart()}),b=new o.KeyFacet("fileEntryChildren",{fileEntry:o.subKeyPart(y)}),w=new o.KeyFacet("fileEntryDirectoryPage",{fileEntryChildren:o.subKeyPart(b),startIndex:o.numberPart()}),E=new a.Facet("entry"),S=new a.Facet("rootEntries"),x=new a.Facet("directoryPage");t.fileEntryAddon=f.createAddon(function(){return function(e){e(r.supportFacets({keyFacet:m,facets:[l.defaultChildItemSetFacet]}));e(r.supportFacets({keyFacet:g,facets:[l.childItemsFacet]}));e(r.supportFacets({keyFacet:y,facets:[c.displayNameFacet,l.defaultChildItemSetFacet,v.sourceFileFacet,c.fileSizeFacet,c.fileNameFacet,c.folderFacet,c.parentFolderItemFacet,c.dateModifiedFacet]}));e(r.supportFacets({keyFacet:b,facets:[l.childItemsFacet]}));e(r.supportFacets({keyFacet:w,facets:[l.childItemsFacet]}));e(f.registerOperationHandler(m,r.getItemsOperation)(f.createSingleItemOperationHandler()(T)));e(f.registerOperationHandler(g,r.getItemsOperation)(f.createSingleItemOperationHandler()(N)));e(f.registerOperationHandler(y,r.getItemsOperation)(f.createSingleItemOperationHandler()(C)));e(f.registerOperationHandler(b,r.getItemsOperation)(f.createSingleItemOperationHandler()(k)));e(f.registerOperationHandler(w,r.getItemsOperation)(f.createSingleItemOperationHandler()(L)));e(f.registerOperationHandler(m,s.deleteItemsOperation)(f.createSingleItemOperationHandler()(A)))}});t.createEntryBatch=function(e){return function(i){var s;i(t.fileEntryAddon);var o=m.serializeNext();i(r.resolveItems({items:(s={},s[o]=n.__assign({},v.entryBatchFacet.pack({}),S.pack(e.entries)),s)}));return{itemKey:o}}};function T(e){var t=this,i=e.itemKey,s=m.deserialize(i);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t;return n.__generator(this,function(o){e(h.readItems(function(e){return e.demandItemFacet(S,i)}))&&e(r.resolveItems({items:(t={},t[i]=n.__assign({},v.entryBatchFacet.pack({}),l.defaultChildItemSetFacet.pack({itemKey:g.serialize({batch:s})})),t)}));return[2]})})}}function N(e){var t=this,r=e.itemKey,i=g.deserialize(r).batch,s=m.serialize(i);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,o,u,a,f,c,d,v,m,g;return n.__generator(this,function(b){if(u=e(h.readItems(function(e){return e.demandItemFacet(S,s)}))){a=new p.ItemResolver;f=[];c=0;for(d=0,v=u;d<v.length;d++){m=v[d];g=y.serialize({batch:i,index:c,path:m.name});a.resolveItems({items:(t={},t[g]=n.__assign({},E.pack(m)),t)});f.push(g);c++}a.resolveItems({items:(o={},o[r]=n.__assign({},l.childItemsFacet.pack({itemKeys:f})),o)});e(a.execute())}return[2]})})}}function C(e){var t=this,i=e.itemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,s,o,u;return n.__generator(this,function(a){switch(a.label){case 0:if(!(o=e(h.readItems(function(e){return e.demandItemFacet(E,i)}))))return[3,2];e(r.resolveItems({items:(t={},t[i]=n.__assign({},c.displayNameFacet.pack(o.name),2===o.type?n.__assign({},c.folderFacet.pack({}),c.fileNameFacet.pack({name:o.name,extension:""}),l.defaultChildItemSetFacet.pack({itemKey:b.serialize({fileEntry:y.deserialize(i)})})):n.__assign({},l.defaultChildItemSetFacet.pack(void 0),c.folderFacet.pack(void 0)),1===o.type?n.__assign({},c.fileNameFacet.pack(O(o.name))):{}),t)}));return 1!==o.type&&0!==o.type?[3,2]:[4,o.getFile()];case 1:u=a.sent();e(r.resolveItems({items:(s={},s[i]=n.__assign({},c.fileNameFacet.pack(O(u.name)),c.folderFacet.pack(void 0),c.fileSizeFacet.pack(u.size),c.dateModifiedFacet.pack(u.lastModified),v.sourceFileFacet.pack(u)),s)}));a.label=2;case 2:return[2]}})})}}function k(e){var t=this,r=e.itemKey,i=b.deserialize(r),s=i.fileEntry,o=y.serialize(s);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,u,a,f,v,m,g,b,S,T,N,C,k,L,A;return n.__generator(this,function(O){switch(O.label){case 0:return(f=e(h.readItems(function(e){return e.demandItemFacet(E,y.serialize(s))})))&&2===f.type?[4,f.getEntries()]:[3,2];case 1:v=O.sent();m=new p.ItemResolver;g=v.entries,b=v.getEntries;S=[];T=0;for(N=0,C=g;N<C.length;N++){k=C[N];L=y.serialize(n.__assign({},s,{index:T,path:s.path+"/"+k.name}));m.resolveItems({items:(t={},t[L]=n.__assign({},E.pack(k),c.parentFolderItemFacet.pack({itemKey:o})),t)});S.push(L);T++}if(b){A=w.serialize({fileEntryChildren:i,startIndex:T});m.merge(d.resolveNewPage({itemKey:A}).itemResolver);m.resolveItems({items:(u={},u[A]=n.__assign({},x.pack(v)),u)});S.push(A)}m.resolveItems({items:(a={},a[r]=n.__assign({},l.childItemsFacet.pack({itemKeys:S}),l.parentItemFacet.pack({itemKey:o})),a)});e(m.execute());O.label=2;case 2:return[2]}})})}}function L(e){var t=this,r=e.itemKey,i=w.deserialize(r),s=i.fileEntryChildren,o=i.startIndex,u=s.fileEntry,a=y.serialize(u);return function(e){return n.__awaiter(t,void 0,void 0,function(){var t,i,f,l,v,m,g,S,T,N,C,k,L;return n.__generator(this,function(A){switch(A.label){case 0:return(f=e(h.readItems(function(e){return e.demandItemFacet(x,r)})))&&f.getEntries?[4,f.getEntries()]:[3,2];case 1:l=A.sent();v=new p.ItemResolver;m=l.entries,g=l.getEntries;S=[];for(T=0,N=m;T<N.length;T++){C=N[T];k=y.serialize(n.__assign({},u,{path:u.path+"/"+C.name}));v.resolveItems({items:(t={},t[k]=n.__assign({},E.pack(C),c.parentFolderItemFacet.pack({itemKey:a})),t)});S.push(k)}if(g){L=w.serialize({fileEntryChildren:s,startIndex:o+m.length});v.merge(d.resolveNewPage({itemKey:L}).itemResolver);v.resolveItems({items:(i={},i[L]=n.__assign({},x.pack(l)),i)});S.push(L)}v.merge(d.resolveExistingPage({itemKey:r,itemSetKey:b.serialize(s),childItemKeys:S}).itemResolver);e(v.execute());A.label=2;case 2:return[2]}})})}}function A(e){var t=this,r=e.itemKey;return function(e){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){e(i.clearItems({items:e(h.readItems(function(e){for(var t,n={},i=[r];t=i.pop();){n[t]=!0;var s=e.demandItemFacet(l.defaultChildItemSetFacet,t),o=s&&s.itemKey;o&&(n[o]=!0);var u=e.demandItemFacet(l.childItemsFacet,o),a=u&&u.itemKeys;a&&i.push.apply(i,a)}return n}))}));return[2]})})}}function O(e){var t=e.lastIndexOf(".");return t>-1?{name:e.slice(0,t),extension:e.slice(t)}:{name:e,extension:""}}});
define("@ms/telemetry-addon-aria/lib/AriaWrapper",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.aria=e("@ms/aria-private")});
define("odsp-next/actions/itemsScope/DefaultClickAction",["require","exports","tslib","./base/CreateItemsScopeItemActionFromKnockout","../../resources/ControlResourceKeys","../../base/BaseAction","../../utilities/killSwitch/KillSwitch"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this,r=n.resources.consume(i.actionMap);n._action=new(n.managed(r.DefaultClickAction))(t);n._item=t.item;return n}t.prototype.onIsAvailable=function(){var e=this.observables.unwrap(this._item);return!(!e||e.isPlaceholder)&&this._action.isAvailable()};t.prototype.onExecute=function(e){return this._action.execute(e)};return t}(s.default);t.DefaultClickAction=r.createItemsScopeItemActionFromKnockout(function(e,t){var n=e.consume(i.actionMap),r=o.default.isActivated("9FCD7B65-390C-4C59-9913-FC1D9D8D79E1","9/9/2019","Restore original DefaultClickAction behavior thanks to deferred execution")?u:n.DefaultClickAction;return new(e.injected(r,{injectChildResourceScope:!0}))({item:t.item,userInvokedItem:!0,sourceEngagement:"ItemRow.Click"})})});
define("odsp-next/actions/itemsScope/base/CreateItemsScopeItemActionFromKnockout",["require","exports","./CreateItemsScopeActionFromKnockout","../../../controls/base/react/WithKnockoutStoreItem"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createItemsScopeItemActionFromKnockout=function(e,t){void 0===t&&(t={});var i=n.createItemsScopeActionFromKnockout(e);return r.withKnockoutStoreItem(function(e){return{item:e}})(i)}});
define("odsp-next/actions/itemsScope/base/CreateItemsScopeActionFromKnockout",["require","exports","tslib","react","@ms/odsp-utilities/lib/resources/Resources","@ms/items-view/lib/private/components/action/Action","../../../controls/base/react/WithResources","../../../controls/base/react/WithKnockoutComputed","../../base/ItemSelectionHelper","../../base/itemsScope/ItemSelectionHelper","../../../utilities/killSwitch/KillSwitch"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=e("module").id;t.createItemsScopeActionFromKnockout=function(e,t){void 0===t&&(t={});var h=t.isToggleable,p=void 0!==h&&h;function d(t){var i=this,a=o.useResourceScope(),f=r.useRef(),l=f.current||(f.current=e(a,t));r.useEffect(function(){return function(){l.dispose()}},[]);var c=u.useObservableValue(l.isAvailable),h=u.useObservableValue(p?l.isToggled:void 0);return r.createElement(s.ActionBase,{isAvailable:c,onExecute:function(e){return n.__awaiter(i,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,l.execute(e.event)];case 1:t.sent();return[2]}})})},isToggled:h})}return l.default.isActivated("DB243761-5E52-4E84-8204-175D856F50DE","9/4/2019","Always use ItemCache selection shim for actions")?d:o.withChildResources(function(e){e.exposeFactory(a.typeResourceKey,new i.AliasResourceFactory(f.typeResourceKey))},{owner:c})(d)}});
define("odsp-next/actions/base/itemsScope/ItemSelectionHelper",["require","exports","tslib","@ms/odsp-utilities/lib/async/Promise","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/resources/Resources","../../../models/itemCache/ItemCacheObservable","../../../controls/itemsScope/ItemsScopeItemKey","../../../models/itemCache/ItemCacheStore","@ms/items-view/lib/private/facets/ScopeFacets","@ms/items-view/lib/private/models/items/getItemKey","../../../models/itemsScope/facets/KnockoutStoreItemFacet","@ms/items-view/lib/private/operations/selectItems","@ms/items-view/lib/private/facets/ItemFacets","../../../models/item/OneDriveItem"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=function(t){n.__extends(i,t);function i(e,n){var r=t.call(this,e,n)||this,i=e.allowMultiSelect,s=void 0!==i&&i,o=e.canFallback,u=void 0!==o&&o,a=e.overrideItem,h=e.ignoreSelection,v=void 0!==h&&h,m=n.itemsScopeItemKey,g=n.itemCacheObservablesFactory,y=n.itemCacheStore;r._itemCacheStore=y;r._itemsScopeItemKey=m;r._placeholder=r.observables.create(new d.default);r._currentKnockoutStoreItem=r.scope.attach(g.pureCompute(function(e){var t=e.demandItemFacet(f.currentItemFacet,m),n=l.getItemKey(e,{itemKey:t&&t.itemKey});e.demandItemFacet(p.displayNameFacet,n);return e.demandItemFacet(c.knockoutStoreItemFacet,n)||r._placeholder}));r.currentItem=r.observables.pureCompute(function(){var e=r._currentKnockoutStoreItem();return e&&e()});r._selectedKnockoutStoreItems=r.scope.attach(g.pureCompute(function(e){if(a)return[[void 0,a]];var t=e.demandItemFacet(f.selectedItemsFacet,m),n=t&&t.itemKeys,r=e.demandItemFacet(f.currentItemFacet,m),i=l.getItemKey(e,{itemKey:r&&r.itemKey}),o=n&&n.length>0;if(!s&&n&&n.length>1)return[];for(var h=[],p=0,d=o&&!v||!u?n||[]:i?[i]:[];p<d.length;p++){var g=d[p],y=e.demandItemFacet(c.knockoutStoreItemFacet,g);y&&h.push([g,y])}return h}));r.selection=r.observables.pureCompute(function(){return r._selectedKnockoutStoreItems().map(function(e){return e[1]})});r.firstItem=r.observables.pureCompute(function(){var e=r._selectedKnockoutStoreItems()[0],t=(void 0===e?[]:e)[1],n=void 0===t?void 0:t;return n&&n()});return r}i.prototype.filterItems=function(e){return this._selectedKnockoutStoreItems.peek().some(function(t){var n=t[1];return e(n())})};i.prototype.resolveSelection=function(){return n.__awaiter(this,void 0,r.default,function(){var t,r,i,s;return n.__generator(this,function(n){switch(n.label){case 0:t=this._selectedKnockoutStoreItems.peek();return[4,Promise.all([new Promise(function(t,n){e(["@ms/items-view/lib/private/operations/demandItems"],t,n)}),new Promise(function(t,n){e(["../../../models/itemsScope/facets/OneDriveItemFacet"],t,n)})])];case 1:r=n.sent(),i=r[0].demandItems,s=r[1].oneDriveItemFacet;return[4,this._itemCacheStore.dispatch(i(function(e){for(var n=0,r=t;n<r.length;n++){var i=r[n][0];e.demandItemFacet(s,i)}}))];case 2:n.sent();return[2,t.map(function(e){return e[1].peek()})]}})})};i.prototype.resolveFirst=function(){return n.__awaiter(this,void 0,r.default,function(){var t,r,i,s,o,u;return n.__generator(this,function(n){switch(n.label){case 0:if(!(t=this._selectedKnockoutStoreItems.peek()[0]))return[2,void 0];r=t[0],i=t[1];return[4,Promise.all([new Promise(function(t,n){e(["@ms/items-view/lib/private/operations/demandItems"],t,n)}),new Promise(function(t,n){e(["../../../models/itemsScope/facets/OneDriveItemFacet"],t,n)})])];case 1:s=n.sent(),o=s[0].demandItems,u=s[1].oneDriveItemFacet;return[4,this._itemCacheStore.dispatch(o(function(e){e.demandItemFacet(u,r)}))];case 2:n.sent();return[2,i.peek()]}})})};i.prototype.clearSelection=function(){this._itemCacheStore.dispatch(h.clearSelection({itemsScopeItemKey:this._itemsScopeItemKey}))};i.prototype.selectAll=function(){};return i}(i.default);t.ItemsScopeItemSelectionHelper=v;t.typeResourceKey=s.createResolvedTypeResourceKey(e("module").id,v,n.__assign({},i.default.dependencies,{itemCacheStore:a.resourceKey,itemCacheObservablesFactory:o.resourceKey,itemsScopeItemKey:u.resourceKey}))});
define("odsp-next/models/itemsScope/facets/KnockoutStoreItemFacet",["require","exports","@ms/items-view/lib/private/models/itemCache/ComputedItemFacet","../controls/ItemKeyToStoreKeyControl","./OdspNextAppFacets","../controls/KnockoutStoreItemControl"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.knockoutStoreItemFacet=new n.ComputedItemFacet("knockoutStoreItem",function(e,t){var n=t.itemKey,o=e.demandItemFacet(r.itemKeyToStoreKeyControl,i.odspNextAppItemKey),u=r.itemKeyToStoreKeyControl.evaluate(o)(e,{itemKey:n,viewParams:{}}).storeKey;if(void 0!==u){var a=e.demandItemFacet(s.knockoutStoreItemControl,i.odspNextAppItemKey),f=s.knockoutStoreItemControl.evaluate(a)(e,{}).getItem;if(f)return f(u.key)}})});
define("odsp-next/controls/base/react/WithKnockoutStoreItem",["require","exports","tslib","react","@ms/items-view/lib/private/components/decorators/connectToItemCache","./WithKnockoutComputed","../../../models/itemsScope/facets/KnockoutStoreItemFacet"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.withKnockoutStoreItem=function(e){return function(t){var u=t;return i.connectToItemCache(function(e,t){return{storeItem:e.demandItemFacet(o.knockoutStoreItemFacet,t.itemKey)}})(function(t){var i=t.storeItem,o=s.useObservableValue(i),a=s.useObservable(o);return r.createElement(u,n.__assign({},t,e(a,t)))})}};t.withKnockoutStoreItems=function(){return function(e){var t=e;return i.connectToItemCache(function(e,t){return{items:t.itemKeys.map(function(t){return e.demandItemFacet(o.knockoutStoreItemFacet,t)})}})(t)}}});
define("odsp-next/actions/itemsScope/LaunchMovePanelAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchMovePanelAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.LaunchMoveCopyPanelAction))({isMove:!0})})});
define("odsp-next/actions/itemsScope/LaunchCopyPanelAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchCopyPanelAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.LaunchMoveCopyPanelAction))({isMove:!1})})});
define("odsp-next/actions/itemsScope/PreviewAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PreviewAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.PreviewAction))})});
define("odsp-next/actions/itemsScope/ToggleInfoPaneAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout","../../utilities/features/Features"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ToggleInfoPaneAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowPropertiesAction))({useToggleBehavior:!0,allowMultiSelect:i.isFeatureEnabled(i.SPListBulkEditItemProperties)})},{isToggleable:!0})});
define("odsp-next/controls/itemsScope/CommandBar",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","@ms/items-view/lib/private/components/itemsCommandBar/ItemsCommandBar","@ms/items-view/lib/private/components/decorators/withControlHandler","@ms/items-view/lib/private/controls/itemsCommandBarControl","../../bindings/component/ReactControlBinding","office-ui-fabric-react/lib/Fabric","@ms/odsp-shared-react/lib/utilities/resources/Resources","@ms/odsp-utilities/lib/resources/Resources","../operation/commands/OperationCommandBuilder","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-utilities/lib/scope/Scope","../commands/react/ReactCommandManager","./CurrentItemsScope","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view/lib/private/utilities/performance","../../models/itemsScope/ItemsScopeManager.key","./ExtendedCommandBarControl","../../models/itemsScope/facets/OdspNextAppFacets","./ActionControlHandlers","../../utilities/features/Features","@uifabric/fluent-theme/lib/fluent/styles/CommandBar.styles","@uifabric/fluent-theme/lib/fluent/styles/CommandBarButton.styles","../FabricIconsDeferred","./CommandBar.css"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var C={commands:[],farCommands:[],overflowCommands:[]},k=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._itemsCommandBarControlHandler=function(e,t){var n=t.itemKey;if(!e.isItemFacetResolved(g.displayNameFacet,n))return C;var r=e.demandItemFacet(w.extendedCommandBarControl,E.odspNextAppItemKey);return r?w.extendedCommandBarControl.evaluate(r)(e,t):C};r._scope=new d.default;var i=r._scope.attach(new(r.context.dependencies.resources.injected(h.default))({renderLabel:1})).command;r._observables=r._scope.attach(new r.context.dependencies.observablesFactoryType({owner:r}));r._reactCommandManager=r._scope.attach(new r.context.dependencies.reactCommandManagerType({commandSet:{commands:r._observables.createArray([i])}}));r.state={farItems:r._reactCommandManager.commandBarItems.peek().farItems};r._itemsScopeManager=n.dependencies.itemsScopeManager;r._controlHandlers=u.itemsCommandBarControl.pack(r._itemsCommandBarControlHandler);return r}t.prototype.componentDidMount=function(){var e=this;this._observables.subscribe(this._reactCommandManager.commandBarItems,function(t){e.setState({farItems:t.farItems.slice()})});this.props.handleRenderComplete(y.now(),this._itemsScopeManager)};t.prototype.componentWillUnmount=function(){this._scope.dispose()};t.prototype.render=function(){var e=this.context.dependencies,t=e.currentItemsScope,n=e.actionControlHandlers,u=this.state.farItems,a=r.createElement(n,null,r.createElement(o.ControlHandlerProvider,{controlHandlers:this._controlHandlers},r.createElement(t,null,r.createElement("div",{style:{display:"flex"}},r.createElement("div",{style:{display:"block",width:"100%"}},r.createElement(s.ItemsCommandBar,{farItems:u}))))));return x.isFeatureEnabled(x.EnableFluentStyling)?r.createElement(f.Fabric,null,r.createElement(i.Customizer,{scopedSettings:{CommandBar:{styles:T.CommandBarStyles},CommandBarButton:{styles:N.CommandBarButtonStyles}}},a)):r.createElement(f.Fabric,null,a)};t.contextTypes=l.RESOLVED_COMPONENT_CONTEXT_TYPES;return t}(r.PureComponent);t.ItemsScopeCommandBar=k;t.resourceKey=l.createResolvedComponentTypeResourceKey(e("module").id,k,{resources:c.resourceScopeKey,observablesFactoryType:p.observablesFactoryTypeResourceKey,reactCommandManagerType:v.typeResourceKey,currentItemsScope:m.resourceKey.local,itemsScopeManager:b.resourceKey,actionControlHandlers:S.resourceKey});t.knockoutResourceKey=a.createKnockoutResourceKeyFromReactKey(t.resourceKey,{automationName:"ms-items-scope-command-bar",name:e("module").id+".knockout"})});
define("@ms/items-view/lib/private/components/itemsCommandBar/ItemsCommandBar",["require","exports","../decorators/selectors","../decorators/connectToItemCache","../actionCommandBar/ActionCommandBar","../../controls/itemsCommandBarControl","../commands/new/newCommand","../commands/open/openCommand","../commands/upload/uploadCommand","../commands/share/shareCommand","../commands/download/downloadCommand","../commands/rename/renameCommand","../commands/delete/deleteCommand","../commands/showProgress/showProgressCommand","../commands/switchLayout/switchLayoutCommand","../commands/clearSelection/clearSelectionCommand","../../utilities/arrays","../commands/layout/layoutCommand","../../utilities/components/Props","../telemetry/TelemetryProvider","../decorators/afterPageLoad","../commands/follow/followCommand","../../models/itemsScope/getCurrentItemKey","../decorators/connectToItemsScope","../../facets/DemandFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var N=[o.newCommand,a.uploadCommand,u.openCommand,f.shareCommand,f.copyLinkCommand,l.downloadCommand,E.followCommand,h.deleteCommand,c.renameCommand],C=[v.clearSelectionCommand,p.showProgressCommand,d.switchLayoutCommand,g.layoutCommand],k=[],L=[],A=[],O=b.createTelemetryProvider({withContext:{component:"CommandBar"}});t.ItemsCommandBar=y.wrapWithParent(O)(w.withPageLoad()(r.connectToItemCache(function(e,t){var r=S.getCurrentItemKey(e),i=n.getCurrentItemSetKey(e),o=x.getItemsScope(e).itemsScopeItemKey,u=e.isItemFacetResolved(T.errorFacet,o),a=t.commands,f=void 0===a?A:a,l=t.overflowCommands,c=void 0===l?A:l,h=t.farCommands,p=void 0===h?A:h,d=t.shortcutCommands,v=void 0===d?A:d;if(t.hasPageLoaded&&!u){var g=e.demandItemFacet(s.itemsCommandBarControl,r),y=s.itemsCommandBarControl.evaluate(g)(e,{itemKey:r||"",itemSetKey:i,commands:N,farCommands:C,overflowCommands:k,shortcutCommands:L}),b=y.commands,w=y.overflowCommands,E=y.farCommands,O=y.shortcutCommands;return{commands:m.concat(b,f),overflowCommands:m.concat(w,c),farCommands:m.concat(E,p),shortcutCommands:m.concat(O,v)}}return{}})(i.ActionCommandBar)));t.ItemsCommandBar.displayName="ItemsCommandBar"});
define("@ms/items-view/lib/private/components/commands/showProgress/showProgressCommand",["require","exports","react","../../../models/Facet","../../actions/showProgress/ShowProgressAction","../../progress/commandButton/ProgressCommandButton","../Commands.resx","../../keyboard/KeyboardMap.resx"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.showProgressCommand={key:new r.Facet("progress").id,automationId:"showProgressCommand",action:n.createElement(i.ShowProgressAction,null),shortcutProps:{keySequences:["G"],content:u.default.showActionDetailsDesc},ariaLabel:o.default.ShowProgressCommandAriaLabel,commandBarButtonAs:s.ProgressCommandButton}});
define("@ms/items-view/lib/private/components/actions/showProgress/ShowProgressAction",["require","exports","tslib","react","../../action/Action","../../withItemCache/WithItemCache","../../../operations/progress","../../../facets/SetFacets","../../../facets/ProgressFacets","../../../utilities/components/Async","../../decorators/afterPageLoad","../../itemCacheInitializer/ItemCacheInitializer","../../withAction/WithAction"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";var p=this;Object.defineProperty(t,"__esModule",{value:!0});var d=l.afterPageLoad()(f.asAsync(function(){return n.__awaiter(p,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../../DeferredComponents"],t,n)})];case 1:return[2,t.sent().ProgressPanel]}})})})),v=c.createItemCacheInitializer(function(){return o.progressAddon}),m=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(v,null,r.createElement(s.WithItemCache,null,function(e){var t=e.itemCache,n=t.demandItemFacet(u.childItemsFacet,o.progressRootItemKey),s=!1,f=n&&n.itemKeys;if(f)for(var l=0,c=f;l<c.length;l++){var p=c[l];if(o.getOverallProgressPhase(t,{itemKey:p})!==a.ProgressPhase.expired){s=!0;break}}var v=h.renderComponentOnExecute(d);return r.createElement(i.Action,{isAvailable:s,onExecute:v})}))};return t}(r.PureComponent);t.ShowProgressAction=m});
define("@ms/items-view/lib/private/components/itemCacheInitializer/ItemCacheInitializer",["require","exports","tslib","react","../decorators/connectToItemCache","../../utilities/components/RenderProps"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createItemCacheInitializer=function(e,t){var o=function(r){n.__extends(i,r);function i(){return null!==r&&r.apply(this,arguments)||this}i.prototype.render=function(){return s.renderChildrenWithProps(this.props.children,{})};i.prototype.componentDidMount=function(){if(e){var t=this.props,r=t.itemCacheDispatch,i=n.__rest(t,["itemCacheDispatch"]);r(e({props:i,previousProps:void 0}))}};i.prototype.componentDidUpdate=function(t){t.itemCacheDispatch;var r=n.__rest(t,["itemCacheDispatch"]);if(e){var i=this.props,s=i.itemCacheDispatch,o=n.__rest(i,["itemCacheDispatch"]);s(e({props:o,previousProps:r}))}};i.prototype.componentWillUnmount=function(){if(t){var e=this.props,r=e.itemCacheDispatch,i=n.__rest(e,["itemCacheDispatch"]);r(t({props:i}))}};return i}(r.PureComponent);return i.connectToItemCache()(o)}});
define("@ms/items-view/lib/private/components/progress/commandButton/ProgressCommandButton",["require","exports","tslib","react","react-dom","prop-types","../../../controls/progressControl","../../../operations/progress","@uifabric/utilities/lib/css","office-ui-fabric-react/lib/Layer","./ProgressCommandButton.scss","../ProgressStrings.resx","@ms/utilities-strings/lib/index","../../../utilities/objects","../../decorators/connectToItemCache","../../../facets/ProgressFacets","../../../facets/SetFacets","@uifabric/utilities/lib/Async","../../../controls/progressCommandControl","../../withItemCache/WithItemCache","../../decorators/afterPageLoad","../../../utilities/components/Async"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var S,x=this,T=w.afterPageLoad()(E.asAsync(function(){return n.__awaiter(x,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../../actions/DeferredActions"],t,n)})];case 1:return[2,t.sent().ProgressCallout]}})})})),N={started:"Sync",completed:"CheckMark",failed:"StatusErrorFull",canceled:"Sync"},C=((S={})[v.ProgressPhase.started]=function(e){return h.format(h.getLocalizedCountValue(c.default.genericStartedItemsTitle,c.default.genericCompletedItemsTitleIntervals,e)||"",e)},S[v.ProgressPhase.completed]=function(e){return h.format(h.getLocalizedCountValue(c.default.genericCompletedItemsTitle,c.default.genericCompletedItemsTitleIntervals,e)||"",e)},S[v.ProgressPhase.failed]=function(e){return h.format(h.getLocalizedCountValue(c.default.genericFailedItemsTitle,c.default.genericFailedItemsTitleIntervals,e)||"",e)},S[v.ProgressPhase.canceled]=function(e){return h.format(h.getLocalizedCountValue(c.default.genericFailedItemsTitle,c.default.genericFailedItemsTitleIntervals,e)||"",e)},S),k=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.state={status:t.status,percentComplete:t.percentComplete};n._async=new g.Async(n);n._updateStatus=n._async.throttle(function(){n.setState({status:n.props.status,percentComplete:n.props.percentComplete})},500,{leading:!1,trailing:!0});n._updatePercentComplete=n._async.throttle(function(){n.setState({status:n.props.status,percentComplete:n.props.percentComplete})},1e4,{leading:!1,trailing:!0});return n}t.prototype.render=function(){var e=this.state,t=e.status,n=e.percentComplete;return r.createElement(f.Layer,null,r.createElement("span",{className:l.accessibleStatus,role:"status","aria-live":"polite","aria-atomic":"true"},t," ",function(e){if("number"==typeof e)return h.formatWithLocalizedCountValue(c.default.percentCompletedDescription,c.default.percentCompletedDescriptionIntervals,Math.round(100*e));return c.default.genericStartedIndeterminateDescription}(n)))};t.prototype.componentDidUpdate=function(e){e.status!==this.props.status?this._updateStatus():e.percentComplete!==this.props.percentComplete&&this._updatePercentComplete()};t.prototype.componentWillUnmount=function(){this._async.dispose()};return t}(r.PureComponent);var L=d.connectToItemCache()(function(e){var t=e.finishedPinnedItemKeys,n=e.finishedHiddenItemKeys,i=e.itemCacheDispatch,s=function(e,t){var n=r.useRef(),i=n.current;n.current=e;var s=r.useRef(),o=r.useState({})[1];e!==i&&e&&(s.current=e);r.useEffect(function(){if(e){var n=setTimeout(function(){s.current=void 0;o({})},t);return function(){clearTimeout(n)}}},[e]);return s.current}(function(e){var t=r.useRef(),n=t.current;t.current=e;var i=r.useRef(),s=i.current||(i.current={}),o=r.useRef(),u=o.current;if(e!==n){for(var a=void 0,f={},l=0,c=e;l<c.length;l++){var h=c[l];f[h]=!0;s[h]||(a=h)}i.current=f;(a||u&&!f[u])&&(o.current=a)}return o.current}(t),3e3),a=r.useRef();a.current=e.doNotExpire;var f=s||e.currentItemKey,l=r.useRef(),c=l.current;l.current=s;r.useEffect(function(){var e;c&&!a.current&&i(u.expireProgressItems({items:(e={},e[c]=!0,e)}))},[s]);r.useEffect(function(){n.length>0&&!a.current&&i(u.expireProgressItems({items:p.makeObject(n,function(){return!0})}))},[n]);var h=r.useCallback(function(t){var n,i,s,a=t.itemCache;if(f){var l=a.demandItemFacet(o.progressControl,f),c=u.getItemCountsByProgressPhase(a,{itemKey:f}),h=u.getOverallSimpleProgressBreakdown(a,{itemKey:f}),p=h.phase,d=h.count,v=o.progressControl.evaluate(l)(a,{itemKey:f,itemCountsByPhase:c,title:C[p](d),percentComplete:(n=c,i=n.created+n.started+n.completed+n.failed,s=n.completed+n.failed,i>0?s/i:void 0),showTitle:!0,format:"summary"}),m=v.title,g=v.percentComplete,y=v.showTitle;return r.createElement(r.Fragment,null,y?r.createElement("div",null,m):null,e.isMeasured?null:r.createElement(k,{status:m,percentComplete:g}))}return null},[f]);return r.createElement(b.WithItemCache,null,h)}),A=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n._onDismiss=function(){n.setState({doNotExpire:!1})};n._onClick=function(e){n.setState({doNotExpire:!0});var t=n.props.onClick;t&&t(e)};n.state={root:null,doNotExpire:!1};return n}t.prototype.render=function(){var e,t=this.props,i=t.iconName,s=t.isStarted,o=t.finishedCalloutProgressItemKeys,u=t.finishedPinnedProgressItemKeys,f=t.finishedHiddenProgressItemKeys,c=(t.children,t.defaultRender),h=(t.progressTitle,t.progressPercentComplete,n.__rest(t,["iconName","isStarted","finishedCalloutProgressItemKeys","finishedPinnedProgressItemKeys","finishedHiddenProgressItemKeys","children","defaultRender","progressTitle","progressPercentComplete"])),p=this.state.root;return c?r.createElement(c,n.__assign({},h,{onClick:this._onClick,iconProps:{iconName:i,className:a.css((e={},e[l.created]=s,e))}}),r.createElement(L,{isMeasured:this.context.isMeasured,currentItemKey:this.props.currentItemKey,doNotExpire:this.state.doNotExpire,finishedPinnedItemKeys:u,finishedHiddenItemKeys:f}),p?r.createElement(T,{target:p,onViewAll:this._onClick,onDismiss:this._onDismiss,isExecuting:this.props.isExecuting,doNotExpire:this.state.doNotExpire,finishedItemKeys:o}):null):null};t.prototype.componentDidMount=function(){this.context.isMeasured||this.setState({root:i.findDOMNode(this)})};t.contextTypes={isMeasured:s.any};return t}(r.PureComponent);t.ProgressCommandButton=d.connectToItemCache(function(e,t){for(var n=t.actionState,r=e.demandItemFacet(m.childItemsFacet,u.progressRootItemKey),i=r&&r.itemKeys||[],s=void 0,o=[],a=[],f=[],l=e.demandItemFacet(y.progressCommandControl,void 0),c=y.progressCommandControl.evaluate(l)(e,{}).summaryControlHandler,h=0,p=i;h<p.length;h++){var d=p[h],g=u.getOverallProgressPhase(e,{itemKey:d}),b=e.demandItemFacet(y.progressCommandSummaryControl,d),w=y.progressCommandSummaryControl.evaluate(b,c)(e,{itemKey:d,reportMode:y.ProgressSummaryReportMode.callout}).reportMode;switch(g){case v.ProgressPhase.created:case v.ProgressPhase.started:s=d;break;case v.ProgressPhase.completed:w===y.ProgressSummaryReportMode.callout?a.push(d):w===y.ProgressSummaryReportMode.pin?f.push(d):o.push(d);break;case v.ProgressPhase.failed:a.push(d);break;case v.ProgressPhase.canceled:case v.ProgressPhase.expired:}}var E=u.getOverallSimpleProgressBreakdown(e,{itemKey:u.progressRootItemKey}).phase;return{iconName:N[E]||"Sync",isStarted:"started"===E,currentItemKey:s,finishedCalloutProgressItemKeys:a,finishedPinnedProgressItemKeys:f,finishedHiddenProgressItemKeys:o,isExecuting:!!n&&n.executingCount>0}})(A)});
define("@ms/items-view/lib/private/components/progress/commandButton/ProgressCommandButton.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".created_d87c1c86{-webkit-animation:spin_d87c1c86 1100ms infinite linear;animation:spin_d87c1c86 1100ms infinite linear}@-webkit-keyframes spin_d87c1c86{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spin_d87c1c86{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.closeButton_d87c1c86{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.accessibleStatus_d87c1c86{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}\n"}]);t.created="created_d87c1c86";t.spin="spin_d87c1c86";t.closeButton="closeButton_d87c1c86";t.accessibleStatus="accessibleStatus_d87c1c86"});
define("@ms/items-view/lib/private/controls/progressCommandControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ProgressSummaryReportMode={callout:"callout",pin:"pin",none:"none"};t.progressCommandSummaryControl=new n.ControlFacet("progressCommandSummaryControl",{});t.progressCommandControl=new n.ControlFacet("progressCommandControl",{summaryControlHandler:n.childControlOption(t.progressCommandSummaryControl)})});
define("@ms/items-view/lib/private/components/commands/switchLayout/switchLayoutCommand",["require","exports","tslib","react","../../../models/Facet","../../actions/switchLayout/SwitchLayoutAction","../../layouts/DetailsLayoutTypeFacet","../../layouts/TilesLayoutTypeFacet","../Commands.resx"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.switchLayoutCommand={key:new i.Facet("switchLayout").id,automationId:"switchLayoutCommand",title:a.default.SwitchLayoutCommandLabel,ariaLabel:a.default.SwitchLayoutCommandLabel,iconProps:{iconName:"tiles"},postProcess:function(e){var t=e.subMenuProps&&e.subMenuProps.items,r=t&&t.filter(function(e){return e.checked})[0];return n.__assign({},e,t&&1===t.length?{subMenuProps:void 0,disabled:!0}:{},r?{iconProps:r.iconProps}:{})},subMenuProps:{items:[{key:new i.Facet("detailsList").id,automationId:"detailsListCommand",name:a.default.ViewList,title:a.default.ViewListCommandTooltip,action:r.createElement(s.SwitchLayoutAction,{layoutType:o.detailsLayoutType}),iconProps:{iconName:"list"}},{key:new i.Facet("compactDetailsList").id,automationId:"compactDetailsListCommand",name:a.default.ViewCompactList,title:a.default.ViewCompactListCommandTooltip,action:r.createElement(s.SwitchLayoutAction,{layoutType:o.compactDetailsLayoutType}),iconProps:{iconName:"alignleft"}},{key:new i.Facet("tilesList").id,automationId:"tilesListCommand",name:a.default.ViewGrid,title:a.default.ViewGridCommandTooltip,action:r.createElement(s.SwitchLayoutAction,{layoutType:u.tilesLayoutType}),iconProps:{iconName:"viewall"}}]}}});
define("@ms/items-view/lib/private/components/actions/switchLayout/SwitchLayoutAction",["require","exports","tslib","../../../operations/switchLayout","../../../facets/ScopeFacets","../../decorators/connectToItemCache","../../action/Action","../../decorators/connectToItemsScope","../../decorators/selectors","../../../models/telemetry/getItemEngagement","../../../models/Facet","../../../facets/DemandFacets","../../../controls/switchLayoutActionControl"],function(e,t,n,r,i,s,o,u,a,f,l,c,h){"use strict";var p=this;Object.defineProperty(t,"__esModule",{value:!0});t.SwitchLayoutAction=a.withCurrentItemSet()(u.connectToItemsScope()(s.connectToItemCache(function(e,t){var s=t.itemKey,o=t.layoutType,u=t.itemsScopeItemKey,d=e.isItemFacetResolved(c.errorFacet,s)&&!!e.demandItemFacet(c.errorFacet,s),v=e.demandItemFacet(i.availableLayoutsFacet,u)||l.pack({},{}),m=e.demandItemFacet(i.layoutTypeFacet,u),g=m&&v[m.id]&&m||void 0,y=e.demandItemFacet(i.defaultLayoutFacet,u),b=y&&v[y.id]&&y||void 0,w=(g||b)===o,E=e.dispatch,S=e.demandItemFacet(h.switchLayoutActionControl,u),x=h.switchLayoutActionControl.evaluate(S)(e,{}).onSwitchLayout;return n.__assign({isAvailable:!(!s||d||w||!v||!v[o.id]),isToggled:w&&!d},f.getItemActionEngagement(e,{itemKey:a.getItemKey(e,{itemKey:s}),engagement:{name:"SwitchLayout",isIntentional:!0,extraData:{layoutType:o.name}}}),{onExecute:function(){return n.__awaiter(p,void 0,void 0,function(){return n.__generator(this,function(e){E(r.switchLayout({itemsScopeItemKey:u,layoutType:o}));x&&E(x({itemsScopeItemKey:u,layoutType:o}));return[2]})})}})})(o.Action)))});
define("@ms/items-view/lib/private/components/commands/clearSelection/clearSelectionCommand",["require","exports","tslib","react","../../../models/Facet","../../actions/clearSelection/ClearSelectionAction","../../selectionVisibility/SelectionVisibility","../commandBarItemDefaultRender","../../decorators/selectors","./ClearSelectionCommand.resx","@ms/utilities-strings/lib/index"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,i=e.itemKeys,s=e.item,o=n.__rest(e,["defaultRender","itemKeys","item"]);return t?r.createElement(t,n.__assign({},o,{item:n.__assign({},s,{name:l.formatWithLocalizedCountValue(f.default.ClearSelectionCommandText,f.default.ClearSelectionCommandTextIntervals,i.length),ariaLabel:l.formatWithLocalizedCountValue(f.default.ClearSelectionCommandAriaLabel,f.default.ClearSelectionCommandAriaLabelIntervals,i.length)})})):null};return t}(r.PureComponent),h=a.withSelectedItems()(c);t.clearSelectionCommand={key:new i.Facet("clearSelectionCommand").id,iconProps:{iconName:"Clear"},shortcutProps:{content:f.default.ClearSelectionShortcutDesc,keySequences:["CtrlD"]},action:r.createElement(o.ShowOnlyWithSelection,null,r.createElement(s.ClearSelectionAction,null)),onRender:function(e){return r.createElement(h,{item:e,defaultRender:u.commandBarItemDefaultRender})}}});
define("@ms/items-view/lib/private/components/actions/clearSelection/ClearSelectionAction",["require","exports","tslib","react","../../withItemCache/WithItemCache","../../action/Action","../../../operations/selectItems","../../decorators/connectToItemsScope","../../decorators/selectors"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var f=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,u=t.itemKeys,a=t.itemsScopeItemKey;return r.createElement(i.WithItemCache,null,function(t){var i=t.dispatch;return r.createElement(s.Action,{isAvailable:u.length>0,onExecute:function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){i(o.clearSelection({itemsScopeItemKey:a}));return[2]})})}})})};return t}(r.PureComponent);t.ClearSelectionActionBase=f;t.ClearSelectionAction=u.connectToItemsScope()(a.withSelectedItems()(f))});
define("@ms/items-view/lib/private/components/commands/commandBarItemDefaultRender",["require","exports","tslib","react","office-ui-fabric-react/lib/Button","@uifabric/utilities/lib/css"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.commandBarItemDefaultRender=function(e){var t=e.item,o=e.buttonRef,u=n.__rest(e,["item","buttonRef"]),a=t.onClick,f=a?function(e){a(e,t)}:void 0,l=t.text||t.name,c=n.__assign({allowDisabledFocus:!0},t,{styles:n.__assign({root:{height:"100%"}},t.buttonStyles),className:s.css("ms-CommandBarItem-link",t.className),text:t.iconOnly?void 0:l,menuProps:t.subMenuProps,onClick:f});return r.createElement(i.CommandBarButton,n.__assign({ref:o},c,u))}});
define("@ms/items-view/lib/private/components/commands/layout/layoutCommand",["require","exports","tslib","react","../../decorators/selectors","../../../models/Facet","../../actions/setPreferredLayout/SetPreferredLayoutAction","../../commandSet/CommandSet","../../action/Action","../../../facets/ScopeFacets","../../itemsView/ItemsViewBeta","../commandBarItemDefaultRender"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.itemKey;return r.createElement(l.WithItemsView,{itemKey:e},function(e){var t=e.layoutHandlers,n=e.itemsScopeItemKey;if(!e.itemCache.demandItemFacet(f.hasLayoutFacet,n))return r.createElement(a.Action,null);for(var i=0,s=t;i<s.length;i++){var u=s[i],l=u.layout,c=u.key;if(l)return r.createElement(o.SetPreferredLayoutAction,{layoutHandlerKey:c})}return r.createElement(a.Action,null)})};return t}(r.PureComponent),p=i.withCurrentItemSet()(h),d=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.itemKey,i=e.item,s=i.subMenuProps,o=n.__rest(i,["subMenuProps"]),a=e.defaultRender,f=n.__rest(e,["itemKey","item","defaultRender"]);return r.createElement(l.WithItemsView,{itemKey:t},function(e){for(var t,i=[],l=0,c=e.layoutHandlers;l<c.length;l++){var h=c[l],p=h.layout,d=h.command,v=h.key;p&&!t&&(t=d);i.push(m({layoutHandlerKey:v,command:d}))}return r.createElement(u.CommandSet,{commands:i},function(e){var i=e.menuItems;return a?r.createElement(a,n.__assign({},f,{item:n.__assign({},o,t||{},{subMenuProps:i.length>1?n.__assign({},s||{},{items:i.concat(s&&s.items||[])}):void 0,iconOnly:!0,checked:!1,disabled:i.length<=1})})):null})})};return t}(r.PureComponent),v=i.withCurrentItemSet()(d);t.layoutCommand={key:new s.Facet("layout").id,automationId:"layoutCommand",action:r.createElement(p,null),onRender:function(e){return r.createElement(v,{item:e,defaultRender:c.commandBarItemDefaultRender})}};function m(e){var t=e.layoutHandlerKey,i=e.command;return n.__assign({key:t},i,{action:r.createElement(o.SetPreferredLayoutAction,{layoutHandlerKey:t}),canCheck:!0})}});
define("@ms/items-view/lib/private/components/actions/setPreferredLayout/SetPreferredLayoutAction",["require","exports","tslib","react","../../action/Action","../../decorators/selectors","../../itemsView/ItemsViewBeta"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,s=t.itemKey,u=t.layoutHandlerKey;return r.createElement(o.WithItemsView,{itemKey:s},function(t){for(var s,o,a=0,f=t.layoutHandlers;a<f.length;a++){var l=f[a],c=l.layout,h=l.setAsPreferredLayout,p=l.key;c&&!s&&(s=p);p===u&&c&&(o=h);if(s&&o)break}var d=o,v=d?function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){d();return[2]})})}:void 0;return r.createElement(i.Action,{onExecute:v,isToggled:u===s})})};return t}(r.PureComponent);t.ItemSetPreferredLayoutAction=u;t.SetPreferredLayoutAction=s.withCurrentItemSet()(u)});
define("@ms/items-view/lib/private/components/itemsView/ItemsViewBeta",["require","exports","tslib","react","../layoutSwitcher/LayoutSwitcher","../decorators/selectors","../decorators/connectToItemCache","../../utilities/components/Fragment","../decorators/connectToItemsScope","../../operations/getItems","../../facets/ScopeFacets","../../models/Facet","../../utilities/Graft","../../controls/itemsViewBetaControl","./layoutHandlers/detailsLayout","./layoutHandlers/tilesLayout","../../utilities/components/RenderProps","../withItemCache/WithItemCache","../itemsScope/ItemsScope","../../operations/setPreferredLayout","../../utilities/arrays","./layoutHandlers/errorLayout","./layoutHandlers/emptyLayout"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=a.connectToItemsScope()(o.connectToItemCache(void 0,function(e,t){var n=t.itemsScopeItemKey;return{onMount:function(){var t;e(f.resolveItems({items:(t={},t[n]=l.hasLayoutFacet.pack(!0),t)}))},onUnmount:function(){var t;e(f.resolveItems({items:(t={},t[n]=c.pack({hasLayout:l.hasLayoutFacet},{hasLayout:new h.Delete}),t)}))}}})(function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(u.Fragment,null,this.props.children)};t.prototype.componentDidMount=function(){this.props.onMount()};t.prototype.componentWillUnmount=function(){this.props.onUnmount()};return t}(r.PureComponent))),T=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(u.Fragment,null,this.props.children)};return t}(r.PureComponent),N=[d.itemsViewDetailsLayoutHandler,d.itemsViewCompactDetailsLayoutHandler,v.itemsViewTilesLayoutHandler],C=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.itemKey,i=e.children;return r.createElement(y.WithItemsScope,null,function(e){var s=e.itemsScopeItemKey;return r.createElement(g.WithItemCache,null,function(e){var r=e.itemCache,o=e.dispatch,u=function(e,t){var r=t.itemKey,i=t.itemsScopeItemKey,s=t.setPreferredLayout,o=e.demandItemFacet(l.preferredLayoutFacet,i),u=o&&o.layoutHandlerKey,a=e.demandItemFacet(p.itemsViewBetaControl,r),f=p.itemsViewBetaControl.evaluate(a)(e,{itemKey:r,itemsScopeItemKey:i,itemsViewAs:t.itemsViewAs,layoutHandlers:N}),c=f.layoutHandlers,h=f.layoutControlHandler,d=f.itemsViewAs,v=w.findMatch(c,function(e){return e.key===u});return{evaluatedLayoutHandlers:(v?[v.value].concat(c.slice(0,v.index),c.slice(v.index+1)):c).map(function(t){var o=t.controlHandler,u=n.__rest(t,["controlHandler"]),a=u.key,f=p.itemsViewLayoutHandlerControl.evaluate(o,h)(e,{itemKey:r,itemsScopeItemKey:i,layoutHandlerKey:a}).layout;return n.__assign({},u,{layout:f,setAsPreferredLayout:function(){s({itemsScopeItemKey:i,layoutHandlerKey:a})}})}),itemsViewAs:d}}(r,{itemKey:t,itemsScopeItemKey:s,itemsViewAs:T,setPreferredLayout:function(e){o(b.setPreferredLayout(e))}}),a=u.evaluatedLayoutHandlers,f=u.itemsViewAs;return m.renderChildrenWithProps(i,{layoutHandlers:a,itemsViewAs:f,itemCache:r,itemsScopeItemKey:s,dispatch:o})})})};return t}(r.PureComponent);t.WithItemsView=C;var k=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.itemKey;return r.createElement(C,{itemKey:e},function(t){for(var n,s,o=t.layoutHandlers,u=t.itemsViewAs,a=t.itemsScopeItemKey,f=t.itemCache,l=p.itemsViewLayoutHandlerControl.evaluate(E.itemsViewErrorLayoutHandler.controlHandler)(f,{itemKey:e,itemsScopeItemKey:a,layoutHandlerKey:E.itemsViewErrorLayoutHandler.key}).layout,c=p.itemsViewLayoutHandlerControl.evaluate(S.itemsViewEmptyLayoutHandler.controlHandler)(f,{itemKey:e,itemsScopeItemKey:a,layoutHandlerKey:E.itemsViewErrorLayoutHandler.key}).layout,h=0,d=o;h<d.length;h++){var v=d[h],m=v.layout,g=v.key;if(m){n=m;s=g;break}}var y=l||n,b=!l&&c;return r.createElement(x,null,r.createElement(u,{itemKey:e,layoutHandlerKey:s},r.createElement(i.LayoutSwitcher,{layoutKey:s},y?r.createElement(y,{key:"layout",itemKey:e}):null)),b?r.createElement(b,{key:"empty",itemKey:e}):null)})};return t}(r.PureComponent);t.ItemViewBeta=k;t.ItemsViewBeta=s.withCurrentItemSet()(k)});
define("@ms/items-view/lib/private/controls/itemsViewBetaControl",["require","exports","../models/controls/ControlFacet","../components/controls/defaultRenderComponentControlOption"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemsViewLayoutHandlerControl=new n.ControlFacet("itemsViewLayoutControl");t.itemsViewBetaControl=new n.ControlFacet("itemsViewBetaControl",{layoutControlHandler:n.childControlOption(t.itemsViewLayoutHandlerControl),itemsViewAs:r.defaultRenderComponentOption()})});
define("@ms/items-view/lib/private/components/itemsView/layoutHandlers/detailsLayout",["require","exports","tslib","react","../../layouts/DetailsLayoutTypeFacet","../../../utilities/components/Async","../../commands/Commands.resx","../../decorators/connectToSelection","../../../utilities/components/Props","../../decorators/withSelectedItemsContextMenu"],function(e,t,n,r,i,s,o,u,a,f){"use strict";var l=this;Object.defineProperty(t,"__esModule",{value:!0});var c=s.asAsync(function(){return n.__awaiter(l,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../../itemSetDetailsList/ItemSetDetailsList"],t,n)})];case 1:return[2,t.sent().ItemSetDetailsList]}})})}),h=f.withSelectedItemsContextMenu()(c),p=u.withItemSetSelection()(h);function d(e){return r.createElement(p,n.__assign({},e))}var v=a.injectProps(function(){return{compact:!0}})(p);function m(e){return r.createElement(v,n.__assign({},e))}t.itemsViewDetailsLayoutHandler={key:i.detailsLayoutType.id,command:{automationId:"detailsListCommand",name:o.default.ViewList,title:o.default.ViewListCommandTooltip,iconProps:{iconName:"list"}},controlHandler:function(e,t){return{layout:d}}};t.itemsViewCompactDetailsLayoutHandler={key:i.compactDetailsLayoutType.id,command:{automationId:"compactDetailsListCommand",name:o.default.ViewCompactList,title:o.default.ViewCompactListCommandTooltip,iconProps:{iconName:"alignleft"}},controlHandler:function(e,t){return{layout:m}}}});
define("@ms/items-view/lib/private/components/itemsView/layoutHandlers/tilesLayout",["require","exports","tslib","react","../../layouts/TilesLayoutTypeFacet","../../../utilities/components/Async","../../commands/Commands.resx","../../decorators/connectToSelection","../../decorators/withSelectedItemsContextMenu"],function(e,t,n,r,i,s,o,u,a){"use strict";var f=this;Object.defineProperty(t,"__esModule",{value:!0});var l=s.asAsync(function(){return n.__awaiter(f,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../../itemSetTilesList/ItemSetTilesList"],t,n)})];case 1:return[2,t.sent().ItemSetTilesList]}})})}),c=a.withSelectedItemsContextMenu()(l),h=u.withItemSetSelection()(c),p=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(h,n.__assign({},this.props))};return t}(r.PureComponent);t.itemsViewTilesLayoutHandler={key:i.tilesLayoutType.id,command:{automationId:"tilesListCommand",name:o.default.ViewGrid,title:o.default.ViewGridCommandTooltip,iconProps:{iconName:"viewall"}},controlHandler:function(e,t){return{layout:p}}}});
define("@ms/items-view/lib/private/operations/setPreferredLayout",["require","exports","tslib","../store/actions/createActionCreator","../operations/getItems","../facets/ScopeFacets"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.setPreferredLayout=r.createAsyncActionCreator(function(e){var t=e.itemsScopeItemKey,r=e.layoutHandlerKey;return function(e){var o;e(i.resolveItems({items:(o={},o[t]=n.__assign({},s.preferredLayoutFacet.pack({layoutHandlerKey:r})),o)}))}})});
define("@ms/items-view/lib/private/components/itemsView/layoutHandlers/errorLayout",["require","exports","tslib","react","../../../models/Facet","../../../facets/DemandFacets","../../itemsError/ItemError"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.itemKey;return e?r.createElement(o.ItemError,{itemKey:e}):null};return t}(r.PureComponent);t.itemsViewErrorLayoutHandler={key:new i.Facet("itemsViewErrorLayout").id,command:{},controlHandler:function(e,t){var n=t.itemKey;return(e.isItemFacetResolved(s.errorFacet,n)?e.demandItemFacet(s.errorFacet,n):void 0)?{layout:u}:{}}}});
define("@ms/items-view/lib/private/components/itemsView/layoutHandlers/emptyLayout",["require","exports","tslib","react","../../../models/Facet","../../../facets/SetFacets","../../itemsEmptyFolder/ItemEmptyFolder"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.itemKey;return e?r.createElement(o.ItemEmptyFolder,{itemKey:e}):null};return t}(r.PureComponent);t.itemsViewEmptyLayoutHandler={key:new i.Facet("itemsViewEmptyLayout").id,command:{},controlHandler:function(e,t){var n=t.itemKey,r=e.isItemFacetResolved(s.childItemsFacet,n)?e.demandItemFacet(s.childItemsFacet,n):void 0;return!!r&&!!r.itemKeys&&0===r.itemKeys.length?{layout:u}:{}}}});
define("odsp-next/controls/itemsScope/CommandBar.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".od-TopBar-commandBar{padding:0!important}.isFluent .od-TopBar-commandBar .ms-Button--commandBar .ms-Button-menuIcon{background-color:inherit}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot{position:relative;border-bottom:2px solid transparent;color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot .ms-Button-label:after{transition:all .1s ease-in-out}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";border-bottom:2px solid transparent}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot:active{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";border-bottom:2px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view,.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled{border-bottom:2px solid transparent}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view:hover,.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";border-bottom:2px solid transparent}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view:hover .ms-Button-label:after,.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled:hover .ms-Button-label:after{width:100%;left:0}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view .ms-Button-label,.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled .ms-Button-label{font-weight:600}.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view .ms-Button-label:after,.isFluent .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled .ms-Button-label:after{content:'';display:block;position:absolute;left:8px;border-bottom:2px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";bottom:-2px;width:calc(100% - (8px + 8px))}.od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view,.od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled,.od-TopBar-commandBar .ms-CommandBar button.is-pivot:active,.od-TopBar-commandBar .ms-CommandBar button.is-pivot:hover{border-bottom:2px solid "},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-current-view,.od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-toggled{font-weight:600}[dir=ltr] .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-last-pivot{margin-right:24px}[dir=rtl] .od-TopBar-commandBar .ms-CommandBar button.is-pivot.is-last-pivot{margin-left:24px}.od-TopBar-commandBar .ms-CommandBar button.is-toggled{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#dadada"},{rawString:";color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}.od-TopBar.od--hasSelection .ms-CommandBar{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";transition:background-color 467ms cubic-bezier(.1,.9,.2,1)}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:";transition:none}.od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:";transition:background-color 467ms cubic-bezier(.1,.9,.2,1)}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar{color:"},{theme:"neutralPrimary",defaultValue:"#333333"},{rawString:";background-color:inherit;transition:none}.od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar:hover{background-color:"},{theme:"neutralQuaternary",defaultValue:"#d0d0d0"},{rawString:"}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar:hover{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar.is-toggled{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#dadada"},{rawString:"}.od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar.is-toggled:hover{background-color:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c8c8"},{rawString:"}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar:active{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#dadada"},{rawString:"}.isFluent .od-TopBar.od--hasSelection .ms-CommandBar .ms-Button--commandBar.is-expanded:hover{color:"},{theme:"neutralDark",defaultValue:"#212121"},{rawString:";background-color:"},{theme:"neutralQuaternary",defaultValue:"#d0d0d0"},{rawString:"}"}])});
define("odsp-next/controls/itemsScope/od/ItemsContextMenuController",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.extendedItemsContextMenuControlHandler=n.createControlHandler()(function(){return function(e){return r}});function r(e,t){return{contextMenuOverride:void 0}}});
define("odsp-next/controls/itemsScope/od/ItemsCommandBarController",["require","exports","tslib","@ms/items-view/lib/private/addons/registerControlHandler","../ItemsScopeCommands","@ms/items-view/lib/private/components/commands/new/newCommand","@ms/items-view/lib/private/components/commands/open/openCommand","@ms/items-view/lib/private/components/commands/delete/deleteCommand","@ms/items-view/lib/private/components/commands/rename/renameCommand"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.extendedItemsCommandBarControlHandler=r.createControlHandler()(function(){return function(e){return f}});function f(e,t){var n=t.commands,r=t.farCommands,f=t.overflowCommands,c=[];n&&(c=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var f=r[n];if(f.key===s.newCommand.key)t.push(l(f));else if(f.key===o.openCommand.key){t.push(i.surveyCommand);t.push(i.openFileCommand);t.push(i.OpenInTextEditorCommand)}else if(f.key===u.deleteCommand.key)t.push(f,i.createMountPointCommand,i.removeMountPointCommand,i.moveToCommand,i.copyToCommand);else if(f.key===a.renameCommand.key){t.push(f);t.push(i.rotateCommand,i.orderPrintsCommand,i.embedCommand,i.versionHistoryCommand,i.reportAbuseCommand)}else t.push(f)}return t}(n));var h=[];r&&h.push.apply(h,r);h.push(i.detailsCommand);var p=[];f&&p.push.apply(p,f);return{commands:c,farCommands:h,overflowCommands:p}}function l(e){if(e.key!==s.newCommand.key)return e;var t=e;e.subMenuProps&&e.subMenuProps.items&&e.subMenuProps.items.length>0&&(t=n.__assign({},e,{subMenuProps:n.__assign({},e.subMenuProps,{items:e.subMenuProps.items.concat([i.createWordCommand,i.createExcelCommand,i.createPowerPointCommand,i.createOneNoteCommand,i.createExcelSurveyCommand,i.createTextFileCommand])})}));return t}});
define("odsp-next/controls/itemsScope/ItemsScopeCommands",["require","exports","tslib","react","../commands/Commands.resx","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../../actions/itemsScope/EditNewMenuAction","../../actions/itemsScope/LaunchCopyPanelAction","../../actions/itemsScope/LaunchMovePanelAction","../../actions/itemsScope/ShowInfoPaneAction","../../actions/itemsScope/CancelEditAction","../../actions/itemsScope/QuickEditAction","../../actions/itemsScope/LaunchContentCenterCreateModelPanelAction","../../actions/itemsScope/LaunchPublishModelPanelAction","../../actions/itemsScope/OpenInPowerBIAction","../../actions/itemsScope/ToggleFiltersPaneAction","../../actions/itemsScope/AddToQuickLaunchAction","../../actions/itemsScope/OpenInOfficeOnlineAction","../../actions/itemsScope/OpenInOfficeClientAction","../../actions/itemsScope/OpenInSharePointAction","../../actions/itemsScope/OpenInExplorerAction","../../actions/itemsScope/UploadAction","../../actions/itemsScope/PreviewAction","../../actions/itemsScope/ReportAbuseAction","../../actions/itemsScope/MakeHomePageAction","../../actions/itemsScope/FileRequestAction","../../actions/itemsScope/RotateAction","../../actions/itemsScope/OrderPrintsAction","../../actions/itemsScope/EmbedAction","../../actions/itemsScope/SurveyActions","../../actions/itemsScope/CreateShortcutAction","../../actions/itemsScope/CreateDocumentAction","../../actions/itemsScope/ListActions","../../actions/itemsScope/MoreAction","../../actions/itemsScope/MountPointActions","../../actions/itemsScope/LaunchFormatViewPaneAction","../../actions/itemsScope/TeamChannelAction","../../actions/itemsScope/ApproveRejectAction","../../actions/itemsScope/CheckInAction","../../experiments/splightspeed/actions/FullscreenAction","@ms/items-view-addon-sp/lib/commands/NewDocumentTemplateCommands","@ms/items-view/lib/private/components/commands/getCommandIconProps","../../actions/itemsScope/ManageAccessAction","../../actions/itemsScope/NavigateToQueryRootAction","../../dataSources/url/QueryType","../../utilities/sharing/SharingHelper","@ms/items-view/lib/private/components/scope/commands/commands.resx","@ms/items-view/lib/private/facets/CommandFacets","@ms/items-view/lib/private/components/commands/open/openCommand","./spo/ItemsScopePLTCommands","../commands/itemsScope/DetailsCommand","../commands/itemsScope/OpenInTextEditorCommand"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var Z={iconName:void 0,styles:{root:{display:"none!important"}}};t.alertMeCommand=Q.alertMeCommand;t.manageAlertCommand=Q.manageAlertCommand;t.versionHistoryCommand=Q.versionHistoryCommand;t.powerAppsCommand=Q.powerAppsCommand;t.aibuilderCommand=Q.aibuilderCommand;t.detailsCommand=G.detailsCommand;t.detailsMenuCommand={key:new s.Facet("Details").id,name:i.strings.Details,ariaLabel:i.strings.DetailsPane,action:r.createElement(l.ShowInfoPaneAction,null)};t.filtersPaneCommand={key:new s.Facet("FiltersPane").id,action:r.createElement(m.ToggleFiltersPaneAction,null),title:i.strings.FiltersPane,ariaLabel:i.strings.FiltersPane,iconProps:{iconName:"Filter"}};t.moveToCommand={key:new s.Facet("MoveTo").id,name:i.strings.Move,action:r.createElement(o.ShowOnlyWithSelection,null,r.createElement(f.LaunchMovePanelAction,null)),iconProps:{iconName:"FabricMoveToFolder"}};t.copyToCommand={key:new s.Facet("CopyTo").id,name:i.strings.Copy,action:r.createElement(o.ShowOnlyWithSelection,null,r.createElement(a.LaunchCopyPanelAction,null)),iconProps:{iconName:"Copy"}};t.quickEditCommand={key:new s.Facet("QuickEdit").id,name:i.strings.EditAll,action:r.createElement(h.LaunchQuickEditAtion,null),iconProps:{iconName:"Edit"}};t.cancelEditCommand={key:new s.Facet("CancelEdit").id,name:i.strings.cancelEdit,action:r.createElement(c.LaunchCancelEditAtion,null),iconProps:{iconName:"CheckMark"}};t.copyFieldCommand={key:new s.Facet("CopyField").id,name:i.strings.CopyField,action:r.createElement(D.CopyFieldAction,null),hasLaunchTarget:!0};t.EditItemCommand={key:new s.Facet("EditProperties").id,name:i.strings.editProperties,action:r.createElement(D.EditItemAction,null),iconProps:{iconName:"Edit"}};t.ViewItemCommand={key:new s.Facet("ViewProperties").id,name:i.strings.Open,action:r.createElement(D.ViewItemAction,null)};t.ViewDocumentPropertyCommand={key:new s.Facet("ViewProperties").id,name:i.strings.viewProperties,action:r.createElement(D.ViewItemAction,null)};t.makeHomePageCommand={key:new s.Facet("MakeHomePage").id,name:i.strings.MakeHomepage,action:r.createElement(N.MakeHomePageAction,null),iconProps:{iconName:"Home"}};t.rotateCommand={key:new s.Facet("rotate").id,name:i.strings.rotate,action:r.createElement(k.RotateAction,null),iconProps:{iconName:"rotate"}};t.orderPrintsCommand={key:new s.Facet("orderPrints").id,name:i.strings.OrderPrints,action:r.createElement(L.OrderPrintsAction,null),iconProps:{iconName:"Print"}};t.embedCommand={key:new s.Facet("embed").id,automationId:"embed",name:i.strings.Embed,action:r.createElement(A.EmbedAction,null),iconProps:{iconName:"Embed"}};t.createMountPointCommand={key:new s.Facet("createMountPoint").id,automationId:"createMountPoint",name:i.strings.CreateMountPoint,action:r.createElement(H.CreateMountPointAction,null),iconProps:{iconName:"OneDriveAdd"}};t.removeMountPointCommand={key:new s.Facet("removeMountPoint").id,name:i.strings.RemoveMountPoint,action:r.createElement(H.RemoveMountPointAction,null),iconProps:{iconName:"Cancel"}};t.reportAbuseCommand={key:new s.Facet("reportAbuse").id,name:i.strings.reportAbuse,action:r.createElement(T.ReportAbuseAction,null),iconProps:{iconName:"EditNote"}};t.approveRejectCommand={key:new s.Facet("ApproveReject").id,name:i.strings.ApproveReject,action:r.createElement(F.ApproveRejectAction,null),iconProps:Z};t.previewCommand={key:new s.Facet("Preview").id,name:i.strings.Preview,action:r.createElement(x.PreviewAction,null)};t.WorkflowCommand={key:new s.Facet("Workflow").id,name:i.strings.Workflow,action:r.createElement(P.WorkflowAction,null)};t.ComplianceDetailsCommand={key:new s.Facet("ComplianceDetails").id,name:i.strings.ComplianceDetails,action:r.createElement(P.ComplianceDetailsAction,null)};t.EditRenditionsCommand={key:new s.Facet("EditRenditions").id,name:i.strings.EditRenditions,action:r.createElement(P.EditRenditionsAction,null)};t.PublishCommand={key:new s.Facet("Publish").id,name:i.strings.Publish,action:r.createElement(P.PublishAction,null)};t.UnPublishCommand={key:new s.Facet("UnPublish").id,name:i.strings.UnPublish,action:r.createElement(P.UnPublishAction,null)};t.CancelPublishCommand={key:new s.Facet("CancelApproval").id,name:i.strings.CancelApproval,action:r.createElement(P.CancelApprovalAction,null)};t.CreateShortcutCommand={key:new s.Facet("Link").id,name:i.strings.CreateShortcut,action:r.createElement(o.HideWithSelection,null,r.createElement(M.CreateShortcutAction,null)),iconProps:{iconName:"Globe"}};t.contentCenterCreateNewModelCommand={key:new s.Facet("CreateNewModel").id,name:i.strings.StartTrainingButtonText,action:r.createElement(o.ShowOnlyWithSelection,null,r.createElement(p.LaunchContentCenterCreateModelPanelAction,null)),iconProps:{iconName:"ChevronRight"}};t.contentCenterPublishModelCommand={key:new s.Facet("PublishModel").id,name:i.strings.PublishModel,action:r.createElement(o.ShowOnlyWithSelection,null,r.createElement(d.LaunchPublishModelPanelAction,null)),iconProps:{iconName:"Market"}};t.createWordCommand={key:new s.Facet("createWord").id,automationId:"createWordCommand",name:$.default.CreateWord,action:r.createElement(o.HideWithSelection,null,r.createElement(_.CreateWordAction,null)),iconProps:U.getCommandIconProps({extension:"docx",size:16})};t.createExcelCommand={key:new s.Facet("createExcel").id,automationId:"createExcelCommand",name:$.default.CreateExcel,action:r.createElement(o.HideWithSelection,null,r.createElement(_.CreateExcelAction,null)),iconProps:U.getCommandIconProps({extension:"xlsx",size:16})};t.createPowerPointCommand={key:new s.Facet("createPowerPoint").id,automationId:"createPowerPointCommand",name:$.default.CreatePowerPoint,action:r.createElement(o.HideWithSelection,null,r.createElement(_.CreatePowerPointAction,null)),iconProps:U.getCommandIconProps({extension:"pptx",size:16})};t.createOneNoteCommand={key:new s.Facet("createOneNote").id,automationId:"createOneNoteCommand",name:$.default.CreateOneNote,action:r.createElement(o.HideWithSelection,null,r.createElement(_.CreateOneNoteAction,null)),iconProps:U.getCommandIconProps({extension:"onetoc",size:16})};t.createExcelSurveyCommand={key:new s.Facet("createExcelSurvey").id,automationId:"createExcelSurveyCommand",name:$.default.CreateExcelSurvey,action:r.createElement(o.HideWithSelection,null,r.createElement(_.CreateExcelSurveyAction,null)),iconProps:U.getCommandIconProps({extension:"xlsx",size:16})};t.createTextFileCommand={key:new s.Facet("createTextFile").id,name:i.strings.CreateText,action:r.createElement(o.HideWithSelection,null,r.createElement(_.CreateTextFileAction,null)),iconProps:U.getCommandIconProps({extension:"txt",size:16})};t.shareSurveyCommand={key:new s.Facet("shareSurvey").id,name:i.strings.shareSurvey,action:r.createElement(o.HideWithSelection,null,r.createElement(O.ShareSurveyAction,null)),iconProps:Z};t.viewSurveyCommand={key:new s.Facet("viewSurvey").id,name:i.strings.viewSurvey,action:r.createElement(o.HideWithSelection,null,r.createElement(O.ViewSurveyAction,null)),iconProps:Z};t.editSurveyCommand={key:new s.Facet("editSurvey").id,name:i.strings.editSurvey,action:r.createElement(o.HideWithSelection,null,r.createElement(O.EditSurveyAction,null)),iconProps:Z};t.surveyCommand={key:new s.Facet("survey").id,name:"Survey",subMenuProps:{items:[t.shareSurveyCommand,t.viewSurveyCommand,t.editSurveyCommand]},iconProps:Z};t.OpenInPowerBICommand={key:new s.Facet("OpenInPowerBI").id,name:i.strings.OpenInPowerBI,action:r.createElement(v.OpenInPowerBIAction,null),iconProps:{iconName:"PowerBILogo16"}};t.AddToQuickLaunchCommand={key:new s.Facet("AddToQuickLaunch").id,name:i.strings.AddToQuickLaunch,action:r.createElement(g.AddToQuickLaunch,null),iconProps:{iconName:"Pin"}};t.OpenInTextEditorCommand=Y.openInTextEditorCommand;t.OpenInExplorerCommand={key:new s.Facet("OpenInExplorer").id,name:i.strings.OpenInExplorer,action:r.createElement(E.OpenInExplorerAction,null),iconProps:Z};t.OpenInSharePointCommand={key:new s.Facet("OpenInSharePoint").id,name:i.strings.OpenInSharePoint,action:r.createElement(o.HideWithSelection,null,r.createElement(w.OpenInSharePointAction,null)),iconProps:{iconName:"SharepointLogo"}};t.openInOfficeOnlineCommand={key:new s.Facet("openInOfficeOnline").id,automationId:"openInOfficeOnlineCommand",name:"##Localized_OpenInOfficeOnline##",action:r.createElement(y.OpenInOfficeOnlineAction,null),facets:n.__assign({},J.isReadonlyFacet.pack(!0))};t.openInOfficeClientCommand={key:new s.Facet("openInOfficeClient").id,automationId:"openInOfficeClientCommand",name:"##Localized_OpenInOfficeClient##",action:r.createElement(b.OpenInOfficeClientAction,null),facets:n.__assign({},J.isReadonlyFacet.pack(!0))};t.openFileCommand={key:K.openCommand.key,automationId:K.openCommand.automationId,name:"##Localized_Open##",subMenuProps:{items:[t.openInOfficeOnlineCommand,t.openInOfficeClientCommand]},facets:n.__assign({},J.isReadonlyFacet.pack(!0))};t.launchFormatViewPaneCommand={key:new s.Facet("LaunchFormatViewPane").id,name:i.strings.FormatView,action:r.createElement(o.HideWithSelection,null,r.createElement(B.LaunchFormatViewPaneAction,null)),iconProps:Z};t.TeamChannelCommand={key:new s.Facet("TeamChannel").id,name:i.strings.Channel,action:r.createElement(j.TeamChannelAction,null),iconProps:{iconName:"TeamsLogo"}};t.EditNewMenuCommand={key:R.editNewMenuKey,name:i.strings.editNewMenu,action:r.createElement(o.HideWithSelection,null,r.createElement(u.EditNewMenuAction,null)),iconProps:{iconName:"Edit"}};t.CheckInCommand={key:new s.Facet("CheckIn").id,name:i.strings.CheckIn,action:r.createElement(I.CheckInAction,null),iconProps:{iconName:"ArrowDownRight8"}};t.UploadFileCommand={key:new s.Facet("UploadFile").id,name:i.strings.UploadFile,action:r.createElement(o.HideWithSelection,null,r.createElement(S.UploadFileAction,null))};t.UploadFolderCommand={key:new s.Facet("UploadFolder").id,name:i.strings.UploadFolder,action:r.createElement(o.HideWithSelection,null,r.createElement(S.UploadFolderAction,null))};t.FileRequestCommand={key:new s.Facet("FileRequest").id,name:i.strings.CreateFileRequest,action:r.createElement(C.FileRequestAction,null),iconProps:{iconName:"FileRequest"}};t.ManageAccessCommand={key:new s.Facet("ManageAccess").id,name:i.strings.ManageAccess,action:r.createElement(o.ShowOnlyWithSelection,null,r.createElement(z.ManageAccessAction,null)),iconProps:{iconName:"PlayerSettings"}};t.NavigateToSharedWithMeCommand={key:new s.Facet("NavigateToSharedWithMe").id,name:V.isShareByWithYouEnabled()?i.strings.SharedWithYou:i.strings.SharedWithMe,action:r.createElement(W.NavigateToQueryRootAction,{queryType:X.default.SharedWithMe}),isPermanent:!0};t.NavigateToSharedByMeCommand={key:new s.Facet("NavigateToSharedByMe").id,name:V.isShareByWithYouEnabled()?i.strings.SharedByYou:i.strings.SharedByMe,action:r.createElement(W.NavigateToQueryRootAction,{queryType:X.default.SharedByMe}),isPermanent:!0};t.FullscreenCommand={action:q.FullscreenAction,key:new s.Facet("FullscreenMode").id,commandBarButtonAs:function(e){var t=e.defaultRender,s=e.actionState&&e.actionState.isToggled;return t?r.createElement(t,n.__assign({},e,{iconProps:{iconName:s?"BackToWindow":"FullScreen"},title:s?i.strings.collapseContent:i.strings.expandContent})):null}}});
define("odsp-next/actions/itemsScope/EditNewMenuAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EditNewMenuAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.EditNewMenuAction))({templates:[]})})});
define("odsp-next/actions/itemsScope/ShowInfoPaneAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShowInfoPaneAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowPropertiesAction))({useToggleBehavior:!1})},{isToggleable:!1})});
define("odsp-next/actions/itemsScope/CancelEditAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchCancelEditAtion=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.CancelEditAction))})});
define("odsp-next/actions/itemsScope/QuickEditAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchQuickEditAtion=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.EditAction))})});
define("odsp-next/actions/itemsScope/LaunchContentCenterCreateModelPanelAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchContentCenterCreateModelPanelAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.LaunchContentCenterCreateModelPanelAction))({})})});
define("odsp-next/actions/itemsScope/LaunchPublishModelPanelAction",["require","exports","tslib","react","@ms/items-view/lib/private/components/decorators/connectToItemCache","@ms/items-view/lib/private/components/withAction/WithAction","@ms/items-view/lib/private/components/wizardAction/WizardAction","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view/lib/private/models/telemetry/getItemEngagement","@ms/items-view/lib/private/utilities/async/CancelError","@ms/items-view/lib/private/components/withItemCache/WithItemCache","../../controls/contentCenterPublishModelPanel/ContentCenterPublishModelPanel","../../controls/base/react/WithResources","@ms/items-view-addon-sp/lib/dataSource/Facets","@ms/items-view-addon-sp/lib/dataSource/Keys","@ms/items-view/lib/private/facets/ItemFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,n=t.reject,i=t.resolve,s=t.itemKey,o=function(){n(new f.CancelError)},u=function(e){e&&i()};return r.createElement(l.WithItemCache,null,function(t){var n=t.itemCache,i=n.demandItemFacet(p.uniqueIdFacet,s),a=n.demandItemFacet(v.displayNameFacet,s),f=n.demandItemFacet(d.spItemKeyFacet,s);return i&&a?r.createElement(c.default,{resources:e.props.resources,modelDisplayName:a,siteAbsoluteUrl:f?f.webAbsoluteUrl:"",selectedModelId:i,onDismiss:o,onPublish:u}):null})};return t}(r.PureComponent),g=h.withResources()(m);t.ItemLaunchPublishModelPanelAction=i.connectToItemCache(function(e,t){var i=t.itemKey;return i?{action:r.createElement(o.WizardAction,n.__assign({isAvailable:!0},a.getItemActionEngagement(e,{itemKey:i,engagement:{name:"LaunchPublishModelPanel",isIntentional:!0}})),function(e){return i&&r.createElement(g,n.__assign({},e,{itemKey:i}))})}:{action:null}})(s.ActionSelector);t.LaunchPublishModelPanelAction=u.withSelectedItems()(u.withExactlyOneItem()(t.ItemLaunchPublishModelPanelAction))});
define("@ms/items-view/lib/private/components/wizardAction/WizardAction",["require","exports","tslib","../../utilities/components/RenderProps","../decorators/withWizard","react"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.children,i=n.__rest(e,["children"]);return r.renderChildrenWithProps(t,i)};return t}(s.Component);t.WizardAction=i.withWizard()(o);t.BackgroundAction=i.withWizard(void 0,{isBackgroundTask:!0})(o);t.HeadlessAction=i.withWizard(void 0,{isBackgroundTask:!0,backgroundTaskScope:"headless"})(o)});
define("odsp-next/controls/contentCenterPublishModelPanel/ContentCenterPublishModelPanel",["require","exports","tslib","react","office-ui-fabric-react/lib/Panel","office-ui-fabric-react/lib/Button","office-ui-fabric-react/lib/TextField","office-ui-fabric-react/lib/Label","../../dataSources/contentCenter/spo/ContentCenterDataSource","office-ui-fabric-react/lib/Spinner","@ms/odsp-utilities/lib/logging/ErrorHelper","./ContentCenterPublishModelPanel.resx","./ContentCenterPublishModelPanel.css"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){n.__extends(t,e);function t(t){var n=e.call(this,t)||this;n.onRenderFooterContent=function(){return r.createElement("div",null,r.createElement(s.PrimaryButton,{onClick:n.onPublishClick,className:"LeftElement",disabled:n.state.isPublishing},c.strings.PublishText),r.createElement(s.DefaultButton,{onClick:n.props.onDismiss},c.strings.CancelText))};n.onPublishClick=function(){if(n.publishRequest.targetSiteUrl&&""!==n.publishRequest.targetSiteUrl)if(n.publishRequest.targetLibrary&&""!==n.publishRequest.targetLibrary)if(n.selectedModelId&&""!==n.selectedModelId){n.setState({isPublishing:!0});n.contentCenterDataSource.publishModel(n.selectedModelId,n.publishRequest.targetSiteUrl,n.publishRequest.targetLibrary,"").then(function(e){n.setState({isPublishing:!1});e?n.props.onPublish(!0):l.default.log("[ccui] create model api call failed")}).catch(function(e){l.default.log("[ccui] publish model api call failed"+e.message);n.setState({isPublishing:!1,generalErrorMessage:e.message})})}else n.setState({generalErrorMessage:c.strings.SelectedModelInvalidText});else n.setState({targetLibraryErrorMessage:c.strings.TargetLibraryEmptyErrorText});else n.setState({targetSiteUrlErrorMessage:c.strings.TargetSiteUrlEmptyErrorText})};n.getDefaultLibUrl=function(){return{targetSiteUrl:n.props.siteAbsoluteUrl,targetLibrary:"Prime"}};n.resources=t.resources;n.contentCenterDataSource=n.resources.consume(a.resourceKey);n.publishRequest=n.getDefaultLibUrl();n.state={isPublishing:!1,targetLibraryErrorMessage:"",targetSiteUrlErrorMessage:"",generalErrorMessage:"",selectedModelName:t.modelDisplayName};n.selectedModelId=t.selectedModelId;return n}t.prototype.render=function(){var e=this;return r.createElement(i.Panel,{headerText:"Publish "+this.state.selectedModelName+" to",onRenderFooterContent:this.onRenderFooterContent,onDismiss:this.props.onDismiss,isOpen:!0,isLightDismiss:!0,type:i.PanelType.smallFixedFar},r.createElement("div",{className:"ContentCenterPublishModelPanel-bottomMargin"},r.createElement(o.TextField,{multiline:!0,rows:3,label:c.strings.TargetSiteUrlLabel,errorMessage:this.state.targetSiteUrlErrorMessage,required:!0,value:this.publishRequest.targetSiteUrl,onChange:function(t,n){e.publishRequest.targetSiteUrl=n},placeholder:"e.g. "+this.publishRequest.targetSiteUrl})),r.createElement("div",{className:"ContentCenterPublishModelPanel-bottomMargin"},r.createElement(o.TextField,{label:c.strings.TargetLibraryLabel,errorMessage:this.state.targetLibraryErrorMessage,required:!0,value:this.publishRequest.targetLibrary,onChange:function(t,n){e.publishRequest.targetLibrary=n},placeholder:"e.g. "+this.publishRequest.targetLibrary})),r.createElement("div",{className:"ContentCenterPublishModelPanel-bottomMargin"},r.createElement(u.Label,{className:"ErrorTextStyle"},this.state.generalErrorMessage)),this.state.isPublishing&&r.createElement(f.Spinner,{size:f.SpinnerSize.small,ariaLive:"assertive",labelPosition:"right",label:c.strings.PublishingText}))};return t}(r.Component);t.default=h});
define("odsp-next/dataSources/contentCenter/spo/ContentCenterDataSource",["require","exports","tslib","../../url/odb/ApiUrlHelper","../../base/odb/DataSource","@ms/odsp-utilities/lib/resources/Resources","../../../resources/SPOResourceKeys","@ms/odsp-shared/lib/utilities/navigation/Navigation.key"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){n.__extends(t,e);function t(t,n){var r=e.call(this,n.pageContext)||this;r._apiUrlHelper=n.apiUrlHelper;r._navigation=n.navigation;r._pageContext=n.pageContext;return r}t.prototype.getWebFields=function(e){var t=e+"/_api/web/fields?$select=Id,Title&$filter=(Hidden eq false) and (ReadOnlyField eq false) and (TypeDisplayName ne 'Managed Metadata') and (Group ne '_Hidden')";return this.getData(function(){return t.toString()},function(e){return JSON.parse(e).value},"getWebFields",function(){return""},"GET",{accept:"application/json","content-type":"application/json"})};t.prototype.getSiteContentTypes=function(e,t,n,r){void 0===r&&(r="Intelligent Document Content Types");var i=e.substr(0,e.indexOf(t)),s=i.replace("https://",""),o=i+"/_api/V2.0/sites/"+s+","+(n=n.replace("{","").replace("}",""))+"/ContentTypes";return this.getData(function(){return o.toString()},function(e){var t=JSON.parse(e).value;r&&(t=t.filter(function(e){return e.group===r}));return t},"getSiteContentTypes",function(){return""},"GET",{accept:"application/json","content-type":"application/json"})};t.prototype.createOrUpdateModel=function(e,t,n,r,i){void 0===i&&(i="Intelligent Document Content Types");var s={__metadata:{type:"Microsoft.Office.Server.ContentCenter.SPMachineLearningModelEntityData"},ColumnId:r,ColumnName:n,ContentTypeGroup:i,ContentTypeId:t,ContentTypeName:e},o=this._apiUrlHelper.build().segment("machinelearning").segment("models");return this.getData(function(){return o.toString()},function(e){return JSON.parse(e)},"createContentTypeAndModel",function(){return JSON.stringify(s)},"POST")};t.prototype.navigateToTrainingPage=function(e){var t=[];t.push(this._pageContext.webAbsoluteUrl);t.push(this._pageContext.layoutsUrl);t.push("training.aspx");var n=t.join("/")+e;this._navigation.navigateTo(n)};t.prototype.publishModel=function(e,t,n,r){var i="";try{var s=t.substring(0,t.lastIndexOf("/")).lastIndexOf("/");i=t.substring(s)}catch(e){throw new Error("url format invalid")}var o={__metadata:{type:"Microsoft.Office.Server.ContentCenter.SPMachineLearningPublicationsEntityData"},Publications:{results:[{ModelUniqueId:e,TargetSiteUrl:t,TargetWebServerRelativeUrl:i,TargetLibraryServerRelativeUrl:i+"/"+n}]},Comment:r},u=this._apiUrlHelper.build().segment("machinelearning").segment("publications");return this.getData(function(){return u.toString()},function(e){return 0===JSON.parse(e).d.TotalFailures},"publishContentCenterModel",function(){return JSON.stringify(o)},"POST").catch(function(e){var t="";if(e&&e.message&&e.message.value){t=e.message.value;e.correlationId&&(t=t+" correlationId: "+e.correlationId)}else t=JSON.stringify(e);return Promise.reject(new Error(t))})};t.dependencies={pageContext:o.pageContext,apiUrlHelper:r.resourceKey,navigation:u.navigation};return t}(i.default);t.default=a;t.resourceKey=s.createResolvedResourceKey(e("module").id,a)});
define("odsp-next/controls/contentCenterPublishModelPanel/ContentCenterPublishModelPanel.css",["@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t){e.loadStyles([{rawString:".ContentCenterPublishModelPanel-bottomMargin{margin-bottom:10px}.ErrorTextStyle{color:"},{theme:"redDark",defaultValue:"#a80000"},{rawString:"}.LeftElement{margin-right:8px}"}])});
define("@ms/items-view-addon-sp/lib/dataSource/Keys",["require","exports","@ms/items-view/lib/private/models/KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.needsAttentionViewId="f9ebc8b2-a976-48f0-a8fa-0846164c0466";t.spWebKeyFacet=new n.KeyFacet("spWeb",{webAbsoluteUrl:n.stringPart()});t.spItemKeyFacet=new n.KeyFacet("spItem",{webAbsoluteUrl:n.stringPart(),listFullUrl:n.stringPart(),itemId:n.stringPart({shouldNormalizeToEmpty:!0}),rootFolder:n.stringPart({shouldNormalizeToEmpty:!0})});t.spItemFullUrlKeyFacet=new n.KeyFacet("spItemFullUrl",{itemFullUrl:n.stringPart()});t.spListKeyFacet=new n.KeyFacet("spList",{webAbsoluteUrl:n.stringPart(),listFullUrl:n.stringPart()});t.spListViewsSetKeyFacet=new n.KeyFacet("spListViews",{webAbsoluteUrl:n.stringPart(),listFullUrl:n.stringPart()});t.spFieldKeyFacet=new n.KeyFacet("spField",{internalName:n.stringPart()});t.spColumnAdapterKeyFacet=new n.KeyFacet("spColumnAdapter",{internalName:n.stringPart()});t.spViewKeyFacet=new n.KeyFacet("spView",{viewId:n.stringPart()});t.likedByItemKeyFacet=new n.KeyFacet("likedByItem",{spItem:n.subKeyPart(t.spItemKeyFacet)});t.spPageContextKeyFacet=new n.KeyFacet("spPageContext",{webAbsoluteUrl:n.stringPart(),listFullUrl:n.stringPart()});t.spWebPageContextKeyFacet=new n.KeyFacet("spWebPageContext",{webAbsoluteUrl:n.stringPart()});t.spPageContextForDataRequestorKeyFacet=new n.KeyFacet("spPageContextForDataRequestor",{webAbsoluteUrl:n.stringPart()});t.spFolderItemSetKeyFacet=new n.KeyFacet("spFolderItemSet",{webAbsoluteUrl:n.stringPart(),listFullUrl:n.stringPart(),rootFolder:n.stringPart(),sortFieldKey:n.stringPart(),sortAscending:n.booleanPart(),filterParams:n.stringPart(),groupByFieldKey:n.stringPart(),disableGrouping:n.booleanPart(),viewKey:n.subKeyPart(t.spViewKeyFacet),viewPath:n.stringPart(),extFilters:n.arrayPart(n.stringPart())});t.spSearchItemSetKeyFacet=new n.KeyFacet("spSearchItemSet",{webAbsoluteUrl:n.stringPart(),listFullUrl:n.stringPart(),rootFolder:n.stringPart(),sortFieldKey:n.stringPart(),sortAscending:n.booleanPart(),filterParams:n.stringPart(),groupByFieldKey:n.stringPart(),disableGrouping:n.booleanPart(),viewKey:n.subKeyPart(t.spViewKeyFacet),viewPath:n.stringPart(),extFilters:n.arrayPart(n.stringPart()),searchTerm:n.stringPart()});t.spFolderMediaGroupingItemSetKeyFacet=new n.KeyFacet("spFolderMediaGroupingItemSet",{spFolderItemSet:n.subKeyPart(t.spFolderItemSetKeyFacet)});t.spFolderMediaGroupingItemSetGroupKeyFacet=new n.KeyFacet("spFolderMediaGroupingItemSetGroup",{spFolderItemSet:n.subKeyPart(t.spFolderItemSetKeyFacet),group:n.stringPart()});t.spFolderMediaGroupingItemSetPageKeyFacet=new n.KeyFacet("spFolderMediaGroupingItemSetPage",{spFolderItemSet:n.subKeyPart(t.spFolderItemSetKeyFacet),pageKey:n.stringPart()});t.spItemSetKeyFacet=new n.KeyFacet("spItemSet",{parentItemKey:n.subKeyPart(t.spItemKeyFacet),sortFieldKey:n.stringPart(),sortAscending:n.booleanPart(),filterParams:n.stringPart(),groupByFieldKey:n.stringPart(),viewKey:n.subKeyPart(t.spViewKeyFacet)});t.spNeedsAttentionItemKeyFacet=new n.KeyFacet("spNeedsAttentionItem",{webAbsoluteUrl:n.stringPart(),listFullUrl:n.stringPart()});t.spItemGroupKeyFacet=new n.KeyFacet("spItemGroup",{groupId:n.stringPart(),itemSetKey:n.subKeyPart(t.spFolderItemSetKeyFacet),viewKey:n.subKeyPart(t.spViewKeyFacet)});t.spPersonKeyFacet=new n.KeyFacet("spPerson",{id:n.stringPart()});t.spItemPageKeyFacet=new n.KeyFacet("spItemPage",{itemSetKey:n.subKeyPart(t.spFolderItemSetKeyFacet),token:n.stringPart()});t.spFolderItemSetPagingTokenKeyFacet=new n.KeyFacet("spFolderItemSetPagingTokenKeyFacet",{itemSetKey:n.subKeyPart(t.spFolderItemSetKeyFacet),currentFirstRow:n.numberPart()});t.spItemTokenGroupPageKeyFacet=new n.KeyFacet("spItemTokenGroupPage",{itemSetKey:n.subKeyPart(t.spFolderItemSetKeyFacet),parentGroupKey:n.stringPart(),token:n.stringPart()});t.spItemNextGroupPageKeyFacet=new n.KeyFacet("spItemNextGroupPage",{itemSetKey:n.subKeyPart(t.spFolderItemSetKeyFacet),lastGroupKey:n.stringPart(),nextGroupXml:n.stringPart(),nextGroupLevel:n.numberPart(),filterParams:n.stringPart(),token:n.stringPart()});t.spFilterOptionSetKeyFacet=new n.KeyFacet("spFilterOptionSet",{itemSetKey:n.subKeyPart(t.spFolderItemSetKeyFacet),fieldKey:n.subKeyPart(t.spFieldKeyFacet)});t.spLookupItemKeyFacet=new n.KeyFacet("spLookupItem",{fieldName:n.stringPart(),lookupId:n.stringPart()});t.spListContentTypeKeyFacet=new n.KeyFacet("spListContentType",{listKey:n.subKeyPart(t.spListKeyFacet),contentTypeId:n.stringPart()});t.spFolderContentTypeKeyFacet=new n.KeyFacet("spFolderContentTypeOrder",{folderKey:n.subKeyPart(t.spItemKeyFacet),contentTypeId:n.stringPart()});t.spNewDocumentTemplateKeyFacet=new n.KeyFacet("spNewDocumentTemplateKeyFacet",{listKey:n.subKeyPart(t.spListKeyFacet),templateUrl:n.stringPart()});t.spContentTypeCreateDocumentActionKeyFacet=new n.KeyFacet("spContentTypeCreateDocumentAction",{listKey:n.subKeyPart(t.spListKeyFacet),templateUrl:n.stringPart()});t.spContentTypeNavigationActionKeyFacet=new n.KeyFacet("spContentTypeNavigationActionKeyFacet",{listKey:n.subKeyPart(t.spListKeyFacet),contentTypeId:n.stringPart()});t.spPinnedItemSetKeyFacet=new n.KeyFacet("spPinnedItemSetKeyFacet",{parentItemKey:n.subKeyPart(t.spItemKeyFacet),viewKey:n.subKeyPart(t.spViewKeyFacet)});t.spGridInitInfoKeyFacet=new n.KeyFacet("spGridInitInfoKeyFacet",{listKey:n.subKeyPart(t.spListKeyFacet),viewKey:n.subKeyPart(t.spViewKeyFacet)});t.customActionKeyFacet=new n.KeyFacet("customActionKeyFacet",{actionId:n.stringPart()});t.customActionSetKeyFacet=new n.KeyFacet("customActionSetKeyFacet",{webAbsoluteUrl:n.stringPart(),listFullUrl:n.stringPart(),spfxLoaded:n.booleanPart(),itemsScopeItemKey:n.stringPart()});t.legacyCustomActionSetKeyFacet=new n.KeyFacet("legacyCustomActionSetKeyFacet",{webAbsoluteUrl:n.stringPart(),listFullUrl:n.stringPart(),spfxLoaded:n.booleanPart(),itemsScopeItemKey:n.stringPart()});t.tenantAppCustomActionSetKeyFacet=new n.KeyFacet("tenantAppCustomActionSetKeyFacet",{webAbsoluteUrl:n.stringPart(),listFullUrl:n.stringPart(),spfxLoaded:n.booleanPart(),itemsScopeItemKey:n.stringPart()});t.contextMenuCustomActionSetKeyFacet=new n.KeyFacet("contextMenuCustomActionSetKeyFacet",{webAbsoluteUrl:n.stringPart(),listFullUrl:n.stringPart()});t.clientSideExtensionsKeyFacet=new n.KeyFacet("clientSideExtensionsKeyFacet",{webAbsoluteUrl:n.stringPart(),listFullUrl:n.stringPart()});t.spHomeContextKeyFacet=new n.KeyFacet("spHomeContextKeyFacet",{tenantRootUrl:n.stringPart()});t.spAllSitesKeyFacet=new n.KeyFacet("spAllSitesKeyFacet",{tenantRootUrl:n.stringPart()});t.spFollowedSitesItemSetKeyFacet=new n.KeyFacet("spFollowedSitesItemSet",{tenantRootUrl:n.stringPart()});t.spFrequentSitesItemSetKeyFacet=new n.KeyFacet("spFrequentSitesItemSet",{tenantRootUrl:n.stringPart()});t.spLibrariesItemSetKeyFacet=new n.KeyFacet("spLibrariesItemSet",{webAbsoluteUrl:n.stringPart()});t.spOneDriveKeyFacet=new n.KeyFacet("oneDrive",{tenantRootUrl:n.stringPart()});t.spOneDriveDocumentLibraryKeyFacet=new n.KeyFacet("oneDriveDocumentLibrary",{tenantRootUrl:n.stringPart()});t.spTenantKeyFacet=new n.KeyFacet("spTenantKeyFacet",{tenantRootUrl:n.stringPart()});t.followedItemKeyFacet=new n.KeyFacet("followedItemKeyFacet",{endpoint:n.stringPart()});t.spPeoplePickerDataSourceKeyFacet=new n.KeyFacet("spPeoplePickerDataSource",{webAbsoluteUrl:n.stringPart(),listFullUrl:n.stringPart()});t.businessNavSetKeyFacet=new n.KeyFacet("businessNavSet",{tenantRootUrl:n.stringPart()});t.oneDriveNavSetKeyFacet=new n.KeyFacet("oneDriveNavSet",{tenantRootUrl:n.stringPart()});t.pinnedItemKeyFacet=new n.KeyFacet("pinnedItem",{rootItemKey:n.stringPart(),itemKey:n.stringPart()});t.spOneDriveSharedKeyFacet=new n.KeyFacet("spOneDriveShared",{});t.spOneDriveDiscoverKeyFacet=new n.KeyFacet("spOneDriveDiscover",{});t.spOneDriveRecyleBinKeyFacet=new n.KeyFacet("spOneDriveRecyleBin",{})});
define("odsp-next/actions/itemsScope/OpenInPowerBIAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInPowerBIAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OpenInPowerBIAction))})});
define("odsp-next/actions/itemsScope/ToggleFiltersPaneAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ToggleFiltersPaneAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowFiltersAction))},{isToggleable:!0})});
define("odsp-next/actions/itemsScope/AddToQuickLaunchAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AddToQuickLaunch=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.AddToQuickLaunchAction))})});
define("odsp-next/actions/itemsScope/OpenInOfficeOnlineAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInOfficeOnlineAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OpenInOfficeOnlineAction))})});
define("odsp-next/actions/itemsScope/OpenInOfficeClientAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInOfficeClientAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OpenInOfficeClientAction))})});
define("odsp-next/actions/itemsScope/OpenInSharePointAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInSharePointAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OpenInSharePointAction))})});
define("odsp-next/actions/itemsScope/OpenInExplorerAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInExplorerAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OpenInExplorerAction))})});
define("odsp-next/actions/itemsScope/UploadAction",["require","exports","@ms/odsp-datasources/lib/dataSources/upload/UploadProcessorType","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.UploadFileAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.UploadAction))({uploadProcessorType:n.UploadProcessorType.Html5file})});t.UploadFolderAction=i.createItemsScopeActionFromKnockout(function(e){var t=e.consume(r.actionMap);return new(e.injected(t.UploadAction))({uploadProcessorType:n.UploadProcessorType.Folder})})});
define("odsp-next/actions/itemsScope/ReportAbuseAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ReportAbuseAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ReportAbuseAction))})});
define("odsp-next/actions/itemsScope/MakeHomePageAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MakeHomePageAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.MakeHomepageAction))})});
define("odsp-next/actions/itemsScope/FileRequestAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.FileRequestAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.CreateFileRequestAction))})});
define("odsp-next/actions/itemsScope/RotateAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.RotateAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.RotateAction))})});
define("odsp-next/actions/itemsScope/OrderPrintsAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OrderPrintsAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OrderPrintsAction))})});
define("odsp-next/actions/itemsScope/EmbedAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EmbedAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.EmbedAction))})});
define("odsp-next/actions/itemsScope/SurveyActions",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ShareSurveyAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SurveyAction))({actionType:1})});t.ViewSurveyAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SurveyAction))({actionType:2})});t.EditSurveyAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.SurveyAction))({actionType:3})})});
define("odsp-next/actions/itemsScope/CreateShortcutAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateShortcutAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.LaunchCreateShortcutPanel))})});
define("odsp-next/actions/itemsScope/CreateDocumentAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout","@ms/odsp-datasources/lib/interfaces/list/DocumentType"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){return function(t){var r=t.consume(n.actionMap);return new(t.injected(r.CreateDocumentAction))({docType:e})}};t.CreateWordAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.Word));t.CreateExcelAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.Excel));t.CreatePowerPointAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.PowerPoint));t.CreateOneNoteAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.OneNote));t.CreateExcelSurveyAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.ExcelSurvey));t.CreateTextFileAction=r.createItemsScopeActionFromKnockout(s(i.DocumentType.Text))});
define("odsp-next/actions/itemsScope/ListActions",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CopyFieldAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.CopyFieldAction))});t.EditItemAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.EditItemAction))});t.ViewItemAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ViewItemAction))})});
define("odsp-next/actions/itemsScope/MoreAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.WorkflowAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.WorkflowAction))});t.ComplianceDetailsAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ComplianceDetailsAction))});t.EditRenditionsAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.EditRenditionsAction))});t.PublishAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.PublishAction))});t.UnPublishAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.UnPublishAction))({unPublishType:0})});t.CancelApprovalAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.UnPublishAction))({unPublishType:1})})});
define("odsp-next/actions/itemsScope/MountPointActions",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CreateMountPointAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.CreateMountPointAction))});t.RemoveMountPointAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.RemoveMountPointAction))})});
define("odsp-next/actions/itemsScope/LaunchFormatViewPaneAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LaunchFormatViewPaneAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.LaunchFormatViewPaneAction))})});
define("odsp-next/actions/itemsScope/TeamChannelAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TeamChannelAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.LaunchTeamChannelAction))})});
define("odsp-next/actions/itemsScope/ApproveRejectAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ApproveRejectAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ApproveRejectAction))})});
define("odsp-next/actions/itemsScope/CheckInAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CheckInAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.CheckInAction))})});
define("odsp-next/experiments/splightspeed/actions/FullscreenAction",["require","exports","tslib","react","@ms/items-view/lib/private/components/action/Action","../context/SPOAppContextProvider"],function(e,t,n,r,i,s){"use strict";var o=this;Object.defineProperty(t,"__esModule",{value:!0});t.FullscreenAction=s.createComponentWithSPOAppContext([s.ContextKeys.pageControls])(function(e){var t=e.pageControls.isFullscreen;return r.createElement(i.Action,{isToggled:t,engagement:{isIntentional:!0,name:t?"FullscreenListOff":"FullscreenListOn"},onExecute:function(){return n.__awaiter(o,void 0,void 0,function(){var r;return n.__generator(this,function(n){e.handleContextDataChange(((r={})[s.ContextKeys.pageControls]={isFullscreen:!t},r));return[2]})})}})})});
define("odsp-next/experiments/splightspeed/context/SPOAppContextProvider",["require","exports","tslib","@ms/items-view/lib/private/utilities/Graft","@ms/utilities-objects/lib/areShallowEqual","react","../utilities/browser/ResponsiveUI","./ContextKeys","./SPOAppContextItems","./SPOAppContextHandler"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ContextKeys=u;var l=s.createContext({}),c=function(e){n.__extends(t,e);function t(t){var r=e.call(this,t)||this;r._isDisposed=!1;r._handleContextChange=function(e){if(!r._isDisposed){var t=r.state,i=t.contextData,s=t.handleContextDataChange,o=p(i,e);if(!o)return null;r.setState({contextData:o,handleContextDataChange:s},function(){r._contextHandler.notifyUpdate(n.__assign({},o))})}};r._contextHandler=t.resources.consume(f.resourceKey);r._setContextInitState();return r}t.prototype.componentDidMount=function(){this._contextHandler.registerContextChangeHandler(this._handleContextChange);this._contextHandler.notifyUpdate(n.__assign({},this.state.contextData))};t.prototype.componentWillUnmount=function(){this._isDisposed=!0;this._stopListener&&this._stopListener()};t.prototype.render=function(){return s.createElement(l.Provider,{value:this.state},this.props.children)};t.prototype._setContextInitState=function(){var e=this,t=this.props.resources,r=t.consume(o.resourceKey);this._stopListener=r.listen(function(t){var r;e._handleContextChange(((r={})[u.responsiveUIMetrics]=n.__assign({},t),r))});this.state={contextData:a.createSPOAppContextData(t),handleContextDataChange:this._handleContextChange}};return t}(s.PureComponent);t.SPOAppContextProvider=c;function h(e,t){for(var n=t.contextData,r={handleContextDataChange:t.handleContextDataChange},i=[],s=0,o=e;s<o.length;s++){var u=o[s],a=n[u].data;r[u]=a;i.push(a)}return{pickedContext:r,contextDeps:i}}t.pickContextItems=h;t.createComponentWithSPOAppContext=function(e){return function(t){return function(r){var i=s.useContext(l),o=h(e,i),u=o.pickedContext,a=o.contextDeps,f=t;return s.useMemo(function(){return s.createElement(f,n.__assign({},u,r))},a.concat([r]))}}};function p(e,t){var n={},s=!1;for(var o in t){var u=e[o],f=u.data,l=t[o],c=void 0;switch(u.updateMethod){case a.ContextItemUpdateMethod.READONLY:throw'Read-only SPOAppContextItem "'+o+'" cannot be updated';case a.ContextItemUpdateMethod.REPLACE:c=l;break;case a.ContextItemUpdateMethod.PATCH:default:c=r.graft(f,l)}if(i.areShallowDifferent(f,c)){s=!0;n[o]={data:new r.ReplacePatch(c)};u.onChange&&u.onChange(f,c)}}return s?r.graft(e,n):null}t.createNewContextData=p});
define("odsp-next/experiments/splightspeed/utilities/browser/ResponsiveUI",["require","exports","tslib","@ms/odsp-utilities/lib/events/EventGroup","../../dataSources/base/Listenable","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={Small:"sm",Medium:"md",Large:"lg",XLarge:"xlg",XXLarge:"xxlg",XXXLarge:"xxxlg",XXXXLarge:"xxxxlg"},u={Small:480,Medium:640,Large:1024,XLarge:1366,XXLarge:1920,XXXLarge:2560,XXXXLarge:1/0};t.breakpointsResourceKey=new s.ResourceKey({name:e("module").id+".breakpoints",factory:new s.ConstantResourceFactory(u)});var a=function(e){n.__extends(i,e);function i(t,n){var i=e.call(this)||this;i._onContainerResize=function(e){var t=i._containerElement,n=document.body,r=document.documentElement,s=t.clientWidth||r.clientWidth||t.innerWidth||n.clientWidth,o=t.clientHeight||r.clientHeight||t.innerHeight||n.clientHeight,a=i._computeFormFactorSize(i._breakpoints,s),f=i._computeCssClass(a),l=i._computeShowLabels(a),c=i._computeIsHamburgerVisible(s),h={DEFAULT_BREAKPOINTS:u,MAC_SCROLL_BAR_WIDTH:8,windowWidth:s,windowHeight:o,formFactorSize:a,showLabels:l,isHamburgerVisible:c,cssClass:f};i.setData(h)};var s=t.containerElement,o=void 0===s?window:s,a=n.breakpoints;i._containerElement=o;i._breakpoints=a;i._event=new r.default(i);i._event.on(i._containerElement,"resize, orientationchange",i._onContainerResize);i._onContainerResize();return i}Object.defineProperty(i.prototype,"metrics",{get:function(){return this.readData()},enumerable:!0,configurable:!0});i.reduceBreakpoints=function(e,t){return{Small:t,Medium:e.Small,Large:e.Medium,XLarge:e.Large,XXLarge:e.XLarge,XXXLarge:e.XXLarge,XXXXLarge:1/0}};i.determineWindowSize=function(e,t){void 0===t&&(t=u);if(0===e)return"Medium";for(var n in u)if(e<t[n])return n};i.determineCssClass=function(e){return o[e]};i.getScrollbarWidth=function(){var e=document.createElement("div"),t=e.style;t.visibility="hidden";t.width="100px";t.msOverflowStyle="scrollbar";document.body.appendChild(e);var n=e.offsetWidth;t.overflow="scroll";var r=document.createElement("div");r.style.width="100%";e.appendChild(r);var i=r.offsetWidth;e.parentNode.removeChild(e);var s=n-i;this.getScrollbarWidth=function(){return s};return s};i.prototype.compareSize=function(e,t){var n=this._breakpoints;return n[e]-n[t]};i.prototype._computeFormFactorSize=function(e,t){return this._containerElement===window?i.determineWindowSize(t,e):"Medium"};i.prototype._computeCssClass=function(e){return i.determineCssClass(e)};i.prototype._computeShowLabels=function(e){return this.compareSize(e,"Medium")>0};i.prototype._computeIsHamburgerVisible=function(e){return e<u.Large};i.dependencies={breakpoints:t.breakpointsResourceKey};return i}(i.Listenable);t.ResponsiveUI=a;t.resourceKey=s.createResolvedResourceKey(e("module").id,a)});
define("odsp-next/experiments/splightspeed/dataSources/base/Listenable",["require","exports","@ms/items-view/lib/private/utilities/Graft"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._listeners=[]}e.prototype.readData=function(){return this._data};e.prototype.listen=function(e){var t=this;this._listeners.indexOf(e)<0&&this._listeners.push(e);return function(){var n=t._listeners.indexOf(e);n>=0&&t._listeners.splice(n,1)}};e.prototype.setData=function(e){this._data=this._data||{};var t=n.graft(this._data,e);this._data=t;for(var r=0,i=this._listeners;r<i.length;r++){(0,i[r])(this._data)}};e.prototype.refresh=function(){};return e}();t.Listenable=r});
define("odsp-next/experiments/splightspeed/context/ContextKeys",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.pageContext="pageContext";t.legacyMode="legacyMode";t.viewParams="viewParams";t.responsiveUIMetrics="responsiveUIMetrics";t.itemsScopeCurrentItemKey="itemsScopeCurrentItemKey";t.resources="resources";t.paneControls="paneControls";t.pageControls="pageControls";t.hotMainComponent="hotMainComponent"});
define("odsp-next/experiments/splightspeed/context/SPOAppContextItems",["require","exports","@ms/odsp-shared/lib/utilities/navigation/Navigation.key","@ms/odsp-utilities/lib/graft/Graft","../../../resources/ControlResourceKeys","../../../resources/ControlResourceKeys","../../../resources/SPOResourceKeys","../models/itemsScope/ItemsScopeHelper","../resources/itemsScope/ItemsScopeKeys","../utilities/browser/ResponsiveUI","./ContextKeys"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c;!function(e){e[e.READONLY=0]="READONLY";e[e.REPLACE=1]="REPLACE";e[e.PATCH=2]="PATCH"}(c=t.ContextItemUpdateMethod||(t.ContextItemUpdateMethod={}));t.createSPOAppContextData=function(e){var t=e.consume(u.resourceKey),h=e.consume(n.navigation),p={name:l.pageContext,data:e.consume(o.pageContext),updateMethod:c.PATCH,onChange:function(t,n){r.default(e.consume(o.pageContext),n)}},d={name:l.legacyMode,updateMethod:c.REPLACE,data:!1},v={name:l.viewParams,data:h.viewParams,updateMethod:c.REPLACE,onChange:function(n,o){e.consume(i.originalViewParams)&&r.default(e.consume(i.originalViewParams),o);var u=e.consume(s.viewParams.optional);u&&u(o);t.updateViewParams(o)}},m=e.consume(f.resourceKey);return{pageContext:p,legacyMode:d,viewParams:v,responsiveUIMetrics:{name:l.responsiveUIMetrics,updateMethod:c.PATCH,data:m.metrics},resources:{name:l.resources,updateMethod:c.READONLY,data:e},itemsScopeCurrentItemKey:{name:l.itemsScopeCurrentItemKey,data:e.consume(a.resourceKey).currentItemKey,updateMethod:c.REPLACE,onChange:function(n,r){if(r!==n){e.consume(a.resourceKey).currentItemKey=r;t.openItem(r)}}},paneControls:{name:l.paneControls,updateMethod:c.PATCH,data:{isLeftNavExpanded:!1,isRightPaneExpanded:!1,isInfoPaneExpanded:!1,isFiltersPaneExpanded:!1,isColumnCustomizationPaneExpanded:!1,isO365FlexPaneVisible:!1,isTipsNTricksPaneVisible:!1}},pageControls:{name:l.pageControls,updateMethod:c.PATCH,data:{canUserSelect:!0,isSuiteNavHamburgerVisible:m.metrics.isHamburgerVisible,isFullscreen:!1}},hotMainComponent:{name:l.hotMainComponent,updateMethod:c.REPLACE,data:void 0}}}});
define("odsp-next/experiments/splightspeed/models/itemsScope/ItemsScopeHelper",["require","exports","tslib","@ms/odsp-utilities/lib/resources/Resources","../itemCache/ItemCacheStore","@ms/items-view/lib/private/operations/readItems","@ms/items-view/lib/private/operations/getItems","@ms/items-view/lib/private/operations/blockItemPage","../../../../models/itemsScope/facets/CurrentItemsScopeFacets","@ms/items-view/lib/private/utilities/Graft","@ms/items-view/lib/private/models/Facet","@ms/odsp-utilities/lib/component/Component","@ms/odsp-utilities/lib/async/Async","../../resources/itemsScope/ItemsScopeKeys","../../../../models/itemsScope/ItemsScopeAddonHelper"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v=new h.default,m=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.openActionControlHandler=function(e,t){throw new Error("Not Implemented")};r._itemsScopeItemKey=n.itemsScopeKeys.itemKey;r._itemCacheStore=n.itemCacheStore;r._itemCacheStore.dispatch(u.blockItemPage());return r}t.prototype.unblockItemPageRender=function(){var e=this;this._itemCacheStore.dispatch(s.readItems(function(e){return u.itemPageIsBlocked(e)}))&&v.setTimeout(function(){return e._itemCacheStore.dispatch(u.unblockItemPage())},0)};t.prototype.updateViewParams=function(e){var t;(0,this._itemCacheStore.dispatch)(o.resolveItems({items:(t={},t[this._itemsScopeItemKey]=l.pack({viewParams:a.currentViewParamsFacet},{viewParams:new f.MirrorPatch(e)}),t)}))};t.prototype.openItem=function(e){var t=this._itemCacheStore.dispatch,n=this._nextOpenItem;if(n){this._nextOpenItem=void 0;t(n)}else t(d.openItemWithAddon({itemsScopeItemKey:this._itemsScopeItemKey,currentItemKey:e}))};t.dependencies=n.__assign({},c.default.dependencies,{itemsScopeKeys:p.resourceKey,itemCacheStore:i.resourceKey});return t}(c.default);t.ItemsScopeHelper=m;t.resourceKey=r.createResolvedResourceKey(e("module").id,m)});
define("odsp-next/experiments/splightspeed/models/itemCache/ItemCacheStore",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","@ms/items-view/lib/private/store/createStore","@ms/odsp-utilities/lib/resources/Resources","../../../../models/itemsScope/controls/ItemKeyToStoreKeyControl","../../../../models/itemsScope/controls/ViewParamsToItemKeyControl","../../../../models/itemsScope/facets/OdspNextAppFacets","../../../../models/itemsScope/ItemsScopeAddon.key","../../../../models/itemsScope/ItemsScopeKeyConverter.key","../../../../resources/SPOResourceKeys","./ItemCacheConfiguration","../../../../models/itemsScope/KnockoutStoreItemControlHandler","../../../../models/itemsScope/controls/KnockoutStoreItemControl"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d=new i.ResourceKey({name:e("module").id+".oneItemCacheInstance",factory:{dependencies:{},create:function(e){var t={created:!1};return{instance:t,disposible:t}}}}),v={resources:i.resourceScopeKey,itemsScopeKeyConverter:f.resourceKey,itemCacheConfiguration:c.resourceKey,oneItemCacheInstance:d,pageContext:l.pageContext,itemsScopeAddon:a.resourceKey,knockoutStoreItemControlHandler:h.resourceKey};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:{dependencies:v,create:function(e){var t=e.itemsScopeKeyConverter,i=e.itemCacheConfiguration,a=e.oneItemCacheInstance,f=e.itemsScopeAddon,l=e.knockoutStoreItemControlHandler;if(a.created)throw new Error("Attempted to create a second instance of the ItemCacheStore.");a.created=!0;var c=r.createItemCacheStore({configuration:i});c.dispatch(n.registerControlHandler(u.odspNextAppKeyFacet,s.itemKeyToStoreKeyControl)(n.createControlHandler()(function(){return function(){return t.itemKeyToStoreKeyControlHandler}})));c.dispatch(n.registerControlHandler(u.odspNextAppKeyFacet,o.viewParamsToItemKeyControl)(n.createControlHandler()(function(){return function(){return t.viewParamsToItemKeyControlHandler}})));c.dispatch(n.registerControlHandler(u.odspNextAppKeyFacet,p.knockoutStoreItemControl)(n.createControlHandler()(function(){return l})));c.dispatch(f);return{instance:c,disposable:c}}}})});
define("odsp-next/experiments/splightspeed/models/itemCache/ItemCacheConfiguration",["require","exports","tslib","../../../../models/itemCache/spo/ItemCacheConfiguration","@ms/odsp-utilities/lib/resources/Resources","@ms/items-view/lib/private/facets/LoggerFacets","../../../../resources/LoggingResourceKeys","../../../../utilities/logging/itemsScope/Logging","../../../../providers/engagement/Engagement","../../../../utilities/killSwitch/KillSwitch"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l={resources:i.resourceScopeKey,spoItemCacheConfiguration:r.resourceKey};t.resourceKey=new i.ResourceKey({name:e("module").id,factory:{dependencies:l,create:function(e){var t=e.resources,r=e.spoItemCacheConfiguration;return{instance:n.__assign({},r,s.loggerFacet.pack(n.__assign({},f.default.isActivated("80C3EC2C-9E89-477C-90F5-A6F3BBCDF698","6/18/2019","Disable logging callbacks in ItemsScope")?{logEngagementData:u.getLoggingEngagementData(t.consume(a.resourceKey)),logQoSData:u.logQoS}:{},{sharingClientId:s.ClientId.sharePoint,reportRUMOnePerfData:!1,logRenderEndTime:function(e,n){t.consume(o.rumOneHelper).logRUMOneForItemsScopeListView(e,n)}})))}}}})});
define("odsp-next/models/itemCache/spo/ItemCacheConfiguration",["require","exports","tslib","@ms/items-view-addon-sp/lib/dataSource/Facets","../../itemSet/ItemSetQueryType","@ms/items-view-addon-recent/lib/models/facets/TokenFetcherConfigurationFacet","@ms/items-view-addon-graph/lib/models/facets/GraphDataSourceConfigurationFacet","@ms/items-view/lib/private/facets/ConfigurationFacets","@ms/items-view-addon-graph/lib/models/facets/ConfigurationFacets","@ms/items-view/lib/private/facets/LoggerFacets","@ms/odsp-utilities/lib/uri/SimpleUri","../../../providers/mruRecent/MruRecentProvider.key","../../../resources/UtilityResourceKeys","../../../utilities/features/Features","../../../resources/LoggingResourceKeys","../../../dataSources/itemsScope/PrefetchListData","../../../utilities/logging/itemsScope/Logging","../../../providers/engagement/Engagement","@ms/odsp-datasources/lib/interfaces/WebTemplateType","@ms/items-view/lib/private/facets/TelemetryFacets","../../../utilities/killSwitch/KillSwitch","@ms/spo-core/lib/Init","../../../dataSources/url/odb/ItemUrlHelper","@ms/odsp-utilities/lib/resources/Resources","../ItemCacheConfiguration","../../../resources/SPOResourceKeys","../../../resources/DataSourceResourceKeys","../../../providers/serviceWorker/itemsScope/ServiceWorkerOfflineCache","@ms/odsp-utilities/lib/uri/Uri","@ms/telemetry-addon-aria/lib/AriaTelemetryHandler","@ms/spo-core/lib/Tenants","@ms/utilities-guid/lib/index","@ms/utilities-browser/lib/PlatformDetection","../../../dataSources/item/odb/ItemCacheSPResponseHandler.key"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D){"use strict";var P=this;Object.defineProperty(t,"__esModule",{value:!0});var H=w.default.isActivated("04926A2B-07B3-42D3-B13E-ACF9AE7E8F82","8/01/2019","rigth casing for loadSPFX")?"loadSpfx":"loadSPFX",B={resources:x.resourceScopeKey,baseItemCacheConfiguration:T.resourceKey,itemUrlHelper:S.resourceKey,pageContext:N.pageContext,identityDataSource:C.identity,serviceWorkerOfflineCache:k.resourceKey,getItemCacheSPResponseHandler:D.resourceKey.async};t.resourceKey=new x.ResourceKey({name:e("module").id,factory:{dependencies:B,create:function(t){var x=t.baseItemCacheConfiguration,T=t.resources,N=t.itemUrlHelper,C=t.pageContext,k=t.identityDataSource,D=t.getItemCacheSPResponseHandler,B=Number(C.webTemplate)===y.WebTemplateType.mySite,j=p.isFeatureEnabled(p.EnableTilesListMediaGroupings),F=E.getAriaInfo(),I=F.ariaEnvironment,q=F.manifest,R=F.version,U=new L.default(document.location.href),z=U.getQueryParameter(H),W=U.getQueryParameter("customActions"),X=U.getQueryParameter("fieldCustomizers"),V=z&&(W||X),$=new _.PlatformDetection;return{instance:n.__assign({},x,u.offlineCacheFacet.pack(t.serviceWorkerOfflineCache),u.loginUserFacet.pack({userLoginName:C.userLoginName,userEmail:C.userEmail}),s.tokenFetcherConfigurationFacet.pack({getToken:function(){return n.__awaiter(P,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,T.consumeAsync(c.resourceKey.bypass)];case 1:return[4,e.sent().getTokenForMru()];case 2:return[2,e.sent()]}})})}}),f.loggerFacet.pack(n.__assign({},w.default.isActivated("80C3EC2C-9E89-477C-90F5-A6F3BBCDF698","6/18/2019","Disable logging callbacks in ItemsScope")?{logEngagementData:m.getLoggingEngagementData(T.consume(g.resourceKey))}:{},w.default.isActivated("6FB30709-8477-47EA-B7E6-A51BCED4217F","8/22/2019","Disable logQos callbacks in ItemsScope")?{logQoSData:m.logQoS}:{},{sharingClientId:B?f.ClientId.odb:f.ClientId.sharePoint,reportRUMOnePerfData:!1,scenarioId:B?"ODB":"SPList",logRenderEndTime:function(e,t){var n=T.consume(d.rumOneHelper.optional);n&&n.logRUMOneForItemsScopeListView(e,t)}})),a.isTestMode.pack(localStorage._isRunningTABTest),r.spDataSourceConfigurationFacet.pack({ensureAuthToken:function(e,r){void 0===r&&(r={});return n.__awaiter(P,void 0,void 0,function(){var i,s,o;return n.__generator(this,function(n){switch(n.label){case 0:i=r.disallowCookies,s=void 0!==i&&i;return w.default.isActivated("480bf467-7642-4b7d-9284-72ddb6a7f26c","3/20/2019","Get SP token method.")?[3,3]:s||e!==t.pageContext.webAbsoluteUrl?[4,k.getSharePointToken(new l.SimpleUri(e).authority)]:[3,2];case 1:return[2,n.sent().accessToken];case 2:return[3,5];case 3:o=N.getUrlParts({path:e}).siteRelation;return s||o===S.SiteRelation.crossSite?[4,k.getSharePointToken(new l.SimpleUri(e).authority)]:[3,5];case 4:return[2,n.sent().accessToken];case 5:return[2,void 0]}})})}}),r.spHomeDataSourceConfigurationFacet.pack({contextAcquiresAuthToken:p.isFeatureEnabled(p.UseSPHomeContextAuth)}),r.spCreateDocumentFormDigestFacet.pack(!w.default.isActivated("02D1B4C9-DE85-4DC6-8F3D-71D72CD5A818","8/01/2019","allow formdigetst create document in ItemsScope")||B),r.spPrefetchDataConfigurationFacet.pack({prefetchData:v.getPrefetchListData}),r.spFeatureConfigurationFacet.pack({isFeatureEnabled:p.isFeatureEnabled}),r.spClientSideFrameworkConfigurationFacet.pack({loadSpfxHostApplication:function(e,t){return n.__awaiter(P,void 0,void 0,function(){var r;return n.__generator(this,function(n){switch(n.label){case 0:return[4,T.consumeAsync(h.clientSideExtensionHelper.optional.bypass)];case 1:return(r=n.sent())?[4,r.loadSPFramework(e,void 0,t)]:[3,3];case 2:return[2,n.sent()];case 3:return[2]}})})},loadSpfxAdapter:function(e,t){return n.__awaiter(P,void 0,void 0,function(){var r,i;return n.__generator(this,function(n){switch(n.label){case 0:return[4,T.consumeAsync(h.clientSideExtensionHelper.optional.bypass)];case 1:return(r=n.sent())?[4,r.loadSPFramework(e,void 0,t)]:[3,3];case 2:return[2,(i=n.sent())&&i.adapter||void 0];case 3:return[2]}})})},requestSpfxFrameworkInfo:!1}),o.graphDataSourceConfigurationFacet.pack({ensureAuthToken:function(e,t){return n.__awaiter(P,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,k.getSharePointToken(new l.SimpleUri(t).authority)];case 1:return[2,e.sent().accessToken]}})})}}),!w.default.isActivated("2C8D4C9E-B6FE-4F44-8CDB-46BC78EB53DE","10/25/2018","Enable Shared Aria telemetry for Items View")&&(I&&"dev"!==R||p.isFeatureEnabled(p.ForceEnableAria))?n.__assign({},b.telemetryHandlersConfigurationFacet.pack([new A.AriaTelemetryHandler({ariaLoader:function(){return new Promise(function(t,n){e(["aria"],t,n)})},context:{BrowserIsMobile:$.isMobile,BrowserMajVer:$.browserMajor,BrowserMinVer:$.browserMinor,BrowserName:$.browserName,BrowserUserAgent:$.userAgent,OSName:$.osName,OSVersion:$.osVersion,ClientName:B?"ODB Web":"SPList Web",Environment:I||"ppe",Market:C.currentUICultureName,Workload:B?"ODB":"SPList",UserId:C.systemUserKey,IsAuthenticated:C.isAnonymousGuestUser?0:1,AccountType:C.userLoginName?"Business":"BusinessAnonymous",SiteSubscriptionId:C.siteSubscriptionId,Session:M.generate(),FarmLabel:C.farmLabel,Version:R,Manifest:q,IsSharedControl:!0},disableCookies:C.isAnonymousGuestUser,tenantToken:"prod"===I?B?O.ODBTenantTokens.prod:O.SPOTenantTokens.prod:B?O.ODBTenantTokens.ppe:O.SPOTenantTokens.ppe})])):{},r.spLayoutConfigurationFacet.pack(function(e,t){return{queryType:i.getQueryType(e,t.itemSetKey)}}),r.spCookieDomainConfigurationFacet.pack(new l.SimpleUri(window.location.href).authority),w.default.isActivated("16FF6E04-2E99-4865-80BE-319D6E8F82A6","8/29/2019","Fix onepage navigation to subsite list")?{}:r.spPageFallbackWebAbsoluteUrlConfigurationFacet.pack(C.webAbsoluteUrl),r.enableQuickEditFacet.pack(p.isFeatureEnabled(p.showQuickEditFeature)&&p.isFeatureEnabled(p.UseItemsScopeInTeamSites)),r.enableModernColumnTotalsSettingsFacet.pack(p.isFeatureEnabled(p.ModernColumnTotalsSettings)&&p.isFeatureEnabled(p.ShowColumnTotals)),r.enableMapGraphItemsToSharePointFacet.pack(p.isFeatureEnabled(p.UseItemsScopeGraphSPMergedItems)),r.enableModernListSchemasConfigurationFacet.pack(p.isFeatureEnabled(p.EnableModernListSchemasInItemsScope)),r.enableMediaGroupingConfigurationFacet.pack(j),r.enableApproveRejectCommandConfigurationFacet.pack(p.isFeatureEnabled(p.BulkApproveReject)),V?n.__assign({},r.enableDebugClientSideExtensionsFacet.pack({fieldCustomizers:X,customActions:W})):{},p.isFeatureEnabled(p.EnableRecentWithGraphAddon)?a.recentItemsGroupByFacet.pack("date"):{},w.default.isActivated("586D645A-B3B2-422F-8B0A-4EE0725D5FB1","9/4/2019","Update ItemsStore on all SP Requests")?{}:r.onProcessListItemResponseConfigurationFacet.pack(function(e){var t=this;return function(r){var i=e.itemSetKey,s=e.serverData,o=e.isItemSetRequest;n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:return[4,D()];case 1:e=t.sent();r(e.updateFromResponse({itemSetKey:i,serverData:s,isItemSetRequest:o}));return[2]}})})}}))}}}})});
define("odsp-next/models/itemSet/ItemSetQueryType",["require","exports","@ms/items-view-addon-recent/lib/models/keys/RecentRootItemKeyFacet","@ms/items-view-addon-sp/lib/dataSource/Keys","../../dataSources/url/QueryType","@ms/odsp-graph/lib/utilities/media/MediaUtils","@ms/odsp-graph/lib/models/item/IItemTypeFilter","@uifabric/file-type-icons/lib/FileTypeIconMap"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getQueryType=function(e,t){var a=e.demandItemFacet(r.spWebKeyFacet,t),f=e.demandItemFacet(r.spLibrariesItemSetKeyFacet,t),l=e.demandItemFacet(n.recentRootItemKeyFacet,t),c=e.demandItemFacet(r.spItemKeyFacet,t),h=e.demandItemFacet(r.spFolderItemSetKeyFacet,t);if(a)return i.default.Files;if(f)return i.default.DocumentLibraries;if(l)return i.default.Recent;if(c)return i.default.Files;if(h){if(h.extFilters){return s.doExtFiltersHaveMediaTypesOnly({extFilters:s.getIItemTypeFilter(h.extFilters),allowedMediaTypes:[o.ItemTypeFilter.photo,o.ItemTypeFilter.video],fileTypeIconMap:u.FileTypeIconMap})?i.default.Photos:i.default.Files}return i.default.Files}return i.default.Files}});
define("@ms/items-view-addon-recent/lib/models/keys/RecentRootItemKeyFacet",["require","exports","@ms/items-view/lib/private/models/KeyFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recentRootItemKeyFacet=new n.KeyFacet("recent",{})});
define("@ms/items-view-addon-recent/lib/models/facets/TokenFetcherConfigurationFacet",["require","exports","@ms/items-view/lib/private/models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.tokenFetcherConfigurationFacet=new n.Facet("tokenFetcher")});
define("odsp-next/providers/mruRecent/MruRecentProvider.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./MruRecentProvider"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/dataSources/itemsScope/PrefetchListData",["require","exports","@ms/odsp-utilities/lib/async/Promise","../item/odb/ListViewDataPrefetchHelper","@ms/odsp-utilities/lib/performance/PerformanceCollection","@ms/odsp-utilities/lib/logging/events/Qos.event","@ms/odsp-utilities/lib/navigation/AddressParser"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getPrefetchListData=function(e){var t=new s.Qos({name:"ItemsViewGetPrefetchListData"}),o=e.serverDataCallSignature,a=o.url,f=o.body,l=r.default.createHashCode(a,f);window.ItemsViewListDataActualHash=l;var c=r.default.prefetchData(l);if(c){r.default.shouldLogError=!1;return new n.default(function(e,n){var o=function(o,u){if(200===o||u){t.end({resultType:s.ResultTypeEnum.Success});var a=i.default.getResponseEnd();if(o&&!u){i.default.summary.dataFetchServerTime=c.serverDuration;if(window.performance&&performance.timing){i.default.summary.prefetchStart=c.startTimeMark-a;window.g_prefetchStart=i.default.summary.prefetchStart}}else if(u&&window.g_deferDataLoadTime){i.default.summary.deferredListDataRender=Number(window.g_deferDataLoadTime)-a;window.g_deferredListDataRender=i.default.summary.deferredListDataRender}try{var h=c.listData,p=JSON.parse(h);p.isFromServiceWorkerCache=c.isFromServiceWorkerCache;e(p)}catch(e){n()}}else{({resultType:s.ResultTypeEnum.Failure,resultCode:"PrefetchFailed"}).extraData={AdditionalPostData:f||"null",ResponseStatusCode:o};e(void 0)}r.default.clearPrefetchData(l)};c.responseCode||c.deferredListData?o(c.responseCode,c.deferredListData):c.completedCallback=o})}if(r.default.shouldLogError){t.end({resultType:s.ResultTypeEnum.Failure,resultCode:"PrefetchNotStartedOrUrlOrPayLoadNotMatch",extraData:u({url:a,body:f})});r.default.shouldLogError=!1}return n.default.resolve(void 0)};function u(e){var t=e.url,n=e.body,i=o.deserializeQuery(o.getQueryStringFromUrl(window.location.href)),s=o.deserializeQuery(o.getQueryStringFromUrl(t)),u=r.default.prefetchSignature||{},a=u.url,f=void 0===a?"":a,l=u.body,c=void 0===l?void 0:l,h=o.deserializeQuery(o.getQueryStringFromUrl(f));return{deferredListData:JSON.stringify({url:h?Object.getOwnPropertyNames(h):"null",body:window.g_payload}),prefetch:JSON.stringify({url:h?Object.getOwnPropertyNames(h):"null",body:c}),itemsViewUsed:JSON.stringify({url:s?Object.getOwnPropertyNames(s):"null",body:n}),browserLocation:JSON.stringify(i?Object.getOwnPropertyNames(i):"null")}}});
define("@ms/spo-core/lib/Init",["require","exports","@ms/odsp-utilities/lib/logging/PageInit","@ms/odsp-utilities/lib/aria/AriaLogger","@ms/odsp-utilities/lib/guid/Guid","@ms/odsp-utilities/lib/logging/EventBase","@ms/odsp-utilities/lib/logging/ManagerExtended","@ms/odsp-utilities/lib/logging/UnhandledErrorHandler","@ms/odsp-utilities/lib/logging/RequireJSErrorHandler","@ms/odsp-utilities/lib/logging/PromiseErrorHandler","@ms/odsp-utilities/lib/logging/ErrorUI"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.default.init();function o(){var e,t=window._spPageContextInfo&&window._spPageContextInfo.env||"devbox",n="",r="",i=window._spModuleLink;if(i){n=i.buildNumber;r=i.manifestName;if(!i.usingRedirectCookie)switch(t.toLowerCase()){case"prod":case"dprod":e="prod";break;default:case"edog":case"prodbubble":e="ppe"}}return{version:n,manifest:r,appEnvironment:t,ariaEnvironment:e}}t.getAriaInfo=o;t.default=function(e){var t=o(),n=t.version,a=t.manifest,f=t.appEnvironment,l=t.ariaEnvironment,c=l&&e.tokens[l],h=window._spPageContextInfo,p=h.isAnonymousGuestUser,d=h.currentUICultureName,v=h.systemUserKey,m=h.userLoginName,g=h.siteSubscriptionId,y=h.farmLabel,b=h.siteId,w=h.webTemplate,E=h.webId;c&&"dev"!==n&&r.default.Init(c,{isAuthenticated:!p,market:d,session:i.default.generate(),version:n,manifest:a,userId:v,accountType:m?s.AccountType.Business:s.AccountType.BusinessAnonymous,siteSubscriptionId:g,farmLabel:y,environment:f,workload:e.workload,disableCookies:p,siteId:u(b),webTemplateId:w,webId:u(E)},e.ariaLoader)};function u(e){e.length>36&&(e=e.replace(/[{}]/g,""));return e}});
define("odsp-next/providers/serviceWorker/itemsScope/ServiceWorkerOfflineCache",["require","exports","../../../utilities/browser/ServiceWorkerAgent","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this._serviceWorkerAgent=t.serviceWorkerAgent}e.prototype.clearCache=function(){var e=this._serviceWorkerAgent;e.isServiceWorkerActive()&&e.invalidateFileMetadataCache()};return e}();t.ServiceWorkerOfflineCache=i;t.resourceKey=r.createResolvedResourceKey(e("module").id,i,{serviceWorkerAgent:n.resourceKey})});
define("@ms/spo-core/lib/Tenants",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SPOTenantTokens={ppe:"3620e5572cf04917bf4993285ebe4e15-d5c60963-35a1-45e2-9430-928e0656b9cd-6718",prod:"a9e9a63d9df4411ebbf89297947d7666-b5f0498b-a808-4b74-bb7b-2b33f7971660-7417"};t.ODBTenantTokens={ppe:"f74c101dfd474d06a7b40fed2051df7e-edb10b9a-779e-4b75-b0cc-ee0cee0f831b-7189",prod:"af7114704a204580909f08c904c5ac6f-6f6f4c13-294c-4a00-8e55-71180ed7d627-7044"}});
define("@ms/utilities-guid/lib/index",["require","exports","tslib","./Guid"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.__exportStar(r,t)});
define("odsp-next/dataSources/item/odb/ItemCacheSPResponseHandler.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./ItemCacheSPResponseHandler"],t,n)}).then(function(e){return e.resourceKey})})})});
define("odsp-next/experiments/splightspeed/resources/itemsScope/ItemsScopeKeys",["require","exports","@ms/odsp-utilities/lib/resources/Resources","@ms/items-view-addon-sp/lib/dataSource/Keys","@ms/items-view-addon-sp/lib/dataSource/Keys","@ms/items-view/lib/private/components/itemsScope/ItemsScope","../../models/itemCache/ItemCacheStore","@ms/items-view/lib/private/operations/readItems","../../../../dataSources/url/odb/ItemUrlHelper","../../../../resources/SPOResourceKeys","../../../../models/itemsScope/ItemsScopeKeyConverter.key","../../../../resources/ControlResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,factory:{dependencies:{itemUrlHelper:a.resourceKey,pageContext:f.pageContext,itemsScopeKeyConverter:l.resourceKey,viewParams:c.originalViewParams,itemCacheStore:o.resourceKey},create:function(e){var t=e.itemUrlHelper,n=e.pageContext,o=e.itemsScopeKeyConverter,a=e.viewParams,f=e.itemCacheStore,l=t.getUrlParts(),c=f.dispatch(u.readItems(function(e){return o.viewParamsToItemKeyControlHandler(e,{viewParams:a,isNavigation:!0}).itemKey})),h=r.spFolderItemSetKeyFacet.matches(c)&&r.spFolderItemSetKeyFacet.deserialize(c)||{webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:l.fullListUrl,rootFolder:""},p={itemKey:s.getNextItemsScopeItemKey(),currentItemKey:c||"",pageContextKey:i.spPageContextKeyFacet.serialize(h)};return{instance:p,disposable:p}}}});t.itemsScopeItemKeyResourceKey=new n.ResourceKey({name:e("module").id+".itemsScopeItemKey",factory:{dependencies:{itemsScopeKeys:t.resourceKey},create:function(e){return{instance:e.itemsScopeKeys.itemKey}}}})});
define("odsp-next/experiments/splightspeed/context/SPOAppContextHandler",["require","exports","tslib","@ms/odsp-utilities/lib/events/EventGroup","@ms/odsp-utilities/lib/resources/Resources","./ContextKeys"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ContextKeys=s;var o=function(){function e(){this._events=new r.default(this);this._events.declare("contextUpdated")}e.prototype.registerContextChangeHandler=function(e){this._handleContextDataChange=e};e.prototype.update=function(e){this._handleContextDataChange&&this._handleContextDataChange(e)};e.prototype.onUpdated=function(e){this._events.on(this,"contextUpdated",e)};e.prototype.offUpdated=function(e){this._events.off(this,"contextUpdated",e)};e.prototype.notifyUpdate=function(e){this._contextData=e;this._events.raise("contextUpdated",e)};e.prototype.getContext=function(){return n.__assign({},this._contextData)};e.prototype.dispose=function(){this._events.dispose()};return e}();t.SPOAppContextHandler=o;t.resourceKey=new i.ResourceKey({name:e("module").id+"s",factory:new i.SimpleResourceFactory(o)})});
define("@ms/items-view-addon-sp/lib/commands/NewDocumentTemplateCommands",["require","exports","@ms/items-view/lib/private/models/Facet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.editNewMenuKey=new n.Facet("editNewMenu").id});
define("odsp-next/actions/itemsScope/ManageAccessAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ManageAccessAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.ShowPermissionsAction))})});
define("odsp-next/actions/itemsScope/NavigateToQueryRootAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout","../../resources/DataSourceResourceKeys","../../providers/item/ItemProvider"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.NavigateToQueryRootAction=r.createItemsScopeActionFromKnockout(function(e,t){var r=e.consume(n.actionMap),o=e.consume(s.resourceKey),u=e.consume(i.url);return new(e.injected(r.OpenAction))({item:o.getItemSync({parentKey:u.getRootItemKey(t.queryType)}).item,openRelation:2})})});
define("odsp-next/controls/itemsScope/spo/ItemsScopePLTCommands",["require","exports","react","../../commands/PLTCommands.resx","@ms/items-view/lib/private/models/Facet","@ms/items-view/lib/private/components/selectionVisibility/SelectionVisibility","../../../actions/itemsScope/AlertAction","../../../actions/itemsScope/VersionHistoryAction","../../../actions/itemsScope/AibuilderAction","../../../actions/itemsScope/PowerAppActions"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.alertMeCommand={key:new i.Facet("AlertMe").id,name:r.strings.Alert,action:n.createElement(o.AlertMeAction,null),iconProps:{iconName:"Ringer"}};t.manageAlertCommand={key:new i.Facet("ManageAlert").id,name:r.strings.ManageAlert,action:n.createElement(o.ManageAlertAction,null),iconProps:{iconName:"EditNote"}};t.versionHistoryCommand={key:new i.Facet("VersionHistory").id,name:r.strings.ShowVersionHistory,action:n.createElement(u.VersionHistoryAction,null),iconProps:{iconName:"StackIndicator"}};var l={key:new i.Facet("CustomizeListForms").id,name:r.strings.CustomizeListForms,engagement:{name:"LaunchCustomizePowerAppForm",isIntentional:!0},action:n.createElement(s.HideWithSelection,null,n.createElement(f.CustomizeFormsNavigationAction,null))},c={key:new i.Facet("CreateAppView").id,name:r.strings.CreateAppView,engagement:{name:"LaunchCreatePowerAppPanel",isIntentional:!0},action:n.createElement(s.HideWithSelection,null,n.createElement(f.LaunchCreateAppViewPanelAction,null))},h={key:new i.Facet("SeeAllApps").id,name:r.strings.SeeAllAppsLabel,engagement:{name:"LaunchSeeAllPowerApps",isIntentional:!0},action:n.createElement(s.HideWithSelection,null,n.createElement(f.SeeAllAppsAction,null))};t.powerAppsCommand={key:new i.Facet("PowerApps").id,name:r.strings.AppViewsCommandLabel,iconProps:{iconName:"PowerApps2Logo"},engagement:{name:"PowerAppsMainMenu",isIntentional:!0},subMenuProps:{items:[c,h,l]}};var p={key:new i.Facet("CreateAIBuilderModel").id,name:r.strings.CreateAIBuilderModel,action:n.createElement(s.HideWithSelection,null,n.createElement(a.CreateAIBuilderModelAction,null))},d={key:new i.Facet("SeeAIBuilderModels").id,name:r.strings.ExistingAIBuilderModels,action:n.createElement(s.HideWithSelection,null,n.createElement(a.ViewAIBuilderModelsAction,null))};t.aibuilderCommand={key:new i.Facet("AIBuilder").id,name:r.strings.AIBuilderCommandLabel,iconProps:{iconName:"HomeGroup"},subMenuProps:{items:[p,d]}}});
define("odsp-next/actions/itemsScope/AlertAction",["require","exports","tslib","react","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view-addon-sp/lib/utilities/item/pageContextHelper","../../dataSources/url/odb/ItemUrlHelper","@ms/items-view-addon-sp/lib/dataSource/Facets","@ms/odsp-datasources/lib/utilities/permissions/PermissionMask","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction","../../controls/base/react/WithResources"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";var h=this;Object.defineProperty(t,"__esModule",{value:!0});var p=i.withSelectedItems()(i.withCurrentItemAsFallback()(i.withExactlyOneItem()(l.createDeferredOnExecuteAction(function(){return n.__awaiter(h,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/AlertAction"],t,n)})];case 1:return[2,t.sent().AlertAction]}})})},function(e,t){var n=t.itemKey,r=t.resources;if(!n)return!1;var i=s.getPageContextFromItemCache(e,n),l=e.demandItemFacet(u.permissionsFacet,n);if(!(!!i&&!i.isEmailAuthenticationGuestUser&&a.PermissionMask.hasItemPermission({permissions:l},a.PermissionMask.createAlerts)))return!1;var c=r&&r.consume(o.resourceKey.optional);if(c){var h=e.demandItemFacet(f.canonicalUrlFacet,n);if(c.getUrlParts({path:h}).isCrossDomain)return!1}return!0}))));t.AlertMeAction=function(){var e=c.useResourceScope();return r.createElement(p,{resources:e})};t.ManageAlertAction=function(){var e=c.useResourceScope();return r.createElement(p,{resources:e,manageAlerts:!0})}});
define("@ms/items-view-addon-sp/lib/utilities/item/pageContextHelper",["require","exports","../../dataSource/Keys","../../dataSource/Facets"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getPageContextFromItemCache=function(e,t){var i=e.demandItem({key:n.spItemKeyFacet},t).key;return i&&e.demandItemFacet(r.spPageContextFacet,n.spPageContextKeyFacet.serialize({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl}))}});
define("@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction",["require","exports","tslib","react","@ms/items-view/lib/private/utilities/components/Async","@ms/items-view/lib/private/components/withAction/WithAction","@ms/items-view/lib/private/components/decorators/connectToItemCache","@ms/items-view/lib/private/components/decorators/asAutoAction","@ms/items-view/lib/private/components/withAction/WithAction"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createDeferredOnExecuteAction=function(e,t,f){var l=u.asAutoAction({timeout:3e3})(i.asAsync(e));return o.connectToItemCache(function(e,i){var s=t(e,i),o=f&&f(e,i),u=a.renderComponentOnExecute(function(e){var t=e.resolve,s=e.reject,o=e.onExecuteProps;return r.createElement(l,n.__assign({},i,{onComplete:t,onError:s,onExecuteProps:o}))});return{action:r.createElement(a.ActionBase,{onExecute:u,isAvailable:s,isToggled:o})}})(s.ActionSelector)}});
define("odsp-next/actions/itemsScope/VersionHistoryAction",["require","exports","tslib","react","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view-addon-sp/lib/utilities/item/pageContextHelper","../../dataSources/url/odb/ItemUrlHelper","@ms/items-view-addon-sp/lib/dataSource/Facets","@ms/items-view-addon-sp/lib/models/facets/ItemComplianceStatusFacet","@ms/odsp-datasources/lib/utilities/permissions/PermissionMask","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction","../../controls/base/react/WithResources","@ms/items-view-addon-sp/lib/dataSource/Keys","../../utilities/features/Features","@ms/items-view/lib/private/facets/DocumentFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){"use strict";var m=this;Object.defineProperty(t,"__esModule",{value:!0});var g=i.withSelectedItems()(i.withExactlyOneItem()(c.createDeferredOnExecuteAction(function(){return n.__awaiter(m,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/VersionHistoryAction"],t,n)})];case 1:return[2,t.sent().VersionHistoryAction]}})})},function(e,t){var n=t.itemKey,r=t.resources;if(!n)return!1;var i=s.getPageContextFromItemCache(e,n),c=e.demandItemFacet(u.permissionsFacet,n),h=e.demandItemFacet(a.itemComplianceStatusFacet,n);if(!(!!i&&!i.isEmailAuthenticationGuestUser&&f.PermissionMask.hasItemPermission({permissions:c},f.PermissionMask.viewVersions)&&3!==h&&4!==h))return!1;var m=e.demandItemFacet(p.spItemKeyFacet,n),g=m&&p.spListKeyFacet.serialize(m),y=e.demandItemFacet(u.listFacet,g),b=!(!y||!y.enableVersions&&!y.isModerated);if(!b)return!1;var w=r&&r.consume(o.resourceKey.optional);if(w){var E=e.demandItemFacet(l.canonicalUrlFacet,n);if(w.getUrlParts({path:E}).isCrossDomain)return!1}var S=e.demandItemFacet(l.folderFacet,n),x=e.demandItemFacet(u.documentSetFacet,n),T=e.demandItemFacet(v.oneNoteFacet,n),N=e.demandItemFacet(u.listItemIdFacet,n),C=d.isFeatureEnabled(d.DocumentSetsModernView)&&d.isFeatureEnabled(d.UseItemsScopeInTeamSites)&&N;return b=!S&&!T||!(!C||!x)})));t.VersionHistoryAction=function(){var e=h.useResourceScope();return r.createElement(g,{resources:e})}});
define("@ms/items-view-addon-sp/lib/models/facets/ItemComplianceStatusFacet",["require","exports","@ms/items-view/lib/private/models/itemCache/ComputedItemFacet","../../utilities/item/pageContextHelper","@ms/items-view/lib/private/facets/ItemFacets","../../dataSource/Facets"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemComplianceStatusFacet=new n.ComputedItemFacet("itemComplianceStatus",function(e,t){var n=t.itemKey,o=r.getPageContextFromItemCache(e,n),u=o&&o.blockDownloadsExperienceEnabled,a=o&&o.viewOnlyExperienceEnabled;if(u||a){var f=void 0;u&&e.demandItemFacet(i.openUrlFacet,n)&&e.demandItemFacet(s.officeAppFacet,n)?f=4:u&&!e.demandItemFacet(i.folderFacet,n)?f=3:a&&(f=4);return f}})});
define("odsp-next/actions/itemsScope/AibuilderAction",["require","exports","tslib","react","@ms/items-view/lib/private/components/action/Action"],function(e,t,n,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this;return r.createElement(i.Action,{onExecute:function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){window.open("https://make.preview.powerapps.com/aibuilder/build","_blank");return[2]})})}})};return t}(r.PureComponent);t.CreateAIBuilderModelAction=s;var o=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this;return r.createElement(i.Action,{onExecute:function(){return n.__awaiter(e,void 0,void 0,function(){return n.__generator(this,function(e){window.open("https://make.preview.powerapps.com/aibuilder/models","_blank");return[2]})})}})};return t}(r.PureComponent);t.ViewAIBuilderModelsAction=o});
define("odsp-next/actions/itemsScope/PowerAppActions",["require","exports","tslib","@ms/items-view/lib/private/components/decorators/selectors","@ms/items-view-addon-sp/lib/utilities/item/pageContextHelper","../../utilities/features/Features","@ms/items-view-addon-sp/lib/dataSource/Keys","@ms/items-view-addon-sp/lib/dataSource/Facets","@ms/odsp-datasources/lib/dataSources/listCollection/ListTemplateType","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction"],function(e,t,n,r,i,s,o,u,a,f){"use strict";var l=this;Object.defineProperty(t,"__esModule",{value:!0});function c(e,t){var n=t.itemKey;if(!n)return!1;var r=i.getPageContextFromItemCache(e,n);return!!r&&!!n&&s.isFeatureEnabled(s.PowerApps)&&!r.disableAppViews}t.CustomizeFormsNavigationAction=r.withCurrentItem()(f.createDeferredOnExecuteAction(function(){return n.__awaiter(l,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/PowerAppActions"],t,n)})];case 1:return[2,t.sent().CustomizeFormsNavigationAction]}})})},function(e,t){var n=t.itemKey,r=s.isFeatureEnabled(s.PowerAppListForms)&&s.isFeatureEnabled(s.PowerApps),i=!!n&&r;if(!i)return!1;var f=e.demandItemFacet(o.spItemKeyFacet,n),l=f&&o.spListKeyFacet.serialize(f),c=e.demandItemFacet(u.listFacet,l);if(!c||!c.id)return!1;var h=!(!c.permissions||!c.permissions.manageLists),p=c.isDocumentLibrary,d=Number(c.templateType)===a.ListTemplateType.genericList;return i=s.isFeatureEnabled(s.PowerappsCustomizationOnDocLibs)?(p||d)&&h:!p&&d&&h}));t.LaunchCreateAppViewPanelAction=r.withCurrentItem()(f.createDeferredOnExecuteAction(function(){return n.__awaiter(l,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/PowerAppActions"],t,n)})];case 1:return[2,t.sent().LaunchCreateAppViewPanelAction]}})})},function(e,t){var n=t.itemKey,r=!!n&&c(e,t);if(r){var i=e.demandItemFacet(o.spItemKeyFacet,n),s=i&&o.spListKeyFacet.serialize(i),a=e.demandItemFacet(u.listFacet,s);r=!(!(a&&a.permissions&&a.permissions.manageLists)||a.isDocumentLibrary)}return r}));t.SeeAllAppsAction=r.withCurrentItem()(f.createDeferredOnExecuteAction(function(){return n.__awaiter(l,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["./deferredActionExecutors/PowerAppActions"],t,n)})];case 1:return[2,t.sent().SeeAllAppsAction]}})})},c))});
define("odsp-next/controls/commands/itemsScope/DetailsCommand",["require","exports","tslib","react","@ms/items-view/lib/private/models/Facet","../../../actions/itemsScope/ToggleInfoPaneAction","../Commands.resx","../../knockoutContentShim/WithKnockoutResourceScope"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.detailsCommand={key:new i.Facet("Details").id,action:r.createElement(u.WithKnockoutResourceScope,null,r.createElement(s.ToggleInfoPaneAction,null)),iconProps:{iconName:"Info"},title:o.strings.DetailsPane,ariaLabel:o.strings.DetailsPane,shortcutProps:{content:o.strings.DetailsPane,keySequences:["I"]},commandBarButtonAs:function(e){var t=e.actionState&&e.actionState.isToggled,i=e.defaultRender;return i?r.createElement(i,n.__assign({},e,{"aria-expanded":!!t})):null}}});
define("odsp-next/controls/knockoutContentShim/WithKnockoutResourceScope",["require","exports","tslib","react","../base/react/WithResources","@ms/items-view/lib/private/utilities/components/Async","../../utilities/initialization/KnockoutResourceScope.key","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function a(e){return r.createElement(r.Fragment,null,e.children)}var f=new u.ResourceKey(e("module").id+".canary"),l=e("module").id;t.WithKnockoutResourceScope=function(e){var t=this,c=e.bypass,h=i.useResourceScope(),p=r.useState(function(){return s.asAsync(function(){return n.__awaiter(t,void 0,void 0,function(){var e;return n.__generator(this,function(t){switch(t.label){case 0:if(!c)return[3,5];(e=new u.ResourceScope(h,{owner:l})).expose(f,!0);t.label=1;case 1:t.trys.push([1,,3,4]);return[4,e.consumeAsync(o.resourceKey.optional.bypass)];case 2:t.sent();return[3,4];case 3:e.dispose();return[7];case 4:return[3,7];case 5:return[4,h.consumeAsync(o.resourceKey.optional)];case 6:t.sent();t.label=7;case 7:return[2,a]}})})})})[0];return r.createElement(p,n.__assign({},e))}});
define("odsp-next/utilities/initialization/KnockoutResourceScope.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey(e("module").id)});
define("odsp-next/controls/commands/itemsScope/OpenInTextEditorCommand",["require","exports","react","@ms/items-view/lib/private/models/Facet","../../../actions/itemsScope/OpenInTextEditorAction","../Commands.resx","../../knockoutContentShim/WithKnockoutResourceScope"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.openInTextEditorCommand={key:new r.Facet("OpenInTextEditor").id,name:s.strings.OpenInTextEditor,action:n.createElement(o.WithKnockoutResourceScope,null,n.createElement(i.OpenInTextEditorAction,null)),iconProps:{iconName:"Edit"}}});
define("odsp-next/actions/itemsScope/OpenInTextEditorAction",["require","exports","../../resources/ControlResourceKeys","./base/CreateItemsScopeActionFromKnockout"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OpenInTextEditorAction=r.createItemsScopeActionFromKnockout(function(e){var t=e.consume(n.actionMap);return new(e.injected(t.OpenInTextEditorAction))})});
define("odsp-next/models/itemsScope/od/OneDriveItemControlHandler",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","@ms/odsp-utilities/lib/resources/Resources","@ms/items-view-addon-graph/lib/models/facets/DriveItemResponseFacet","@ms/items-view/lib/private/facets/ItemFacets","../controls/ItemKeyToStoreKeyControl","../facets/OdspNextAppFacets","../../../dataSources/item/od/ItemCacheToKOStoreCommands","../../../dataSources/base/vroom/ItemResultProcessor","@ms/odsp-utilities/lib/graft/Graft","@ms/items-view/lib/private/utilities/Graft"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new r.ResourceKey({name:e("module").id,factory:{dependencies:{itemCacheToKOStoreCommands:a.resourceKey,itemResultProcessor:f.resourceKey},create:function(e){var t=e.itemCacheToKOStoreCommands,r=e.itemResultProcessor,a=function(e,n){var a=n.itemKey,f=n.key,h=n.item,p=e.demandItemFacet(i.driveItemResponseFacet,a);if(!h||!p)return{item:h};var d=function(e){var t=e.itemCache,n=e.itemKey,r=t.demandItemFacet(s.parentFolderItemFacet,n),i=t.demandItemFacet(o.itemKeyToStoreKeyControl,u.odspNextAppItemKey);if(!r)return;var a=o.itemKeyToStoreKeyControl.evaluate(i)(t,{itemKey:r.itemKey,viewParams:{}}).storeKey;if(a)return a.key}({itemCache:e,itemKey:a}),v=r.buildItemFromServerResponse({itemFromServer:p,key:f,parentKey:d}),m=function(e){var t=e.itemCache,n=e.itemKey,r=e.itemCacheToKOStoreCommands.getCommandStates(t,{itemKey:n}),i={};for(var s in r)0!==r[s]&&(i[s]=""+r[s]);return i}({itemCache:e,itemKey:a,itemCacheToKOStoreCommands:t});return{item:c.graft(l.default(h,v),{properties:{commandsSupported:new c.ReplacePatch(m)}})}};return{instance:n.createControlHandler()(function(){return function(e){return a}})}}}})});
define("odsp-next/dataSources/item/od/ItemCacheToKOStoreCommands",["require","exports","tslib","@ms/odsp-shared/lib/base/BaseModel","../../../dataSources/item/odc/SkyApiCommands","@ms/odsp-utilities/lib/resources/Resources","@ms/items-view-addon-graph/lib/models/facets/DriveItemResponseFacet","../../../utilities/mime/MimeHelper","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view-addon-graph/lib/utilities/hasPermission","@ms/items-view/lib/private/facets/DocumentFacets","../../../resources/ProviderResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var h;!function(e){e[e.NO_PERMISSION=0]="NO_PERMISSION";e[e.HAS_PERMISSION=1]="HAS_PERMISSION"}(h||(h={}));var p,d={XLSX:1,XLSM:1,XLSB:1,XLS:1,ODS:1,ONE:2,PPTX:3,PPSX:3,PPT:3,PPS:3,POT:3,PPTM:3,POTM:3,POTX:3,PPSM:3,ODP:3,PPA:3,PPAM:3,DOCX:4,DOCM:4,DOC:4,DOTX:4,DOT:4,DOTM:4,ODT:4,VSDX:5,VSDM:5,VSSX:5,VSSM:5,VSTX:5,VSTM:5,VDW:5,VSD:5,VSS:5,VST:5,VSW:5,VDX:5,VSX:5,VTX:5,MPP:6,MPT:6,PUB:7};!function(e){e[e.NO_PERMISSION=0]="NO_PERMISSION";e[e.CAN_MULTI_SHARE_COMMAND_STATE=1]="CAN_MULTI_SHARE_COMMAND_STATE";e[e.CAN_SHARE_COMMAND_STATE=2]="CAN_SHARE_COMMAND_STATE"}(p||(p={}));var v=["PSD","PSB"],m="image/jpeg",g=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._userInfoProvider=n.userInfoProvider;return r}t.prototype.getCommandStates=function(e,t){var n,r=t.itemKey,s=e.demandItemFacet(o.driveItemResponseFacet,r),c=e.demandItemFacet(a.fileNameFacet,r),g=f.hasRequiredItemRole(e,{itemKey:r,oneOfRequiredRoles:["write","owner"]}),y=!!e.demandItemFacet(a.folderFacet,r),b=(c.extension||"").toUpperCase(),w=!!d[b]&&d[b]<=4,E={itemKey:r,driveItemResponse:s,fileName:c.name,fileExtension:"."===b[0]?b.substring(1):b,canEdit:g,canDelete:e.demandItemFacet(f.canDeleteFacet,r),canRename:e.demandItemFacet(f.canRenameFacet,r),canMove:e.demandItemFacet(f.canMoveFacet,r),canUpload:e.demandItemFacet(f.canUploadFacet,r),canDownload:e.demandItemFacet(f.canDownloadFacet,r),isOneNote:!!e.demandItemFacet(l.oneNoteFacet,r),isFolder:y,isOwner:f.isOwner(e,r),isRoot:!!s.root,hasItems:y&&(s.folder||s.remoteItem.folder).childCount>0,isPhoto:!!s.photo,isVideo:!!s.video,isAuthenticated:this._userInfoProvider.isAuthenticated(),isMountPoint:!!s.remoteItem,isBundle:!1,isWacViewEnabled:w,isSharerFolder:!1,isRestricted:!1,isPanorama:!1,isMounted:!1,canCreateOfficeDocument:!0,ownerUsesODF:!1,isBadgerUser:!1,isAdmin:!1,isUserRoleFromViewToken:!1};return(n={})[i.abdicatePermissions]=h.NO_PERMISSION,n[i.addCoverPhoto]=h.NO_PERMISSION,n[i.applyOfficeLens]=h.NO_PERMISSION,n[i.addTag]=h.NO_PERMISSION,n[i.addToAlbum]=h.NO_PERMISSION,n[i.addToSharedList]=h.NO_PERMISSION,n[i.changeExpiration]=h.NO_PERMISSION,n[i.comment]=h.NO_PERMISSION,n[i.copy]=function(e){var t=e.canMove,n=e.isAuthenticated,r=e.isOwner,i=e.isMounted,s=e.isMountPoint,o=e.isRoot,u=e.isSharerFolder,a=e.isBundle;return!n||!t||u||a||o||!r&&!i||s?h.NO_PERMISSION:h.HAS_PERMISSION}(E),n[i.createExcel]=function(e){var t=e.canCreateOfficeDocument,n=e.canEdit;if(!t)return 0;return n?1:2}(E),n[i.createExcelSurvey]=function(e){var t=e.canEdit,n=e.canCreateOfficeDocument,r=e.ownerUsesODF;return t&&n&&!r?h.HAS_PERMISSION:h.NO_PERMISSION}(E),n[i.createFolder]=h.NO_PERMISSION,n[i.createMountPoint]=function(e){var t=e.canEdit,n=e.isFolder,r=e.isBundle,i=e.isMounted,s=e.isMountPoint,o=e.isOwner;return!t||!n||r||i||s||o?h.NO_PERMISSION:h.HAS_PERMISSION}(E),n[i.createOneNote]=E.canCreateOfficeDocument?h.HAS_PERMISSION:h.NO_PERMISSION,n[i.createPowerPoint]=function(e){var t=e.canCreateOfficeDocument,n=e.canEdit;if(!t)return 0;return n?1:2}(E),n[i.createWord]=function(e){var t=e.canCreateOfficeDocument,n=e.canEdit;if(!t)return 0;return n?1:2}(E),n[i.defaultClick]=function(e){var t=e.fileExtension,n=e.isRestricted,r=e.isOwner,i=e.isPhoto,s=e.isVideo,o=e.isFolder;if(n&&!r&&!i&&!s)return 50;if(o)return 1;var a=u.canOpenInMonaco(t),f=-1!==v.indexOf(t);if(i||s||a)return 1;if(f)return 1;return 4}(E),n[i.deleteCommand]=function(e){var t=e.canDelete,n=e.isOwner,r=e.isRestricted,i=e.isMountPoint,s=e.isMounted;return r&&!n||!t||i||!n&&!s?h.NO_PERMISSION:h.HAS_PERMISSION}(E),n[i.download]=function(e){var t=e.canDownload,n=e.isOneNote,r=e.isFolder,i=e.isOwner,s=e.isRoot,o=e.isSharerFolder,u=e.isRestricted,a=e.hasItems,f=!s&&a;return u&&!i||!t||n||o||r&&!f?h.NO_PERMISSION:h.HAS_PERMISSION}(E),n[i.editSurvey]=h.NO_PERMISSION,n[i.embed]=function(e){var t=e.isAuthenticated,n=e.isRoot,r=e.isBundle;return!t||n||r?h.NO_PERMISSION:h.HAS_PERMISSION}(E),n[i.emptyRecycleBin]=h.NO_PERMISSION,n[i.modifyCaption]=function(e){var t=e.canEdit,n=e.isAuthenticated,r=e.isRoot;return n&&t&&!r?h.HAS_PERMISSION:h.NO_PERMISSION}(E),n[i.move]=function(e){var t=e.canMove,n=e.isAuthenticated,r=e.isOwner,i=e.isMounted,s=e.isMountPoint,o=e.isRoot;return n&&t&&!o&&(r||i)&&!s?h.HAS_PERMISSION:h.NO_PERMISSION}(E),n[i.openInOffice]=function(e){var t=e.canEdit,n=e.isBadgerUser,r=e.isAdmin,i=e.isUserRoleFromViewToken,s=e.fileExtension;if(t&&!n&&!r&&!i){var o=d[s];if(o)return o}return h.NO_PERMISSION}(E),n[i.playAudio]=h.NO_PERMISSION,n[i.rearrange]=h.NO_PERMISSION,n[i.removeCoverPhoto]=h.NO_PERMISSION,n[i.removeFromAlbum]=h.NO_PERMISSION,n[i.removeFromRecent]=h.NO_PERMISSION,n[i.removeMountPoint]=function(e){var t=e.canEdit,n=e.isMounted,r=e.isMountPoint;return t&&n&&r?h.HAS_PERMISSION:h.NO_PERMISSION}(E),n[i.rename]=function(e){var t=e.canRename,n=e.isAuthenticated,r=e.isOwner,i=e.isMounted,s=e.isRoot;return n&&t&&!s&&(r||i)?h.HAS_PERMISSION:h.NO_PERMISSION}(E),n[i.removeOfficeLens]=h.NO_PERMISSION,n[i.reportAbuse]=function(e){var t=e.isAuthenticated,n=e.isRestricted,r=e.isOwner,i=e.isAdmin;return!t||n||r||i?h.NO_PERMISSION:h.HAS_PERMISSION}(E),n[i.requestReview]=h.NO_PERMISSION,n[i.restore]=h.NO_PERMISSION,n[i.restoreAll]=h.NO_PERMISSION,n[i.rotate]=function(e){var t=e.canEdit,n=e.driveItemResponse,r=e.isAuthenticated,i=e.isPhoto,s=!!n.file&&n.file.mimeType&&n.file.mimeType.toLowerCase()===m;return r&&i&&t&&s?h.HAS_PERMISSION:h.NO_PERMISSION}(E),n[i.share]=function(e){var t=e.canEdit,n=e.isAuthenticated,r=e.isRestricted,i=e.isOwner,s=e.isBundle,o=e.isRoot;if(!n||r&&!i||!t||o)return p.NO_PERMISSION;return s?p.CAN_SHARE_COMMAND_STATE:p.CAN_MULTI_SHARE_COMMAND_STATE}(E),n[i.shareSurvey]=h.NO_PERMISSION,n[i.upload]=function(e){var t=e.canUpload,n=e.isAuthenticated,r=e.isBundle;return n&&t&&!r?h.HAS_PERMISSION:h.NO_PERMISSION}(E),n[i.viewInBrowser]=function(e){return e.isWacViewEnabled?h.HAS_PERMISSION:h.NO_PERMISSION}(E),n[i.viewOriginal]=function(e){var t=e.isRestricted,n=e.isOwner,r=e.isPanorama;return t&&!n||r?h.NO_PERMISSION:h.HAS_PERMISSION}(E),n[i.viewSurvey]=h.NO_PERMISSION,n[i.viewVersions]=h.NO_PERMISSION,n};t.dependencies=n.__assign({},r.default.dependencies,{userInfoProvider:c.userInfo});return t}(r.default);t.default=g;t.resourceKey=s.createResolvedResourceKey(e("module").id,g)});
define("odsp-next/controls/itemsScope/odc/CreateDocumentActionControlHandler",["require","exports","@ms/items-view/lib/private/addons/registerControlHandler","@ms/items-view/lib/private/operations/createDocument/DocumentType"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.createDocumentActionControlHandler=n.createControlHandler()(function(){return function(e){return function(e,t){var n=!0;switch(t.documentType){case r.DocumentType.Word:case r.DocumentType.Excel:case r.DocumentType.ExcelSurvey:case r.DocumentType.PowerPoint:case r.DocumentType.OneNote:case r.DocumentType.Prague:case r.DocumentType.Bohemia:case r.DocumentType.ExcelForm:case r.DocumentType.Visio:n=!1}return{isAvailable:n,askForFileName:!1,validator:function(){}}}}})});
define("odsp-next/controls/itemsScope/UserHoverCardLauncher",["require","exports","tslib","react","office-ui-fabric-react/lib/Utilities","../../controls/personaCard/EasyLpc","@ms/items-view/lib/private/facets/PersonFacets","@ms/items-view/lib/private/facets/ItemFacets","../../utilities/features/Features","../base/react/WithResources","@ms/items-view/lib/private/components/decorators/connectToItemCache"],function(e,t,n,r,i,s,o,u,a,f,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var c=a.isFeatureEnabled(a.PeopleCardsReactComponent),h=a.isFeatureEnabled(a.PeopleCardsOnLoki),p=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.resources,n=e.user,o=i.css("od-FieldRender","od-FieldRender-nofill",{"od-FieldRender-person":h||c}),u=n.email||n.sip,a=r.createElement("span",{className:o},this.props.children);return r.createElement(s.EasyLpc,{resourceScope:t,personaType:"User",identifier:u,loggingData:{name:"UserRenderer.LPC.Click"},placeHolder:a},a)};return t}(r.PureComponent),d=f.withResources()(p),v=l.connectToItemCache(function(e,t){var r=t.personKey,i=t.displayValue,s=e.demandItem({title:u.displayNameFacet,email:o.emailFacet,picture:o.pictureFacet,sip:o.sipFacet},r);return{user:n.__assign({},s,i?{title:i}:{})}})(d);t.UserHoverCard=function(e){var t=e.user,i=n.__rest(e,["user"]);return t?r.createElement(d,n.__assign({user:t},i)):r.createElement(v,n.__assign({},e))}});
define("odsp-next/controls/itemPicker/itemsScope/ItemsPicker",["require","exports","tslib","react","@ms/items-view/lib/private/components/picker/ItemsPicker","@ms/odsp-shared-react/lib/utilities/resources/Resources","../../../bindings/component/ReactControlBinding"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(i.ItemsPicker,n.__assign({},this.props))};t.contextTypes=n.__assign({},s.RESOLVED_COMPONENT_CONTEXT_TYPES);return t}(r.PureComponent);t.ItemsPicker=u;t.resourceKey=s.createResolvedComponentTypeResourceKey(e("module").id,u,{});t.knockoutResourceKey=o.createKnockoutResourceKeyFromReactKey(t.resourceKey,{automationName:"ms-items-picker",name:e("module").id+".knockout"})});
define("@ms/items-view/lib/private/components/picker/ItemsPicker",["require","exports","tslib","react","../decorators/withControlHandler","./PickerContext","../action/Action","../withItemCache/WithItemCache","../../controls/defaultClickActionControl","../actions/defaultClick/handlers/open","../../controls/itemSetSelectionControl","../../controls/filteredItemSetControl","../../models/itemSets/filters/itemTypeFilterHandler","../../controls/currentItemSetControl","./actions/defaultClickActionHandlers/completePicker","../commands/new/newCommand","../commands/createFolder/createFolderCommand","../commands/upload/uploadCommand","../commands/showProgress/showProgressCommand","../commands/switchLayout/switchLayoutCommand","../../controls/itemsCommandBarControl","../../controls/itemsContextMenuControl","../../controls/itemHeroCommandsControl"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var x=[],T=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(o.Action,null)};return t}(r.PureComponent),N=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return r.createElement(o.Action,null)};return t}(r.PureComponent);t.createPickerCompleteAction=function(e){return function(t){n.__extends(i,t);function i(){return null!==t&&t.apply(this,arguments)||this}i.prototype.render=function(){var t=this,i=this.props.itemKeys;return r.createElement(u.WithItemCache,null,function(s){var u=s.dispatch;return r.createElement(o.Action,{onExecute:function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,u(e({itemKeys:i}))];case 1:t.sent();return[2]}})})}})})};return i}(r.PureComponent)};t.createPickerFailAction=function(e){return function(t){n.__extends(i,t);function i(){return null!==t&&t.apply(this,arguments)||this}i.prototype.render=function(){var t=this,i=this.props.error;return r.createElement(u.WithItemCache,null,function(s){var u=s.dispatch;return r.createElement(o.Action,{onExecute:function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,u(e({error:i}))];case 1:t.sent();return[2]}})})}})})};return i}(r.PureComponent)};var C=function(e){n.__extends(t,e);function t(t){var i=e.call(this,t)||this;i._defaultClickActionControlHandler=function(e,t){var n=i.props.selectionMode,r=void 0===n?"single":n;return{handlers:[f.openDefaultClickActionHandler].concat("pick"===r?[d.completePickerDefaultClickActionHandler]:[])}};i._currentItemSetControlHandler=function(e,t){var n=t.itemKey,r=i.props.filters,s=void 0===r?x:r;if(s.length<=0||!n)return{};var o=e.demandItemFacet(c.filteredItemSetControl,t.itemKey);return{itemKey:c.filteredItemSetControl.evaluate(o)(e,{itemKey:n,handlers:s}).itemKey}};i._itemSetSelectionControlHandler=function(e,t){var r=i.props,s=r.filters,o=r.selectionMode,u=void 0===o?"single":o,a=r.itemMode,f=void 0===a?"files":a;return"pick"===u?{selectionMode:"none",canSelectItem:function(){return!1}}:{selectionMode:u,canSelectItem:function(e,t){return k(e,n.__assign({},t,{itemMode:f,filters:s}))}}};i._itemsCommandBarControlHandler=function(e,t){var r=t.commands,s=t.farCommands,o=t.overflowCommands,u=t.shortcutCommands,a=i.props.commandMode,f=void 0===a?"safe-write":a;return"all"===f?{}:n.__assign({},r?{commands:L(r,f)}:{},s?{farCommands:L(s,f)}:{},o?{overflowCommands:L(o,f)}:{},u?{shortcutCommands:L(u,f)}:{})};i._itemsContextMenuControlHandler=function(e,t){var r=t.commands,s=i.props.commandMode,o=void 0===s?"safe-write":s;return"all"===o?{}:n.__assign({},r?{commands:L(r,o)}:{})};i._itemHeroCommandControlHandler=function(e,t){var r=t.commands,s=i.props.commandMode,o=void 0===s?"safe-write":s;return"all"===o?{}:n.__assign({},r?{commands:L(r,o)}:{})};i._controlHandlers=n.__assign({},a.defaultClickActionControl.pack(i._defaultClickActionControlHandler),l.itemSetSelectionControl.pack(i._itemSetSelectionControlHandler),p.currentItemSetControl.pack(i._currentItemSetControlHandler),w.itemsCommandBarControl.pack(i._itemsCommandBarControlHandler),E.itemsContextMenuControl.pack(i._itemsContextMenuControlHandler),S.itemHeroCommandsControl.pack(i._itemHeroCommandControlHandler));var s=i;i._completePickerActionType=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=s.props,i=t.filters,a=t.itemMode,f=void 0===a?"files":a,l=t.completeAction,c=void 0===l?T:l;return r.createElement(u.WithItemCache,null,function(t){for(var s=t.itemCache,u=0,a=e.props.itemKeys;u<a.length;u++){if(!k(s,{itemKey:a[u],filters:i,itemMode:f}))return r.createElement(o.Action,null)}return r.createElement(c,n.__assign({},e.props))})};return t}(r.PureComponent);i._failPickerActionType=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=s.props.failAction,t=void 0===e?N:e;return r.createElement(t,n.__assign({},this.props))};return t}(r.PureComponent);return i}t.prototype.render=function(){return r.createElement(s.PICKER_CONTEXT.Provider,{value:{completeAction:this._completePickerActionType,failAction:this._failPickerActionType}},r.createElement(i.ControlHandlerProvider,{controlHandlers:this._controlHandlers},this.props.children))};return t}(r.PureComponent);t.ItemsPicker=C;function k(e,t){var n=t.filters,r=t.itemMode;if("folders"===r){if(!h.itemFolderTypeFilterHandler.filter(e,t))return!1}else if("files"===r&&!h.itemNonFolderTypeFilterHandler.filter(e,t))return!1;if(!n||0===n.length)return!0;for(var i=0,s=n;i<s.length;i++){if(s[i].filter(e,t))return!0}return!1}function L(e,t){if("all"===t)return e;for(var r=[],i=0,s=e;i<s.length;i++){var o=s[i];if(o.key===v.newCommand.key){var u=o.subMenuProps&&o.subMenuProps.items;u&&r.push(n.__assign({},o,{subMenuProps:n.__assign({},o.subMenuProps,{items:L(u,t)})}))}else o.key===m.createFolderCommand.key||o.key===g.uploadCommand.key?"safe-write"===t&&r.push(o):o.key!==y.showProgressCommand.key&&o.key!==b.switchLayoutCommand.key||r.push(o)}return r}});
define("@ms/items-view/lib/private/components/picker/PickerContext",["require","exports","react"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PICKER_CONTEXT=n.createContext(void 0)});
define("@ms/items-view/lib/private/components/picker/actions/defaultClickActionHandlers/completePicker",["require","exports","react","../../../../models/Facet","../../../../facets/ItemFacets","../PickerCompleteAction"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.completePickerDefaultClickActionHandler={key:new r.Facet("completePickerDefaultClickActionHandler").id,evaluate:function(e,t){return{action:e.demandItemFacet(i.folderFacet,t.itemKey)?void 0:n.createElement(s.ItemPickerCompleteAction,{itemKeys:[t.itemKey]})}}}});
define("@ms/items-view/lib/private/components/picker/actions/PickerCompleteAction",["require","exports","tslib","react","../PickerContext","../../decorators/selectors"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.itemKeys;return r.createElement(i.PICKER_CONTEXT.Consumer,null,function(t){if(!t)return null;var n=t.completeAction;return r.createElement(n,{itemKeys:e})})};return t}(r.PureComponent);t.ItemPickerCompleteAction=o;t.PickerCompleteAction=s.withSelectedItems()(s.withCurrentItemAsFallback()(o))});
define("@ms/items-view/lib/private/components/reactDragDrop/DragDropHook",["require","exports","tslib","react","../decorators/connectToItemCache","@ms/utilities-react-drag-drop/lib/drag-drop-context-provider/DragDropContextProviderWrapper","@ms/utilities-react-drag-drop/lib/drop-target/DropTargetWrapper","@ms/utilities-react-drag-drop/lib/drag-source/DragSourceWrapper","./DragLayerPreview"],function(e,t,n,r,i,s,o,u,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DropTargetHook=i.connectToItemCache()(function(e){e.itemCacheDispatch;var t=n.__rest(e,["itemCacheDispatch"]);return r.createElement(s.DragDropContextProviderWrapper,null,r.createElement(o.DropTargetHookWrapper,n.__assign({},t)))});t.DragSourceHook=i.connectToItemCache()(function(e){e.itemCacheDispatch;var t=n.__rest(e,["itemCacheDispatch"]),i=t.dragSourceKey,o=t.type;return r.createElement(s.DragDropContextProviderWrapper,null,r.createElement(u.DragSourceHookWrapper,n.__assign({},t)),r.createElement(u.DragLayerHookWrapper,{dragSourceKey:i,type:o},r.createElement(a.DragLayerPreview,null)))})});
define("@ms/utilities-react-drag-drop/lib/drag-drop-context-provider/DragDropContextProviderWrapper",["require","exports","tslib","react","../backends/odsp-react-dnd-html5-backend","react-dnd","./../Constants"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){switch(this.props.backend){case o.Backend.HTML5Backend:default:return r.createElement(s.DndProvider,{backend:i.odspReactDndHTML5Backend},this.props.children)}};return t}(r.PureComponent);t.DragDropContextProviderWrapper=u});
define("@ms/utilities-react-drag-drop/lib/backends/odsp-react-dnd-html5-backend",["require","exports","react-dnd-html5-backend"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={handleTopDragStart:"dragStartSourceIds",handleTopDragOver:"dragOverTargetIds",handleTopDragEnter:"dragEnterTargetIds",handleTopDrop:"dropTargetIds"};t.odspReactDndHTML5Backend=function(e){var t=n.default(e),i={},s=function(e){if(!r[e])return"continue";i[e]=t[e];t[e]=function(n){var s=t[r[e]];s&&s.length&&i[e](n)}};for(var o in r)s(o);return t}});
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define('react-dnd-html5-backend',[],t):"object"==typeof exports?exports["react-dnd-html5-backend"]=t():e["react-dnd-html5-backend"]=t()}(window,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FILE="__NATIVE_FILE__",t.URL="__NATIVE_URL__",t.TEXT="__NATIVE_TEXT__"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.memoize=function(e){var t=null;return function(){return null==t&&(t=e()),t}},t.without=function(e,t){return e.filter(function(e){return e!==t})},t.union=function(e,t){var r=new Set,n=function(e){return r.add(e)};e.forEach(n),t.forEach(n);var o=[];return r.forEach(function(e){return o.push(e)}),o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.isFirefox=n.memoize(function(){return/firefox/i.test(navigator.userAgent)}),t.isSafari=n.memoize(function(){return Boolean(window.safari)})},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(4)),a=o(r(0));t.NativeTypes=a;var s=r(13);t.getEmptyImage=s.getEmptyImage;t.default=function(e,t){return new i.default(e,t)}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var a=o(r(5)),s=r(2),u=r(6),d=r(8),c=i(r(0)),f=r(12),g=function(){function e(e,t){var r=this;this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.getSourceClientOffset=function(e){return u.getNodeClientOffset(r.sourceNodes.get(e))},this.endDragNativeItem=function(){r.isDraggingNativeItem()&&(r.actions.endDrag(),r.registry.removeSource(r.currentNativeHandle),r.currentNativeHandle=null,r.currentNativeSource=null)},this.isNodeInDocument=function(e){return r.document&&r.document.body&&document.body.contains(e)},this.endDragIfSourceWasRemovedFromDOM=function(){var e=r.currentDragSourceNode;r.isNodeInDocument(e)||r.clearCurrentDragSourceNode()&&r.actions.endDrag()},this.handleTopDragStartCapture=function(){r.clearCurrentDragSourceNode(),r.dragStartSourceIds=[]},this.handleTopDragStart=function(e){if(!e.defaultPrevented){var t=r.dragStartSourceIds;r.dragStartSourceIds=null;var n=u.getEventClientOffset(e);r.monitor.isDragging()&&r.actions.endDrag(),r.actions.beginDrag(t||[],{publishSource:!1,getSourceClientOffset:r.getSourceClientOffset,clientOffset:n});var o=e.dataTransfer,i=d.matchNativeItemType(o);if(r.monitor.isDragging()){if(o&&"function"==typeof o.setDragImage){var a=r.monitor.getSourceId(),s=r.sourceNodes.get(a),c=r.sourcePreviewNodes.get(a)||s;if(c){var f=r.getCurrentSourcePreviewNodeOptions(),g={anchorX:f.anchorX,anchorY:f.anchorY},l={offsetX:f.offsetX,offsetY:f.offsetY},p=u.getDragPreviewOffset(s,c,n,g,l);o.setDragImage(c,p.x,p.y)}}try{o.setData("application/json",{})}catch(e){}r.setCurrentDragSourceNode(e.target),r.getCurrentSourcePreviewNodeOptions().captureDraggingState?r.actions.publishDragSource():setTimeout(function(){return r.actions.publishDragSource()},0)}else if(i)r.beginDragNativeItem(i);else{if(o&&!o.types&&(e.target&&!e.target.hasAttribute||!e.target.hasAttribute("draggable")))return;e.preventDefault()}}},this.handleTopDragEndCapture=function(){r.clearCurrentDragSourceNode()&&r.actions.endDrag()},this.handleTopDragEnterCapture=function(e){if(r.dragEnterTargetIds=[],r.enterLeaveCounter.enter(e.target)&&!r.monitor.isDragging()){var t=e.dataTransfer,n=d.matchNativeItemType(t);n&&r.beginDragNativeItem(n)}},this.handleTopDragEnter=function(e){var t=r.dragEnterTargetIds;(r.dragEnterTargetIds=[],r.monitor.isDragging())&&(r.altKeyPressed=e.altKey,s.isFirefox()||r.actions.hover(t,{clientOffset:u.getEventClientOffset(e)}),t.some(function(e){return r.monitor.canDropOnTarget(e)})&&(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=r.getCurrentDropEffect())))},this.handleTopDragOverCapture=function(){r.dragOverTargetIds=[]},this.handleTopDragOver=function(e){var t=r.dragOverTargetIds;if(r.dragOverTargetIds=[],!r.monitor.isDragging())return e.preventDefault(),void(e.dataTransfer&&(e.dataTransfer.dropEffect="none"));r.altKeyPressed=e.altKey,r.actions.hover(t||[],{clientOffset:u.getEventClientOffset(e)}),(t||[]).some(function(e){return r.monitor.canDropOnTarget(e)})?(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect=r.getCurrentDropEffect())):r.isDraggingNativeItem()?e.preventDefault():(e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=function(e){r.isDraggingNativeItem()&&e.preventDefault(),r.enterLeaveCounter.leave(e.target)&&r.isDraggingNativeItem()&&r.endDragNativeItem()},this.handleTopDropCapture=function(e){r.dropTargetIds=[],e.preventDefault(),r.isDraggingNativeItem()&&r.currentNativeSource.mutateItemByReadingDataTransfer(e.dataTransfer),r.enterLeaveCounter.reset()},this.handleTopDrop=function(e){var t=r.dropTargetIds;r.dropTargetIds=[],r.actions.hover(t,{clientOffset:u.getEventClientOffset(e)}),r.actions.drop({dropEffect:r.getCurrentDropEffect()}),r.isDraggingNativeItem()?r.endDragNativeItem():r.endDragIfSourceWasRemovedFromDOM()},this.handleSelectStart=function(e){var t=e.target;"function"==typeof t.dragDrop&&("INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable||(e.preventDefault(),t.dragDrop()))},this.options=new f.OptionsReader(t),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.registry=e.getRegistry(),this.enterLeaveCounter=new a.default(this.isNodeInDocument)}return Object.defineProperty(e.prototype,"window",{get:function(){return this.options.window},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"document",{get:function(){return this.options.document},enumerable:!0,configurable:!0}),e.prototype.setup=function(){if(void 0!==this.window){if(this.window.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");this.window.__isReactDndBackendSetUp=!0,this.addEventListeners(this.window)}},e.prototype.teardown=function(){void 0!==this.window&&(this.window.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.window),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId&&this.window.cancelAnimationFrame(this.asyncEndDragFrameId))},e.prototype.connectDragPreview=function(e,t,r){var n=this;return this.sourcePreviewNodeOptions.set(e,r),this.sourcePreviewNodes.set(e,t),function(){n.sourcePreviewNodes.delete(e),n.sourcePreviewNodeOptions.delete(e)}},e.prototype.connectDragSource=function(e,t,r){var n=this;this.sourceNodes.set(e,t),this.sourceNodeOptions.set(e,r);var o=function(t){return n.handleDragStart(t,e)},i=function(e){return n.handleSelectStart(e)};return t.setAttribute("draggable","true"),t.addEventListener("dragstart",o),t.addEventListener("selectstart",i),function(){n.sourceNodes.delete(e),n.sourceNodeOptions.delete(e),t.removeEventListener("dragstart",o),t.removeEventListener("selectstart",i),t.setAttribute("draggable","false")}},e.prototype.connectDropTarget=function(e,t){var r=this,n=function(t){return r.handleDragEnter(t,e)},o=function(t){return r.handleDragOver(t,e)},i=function(t){return r.handleDrop(t,e)};return t.addEventListener("dragenter",n),t.addEventListener("dragover",o),t.addEventListener("drop",i),function(){t.removeEventListener("dragenter",n),t.removeEventListener("dragover",o),t.removeEventListener("drop",i)}},e.prototype.addEventListeners=function(e){e.addEventListener&&(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))},e.prototype.removeEventListeners=function(e){e.removeEventListener&&(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))},e.prototype.getCurrentSourceNodeOptions=function(){var e=this.monitor.getSourceId(),t=this.sourceNodeOptions.get(e);return n({dropEffect:this.altKeyPressed?"copy":"move"},t||{})},e.prototype.getCurrentDropEffect=function(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect},e.prototype.getCurrentSourcePreviewNodeOptions=function(){var e=this.monitor.getSourceId(),t=this.sourcePreviewNodeOptions.get(e);return n({anchorX:.5,anchorY:.5,captureDraggingState:!1},t||{})},e.prototype.isDraggingNativeItem=function(){var e=this.monitor.getItemType();return Object.keys(c).some(function(t){return c[t]===e})},e.prototype.beginDragNativeItem=function(e){this.clearCurrentDragSourceNode(),this.currentNativeSource=d.createNativeDragSource(e),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])},e.prototype.setCurrentDragSourceNode=function(e){var t=this;this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e;this.mouseMoveTimeoutTimer=setTimeout(function(){return t.window&&t.window.addEventListener("mousemove",t.endDragIfSourceWasRemovedFromDOM,!0)},1e3)},e.prototype.clearCurrentDragSourceNode=function(){return!!this.currentDragSourceNode&&(this.currentDragSourceNode=null,this.window&&(this.window.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.window.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)),this.mouseMoveTimeoutTimer=null,!0)},e.prototype.handleDragStart=function(e,t){e.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(t))},e.prototype.handleDragEnter=function(e,t){this.dragEnterTargetIds.unshift(t)},e.prototype.handleDragOver=function(e,t){null===this.dragOverTargetIds&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(t)},e.prototype.handleDrop=function(e,t){this.dropTargetIds.unshift(t)},e}();t.default=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=function(){function e(e){this.entered=[],this.isNodeInDocument=e}return e.prototype.enter=function(e){var t=this,r=this.entered.length;return this.entered=n.union(this.entered.filter(function(r){return t.isNodeInDocument(r)&&(!r.contains||r.contains(e))}),[e]),0===r&&this.entered.length>0},e.prototype.leave=function(e){var t=this.entered.length;return this.entered=n.without(this.entered.filter(this.isNodeInDocument),e),t>0&&0===this.entered.length},e.prototype.reset=function(){this.entered=[]},e}();t.default=o},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(2),i=n(r(7)),a=1;function s(e){var t=e.nodeType===a?e:e.parentElement;if(!t)return null;var r=t.getBoundingClientRect(),n=r.top;return{x:r.left,y:n}}t.getNodeClientOffset=s,t.getEventClientOffset=function(e){return{x:e.clientX,y:e.clientY}},t.getDragPreviewOffset=function(e,t,r,n,a){var u,d,c="IMG"===(u=t).nodeName&&(o.isFirefox()||!document.documentElement.contains(u)),f=s(c?e:t),g={x:r.x-f.x,y:r.y-f.y},l=e.offsetWidth,p=e.offsetHeight,h=n.anchorX,v=n.anchorY,m=function(e,t,r,n){var i=e?t.width:r,a=e?t.height:n;return o.isSafari()&&e&&(a/=window.devicePixelRatio,i/=window.devicePixelRatio),{dragPreviewWidth:i,dragPreviewHeight:a}}(c,t,l,p),D=m.dragPreviewWidth,y=m.dragPreviewHeight,T=a.offsetX,E=a.offsetY,w=0===E||E;return{x:0===T||T?T:new i.default([0,.5,1],[g.x,g.x/l*D,g.x+D-l]).interpolate(h),y:w?E:(d=new i.default([0,.5,1],[g.y,g.y/p*y,g.y+y-p]).interpolate(v),o.isSafari()&&c&&(d+=(window.devicePixelRatio-1)*y),d)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=e.length,n=[],o=0;o<r;o++)n.push(o);n.sort(function(t,r){return e[t]<e[r]?-1:1});var i,a,s=[],u=[],d=[];for(o=0;o<r-1;o++)i=e[o+1]-e[o],a=t[o+1]-t[o],u.push(i),s.push(a),d.push(a/i);var c=[d[0]];for(o=0;o<u.length-1;o++){var f=d[o],g=d[o+1];if(f*g<=0)c.push(0);else{i=u[o];var l=u[o+1],p=i+l;c.push(3*p/((p+l)/f+(p+i)/g))}}c.push(d[d.length-1]);var h,v=[],m=[];for(o=0;o<c.length-1;o++){h=d[o];var D=c[o],y=1/u[o];p=D+c[o+1]-h-h;v.push((h-D-p)*y),m.push(p*y*y)}this.xs=e,this.ys=t,this.c1s=c,this.c2s=v,this.c3s=m}return e.prototype.interpolate=function(e){var t=this,r=t.xs,n=t.ys,o=t.c1s,i=t.c2s,a=t.c3s,s=r.length-1;if(e===r[s])return n[s];for(var u,d=0,c=a.length-1;d<=c;){var f=r[u=Math.floor(.5*(d+c))];if(f<e)d=u+1;else{if(!(f>e))return n[u];c=u-1}}var g=e-r[s=Math.max(0,c)],l=g*g;return n[s]+o[s]*g+i[s]*l+a[s]*g*l},e}();t.default=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9),o=r(11);t.createNativeDragSource=function(e){return new o.NativeDragSource(n.nativeTypesConfig[e])},t.matchNativeItemType=function(e){if(!e)return null;var t=Array.prototype.slice.call(e.types||[]);return Object.keys(n.nativeTypesConfig).filter(function(e){return n.nativeTypesConfig[e].matchesTypes.some(function(e){return t.indexOf(e)>-1})})[0]||null}},function(e,t,r){"use strict";var n,o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=o(r(0)),a=r(10);t.nativeTypesConfig=((n={})[i.FILE]={exposeProperties:{files:function(e){return Array.prototype.slice.call(e.files)},items:function(e){return e.items}},matchesTypes:["Files"]},n[i.URL]={exposeProperties:{urls:function(e,t){return a.getDataFromDataTransfer(e,t,"").split("\n")}},matchesTypes:["Url","text/uri-list"]},n[i.TEXT]={exposeProperties:{text:function(e,t){return a.getDataFromDataTransfer(e,t,"")}},matchesTypes:["Text","text/plain"]},n)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDataFromDataTransfer=function(e,t,r){var n=t.reduce(function(t,r){return t||e.getData(r)},"");return null!=n?n:r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=this;this.config=e,this.item={},Object.keys(this.config.exposeProperties).forEach(function(e){Object.defineProperty(t.item,e,{configurable:!0,enumerable:!0,get:function(){return console.warn("Browser doesn't allow reading \""+e+'" until the drop event.'),null}})})}return e.prototype.mutateItemByReadingDataTransfer=function(e){var t=this,r={};e&&Object.keys(this.config.exposeProperties).forEach(function(n){r[n]={value:t.config.exposeProperties[n](e,t.config.matchesTypes)}}),Object.defineProperties(this.item,r)},e.prototype.canDrag=function(){return!0},e.prototype.beginDrag=function(){return this.item},e.prototype.isDragging=function(e,t){return t===e.getSourceId()},e.prototype.endDrag=function(){},e}();t.NativeDragSource=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.globalContext=e}return Object.defineProperty(e.prototype,"window",{get:function(){return this.globalContext?this.globalContext:"undefined"!=typeof window?window:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"document",{get:function(){if(this.window)return this.window.document},enumerable:!0,configurable:!0}),e}();t.OptionsReader=n},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.getEmptyImage=function(){return n||((n=new Image).src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),n}}])});
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react")):"function"==typeof define&&define.amd?define('react-dnd',["react"],t):"object"==typeof exports?exports["react-dnd"]=t(require("react")):e["react-dnd"]=t(e.React)}(window,function(e){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=10)}([function(e,t,r){"use strict";e.exports=function(e,t,r,n,o,i,a,u){if(!e){var s;if(void 0===t)s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[r,n,o,i,a,u],d=0;(s=new Error(t.replace(/%s/g,function(){return c[d++]}))).name="Invariant Violation"}throw s.framesToPop=1,s}}},function(t,r){t.exports=e},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.INIT_COORDS="dnd-core/INIT_COORDS",t.BEGIN_DRAG="dnd-core/BEGIN_DRAG",t.PUBLISH_DRAG_SOURCE="dnd-core/PUBLISH_DRAG_SOURCE",t.HOVER="dnd-core/HOVER",t.DROP="dnd-core/DROP",t.END_DRAG="dnd-core/END_DRAG"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFunction=function(e){return"function"==typeof e},t.noop=function(){},t.isPlainObject=function(e){if(!function(e){return"object"==typeof e&&null!==e}(e))return!1;if(null===Object.getPrototypeOf(e))return!0;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.get=function(e,t,r){return t.split(".").reduce(function(e,t){return e&&e[t]?e[t]:r||null},e)},t.without=function(e,t){return e.filter(function(e){return e!==t})},t.isString=function(e){return"string"==typeof e},t.isObject=function(e){return"object"==typeof e},t.xor=function(e,t){var r=new Map,n=function(e){return r.set(e,r.has(e)?r.get(e)+1:1)};e.forEach(n),t.forEach(n);var o=[];return r.forEach(function(e,t){1===e&&o.push(t)}),o},t.intersection=function(e,t){return e.filter(function(e){return t.indexOf(e)>-1})}},function(e,t,r){"use strict";function n(e){return e&&e.prototype&&"function"==typeof e.prototype.render}function o(e){return e&&e.$$typeof&&"Symbol(react.forward_ref)"===e.$$typeof.toString()}Object.defineProperty(t,"__esModule",{value:!0}),t.getDecoratedComponent=function(e){var t=e.current;return null==t?null:t.decoratedRef?t.decoratedRef.current:t},t.isClassComponent=n,t.isRefForwardingComponent=o,t.isRefable=function(e){return n(e)||o(e)},t.checkDecoratorArguments=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n]}},function(e,t){e.exports=function(e,t,r,n){var o=r?r.call(n,e,t):void 0;if(void 0!==o)return!!o;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length)return!1;for(var u=Object.prototype.hasOwnProperty.bind(t),s=0;s<i.length;s++){var c=i[s];if(!u(c))return!1;var d=e[c],f=t[c];if(!1===(o=r?r.call(n,d,f,c):void 0)||void 0===o&&d!==f)return!1}return!0}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(39)),i=n(r(41)),a=n(r(42)),u=n(r(43)),s=n(r(44));!function(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(2)),t.default=function(e){return{beginDrag:o.default(e),publishDragSource:i.default(e),hover:a.default(e),drop:u.default(e),endDrag:s.default(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ADD_SOURCE="dnd-core/ADD_SOURCE",t.ADD_TARGET="dnd-core/ADD_TARGET",t.REMOVE_SOURCE="dnd-core/REMOVE_SOURCE",t.REMOVE_TARGET="dnd-core/REMOVE_TARGET",t.addSource=function(e){return{type:t.ADD_SOURCE,payload:{sourceId:e}}},t.addTarget=function(e){return{type:t.ADD_TARGET,payload:{targetId:e}}},t.removeSource=function(e){return{type:t.REMOVE_SOURCE,payload:{sourceId:e}}},t.removeTarget=function(e){return{type:t.REMOVE_TARGET,payload:{targetId:e}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.registerTarget=function(e,t,r){var n=r.getRegistry(),o=n.addTarget(e,t);return[o,function(){return n.removeTarget(o)}]},t.registerSource=function(e,t,r){var n=r.getRegistry(),o=n.addSource(e,t);return[o,function(){return n.removeSource(o)}]}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(31)),n(r(58)),n(r(65))},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(1)),i=r(32);t.DndContext=o.createContext({dragDropManager:void 0}),t.createDndContext=function(e,t,r,n){return{dragDropManager:i.createDragDropManager(e,t,r,n)}}},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=n(r(0)),a=r(11);t.useDragDropManager=function(){var e=o.useContext(a.DndContext).dragDropManager;return i.default(null!=e,"Expected drag drop context"),e}},function(e,t,r){"use strict";(function(e,n){var o,i=r(30);o="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:n;var a=Object(i.a)(o);t.a=a}).call(this,r(12),r(36)(e))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.SOURCE="SOURCE",e.TARGET="TARGET"}(t.HandlerRole||(t.HandlerRole={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return null===t?null===e:Array.isArray(e)?e.some(function(e){return e===t}):e===t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.strictEquality=function(e,t){return e===t},t.areCoordsEqual=function(e,t){return!e&&!t||!(!e||!t)&&e.x===t.x&&e.y===t.y},t.areArraysEqual=function(e,r,n){if(void 0===n&&(n=t.strictEquality),e.length!==r.length)return!1;for(var o=0;o<e.length;++o)if(!n(e[o],r[o]))return!1;return!0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4);t.NONE=[],t.ALL=[],t.NONE.__IS_NONE__=!0,t.ALL.__IS_ALL__=!0,t.areDirty=function(e,r){return e!==t.NONE&&(e===t.ALL||void 0===r||n.intersection(r,e).length>0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(20);t.useMonitorOutput=function(e,t,r){var i=o.useCollector(e,t,r),a=i[0],u=i[1];return n.useLayoutEffect(function(){var t=e.getHandlerId();if(null!=t)return e.subscribeToStateChange(u,{handlerIds:[t]})},[e,u]),a}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(6)),i=r(1);t.useCollector=function(e,t,r){var n=i.useState(function(){return t(e)}),a=n[0],u=n[1],s=i.useCallback(function(){var n=t(e);o.default(a,n)||(u(n),r&&r())},[a,e,r]);return i.useLayoutEffect(s,[]),[a,s]}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(0)),i=!1,a=!1,u=function(){function e(e){this.sourceId=null,this.internalMonitor=e.getMonitor()}return e.prototype.receiveHandlerId=function(e){this.sourceId=e},e.prototype.getHandlerId=function(){return this.sourceId},e.prototype.canDrag=function(){o.default(!i,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return i=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{i=!1}},e.prototype.isDragging=function(){if(!this.sourceId)return!1;o.default(!a,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return a=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{a=!1}},e.prototype.subscribeToStateChange=function(e,t){return this.internalMonitor.subscribeToStateChange(e,t)},e.prototype.isDraggingSource=function(e){return this.internalMonitor.isDraggingSource(e)},e.prototype.isOverTarget=function(e,t){return this.internalMonitor.isOverTarget(e,t)},e.prototype.getTargetIds=function(){return this.internalMonitor.getTargetIds()},e.prototype.isSourcePublic=function(){return this.internalMonitor.isSourcePublic()},e.prototype.getSourceId=function(){return this.internalMonitor.getSourceId()},e.prototype.subscribeToOffsetChange=function(e){return this.internalMonitor.subscribeToOffsetChange(e)},e.prototype.canDragSource=function(e){return this.internalMonitor.canDragSource(e)},e.prototype.canDropOnTarget=function(e){return this.internalMonitor.canDropOnTarget(e)},e.prototype.getItemType=function(){return this.internalMonitor.getItemType()},e.prototype.getItem=function(){return this.internalMonitor.getItem()},e.prototype.getDropResult=function(){return this.internalMonitor.getDropResult()},e.prototype.didDrop=function(){return this.internalMonitor.didDrop()},e.prototype.getInitialClientOffset=function(){return this.internalMonitor.getInitialClientOffset()},e.prototype.getInitialSourceClientOffset=function(){return this.internalMonitor.getInitialSourceClientOffset()},e.prototype.getSourceClientOffset=function(){return this.internalMonitor.getSourceClientOffset()},e.prototype.getClientOffset=function(){return this.internalMonitor.getClientOffset()},e.prototype.getDifferenceFromInitialOffset=function(){return this.internalMonitor.getDifferenceFromInitialOffset()},e}();t.DragSourceMonitorImpl=u},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(23)),i=r(24),a=n(r(6)),u=function(){function e(e){var t=this;this.hooks=o.default({dragSource:function(e,r){t.dragSourceOptions=r||null,i.isRef(e)?t.dragSourceRef=e:t.dragSourceNode=e,t.reconnectDragSource()},dragPreview:function(e,r){t.dragPreviewOptions=r||null,i.isRef(e)?t.dragPreviewRef=e:t.dragPreviewNode=e,t.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}return e.prototype.receiveHandlerId=function(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())},Object.defineProperty(e.prototype,"connectTarget",{get:function(){return this.dragSource},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragSourceOptions",{get:function(){return this.dragSourceOptionsInternal},set:function(e){this.dragSourceOptionsInternal=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragPreviewOptions",{get:function(){return this.dragPreviewOptionsInternal},set:function(e){this.dragPreviewOptionsInternal=e},enumerable:!0,configurable:!0}),e.prototype.reconnect=function(){this.reconnectDragSource(),this.reconnectDragPreview()},e.prototype.reconnectDragSource=function(){var e=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();e&&this.disconnectDragSource();var t=this.dragSource;this.handlerId&&(t?e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=t,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,t,this.dragSourceOptions)):this.lastConnectedDragSource=t)},e.prototype.reconnectDragPreview=function(){var e=this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();e&&this.disconnectDragPreview();var t=this.dragPreview;this.handlerId&&t&&e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=t,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,t,this.dragPreviewOptions))},e.prototype.didHandlerIdChange=function(){return this.lastConnectedHandlerId!==this.handlerId},e.prototype.didConnectedDragSourceChange=function(){return this.lastConnectedDragSource!==this.dragSource},e.prototype.didConnectedDragPreviewChange=function(){return this.lastConnectedDragPreview!==this.dragPreview},e.prototype.didDragSourceOptionsChange=function(){return!a.default(this.lastConnectedDragSourceOptions,this.dragSourceOptions)},e.prototype.didDragPreviewOptionsChange=function(){return!a.default(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)},e.prototype.disconnectDragSource=function(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)},e.prototype.disconnectDragPreview=function(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)},Object.defineProperty(e.prototype,"dragSource",{get:function(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dragPreview",{get:function(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current},enumerable:!0,configurable:!0}),e}();t.SourceConnector=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(61);function i(e){return function(t,r){if(void 0===t&&(t=null),void 0===r&&(r=null),!n.isValidElement(t)){var i=t;return e(i,r),i}var a=t;!function(e){if("string"!=typeof e.type){var t=e.type.displayName||e.type.name||"the component";throw new Error("Only native element nodes can now be passed to React DnD connectors.You can either wrap "+t+" into a <div>, or turn it into a drag source or a drop target itself.")}}(a);var u=r?function(t){return e(t,r)}:e;return o.cloneWithRef(a,u)}}t.default=function(e){var t={};return Object.keys(e).forEach(function(r){var n=e[r];if(r.endsWith("Ref"))t[r]=e[r];else{var o=i(n);t[r]=function(){return o}}}),t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isRef=function(e){return null!==e&&"object"==typeof e&&e.hasOwnProperty("current")}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(6)),i=n(r(23)),a=r(24),u=function(){function e(e){var t=this;this.hooks=i.default({dropTarget:function(e,r){t.dropTargetOptions=r,a.isRef(e)?t.dropTargetRef=e:t.dropTargetNode=e,t.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=e}return Object.defineProperty(e.prototype,"connectTarget",{get:function(){return this.dropTarget},enumerable:!0,configurable:!0}),e.prototype.reconnect=function(){var e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();var t=this.dropTarget;this.handlerId&&(t?e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=t,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,t,this.dropTargetOptions)):this.lastConnectedDropTarget=t)},e.prototype.receiveHandlerId=function(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())},Object.defineProperty(e.prototype,"dropTargetOptions",{get:function(){return this.dropTargetOptionsInternal},set:function(e){this.dropTargetOptionsInternal=e},enumerable:!0,configurable:!0}),e.prototype.didHandlerIdChange=function(){return this.lastConnectedHandlerId!==this.handlerId},e.prototype.didDropTargetChange=function(){return this.lastConnectedDropTarget!==this.dropTarget},e.prototype.didOptionsChange=function(){return!o.default(this.lastConnectedDropTargetOptions,this.dropTargetOptions)},e.prototype.disconnectDropTarget=function(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)},Object.defineProperty(e.prototype,"dropTarget",{get:function(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current},enumerable:!0,configurable:!0}),e}();t.TargetConnector=u},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(0)),i=!1,a=function(){function e(e){this.targetId=null,this.internalMonitor=e.getMonitor()}return e.prototype.receiveHandlerId=function(e){this.targetId=e},e.prototype.getHandlerId=function(){return this.targetId},e.prototype.subscribeToStateChange=function(e,t){return this.internalMonitor.subscribeToStateChange(e,t)},e.prototype.canDrop=function(){if(!this.targetId)return!1;o.default(!i,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return i=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{i=!1}},e.prototype.isOver=function(e){return!!this.targetId&&this.internalMonitor.isOverTarget(this.targetId,e)},e.prototype.getItemType=function(){return this.internalMonitor.getItemType()},e.prototype.getItem=function(){return this.internalMonitor.getItem()},e.prototype.getDropResult=function(){return this.internalMonitor.getDropResult()},e.prototype.didDrop=function(){return this.internalMonitor.didDrop()},e.prototype.getInitialClientOffset=function(){return this.internalMonitor.getInitialClientOffset()},e.prototype.getInitialSourceClientOffset=function(){return this.internalMonitor.getInitialSourceClientOffset()},e.prototype.getSourceClientOffset=function(){return this.internalMonitor.getSourceClientOffset()},e.prototype.getClientOffset=function(){return this.internalMonitor.getClientOffset()},e.prototype.getDifferenceFromInitialOffset=function(){return this.internalMonitor.getDifferenceFromInitialOffset()},e}();t.DropTargetMonitorImpl=a},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=a(r(1)),c=u(r(6)),d=u(r(0)),f=u(r(28)),l=r(10),p=(r(3),r(69)),h=r(5);t.default=function(e){var t=e.DecoratedComponent,r=e.createHandler,n=e.createMonitor,a=e.createConnector,u=e.registerHandler,g=e.containerDisplayName,y=e.getType,v=e.collect,b=e.options.arePropsEqual,O=void 0===b?c.default:b,m=t,D=t.displayName||t.name||"Component",_=function(e){function f(t){var r=e.call(this,t)||this;return r.decoratedRef=s.createRef(),r.handleChange=function(){var e=r.getCurrentState();c.default(e,r.state)||r.setState(e)},r.disposable=new p.SerialDisposable,r.receiveProps(t),r.dispose(),r}return o(f,e),f.prototype.getHandlerId=function(){return this.handlerId},f.prototype.getDecoratedComponentInstance=function(){return d.default(this.decoratedRef.current,"In order to access an instance of the decorated component, it must either be a class component or use React.forwardRef()"),this.decoratedRef.current},f.prototype.shouldComponentUpdate=function(e,t){return!O(e,this.props)||!c.default(t,this.state)},f.prototype.componentDidMount=function(){this.disposable=new p.SerialDisposable,this.currentType=void 0,this.receiveProps(this.props),this.handleChange()},f.prototype.componentDidUpdate=function(e){O(this.props,e)||(this.receiveProps(this.props),this.handleChange())},f.prototype.componentWillUnmount=function(){this.dispose()},f.prototype.receiveProps=function(e){this.handler&&(this.handler.receiveProps(e),this.receiveType(y(e)))},f.prototype.receiveType=function(e){if(this.handlerMonitor&&this.manager&&this.handlerConnector&&e!==this.currentType){this.currentType=e;var t=u(e,this.handler,this.manager),r=t[0],n=t[1];this.handlerId=r,this.handlerMonitor.receiveHandlerId(r),this.handlerConnector.receiveHandlerId(r);var o=this.manager.getMonitor().subscribeToStateChange(this.handleChange,{handlerIds:[r]});this.disposable.setDisposable(new p.CompositeDisposable(new p.Disposable(o),new p.Disposable(n)))}},f.prototype.dispose=function(){this.disposable.dispose(),this.handlerConnector&&this.handlerConnector.receiveHandlerId(null)},f.prototype.getCurrentState=function(){return this.handlerConnector?v(this.handlerConnector.hooks,this.handlerMonitor,this.props):{}},f.prototype.render=function(){var e=this;return s.createElement(l.DndContext.Consumer,null,function(t){var r=t.dragDropManager;return e.receiveDragDropManager(r),"undefined"!=typeof requestAnimationFrame&&requestAnimationFrame(function(){return e.handlerConnector.reconnect()}),s.createElement(m,i({},e.props,e.getCurrentState(),{ref:h.isRefable(m)?e.decoratedRef:null}))})},f.prototype.receiveDragDropManager=function(e){void 0===this.manager&&(d.default(void 0!==e,"Could not find the drag and drop manager in the context of %s. Make sure to render a DndProvider component in your top-level component. Read more: http://react-dnd.github.io/react-dnd/docs/troubleshooting#could-not-find-the-drag-and-drop-manager-in-the-context",D,D),void 0!==e&&(this.manager=e,this.handlerMonitor=n(e),this.handlerConnector=a(e.getBackend()),this.handler=r(this.handlerMonitor,this.decoratedRef)))},f.DecoratedComponent=t,f.displayName=g+"("+D+")",f}(s.Component);return f.default(_,t)}},function(e,t,r){"use strict";var n=r(67),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},u={};function s(e){return n.isMemo(e)?a:u[e.$$typeof]||o}u[n.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0};var c=Object.defineProperty,d=Object.getOwnPropertyNames,f=Object.getOwnPropertySymbols,l=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,h=Object.prototype;e.exports=function e(t,r,n){if("string"!=typeof r){if(h){var o=p(r);o&&o!==h&&e(t,o,n)}var a=d(r);f&&(a=a.concat(f(r)));for(var u=s(t),g=s(r),y=0;y<a.length;++y){var v=a[y];if(!(i[v]||n&&n[v]||g&&g[v]||u&&u[v])){var b=l(r,v);try{c(t,v,b)}catch(e){}}}return t}return t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isValidType=function e(t,r){return"string"==typeof t||"symbol"==typeof t||!!r&&Array.isArray(t)&&t.every(function(t){return e(t,!1)})}},function(e,t,r){"use strict";function n(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}r.d(t,"a",function(){return n})},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(11)),n(r(56)),n(r(57))},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(15)),n(r(33))},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(34));t.createDragDropManager=function(e,t,r,n){var i=new o.default(n),a=e(i,t,r);return i.receiveBackend(a),i}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(35),i=n(r(37)),a=n(r(7)),u=n(r(49)),s=n(r(51));var c=function(){function e(e){var t=this;void 0===e&&(e=!1),this.isSetUp=!1,this.handleRefCountChange=function(){var e=t.store.getState().refCount>0;t.backend&&(e&&!t.isSetUp?(t.backend.setup(),t.isSetUp=!0):!e&&t.isSetUp&&(t.backend.teardown(),t.isSetUp=!1))};var r=function(e){var t="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__;return o.createStore(i.default,e&&t&&t({name:"dnd-core",instanceId:"dnd-core"}))}(e);this.store=r,this.monitor=new u.default(r,new s.default(r)),r.subscribe(this.handleRefCountChange)}return e.prototype.receiveBackend=function(e){this.backend=e},e.prototype.getMonitor=function(){return this.monitor},e.prototype.getBackend=function(){return this.backend},e.prototype.getRegistry=function(){return this.monitor.registry},e.prototype.getActions=function(){var e=this,t=this.store.dispatch;var r=a.default(this);return Object.keys(r).reduce(function(n,o){var i,a=r[o];return n[o]=(i=a,function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var o=i.apply(e,r);void 0!==o&&t(o)}),n},{})},e.prototype.dispatch=function(e){this.store.dispatch(e)},e}();t.default=c},function(e,t,r){"use strict";r.r(t),r.d(t,"__DO_NOT_USE__ActionTypes",function(){return i}),r.d(t,"applyMiddleware",function(){return y}),r.d(t,"bindActionCreators",function(){return f}),r.d(t,"combineReducers",function(){return c}),r.d(t,"compose",function(){return g}),r.d(t,"createStore",function(){return u});var n=r(14),o=function(){return Math.random().toString(36).substring(7).split("").join(".")},i={INIT:"@@redux/INIT"+o(),REPLACE:"@@redux/REPLACE"+o(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+o()}};function a(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function u(e,t,r){var o;if("function"==typeof t&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(u)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var s=e,c=t,d=[],f=d,l=!1;function p(){f===d&&(f=d.slice())}function h(){if(l)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return c}function g(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(l)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var t=!0;return p(),f.push(e),function(){if(t){if(l)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");t=!1,p();var r=f.indexOf(e);f.splice(r,1)}}}function y(e){if(!a(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(l)throw new Error("Reducers may not dispatch actions.");try{l=!0,c=s(c,e)}finally{l=!1}for(var t=d=f,r=0;r<t.length;r++){(0,t[r])()}return e}return y({type:i.INIT}),(o={dispatch:y,subscribe:g,getState:h,replaceReducer:function(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");s=e,y({type:i.REPLACE})}})[n.a]=function(){var e,t=g;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function r(){e.next&&e.next(h())}return r(),{unsubscribe:t(r)}}})[n.a]=function(){return this},e},o}function s(e,t){var r=t&&t.type;return"Given "+(r&&'action "'+String(r)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function c(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var o=t[n];0,"function"==typeof e[o]&&(r[o]=e[o])}var a,u=Object.keys(r);try{!function(e){Object.keys(e).forEach(function(t){var r=e[t];if(void 0===r(void 0,{type:i.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===r(void 0,{type:i.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+i.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}(r)}catch(e){a=e}return function(e,t){if(void 0===e&&(e={}),a)throw a;for(var n=!1,o={},i=0;i<u.length;i++){var c=u[i],d=r[c],f=e[c],l=d(f,t);if(void 0===l){var p=s(c,t);throw new Error(p)}o[c]=l,n=n||l!==f}return n?o:e}}function d(e,t){return function(){return t(e.apply(this,arguments))}}function f(e,t){if("function"==typeof e)return d(e,t);if("object"!=typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');var r={};for(var n in e){var o=e[n];"function"==typeof o&&(r[n]=d(o,t))}return r}function l(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function p(e,t){var r=Object.keys(e);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(e)),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(r,!0).forEach(function(t){l(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function g(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function y(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){var r=e.apply(void 0,arguments),n=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},o={getState:r.getState,dispatch:function(){return n.apply(void 0,arguments)}},i=t.map(function(e){return e(o)});return h({},r,{dispatch:n=g.apply(void 0,i)(r.dispatch)})}}}},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=o(r(38)),a=o(r(45)),u=o(r(46)),s=o(r(47)),c=o(r(48)),d=r(4);t.default=function(e,t){return void 0===e&&(e={}),{dirtyHandlerIds:s.default(e.dirtyHandlerIds,{type:t.type,payload:n(n({},t.payload),{prevTargetIds:d.get(e,"dragOperation.targetIds",[])})}),dragOffset:i.default(e.dragOffset,t),refCount:u.default(e.refCount,t),dragOperation:a.default(e.dragOperation,t),stateId:c.default(e.stateId)}}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(7),i=r(17),a={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};t.default=function(e,t){void 0===e&&(e=a);var r=t.payload;switch(t.type){case o.INIT_COORDS:case o.BEGIN_DRAG:return{initialSourceClientOffset:r.sourceClientOffset,initialClientOffset:r.clientOffset,clientOffset:r.clientOffset};case o.HOVER:return i.areCoordsEqual(e.clientOffset,r.clientOffset)?e:n(n({},e),{clientOffset:r.clientOffset});case o.END_DRAG:case o.DROP:return a;default:return e}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(0)),i=r(40),a=r(4),u=r(2),s={type:u.INIT_COORDS,payload:{clientOffset:null,sourceClientOffset:null}};t.default=function(e){return function(t,r){void 0===t&&(t=[]),void 0===r&&(r={publishSource:!0});var n=r.publishSource,c=void 0===n||n,d=r.clientOffset,f=r.getSourceClientOffset,l=e.getMonitor(),p=e.getRegistry();e.dispatch(i.setClientOffset(d)),function(e,t,r){o.default(!t.isDragging(),"Cannot call beginDrag while dragging."),e.forEach(function(e){o.default(r.getSource(e),"Expected sourceIds to be registered.")})}(t,l,p);var h=function(e,t){for(var r=null,n=e.length-1;n>=0;n--)if(t.canDragSource(e[n])){r=e[n];break}return r}(t,l);if(null!==h){var g=null;d&&(function(e){o.default("function"==typeof e,"When clientOffset is provided, getSourceClientOffset must be a function.")}(f),g=f(h)),e.dispatch(i.setClientOffset(d,g));var y=p.getSource(h).beginDrag(l,h);!function(e){o.default(a.isObject(e),"Item must be an object.")}(y),p.pinSource(h);var v=p.getSourceType(h);return{type:u.BEGIN_DRAG,payload:{itemType:v,item:y,sourceId:h,clientOffset:d||null,sourceClientOffset:g||null,isSourcePublic:!!c}}}e.dispatch(s)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.setClientOffset=function(e,t){return{type:n.INIT_COORDS,payload:{sourceClientOffset:t||null,clientOffset:e||null}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.default=function(e){return function(){if(e.getMonitor().isDragging())return{type:n.PUBLISH_DRAG_SOURCE}}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(0)),i=n(r(16)),a=r(2);t.default=function(e){return function(t,r){var n=(void 0===r?{}:r).clientOffset;!function(e){o.default(Array.isArray(e),"Expected targetIds to be an array.")}(t);var u=t.slice(0),s=e.getMonitor(),c=e.getRegistry();return function(e,t,r){o.default(t.isDragging(),"Cannot call hover while not dragging."),o.default(!t.didDrop(),"Cannot call hover after drop.");for(var n=0;n<e.length;n++){var i=e[n];o.default(e.lastIndexOf(i)===n,"Expected targetIds to be unique in the passed array.");var a=r.getTarget(i);o.default(a,"Expected targetIds to be registered.")}}(u,s,c),function(e,t,r){for(var n=e.length-1;n>=0;n--){var o=e[n],a=t.getTargetType(o);i.default(a,r)||e.splice(n,1)}}(u,c,s.getItemType()),function(e,t,r){e.forEach(function(e){var n=r.getTarget(e);n.hover(t,e)})}(u,s,c),{type:a.HOVER,payload:{targetIds:u,clientOffset:n||null}}}}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=o(r(0)),a=r(2),u=r(4);t.default=function(e){return function(t){void 0===t&&(t={});var r=e.getMonitor(),o=e.getRegistry();!function(e){i.default(e.isDragging(),"Cannot call drop while not dragging."),i.default(!e.didDrop(),"Cannot call drop twice during one drag operation.")}(r),function(e){var t=e.getTargetIds().filter(e.canDropOnTarget,e);return t.reverse(),t}(r).forEach(function(s,c){var d=function(e,t,r,n){var o=r.getTarget(e),a=o?o.drop(n,e):void 0;return function(e){i.default(void 0===e||u.isObject(e),"Drop result must either be an object or undefined.")}(a),void 0===a&&(a=0===t?{}:n.getDropResult()),a}(s,c,o,r),f={type:a.DROP,payload:{dropResult:n(n({},t),d)}};e.dispatch(f)})}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(0)),i=r(2);t.default=function(e){return function(){var t=e.getMonitor(),r=e.getRegistry();!function(e){o.default(e.isDragging(),"Cannot call endDrag while not dragging.")}(t);var n=t.getSourceId();return r.getSource(n,!0).endDrag(t,n),r.unpinSource(),{type:i.END_DRAG}}}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(7),i=r(8),a=r(4),u={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};t.default=function(e,t){void 0===e&&(e=u);var r=t.payload;switch(t.type){case o.BEGIN_DRAG:return n(n({},e),{itemType:r.itemType,item:r.item,sourceId:r.sourceId,isSourcePublic:r.isSourcePublic,dropResult:null,didDrop:!1});case o.PUBLISH_DRAG_SOURCE:return n(n({},e),{isSourcePublic:!0});case o.HOVER:return n(n({},e),{targetIds:r.targetIds});case i.REMOVE_TARGET:return-1===e.targetIds.indexOf(r.targetId)?e:n(n({},e),{targetIds:a.without(e.targetIds,r.targetId)});case o.DROP:return n(n({},e),{dropResult:r.dropResult,didDrop:!0,targetIds:[]});case o.END_DRAG:return n(n({},e),{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(8);t.default=function(e,t){switch(void 0===e&&(e=0),t.type){case n.ADD_SOURCE:case n.ADD_TARGET:return e+1;case n.REMOVE_SOURCE:case n.REMOVE_TARGET:return e-1;default:return e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(7),o=r(8),i=r(17),a=r(18),u=r(4);t.default=function(e,t){switch(void 0===e&&(e=a.NONE),t.type){case n.HOVER:break;case o.ADD_SOURCE:case o.ADD_TARGET:case o.REMOVE_TARGET:case o.REMOVE_SOURCE:return a.NONE;case n.BEGIN_DRAG:case n.PUBLISH_DRAG_SOURCE:case n.END_DRAG:case n.DROP:default:return a.ALL}var r=t.payload,s=r.targetIds,c=void 0===s?[]:s,d=r.prevTargetIds,f=void 0===d?[]:d,l=u.xor(c,f);if(!(l.length>0)&&i.areArraysEqual(c,f))return a.NONE;var p=f[f.length-1],h=c[c.length-1];return p!==h&&(p&&l.push(p),h&&l.push(h)),l}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return void 0===e&&(e=0),e+1}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(0)),i=n(r(16)),a=r(50),u=r(18),s=function(){function e(e,t){this.store=e,this.registry=t}return e.prototype.subscribeToStateChange=function(e,t){var r=this;void 0===t&&(t={handlerIds:void 0});var n=t.handlerIds;o.default("function"==typeof e,"listener must be a function."),o.default(void 0===n||Array.isArray(n),"handlerIds, when specified, must be an array of strings.");var i=this.store.getState().stateId;return this.store.subscribe(function(){var t=r.store.getState(),o=t.stateId;try{o===i||o===i+1&&!u.areDirty(t.dirtyHandlerIds,n)||e()}finally{i=o}})},e.prototype.subscribeToOffsetChange=function(e){var t=this;o.default("function"==typeof e,"listener must be a function.");var r=this.store.getState().dragOffset;return this.store.subscribe(function(){var n=t.store.getState().dragOffset;n!==r&&(r=n,e())})},e.prototype.canDragSource=function(e){if(!e)return!1;var t=this.registry.getSource(e);return o.default(t,"Expected to find a valid source."),!this.isDragging()&&t.canDrag(this,e)},e.prototype.canDropOnTarget=function(e){if(!e)return!1;var t=this.registry.getTarget(e);if(o.default(t,"Expected to find a valid target."),!this.isDragging()||this.didDrop())return!1;var r=this.registry.getTargetType(e),n=this.getItemType();return i.default(r,n)&&t.canDrop(this,e)},e.prototype.isDragging=function(){return Boolean(this.getItemType())},e.prototype.isDraggingSource=function(e){if(!e)return!1;var t=this.registry.getSource(e,!0);return o.default(t,"Expected to find a valid source."),!(!this.isDragging()||!this.isSourcePublic())&&(this.registry.getSourceType(e)===this.getItemType()&&t.isDragging(this,e))},e.prototype.isOverTarget=function(e,t){if(void 0===t&&(t={shallow:!1}),!e)return!1;var r=t.shallow;if(!this.isDragging())return!1;var n=this.registry.getTargetType(e),o=this.getItemType();if(o&&!i.default(n,o))return!1;var a=this.getTargetIds();if(!a.length)return!1;var u=a.indexOf(e);return r?u===a.length-1:u>-1},e.prototype.getItemType=function(){return this.store.getState().dragOperation.itemType},e.prototype.getItem=function(){return this.store.getState().dragOperation.item},e.prototype.getSourceId=function(){return this.store.getState().dragOperation.sourceId},e.prototype.getTargetIds=function(){return this.store.getState().dragOperation.targetIds},e.prototype.getDropResult=function(){return this.store.getState().dragOperation.dropResult},e.prototype.didDrop=function(){return this.store.getState().dragOperation.didDrop},e.prototype.isSourcePublic=function(){return this.store.getState().dragOperation.isSourcePublic},e.prototype.getInitialClientOffset=function(){return this.store.getState().dragOffset.initialClientOffset},e.prototype.getInitialSourceClientOffset=function(){return this.store.getState().dragOffset.initialSourceClientOffset},e.prototype.getClientOffset=function(){return this.store.getState().dragOffset.clientOffset},e.prototype.getSourceClientOffset=function(){return a.getSourceClientOffset(this.store.getState().dragOffset)},e.prototype.getDifferenceFromInitialOffset=function(){return a.getDifferenceFromInitialOffset(this.store.getState().dragOffset)},e}();t.default=s},function(e,t,r){"use strict";function n(e,t){return{x:e.x+t.x,y:e.y+t.y}}function o(e,t){return{x:e.x-t.x,y:e.y-t.y}}Object.defineProperty(t,"__esModule",{value:!0}),t.add=n,t.subtract=o,t.getSourceClientOffset=function(e){var t=e.clientOffset,r=e.initialClientOffset,i=e.initialSourceClientOffset;return t&&r&&i?o(n(t,i),r):null},t.getDifferenceFromInitialOffset=function(e){var t=e.clientOffset,r=e.initialClientOffset;return t&&r?o(t,r):null}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(52)),i=n(r(0)),a=r(8),u=n(r(54)),s=r(15),c=r(55);function d(e){switch(e[0]){case"S":return s.HandlerRole.SOURCE;case"T":return s.HandlerRole.TARGET;default:i.default(!1,"Cannot parse handler ID: "+e)}}function f(e,t){var r=e.entries(),n=!1;do{var o=r.next(),i=o.done;if(o.value[1]===t)return!0;n=i}while(!n);return!1}var l=function(){function e(e){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=e}return e.prototype.addSource=function(e,t){c.validateType(e),c.validateSourceContract(t);var r=this.addHandler(s.HandlerRole.SOURCE,e,t);return this.store.dispatch(a.addSource(r)),r},e.prototype.addTarget=function(e,t){c.validateType(e,!0),c.validateTargetContract(t);var r=this.addHandler(s.HandlerRole.TARGET,e,t);return this.store.dispatch(a.addTarget(r)),r},e.prototype.containsHandler=function(e){return f(this.dragSources,e)||f(this.dropTargets,e)},e.prototype.getSource=function(e,t){return void 0===t&&(t=!1),i.default(this.isSourceId(e),"Expected a valid source ID."),t&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)},e.prototype.getTarget=function(e){return i.default(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)},e.prototype.getSourceType=function(e){return i.default(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)},e.prototype.getTargetType=function(e){return i.default(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)},e.prototype.isSourceId=function(e){return d(e)===s.HandlerRole.SOURCE},e.prototype.isTargetId=function(e){return d(e)===s.HandlerRole.TARGET},e.prototype.removeSource=function(e){var t=this;i.default(this.getSource(e),"Expected an existing source."),this.store.dispatch(a.removeSource(e)),o.default(function(){t.dragSources.delete(e),t.types.delete(e)})},e.prototype.removeTarget=function(e){i.default(this.getTarget(e),"Expected an existing target."),this.store.dispatch(a.removeTarget(e)),this.dropTargets.delete(e),this.types.delete(e)},e.prototype.pinSource=function(e){var t=this.getSource(e);i.default(t,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=t},e.prototype.unpinSource=function(){i.default(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null},e.prototype.addHandler=function(e,t,r){var n=function(e){var t=u.default().toString();switch(e){case s.HandlerRole.SOURCE:return"S"+t;case s.HandlerRole.TARGET:return"T"+t;default:throw new Error("Unknown Handler Role: "+e)}}(e);return this.types.set(n,t),e===s.HandlerRole.SOURCE?this.dragSources.set(n,r):e===s.HandlerRole.TARGET&&this.dropTargets.set(n,r),n},e}();t.default=l},function(e,t,r){"use strict";var n=r(53),o=[],i=[],a=n.makeRequestCallFromTimer(function(){if(i.length)throw i.shift()});function u(e){var t;(t=o.length?o.pop():new s).task=e,n(t)}function s(){this.task=null}e.exports=u,s.prototype.call=function(){try{this.task.call()}catch(e){u.onerror?u.onerror(e):(i.push(e),a())}finally{this.task=null,o[o.length]=this}}},function(e,t,r){"use strict";(function(t){function r(e){o.length||(n(),!0),o[o.length]=e}e.exports=r;var n,o=[],i=0,a=1024;function u(){for(;i<o.length;){var e=i;if(i+=1,o[e].call(),i>a){for(var t=0,r=o.length-i;t<r;t++)o[t]=o[t+i];o.length-=i,i=0}}o.length=0,i=0,!1}var s,c,d,f=void 0!==t?t:self,l=f.MutationObserver||f.WebKitMutationObserver;function p(e){return function(){var t=setTimeout(n,0),r=setInterval(n,50);function n(){clearTimeout(t),clearInterval(r),e()}}}"function"==typeof l?(s=1,c=new l(u),d=document.createTextNode(""),c.observe(d,{characterData:!0}),n=function(){s=-s,d.data=s}):n=p(u),r.requestFlush=n,r.makeRequestCallFromTimer=p}).call(this,r(12))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=0;t.default=function(){return n++}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(0));t.validateSourceContract=function(e){o.default("function"==typeof e.canDrag,"Expected canDrag to be a function."),o.default("function"==typeof e.beginDrag,"Expected beginDrag to be a function."),o.default("function"==typeof e.endDrag,"Expected endDrag to be a function.")},t.validateTargetContract=function(e){o.default("function"==typeof e.canDrop,"Expected canDrop to be a function."),o.default("function"==typeof e.hover,"Expected hover to be a function."),o.default("function"==typeof e.drop,"Expected beginDrag to be a function.")},t.validateType=function e(t,r){r&&Array.isArray(t)?t.forEach(function(t){return e(t,!1)}):o.default("string"==typeof t||"symbol"==typeof t,r?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}},function(e,t,r){"use strict";(function(e){var n=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=o(r(1)),a=r(1),u=r(11);t.DndProvider=a.memo(function(t){var r=t.children,o=n(t,["children"]),a="manager"in o?{dragDropManager:o.manager}:function(t,r,n,o){void 0===r&&(r=void 0!==e?e:window);var i=r;i[s]||(i[s]=u.createDndContext(t,r,n,o));return i[s]}(o.backend,o.context,o.options,o.debugMode);return i.createElement(u.DndContext.Provider,{value:a},r)});var s=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__")}).call(this,r(12))},function(e,t,r){"use strict";var n=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(1));t.DragPreviewImage=o.memo(function(e){var t=e.connect,r=e.src;if("undefined"!=typeof Image){var n=new Image;n.src=r,n.onload=function(){return t(n)}}return null}),t.DragPreviewImage.displayName="DragPreviewImage"},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(59)),n(r(62)),n(r(64))},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=n(r(0)),a=r(19),u=r(60);t.useDrag=function(e){var t=o.useRef(e);t.current=e,i.default(null!=e.item,"item must be defined"),i.default(null!=e.item.type,"item type must be defined");var r=u.useDragSourceMonitor(),n=r[0],s=r[1];u.useDragHandler(t,n,s);var c=a.useMonitorOutput(n,t.current.collect||function(){return{}},function(){return s.reconnect()}),d=o.useMemo(function(){return s.hooks.dragSource()},[s]),f=o.useMemo(function(){return s.hooks.dragPreview()},[s]);return o.useLayoutEffect(function(){s.dragSourceOptions=t.current.options||null,s.reconnect()},[s]),o.useLayoutEffect(function(){s.dragPreviewOptions=t.current.previewOptions||null,s.reconnect()},[s]),[c,d,f]}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=n(r(0)),a=r(9),u=r(13),s=r(21),c=r(22);t.useDragSourceMonitor=function(){var e=u.useDragDropManager();return[o.useMemo(function(){return new s.DragSourceMonitorImpl(e)},[e]),o.useMemo(function(){return new c.SourceConnector(e.getBackend())},[e])]},t.useDragHandler=function(e,t,r){var n=u.useDragDropManager(),s=o.useMemo(function(){return{beginDrag:function(){var r=e.current,n=r.begin,o=r.item;if(n){var a=n(t);return i.default(null==a||"object"==typeof a,"dragSpec.begin() must either return an object, undefined, or null"),a||o||{}}return o||{}},canDrag:function(){return"boolean"==typeof e.current.canDrag?e.current.canDrag:"function"!=typeof e.current.canDrag||e.current.canDrag(t)},isDragging:function(r,n){var o=e.current.isDragging;return o?o(t):n===r.getSourceId()},endDrag:function(){var n=e.current.end;n&&n(t.getItem(),t),r.reconnect()}}},[]);o.useLayoutEffect(function(){var o=a.registerSource(e.current.item.type,s,n),i=o[0],u=o[1];return t.receiveHandlerId(i),r.receiveHandlerId(i),u},[])}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=n(r(0));function a(e,t){"function"==typeof e?e(t):e.current=t}t.cloneWithRef=function(e,t){var r=e.ref;return i.default("string"!=typeof r,"Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://facebook.github.io/react/docs/more-about-refs.html#the-ref-callback-attribute"),r?o.cloneElement(e,{ref:function(e){a(t,e),r&&a(r,e)}}):o.cloneElement(e,{ref:t})}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(1),i=n(r(0)),a=r(19),u=r(63);t.useDrop=function(e){var t=o.useRef(e);t.current=e,i.default(null!=e.accept,"accept must be defined");var r=u.useDropTargetMonitor(),n=r[0],s=r[1];u.useDropHandler(t,n,s);var c=a.useMonitorOutput(n,t.current.collect||function(){return{}},function(){return s.reconnect()}),d=o.useMemo(function(){return s.hooks.dropTarget()},[s]);return o.useLayoutEffect(function(){s.dropTargetOptions=e.options||null,s.reconnect()},[e.options]),[c,d]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(9),i=r(13),a=r(25),u=r(26);t.useDropTargetMonitor=function(){var e=i.useDragDropManager();return[n.useMemo(function(){return new u.DropTargetMonitorImpl(e)},[e]),n.useMemo(function(){return new a.TargetConnector(e.getBackend())},[e])]},t.useDropHandler=function(e,t,r){var a=i.useDragDropManager(),u=n.useMemo(function(){return{canDrop:function(){var r=e.current.canDrop;return!r||r(t.getItem(),t)},hover:function(){var r=e.current.hover;r&&r(t.getItem(),t)},drop:function(){var r=e.current.drop;if(r)return r(t.getItem(),t)}}},[t]);n.useLayoutEffect(function(){var n=o.registerTarget(e.current.accept,u,a),i=n[0],s=n[1];return t.receiveHandlerId(i),r.receiveHandlerId(i),s},[t,r])}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(13),i=r(20);t.useDragLayer=function(e){var t=o.useDragDropManager().getMonitor(),r=i.useCollector(t,e),a=r[0],u=r[1];return n.useEffect(function(){return t.subscribeToOffsetChange(u)}),n.useEffect(function(){return t.subscribeToStateChange(u)}),a}},function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),n(r(66)),n(r(71)),n(r(73))},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(0)),i=r(3),a=r(5),u=n(r(27)),s=r(9),c=r(21),d=r(22),f=r(29),l=n(r(70));t.DragSource=function(e,t,r,n){void 0===n&&(n={}),a.checkDecoratorArguments("DragSource","type, spec, collect[, options]",e,t,r,n);var p=e;"function"!=typeof e&&(o.default(f.isValidType(e),'Expected "type" provided as the first argument to DragSource to be a string, or a function that returns a string given the current props. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source',e),p=function(){return e}),o.default(i.isPlainObject(t),'Expected "spec" provided as the second argument to DragSource to be a plain object. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source',t);var h=l.default(t);return o.default("function"==typeof r,'Expected "collect" provided as the third argument to DragSource to be a function that returns a plain object of props to inject. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source',r),o.default(i.isPlainObject(n),'Expected "options" provided as the fourth argument to DragSource to be a plain object when specified. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source',r),function(e){return u.default({containerDisplayName:"DragSource",createHandler:h,registerHandler:s.registerSource,createConnector:function(e){return new d.SourceConnector(e)},createMonitor:function(e){return new c.DragSourceMonitorImpl(e)},DecoratedComponent:e,getType:p,collect:r,options:n})}}},function(e,t,r){"use strict";e.exports=r(68)},function(e,t,r){"use strict";
/** @license React v16.8.6
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&Symbol.for,o=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,a=n?Symbol.for("react.fragment"):60107,u=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,c=n?Symbol.for("react.provider"):60109,d=n?Symbol.for("react.context"):60110,f=n?Symbol.for("react.async_mode"):60111,l=n?Symbol.for("react.concurrent_mode"):60111,p=n?Symbol.for("react.forward_ref"):60112,h=n?Symbol.for("react.suspense"):60113,g=n?Symbol.for("react.memo"):60115,y=n?Symbol.for("react.lazy"):60116;function v(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case o:switch(e=e.type){case f:case l:case a:case s:case u:case h:return e;default:switch(e=e&&e.$$typeof){case d:case p:case c:return e;default:return t}}case y:case g:case i:return t}}}function b(e){return v(e)===l}t.typeOf=v,t.AsyncMode=f,t.ConcurrentMode=l,t.ContextConsumer=d,t.ContextProvider=c,t.Element=o,t.ForwardRef=p,t.Fragment=a,t.Lazy=y,t.Memo=g,t.Portal=i,t.Profiler=s,t.StrictMode=u,t.Suspense=h,t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===a||e===l||e===s||e===u||e===h||"object"==typeof e&&null!==e&&(e.$$typeof===y||e.$$typeof===g||e.$$typeof===c||e.$$typeof===d||e.$$typeof===p)},t.isAsyncMode=function(e){return b(e)||v(e)===f},t.isConcurrentMode=b,t.isContextConsumer=function(e){return v(e)===d},t.isContextProvider=function(e){return v(e)===c},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===o},t.isForwardRef=function(e){return v(e)===p},t.isFragment=function(e){return v(e)===a},t.isLazy=function(e){return v(e)===y},t.isMemo=function(e){return v(e)===g},t.isPortal=function(e){return v(e)===i},t.isProfiler=function(e){return v(e)===s},t.isStrictMode=function(e){return v(e)===u},t.isSuspense=function(e){return v(e)===h}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),o=function(){function e(e){this.isDisposed=!1,this.action=n.isFunction(e)?e:n.noop}return e.isDisposable=function(e){return e&&n.isFunction(e.dispose)},e._fixup=function(t){return e.isDisposable(t)?t:e.empty},e.create=function(t){return new e(t)},e.prototype.dispose=function(){this.isDisposed||(this.action(),this.isDisposed=!0)},e.empty={dispose:n.noop},e}();t.Disposable=o;var i=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.isDisposed=!1,this.disposables=e}return e.prototype.add=function(e){this.isDisposed?e.dispose():this.disposables.push(e)},e.prototype.remove=function(e){var t=!1;if(!this.isDisposed){var r=this.disposables.indexOf(e);-1!==r&&(t=!0,this.disposables.splice(r,1),e.dispose())}return t},e.prototype.clear=function(){if(!this.isDisposed){for(var e=this.disposables.length,t=new Array(e),r=0;r<e;r++)t[r]=this.disposables[r];this.disposables=[];for(r=0;r<e;r++)t[r].dispose()}},e.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;for(var e=this.disposables.length,t=new Array(e),r=0;r<e;r++)t[r]=this.disposables[r];this.disposables=[];for(r=0;r<e;r++)t[r].dispose()}},e}();t.CompositeDisposable=i;var a=function(){function e(){this.isDisposed=!1}return e.prototype.getDisposable=function(){return this.current},e.prototype.setDisposable=function(e){var t=this.isDisposed;if(!t){var r=this.current;this.current=e,r&&r.dispose()}t&&e&&e.dispose()},e.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var e=this.current;this.current=void 0,e&&e.dispose()}},e}();t.SerialDisposable=a},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(0)),i=(r(3),r(5)),a=["canDrag","beginDrag","isDragging","endDrag"],u=["beginDrag"],s=function(){function e(e,t,r){var n=this;this.props=null,this.beginDrag=function(){if(n.props)return n.spec.beginDrag(n.props,n.monitor,n.ref.current)},this.spec=e,this.monitor=t,this.ref=r}return e.prototype.receiveProps=function(e){this.props=e},e.prototype.canDrag=function(){return!!this.props&&(!this.spec.canDrag||this.spec.canDrag(this.props,this.monitor))},e.prototype.isDragging=function(e,t){return!!this.props&&(this.spec.isDragging?this.spec.isDragging(this.props,this.monitor):t===e.getSourceId())},e.prototype.endDrag=function(){this.props&&this.spec.endDrag&&this.spec.endDrag(this.props,this.monitor,i.getDecoratedComponent(this.ref))},e}();t.default=function(e){return Object.keys(e).forEach(function(t){o.default(a.indexOf(t)>-1,'Expected the drag source specification to only have some of the following keys: %s. Instead received a specification with an unexpected "%s" key. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source',a.join(", "),t),o.default("function"==typeof e[t],"Expected %s in the drag source specification to be a function. Instead received a specification with %s: %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source",t,t,e[t])}),u.forEach(function(t){o.default("function"==typeof e[t],"Expected %s in the drag source specification to be a function. Instead received a specification with %s: %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source",t,t,e[t])}),function(t,r){return new s(e,t,r)}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(0)),i=r(3),a=r(9),u=r(29),s=r(25),c=r(26),d=r(5),f=n(r(27)),l=n(r(72));t.DropTarget=function(e,t,r,n){void 0===n&&(n={}),d.checkDecoratorArguments("DropTarget","type, spec, collect[, options]",e,t,r,n);var p=e;"function"!=typeof e&&(o.default(u.isValidType(e,!0),'Expected "type" provided as the first argument to DropTarget to be a string, an array of strings, or a function that returns either given the current props. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',e),p=function(){return e}),o.default(i.isPlainObject(t),'Expected "spec" provided as the second argument to DropTarget to be a plain object. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',t);var h=l.default(t);return o.default("function"==typeof r,'Expected "collect" provided as the third argument to DropTarget to be a function that returns a plain object of props to inject. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',r),o.default(i.isPlainObject(n),'Expected "options" provided as the fourth argument to DropTarget to be a plain object when specified. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',r),function(e){return f.default({containerDisplayName:"DropTarget",createHandler:h,registerHandler:a.registerTarget,createMonitor:function(e){return new c.DropTargetMonitorImpl(e)},createConnector:function(e){return new s.TargetConnector(e)},DecoratedComponent:e,getType:p,collect:r,options:n})}}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(0)),i=(r(3),r(5)),a=["canDrop","hover","drop"],u=function(){function e(e,t,r){this.props=null,this.spec=e,this.monitor=t,this.ref=r}return e.prototype.receiveProps=function(e){this.props=e},e.prototype.receiveMonitor=function(e){this.monitor=e},e.prototype.canDrop=function(){return!this.spec.canDrop||this.spec.canDrop(this.props,this.monitor)},e.prototype.hover=function(){this.spec.hover&&this.spec.hover(this.props,this.monitor,i.getDecoratedComponent(this.ref))},e.prototype.drop=function(){if(this.spec.drop)return this.spec.drop(this.props,this.monitor,this.ref.current)},e}();t.default=function(e){return Object.keys(e).forEach(function(t){o.default(a.indexOf(t)>-1,'Expected the drop target specification to only have some of the following keys: %s. Instead received a specification with an unexpected "%s" key. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target',a.join(", "),t),o.default("function"==typeof e[t],"Expected %s in the drop target specification to be a function. Instead received a specification with %s: %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target",t,t,e[t])}),function(t,r){return new u(e,t,r)}}},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=a(r(1)),c=u(r(6)),d=u(r(28)),f=u(r(0)),l=r(10),p=r(3),h=r(5);t.DragLayer=function(e,t){return void 0===t&&(t={}),h.checkDecoratorArguments("DragLayer","collect[, options]",e,t),f.default("function"==typeof e,'Expected "collect" provided as the first argument to DragLayer to be a function that collects props to inject into the component. ',"Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-layer",e),f.default(p.isPlainObject(t),'Expected "options" provided as the second argument to DragLayer to be a plain object when specified. Instead, received %s. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-layer',t),function(r){var n=r,a=t.arePropsEqual,u=void 0===a?c.default:a,p=n.displayName||n.name||"Component",g=function(t){function a(){var e=null!==t&&t.apply(this,arguments)||this;return e.isCurrentlyMounted=!1,e.ref=s.createRef(),e.handleChange=function(){if(e.isCurrentlyMounted){var t=e.getCurrentState();c.default(t,e.state)||e.setState(t)}},e}return o(a,t),a.prototype.getDecoratedComponentInstance=function(){return f.default(this.ref.current,"In order to access an instance of the decorated component, it must either be a class component or use React.forwardRef()"),this.ref.current},a.prototype.shouldComponentUpdate=function(e,t){return!u(e,this.props)||!c.default(t,this.state)},a.prototype.componentDidMount=function(){this.isCurrentlyMounted=!0,this.handleChange()},a.prototype.componentWillUnmount=function(){this.isCurrentlyMounted=!1,this.unsubscribeFromOffsetChange&&(this.unsubscribeFromOffsetChange(),this.unsubscribeFromOffsetChange=void 0),this.unsubscribeFromStateChange&&(this.unsubscribeFromStateChange(),this.unsubscribeFromStateChange=void 0)},a.prototype.render=function(){var e=this;return s.createElement(l.DndContext.Consumer,null,function(t){var r=t.dragDropManager;return void 0===r?null:(e.receiveDragDropManager(r),e.isCurrentlyMounted?s.createElement(n,i({},e.props,e.state,{ref:h.isRefable(n)?e.ref:null})):null)})},a.prototype.receiveDragDropManager=function(e){if(void 0===this.manager){this.manager=e,f.default("object"==typeof e,"Could not find the drag and drop manager in the context of %s. Make sure to render a DndProvider component in your top-level component. Read more: http://react-dnd.github.io/react-dnd/docs/troubleshooting#could-not-find-the-drag-and-drop-manager-in-the-context",p,p);var t=this.manager.getMonitor();this.unsubscribeFromOffsetChange=t.subscribeToOffsetChange(this.handleChange),this.unsubscribeFromStateChange=t.subscribeToStateChange(this.handleChange)}},a.prototype.getCurrentState=function(){if(!this.manager)return{};var t=this.manager.getMonitor();return e(t,this.props)},a.displayName="DragLayer("+p+")",a.DecoratedComponent=r,a}(s.Component);return d.default(g,r)}}}])});
define("@ms/utilities-react-drag-drop/lib/drop-target/DropTargetWrapper",["require","exports","tslib","react","react","react-dnd","react-dom"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.injectDropTargetProps=function(e,t){var r={drop:function(t,n,r){var i=String(n.getItemType());if(i&&e[i]){var s=e[i];if(s&&s.onDropHandler)return s.onDropHandler({draggedItem:n.getItem(),dragSourceKey:n.getItem().dragSourceKey,dropTargetKey:t.dropTargetKey,dragItemType:i,didDrop:n.didDrop()})}return{dropTargetKey:t.dropTargetKey}},hover:function(t,n,r){var i,s=String(n.getItemType());if(r&&s&&e[s]){var u=e[s];i=o.findDOMNode(r);var a=n.getClientOffset();return u&&u.onHoverHandler?u.onHoverHandler({hoveredOnItemKey:t.dropTargetKey,dragItemType:s,componentNode:i,draggedItem:n.getItem(),clientOffset:a?{x:a.x,y:a.y}:null}):void 0}}};return s.DropTarget(Object.keys(e),r,function(e,r,i){return n.__assign({},t(r),{connectDropTarget:e.dropTarget()})})};t.withDropTargetWrapper=function(e){return function(t){n.__extends(i,t);function i(e){return t.call(this,e)||this}i.prototype.render=function(){var t=this.props.connectDropTarget,i=e,s=r.createElement("div",null,r.createElement(i,n.__assign({},this.props)));if(t){var o=t(s);if(o)return o}return s};return i}(r.PureComponent)};t.getDropTargetHandlers=function(e,t){return{onDropHandler:e,onHoverHandler:t}};t.DropTargetHookWrapper=function(e){var t=e.acceptType,n=e.dropTargetKey,r=e.handlers,o=e.hookCallback,u=r.onDropHandler,a=r.onHoverHandler,f=r.canDropHandler,l={accept:t,drop:function(e,t){u&&u({draggedItem:e,dragSourceKey:e.dragSourceKey,dropTargetKey:n,dragItemType:String(t.getItemType()),didDrop:t.didDrop()});return{dropTargetKey:n}},hover:function(e,t){a&&a({hoveredOnItemKey:n,dragItemType:String(t.getItemType()),draggedItem:t.getItem()})},canDrop:function(e,t){return!!f&&f({draggedItem:e,dragItemType:String(t.getItemType())})},collect:function(e){return{isOver:e.isOver(),isOverCurrent:e.isOver({shallow:!0}),canDrop:e.canDrop(),didDrop:e.didDrop(),itemType:String(e.getItemType())}}},c=s.useDrop(l),h=c[0],p=c[1];i.useEffect(function(){p&&o({collectedProps:h,connectDropTarget:p})},[h,p]);return null}});
define("@ms/utilities-react-drag-drop/lib/drag-source/DragSourceWrapper",["require","exports","tslib","react","react","react-dnd","react-dnd-html5-backend","office-ui-fabric-react/lib/Icon","./DragSourceWrapper.scss","@uifabric/utilities/lib/css"],function(e,t,n,r,i,s,o,u,a,f){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.injectDragSourceProps=function(e,t){var r={beginDrag:function(e,t,n){if(!e)throw new Error("DragSourceWrapper component Props should not be null or undefined");var r={dragSourceKey:e.dragSourceKey};return e.onBeginDrag?e.onBeginDrag(r):r},endDrag:function(e,t,n){e&&e.onEndDrag&&e.onEndDrag({dragSourceKey:e.dragSourceKey,dropResult:t.getDropResult(),didDrop:t.didDrop(),draggedItem:t.getItem()})}};return s.DragSource(e,r,function(e,r,i){return n.__assign({},t(r),{connectDragSource:e.dragSource(),connectDragPreview:e.dragPreview(),isDragging:r.isDragging()})})};t.withDragSourceWrapper=function(e){return function(t){n.__extends(i,t);function i(e){return t.call(this,e)||this}i.prototype.render=function(){var t,i=this.props,s=i.connectDragSource,o=i.isDragging,l=i.connectDragPreview,c=i.dragHintIconClassName,h=i.dragStartRootOverrideClassName,p=i.dragPreviewElementRef,d=i.dragHintIconName,v=e;if(s){t=s(r.createElement("div",{className:f.css(a.msRoot,o?h||a.msDragStart:"")},r.createElement(u.Icon,{iconName:d||"GripperBarVertical",className:f.css(c||a.msDragIcon,o?a.isVisible:"")}),r.createElement("div",{className:a.msDragSrouceContainer},r.createElement(v,n.__assign({},this.props)))));l&&l(p&&p.current?p.current:t,{captureDraggingState:!0})}return t||r.createElement("div",null,r.createElement(v,n.__assign({},this.props)))};return i}(r.PureComponent)};t.DragSourceHookWrapper=function(e){var t=e.dragSourceKey,n=e.type,r=e.handlers,u=e.hookCallback,a=r.onBeginHandler,f=r.onEndHandler,l=r.canDragHandler,c={item:{dragSourceKey:t,type:n},collect:function(e){return{isDragging:e.isDragging(),canDrag:e.canDrag()}},begin:function(e){if(a)return a({draggedItem:e.getItem(),dragItemType:String(e.getItemType())})},end:function(e,t){f&&f({draggedItem:t.getItem(),dragItemType:String(t.getItemType())})},canDrag:function(e){return!!l&&l({draggedItem:e.getItem(),dragItemType:String(e.getItemType())})}},h=s.useDrag(c),p=h[0],d=h[1],v=h[2];i.useEffect(function(){d&&u({collectedProps:p,connectDragSource:d})},[p,d,v]);i.useEffect(function(){v&&v(o.getEmptyImage(),{captureDraggingState:!0})},[]);return null};t.DragLayerHookWrapper=function(e){var t=e.dragSourceKey,n=void 0===t?"":t,o=e.type,u=void 0===o?"":o,f=e.children,l=s.useDragLayer(function(e){return{isDragging:e.isDragging(),item:e.getItem(),itemType:String(e.getItemType()),initialOffset:e.getInitialClientOffset(),currentOffset:e.getClientOffset(),initialSourceOffset:e.getInitialSourceClientOffset(),currentSourceOffset:e.getSourceClientOffset()}}),c=i.useRef(null),h=l.isDragging,p=l.item,d=l.itemType,v=l.initialOffset,m=l.currentOffset,g=l.initialSourceOffset,y=l.currentSourceOffset;if(!h||!p||p.dragSourceKey!==n||d!==u)return null;var b=function(e,t,n,r,i){if(!(e&&t&&n&&r))return{display:"none"};var s={top:0,left:0};if(null!==i){var o=i.getBoundingClientRect();if(o){s.top=o.top;s.left=o.left}}var u=t||{x:0,y:0},a=u.x,f=u.y;a-=n.x;f-=s.top;var l="translate("+a+"px, "+f+"px)";return{transform:l,WebkitTransform:l}}(v,m,g,y,c.current),w=f?r.cloneElement(f,{draggedItem:p}):null;return r.createElement("div",{className:a.dragLayerRoot,ref:c},r.createElement("div",{style:b},w))}});
define("@ms/utilities-react-drag-drop/lib/drag-source/DragSourceWrapper.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".msDragStart_d71039cb{background-color:"},{theme:"neutralLight",defaultValue:"#eaeaea"},{rawString:"}.msDragStart_d71039cb .msDragSourceWrapperLinkDragIcon_d71039cb{opacity:1}.msDragIcon_d71039cb{opacity:0;position:absolute;top:0px;color:"},{theme:"neutralTertiary",defaultValue:"#a6a6a6"},{rawString:";z-index:1;padding-top:8px;margin-left:0px}.msDragSrouceContainer_d71039cb{padding-left:16px}.isVisible_d71039cb{opacity:1}.msRoot_d71039cb{-webkit-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);cursor:pointer}.msRoot_d71039cb:focus,.msRoot_d71039cb:hover{background-color:"},{theme:"neutralLighter",defaultValue:"#f4f4f4"},{rawString:'}.msRoot_d71039cb:focus i[data-icon-name="GripperBarVertical"],.msRoot_d71039cb:hover i[data-icon-name="GripperBarVertical"]{opacity:1}.dragLayerRoot_d71039cb{position:absolute;pointer-events:none;z-index:100;left:0;top:0}\n'}]);t.msDragStart="msDragStart_d71039cb";t.msDragSourceWrapperLinkDragIcon="msDragSourceWrapperLinkDragIcon_d71039cb";t.msDragIcon="msDragIcon_d71039cb";t.msDragSrouceContainer="msDragSrouceContainer_d71039cb";t.isVisible="isVisible_d71039cb";t.msRoot="msRoot_d71039cb";t.dragLayerRoot="dragLayerRoot_d71039cb"});
define("@ms/items-view/lib/private/components/reactDragDrop/DragLayerPreview",["require","exports","react","@ms/utilities-strings/lib/index","./DragDropWrapper.resx","./DragLayerPreview.scss","../itemFileTypeIcon/ItemFileTypeIcon","@uifabric/file-type-icons/lib/index"],function(e,t,n,r,i,s,o,u){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.DragLayerPreview=function(e){var t=e.draggedItem;if(!t)return null;var a=t.dragSourceKey,f=t.itemKeys,l=void 0===f?[]:f,c=l[0]||a,h=l.length>0?l.length:a?1:0,p="",d=null;if(h<1)return null;p=r.format(r.getLocalizedCountValue(i.default.dragMoveItemsPreviewText,i.default.dragMoveItemsPreviewTextIntervals,h)||"",h);d=1===h?n.createElement(o.ItemFileTypeIcon,{itemKey:c,size:20,className:s.dragPreviewIcon}):n.createElement(o.FileTypeIcon,{type:u.FileIconType.genericFile,size:20,className:s.dragPreviewIcon});return p?n.createElement("div",{className:s.dragPreviewRoot},d||null,n.createElement("span",{className:s.dragPreviewText},p)):null}});
define("@ms/items-view/lib/private/components/reactDragDrop/DragLayerPreview.scss",["require","exports","@microsoft/load-themed-styles","odsp-next/providers/theming/ThemeInitializer"],function(e,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.loadStyles([{rawString:".dragPreviewRoot_7275dba6{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";-webkit-box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,0.132),0 0.6px 1.8px 0 rgba(0,0,0,0.108);box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,0.132),0 0.6px 1.8px 0 rgba(0,0,0,0.108)}.dragPreviewIcon_7275dba6{margin:5px;height:20px;width:20px}[dir='ltr'] .dragPreviewText_7275dba6{margin-right:5px}[dir='rtl'] .dragPreviewText_7275dba6{margin-left:5px}\n"}]);t.dragPreviewRoot="dragPreviewRoot_7275dba6";t.dragPreviewIcon="dragPreviewIcon_7275dba6";t.dragPreviewText="dragPreviewText_7275dba6"});
define("odsp-next/controls/itemContent/itemsScope/TransclusionContent",["require","exports","react","../../knockout/Knockout","../../../bindings/component/ControlBinding","../../detailsPaneTransclusionContent/DetailsPaneTransclusionContent.key","../../../actions/base/ItemSelectionHelper","../../../actions/base/itemsScope/ItemSelectionHelper","../../base/react/WithResources","@ms/odsp-utilities/lib/resources/Resources","../../../utilities/killSwitch/KillSwitch","../../knockoutContentShim/WithKnockoutResourceScope"],function(e,t,n,r,i,s,o,u,a,f,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});function h(e){var t=a.useResourceScope(),o=n.useMemo(function(){return i.toSpecification(s.resourceKey,{})},[]);return n.createElement(c.WithKnockoutResourceScope,null,n.createElement(r.default,{specification:o,resources:t}))}var p=a.withChildResources(function(e){e.exposeFactory(o.typeResourceKey,new f.AliasResourceFactory(u.typeResourceKey))},{owner:e("module").id})(h);t.TransclusionContent=l.default.isActivated("F2A3B2C8-3374-4D27-A19A-C791E9C75D2C","8/16/2019","ItemSelectionHelper shim for Knockout")?h:p});
define("odsp-next/controls/detailsPaneTransclusionContent/DetailsPaneTransclusionContent.key",["require","exports","@ms/odsp-utilities/lib/resources/Resources"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceKey=new n.ResourceKey({name:e("module").id,loader:new n.AliasResourceLoader(function(){return new Promise(function(t,n){e(["./DetailsPaneTransclusionContent"],t,n)}).then(function(e){return e.resourceKey.local})})});t.default=t.resourceKey});
define("@ms/items-view/lib/private/components/itemAutoRefresh/ItemAutoRefresh",["require","exports","tslib","react","../decorators/selectors","../decorators/connectToItemCache","../../controls/itemAutoRefreshControl"],function(e,t,n,r,i,s,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){n.__extends(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.componentDidMount=function(){var e=this.props,t=e.isAvailable,n=e.subscribe;if(t&&n){this._subscribe=n;this._unsubscribe=n()}};t.prototype.componentDidUpdate=function(e){var t=this.props,n=t.isAvailable,r=t.subscribe;if(n&&r!==this._subscribe){if(this._unsubscribe){this._unsubscribe();this._unsubscribe=void 0}this._subscribe=r;r&&(this._unsubscribe=r())}};t.prototype.componentWillUnmount=function(){if(this._unsubscribe){this._unsubscribe();this._unsubscribe=void 0}};t.prototype.render=function(){return null};return t}(r.PureComponent);t.ItemAutoRefresh=s.connectToItemCache(function(e,t){var n=t.itemKey,r=e.demandItemFacet(o.itemAutoRefreshControl,n);return o.itemAutoRefreshControl.evaluate(r)(e,{itemKey:n})})(u);t.CurrentItemAutoRefresh=i.withCurrentItemSet()(t.ItemAutoRefresh)});
define("@ms/items-view/lib/private/controls/itemAutoRefreshControl",["require","exports","../models/controls/ControlFacet"],function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemAutoRefreshControl=new n.ControlFacet("itemAutoRefreshControl")});
define("odsp-next/dataSources/item/od/ItemCacheToKOStoreDataSource",["require","exports","tslib","@ms/odsp-utilities/lib/resources/Resources","@ms/odsp-shared/lib/base/BaseModel","@ms/odsp-shared/lib/utilities/object/EqualityComparers","../../../models/store/ItemsStore","../../../providers/item/ItemProvider","@ms/items-view/lib/private/models/items/getItemSetKey","../../../models/itemsScope/facets/OneDriveItemFacet","../../../models/itemCache/ItemCacheObservable","@ms/items-view/lib/private/facets/SetFacets","../../../models/itemsScope/ItemsScopeManager.key","../../../models/item/OneDriveItem","../../../models/itemSet/ItemSet","../../../models/item/ItemType","@ms/items-view/lib/private/facets/ScopeFacets"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=[],y=function(e){n.__extends(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._store=n.itemsStore;r._itemsScopeItemKeyToKOItemKeyMap={};r._itemProvider=n.itemProvider;var i=n.itemCacheObservablesFactory;r._itemsScopeManager=n.itemsScopeManager;r._childKOItems=r.addDisposable(i.pureCompute(function(e){return r._computeChildKOItems(e)}));r._childKOItems.equalityComparer=s.objectStrictEquality;r.koItem=r.addDisposable(i.pureCompute(function(e){return r._computeKOItem(e)}));r.koItem.equalityComparer=s.objectStrictEquality;r.koItemSet=r.observables.compute(r._computeKOItemSet);r.koItemSet.equalityComparer=s.objectStrictEquality;r._selectedItemKeys=r.addDisposable(i.pureCompute(function(e){return r._computeSelectedItemKeys(e)}));r._selectedItemKeys.equalityComparer=s.objectStrictEquality;r.selectedKOItemKeys=r.observables.pureCompute(r._computeSelectedKOItemKeys);return r}t.prototype._computeKOItem=function(e){var t=this._itemsScopeManager.itemsScopeItemKey,n=e.demandItemFacet(m.currentItemFacet,t),r=n&&n.itemKey,i=a.getItemSetKey(e,{itemKey:r}),s=e.demandItemFacet(c.parentItemFacet,i),o=s&&s.itemKey,u=e.demandItemFacet(f.oneDriveItemFacet,o);if(u&&o)this._itemsScopeItemKeyToKOItemKeyMap[o]=u.key;else{var l=new p.default;l.type=v.default.Folder;u=l}return u};t.prototype._computeChildKOItems=function(e){var t=this._itemsScopeManager.itemsScopeItemKey,n=e.demandItemFacet(m.currentItemFacet,t),r=n&&n.itemKey,i=a.getItemSetKey(e,{itemKey:r}),s=e.demandItemFacet(c.childItemsFacet,i),o=[];if(s)for(var u=0,l=s.itemKeys;u<l.length;u++){var h=l[u],p=e.demandItemFacet(f.oneDriveItemFacet,h);if(p){o.push(p);this._itemsScopeItemKeyToKOItemKeyMap[h]=p.key}}return o};t.prototype._computeSelectedItemKeys=function(e){var t=this._itemsScopeManager.itemsScopeItemKey,n=e.demandItemFacet(m.selectedItemsFacet,t);return n&&n.itemKeys||[]};t.prototype._computeSelectedKOItemKeys=function(){var e=this._itemsScopeItemKeyToKOItemKeyMap;this.koItemSet();return this._selectedItemKeys().map(function(t){return e[t]})};t.prototype._computeKOItemSet=function(){var e=this.koItem();if(e.key){this._store.setItem(e,e.key);var t=e.key,n=this._itemProvider.getItemSync({parentKey:t}),r=this._getAndStoreChildKOItems();this._updateItemSet(n,r);return n}var i=new d.default;i.item=this.observables.create(e);return i};t.prototype._getAndStoreChildKOItems=function(){var e=this;return this._childKOItems().map(function(t){e._store.setItem(t,t.key);return e._store.getItem(t.key)})};t.prototype._updateItemSet=function(e,t){e.isPlaceholder=!1;e.content({items:t,groupings:g});this._store.setItemSet(e.key,e)};t.dependencies=n.__assign({},i.default.dependencies,{itemsStore:o.resourceKey,itemProvider:u.resourceKey,itemCacheObservablesFactory:l.resourceKey,itemsScopeManager:h.resourceKey});return t}(i.default);t.default=y;t.resourceKey=r.createResolvedResourceKey(e("module").id,y)});
define("odsp-next/controls/itemsScope/odc/DefaultClickActionControlHandler",["require","exports","react","@ms/odsp-utilities/lib/resources/Resources","@ms/items-view/lib/private/components/actions/defaultClick/handlers/open","../DefaultClickActionHandler","@ms/items-view/lib/private/models/Facet","../../../models/itemsScope/facets/OdspNextAppFacets","../../../models/itemsScope/controls/ItemKeyToStoreKeyControl","@ms/items-view/lib/private/models/itemsScope/getItemsScope","../../../models/itemsScope/facets/CurrentItemsScopeFacets","../../../dataSources/url/odc/UrlRouting","../../../dataSources/url/PageType","@ms/items-view-addon-graph/lib/models/facets/VaultFacet","../../../actions/itemsScope/OpenAction"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var v={resources:r.resourceScopeKey};t.resourceKey=new r.ResourceKey({name:e("module").id,factory:{dependencies:v,create:function(e){var t=e.resources,r={key:new o.Facet("vaultActionHandler").id,evaluate:function(e,r){var i=r.itemKey,s=e.demandItemFacet(a.itemKeyToStoreKeyControl,u.odspNextAppItemKey),o=f.getItemsScope(e).itemsScopeItemKey,v=e.demandItemFacet(l.currentViewParamsFacet,o),m=v&&c.getPageType(v)||h.default.Files,g=m===h.default.FilePicker||m===h.default.FolderPicker,y=e.demandItemFacet(p.vaultFacet,i);return{action:a.itemKeyToStoreKeyControl.evaluate(s)(e,{itemKey:i,viewParams:v||{}}).storeKey&&y&&(y.isLocked||g)?n.createElement(d.OpenAction,{itemKey:r.itemKey,resources:t}):void 0}}};return{instance:function(e,t){var n=t.handlers;if(n){for(var o=[],u=0,a=n;u<a.length;u++){var f=a[u];if(f.key===i.openDefaultClickActionHandler.key){o.push(r);o.push(f);o.push(s.defaultClickActionHandler)}else o.push(f)}return{handlers:o}}return{}}}}}})});
define("odsp-next/controls/itemsScope/DefaultClickActionHandler",["require","exports","tslib","react","@ms/items-view/lib/private/models/Facet","../../models/itemsScope/facets/OdspNextAppFacets","../../models/itemsScope/controls/ItemKeyToStoreKeyControl","@ms/items-view/lib/private/models/itemsScope/getItemsScope","../../models/itemsScope/facets/CurrentItemsScopeFacets","@ms/items-view-addon-sp/lib/actions/base/CreateDeferredOnExecuteAction"],function(e,t,n,r,i,s,o,u,a,f){"use strict";var l=this;Object.defineProperty(t,"__esModule",{value:!0});var c=f.createDeferredOnExecuteAction(function(){return n.__awaiter(l,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,new Promise(function(t,n){e(["../../actions/itemsScope/DefaultClickAction"],t,n)})];case 1:return[2,t.sent().DefaultClickAction]}})})},function(){return!0});t.defaultClickActionHandler={key:new i.Facet("defaultClickHandler").id,evaluate:function(e,t){var n=e.demandItemFacet(o.itemKeyToStoreKeyControl,s.odspNextAppItemKey),i=u.getItemsScope(e).itemsScopeItemKey,f=e.demandItemFacet(a.currentViewParamsFacet,i);return{action:o.itemKeyToStoreKeyControl.evaluate(n)(e,{itemKey:t.itemKey,viewParams:f||{}}).storeKey?r.createElement(c,{itemKey:t.itemKey}):void 0}}}});
define("odsp-next/actions/itemsScope/OpenAction",["require","exports","tslib","react","@ms/items-view/lib/private/components/action/Action","../../providers/bundleLoader/PageLoadMonitor"],function(e,t,n,r,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(t){n.__extends(o,t);function o(e){var n=t.call(this,e)||this;n.state={DeferredClickHandler:void 0};n._resources=e.resources;return n}o.prototype.render=function(){var e=this.state.DeferredClickHandler;return e?r.createElement(e,{itemKey:this.props.itemKey}):r.createElement(i.ActionBase,{isAvailable:!0,isToggled:!1})};o.prototype.componentDidMount=function(){this._loadDeferredClickhandler()};o.prototype._loadDeferredClickhandler=function(){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(n){switch(n.label){case 0:return[4,this._resources.consume(s.resourceKey).waitForPLT()];case 1:n.sent();return[4,new Promise(function(t,n){e(["./DefaultClickAction"],t,n)})];case 2:t=n.sent().DefaultClickAction;this.setState({DeferredClickHandler:t});return[2]}})})};return o}(r.Component);t.OpenAction=o});
define("odsp-next/dataSources/itemInvalidator/odc/ItemInvalidator",["require","exports","@ms/odsp-utilities/lib/resources/Resources","../../../models/itemCache/ItemCacheStore","@ms/items-view/lib/private/facets/SetFacets","@ms/items-view/lib/private/operations/invalidateItems","../../../models/itemsScope/ItemsScopeCurrentItemKey.key","@ms/items-view/lib/private/facets/SetFacets","@ms/items-view-addon-graph/lib/models/keys/DriveItemKeyFacet","../../../dataSources/url/odc/UrlDataSource","@ms/items-view-addon-photos/lib/models/facets/GroupToCountFacets","@ms/items-view-addon-photos/lib/models/facets/WidthsFacets","@ms/items-view-addon-photos/lib/models/facets/PhotoRotationFacet","@ms/items-view-addon-photos/lib/models/keys/PhotosRootItemSetKeyFacet","@ms/items-view-addon-photos/lib/models/keys/AllGroupToCountsItemKeyFacet","@ms/items-view/lib/private/facets/ItemFacets","@ms/items-view-addon-photos/lib/models/facets/PhotoThumbnailSetFacet","../../url/odc/UrlRouting","../../url/odc/UrlHelpers","../../url/odc/UrlRouting","../../../resources/ControlResourceKeys"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var E=function(){function e(e,t){void 0===e&&(e={});var n=t.itemCacheStore;this._itemCacheStore=n;this._itemsScopeCurrentItemKey=t.itemsScopeCurrentItemKey;this._viewParams=t.viewParams}e.prototype.invalidateItemSet=function(e){var t;this._itemCacheStore.dispatch(s.invalidateItems({items:(t={},t[e]=[u.childItemsFacet],t)}))};e.prototype.invalidateCurrentItemSet=function(){var e=this._itemsScopeCurrentItemKey.peek();this.invalidateItemSet(e)};e.prototype.invalidateItems=function(e){var t,n=this._getItemKeyFromKOKey(e);this._itemCacheStore.dispatch(s.invalidateItems({items:(t={},t[n]=[i.defaultChildItemSetFacet],t)}))};e.prototype.refreshItemsInCurrentItemSet=function(e){};e.prototype.invalidateAllPhotosWidths=function(){var e,t=this._itemsScopeCurrentItemKey.peek();this._itemCacheStore.dispatch(s.invalidateItems({items:(e={},e[t]=[c.widthsPointerFacet],e)}))};e.prototype.invalidatePhotoAsDeleted=function(e){var t,n=g.getKeyParams(b.getCurrentItemKey(this._viewParams.peek())).cid,r=f.default.getVroomBaseUrl(),i=a.driveItemKeyFacet.serialize({itemId:e,driveId:n,endpoint:r});this._itemCacheStore.dispatch(s.invalidateItems({items:(t={},t[i]=[v.deletedFacet],t)}))};e.prototype.invalidPhotoSetAsUpdated=function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];r.id&&this.invalidatePhotoAsUpdated(r.id)}};e.prototype.invalidatePhotoAsUpdated=function(e){var t,n=this._itemsScopeCurrentItemKey.peek();if(p.photosRootItemSetKeyFacet.matches(n)){var r=p.photosRootItemSetKeyFacet.deserialize(n).photosRootKeyPart,i=a.driveItemKeyFacet.serialize({itemId:e,driveId:r.driveId,endpoint:r.endpoint});this._itemCacheStore.dispatch(s.invalidateItems({items:(t={},t[i]=[v.displayNameFacet,m.photoThumbnailSetFacet,h.photoRotationFacet],t)}))}};e.prototype.invalidateAllPhotosRootItem=function(){var e,t,n=this._itemsScopeCurrentItemKey.peek();if(p.photosRootItemSetKeyFacet.matches(n)){var r=d.allGroupToCountsItemKeyFacet.serialize({photosRootItemSetKeyPart:p.photosRootItemSetKeyFacet.deserialize(n)});this._itemCacheStore.dispatch(s.invalidateItems({items:(e={},e[r]=[l.allGroupToCountsFacet],e)}));this._itemCacheStore.dispatch(s.invalidateItems({items:(t={},t[n]=[u.childItemsFacet,l.allGroupToCountsPointerFacet,c.widthsPointerFacet,c.targetHeightFacet],t)}))}else console.log("Current Root Key is not an All Photos Root Item Key!")};e.prototype.invalidateGroups=function(e){};e.prototype._getItemKeyFromKOKey=function(e){var t=g.getKeyParams(e),n=t.id,r=t.cid,i=y.getVroomBaseUrl();return a.driveItemKeyFacet.serialize({endpoint:i,driveId:r,itemId:n})};e.dependencies={itemCacheStore:r.resourceKey,itemsScopeCurrentItemKey:o.resourceKey,viewParams:w.viewParams};return e}();t.ItemInvalidator=E;t.resourceKey=n.createResolvedResourceKey(e("module").id,E)});